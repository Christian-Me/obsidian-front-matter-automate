/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian15 = require("obsidian");

// src/settings.ts
var import_obsidian14 = require("obsidian");

// src/frontmatter-tools.ts
var import_obsidian = require("obsidian");
function getPropertiesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get properties:", metadataManager);
    return Object.values(metadataManager.properties).map((value) => ({
      name: value.name,
      type: value.type,
      count: value.count,
      source: "registered"
    })).sort((a, b) => a.name.localeCompare(b.name));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
function getTypesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get types:", metadataManager);
    return Object.values(metadataManager.registeredTypeWidgets).map((value, index, array) => ({
      type: value.type,
      icon: value.icon,
      jsType: ""
    })).sort((a, b) => a.type.localeCompare(b.type));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}

// src/tools.ts
var import_obsidian11 = require("obsidian");

// src/Log.ts
var import_obsidian2 = require("obsidian");
function logError(e) {
  const notice = new import_obsidian2.Notice("", 8e3);
  if (e instanceof ErrorManager && e.console_msg) {
    notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}<br/>Check console for more information`;
    console.error(`Frontmatter Error:`, e.message, "\n", e.console_msg);
  } else {
    notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}`;
  }
}

// src/Error.ts
var ErrorManager = class extends Error {
  constructor(msg, console_msg) {
    super(msg);
    this.console_msg = console_msg;
    this.name = this.constructor.name;
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, this.constructor);
    }
  }
};
function errorWrapperSync(fn2, msg) {
  try {
    return fn2();
  } catch (e) {
    logError(new ErrorManager(msg, e.message));
    return null;
  }
}

// src/alertBox.ts
var import_obsidian3 = require("obsidian");
var AlertModal = class extends import_obsidian3.Modal {
  constructor(app, title, description, btn1, btn2, askAgainLabel) {
    super(app);
    this.title = title;
    this.description = description;
    this.btn1Text = btn1;
    this.btn2Text = btn2;
    this.askAgainLabel = askAgainLabel;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: this.title });
    contentEl.createEl("p", { text: this.description });
    const settings = new import_obsidian3.Setting(contentEl);
    if (this.askAgainLabel) {
      const itemInfoDiv = settings.settingEl.getElementsByClassName("setting-item-info")[0];
      if (itemInfoDiv) {
        this.checkboxEl = itemInfoDiv.createEl("input", { type: "checkbox" });
        const label = itemInfoDiv.createEl("label", { text: this.askAgainLabel });
        label.style.marginLeft = "8px";
      }
    }
    settings.addButton((btn) => {
      btn.setButtonText(this.btn1Text).setCta().onClick(() => {
        var _a;
        this.close();
        this.resolvePromise({ proceed: true, data: { askConfirmation: (_a = this.checkboxEl) == null ? void 0 : _a.checked } });
      });
    });
    settings.addButton((btn) => {
      btn.setButtonText(this.btn2Text).onClick(() => {
        var _a;
        this.close();
        this.resolvePromise({ proceed: false, data: { askConfirmation: (_a = this.checkboxEl) == null ? void 0 : _a.checked } });
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  async openAndGetValue() {
    this.open();
    return this.promise;
  }
};

// src/rules.ts
var import_obsidian10 = require("obsidian");

// src/autocompleteModal.ts
var import_obsidian5 = require("obsidian");

// src/uiElements.ts
var import_obsidian4 = require("obsidian");
function renderValueInput(containerEl, propertyInfo, currentValue, changeCallback) {
  let returnComponent;
  containerEl.empty();
  if (!propertyInfo) {
    containerEl.setText("");
    containerEl.addClass("text-muted");
    return;
  }
  const type = propertyInfo.type;
  switch (type) {
    case "number":
      returnComponent = new import_obsidian4.TextComponent(containerEl).setPlaceholder("Numeric Value").setValue(currentValue !== void 0 && currentValue !== null ? String(currentValue) : "").onChange(async (value) => {
        const numValue = value === "" ? void 0 : parseFloat(value);
        changeCallback(propertyInfo, isNaN(numValue) ? void 0 : numValue);
      });
      returnComponent.inputEl.type = "number";
      break;
    case "checkbox":
      returnComponent = containerEl.createDiv({ cls: "tri-state-checkbox clickable-icon" });
      returnComponent.setAttribute("aria-label", "Checkbox change state");
      returnComponent.setAttribute("role", "checkbox");
      const updateCheckboxVisual = (state) => {
        let iconName;
        let ariaState;
        if (state === true) {
          iconName = "check-square";
          ariaState = "true";
        } else if (state === false) {
          iconName = "square";
          ariaState = "false";
        } else {
          iconName = "minus-square";
          ariaState = "mixed";
        }
        (0, import_obsidian4.setIcon)(returnComponent, iconName);
        returnComponent.setAttribute("aria-checked", ariaState);
        returnComponent.dataset.state = String(state);
      };
      updateCheckboxVisual(currentValue);
      returnComponent.addEventListener("click", async () => {
        let currentState = returnComponent.dataset.state;
        let nextState;
        if (currentState === "false") {
          nextState = true;
        } else if (currentState === "true") {
          nextState = void 0;
        } else {
          nextState = false;
        }
        changeCallback(propertyInfo, nextState);
        updateCheckboxVisual(nextState);
      });
      break;
    case "date":
      returnComponent = new import_obsidian4.TextComponent(containerEl).setPlaceholder("YYYY-MM-DD").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      returnComponent.inputEl.type = "date";
      break;
    case "datetime":
      returnComponent = new import_obsidian4.TextComponent(containerEl).setPlaceholder("YYYY-MM-DDTHH:mm").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      returnComponent.inputEl.type = "datetime-local";
      break;
    case "aliases":
    case "tags":
    case "multitext":
      returnComponent = new import_obsidian4.TextComponent(containerEl).setPlaceholder("values (divided by comma)").setValue(Array.isArray(currentValue) ? currentValue.join(", ") : currentValue || "").onChange(async (value) => {
        const arrayValue = value.split(",").map((s) => s.trim()).filter((s) => s);
        changeCallback(propertyInfo, arrayValue.length > 0 ? arrayValue : void 0);
      });
      break;
    case "text":
    default:
      returnComponent = new import_obsidian4.TextComponent(containerEl).setPlaceholder("value").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      break;
  }
  if (type !== "checkbox") {
    returnComponent.inputEl.style.backgroundColor = "transparent";
    returnComponent.inputEl.style.width = "100%";
    returnComponent.inputEl.style.border = "none";
  }
  return returnComponent;
}
function updatePropertyIcon(iconEl, type) {
  let iconName = "hash";
  switch (type) {
    case "text":
      iconName = "align-left";
      break;
    case "number":
      iconName = "binary";
      break;
    case "multitext":
      iconName = "list";
      break;
    case "date":
      iconName = "calendar";
      break;
    case "datetime":
      iconName = "clock";
      break;
    case "checkbox":
      iconName = "check-square";
      break;
    case "tags":
      iconName = "tags";
      break;
    case "aliases":
      iconName = "forward";
      break;
    default:
      iconName = "help-circle";
  }
  (0, import_obsidian4.setIcon)(iconEl, iconName);
}

// src/autocompleteModal.ts
var AutocompleteModal = class extends import_obsidian5.Modal {
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param plugin - The plugin instance.
   * @param expectedType - Expected return type.
   * @param activeFile - The currently active file or folder.
   * @param frontmatter - Frontmatter data for the active file.
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, plugin, rule, options, activeFile, frontmatter, okCallback) {
    super(app);
    this.knownProperties = {};
    this.result = {};
    this.changeCallback = (propertyInfo, value) => {
      if (propertyInfo) {
        this.result[propertyInfo.name] = value;
      }
    };
    this.app = app;
    this.tools = new ScriptingTools(app, this.plugin, this.frontmatter);
    this.activeFile = activeFile;
    this.frontmatter = frontmatter;
    this.plugin = plugin;
    this.rule = rule;
    this.options = options;
    this.expectedType = rule.type;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
    if (okCallback)
      this.okCallback = okCallback;
    this.resetToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetToInitial() {
  }
  /**
   * Resets the current selection state to empty.
   */
  resetToEmpty() {
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  async onOpen() {
    var _a;
    this.knownProperties = await this.tools.fetchKnownProperties(this.app);
    const { contentEl } = this;
    if (contentEl.parentElement)
      contentEl.parentElement.style.width = "900px";
    contentEl.empty();
    contentEl.addClass("codeEditor-modal");
    contentEl.createEl("h2", { text: "Please complete the following properties" });
    contentEl.createEl("body", { text: `File: ${(_a = this.activeFile) == null ? void 0 : _a.path}` });
    this.contentRootElement = contentEl.createDiv({ cls: "codeEditor-container" });
    this.contentRootElement.style.overflowY = "auto";
    this.contentRootElement.style.padding = "10px";
    this.contentRootElement.style.marginTop = "10px";
    this.contentRootElement.style.marginBottom = "10px";
    const propertyContainerEl = contentEl.createDiv({ cls: "codeEditor-options" });
    propertyContainerEl.style.flexDirection = "column";
    for (const [key, value] of Object.entries(this.frontmatter)) {
      if (key.startsWith(this.rule.property + this.options.propertyDelimiter)) {
        const rowEl = propertyContainerEl.createDiv({ cls: "property-setting-row setting-item" });
        rowEl.style.width = "100%";
        const controlEl = rowEl.createDiv({ cls: "setting-item-control" });
        controlEl.style.display = "flex";
        controlEl.style.alignItems = "center";
        controlEl.style.justifyContent = "space-between";
        controlEl.style.width = "100%";
        controlEl.style.gap = "0px";
        const leftContainer = controlEl.createDiv({ cls: "property-left-container" });
        leftContainer.style.display = "flex";
        leftContainer.style.alignItems = "center";
        leftContainer.style.minWidth = "250px";
        const iconEl = leftContainer.createSpan({ cls: "property-icon setting-item-icon" });
        iconEl.style.marginRight = "8px";
        updatePropertyIcon(iconEl, this.knownProperties[key].type);
        const searchContainer = leftContainer.createDiv({ cls: "property-search-container" });
        const nameInput = new import_obsidian5.TextComponent(searchContainer).setValue(key).setPlaceholder("Property name").setDisabled(true);
        nameInput.inputEl.style.border = "none";
        const middleContainer = controlEl.createDiv({ cls: "property-middle-container" });
        const valueContainer = middleContainer.createDiv({ cls: "property-value-container" });
        valueContainer.style.width = "100%";
        let previewComponent = renderValueInput(valueContainer, this.knownProperties[key], this.frontmatter[key], this.changeCallback);
        previewComponent.inputEl.style.width = "100%";
        previewComponent.inputEl.style.backgroundColor = "transparent";
        const deleteButtonContainer = controlEl.createDiv({ cls: "property-right-container" });
        deleteButtonContainer.style.marginLeft = "auto";
      }
    }
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian5.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetToInitial();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian5.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetToEmpty();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      console.log("Cancel Clicked - Returning");
      this.resolvePromise(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.resolvePromise({ values: this.result });
      this.close();
    };
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  openAndGetValues() {
    this.open();
    return this.promise;
  }
};
async function openAutocompleteModal(app, plugin, rule, options, activeFile, frontmatter) {
  const modal = new AutocompleteModal(app, plugin, rule, options, activeFile, frontmatter);
  return await modal.openAndGetValues();
}

// src/suggesters/FolderSuggester.ts
var import_obsidian7 = require("obsidian");

// src/suggesters/suggest.ts
var import_obsidian6 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/utils/userAgent.js
function getUAString() {
  var uaData = navigator.userAgentData;
  if (uaData != null && uaData.brands && Array.isArray(uaData.brands)) {
    return uaData.brands.map(function(item) {
      return item.brand + "/" + item.version;
    }).join(" ");
  }
  return navigator.userAgent;
}

// node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js
function isLayoutViewport() {
  return !/^((?!chrome|android).)*safari/i.test(getUAString());
}

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale, isFixedStrategy) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  if (isFixedStrategy === void 0) {
    isFixedStrategy = false;
  }
  var clientRect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (includeScale && isHTMLElement(element)) {
    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;
    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;
  }
  var _ref = isElement(element) ? getWindow(element) : window, visualViewport = _ref.visualViewport;
  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;
  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;
  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;
  var width = clientRect.width / scaleX;
  var height = clientRect.height / scaleY;
  return {
    width,
    height,
    top: y,
    right: x + width,
    bottom: y + height,
    left: x,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : (
    // $FlowFixMe[prop-missing]
    element.document
  )) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return (
    // this is a quicker (but less type safe) way to save quite some bytes from the bundle
    // $FlowFixMe[incompatible-return]
    // $FlowFixMe[prop-missing]
    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node
    element.parentNode || // DOM Element detected
    (isShadowRoot(element) ? element.host : null) || // ShadowRoot detected
    // $FlowFixMe[incompatible-call]: HTMLElement is a Node
    getDocumentElement(element)
  );
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837
  getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = /firefox/i.test(getUAString());
  var isIE = /Trident/i.test(getUAString());
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref, win) {
  var x = _ref.x, y = _ref.y;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : (
        // $FlowFixMe[prop-missing]
        offsetParent[heightProp]
      );
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : (
        // $FlowFixMe[prop-missing]
        offsetParent[widthProp]
      );
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }, getWindow(popper2)) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element, strategy) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    var layoutViewport = isLayoutViewport();
    if (layoutViewport || !layoutViewport && strategy === "fixed") {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : (
    // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here
    updatedList.concat(listScrollParents(getParentNode(target)))
  );
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element, strategy) {
  var rect = getBoundingClientRect(element, false, strategy === "fixed");
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent, strategy) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary, strategy) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent, strategy);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent, strategy));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$strategy = _options.strategy, strategy = _options$strategy === void 0 ? state.strategy : _options$strategy, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || // https://github.com/popperjs/popper-core/issues/1078
    isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        runModifierEffects();
        return instance.update();
      },
      // Sync update  it will always be executed, even if not necessary. This
      // is useful for low frequency updates where sync behavior simplifies the
      // logic.
      // For high frequency updates (e.g. `resize` and `scroll` events), always
      // prefer the async Popper#update method
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      // Async and optimistically optimized update  it will not be executed if
      // not necessary (debounced to run at most once-per-tick)
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref) {
        var name = _ref.name, _ref$options = _ref.options, options2 = _ref$options === void 0 ? {} : _ref$options, effect4 = _ref.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggesters/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on(
      "click",
      ".suggestion-item",
      this.onSuggestionClick.bind(this)
    );
    containerEl.on(
      "mousemove",
      ".suggestion-item",
      this.onSuggestionMouseover.bind(this)
    );
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(
      selectedIndex,
      this.suggestions.length
    );
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(app, inputEl) {
    this.app = app;
    this.inputEl = inputEl;
    this.scope = new import_obsidian6.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on(
      "mousedown",
      ".suggestion-container",
      (event) => {
        event.preventDefault();
      }
    );
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(this.app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    this.app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    this.app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/suggesters/FolderSuggester.ts
var FolderSuggest = class extends TextInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian7.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders.slice(0, 1e3);
  }
  renderSuggestion(file, el) {
    el.setText(file.path.replace(/^(?!\/)/, "/"));
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path.replace(/^(?!\/)/, "/");
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/suggesters/FileSuggester.ts
var import_obsidian8 = require("obsidian");
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder) {
    super(plugin.app, inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
  }
  get_error_msg() {
    return `Folder ${this.folder} doesn't exist`;
  }
  getSuggestions(input_str) {
    const all_files = errorWrapperSync(
      () => getFilesFromFolder(
        this.plugin.app,
        this.folder
      ),
      this.get_error_msg()
    );
    if (!all_files) {
      return [];
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian8.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files.slice(0, 1e3);
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/directorySelectionModal.ts
var import_obsidian9 = require("obsidian");
var DirectorySelectionModal = class extends import_obsidian9.Modal {
  // Reference to update dropdown on reset
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param initialFolders - Array of initially selected folder paths.
   * @param initialFiles - Array of initially selected file paths.
   * @param initialMode - The initial selection mode ('include' or 'exclude').
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, initialFolders, initialFiles, initialOptions, okCallback) {
    super(app);
    this.showFiles = false;
    // Container for the tree view
    this.treeNodes = /* @__PURE__ */ new Map();
    // Map path to node info for quick access
    this.modeDropdown = null;
    this.initialFoldersSnapshot = new Set(initialFolders);
    this.initialFilesSnapshot = new Set(initialFiles);
    this.initialModeSnapshot = initialOptions.selectionMode;
    this.initialDisplaySnapshot = initialOptions.displayMode;
    this.showFiles = initialOptions.displayMode === "files" || initialOptions.displayMode === "file" || initialFiles.length > 0;
    this.options = initialOptions;
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    this.currentFolders = new Set(this.initialFoldersSnapshot);
    this.currentFiles = new Set(this.initialFilesSnapshot);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    this.currentFolders = /* @__PURE__ */ new Set([]);
    this.currentFiles = /* @__PURE__ */ new Set([]);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("directory-selection-modal");
    if (this.includeExcludeSelectable) {
      contentEl.createEl("h2", { text: this.options.title || "Include or Exclude Folders and Files" });
    } else {
      contentEl.createEl("h2", { text: this.options.title || `${this.currentMode === "exclude" ? "Exclude" : "Include"} Folders and Files` });
    }
    const controlsEl = contentEl.createDiv({ cls: "modal-controls" });
    this.createModeSetting(controlsEl);
    this.createShowFilesSetting(controlsEl);
    this.treeRootElement = contentEl.createDiv({ cls: "tree-view-container" });
    this.treeRootElement.style.maxHeight = "600px";
    this.treeRootElement.style.overflowY = "auto";
    this.treeRootElement.style.border = "1px solid var(--background-modifier-border)";
    this.treeRootElement.style.padding = "10px";
    this.treeRootElement.style.marginTop = "10px";
    this.treeRootElement.style.marginBottom = "10px";
    if (!this.treeNodes.size) {
      this.buildAndRenderTree();
    }
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the dropdown setting for choosing the selection mode.
   * @param containerEl - The HTML element to append the setting to.
   */
  createModeSetting(containerEl) {
    if (this.includeExcludeSelectable) {
      this.modeDropdown = new import_obsidian9.Setting(containerEl).setName("Selection Mode").setDesc("Choose if the selected files and folders should be excluded or included.").addDropdown((dropdown) => {
        dropdown.addOption("exclude", "exclude").addOption("include", "include").setValue(this.currentMode).onChange((value) => {
          this.currentMode = value;
          this.updateTreeAppearance();
        });
      });
    }
  }
  /**
   * Updates the mode dropdown UI element to reflect the currentMode state.
   */
  updateModeDropdown() {
    var _a;
    const dropdownComponent = (_a = this.modeDropdown) == null ? void 0 : _a.components[0];
    if (dropdownComponent && typeof dropdownComponent.setValue === "function") {
      dropdownComponent.setValue(this.currentMode);
    }
  }
  /**
   * Creates the toggle setting for showing/hiding files in the tree.
   * @param containerEl - The HTML element to append the setting to.
   */
  createShowFilesSetting(containerEl) {
    if (this.options.optionShowFiles) {
      new import_obsidian9.Setting(containerEl).setName("Show Files").setDesc("Show Files within the directory tree.").addToggle((toggle) => {
        toggle.setValue(this.showFiles).onChange((value) => {
          this.showFiles = value;
          this.buildAndRenderTree();
        });
      });
    }
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian9.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian9.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    okButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Builds the logical tree structure data from the vault's files and folders.
   * @returns The root node of the tree structure.
   */
  buildTreeData() {
    const vaultRootNode = {
      path: "/",
      // Root folder path
      name: this.app.vault.getName() || "Vault",
      // Use vault name or default
      type: "folder",
      children: [],
      // Placeholder elements, will be assigned during rendering
      element: null,
      checkbox: null,
      label: null,
      container: null
    };
    const folderNodes = /* @__PURE__ */ new Map();
    folderNodes.set("/", vaultRootNode);
    const allFiles = this.app.vault.getFiles();
    allFiles.forEach((file) => {
      const parentFolder = file.parent;
      if (!parentFolder)
        return;
      let currentPath = "";
      const pathParts = parentFolder.path.split("/").filter((p) => p.length > 0);
      let parentNode = vaultRootNode;
      pathParts.forEach((part) => {
        currentPath = currentPath === "/" ? part : `${currentPath}/${part}`;
        if (!folderNodes.has(currentPath)) {
          const newFolderNode = {
            path: currentPath,
            name: part,
            type: "folder",
            children: [],
            element: null,
            checkbox: null,
            label: null,
            container: null
          };
          folderNodes.set(currentPath, newFolderNode);
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(newFolderNode);
          parentNode = newFolderNode;
        } else {
          parentNode = folderNodes.get(currentPath);
        }
      });
    });
    if (this.showFiles) {
      allFiles.forEach((file) => {
        const parentFolder = file.parent;
        if (!parentFolder)
          return;
        const parentPath = "/" + parentFolder.path;
        const parentNode = folderNodes.get(parentPath);
        const fileNode = {
          path: file.path,
          name: file.name,
          type: "file",
          element: null,
          checkbox: null,
          label: null,
          container: null
        };
        if (parentNode) {
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(fileNode);
        }
      });
    }
    const sortNodes = (a, b) => {
      if (a.type === "folder" && b.type === "file")
        return -1;
      if (a.type === "file" && b.type === "folder")
        return 1;
      return a.name.localeCompare(b.name);
    };
    folderNodes.forEach((node) => {
      var _a;
      return (_a = node.children) == null ? void 0 : _a.sort(sortNodes);
    });
    return vaultRootNode;
  }
  /**
   * Renders the entire tree structure in the DOM based on the tree data.
   */
  renderTree() {
    var _a;
    this.treeRootElement.empty();
    this.treeNodes.clear();
    const treeData = this.buildTreeData();
    const rootUl = this.treeRootElement.createEl("ul");
    rootUl.addClass("tree-root-ul");
    rootUl.style.listStyle = "none";
    rootUl.style.paddingLeft = "0";
    this.renderTreeNode(treeData, rootUl, 0, this.currentFolders, this.currentFiles);
    (_a = treeData.children) == null ? void 0 : _a.forEach((childNode) => {
    });
  }
  /**
   * Recursively renders a single tree node and its children in the DOM.
   * @param node - The TreeNode data to render.
   * @param parentElement - The HTML `ul` element to append this node's `li` to.
   * @param level - The current indentation level.
   */
  renderTreeNode(node, parentElement, level, selectedPaths, selectedfiles) {
    const li = parentElement.createEl("li");
    li.style.marginLeft = `${level * 20}px`;
    li.addClass(`tree-node-${node.type}`);
    const container = li.createDiv({ cls: "tree-node-container" });
    container.style.display = "flex";
    container.style.alignItems = "center";
    container.style.padding = "2px 0";
    let toggleButton = null;
    let isCollapsed = true;
    if (node.type === "folder") {
      toggleButton = container.createSpan({ cls: "tree-toggle-button" });
      toggleButton.textContent = "\u25B6";
      toggleButton.style.cursor = "pointer";
      toggleButton.style.marginRight = "5px";
      const shouldExpand = this.shouldExpandFolder(node, selectedPaths, selectedfiles);
      if (shouldExpand) {
        isCollapsed = false;
      }
      toggleButton.onclick = () => {
        isCollapsed = !isCollapsed;
        if (toggleButton)
          toggleButton.textContent = isCollapsed ? "\u25B6" : "\u25BC";
        if (childrenUl)
          childrenUl.style.display = isCollapsed ? "none" : "block";
      };
    }
    const checkbox = container.createEl("input", { type: "checkbox" });
    checkbox.id = `tree-cb-${node.path.replace(/[^a-zA-Z0-9]/g, "-")}`;
    checkbox.dataset.path = node.path;
    checkbox.dataset.type = node.type;
    const label = container.createEl("label");
    label.textContent = `${node.type === "folder" ? "\u{1F4C1}" : "\u{1F4C4}"} ${node.name}`;
    label.htmlFor = checkbox.id;
    label.style.marginLeft = "5px";
    label.style.cursor = "pointer";
    label.title = node.path;
    node.element = li;
    node.checkbox = checkbox;
    node.label = label;
    node.container = container;
    this.treeNodes.set(node.path, node);
    if (node.type === "folder") {
      checkbox.checked = this.currentFolders.has(node.path);
    } else {
      checkbox.checked = this.currentFiles.has(node.path);
    }
    checkbox.onchange = (event) => {
      const target = event.target;
      const path = target.dataset.path;
      const type = target.dataset.type;
      if (target.checked) {
        if (type === "folder") {
          if (this.options.displayMode === "folder") {
            this.currentFolders.clear();
          }
          this.currentFolders.add(path);
        } else {
          if (this.options.displayMode === "file") {
            this.currentFiles.clear();
          }
          this.currentFiles.add(path);
        }
      } else {
        if (type === "folder")
          this.currentFolders.delete(path);
        else
          this.currentFiles.delete(path);
      }
      this.updateTreeAppearance();
    };
    let childrenUl = null;
    if (node.type === "folder" && node.children && node.children.length > 0) {
      childrenUl = li.createEl("ul");
      childrenUl.style.listStyle = "none";
      childrenUl.style.paddingLeft = "0";
      childrenUl.style.marginLeft = "0";
      childrenUl.style.display = isCollapsed ? "none" : "block";
      node.children.forEach((child) => this.renderTreeNode(child, childrenUl, level + 1, selectedPaths, selectedfiles));
    }
  }
  // Helper method to determine if a folder should be expanded
  shouldExpandFolder(node, selectedPaths, selectedFiles) {
    if (selectedPaths.has(node.path) || selectedFiles.has(node.path)) {
      return true;
    }
    if (node.children) {
      for (const child of node.children) {
        if (this.shouldExpandFolder(child, selectedPaths, selectedFiles)) {
          return true;
        }
      }
    }
    return false;
  }
  /**
   * Updates the visual appearance (enabled/disabled/styling) of all nodes
   * in the tree based on the current mode and selections.
   */
  updateTreeAppearance() {
    this.treeNodes.forEach((node) => {
      let isDisabled = false;
      let isEffectivelyIncluded = false;
      let isEffectivelyExcluded = false;
      let ancestorFolderSelected = false;
      let currentPath = node.path;
      while (currentPath !== "/") {
        const parentPath = currentPath.substring(0, currentPath.lastIndexOf("/")) || "/";
        if (this.currentFolders.has(parentPath)) {
          ancestorFolderSelected = true;
          break;
        }
        if (parentPath === currentPath)
          break;
        currentPath = parentPath;
      }
      const nodeSelected = node.type === "folder" ? this.currentFolders.has(node.path) : this.currentFiles.has(node.path);
      if (this.currentMode === "exclude") {
        isEffectivelyExcluded = nodeSelected || ancestorFolderSelected;
        isDisabled = isEffectivelyExcluded;
      } else {
        if (node.type === "folder") {
          isEffectivelyIncluded = nodeSelected || ancestorFolderSelected;
        } else {
          const parentPath = node.path.substring(0, node.path.lastIndexOf("/")) || "/";
          const parentEffectivelyIncluded = this.isPathEffectivelyIncluded(parentPath);
          isEffectivelyIncluded = nodeSelected || parentEffectivelyIncluded;
        }
        isDisabled = !isEffectivelyIncluded;
      }
      node.checkbox.disabled = false;
      node.checkbox.checked = nodeSelected;
      if (isDisabled) {
        node.container.style.opacity = "0.5";
        node.label.style.textDecoration = "line-through";
        node.element.addClass("is-disabled");
      } else {
        node.container.style.opacity = "1";
        node.label.style.textDecoration = "none";
        node.element.removeClass("is-disabled");
      }
      node.element.classList.remove("is-included", "is-excluded");
      if (this.currentMode === "include" && isEffectivelyIncluded) {
        node.element.addClass("is-included");
      } else if (this.currentMode === "exclude" && isEffectivelyExcluded) {
        node.element.addClass("is-excluded");
      }
    });
  }
  /**
   * Helper function to determine if a given path is effectively included
   * in the current selection under 'include' mode.
   * A path is included if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
   * @param path - The folder or file path to check.
   * @returns True if the path should be considered included, false otherwise.
   */
  isPathEffectivelyIncluded(path) {
    if (this.currentMode !== "include") {
      return !this.isPathEffectivelyExcluded(path);
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
  * Helper function to determine if a given path is effectively excluded
  * in the current selection under 'exclude' mode.
  * A path is excluded if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
  * @param path - The folder or file path to check.
  * @returns True if the path should be considered excluded, false otherwise.
  */
  isPathEffectivelyExcluded(path) {
    if (this.currentMode !== "exclude") {
      return false;
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
   * Combines building the tree data, rendering the DOM, and applying initial appearance.
   */
  buildAndRenderTree() {
    this.renderTree();
    this.updateTreeAppearance();
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      folders: Array.from(this.currentFolders),
      files: Array.from(this.currentFiles),
      mode: this.currentMode,
      display: this.currentDisplay
    };
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
    this.treeNodes.clear();
    this.modeDropdown = null;
  }
};
function openDirectorySelectionModal(app, initialFolders, initialFiles, options, okCallback) {
  new DirectorySelectionModal(
    app,
    initialFolders,
    initialFiles,
    options,
    okCallback
  ).open();
}

// src/rules.ts
var ruleFunctions = [];
function getRuleFunctionById(id) {
  return ruleFunctions.find((rule) => rule.id === id);
}
function applyFormatOptions(value, rule) {
  if (rule.type === "date" || rule.type === "datetime")
    return value;
  switch (typeof value) {
    case "boolean":
    case "number":
      return value;
    case "string":
      if (rule.spaceReplacement && rule.spaceReplacement !== "")
        value = value.replace(/\s+/g, rule.spaceReplacement);
      if (rule.specialCharReplacement && rule.specialCharReplacement !== "")
        value = value.replace(/[^a-zA-Z0-9\-_\/]/g, rule.specialCharReplacement);
      if (rule.lowercaseTags)
        value = value.toLowerCase();
      if (rule.prefix && rule.prefix !== "")
        value = rule.prefix + value;
      if (rule.asLink)
        value = `[[${value}]]`;
      return value;
    case "object":
      if (Array.isArray(value)) {
        return value.map((value2) => applyFormatOptions(value2, rule));
      }
      return value;
  }
  return;
}
function getRuleResult(ruleFx, app, rule, ruleFunction, currentFile, tools, frontMatter) {
  let result = void 0;
  switch (ruleFunction.ruleType) {
    case "script":
    case "buildIn":
      result = applyFormatOptions(ruleFx(app, currentFile, tools), rule);
      break;
    case "buildIn.inputProperty":
      result = applyFormatOptions(ruleFx(app, currentFile, tools, frontMatter[rule.inputProperty]), rule);
      break;
    case "autocomplete.modal":
      ruleFx(app, currentFile, tools);
      result = null;
      break;
    case "automation":
      result = applyFormatOptions(ruleFx(app, currentFile, tools), rule);
      break;
  }
  return result;
}
function executeRule(event, app, settings, currentFile, returnResult, rule, frontMatter, oldPath) {
  if (!rule.active || !currentFile)
    return returnResult;
  const tools = new ScriptingTools(app, this, settings, rule, frontMatter, currentFile);
  let fxResult = returnResult;
  let oldResult;
  let oldFile = void 0;
  if (oldPath) {
    let oldFileParts = oldPath.split("/");
    oldFile = {
      path: oldPath,
      extension: oldFileParts[oldFileParts.length - 1].split(".")[1],
      name: oldFileParts[oldFileParts.length - 1].split(".")[0],
      stat: currentFile.stat,
      basename: currentFile.basename,
      vault: currentFile.vault,
      parent: currentFile.parent
    };
  }
  try {
    const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
    if (functionIndex === -1) {
      console.error(`Rule function ${rule.content} not found!`);
      return returnResult;
    }
    const ruleFunctionConfig = ruleFunctions[functionIndex];
    tools.setCurrentContent(frontMatter[rule.property]);
    tools.setRule(rule);
    tools.setFrontmatter(frontMatter);
    switch (ruleFunctionConfig.ruleType) {
      case "script":
        const customRuleFunction = parseJSCode(rule.jsCode);
        if (typeof customRuleFunction !== "function") {
          console.error(`Could not parse custom function for ${rule.content}!`);
          return;
        }
        fxResult = applyFormatOptions(customRuleFunction(app, currentFile, tools), rule);
        if (oldFile) {
          oldResult = applyFormatOptions(customRuleFunction(app, oldFile, tools), rule);
        }
        break;
      case "buildIn":
        const ruleFunction = rule.useCustomCode ? parseJSCode(rule.buildInCode) : ruleFunctionConfig.fx;
        if (typeof ruleFunction !== "function") {
          console.error(`Could not parse custom function for ${rule.content}!`);
          break;
        }
        fxResult = getRuleResult(ruleFunction, app, rule, ruleFunctionConfig, currentFile, tools, frontMatter);
        if (oldFile) {
          oldResult = getRuleResult(ruleFunction, app, rule, ruleFunctionConfig, oldFile, tools, frontMatter);
        }
        console.log(`executeRule: ${rule.content} ${rule.property} [${rule.type}]= '${fxResult}'`);
        break;
      case "autocomplete.modal":
        fxResult = getRuleResult(ruleFunctionConfig.fx, app, rule, ruleFunctionConfig, currentFile, tools, frontMatter);
        break;
      case "automation":
        fxResult = getRuleResult(ruleFunctionConfig.fx, app, rule, ruleFunctionConfig, currentFile, tools, frontMatter);
        break;
      default:
        break;
    }
  } catch (error) {
    console.error(`Error executing rule ${rule.property}|${rule.content} for file ${currentFile.path}: ${error}`);
    return returnResult;
  }
  if (rule.type === "number" || rule.type === "checkbox" || rule.type === "date" || rule.type === "datetime") {
    return fxResult;
  }
  switch (rule.addContent) {
    case "overwrite":
      returnResult = fxResult;
      break;
    case "end":
      if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
        if (!fxResult)
          fxResult = [];
        if (typeof fxResult === "string")
          fxResult = [fxResult];
        if (!Array.isArray(returnResult))
          returnResult = [returnResult];
        if (!Array.isArray(oldResult))
          oldResult = [oldResult];
        let filtered = returnResult.filter((value) => !oldResult.includes(value));
        returnResult = tools.removeDuplicateStrings(filtered.concat(fxResult));
      } else {
        if (!returnResult)
          returnResult = "";
        returnResult = returnResult.replaceAll(returnResult, oldResult);
        returnResult = returnResult + fxResult;
      }
      break;
    case "start":
      if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
        if (!fxResult)
          fxResult = [];
        if (typeof fxResult === "string")
          fxResult = [fxResult];
        if (!Array.isArray(returnResult))
          returnResult = [returnResult];
        if (!Array.isArray(oldResult))
          oldResult = [oldResult];
        let filtered = returnResult.filter((value) => !oldResult.includes(value));
        returnResult = tools.removeDuplicateStrings(fxResult.concat(filtered));
      } else {
        if (!returnResult)
          returnResult = "";
        returnResult = returnResult.replaceAll(returnResult, oldResult);
        returnResult = fxResult + returnResult;
      }
      break;
  }
  return returnResult;
}
function removeRule(app, settings, currentFile, returnResult, rule, frontMatter) {
  const tools = new ScriptingTools(app, settings, frontMatter);
  let fxResult;
  if (rule.content === "script") {
    const ruleFunction = parseJSCode(rule.jsCode);
    if (typeof ruleFunction !== "function")
      return;
    fxResult = ruleFunction(app, currentFile, tools);
  } else {
    const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
    if (functionIndex !== -1) {
      const ruleFunction = rule.useCustomCode ? parseJSCode(rule.buildInCode) : ruleFunctions[functionIndex].fx;
      if (typeof ruleFunction !== "function") {
        console.error(`Could not parse custom function for ${rule.content}!`);
        return;
      }
      if (ruleFunctions[functionIndex].inputProperty) {
        fxResult = applyFormatOptions(ruleFunction(app, currentFile, tools, frontMatter[rule.inputProperty]), rule);
      } else {
        fxResult = applyFormatOptions(ruleFunction(app, currentFile, tools), rule);
      }
    }
  }
  switch (rule.addContent) {
    case "overwrite":
      returnResult = fxResult;
      break;
    case "end":
      if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
        if (!fxResult)
          fxResult = [];
        if (typeof fxResult === "string")
          fxResult = [fxResult];
        if (!Array.isArray(returnResult))
          returnResult = [returnResult];
        if (!Array.isArray(fxResult))
          fxResult = [fxResult];
        let filtered = returnResult.filter((value) => !fxResult.includes(value));
        returnResult = tools.removeDuplicateStrings(filtered);
      } else {
        if (!returnResult)
          returnResult = "";
        returnResult = returnResult.replaceAll(returnResult, fxResult);
      }
      break;
    case "start":
      if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
        if (!fxResult)
          fxResult = [];
        if (typeof fxResult === "string")
          fxResult = [fxResult];
        if (!Array.isArray(returnResult))
          returnResult = [returnResult];
        if (!Array.isArray(fxResult))
          fxResult = [fxResult];
        let filtered = returnResult.filter((value) => !fxResult.includes(value));
        returnResult = tools.removeDuplicateStrings(filtered);
      } else {
        if (!returnResult)
          returnResult = "";
        returnResult = returnResult.replaceAll(returnResult, fxResult);
      }
      break;
  }
  return returnResult;
}
function filterFile(file, fileList, filterMode, type) {
  let result = false;
  const filterArray = type === "folders" ? fileList[filterMode].selectedFolders : fileList[filterMode].selectedFiles;
  if (filterArray.length === 0)
    return filterMode === "include" ? false : true;
  const filePath = file.path;
  const fileFolder = getFolderFromPath(file.path);
  const fileName = file.basename + "." + file.extension;
  if (type === "files") {
    result = filterArray.includes(filePath);
  }
  if (type === "folders") {
    for (let path of filterArray) {
      result = (fileFolder == null ? void 0 : fileFolder.startsWith(path.slice(1))) || false;
      if (result === true)
        return filterMode === "exclude" ? !result : result;
      ;
    }
    ;
  }
  ;
  return filterMode === "exclude" ? !result : result;
}
function checkIfFileAllowed(file, settings, rule) {
  let result = true;
  if (!file)
    return false;
  if (settings && !rule) {
    try {
      if (settings.exclude.selectedFiles.length > 0) {
        result = filterFile(file, settings, "exclude", "files");
      }
      if (settings.exclude.selectedFolders.length > 0) {
        result = filterFile(file, settings, "exclude", "folders");
      }
      if (settings.include.selectedFiles.length > 0) {
        result = filterFile(file, settings, "include", "files");
      }
      if (settings.include.selectedFolders.length > 0) {
        result = filterFile(file, settings, "include", "folders");
      }
    } catch (error) {
      console.error(`Error filtering file ${file.path} globally: ${error}`);
      return false;
    }
  }
  if (rule) {
    try {
      if (rule.exclude.selectedFiles.length > 0) {
        result = filterFile(file, rule, "exclude", "files");
      }
      if (rule.exclude.selectedFolders.length > 0) {
        result = filterFile(file, rule, "exclude", "folders");
      }
      if (rule.include.selectedFiles.length > 0) {
        result = filterFile(file, rule, "include", "files");
      }
      if (rule.include.selectedFolders.length > 0) {
        result = filterFile(file, rule, "include", "folders");
      }
    } catch (error) {
      console.error(`Error filtering file ${file.path} by rule ${rule.property}|${rule.content}: ${error}`);
      return false;
    }
  }
  return result;
}
function defaultConfigElements(modifiers) {
  const configElements = {
    removeContent: true,
    ruleActive: true,
    modifyOnly: true,
    inputProperty: false,
    addPrefix: true,
    spaceReplacement: true,
    specialCharacterReplacement: true,
    convertToLowerCase: true,
    resultAsLink: true,
    addContent: true,
    excludeFolders: true,
    includeFolders: true,
    script: true
  };
  return Object.assign({}, configElements, modifiers);
}
function useRuleOption(ruleFn, option) {
  if ((ruleFn == null ? void 0 : ruleFn.configElements[option]) === void 0)
    return true;
  return ruleFn.configElements[option];
}
ruleFunctions.push({
  id: "default",
  ruleType: "buildIn",
  description: "Pass parameter",
  source: "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}",
  type: ["text"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let result = "";
    return result;
  }
});
ruleFunctions.push({
  id: "fullPath",
  ruleType: "buildIn",
  description: "Full path, filename",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases", "multitext"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    parts.push(file.basename);
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "fullPathExt",
  ruleType: "buildIn",
  description: "Full path, filename and Extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const result = file.path;\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    return `${file.path}`;
  }
});
ruleFunctions.push({
  id: "path",
  ruleType: "buildIn",
  description: "Full Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "linkToFile",
  ruleType: "buildIn",
  description: "Link to file",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases", "multitext"],
  configElements: defaultConfigElements({ resultAsLink: false }),
  fx: function(app, file, tools) {
    const parts = file.path.split("/");
    const rule = tools.getRule();
    if (!rule)
      return tools.getCurrentContent();
    const addExtension = tools.getOptionConfig(rule.id, "addExtension");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    let fileName = addExtension ? file.basename + "." + file.extension : file.basename;
    return `[[${parts.join("/")}/${fileName}|${file.basename}]]`;
  },
  configTab: function(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      addExtension: true
    });
    new import_obsidian10.Setting(optionEL).setName("Include file extension").setDesc("Add file extension to pathname").addToggle(
      (toggle) => toggle.setValue(that.getOptionConfig(rule.id, "addExtension") || false).onChange(async (value) => {
        that.setOptionConfig(rule.id, "addExtension", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
});
ruleFunctions.push({
  id: "pathFolderNotes",
  ruleType: "buildIn",
  description: "Path (folder notes)",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases", "multitext"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "fullPathFolderNotes",
  ruleType: "buildIn",
  description: 'Full Path (comply with "folder notes")',
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    parts.push(file.basename);
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "fullPathExtFolderNotes",
  ruleType: "buildIn",
  description: 'Full Path with Extension (comply with "folder notes")',
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    parts.push(file.name);
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "isRoot",
  ruleType: "buildIn",
  description: "File in Root folder",
  source: "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  return parts.length === 1;\n}",
  type: ["checkbox"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    return parts.length === 1;
  }
});
ruleFunctions.push({
  id: "folder",
  ruleType: "buildIn",
  description: "Parent Folder",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[parts.length-2];\n  }\n  return result;\n}",
  type: ["text", "tags"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[parts.length - 2];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "folderFolderNotes",
  ruleType: "buildIn",
  description: 'Parent Folder (complies with "folder notes")',
  source: "function (app, file, tools) { // do not change this line!\n  const parts = file.path.split('/');\n  let index = parts.length-2; // index of parent folder\n  if (parts[parts.length-2]===file.basename) {\n      index--; // folder note parent is the child\n  }\n  if (index >= 0) {\n    return parts[index]; // file in folder\n  } else {\n    return tools.app?.vault?.getName() || 'Vault'; // file in root = vault\n  }\n}",
  type: ["text", "tags"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    var _a, _b;
    const parts = file.path.split("/");
    let index = parts.length - 2;
    if (parts[parts.length - 2] === file.basename) {
      index--;
    }
    if (index >= 0) {
      return parts[index];
    } else {
      return ((_b = (_a = tools.app) == null ? void 0 : _a.vault) == null ? void 0 : _b.getName()) || "Vault";
    }
  }
});
ruleFunctions.push({
  id: "folders",
  ruleType: "buildIn",
  description: "All folders of the file as a list",
  source: "function (app, file, tools) { // do not change this line!\n  const path = file.path; // acquire file path\n  const result = path.split('/');\n  result.pop(); // remove file name\n  return result;\n}",
  type: ["multitext", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const path = file.path;
    const result = path.split("/");
    result.pop();
    return result;
  }
});
ruleFunctions.push({
  id: "rootFolder",
  ruleType: "buildIn",
  description: "Root folder",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[0];\n  }\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[0];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "name",
  ruleType: "buildIn",
  description: "File name without extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name.split('.');\n  result.pop(); // remove extension\n  result.join('.'); // reconstruct the file name\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const result = file.name.split(".");
    result.pop();
    result.join(".");
    return result;
  }
});
ruleFunctions.push({
  id: "nameExt",
  ruleType: "buildIn",
  description: "File name with extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name;\n  return result;\n}",
  type: ["text", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const result = file.name;
    return result;
  }
});
ruleFunctions.push({
  id: "getProperty",
  ruleType: "buildIn.inputProperty",
  description: "Get a property",
  isLiveRule: true,
  inputProperty: true,
  source: "function (app, file, tools) { // do not change this line!\n  const result = input;\n  return result;\n}",
  type: ["text", "multitext", "tags", "aliases"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools, input) {
    const result = input;
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeCreated",
  ruleType: "buildIn",
  description: "Date (and Time) created",
  source: "function (app, file, tools) { // do not change this line!\n  const timeOffset = new Date(Date.now()).getTimezoneOffset()*60000; // get local time offset\n  const result = new Date(file.stat.ctime-timeOffset);\n  return result.toISOString().split('Z')[0]; // remove UTC symbol\n}",
  type: ["date", "datetime"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const timeOffset = new Date(Date.now()).getTimezoneOffset() * 6e4;
    const result = new Date(file.stat.ctime - timeOffset);
    return result.toISOString().split("Z")[0];
  }
});
ruleFunctions.push({
  id: "dateTimeModified",
  ruleType: "buildIn",
  description: "Date (and Time) modified",
  source: "function (app, file, tools) { // do not change this line!\n  const timeOffset = new Date(Date.now()).getTimezoneOffset()*60000;\n  const result = new Date(file.stat.mtime-timeOffset); // Apply offset to GMT Timestamp\n  return result.toISOString().split('Z')[0]; // remove UTC symbol\n}",
  type: ["date", "datetime"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const timeOffset = new Date(Date.now()).getTimezoneOffset() * 6e4;
    const result = new Date(file.stat.mtime - timeOffset);
    return result.toISOString().split("Z")[0];
  }
});
ruleFunctions.push({
  id: "fileSizeBytes",
  ruleType: "buildIn",
  description: "File size in bytes",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  const result = file.stat.size;\n  return result; // return you result.\n}",
  type: ["number"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    const result = file.stat.size;
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeString",
  ruleType: "buildIn",
  description: "File size formatted as text",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  let size =file.stat.size;\n  const precision = 2; // number of decimal places\n  if (size > 1024) {\n    size = size / 1024;\n    if (size > 1024) {\n      size = size / 1024;\n      if (size > 1024) {\n        size = size / 1024;\n        return Number.parseFloat(size).toFixed(precision) + ' GB';\n      } \n      return Number.parseFloat(size).toFixed(precision) + ' MB';\n    }\n    return Number.parseFloat(size).toFixed(precision) + ' KB';\n  }   \n  return size + ' Bytes'; // return you result.\n}",
  type: ["text"],
  configElements: defaultConfigElements({}),
  fx: function(app, file, tools) {
    let size = file.stat.size;
    const precision = 2;
    if (size > 1024) {
      size = size / 1024;
      if (size > 1024) {
        size = size / 1024;
        if (size > 1024) {
          size = size / 1024;
          return size.toFixed(precision) + " GB";
        }
        return size.toFixed(precision) + " MB";
      }
      return size.toFixed(precision) + " KB";
    }
    return size + " Bytes";
  }
});
ruleFunctions.push({
  id: "autocomplete.modal",
  ruleType: "autocomplete.modal",
  description: "Autocomplete Modal (advanced)",
  isLiveRule: true,
  source: "",
  type: ["text", "tags", "aliases", "multitext"],
  configElements: defaultConfigElements({ removeContent: false, inputProperty: false, addPrefix: false, spaceReplacement: false, specialCharacterReplacement: false, convertToLowerCase: false, resultAsLink: false, addContent: false, script: false }),
  fx: async function(app, file, tools) {
    console.log(`autocomplete modal, work in progress...`);
    const currentContent = tools.getCurrentContent();
    const rule = tools.getRule();
    if (!rule)
      return currentContent;
    const options = tools.getOptionConfig(rule.id);
    if (!rule)
      return tools.getCurrentContent() || "autocomplete.modal";
    const frontmatter = tools.getFrontmatter();
    const hasAutocompleteProperties = Object.keys(frontmatter).some(
      (key) => key.startsWith(rule.property + options.propertyDelimiter) && (frontmatter[key] === void 0 || frontmatter[key] === null || frontmatter[key] === "")
    );
    if (!hasAutocompleteProperties)
      return tools.getCurrentContent() || "autocomplete.modal";
    const result = await openAutocompleteModal(
      this.app,
      this.plugin,
      rule,
      options,
      tools.getActiveFile(),
      tools.getFrontmatter()
    );
    console.log("autocomplete modal result", result, tools.getFrontmatter());
    if (result == null ? void 0 : result.values) {
      this.app.fileManager.processFrontMatter(file, (frontmatter2) => {
        for (const [key, value] of Object.entries(result.values)) {
          frontmatter2[key] = value;
        }
      }, { "mtime": file.stat.mtime });
    }
    return tools.getCurrentContent() || "autocomplete.modal";
  },
  configTab: function(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      propertyDelimiter: "."
    });
    new import_obsidian10.Setting(optionEL).setName("Delimiter").setDesc("Character to determine which property should appear in the modal").addText((text) => text.setValue(that.getOptionConfig(rule.id, "propertyDelimiter") || ".").onChange(async (value) => {
      that.setOptionConfig(rule.id, "propertyDelimiter", value);
    }));
  }
});
ruleFunctions.push({
  id: "autoLink",
  ruleType: "automation",
  description: "Auto Link (advanced)",
  isLiveRule: true,
  source: "",
  type: ["text", "multitext"],
  configElements: defaultConfigElements({ removeContent: false, inputProperty: false, addPrefix: false, spaceReplacement: false, specialCharacterReplacement: false, convertToLowerCase: false, resultAsLink: false, script: false }),
  fx: async function(app, file, tools) {
    const currentContent = tools.getCurrentContent();
    let newContent = new Array();
    const rule = tools.getRule();
    if (!rule) {
      console.error(`autoLink: rule not found, returning current content ${currentContent}`);
      return currentContent;
    }
    const options = tools.getOptionConfig(rule.id);
    const filesToCheck = tools.getFilesInVault(options.destinationFolder);
    let links = currentContent || [];
    if (typeof links === "object" && !Array.isArray(links)) {
      links = [];
    } else if (typeof links === "string") {
      links = [links];
    }
    for (const part of links) {
      let link = tools.extractLinkParts(part);
      let linkFile = tools.getFileFromPath(link.path, filesToCheck);
      if (!linkFile) {
        if (options.askConfirmation) {
          const result = await new AlertModal(app, "Create new file", `File ${link.path} does not exist. Do you want to create it?`, "Create", "Cancel", "Don't ask again.").openAndGetValue();
          if (!result.proceed)
            return;
          options.askConfirmation = !result.data.askConfirmation;
        }
        link.path = options.destinationFolder + "/" + link.title + ".md";
        linkFile = await tools.createFileFromPath(link.path, options.addTemplate ? options.templateFile : void 0);
        tools.updateFrontmatter(rule.property, [`[[${tools.removeLeadingSlash(link.path)}|${link.title}]]`], linkFile);
      } else {
      }
      if (linkFile) {
        link.path = linkFile.path;
        newContent.push(`[[${tools.removeLeadingSlash(link.path)}|${link.title}]]`);
      }
    }
    tools.updateFrontmatter(rule.property, newContent);
    return newContent;
  },
  configTab: function(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      addTemplate: true,
      askConfirmation: true,
      destinationFolder: "/",
      templateFile: ""
    });
    new import_obsidian10.Setting(optionEL).setName("Add template to new files").setDesc("Automatically add template to new files").addToggle((toggle) => toggle.setValue(that.getOptionConfig(rule.id, "addTemplate") || false).onChange(async (value) => {
      that.setOptionConfig(rule.id, "addTemplate", value);
    }));
    new import_obsidian10.Setting(optionEL).setName("Ask for confirmation").setDesc("Ask for confirmation before creating new files").addToggle((toggle) => toggle.setValue(that.getOptionConfig(rule.id, "askConfirmation") || false).onChange(async (value) => {
      that.setOptionConfig(rule.id, "askConfirmation", value);
    }));
    let destinationFolderEl;
    new import_obsidian10.Setting(optionEL).setName("Destination Folder").setDesc("Folder to place new files").addSearch((cb) => {
      destinationFolderEl = cb;
      new FolderSuggest(that.app, cb.inputEl);
      cb.setPlaceholder("enter folder or browse ...").setValue(that.getOptionConfig(rule.id, "destinationFolder") || "").onChange((newFolder) => {
        newFolder = newFolder.trim();
        newFolder = newFolder.replace(/\/$/, "");
        that.setOptionConfig(rule.id, "destinationFolder", newFolder);
      });
      cb.containerEl.addClass("frontmatter-automate-search");
    }).addExtraButton(
      (button) => button.setIcon("folder-tree").setTooltip("Select template folder").onClick(async () => {
        openDirectorySelectionModal(
          that.app,
          [that.getOptionConfig(rule.id, "destinationFolder")],
          [],
          {
            title: "Select folder to place new files",
            selectionMode: "include",
            displayMode: "folder",
            optionSelectionMode: false,
            optionShowFiles: false
          },
          (result) => {
            if (!result)
              return;
            if (result.folders.length === 0 || !result.folders[0] || typeof result.folders[0] !== "string")
              return;
            let selectedFolder = result.folders[0].trim().replace(/\/$/, "");
            if (selectedFolder === "")
              selectedFolder = "/";
            if (!selectedFolder)
              return;
            destinationFolderEl.setValue(selectedFolder);
            that.setOptionConfig(rule.id, "destinationFolder", selectedFolder);
          }
        );
      })
    );
    let destinationFileEl;
    new import_obsidian10.Setting(optionEL).setName("Template File").setDesc("Select a template file to add to new files").addSearch((cb) => {
      destinationFileEl = cb;
      new FileSuggest(cb.inputEl, that.plugin, "");
      cb.setPlaceholder("enter folder or browse ...").setValue(that.getOptionConfig(rule.id, "templateFile") || "").onChange((newFile) => {
        newFile = newFile.trim();
        newFile = newFile.replace(/\/$/, "");
        that.setOptionConfig(rule.id, "templateFile", newFile);
      });
      cb.containerEl.addClass("frontmatter-automate-search");
    }).addExtraButton(
      (button) => button.setIcon("folder-tree").setTooltip("Select template file").onClick(async () => {
        openDirectorySelectionModal(
          that.app,
          [],
          [that.getOptionConfig(rule.id, "templateFile")],
          {
            title: "Select template for new files",
            selectionMode: "include",
            displayMode: "file",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            if (result.files.length === 0 || !result.files[0] || typeof result.files[0] !== "string")
              return;
            let selectedFile = result.files[0].trim().replace(/\/$/, "");
            if (!selectedFile)
              return;
            destinationFileEl.setValue(selectedFile);
            that.setOptionConfig(rule.id, "templateFile", selectedFile);
          }
        );
      })
    );
  }
});

// src/tools.ts
function parseJSCode(jsCode) {
  function parseFunction(jsCode2) {
    try {
      jsCode2 = cleanCodeString(jsCode2);
      var funcReg = /function *\(([^()]*)\)[ \n\t]*{(.*)}/gmi;
      var match = funcReg.exec(jsCode2.replace(/\n/g, " "));
      if (!match)
        return void 0;
      var args = match[1].split(",");
      args.push(match[2]);
      return new Function(...args);
    } catch (error) {
      console.error("error parsing JS function!", error);
      return error.message;
    }
  }
  ;
  return parseFunction(jsCode);
}
function cleanCodeString(codeString) {
  if (typeof codeString !== "string") {
    throw new TypeError("Input must be a string.");
  }
  let inMultiLineComment = false;
  let inSingleLineComment = false;
  let inString = null;
  let inRegExp = false;
  let cleanedCode = "";
  let i = 0;
  while (i < codeString.length) {
    const char = codeString[i];
    const nextChar = codeString[i + 1];
    if (inMultiLineComment) {
      if (char === "*" && nextChar === "/") {
        inMultiLineComment = false;
        i += 2;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inSingleLineComment) {
      if (char === "\n" || char === "\r") {
        inSingleLineComment = false;
        cleanedCode += char;
        i++;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inString) {
      if (char === inString) {
        inString = null;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (inRegExp) {
      if (char === "/") {
        inRegExp = false;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/" && nextChar === "*") {
      inMultiLineComment = true;
      i += 2;
      continue;
    }
    if (char === "/" && nextChar === "/") {
      inSingleLineComment = true;
      i += 2;
      continue;
    }
    if (char === '"' || char === "'") {
      inString = char;
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/") {
      const prevMeaningfulChar = cleanedCode.trim().slice(-1);
      if (prevMeaningfulChar === "" || ["(", ",", "=", ":", "[", "!", "&", "|", "?", "{", ";", "\n", "\r"].includes(prevMeaningfulChar)) {
        inRegExp = true;
        cleanedCode += char;
        i++;
        continue;
      }
    }
    cleanedCode += char;
    i++;
  }
  return cleanedCode;
}
function resolveFolder(app, folder_str) {
  folder_str = (0, import_obsidian11.normalizePath)(folder_str);
  const folder = app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new ErrorManager(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian11.TFolder)) {
    throw new ErrorManager(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function getFilesFromFolder(app, folder_str) {
  const folder = resolveFolder(app, folder_str);
  const files = [];
  import_obsidian11.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian11.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.path.localeCompare(b.path);
  });
  return files;
}
var ScriptingTools = class {
  constructor(app, plugin, settings, rule, frontmatter, activeFile) {
    this.app = app;
    this.plugin = plugin;
    this.settings = settings;
    this.rule = rule;
    this.frontmatter = frontmatter;
    this.activeFile = activeFile;
  }
  getFrontmatter() {
    return this.frontmatter;
  }
  setFrontmatter(frontmatter) {
    this.frontmatter = frontmatter;
  }
  setFrontmatterProperty(key, value) {
    if (!this.frontmatter)
      this.frontmatter = {};
    this.frontmatter[key] = value;
  }
  getFrontmatterProperty(key) {
    return this.frontmatter[key];
  }
  setActiveFile(file) {
    this.activeFile = file;
  }
  getActiveFile() {
    return this.activeFile;
  }
  setRule(rule) {
    this.rule = rule;
  }
  getRule() {
    return this.rule;
  }
  getRuleFunction(rule) {
    if (!rule)
      rule = this.rule;
    if (rule) {
      const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
      if (functionIndex !== -1) {
        return ruleFunctions[functionIndex];
      }
    }
  }
  setCurrentContent(content) {
    this.currentContent = content;
  }
  getCurrentContent() {
    return this.currentContent;
  }
  updateFrontmatter(property, newContent, file) {
    if (!this.app)
      return;
    if (!file)
      file = this.activeFile;
    if (!file)
      return;
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      console.log(`updateFrontmatter '${file.path}' frontmatter '${property}' to '${newContent.toString()}'`);
      if (typeof newContent === "object" && !Array.isArray(newContent)) {
        console.warn(`updateFrontmatter '${file.path}'|'${property}' object not supported!`);
      } else {
        frontmatter[property] = newContent;
      }
    }, { "mtime": file.stat.mtime });
  }
  async showConfirmDialog(message, title = "Confirm", button1 = "Yes", button2 = "No") {
    const result = await new AlertModal(this.app, title, message, button1, button2).openAndGetValue();
    return result.proceed;
  }
  /**
   * * Get the option config for a specific rule. Optional the specific parameter by providing an option ID.
   *
   * @param {string} ruleId
   * @param {string} [optionId]
   * @return {*} 
   * @memberof ScriptingTools
   */
  getOptionConfig(ruleId, optionId) {
    if (!ruleId || ruleId === void 0 || !this.settings)
      return void 0;
    const rule = this.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule && rule.hasOwnProperty("optionsConfig")) {
      const optionConfig = rule.optionsConfig[ruleId];
      if (optionConfig) {
        if (optionId) {
          return optionConfig[optionId];
        } else {
          return optionConfig;
        }
      }
    }
    return void 0;
  }
  getFilesInVault(matching) {
    matching = matching.replace(/^\/|\/$/g, "") + "/";
    const files = this.app.vault.getMarkdownFiles();
    const matchingFiles = files.filter((file) => file instanceof import_obsidian11.TFile && file.path.includes(matching));
    return matchingFiles;
  }
  getFileFromPath(path, filesCheck) {
    const files = filesCheck ? filesCheck : this.app.vault.getMarkdownFiles();
    const matchingFiles = files.filter(
      (file) => file instanceof import_obsidian11.TFile && file.path.toLocaleLowerCase().includes(path.toLocaleLowerCase())
    );
    return matchingFiles.length > 0 ? matchingFiles[0] : void 0;
  }
  async createFileFromPath(fileNameWithPath, templateFileWithPath) {
    const fileName = fileNameWithPath.replace(/^\/|\/$/g, "");
    const templateFile = templateFileWithPath.replace(/^\/|\/$/g, "");
    const folderPath = this.getFolderFromPath(fileName);
    const fileNameOnly = fileName.split("/").pop() || fileName;
    if (!folderPath) {
      throw new ErrorManager(`Invalid folder path: "${folderPath}"`);
    }
    const folder = this.app.vault.getAbstractFileByPath(folderPath);
    if (!folder) {
      throw new ErrorManager(`Folder "${folderPath}" doesn't exist`);
    }
    if (!(folder instanceof import_obsidian11.TFolder)) {
      throw new ErrorManager(`${folderPath} is a file, not a folder`);
    }
    const templateContent = await this.app.vault.read(this.app.vault.getAbstractFileByPath(templateFile));
    const fileExists = this.app.vault.getAbstractFileByPath(fileNameWithPath);
    if (!fileExists) {
      return await this.app.vault.create(folder.path + "/" + fileNameOnly, templateContent);
    }
    return fileExists;
  }
  // create the file if it does not exist
  /**
   * * Fetches custom property information from all markdown files in the vault.
   *
   * @return {*} 
   */
  fetchCustomPropertyInfos(app) {
    const propertyInfos = {};
    const files = app.vault.getMarkdownFiles();
    files.forEach((file) => {
      const metadata = app.metadataCache.getFileCache(file);
      if (metadata == null ? void 0 : metadata.frontmatter) {
        Object.keys(metadata.frontmatter).forEach((key) => {
          if (!propertyInfos[key]) {
            propertyInfos[key] = { name: key, type: "text" };
          }
        });
      }
    });
    return propertyInfos;
  }
  /**
   * Fetches known properties from the metadata cache.
   * If the method getAllPropertyInfos is not available, it falls back to fetchCustomPropertyInfos.
   * @param app The Obsidian app instance.
   */
  async fetchKnownProperties(app) {
    let propertyInfos = {};
    if (typeof app.metadataCache.getAllPropertyInfos === "function") {
      propertyInfos = app.metadataCache.getAllPropertyInfos();
    } else {
      propertyInfos = this.fetchCustomPropertyInfos(app);
    }
    propertyInfos = Object.fromEntries(
      Object.entries(propertyInfos).sort(([keyA], [keyB]) => keyA.localeCompare(keyB))
    );
    this.knownProperties = {};
    Object.keys(propertyInfos).forEach((key) => {
      this.knownProperties[propertyInfos[key].name] = propertyInfos[key];
    });
    console.log(this.knownProperties);
    return this.knownProperties;
  }
  getKnownProperties() {
    if (!this.knownProperties) {
      this.knownProperties = this.fetchCustomPropertyInfos(this.app);
    }
    return this.knownProperties;
  }
  extractLinkParts(link) {
    const cleanedLink = link.replace(/[\[\]]/g, "");
    const parts = cleanedLink.split("|");
    const path = parts[0].trim();
    const title = parts.length > 1 ? parts[1].trim() : path;
    return { path, title };
  }
  removeLeadingSlash(path) {
    return path.replace(/^\/+/, "");
  }
  addLeadingSlash(path) {
    return path.replace(/^(?!\/)/, "/");
  }
  /**
   * Check if a string complies with ISO Standard
   * 
   * @param str Any string
   * @param options Options to look for
   * @returns 
   */
  isISOString(str, options = {}) {
    const {
      withMilliseconds = false,
      withTimezone = false,
      withTime = true,
      withDate = true
    } = options;
    let dateRegexStr = "^(?:\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01]))";
    let timeRegexStr = "(?:T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
    if (withMilliseconds) {
      timeRegexStr += "\\.\\d{3}";
    }
    if (withTimezone) {
      timeRegexStr += "(?:Z|[+-](?:[01]\\d|2[0-3]):[0-5]\\d)?)?";
    } else {
      timeRegexStr += ")?";
    }
    let regexStr = "";
    if (withDate && withTime) {
      regexStr = `${dateRegexStr}${timeRegexStr}$`;
    } else if (withDate) {
      regexStr = `${dateRegexStr}$`;
    } else if (withTime) {
      regexStr = `^${timeRegexStr.slice(4)}$`;
    } else {
      return false;
    }
    const regex = new RegExp(regexStr);
    return regex.test(str);
  }
  /**
   * Try to convert Any Types to a specific Type
   * @param input 
   * @param typeString 'string' | 'number' | 'boolean' | 'string[]'
   * @returns 
   */
  tryConvert(input, typeString) {
    switch (typeString) {
      case "string":
        if (typeof input === "string") {
          return input;
        }
        return void 0;
      case "number":
        const num = Number(input);
        if (!isNaN(num)) {
          return num;
        }
        return void 0;
      case "boolean":
        if (typeof input === "boolean") {
          return input;
        }
        if (typeof input === "string") {
          const lowerValue = input.toLowerCase();
          if (lowerValue === "true") {
            return true;
          }
          if (lowerValue === "false") {
            return false;
          }
        }
        if (typeof input === "number") {
          if (input === 1) {
            return true;
          }
          if (input === 0) {
            return false;
          }
        }
        return void 0;
      case "string[]":
        if (Array.isArray(input) && input.every((item) => typeof item === "string")) {
          return input;
        }
        return void 0;
      default:
        return void 0;
    }
  }
  formatToYAMLSaveString(text, replaceBy = void 0) {
    let replaceString = "-";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.specialCharReplacement || "-";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/[^a-zA-Z0-9\-_\/]/g, replaceString);
  }
  /**
   * Converts a string to a YAML-safe format by adding quotes when necessary.
   * @param input The string, boolean, number or array to make YAML-safe
   * @returns The safely quoted string when needed, or the original string if safe
   */
  toYamlSafeString(input) {
    if (Array.isArray(input)) {
      input.forEach((item, index) => {
        input[index] = this.toYamlSafeString(item).toString();
      });
      return input;
    }
    switch (typeof input) {
      case "number":
        return input;
      case "boolean":
        return input ? "true" : "false";
      case "string":
        const trimmed = input.trim();
        if (trimmed === "")
          return '""';
        const needsQuotes = /[:{}\[\],&*#?|<>=!%@`"'\\]|^[-?\n]|[\s\n]|^[yYnN]|^[0-9]|^[+-]|^(true|false|yes|no|on|off)$/i.test(trimmed);
        const isAlreadyQuoted = trimmed.startsWith('"') && trimmed.endsWith('"') || trimmed.startsWith("'") && trimmed.endsWith("'");
        if (!needsQuotes && !isAlreadyQuoted) {
          return trimmed;
        }
        if (!isAlreadyQuoted) {
          return `"${trimmed.replace(/"/g, '\\"')}"`;
        }
        return trimmed;
      default:
        console.error(`toYamlSafeString(${input}) if of type '${typeof input}'`);
        return input;
    }
  }
  replaceSpaces(text, replaceBy = void 0) {
    let replaceString = "_";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.spaceReplacement || "_";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/\s+/g, replaceString);
  }
  formatCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      if (index > 0)
        newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  formatUpperCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  /**
   * get the path to a file from a string containing the full parh/name string
   * @param path string
   * @param separator string defaults to '/'
   * @returns string
   */
  getFolderFromPath(path, separator = "/") {
    if (path === null)
      return null;
    if (path === void 0)
      return void 0;
    const currentPathParts = path.split("/");
    currentPathParts.pop();
    return currentPathParts.join(separator);
  }
  /**
   * removes duplicate strings in an array and deletes empty strings
   * @param stringArray 
   * @returns 
   */
  removeDuplicateStrings(stringArray) {
    if (!stringArray)
      return [];
    const uniqueStringsSet = new Set(stringArray);
    uniqueStringsSet.delete("");
    return [...uniqueStringsSet];
  }
};
function getFolderFromPath(path, separator = "/") {
  if (path === null)
    return null;
  if (path === void 0)
    return void 0;
  const currentPathParts = path.split("/");
  currentPathParts.pop();
  return currentPathParts.join(separator);
}

// src/types.ts
var versionString = "0.0.17";
var DEFAULT_FILTER_FILES_AND_FOLDERS = {
  selectedFolders: [],
  selectedFiles: [],
  mode: "exclude",
  display: "folders"
};
var DEFAULT_SETTINGS = {
  tagPrefix: "",
  excludeRootFolder: false,
  tagsPropertyName: "tags",
  spaceReplacement: "_",
  specialCharReplacement: "_",
  lowercaseTags: false,
  knownProperties: [],
  rules: [],
  liveRules: [],
  useTextArea: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folders"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folders"
  },
  configuredProperties: []
};
var DEFAULT_RULE_DEFINITION = {
  id: "",
  active: true,
  asLink: false,
  addContent: "overwrite",
  property: "",
  value: "",
  customProperty: "",
  type: "text",
  typeProperty: { name: "", type: "text", source: "registered" },
  content: "",
  buildInCode: "",
  jsCode: "",
  showContent: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folders"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folders"
  },
  prefix: "",
  spaceReplacement: "",
  specialCharReplacement: "",
  lowercaseTags: false,
  inputProperty: "",
  onlyModify: true,
  useCustomCode: false
};

// src/settings-properties.ts
var import_obsidian13 = require("obsidian");
var import_crypto = require("crypto");

// src/editorModal.ts
var import_obsidian12 = require("obsidian");
var codeEditorModal = class extends import_obsidian12.Modal {
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param plugin - The plugin instance.
   * @param initialCode - String with the initial code.
   * @param expectedType - Expected return type.
   * @param activeFile - The currently active file or folder.
   * @param frontmatter - Frontmatter data for the active file.
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, plugin, initialCode, expectedType, activeFile, frontmatter, okCallback) {
    super(app);
    this.initialCode = initialCode;
    this.expectedType = expectedType;
    this.useTextArea = false;
    this.checkedSuccessfully = false;
    this.activeFile = activeFile;
    this.frontmatter = frontmatter;
    this.currentType = expectedType;
    this.currentCode = initialCode;
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(app, this.plugin, this.frontmatter);
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    var _a;
    this.currentCode = this.initialCode;
    (_a = this.cmEditor) == null ? void 0 : _a.setValue(this.currentCode);
    if (this.functionResultTextComponent)
      this.functionResultTextComponent.setValue("");
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    var _a;
    this.currentCode = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    (_a = this.cmEditor) == null ? void 0 : _a.setValue(this.currentCode);
    if (this.functionResultTextComponent)
      this.functionResultTextComponent.setValue("");
  }
  loadCodeMirrorMode(mode) {
    try {
      require(`obsidian/lib/codemirror/mode/${mode}/${mode}.js`);
      console.log(`CodeMirror mode '${mode}' loaded successfully (using require).`);
    } catch (error) {
      console.error(`Failed to load CodeMirror mode '${mode}' (using require):`, error);
    }
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  async onOpen() {
    const { contentEl } = this;
    if (contentEl.parentElement)
      contentEl.parentElement.style.width = "900px";
    contentEl.empty();
    contentEl.addClass("codeEditor-modal");
    contentEl.createEl("h2", { text: "JavaScript Editor" });
    contentEl.createEl("body", { text: `Make sure your code results: ${this.expectedType}` });
    this.editorRootElement = contentEl.createDiv({ cls: "codeEditor-container" });
    this.editorRootElement.style.height = "600px";
    this.editorRootElement.style.overflowY = "auto";
    this.editorRootElement.style.padding = "10px";
    this.editorRootElement.style.marginTop = "10px";
    this.editorRootElement.style.marginBottom = "10px";
    this.cmEditor = null;
    const ruleOptionsDiv = contentEl.createDiv({ cls: "codeEditor-options" });
    if (this.useTextArea) {
      const ruleOptionsSettings = new import_obsidian12.Setting(this.editorRootElement).addTextArea((textArea) => {
        textArea.setPlaceholder("ender valid JS Code");
        textArea.inputEl.setAttribute("style", `height:190px; width:80%;`);
        textArea.onChange(async (value) => {
          if (this.functionTestButton)
            this.functionTestButton.buttonEl.addClass("mod-warning");
          this.currentCode = value;
        });
      });
    } else {
      const CodeMirror = window.CodeMirror;
      if (CodeMirror) {
        if (!CodeMirror.modes.javascript) {
          await this.loadCodeMirrorMode("javascript");
          console.log("javaScript support loaded");
        }
      }
      let jsCode = this.currentCode;
      this.cmEditor = CodeMirror(this.editorRootElement, {
        value: jsCode || "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result; // return you result.\n}",
        mode: "javascript",
        lineNumbers: true,
        theme: "obsidian",
        indentUnit: 4,
        lineWrapping: false,
        readOnly: false,
        outerHeight: "600px"
      });
      if (this.cmEditor) {
        this.cmEditor.on("change", (cmEditor) => {
          if (this.functionTestButton)
            this.functionTestButton.buttonEl.addClass("mod-warning");
        });
        this.cmEditor.on("blur", (cmEditor) => {
          this.currentCode = cmEditor.getValue();
        });
      }
      ;
      new import_obsidian12.Setting(ruleOptionsDiv).addButton((button) => {
        this.functionTestButton = button;
        button.setWarning().setButtonText("Run Code").setTooltip("Run the code and check for errors").onClick(async () => {
          if (this.cmEditor) {
            let jsCode2 = this.cmEditor.getValue();
            let userFunction = parseJSCode(jsCode2);
            if (typeof userFunction === "string") {
              let errorHint = "See console for details!";
              if (userFunction.contains("Unexpected token")) {
                errorHint = "Did you missed a semicolon (;)?";
              }
              if (this.functionResultTextComponent)
                this.functionResultTextComponent.setValue(`Syntax error: ${userFunction}! ${errorHint}`);
              this.checkedSuccessfully = false;
              button.buttonEl.addClass("mod-warning");
            } else {
              if (userFunction) {
                try {
                  const result = userFunction(this.app, this.activeFile, this.scriptingTools);
                  if (this.functionResultTextComponent)
                    this.functionResultTextComponent.setValue(`'${result.toString()}' (${typeof result})`);
                  this.updateTypeIcons(result, typesContainer, this.expectedType, this.currentType, this.plugin.settings);
                  button.buttonEl.removeClass("mod-warning");
                  this.checkedSuccessfully = true;
                } catch (e) {
                  if (this.functionResultTextComponent) {
                    this.functionResultTextComponent.setValue(`Syntax error: ${e.message}! See console for details!`);
                  }
                  console.error("Syntax error. ", e, jsCode2, userFunction);
                  this.checkedSuccessfully = false;
                  button.buttonEl.addClass("mod-warning");
                }
              } else {
                console.error("syntax error");
                this.checkedSuccessfully = false;
              }
            }
          }
        });
      }).addText((text) => {
        this.functionResultTextComponent = text;
        text.setPlaceholder("function result").setDisabled(true);
        this.functionResultTextComponent.inputEl.style.width = "580px";
      });
      const typesContainer = ruleOptionsDiv.createDiv({ cls: "property-icons-container" });
    }
    this.createActionButtons(contentEl);
  }
  updateTypeIcons(value, container, expectedType, currentType, settings) {
    const newType = typeof value;
    const typeIcons = {
      "string": ["text", "tags", "aliases", "multitext", "date", "datetime"],
      "number": ["number"],
      "boolean": ["checkbox"],
      "object": ["tags", "aliases", "multitext"]
    };
    if (newType === "string") {
      if (!this.scriptingTools.isISOString(value, { withDate: true })) {
        typeIcons[newType].splice(typeIcons[newType].indexOf("date"), 1);
        console.error("Invalid date format:", value);
      }
      if (!this.scriptingTools.isISOString(value, { withDate: true, withTime: true })) {
        typeIcons[newType].splice(typeIcons[newType].indexOf("datetime"), 1);
        console.error("Invalid date format:", value);
      }
    }
    container.empty();
    for (let obsidianType of typeIcons[newType]) {
      if (obsidianType) {
        const iconEl = container.createSpan({ cls: "property-icon setting-item-icon" });
        updatePropertyIcon(iconEl, obsidianType);
      }
    }
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian12.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian12.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      console.log("Cancel Clicked - Returning");
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      code: this.currentCode,
      checked: this.checkedSuccessfully,
      type: "text"
    };
    console.log("OK Clicked - Returning Result:", result);
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
  }
};
function openCodeEditorModal(app, plugin, initialCode, expectedType, activeFile, frontmatter, okCallback) {
  new codeEditorModal(
    app,
    plugin,
    initialCode,
    expectedType,
    activeFile,
    frontmatter,
    okCallback
  ).open();
}

// src/settings-properties.ts
var RulesTable = class extends import_obsidian13.PluginSettingTab {
  constructor(app, plugin, container, settingsParameter) {
    super(app, plugin);
    this.knownProperties = {};
    this.activeFile = null;
    this.plugin = plugin;
    this.container = container;
    this.settingsParameter = settingsParameter;
    this.tools = new ScriptingTools(app, plugin);
    this.activeFile = this.app.workspace.getActiveFile();
  }
  // Helper to render one rule
  renderPropertyRow(containerEl, rule, index) {
    var _a, _b, _c, _d, _e, _f;
    const ruleFn = getRuleFunctionById(rule.content);
    const rowEl = containerEl.createDiv({ cls: "property-setting-row setting-item" });
    rowEl.id = rule.id;
    const controlEl = rowEl.createDiv({ cls: "setting-item-control" });
    controlEl.style.gap = "0px";
    const leftContainer = controlEl.createDiv({ cls: "property-left-container" });
    const iconEl = leftContainer.createSpan({ cls: "property-icon setting-item-icon" });
    (0, import_obsidian13.setIcon)(iconEl, "hash");
    const searchContainer = leftContainer.createDiv({ cls: "property-search-container" });
    const nameInput = new import_obsidian13.TextComponent(searchContainer).setPlaceholder("Select property...").setValue(rule.property || "").onChange(async (value) => {
      this.renderSearchResults(searchContainer, value, index);
    });
    nameInput.inputEl.style.border = "none";
    nameInput.inputEl.addEventListener("focus", () => {
      this.renderSearchResults(searchContainer, nameInput.getValue(), index);
    });
    nameInput.inputEl.addEventListener("input", () => {
      this.renderSearchResults(searchContainer, nameInput.getValue(), index);
    });
    nameInput.inputEl.addEventListener("blur", (event) => {
      setTimeout(() => {
        const relatedTarget = event.relatedTarget;
        const resultsEl = searchContainer.querySelector(".property-search-results");
        if (!resultsEl || !resultsEl.contains(relatedTarget)) {
          this.clearSearchResults(searchContainer);
        }
      }, 100);
    });
    const currentPropertyInfo = this.knownProperties[rule.property];
    if (currentPropertyInfo) {
      updatePropertyIcon(iconEl, currentPropertyInfo.type);
    } else if (rule.property) {
      (0, import_obsidian13.setIcon)(iconEl, "alert-circle");
    }
    const middleContainer = controlEl.createDiv({ cls: "property-middle-container" });
    const valueContainer = middleContainer.createDiv({ cls: "property-value-container" });
    if (this.activeFile) {
      this.app.fileManager.processFrontMatter(this.activeFile, async (frontmatter) => {
        rule.value = await executeRule("preview", this.app, this.plugin.settings, this.activeFile, "", rule, frontmatter);
      }, { "mtime": this.activeFile.stat.mtime });
    }
    const previewComponent = this.renderValueInput(valueContainer, currentPropertyInfo, rule.value, index);
    const propertyDevDropdown = new import_obsidian13.DropdownComponent(middleContainer);
    propertyDevDropdown.selectEl.setAttribute("style", "width:35%");
    propertyDevDropdown.addOption("", "Select a content");
    for (let ruleFunction2 of ruleFunctions) {
      if (ruleFunction2.type.contains(rule.type)) {
        propertyDevDropdown.addOption(ruleFunction2.id, ruleFunction2.description);
      }
    }
    propertyDevDropdown.addOption("script", "JavaScript function (advanced)");
    propertyDevDropdown.setValue(rule.content);
    propertyDevDropdown.onChange(async (value) => {
      var _a2, _b2, _c2, _d2;
      if (value !== "") {
        const ruleFunction2 = getRuleFunctionById(value);
        switch (ruleFunction2 == null ? void 0 : ruleFunction2.ruleType) {
          case "script":
            let oldOriginalCode = ((_a2 = getRuleFunctionById(value)) == null ? void 0 : _a2.source) || ruleFunctions[0].source;
            if (rule.buildInCode !== "" && rule.buildInCode !== oldOriginalCode) {
              const shouldProceed = await new AlertModal(
                this.app,
                "Overwrite existing code?",
                "I sees like you have custom code for this rule! Should this be overwritten by default code for this parameter?",
                "Yes",
                "No"
              ).openAndGetValue();
              if (shouldProceed.proceed) {
                rule.buildInCode = ((_b2 = getRuleFunctionById(value)) == null ? void 0 : _b2.source) || ruleFunctions[0].source;
                rule.useCustomCode = false;
              } else {
                rule.buildInCode;
              }
              await this.plugin.saveSettings();
            } else {
              rule.buildInCode = ((_c2 = getRuleFunctionById(value)) == null ? void 0 : _c2.source) || ruleFunctions[0].source;
              rule.useCustomCode = false;
              await this.plugin.saveSettings();
            }
            break;
          case "buildIn":
            rule.buildInCode = ((_d2 = getRuleFunctionById(value)) == null ? void 0 : _d2.source) || ruleFunctions[0].source;
            rule.useCustomCode = false;
            await this.plugin.saveSettings();
            break;
          case "autocomplete.modal":
            break;
          default:
        }
        rule.content = value;
        await this.plugin.saveSettings();
        this.updatePreview(rule, previewComponent);
      }
    });
    new import_obsidian13.ButtonComponent(middleContainer).setIcon("gear").setTooltip("open settings").setClass("property-icon-button").onClick(async () => {
      let settingsContainers = containerEl.getElementsByClassName("property-options-container");
      for (let container of settingsContainers) {
        if (container.getAttribute("id") !== rule.id)
          container.setAttribute("style", "display: none;");
      }
      optionEL.style.display = optionEL.style.display === "block" ? "none" : "block";
    });
    const deleteButtonContainer = controlEl.createDiv({ cls: "property-delete-button-container" });
    new import_obsidian13.ButtonComponent(deleteButtonContainer).setIcon("trash-2").setTooltip("remove this rule").setClass("mod-subtle").onClick(async () => {
      this.plugin.settings[this.settingsParameter].splice(index, 1);
      await this.plugin.saveSettings();
      this.display();
    });
    controlEl.style.display = "flex";
    controlEl.style.alignItems = "center";
    controlEl.style.justifyContent = "space-between";
    controlEl.style.width = "100%";
    leftContainer.style.display = "flex";
    leftContainer.style.alignItems = "center";
    leftContainer.style.minWidth = "150px";
    iconEl.style.marginRight = "8px";
    searchContainer.style.position = "relative";
    searchContainer.style.flexGrow = "1";
    valueContainer.style.flexGrow = "2";
    deleteButtonContainer.style.marginLeft = "auto";
    const optionEL = containerEl.createDiv({ cls: "property-options-container" });
    optionEL.id = rule.id;
    optionEL.style.display = "none";
    if (useRuleOption(ruleFn, "removeContent")) {
      const removeContentButton = new import_obsidian13.Setting(optionEL).setName("Remove content").setDesc(`Before making changes you might consider to remove content generated by this rule`).addButton(
        (button) => {
          button.setWarning().setButtonText("Remove Content").setCta().onClick(() => {
            let count = this.plugin.removeFrontmatterParamsFromAllFiles(rule);
            button.removeCta();
            button.setDisabled(true);
            removeContentButton.setDesc(`Removed this rule from ${count.files} files.`);
          });
        }
      );
    }
    if (useRuleOption(ruleFn, "ruleActive")) {
      new import_obsidian13.Setting(optionEL).setName("Rule active").setDesc("If enabled, the rule will be executed").addToggle(
        (toggle) => toggle.setValue(rule.active).onChange(async (value) => {
          rule.active = value;
          await this.plugin.saveSettings();
        })
      );
    }
    if (useRuleOption(ruleFn, "modifyOnly")) {
      new import_obsidian13.Setting(optionEL).setName("Modify only").setDesc("Only modify existing properties").addToggle((toggle) => toggle.setValue(rule.onlyModify).onChange(async (value) => {
        rule.onlyModify = value;
        await this.plugin.saveSettings();
        this.updatePreview(rule, previewComponent);
      }));
    }
    if (rule.type === "text" || rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
      if (useRuleOption(ruleFn, "inputProperty")) {
        const ruleFunction2 = ruleFunctions.find((item) => item.id === rule.content);
        if (ruleFunction2 && ruleFunction2.inputProperty !== void 0) {
          let inputPropertiesDropdown;
          new import_obsidian13.Setting(optionEL).setName("Input Property").setDesc("Select a property as input").addDropdown((dropdown) => {
            inputPropertiesDropdown = dropdown;
            dropdown.setValue(rule.addContent).onChange(async (value) => {
              if (value !== "") {
                rule.inputProperty = value;
                await this.plugin.saveSettings();
                this.updatePreview(rule, previewComponent);
              }
            });
          });
          Object.entries(this.knownProperties).forEach((item) => {
            inputPropertiesDropdown.addOption(item[1].name, item[1].name);
          });
          inputPropertiesDropdown.setValue(rule.inputProperty);
        }
      }
      if (useRuleOption(ruleFn, "addPrefix")) {
        if (rule.type === "tags" || rule.type === "aliases") {
          new import_obsidian13.Setting(optionEL).setName("Prefix").setDesc('Optional prefix to add before the content (i.e. "prefix/")').addText((text) => text.setPlaceholder("no prefix").setValue(rule.prefix).onChange(async (value) => {
            rule.prefix = value;
            await this.plugin.saveSettings();
            this.updatePreview(rule, previewComponent);
          }));
        }
      }
      if (useRuleOption(ruleFn, "spaceReplacement")) {
        new import_obsidian13.Setting(optionEL).setName("Space replacement").setDesc('Character to replace spaces in folder names (suggested: "_")').addText((text) => text.setPlaceholder("no replacement").setValue(rule.spaceReplacement).onChange(async (value) => {
          rule.spaceReplacement = value;
          await this.plugin.saveSettings();
          this.updatePreview(rule, previewComponent);
        }));
      }
      if (useRuleOption(ruleFn, "specialCharacterReplacement")) {
        new import_obsidian13.Setting(optionEL).setName("Special character replacement").setDesc('Character to replace special characters (suggested: "-") - preserves letters with diacritics').addText((text) => text.setPlaceholder("no replacement").setValue(rule.specialCharReplacement).onChange(async (value) => {
          rule.specialCharReplacement = value;
          await this.plugin.saveSettings();
          this.updatePreview(rule, previewComponent);
        }));
      }
      if (useRuleOption(ruleFn, "convertToLowerCase")) {
        new import_obsidian13.Setting(optionEL).setName("Convert to lowercase").setDesc("Convert values to lowercase").addToggle((toggle) => toggle.setValue(rule.lowercaseTags).onChange(async (value) => {
          rule.lowercaseTags = value;
          await this.plugin.saveSettings();
          this.updatePreview(rule, previewComponent);
        }));
      }
      if (useRuleOption(ruleFn, "resultAsLink")) {
        new import_obsidian13.Setting(optionEL).setName("Result as Link").setDesc("Format Result as Link").addToggle(
          (toggle) => toggle.setValue(rule.asLink).onChange(async (value) => {
            rule.asLink = value;
            await this.plugin.saveSettings();
            this.updatePreview(rule, previewComponent);
          })
        );
      }
    }
    if (rule.type === "text" || rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
      if (useRuleOption(ruleFn, "addContent")) {
        new import_obsidian13.Setting(optionEL).setName("Add content").setDesc("select how the content should be stored").addDropdown(
          (dropdown) => dropdown.addOption("overwrite", "replace content").addOption("start", "place on start").addOption("end", "place on end").setValue(rule.addContent).onChange(async (value) => {
            if (value !== "") {
              rule.addContent = value === "overwrite" ? "overwrite" : value === "start" ? "start" : "end";
              await this.plugin.saveSettings();
              this.updatePreview(rule, previewComponent);
            }
          })
        );
      }
    }
    if (useRuleOption(ruleFn, "excludeFolders")) {
      const excludeEL = new import_obsidian13.Setting(optionEL).setName("Exclude Files and Folders from this rule").setDesc(`Currently ${((_a = rule.exclude) == null ? void 0 : _a.selectedFolders.length) || 0} folders and ${((_b = rule.exclude) == null ? void 0 : _b.selectedFiles.length) || 0} files will be ${((_c = rule.exclude) == null ? void 0 : _c.mode) || "exclude"}d.`).addButton((button) => {
        button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
          var _a2, _b2, _c2;
          openDirectorySelectionModal(
            this.app,
            ((_a2 = rule.exclude) == null ? void 0 : _a2.selectedFolders) || [],
            ((_b2 = rule.exclude) == null ? void 0 : _b2.selectedFiles) || [],
            {
              selectionMode: "exclude",
              displayMode: ((_c2 = rule.exclude) == null ? void 0 : _c2.display) || "folders",
              optionSelectionMode: false,
              optionShowFiles: true
            },
            (result) => {
              var _a3, _b3, _c3;
              if (!result)
                return;
              if (!rule.exclude) {
                rule.exclude = Object.assign({}, DEFAULT_FILTER_FILES_AND_FOLDERS, {
                  mode: "exclude"
                });
              }
              ;
              rule.exclude.selectedFolders = result.folders;
              rule.exclude.selectedFiles = result.files;
              rule.exclude.mode = "exclude";
              rule.exclude.display = result.display;
              this.plugin.saveSettings();
              console.log(rule.exclude);
              this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
              excludeEL.setDesc(`Currently ${((_a3 = rule.exclude) == null ? void 0 : _a3.selectedFolders.length) || 0} folders and ${((_b3 = rule.exclude) == null ? void 0 : _b3.selectedFiles.length) || 0} files will be ${((_c3 = rule.exclude) == null ? void 0 : _c3.mode) || "exclude"}d.`);
            }
          );
        });
      });
    }
    if (useRuleOption(ruleFn, "includeFolders")) {
      const includeEL = new import_obsidian13.Setting(optionEL).setName("Include Files and Folders for this rule ").setDesc(`Currently ${((_d = rule.include) == null ? void 0 : _d.selectedFolders.length) || 0} folders and ${((_e = rule.include) == null ? void 0 : _e.selectedFiles.length) || 0} files will be ${((_f = rule.include) == null ? void 0 : _f.mode) || "include"}d even if they are excluded globally.`).addButton((button) => {
        button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
          var _a2, _b2, _c2;
          openDirectorySelectionModal(
            this.app,
            ((_a2 = rule.include) == null ? void 0 : _a2.selectedFolders) || [],
            ((_b2 = rule.include) == null ? void 0 : _b2.selectedFiles) || [],
            {
              selectionMode: "include",
              displayMode: ((_c2 = rule.include) == null ? void 0 : _c2.display) || "folders",
              optionSelectionMode: false,
              optionShowFiles: true
            },
            (result) => {
              var _a3, _b3, _c3;
              if (!result)
                return;
              if (!rule.include) {
                rule.include = Object.assign({}, DEFAULT_FILTER_FILES_AND_FOLDERS, {
                  mode: "include"
                });
              }
              ;
              rule.include.selectedFolders = result.folders;
              rule.include.selectedFiles = result.files;
              rule.include.mode = "include";
              rule.include.display = result.display;
              this.plugin.saveSettings();
              console.log(rule.include);
              this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
              includeEL.setDesc(`Currently ${((_a3 = rule.include) == null ? void 0 : _a3.selectedFolders.length) || 0} folders and ${((_b3 = rule.include) == null ? void 0 : _b3.selectedFiles.length) || 0} files will be ${((_c3 = rule.include) == null ? void 0 : _c3.mode) || "include"}d.`);
            }
          );
        });
      });
    }
    if (useRuleOption(ruleFn, "script")) {
      new import_obsidian13.Setting(optionEL).setName("Script").setDesc("edit the script for own modifications").addButton((button) => {
        button.setButtonText("JS Editor").onClick(() => {
          var _a2, _b2;
          openCodeEditorModal(
            this.app,
            this.plugin,
            rule.content === "script" ? rule.jsCode : rule.buildInCode,
            ((_a2 = rule.typeProperty) == null ? void 0 : _a2.type) || "text",
            this.activeFile,
            this.activeFile ? ((_b2 = this.app.metadataCache.getFileCache(this.activeFile)) == null ? void 0 : _b2.frontmatter) || {} : {},
            (result) => {
              if (!result)
                return;
              if (rule.content === "script") {
                rule.jsCode = result.code;
                rule.useCustomCode = false;
              } else {
                rule.buildInCode = result.code;
                rule.useCustomCode = true;
                button.setCta();
              }
              this.plugin.saveSettings();
              this.updatePreview(rule, previewComponent);
            }
          );
        });
        if (rule.useCustomCode) {
          button.setCta();
        } else {
          button.removeCta();
        }
      });
    }
    const ruleFunction = getRuleFunctionById(rule.content);
    if (ruleFunction && typeof ruleFunction.configTab === "function") {
      ruleFunction.configTab(optionEL, rule, this, previewComponent);
    }
  }
  getOptionConfig(ruleId, propertyId) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      const optionConfig = rule.optionsConfig[ruleId];
      if (optionConfig[propertyId]) {
        return optionConfig[propertyId];
      }
    }
    return void 0;
  }
  setOptionConfig(ruleId, propertyId, config) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      if (!rule.optionsConfig)
        rule.optionsConfig = {};
      if (!rule.optionsConfig[ruleId])
        rule.optionsConfig[ruleId] = {};
      rule.optionsConfig[ruleId][propertyId] = config;
      this.plugin.saveSettings();
    }
  }
  setOptionConfigDefaults(ruleId, defaults) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      if (!rule.optionsConfig)
        rule.optionsConfig = {};
      rule.optionsConfig[ruleId] = Object.assign({}, defaults, rule.optionsConfig[ruleId] || {});
    }
    return rule.optionsConfig[ruleId];
  }
  renderSearchResults(searchContainerEl, searchTerm, rowIndex) {
    this.clearSearchResults(searchContainerEl);
    const filteredProperties = Object.entries(this.knownProperties).filter(([name]) => name.toLowerCase().includes(searchTerm.toLowerCase()));
    if (filteredProperties.length === 0 && searchTerm) {
      return;
    }
    if (filteredProperties.length === 0 && !searchTerm) {
      return;
    }
    const resultsEl = searchContainerEl.createDiv({ cls: "property-search-results menu" });
    resultsEl.style.position = "absolute";
    resultsEl.style.top = "100%";
    resultsEl.style.left = "0";
    resultsEl.style.width = "calc(100% + 100px)";
    resultsEl.style.zIndex = "10";
    resultsEl.style.maxHeight = "200px";
    resultsEl.style.overflowY = "auto";
    let activeIndex = -1;
    const updateActiveItem = (newIndex) => {
      const items = resultsEl.querySelectorAll(".menu-item");
      items.forEach((item, index) => {
        if (index === newIndex) {
          item.addClass("property-search-is-active");
          item.scrollIntoView({ block: "nearest" });
        } else {
          item.removeClass("property-search-is-active");
        }
      });
      activeIndex = newIndex;
    };
    const selectActiveItem = async () => {
      if (activeIndex >= 0 && activeIndex < filteredProperties.length) {
        const [name, info] = filteredProperties[activeIndex];
        this.plugin.settings[this.settingsParameter][rowIndex].property = name;
        this.plugin.settings[this.settingsParameter][rowIndex].type = info.type;
        this.plugin.settings[this.settingsParameter][rowIndex].value = void 0;
        await this.plugin.saveSettings();
        this.clearSearchResults(searchContainerEl);
        this.display();
      }
    };
    filteredProperties.forEach(([name, info], index) => {
      const itemEl = resultsEl.createDiv({ cls: "menu-item" });
      const itemIcon = itemEl.createSpan({ cls: "menu-item-icon" });
      updatePropertyIcon(itemIcon, info.type);
      itemEl.createSpan({ text: name });
      itemEl.addEventListener("mousedown", async (e) => {
        e.preventDefault();
        activeIndex = index;
        await selectActiveItem();
      });
    });
    searchContainerEl.addEventListener("keydown", async (e) => {
      const items = resultsEl.querySelectorAll(".menu-item");
      if (e.key === "ArrowDown") {
        e.preventDefault();
        updateActiveItem((activeIndex + 1) % items.length);
      } else if (e.key === "ArrowUp") {
        e.preventDefault();
        updateActiveItem((activeIndex - 1 + items.length) % items.length);
      } else if (e.key === "Enter") {
        e.preventDefault();
        await selectActiveItem();
      }
    });
  }
  clearSearchResults(searchContainerEl) {
    const resultsEl = searchContainerEl.querySelector(".property-search-results");
    if (resultsEl) {
      resultsEl.remove();
    }
  }
  renderValueInput(containerEl, propertyInfo, currentValue, index) {
    let returnComponent;
    containerEl.empty();
    if (!propertyInfo) {
      containerEl.setText("");
      containerEl.addClass("text-muted");
      return;
    }
    const type = propertyInfo.type;
    switch (type) {
      case "number":
        returnComponent = new import_obsidian13.TextComponent(containerEl).setPlaceholder("Numeric Value").setValue(currentValue !== void 0 && currentValue !== null ? String(currentValue) : "").onChange(async (value) => {
          const numValue = value === "" ? void 0 : parseFloat(value);
          this.plugin.settings[this.settingsParameter][index].value = isNaN(numValue) ? void 0 : numValue;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "number";
        break;
      case "checkbox":
        returnComponent = containerEl.createDiv({ cls: "tri-state-checkbox clickable-icon" });
        returnComponent.setAttribute("aria-label", "Checkbox change state");
        returnComponent.setAttribute("role", "checkbox");
        const updateCheckboxVisual = (state) => {
          let iconName;
          let ariaState;
          if (state === true) {
            iconName = "check-square";
            ariaState = "true";
          } else if (state === false) {
            iconName = "square";
            ariaState = "false";
          } else {
            iconName = "minus-square";
            ariaState = "mixed";
          }
          (0, import_obsidian13.setIcon)(returnComponent, iconName);
          returnComponent.setAttribute("aria-checked", ariaState);
          returnComponent.dataset.state = String(state);
        };
        updateCheckboxVisual(currentValue);
        returnComponent.addEventListener("click", async () => {
          let currentState = returnComponent.dataset.state;
          let nextState;
          if (currentState === "false") {
            nextState = true;
          } else if (currentState === "true") {
            nextState = void 0;
          } else {
            nextState = false;
          }
          this.plugin.settings[this.settingsParameter][index].value = nextState;
          await this.plugin.saveSettings();
          updateCheckboxVisual(nextState);
        });
        break;
      case "date":
        returnComponent = new import_obsidian13.TextComponent(containerEl).setPlaceholder("YYYY-MM-DD").setValue(currentValue || "").onChange(async (value) => {
          this.plugin.settings[this.settingsParameter][index].value = value || void 0;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "date";
        break;
      case "datetime":
        returnComponent = new import_obsidian13.TextComponent(containerEl).setPlaceholder("YYYY-MM-DDTHH:mm").setValue(currentValue || "").onChange(async (value) => {
          this.plugin.settings[this.settingsParameter][index].value = value || void 0;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "datetime-local";
        break;
      case "aliases":
      case "tags":
      case "multitext":
        returnComponent = new import_obsidian13.TextComponent(containerEl).setPlaceholder("values (divided by comma)").setValue(Array.isArray(currentValue) ? currentValue.join(", ") : currentValue || "").onChange(async (value) => {
          const arrayValue = value.split(",").map((s) => s.trim()).filter((s) => s);
          this.plugin.settings[this.settingsParameter][index].value = arrayValue.length > 0 ? arrayValue : void 0;
          await this.plugin.saveSettings();
        });
        break;
      case "text":
      default:
        returnComponent = new import_obsidian13.TextComponent(containerEl).setPlaceholder("value").setValue(currentValue || "").onChange(async (value) => {
          this.plugin.settings[this.settingsParameter][index].value = value || void 0;
          await this.plugin.saveSettings();
        });
        break;
    }
    if (type !== "checkbox") {
      returnComponent.inputEl.style.backgroundColor = "transparent";
      returnComponent.inputEl.style.width = "100%";
      returnComponent.inputEl.style.border = "none";
    }
    return returnComponent;
  }
  async updatePreview(rule, previewComponent) {
    if (this.activeFile) {
      let ruleResult;
      await this.app.fileManager.processFrontMatter(this.activeFile, async (frontmatter) => {
        ruleResult = await executeRule("preview", this.app, this.plugin.settings, this.activeFile, "", rule, frontmatter);
      }, { "mtime": this.activeFile.stat.mtime });
      switch (typeof ruleResult) {
        case "object":
          if (Array.isArray(ruleResult))
            previewComponent.inputEl.value = ruleResult.toString();
          break;
        default:
          previewComponent.inputEl.value = ruleResult;
          break;
      }
    }
  }
  async display() {
    const containerEl = this.container;
    containerEl.empty();
    this.knownProperties = await this.tools.fetchKnownProperties(this.app);
    this.propertiesListEl = containerEl.createDiv("properties-list");
    this.plugin.settings.rules.forEach((rule, index) => {
      this.renderPropertyRow(this.propertiesListEl, rule, index);
    });
    let activeFile = this.app.workspace.getActiveFile();
    this.updateFilterIndicator(activeFile, this.propertiesListEl);
    const addBtnContainer = containerEl.createDiv({ cls: "setting-item-control" });
    addBtnContainer.style.justifyContent = "right";
    new import_obsidian13.ButtonComponent(addBtnContainer).setButtonText("Add Property").setIcon("plus-circle").setCta().onClick(async () => {
      const defaultName = "";
      this.plugin.settings[this.settingsParameter].push(Object.assign({}, DEFAULT_RULE_DEFINITION, {
        id: (0, import_crypto.randomUUID)().toString()
      }));
      await this.plugin.saveSettings();
      this.display();
    }).buttonEl.className = "property-plus-button";
  }
  updateFilterIndicator(activeFile, propertiesListEl) {
    if (activeFile) {
      this.plugin.settings.rules.forEach((rule, index) => {
        const propertyRowEl = propertiesListEl.getElementsByClassName("property-setting-row")[index];
        const propertyLeftDiv = propertyRowEl.querySelector(".property-left-container");
        if (checkIfFileAllowed(activeFile, this.plugin.settings, rule)) {
          propertyLeftDiv == null ? void 0 : propertyLeftDiv.addClass("property-left-container-allowed");
        } else {
          propertyLeftDiv == null ? void 0 : propertyLeftDiv.removeClass("property-left-container-allowed");
        }
      });
    }
  }
};

// src/settings.ts
var FolderTagSettingTab = class extends import_obsidian14.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(app, plugin);
  }
  hide() {
    this.plugin.settings.liveRules = [];
    this.plugin.settings.rules.forEach((rule) => {
      let ruleFunction = getRuleFunctionById(rule.content);
      if (!ruleFunction)
        return;
      if (ruleFunction.isLiveRule) {
        this.plugin.settings.liveRules.push(rule);
      }
    });
    this.plugin.saveSettings();
  }
  display() {
    this.knownProperties = getPropertiesFromMetadataManager(this.app);
    this.knownTypes = getTypesFromMetadataManager(this.app);
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: `Front matter automate V${versionString}` });
    new import_obsidian14.Setting(containerEl).setName("Exclude Files and Folders globally").setDesc(`Currently ${this.plugin.settings.exclude.selectedFolders.length} folders and ${this.plugin.settings.exclude.selectedFiles.length} files will be ${this.plugin.settings.exclude.mode}d.`).addButton((button) => {
      button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.exclude.selectedFolders || [],
          this.plugin.settings.exclude.selectedFiles || [],
          {
            selectionMode: this.plugin.settings.exclude.mode || "exclude",
            displayMode: this.plugin.settings.exclude.display || "folders",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            this.plugin.settings.exclude.selectedFolders = result.folders;
            this.plugin.settings.exclude.selectedFiles = result.files;
            this.plugin.settings.exclude.mode = result.mode;
            this.plugin.settings.exclude.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian14.Setting(containerEl).setName("Include Files and Folders globally").setDesc(`Currently ${this.plugin.settings.include.selectedFolders.length} folders and ${this.plugin.settings.include.selectedFiles.length} files will be ${this.plugin.settings.include.mode}d even if they are excluded.`).addButton((button) => {
      button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.include.selectedFolders || [],
          this.plugin.settings.include.selectedFiles || [],
          {
            selectionMode: this.plugin.settings.include.mode || "include",
            displayMode: this.plugin.settings.include.display || "folders",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            this.plugin.settings.include.selectedFolders = result.folders;
            this.plugin.settings.include.selectedFiles = result.files;
            this.plugin.settings.include.mode = result.mode;
            this.plugin.settings.include.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian14.Setting(containerEl).setName("Rules").setDesc("add rules to update selected parameters");
    this.rulesContainer = containerEl.createDiv("properties-list");
    const rulesTable = new RulesTable(this.app, this.plugin, this.rulesContainer, "rules");
    rulesTable.display();
  }
};

// main.ts
var FolderTagPlugin = class extends import_obsidian15.Plugin {
  //private oldFolderPaths = new Map<string, string | null>();
  async onload() {
    await this.loadSettings();
    this.tools = new ScriptingTools(this.app, this);
    ;
    let noticeMessage = `Front Matter Automate ${versionString}
 loading ...`;
    const loadingNotice = new import_obsidian15.Notice(noticeMessage, 0);
    noticeMessage = noticeMessage + "\n register events ...";
    loadingNotice.setMessage(noticeMessage);
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian15.TFile && file.extension === "md") {
          console.log(`creating file: `, file.path);
          this.updateFrontmatterParameters("create", file, this.settings.rules);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian15.TFile && file.extension === "md") {
          console.log(`renaming file: `, file.path);
          this.updateFrontmatterParameters("rename", file, this.settings.rules, oldPath);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian15.MarkdownView) {
          const activeFile = this.app.workspace.getActiveFile();
          console.log(`active-leaf-change file: `, activeFile == null ? void 0 : activeFile.path);
          if (activeFile)
            this.updateFrontmatterParameters("active-leaf-change", activeFile, this.settings.rules);
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("changed", async (file, data, cache) => {
        if (!checkIfFileAllowed(file, this.settings)) {
          console.log(`file ${file.path} globally rejected!`);
          return;
        }
        if (cache.frontmatter && Array.isArray(this.settings.liveRules) && this.settings.liveRules.length > 0) {
          console.log(`Event metadata changed: ${file.path} ${this.settings.liveRules.length} rules live`);
          this.app.fileManager.processFrontMatter(file, async (frontmatter) => {
            for (const rule of this.settings.liveRules) {
              if (checkIfFileAllowed(file, this.settings, rule)) {
                let result;
                if (rule.onlyModify && !frontmatter.hasOwnProperty(rule.property))
                  return;
                if (frontmatter) {
                  result = await executeRule("modify", this.app, this.settings, file, frontmatter[rule.property], rule, frontmatter);
                  if (result)
                    frontmatter[rule.property] = result;
                }
              } else {
                console.log(`file ${file.path} rejected ny rule ${rule.content}!`);
              }
            }
            console.log(`${this.settings.liveRules.length} rules updated metadata: `, frontmatter);
          }, { "mtime": file.stat.mtime });
        }
        ;
      })
    );
    noticeMessage = noticeMessage + "\n initial processing ...";
    loadingNotice.setMessage(noticeMessage);
    this.settings.liveRules = [];
    this.settings.rules.forEach((rule) => {
      let ruleFunction = getRuleFunctionById(rule.content);
      if (!ruleFunction)
        return;
      switch (ruleFunction.ruleType) {
        case "autocomplete.modal":
        case "buildIn.inputProperty":
        case "automation":
          this.settings.liveRules.push(rule);
          break;
      }
    });
    noticeMessage = noticeMessage + "\ndone!";
    loadingNotice.setMessage(noticeMessage);
    setTimeout(() => {
      loadingNotice.hide();
    }, 2e3);
    this.addSettingTab(new FolderTagSettingTab(this.app, this));
  }
  async loadSettings() {
    let data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  formatTagName(name) {
    if (name === null)
      return null;
    if (name === void 0)
      return void 0;
    let formatted = name.replace(/\s+/g, this.settings.spaceReplacement);
    formatted = formatted.replace(/[^a-zA-Z0-9\-_\/]/g, this.settings.specialCharReplacement);
    if (this.settings.lowercaseTags) {
      formatted = formatted.toLowerCase();
    }
    return formatted;
  }
  formatValue(value, type) {
    switch (type) {
      case "text":
      case "tags":
      case "aliases":
      case "multitext":
        return this.tools.toYamlSafeString(value);
      case "date":
      case "datetime":
        if (typeof value === "number") {
          return new Date(value).toISOString();
        }
        return value.toString();
      case "checkbox":
        return value ? "true" : "false";
      case "number":
        return Number(value);
      default:
        return this.tools.toYamlSafeString(value);
    }
  }
  updateFrontmatterParameters(eventName, file, rules, oldPath) {
    if (!checkIfFileAllowed(file, this.settings)) {
      console.log(`file ${file.path} globally rejected!`);
      return;
    }
    const currentPathTag = this.formatTagName(this.tools.getFolderFromPath(file.path));
    const oldPathTag = this.formatTagName(this.tools.getFolderFromPath(oldPath));
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      var _a;
      console.log(`Event start ${eventName}: ${file.path} ${rules.length} rules`, frontmatter);
      for (let rule of rules) {
        let result = frontmatter[rule.property];
        if (!checkIfFileAllowed(file, this.settings, rule)) {
          console.log(`file ${file.path} rejected by rule (${rule.property}|${rule.content}) settings`);
          continue;
        }
        if (rule.onlyModify && !frontmatter.hasOwnProperty(rule.property)) {
          console.log(`file ${file.path} has not ${rule.property}(${rule.content}) onlyModify`);
          continue;
        }
        switch ((_a = this.tools.getRuleFunction(rule)) == null ? void 0 : _a.ruleType) {
          case "buildIn":
          case "script":
            result = executeRule(eventName, this.app, this.settings, file, frontmatter[rule.property], rule, frontmatter, oldPath);
            break;
          default:
        }
        frontmatter[rule.property] = result;
      }
      console.log("Frontmatter updated", frontmatter);
    }, { "mtime": file.stat.mtime });
  }
  async removeFrontmatterParamsFromAllFiles(rule) {
    let count = { files: 0, items: 0 };
    this.app.vault.getMarkdownFiles().forEach((file) => {
      count.files++;
      this.removeFrontmatterParameter(file, rule, count);
    });
    return count;
  }
  async removeFrontmatterParameter(file, rule, count) {
    if (!checkIfFileAllowed(file, this.settings, rule))
      return;
    const currentPathTag = this.formatTagName(this.tools.getFolderFromPath(file.path));
    let content = await this.app.vault.read(file);
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      if (Array.isArray(frontmatter[rule.property]))
        count.items += frontmatter[rule.property].length;
      frontmatter[rule.property] = removeRule(this.app, this.settings, file, frontmatter[rule.property], rule, frontmatter);
      if (Array.isArray(frontmatter[rule.property]))
        count.items -= frontmatter[rule.property].length;
    }, { "mtime": file.stat.mtime });
    return count;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2Zyb250bWF0dGVyLXRvb2xzLnRzIiwgInNyYy90b29scy50cyIsICJzcmMvTG9nLnRzIiwgInNyYy9FcnJvci50cyIsICJzcmMvYWxlcnRCb3gudHMiLCAic3JjL3J1bGVzLnRzIiwgInNyYy9hdXRvY29tcGxldGVNb2RhbC50cyIsICJzcmMvdWlFbGVtZW50cy50cyIsICJzcmMvc3VnZ2VzdGVycy9Gb2xkZXJTdWdnZXN0ZXIudHMiLCAic3JjL3N1Z2dlc3RlcnMvc3VnZ2VzdC50cyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2VudW1zLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVOYW1lLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21hdGguanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy91c2VyQWdlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaXNMYXlvdXRWaWV3cG9ydC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9jb250YWlucy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzVGFibGVFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRQYXJlbnROb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3dpdGhpbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcnJvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldFZhcmlhdGlvbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsQmFyWC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRWaWV3cG9ydFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzU2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFNjcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZU9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZXRlY3RPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2ZsaXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvaGlkZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9vZmZzZXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEFsdEF4aXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGVib3VuY2UuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9tZXJnZUJ5TmFtZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2NyZWF0ZVBvcHBlci5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3BvcHBlci5qcyIsICJzcmMvc3VnZ2VzdGVycy9GaWxlU3VnZ2VzdGVyLnRzIiwgInNyYy9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbC50cyIsICJzcmMvdHlwZXMudHMiLCAic3JjL3NldHRpbmdzLXByb3BlcnRpZXMudHMiLCAic3JjL2VkaXRvck1vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIEVkaXRvciwgUGx1Z2luLCBNYXJrZG93blZpZXcsIE1hcmtkb3duUG9zdFByb2Nlc3NvciwgUGx1Z2luTWFuaWZlc3QsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCwgcGFyc2VGcm9udE1hdHRlclRhZ3MsIE5vdGljZX0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbi8vaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzLXByb3BlcnRpZXMnO1xuaW1wb3J0IHsgY2hlY2tJZkZpbGVBbGxvd2VkLCBleGVjdXRlUnVsZSwgZ2V0UnVsZUZ1bmN0aW9uQnlJZCwgcmVtb3ZlUnVsZSwgcnVsZUZ1bmN0aW9ucyB9IGZyb20gJy4vc3JjL3J1bGVzJztcbmltcG9ydCB7IHBhcnNlSlNDb2RlLCBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vc3JjL3Rvb2xzJztcbmltcG9ydCB7IHZlcnNpb25TdHJpbmcsIEZvbGRlclRhZ1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTLCBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgUHJvcGVydHlUeXBlSW5mb30gZnJvbSAnLi9zcmMvdHlwZXMnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlclRhZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEZvbGRlclRhZ1NldHRpbmdzO1xuICAgIHByaXZhdGUgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xuICAgIC8vcHJpdmF0ZSBvbGRGb2xkZXJQYXRocyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmcgfCBudWxsPigpO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKHRoaXMuYXBwLCB0aGlzKTs7XG4gICAgICAgIGxldCBub3RpY2VNZXNzYWdlID0gYEZyb250IE1hdHRlciBBdXRvbWF0ZSAke3ZlcnNpb25TdHJpbmd9XFxuIGxvYWRpbmcgLi4uYDtcbiAgICAgICAgY29uc3QgbG9hZGluZ05vdGljZSA9IG5ldyBOb3RpY2Uobm90aWNlTWVzc2FnZSwwKVxuXG4gICAgICAgIG5vdGljZU1lc3NhZ2UgPSBub3RpY2VNZXNzYWdlICsgJ1xcbiByZWdpc3RlciBldmVudHMgLi4uJztcbiAgICAgICAgbG9hZGluZ05vdGljZS5zZXRNZXNzYWdlKG5vdGljZU1lc3NhZ2UpO1xuICAgICAgICAvLyBGaWxlIGNyZWF0aW9uIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ2NyZWF0ZScsIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgY3JlYXRpbmcgZmlsZTogYCwgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoJ2NyZWF0ZScsIGZpbGUsIHRoaXMuc2V0dGluZ3MucnVsZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gRmlsZSByZW5hbWUvbW92ZSBoYW5kbGVyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHJlbmFtaW5nIGZpbGU6IGAsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKCdyZW5hbWUnLCBmaWxlLCB0aGlzLnNldHRpbmdzLnJ1bGVzLCBvbGRQYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEZpbGUgY2xvc2UgaGFuZGxlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIChsZWFmKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBhY3RpdmUtbGVhZi1jaGFuZ2UgZmlsZTogYCwgYWN0aXZlRmlsZT8ucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVGaWxlKSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycygnYWN0aXZlLWxlYWYtY2hhbmdlJywgYWN0aXZlRmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBNZXRhZGF0YSBjaGFuZ2VkIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIGFzeW5jIChmaWxlLCBkYXRhLCBjYWNoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGUsIHRoaXMuc2V0dGluZ3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBmaWxlICR7ZmlsZS5wYXRofSBnbG9iYWxseSByZWplY3RlZCFgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWNoZS5mcm9udG1hdHRlciAmJiBBcnJheS5pc0FycmF5KHRoaXMuc2V0dGluZ3MubGl2ZVJ1bGVzKSAmJiB0aGlzLnNldHRpbmdzLmxpdmVSdWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFdmVudCBtZXRhZGF0YSBjaGFuZ2VkOiAke2ZpbGUucGF0aH0gJHt0aGlzLnNldHRpbmdzLmxpdmVSdWxlcy5sZW5ndGh9IHJ1bGVzIGxpdmVgKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIGFzeW5jIChmcm9udG1hdHRlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXBwbHkgYWxsIGxpdmUgcnVsZXMgdG8gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcnVsZSBvZiB0aGlzLnNldHRpbmdzLmxpdmVSdWxlcykgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGUsIHRoaXMuc2V0dGluZ3MsIHJ1bGUpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUub25seU1vZGlmeSAmJiAhZnJvbnRtYXR0ZXIuaGFzT3duUHJvcGVydHkocnVsZS5wcm9wZXJ0eSkpIHJldHVybjsgLy8gb25seSBtb2RpZnkgaWYgcHJvcGVydHkgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlcikgey8vIGNhY2hlLmZyb250bWF0dGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVJ1bGUoJ21vZGlmeScsdGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIGZpbGUsIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLCBydWxlLCBmcm9udG1hdHRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSBmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBmaWxlICR7ZmlsZS5wYXRofSByZWplY3RlZCBueSBydWxlICR7cnVsZS5jb250ZW50fSFgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3RoaXMuc2V0dGluZ3MubGl2ZVJ1bGVzLmxlbmd0aH0gcnVsZXMgdXBkYXRlZCBtZXRhZGF0YTogYCwgZnJvbnRtYXR0ZXIpO1xuICAgICAgICAgICAgICAgICAgICB9LHsnbXRpbWUnOmZpbGUuc3RhdC5tdGltZX0pOyAvLyBkbyBub3QgY2hhbmdlIHRoZSBtb2RpZnkgdGltZS5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG4gaW5pdGlhbCBwcm9jZXNzaW5nIC4uLic7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5saXZlUnVsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5ydWxlcy5mb3JFYWNoKHJ1bGUgPT4ge1xuICAgICAgICAgICAgbGV0IHJ1bGVGdW5jdGlvbiA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZS5jb250ZW50KTtcbiAgICAgICAgICAgIGlmICghcnVsZUZ1bmN0aW9uKSByZXR1cm47XG4gICAgICAgICAgICBzd2l0Y2ggKHJ1bGVGdW5jdGlvbi5ydWxlVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2F1dG9jb21wbGV0ZS5tb2RhbCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRJbi5pbnB1dFByb3BlcnR5JzpcbiAgICAgICAgICAgICAgICBjYXNlICdhdXRvbWF0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5saXZlUnVsZXMucHVzaChydWxlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9KVxuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG5kb25lISc7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgbG9hZGluZ05vdGljZS5oaWRlKCk7XG4gICAgICAgIH0sMjAwMClcblxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRm9sZGVyVGFnU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBkYXRhKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZm9ybWF0VGFnTmFtZShuYW1lOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZHtcbiAgICAgICAgaWYgKG5hbWUgPT09IG51bGwpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlyc3QgcmVwbGFjZSBzcGFjZXMgYWNjb3JkaW5nIHRvIHNldHRpbmdzXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSBuYW1lLnJlcGxhY2UoL1xccysvZywgdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRoZW4gcmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnMgKHByZXNlcnZpbmcgbGV0dGVycyB3aXRoIGRpYWNyaXRpY3MpXG4gICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHRoaXMuc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb252ZXJ0IHRvIGxvd2VyY2FzZSBpZiBjb25maWd1cmVkXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmxvd2VyY2FzZVRhZ3MpIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIGZvcm1hdFZhbHVlKHZhbHVlOmFueSwgdHlwZTpzdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd0ZXh0JzpcbiAgICAgICAgICAgIGNhc2UgJ3RhZ3MnOlxuICAgICAgICAgICAgY2FzZSAnYWxpYXNlcyc6XG4gICAgICAgICAgICBjYXNlICdtdWx0aXRleHQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgY2FzZSAnZGF0ZSc6XG4gICAgICAgICAgICBjYXNlICdkYXRldGltZSc6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPyAndHJ1ZScgOiAnZmFsc2UnO1xuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9vbHMudG9ZYW1sU2FmZVN0cmluZyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZXZlbnROYW1lOiAnY3JlYXRlJyB8ICdyZW5hbWUnIHwgJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIGZpbGU6IFRGaWxlLCBydWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXSwgb2xkUGF0aD86IHN0cmluZykge1xuICAgICAgICBpZiAoIWNoZWNrSWZGaWxlQWxsb3dlZChmaWxlLCB0aGlzLnNldHRpbmdzKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYGZpbGUgJHtmaWxlLnBhdGh9IGdsb2JhbGx5IHJlamVjdGVkIWApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3VycmVudFBhdGhUYWcgPSB0aGlzLmZvcm1hdFRhZ05hbWUodGhpcy50b29scy5nZXRGb2xkZXJGcm9tUGF0aChmaWxlLnBhdGgpKTtcbiAgICAgICAgY29uc3Qgb2xkUGF0aFRhZyA9IHRoaXMuZm9ybWF0VGFnTmFtZSh0aGlzLnRvb2xzLmdldEZvbGRlckZyb21QYXRoKG9sZFBhdGgpKVxuXG4gICAgICAgIHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcbiAgICAgICAgICAgLy8gYXBwbHkgYWxsIHJ1bGVzIHRvIGZyb250bWF0dGVyXG4gICAgICAgICAgIGNvbnNvbGUubG9nKGBFdmVudCBzdGFydCAke2V2ZW50TmFtZX06ICR7ZmlsZS5wYXRofSAke3J1bGVzLmxlbmd0aH0gcnVsZXNgLGZyb250bWF0dGVyKTtcbiAgICAgICAgICAgIGZvciAobGV0IHJ1bGUgb2YgcnVsZXMpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gZnJvbnRtYXR0ZXJbcnVsZS5wcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja0lmRmlsZUFsbG93ZWQoZmlsZSwgdGhpcy5zZXR0aW5ncywgcnVsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYGZpbGUgJHtmaWxlLnBhdGh9IHJlamVjdGVkIGJ5IHJ1bGUgKCR7cnVsZS5wcm9wZXJ0eX18JHtydWxlLmNvbnRlbnR9KSBzZXR0aW5nc2ApO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gb25seSBtb2RpZnkgaWYgZmlsZSBpcyBhbGxvd2VkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydWxlLm9ubHlNb2RpZnkgJiYgIWZyb250bWF0dGVyLmhhc093blByb3BlcnR5KHJ1bGUucHJvcGVydHkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBmaWxlICR7ZmlsZS5wYXRofSBoYXMgbm90ICR7cnVsZS5wcm9wZXJ0eX0oJHtydWxlLmNvbnRlbnR9KSBvbmx5TW9kaWZ5YCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBvbmx5IG1vZGlmeSBpZiBwcm9wZXJ0eSBleGlzdHNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnRvb2xzLmdldFJ1bGVGdW5jdGlvbihydWxlKT8ucnVsZVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRJbic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NjcmlwdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBleGVjdXRlUnVsZShldmVudE5hbWUsIHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCBmaWxlLCBmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSwgcnVsZSwgZnJvbnRtYXR0ZXIsIG9sZFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldID0gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Zyb250bWF0dGVyIHVwZGF0ZWQnLGZyb250bWF0dGVyKTtcbiAgICAgICAgfSx7J210aW1lJzpmaWxlLnN0YXQubXRpbWV9KTsgLy8gZG8gbm90IGNoYW5nZSB0aGUgbW9kaWZ5IHRpbWUuXG4gICAgfVxuICAgIFxuICAgIGFzeW5jIHJlbW92ZUZyb250bWF0dGVyUGFyYW1zRnJvbUFsbEZpbGVzKHJ1bGU6IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uKXtcbiAgICAgICAgbGV0IGNvdW50ID0ge2ZpbGVzOjAsIGl0ZW1zOiAwfVxuICAgICAgICB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgICAgICAgIGNvdW50LmZpbGVzKys7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZyb250bWF0dGVyUGFyYW1ldGVyKGZpbGUsIHJ1bGUsIGNvdW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9XG5cbiAgICBhc3luYyByZW1vdmVGcm9udG1hdHRlclBhcmFtZXRlcihmaWxlOiBURmlsZSwgcnVsZTogRm9sZGVyVGFnUnVsZURlZmluaXRpb24sIGNvdW50KSB7XG4gICAgICAgIGlmICghY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGUsIHRoaXMuc2V0dGluZ3MsIHJ1bGUpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyRnJvbVBhdGgoZmlsZS5wYXRoKSk7XG4gICAgICAgIGxldCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgdGhpcy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIChmcm9udG1hdHRlcikgPT4ge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZnJvbnRtYXR0ZXJbcnVsZS5wcm9wZXJ0eV0pKSBjb3VudC5pdGVtcyArPSBmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XS5sZW5ndGg7XG4gICAgICAgICAgICBmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSA9IHJlbW92ZVJ1bGUodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIGZpbGUsIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLCBydWxlLCBmcm9udG1hdHRlcik7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSkpIGNvdW50Lml0ZW1zIC09IGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLmxlbmd0aDtcbiAgICAgICAgfSx7J210aW1lJzpmaWxlLnN0YXQubXRpbWV9KTsgLy8gZG8gbm90IGNoYW5nZSB0aGUgbW9kaWZ5IHRpbWUuXG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUZXh0Q29tcG9uZW50IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBmbVRvb2xzIGZyb20gJy4vZnJvbnRtYXR0ZXItdG9vbHMnO1xyXG5pbXBvcnQgeyBwYXJzZUpTQ29kZSwgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgZ2V0UnVsZUZ1bmN0aW9uQnlJZCwgcnVsZUZ1bmN0aW9ucywgUnVsZUZ1bmN0aW9uIH0gZnJvbSAnLi9ydWxlcyc7XHJcbmltcG9ydCB7IHZlcnNpb25TdHJpbmcsIEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uLCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiwgUHJvcGVydHlUeXBlSW5mbywgT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgQWxlcnRNb2RhbCB9IGZyb20gJy4vYWxlcnRCb3gnO1xyXG5pbXBvcnQgeyBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwsIERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB9IGZyb20gJy4vZGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwnO1xyXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcclxuaW1wb3J0IHsgUnVsZXNUYWJsZSB9IGZyb20gJy4vc2V0dGluZ3MtcHJvcGVydGllcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgRm9sZGVyVGFnU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBhbnk7IC8vRm9sZGVyVGFnUGx1Z2luO1xyXG4gICAgcnVsZXNEaXY6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgcnVsZXNDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgcnVsZXNDb250cm9sOiBIVE1MRGl2RWxlbWVudDtcclxuICAgIGtub3duUHJvcGVydGllczogUHJvcGVydHlUeXBlSW5mb1tdO1xyXG4gICAga25vd25UeXBlczogYW55O1xyXG4gICAgc2NyaXB0aW5nVG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBhbnkgLypGb2xkZXJUYWdQbHVnaW4qLykge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnNjcmlwdGluZ1Rvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKGFwcCwgcGx1Z2luKTtcclxuICAgIH1cclxuICAgIGhpZGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGl2ZVJ1bGVzPVtdO1xyXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZvckVhY2gocnVsZSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBydWxlRnVuY3Rpb24gPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgICAgIGlmICghcnVsZUZ1bmN0aW9uKSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmIChydWxlRnVuY3Rpb24uaXNMaXZlUnVsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGl2ZVJ1bGVzLnB1c2gocnVsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgfVxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGZtVG9vbHMuZ2V0UHJvcGVydGllc0Zyb21NZXRhZGF0YU1hbmFnZXIodGhpcy5hcHApO1xyXG4gICAgICAgIHRoaXMua25vd25UeXBlcyA9IGZtVG9vbHMuZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKHRoaXMuYXBwKTtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogYEZyb250IG1hdHRlciBhdXRvbWF0ZSBWJHt2ZXJzaW9uU3RyaW5nfWAgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgIC5zZXROYW1lKCdFeGNsdWRlIEZpbGVzIGFuZCBGb2xkZXJzIGdsb2JhbGx5JylcclxuICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RofSBmb2xkZXJzIGFuZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHdpbGwgYmUgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGV9ZC5gKVxyXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLXgnKVxyXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0V4Y2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5tb2RlIHx8ICdleGNsdWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2VsZWN0aW9uTW9kZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TaG93RmlsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5tb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLmRpc3BsYXkgPSByZXN1bHQuZGlzcGxheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyAgXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIEZpbGVzIGFuZCBGb2xkZXJzIGdsb2JhbGx5JylcclxuICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RofSBmb2xkZXJzIGFuZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHdpbGwgYmUgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGV9ZCBldmVuIGlmIHRoZXkgYXJlIGV4Y2x1ZGVkLmApXHJcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXItY2hlY2snKVxyXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5tb2RlIHx8ICdpbmNsdWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2VsZWN0aW9uTW9kZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TaG93RmlsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5tb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLmRpc3BsYXkgPSByZXN1bHQuZGlzcGxheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyAgICBcclxuICAgICAgICBcclxuICBcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnUnVsZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdhZGQgcnVsZXMgdG8gdXBkYXRlIHNlbGVjdGVkIHBhcmFtZXRlcnMnKTtcclxuXHJcbiAgICAgICAgdGhpcy5ydWxlc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigncHJvcGVydGllcy1saXN0Jyk7XHJcbiAgICAgICAgY29uc3QgcnVsZXNUYWJsZSA9IG5ldyBSdWxlc1RhYmxlKHRoaXMuYXBwLCB0aGlzLnBsdWdpbix0aGlzLnJ1bGVzQ29udGFpbmVyLCdydWxlcycpO1xyXG4gICAgICAgIHJ1bGVzVGFibGUuZGlzcGxheSgpO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eVR5cGVJbmZvLCBQcm9wZXJ0eVR5cGUsIE9ic2lkaWFuUHJvcGVydHlUeXBlc30gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9QUk9QRVJUWV9UWVBFX0lORk86IFByb3BlcnR5VHlwZUluZm8gPSB7XHJcbiAgICBuYW1lIDogXCJcIixcclxuICAgIHR5cGUgOiAndGV4dCcsXHJcbiAgICBpc0FycmF5OiBmYWxzZSxcclxuICAgIHZhbHVlczogW10sXHJcbiAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJyxcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIGFsbCBhdmFpbGFibGUgcHJvcGVydGllcyB3aXRoIHRoZWlyIHR5cGUgaW5mb3JtYXRpb25cclxuICogQHBhcmFtIGFwcCBUaGUgT2JzaWRpYW4gQXBwIGluc3RhbmNlXHJcbiAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byBhbiBhcnJheSBvZiBQcm9wZXJ0eVR5cGVJbmZvXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUHJvcGVydGllc1dpdGhUeXBlcyhhcHA6IEFwcCk6IFByb21pc2U8UHJvcGVydHlUeXBlSW5mb1tdPiB7XHJcbiAgICAvLyBUcnkgdG8gZ2V0IHJlZ2lzdGVyZWQgcHJvcGVydGllcyAoZmFsbGJhY2sgdG8gZW1wdHkgYXJyYXkgaWYgQVBJIGNoYW5nZWQpXHJcbiAgICBjb25zdCByZWdpc3RlcmVkUHJvcHMgPSBhd2FpdCBnZXRSZWdpc3RlcmVkUHJvcGVydGllc1NhZmUoYXBwKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IGFkZGl0aW9uYWwgcHJvcGVydGllcyBmb3VuZCBpbiBub3Rlc1xyXG4gICAgY29uc3QgZmlsZVByb3BzID0gYXdhaXQgZ2V0UHJvcGVydGllc0Zyb21GaWxlcyhhcHApO1xyXG4gICAgXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgKGZhdm9yIHJlZ2lzdGVyZWQgcHJvcGVydGllcyB3aGVuIGR1cGxpY2F0ZXMgZXhpc3QpXHJcbiAgICBjb25zdCBjb21iaW5lZCA9IG5ldyBNYXA8c3RyaW5nLCBQcm9wZXJ0eVR5cGVJbmZvPigpO1xyXG4gICAgXHJcbiAgICAvLyBBZGQgcHJvcGVydGllcyBmb3VuZCBpbiBmaWxlcyBmaXJzdFxyXG4gICAgZmlsZVByb3BzLmZvckVhY2gocHJvcCA9PiB7XHJcbiAgICAgICAgY29tYmluZWQuc2V0KHByb3AubmFtZSwgcHJvcCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gVGhlbiBvdmVycmlkZSB3aXRoIHJlZ2lzdGVyZWQgcHJvcGVydGllcyAod2hpY2ggaGF2ZSBtb3JlIGNvbXBsZXRlIHR5cGUgaW5mbylcclxuICAgIHJlZ2lzdGVyZWRQcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xyXG4gICAgICAgIGNvbWJpbmVkLnNldChwcm9wLm5hbWUsIHByb3ApO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBBcnJheS5mcm9tKGNvbWJpbmVkLnZhbHVlcygpKS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBQcm9wZXJ0aWVzIGZyb20gTWV0YWRhdGFNYW5hZ2VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvcGVydGllc0Zyb21NZXRhZGF0YU1hbmFnZXIoYXBwOiBBcHApOiBQcm9wZXJ0eVR5cGVJbmZvW10ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YU1hbmFnZXIgPSAoYXBwIGFzIGFueSkubWV0YWRhdGFUeXBlTWFuYWdlcjtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImdldCBwcm9wZXJ0aWVzOlwiLG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobWV0YWRhdGFNYW5hZ2VyLnByb3BlcnRpZXMpLm1hcCggKHZhbHVlOmFueSk6UHJvcGVydHlUeXBlSW5mbyA9PiAoe1xyXG4gICAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxyXG4gICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXHJcbiAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgfSkpLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgYWNjZXNzIHByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YSBNYW5hZ2VyXCIsIGUpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IFR5cGVzIGZyb20gTWV0YWRhdGFNYW5hZ2VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKGFwcDogQXBwKTogYW55IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnZXQgdHlwZXM6XCIsbWV0YWRhdGFNYW5hZ2VyKTtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhtZXRhZGF0YU1hbmFnZXIucmVnaXN0ZXJlZFR5cGVXaWRnZXRzKS5tYXAoICh2YWx1ZTphbnksIGluZGV4LCBhcnJheSk6UHJvcGVydHlUeXBlICA9PiAoe1xyXG4gICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxyXG4gICAgICAgICAgICBpY29uOiB2YWx1ZS5pY29uLFxyXG4gICAgICAgICAgICBqc1R5cGU6ICcnLFxyXG4gICAgICAgIH0pKS5zb3J0KChhLCBiKSA9PiBhLnR5cGUubG9jYWxlQ29tcGFyZShiLnR5cGUpKTtcclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGFjY2VzcyBwcm9wZXJ0aWVzIGZyb20gTWV0YWRhdGEgTWFuYWdlclwiLCBlKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFNhZmUgbWV0aG9kIHRvIGdldCByZWdpc3RlcmVkIHByb3BlcnRpZXMgdGhhdCB3b24ndCB0aHJvdyBpZiBBUEkgY2hhbmdlc1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZFByb3BlcnRpZXNTYWZlKGFwcDogQXBwKTogUHJvbWlzZTxQcm9wZXJ0eVR5cGVJbmZvW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgY29uc29sZS5sb2cobWV0YWRhdGFNYW5hZ2VyKTtcclxuICAgICAgICBpZiAoIW1ldGFkYXRhTWFuYWdlcikgcmV0dXJuIFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgd2F5cyB0byBnZXQgcHJvcGVydGllcyBiYXNlZCBvbiBPYnNpZGlhbiB2ZXJzaW9uXHJcbiAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YU1hbmFnZXIuZ2V0QWxsRnJvbnRtYXR0ZXJUeXBlcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAvLyBPbGRlciBPYnNpZGlhbiB2ZXJzaW9uc1xyXG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlclR5cGVzID0gbWV0YWRhdGFNYW5hZ2VyLmdldEFsbEZyb250bWF0dGVyVHlwZXMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZyb250bWF0dGVyVHlwZXMubWFwKChuYW1lOiBzdHJpbmcpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLCAvLyBEZWZhdWx0IHR5cGUgaWYgd2UgY2FuJ3QgZ2V0IG1vcmUgaW5mb1xyXG4gICAgICAgICAgICAgICAgc291cmNlOiAncmVnaXN0ZXJlZCdcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG1ldGFkYXRhTWFuYWdlci5nZXRQcm9wZXJ0aWVzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIC8vIE5ld2VyIE9ic2lkaWFuIHZlcnNpb25zIG1pZ2h0IHVzZSB0aGlzXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBtZXRhZGF0YU1hbmFnZXIuZ2V0UHJvcGVydGllcygpO1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMocHJvcGVydGllcykubWFwKChbbmFtZSwgdHlwZV06IFtzdHJpbmcsIGFueV0pID0+ICh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdHlwZSxcclxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGFjY2VzcyByZWdpc3RlcmVkIHByb3BlcnRpZXM6XCIsIGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtdO1xyXG59XHJcblxyXG4vKipcclxuICogU2NhbnMgZmlsZXMgZm9yIGFkZGl0aW9uYWwgcHJvcGVydGllcyB3aXRoIHR5cGUgaW5mZXJlbmNlXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRQcm9wZXJ0aWVzRnJvbUZpbGVzKGFwcDogQXBwKTogUHJvbWlzZTxQcm9wZXJ0eVR5cGVJbmZvW10+IHtcclxuICAgIGNvbnN0IGZpbGVzID0gYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgIGNvbnN0IHByb3BlcnR5TWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgdmFsdWVzOiBTZXQ8YW55PiwgdHlwZXM6IFNldDxzdHJpbmc+IH0+KCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcy5zbGljZSgwLCAxMDAwKSkgeyAvLyBMaW1pdCB0byAxMDAwIGZpbGVzIGZvciBwZXJmb3JtYW5jZVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjYWNoZS5mcm9udG1hdHRlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAncG9zaXRpb24nKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnR5TWFwLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5TWFwLnNldChrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogbmV3IFNldCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXM6IG5ldyBTZXQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcERhdGEgPSBwcm9wZXJ0eU1hcC5nZXQoa2V5KSE7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcERhdGEudmFsdWVzLmFkZCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcERhdGEudHlwZXMuYWRkKGluZmVyVHlwZUZyb21WYWx1ZSh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShwcm9wZXJ0eU1hcC5lbnRyaWVzKCkpLm1hcCgoW25hbWUsIGRhdGFdKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IGRldGVybWluZVByaW1hcnlUeXBlKGRhdGEudHlwZXMpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgICAgIGlzQXJyYXk6IGRhdGEudHlwZXMuaGFzKCdhcnJheScpLFxyXG4gICAgICAgICAgICB2YWx1ZXM6IGRhdGEudmFsdWVzLnNpemUgPiAwID8gQXJyYXkuZnJvbShkYXRhLnZhbHVlcykubWFwKFN0cmluZykgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHNvdXJjZTogJ2luZmVycmVkJ1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERldGVybWluZXMgdGhlIHByaW1hcnkgdHlwZSBmcm9tIGEgU2V0IG9mIG9ic2VydmVkIHR5cGVzXHJcbiAqIEBwYXJhbSB0eXBlcyBTZXQgb2Ygb2JzZXJ2ZWQgdHlwZXMgZm9yIGEgcHJvcGVydHlcclxuICogQHJldHVybnMgVGhlIG1vc3Qgc3BlY2lmaWMgdHlwZSB3ZSBjYW4gZGV0ZXJtaW5lXHJcbiAqL1xyXG5mdW5jdGlvbiBkZXRlcm1pbmVQcmltYXJ5VHlwZSh0eXBlczogU2V0PHN0cmluZz4pOiBPYnNpZGlhblByb3BlcnR5VHlwZXMge1xyXG4gICAgLy8gSGFuZGxlIGVtcHR5IGNhc2UgKHNob3VsZG4ndCBoYXBwZW4gYnV0IFR5cGVTY3JpcHQgd2FudHMgdXMgdG8gY2hlY2spXHJcbiAgICBpZiAodHlwZXMuc2l6ZSA9PT0gMCkgcmV0dXJuICd0ZXh0JztcclxuICAgIFxyXG4gICAgLy8gSWYgb25seSBvbmUgdHlwZSBvYnNlcnZlZCwgdXNlIHRoYXRcclxuICAgIGlmICh0eXBlcy5zaXplID09PSAxKSByZXR1cm4gdHlwZXMudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xyXG4gICAgXHJcbiAgICAvLyBQcmlvcml0eSBvcmRlciBmb3IgdHlwZSByZXNvbHV0aW9uXHJcbiAgICBjb25zdCB0eXBlUHJpb3JpdHk6IE9ic2lkaWFuUHJvcGVydHlUeXBlc1tdID0gW1xyXG4gICAgICAgICdkYXRlJyxcclxuICAgICAgICAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICdjaGVja2JveCcsXHJcbiAgICAgICAgJ251bWJlcicsXHJcbiAgICAgICAgJ3RhZ3MnLFxyXG4gICAgICAgICdhbGlhc2VzJyxcclxuICAgICAgICAnbXVsdGl0ZXh0JyxcclxuICAgICAgICAndGV4dCcgLy8gZmFsbGJhY2tcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8vIFJldHVybiB0aGUgaGlnaGVzdCBwcmlvcml0eSB0eXBlIHdlIGZpbmRcclxuICAgIGZvciAoY29uc3QgdHlwZSBvZiB0eXBlUHJpb3JpdHkpIHtcclxuICAgICAgICBpZiAodHlwZXMuaGFzKHR5cGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRmluYWwgZmFsbGJhY2tcclxuICAgIHJldHVybiAndGV4dCc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCB0eXBlIGluZmVyZW5jZSB3aXRoIGJldHRlciBkYXRlIGRldGVjdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gaW5mZXJUeXBlRnJvbVZhbHVlKHZhbHVlOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gJ251bGwnO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBhcnJheSBmaXJzdFxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgYXJyYXkgZWxlbWVudCB0eXBlc1xyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50VHlwZXMgPSBuZXcgU2V0KHZhbHVlLm1hcChpbmZlclR5cGVGcm9tVmFsdWUpKTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnRUeXBlcy5zaXplID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYGFycmF5PCR7ZWxlbWVudFR5cGVzLnZhbHVlcygpLm5leHQoKS52YWx1ZX0+YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ2FycmF5JztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgYmFzaWMgdHlwZXNcclxuICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6IHJldHVybiAnYm9vbGVhbic7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzogcmV0dXJuICdudW1iZXInO1xyXG4gICAgICAgIGNhc2UgJ29iamVjdCc6IHJldHVybiAnb2JqZWN0JzsgLy8gZm9yIGZ1dHVyZSBleHBhbnNpb25cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gTXVzdCBiZSBzdHJpbmcgYXQgdGhpcyBwb2ludCAtIGNoZWNrIGZvciBzcGVjaWFsIHN0cmluZyBmb3JtYXRzXHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIC8vIElTTyBEYXRlIChZWVlZLU1NLUREKVxyXG4gICAgICAgIGlmICgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC8udGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdkYXRlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSVNPIERhdGVUaW1lXHJcbiAgICAgICAgaWYgKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn1bVCBdXFxkezJ9OlxcZHsyfTpcXGR7Mn0vLnRlc3QodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnZGF0ZXRpbWUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBPYnNpZGlhbiB0YWdcclxuICAgICAgICBpZiAodmFsdWUuc3RhcnRzV2l0aCgnIycpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAndGFnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERlZmF1bHQgdG8gc3RyaW5nXHJcbiAgICByZXR1cm4gJ3N0cmluZyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbHVlKHZhbHVlOiB1bmtub3duLCBpbmRleDogbnVtYmVyLCBhcnJheTogdW5rbm93bltdKTogdW5rbm93biB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIG5vdCBpbXBsZW1lbnRlZC4nKTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdFByb3BlcnR5IGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFByb3BlcnR5VHlwZUluZm8+IHtcclxuICAgIHByaXZhdGUgb25TdWJtaXQ6IChyZXN1bHQ6IFByb3BlcnR5VHlwZUluZm8pID0+IHZvaWQ7XHJcbiAgICBwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZDtcclxuICAgIGtub3duUHJvcGVydGllczpQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICB0eXBlZFRleHQ6IHN0cmluZztcclxuICAgIG5ld1RleHRGbGFnOiBCb29sZWFuO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yIChhcHA6QXBwLCBrbm93blByb3BlcnRpZXM6UHJvcGVydHlUeXBlSW5mb1tdLCBwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZCwgb25TdWJtaXQ6IChyZXN1bHQ6IFByb3BlcnR5VHlwZUluZm8pID0+IHZvaWQpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcclxuICAgICAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7XHJcbiAgICAgICAgdGhpcy50eXBlZFRleHQgPSAnJztcclxuICAgICAgICB0aGlzLm5ld1RleHRGbGFnID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGtub3duUHJvcGVydGllcztcclxuICAgIH1cclxuICAgIC8vIFJldHVybnMgYWxsIGF2YWlsYWJsZSBzdWdnZXN0aW9ucy5cclxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBQcm9wZXJ0eVR5cGVJbmZvW10ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMua25vd25Qcm9wZXJ0aWVzLmZpbHRlcigocHJvcGVydHkpID0+IHByb3BlcnR5Lm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSk7XHJcbiAgICAgICAgdGhpcy5uZXdUZXh0RmxhZyA9IChyZXN1bHQubGVuZ3RoID09PSAwKTtcclxuICAgICAgICB0aGlzLnR5cGVkVGV4dCA9IHF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBvbk9wZW4oKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydHkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcih0aGlzLnByb3BlcnR5Lm5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ25vIHByb3BlcnR5IHNlbGVjdGVkIScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFRpdGxlKCdTZWxlY3Qgb3IgdHlwZSBhIHByb3BlcnR5IG5hbWUnKTtcclxuICAgIH1cclxuICAgIC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXHJcbiAgICByZW5kZXJTdWdnZXN0aW9uKHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvLCBlbDogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgZWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogcHJvcGVydHkubmFtZSB9KTtcclxuICAgICAgZWwuY3JlYXRlRWwoJ3NtYWxsJywgeyB0ZXh0OiBwcm9wZXJ0eS50eXBlIH0pO1xyXG4gICAgfVxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5uZXdUZXh0RmxhZyAmJiB0aGlzLnByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcGVydHkubmFtZSA9IHRoaXMudHlwZWRUZXh0O1xyXG4gICAgICAgICAgICB0aGlzLnByb3BlcnR5LnR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXQodGhpcy5wcm9wZXJ0eSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFBlcmZvcm0gYWN0aW9uIG9uIHRoZSBzZWxlY3RlZCBzdWdnZXN0aW9uLlxyXG4gICAgb25DaG9vc2VTdWdnZXN0aW9uKHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2dCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYGtleWJvYXJkICR7dGhpcy50eXBlZFRleHR9ICR7dGhpcy5uZXdUZXh0RmxhZ31gLCBwcm9wZXJ0eSlcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coJ29uQ2hvb3NlU3VnZ2VzdGlvbicsIGV2dClcclxuICAgICAgICB0aGlzLm9uU3VibWl0KHByb3BlcnR5KTtcclxuICAgIH1cclxuICB9XHJcbiIsICJpbXBvcnQgeyBBcHAsIG5vcm1hbGl6ZVBhdGgsIFRBYnN0cmFjdEZpbGUsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRm9sZGVyVGFnUnVsZURlZmluaXRpb24sIEZvbGRlclRhZ1NldHRpbmdzLCBQcm9wZXJ0eUluZm8sIFByb3BlcnR5VHlwZUluZm8gfSBmcm9tICcuL3R5cGVzJ1xyXG5pbXBvcnQgeyBFcnJvck1hbmFnZXIgfSBmcm9tIFwiLi9FcnJvclwiO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSAnLi9hbGVydEJveCc7XHJcbmltcG9ydCB7IHJ1bGVGdW5jdGlvbnMgfSBmcm9tICcuL3J1bGVzJztcclxuLyoqXHJcbiAqIFBhcnNlIGEgSmF2YVNjcmlwdCBmdW5jdGlvbiwgY2xlYW4gY29tbWVudHMgYW5kIGRlZmluZSB0aGUgZnVuY3Rpb24gXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IGpzQ29kZVxyXG4gKiBAcmV0dXJuIHsqfSAgeyhGdW5jdGlvbiB8IHN0cmluZyB8IHVuZGVmaW5lZCl9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKU0NvZGUoanNDb2RlOnN0cmluZyk6IEZ1bmN0aW9uIHwgc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIGZ1bmN0aW9uIHBhcnNlRnVuY3Rpb24gKGpzQ29kZTogc3RyaW5nKTogRnVuY3Rpb24gfCBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAganNDb2RlID0gY2xlYW5Db2RlU3RyaW5nKGpzQ29kZSk7XHJcbiAgICAgICAgdmFyIGZ1bmNSZWcgPSAvZnVuY3Rpb24gKlxcKChbXigpXSopXFwpWyBcXG5cXHRdKnsoLiopfS9nbWk7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gZnVuY1JlZy5leGVjKGpzQ29kZS5yZXBsYWNlKC9cXG4vZywgJyAnKSk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB2YXIgYXJncyA9IG1hdGNoWzFdLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgYXJncy5wdXNoKG1hdGNoWzJdKTtcclxuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Vycm9yIHBhcnNpbmcgSlMgZnVuY3Rpb24hJywgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gZXJyb3IubWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHBhcnNlRnVuY3Rpb24oanNDb2RlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFucyBhIEphdmFTY3JpcHQvVHlwZVNjcmlwdCBjb2RlIHN0cmluZyBieSByZW1vdmluZyBjb21tZW50cy5cclxuICogVGhpcyBmdW5jdGlvbiBoYW5kbGVzIGJvdGggc2luZ2xlLWxpbmUgY29tbWVudHMgKGAvLyAuLi5gKSBhbmRcclxuICogbXVsdGktbGluZSBjb21tZW50cyAoYC8qIC4uLiAqXFwvYCkuIEl0IGFsc28gY29ycmVjdGx5IGhhbmRsZXNcclxuICogY29tbWVudHMgd2l0aGluIHN0cmluZ3MgYW5kIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb2RlU3RyaW5nIFRoZSBjb2RlIHN0cmluZyB0byBjbGVhbi5cclxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNsZWFuZWQgY29kZSBzdHJpbmcgd2l0aCBjb21tZW50cyByZW1vdmVkLlxyXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IElmIHRoZSBpbnB1dCBpcyBub3QgYSBzdHJpbmcuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5Db2RlU3RyaW5nKGNvZGVTdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBFbnN1cmUgdGhlIGlucHV0IGlzIGEgc3RyaW5nXHJcbiAgICBpZiAodHlwZW9mIGNvZGVTdHJpbmcgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0lucHV0IG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvLyBGbGFncyB0byB0cmFjayB0aGUgY3VycmVudCBwYXJzaW5nIGNvbnRleHRcclxuICAgIGxldCBpbk11bHRpTGluZUNvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGxldCBpblNpbmdsZUxpbmVDb21tZW50OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBsZXQgaW5TdHJpbmc6ICdcIicgfCBcIidcIiB8IG51bGwgPSBudWxsOyAvLyBUcmFja3MgaWYgaW5zaWRlIHNpbmdsZSBvciBkb3VibGUgcXVvdGVzXHJcbiAgICBsZXQgaW5SZWdFeHA6IGJvb2xlYW4gPSBmYWxzZTsgLy8gVHJhY2tzIGlmIGluc2lkZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsXHJcbiAgXHJcbiAgICAvLyBUaGUgcmVzdWx0aW5nIHN0cmluZyB3aXRob3V0IGNvbW1lbnRzXHJcbiAgICBsZXQgY2xlYW5lZENvZGU6IHN0cmluZyA9ICcnO1xyXG4gICAgLy8gQ3VycmVudCBpbmRleCBpbiB0aGUgaW5wdXQgc3RyaW5nXHJcbiAgICBsZXQgaTogbnVtYmVyID0gMDtcclxuICBcclxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgaW5wdXQgc3RyaW5nIGNoYXJhY3RlciBieSBjaGFyYWN0ZXJcclxuICAgIHdoaWxlIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgY29uc3QgY2hhcjogc3RyaW5nID0gY29kZVN0cmluZ1tpXTtcclxuICAgICAgY29uc3QgbmV4dENoYXI6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGNvZGVTdHJpbmdbaSArIDFdOyAvLyBVc2UgdW5kZWZpbmVkIGZvciBwb3RlbnRpYWwgZW5kIG9mIHN0cmluZ1xyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIG11bHRpLWxpbmUgY29tbWVudCAtLS1cclxuICAgICAgaWYgKGluTXVsdGlMaW5lQ29tbWVudCkge1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB0aGUgZW5kIG9mIHRoZSBtdWx0aS1saW5lIGNvbW1lbnQgJyovJ1xyXG4gICAgICAgIGlmIChjaGFyID09PSAnKicgJiYgbmV4dENoYXIgPT09ICcvJykge1xyXG4gICAgICAgICAgaW5NdWx0aUxpbmVDb21tZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcqLydcclxuICAgICAgICAgIGNvbnRpbnVlOyAvLyBNb3ZlIHRvIHRoZSBuZXh0IGl0ZXJhdGlvblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpKys7IC8vIFNraXAgdGhlIGNoYXJhY3RlciBpbnNpZGUgdGhlIGNvbW1lbnRcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHNpbmdsZS1saW5lIGNvbW1lbnQgLS0tXHJcbiAgICAgIGlmIChpblNpbmdsZUxpbmVDb21tZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBlbmQgb2YgdGhlIGxpbmUgKG5ld2xpbmUgb3IgY2FycmlhZ2UgcmV0dXJuKVxyXG4gICAgICAgIGlmIChjaGFyID09PSAnXFxuJyB8fCBjaGFyID09PSAnXFxyJykge1xyXG4gICAgICAgICAgaW5TaW5nbGVMaW5lQ29tbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gS2VlcCB0aGUgbmV3bGluZSBjaGFyYWN0ZXJcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpKys7IC8vIFNraXAgdGhlIGNoYXJhY3RlciBpbnNpZGUgdGhlIGNvbW1lbnRcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHN0cmluZyBsaXRlcmFsIC0tLVxyXG4gICAgICBpZiAoaW5TdHJpbmcpIHtcclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgY2xvc2VzIHRoZSBzdHJpbmdcclxuICAgICAgICBpZiAoY2hhciA9PT0gaW5TdHJpbmcpIHtcclxuICAgICAgICAgIGluU3RyaW5nID0gbnVsbDsgLy8gRXhpdCBzdHJpbmcgc3RhdGVcclxuICAgICAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICdcXFxcJykge1xyXG4gICAgICAgICAgLy8gSGFuZGxlIGVzY2FwZWQgY2hhcmFjdGVycyB3aXRoaW4gc3RyaW5ncyAoZS5nLiwgXCJpdFxcJ3NcIilcclxuICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEFkZCB0aGUgYmFja3NsYXNoXHJcbiAgICAgICAgICBpKys7IC8vIE1vdmUgdG8gdGhlIG5leHQgY2hhcmFjdGVyICh0aGUgZXNjYXBlZCBvbmUpXHJcbiAgICAgICAgICBpZiAoaSA8IGNvZGVTdHJpbmcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjb2RlU3RyaW5nW2ldOyAvLyBBZGQgdGhlIGVzY2FwZWQgY2hhcmFjdGVyXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpKys7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQWRkIHRoZSBjaGFyYWN0ZXIgdG8gdGhlIHJlc3VsdCBpZiBpdCdzIHBhcnQgb2YgdGhlIHN0cmluZ1xyXG4gICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsIC0tLVxyXG4gICAgICAgaWYgKGluUmVnRXhwKSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgY2xvc2VzIHRoZSByZWdleCBsaXRlcmFsXHJcbiAgICAgICAgICAvLyBOb3RlOiBUaGlzIGRvZXNuJ3QgaGFuZGxlIHJlZ2V4IGZsYWdzIHBlcmZlY3RseSBidXQgY292ZXJzIGJhc2ljIGNhc2VzLlxyXG4gICAgICAgICAgaWYgKGNoYXIgPT09ICcvJykge1xyXG4gICAgICAgICAgICAgIGluUmVnRXhwID0gZmFsc2U7IC8vIEV4aXQgcmVnZXggc3RhdGVcclxuICAgICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAgICAgLy8gSGFuZGxlIGVzY2FwZWQgY2hhcmFjdGVycyB3aXRoaW4gcmVnZXggKGUuZy4sIC9cXC8vKVxyXG4gICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEFkZCB0aGUgYmFja3NsYXNoXHJcbiAgICAgICAgICAgICAgaSsrOyAvLyBNb3ZlIHRvIHRoZSBuZXh0IGNoYXJhY3RlclxyXG4gICAgICAgICAgICAgIGlmIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjb2RlU3RyaW5nW2ldOyAvLyBBZGQgdGhlIGVzY2FwZWQgY2hhcmFjdGVyXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIEFkZCB0aGUgY2hhcmFjdGVyIHRvIHRoZSByZXN1bHQgaWYgaXQncyBwYXJ0IG9mIHRoZSByZWdleFxyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gRGVmYXVsdCBTdGF0ZTogQ2hlY2sgZm9yIGNvbW1lbnQvc3RyaW5nL3JlZ2V4IHN0YXJ0cyAtLS1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIG11bHRpLWxpbmUgY29tbWVudCAnLyonXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycgJiYgbmV4dENoYXIgPT09ICcqJykge1xyXG4gICAgICAgIGluTXVsdGlMaW5lQ29tbWVudCA9IHRydWU7XHJcbiAgICAgICAgaSArPSAyOyAvLyBTa2lwIHRoZSAnLyonXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIHNpbmdsZS1saW5lIGNvbW1lbnQgJy8vJ1xyXG4gICAgICBpZiAoY2hhciA9PT0gJy8nICYmIG5leHRDaGFyID09PSAnLycpIHtcclxuICAgICAgICBpblNpbmdsZUxpbmVDb21tZW50ID0gdHJ1ZTtcclxuICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcvLydcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgc3RyaW5nIGxpdGVyYWwgKCcgb3IgXCIpXHJcbiAgICAgIGlmIChjaGFyID09PSAnXCInIHx8IGNoYXIgPT09IFwiJ1wiKSB7XHJcbiAgICAgICAgaW5TdHJpbmcgPSBjaGFyOyAvLyBFbnRlciBzdHJpbmcgc3RhdGUsIHJlbWVtYmVyaW5nIHRoZSBxdW90ZSB0eXBlXHJcbiAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBvcGVuaW5nIHF1b3RlXHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbCAnLydcclxuICAgICAgLy8gQmFzaWMgY2hlY2s6IGFzc3VtZXMgJy8nIGluZGljYXRlcyBhIHJlZ2V4IHN0YXJ0IGlmIG5vdCBwcmVjZWRlZCBieSBvcGVyYXRvcnMva2V5d29yZHNcclxuICAgICAgLy8gQSBtb3JlIHJvYnVzdCBzb2x1dGlvbiB3b3VsZCByZXF1aXJlIG1vcmUgY29tcGxleCBwYXJzaW5nLlxyXG4gICAgICBpZiAoY2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAvLyBWZXJ5IGJhc2ljIGNoZWNrIHRvIGRpZmZlcmVudGlhdGUgZGl2aXNpb24gZnJvbSByZWdleCBzdGFydC5cclxuICAgICAgICAgIC8vIFRoaXMgbWlnaHQgbmVlZCByZWZpbmVtZW50IGZvciBjb21wbGV4IGNhc2VzLlxyXG4gICAgICAgICAgY29uc3QgcHJldk1lYW5pbmdmdWxDaGFyID0gY2xlYW5lZENvZGUudHJpbSgpLnNsaWNlKC0xKTtcclxuICAgICAgICAgIGlmIChwcmV2TWVhbmluZ2Z1bENoYXIgPT09ICcnIHx8IFsnKCcsICcsJywgJz0nLCAnOicsICdbJywgJyEnLCAnJicsICd8JywgJz8nLCAneycsICc7JywgJ1xcbicsICdcXHInXS5pbmNsdWRlcyhwcmV2TWVhbmluZ2Z1bENoYXIpKSB7XHJcbiAgICAgICAgICAgICAgaW5SZWdFeHAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIElmIG5vbmUgb2YgdGhlIGFib3ZlLCBpdCdzIHJlZ3VsYXIgY29kZTsgYWRkIGl0IHRvIHRoZSByZXN1bHRcclxuICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgaSsrO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLy8gUmV0dXJuIHRoZSBhY2N1bXVsYXRlZCBjbGVhbmVkIGNvZGUgc3RyaW5nXHJcbiAgICByZXR1cm4gY2xlYW5lZENvZGU7XHJcbiAgfVxyXG4gIGV4cG9ydCBmdW5jdGlvbiByZXNvbHZlRm9sZGVyKGFwcDogQXBwLCBmb2xkZXJfc3RyOiBzdHJpbmcpOiBURm9sZGVyIHtcclxuICAgIGZvbGRlcl9zdHIgPSBub3JtYWxpemVQYXRoKGZvbGRlcl9zdHIpO1xyXG5cclxuICAgIGNvbnN0IGZvbGRlciA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyX3N0cik7XHJcbiAgICBpZiAoIWZvbGRlcikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYEZvbGRlciBcIiR7Zm9sZGVyX3N0cn1cIiBkb2Vzbid0IGV4aXN0YCk7XHJcbiAgICB9XHJcbiAgICBpZiAoIShmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYCR7Zm9sZGVyX3N0cn0gaXMgYSBmaWxlLCBub3QgYSBmb2xkZXJgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZm9sZGVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZUZpbGUoYXBwOiBBcHAsIGZpbGVfc3RyOiBzdHJpbmcpOiBURmlsZSB7XHJcbiAgICBmaWxlX3N0ciA9IG5vcm1hbGl6ZVBhdGgoZmlsZV9zdHIpO1xyXG5cclxuICAgIGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVfc3RyKTtcclxuICAgIGlmICghZmlsZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYEZpbGUgXCIke2ZpbGVfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcclxuICAgIH1cclxuICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3JNYW5hZ2VyKGAke2ZpbGVfc3RyfSBpcyBhIGZvbGRlciwgbm90IGEgZmlsZWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmaWxlO1xyXG59XHJcbiAgZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVzRnJvbUZvbGRlcihcclxuICAgIGFwcDogQXBwLFxyXG4gICAgZm9sZGVyX3N0cjogc3RyaW5nXHJcbiAgKTogQXJyYXk8VEZpbGU+IHtcclxuICAgIGNvbnN0IGZvbGRlciA9IHJlc29sdmVGb2xkZXIoYXBwLCBmb2xkZXJfc3RyKTtcclxuXHJcbiAgICBjb25zdCBmaWxlczogQXJyYXk8VEZpbGU+ID0gW107XHJcbiAgICBWYXVsdC5yZWN1cnNlQ2hpbGRyZW4oZm9sZGVyLCAoZmlsZTogVEFic3RyYWN0RmlsZSkgPT4ge1xyXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgZmlsZXMucHVzaChmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBmaWxlcy5zb3J0KChhLCBiKSA9PiB7ICBcclxuICAgICAgICByZXR1cm4gYS5wYXRoLmxvY2FsZUNvbXBhcmUoYi5wYXRoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmaWxlcztcclxufVxyXG4gIGV4cG9ydCBjbGFzcyBTY3JpcHRpbmdUb29scyB7XHJcbiAgICBhcHA6IEFwcCB8IHVuZGVmaW5lZDtcclxuICAgIHBsdWdpbjogYW55OyAvL0ZvbGRlclRhZ1BsdWdpbjtcclxuICAgIHNldHRpbmdzOiBGb2xkZXJUYWdTZXR0aW5ncyB8IHVuZGVmaW5lZDtcclxuICAgIHJ1bGU6IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uIHwgdW5kZWZpbmVkO1xyXG4gICAgZnJvbnRtYXR0ZXI6IGFueTtcclxuICAgIGN1cnJlbnRDb250ZW50OiBhbnk7XHJcbiAgICBhY3RpdmVGaWxlOiBURmlsZSB8IHVuZGVmaW5lZDtcclxuICAgIGtub3duUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgUHJvcGVydHlJbmZvPjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA/OkFwcCwgcGx1Z2luPzphbnksIHNldHRpbmdzPzpGb2xkZXJUYWdTZXR0aW5ncywgcnVsZT86IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uLCBmcm9udG1hdHRlcj86IGFueSwgYWN0aXZlRmlsZT86IFRGaWxlKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzXHJcbiAgICAgICAgdGhpcy5ydWxlID0gcnVsZTtcclxuICAgICAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVGaWxlID0gYWN0aXZlRmlsZTtcclxuICAgIH1cclxuICAgIGdldEZyb250bWF0dGVyKCkgeyBcclxuICAgICAgcmV0dXJuIHRoaXMuZnJvbnRtYXR0ZXI7XHJcbiAgICB9XHJcbiAgICBzZXRGcm9udG1hdHRlcihmcm9udG1hdHRlcjphbnkpIHtcclxuICAgICAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7XHJcbiAgICB9XHJcbiAgICBzZXRGcm9udG1hdHRlclByb3BlcnR5KGtleTpzdHJpbmcsIHZhbHVlOmFueSkge1xyXG4gICAgICBpZiAoIXRoaXMuZnJvbnRtYXR0ZXIpIHRoaXMuZnJvbnRtYXR0ZXIgPSB7fTtcclxuICAgICAgdGhpcy5mcm9udG1hdHRlcltrZXldID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXRGcm9udG1hdHRlclByb3BlcnR5KGtleTpzdHJpbmcpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuZnJvbnRtYXR0ZXJba2V5XVxyXG4gICAgfVxyXG4gICAgc2V0QWN0aXZlRmlsZShmaWxlOlRGaWxlKSB7XHJcbiAgICAgIHRoaXMuYWN0aXZlRmlsZSA9IGZpbGU7XHJcbiAgICB9XHJcbiAgICBnZXRBY3RpdmVGaWxlKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5hY3RpdmVGaWxlO1xyXG4gICAgfVxyXG4gICAgc2V0UnVsZShydWxlOkZvbGRlclRhZ1J1bGVEZWZpbml0aW9uKSB7XHJcbiAgICAgIHRoaXMucnVsZSA9IHJ1bGU7XHJcbiAgICB9XHJcbiAgICBnZXRSdWxlKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ydWxlO1xyXG4gICAgfVxyXG4gICAgZ2V0UnVsZUZ1bmN0aW9uKHJ1bGU/OkZvbGRlclRhZ1J1bGVEZWZpbml0aW9uKSB7XHJcbiAgICAgIGlmICghcnVsZSkgcnVsZSA9IHRoaXMucnVsZTtcclxuICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICBjb25zdCBmdW5jdGlvbkluZGV4ID0gcnVsZUZ1bmN0aW9ucy5maW5kSW5kZXgoZnggPT4gZnguaWQgPT09IHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgICBpZiAoZnVuY3Rpb25JbmRleCE9PS0xKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2V0Q3VycmVudENvbnRlbnQoY29udGVudDphbnkpIHtcclxuICAgICAgdGhpcy5jdXJyZW50Q29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICBnZXRDdXJyZW50Q29udGVudCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudENvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVGcm9udG1hdHRlcihwcm9wZXJ0eSwgbmV3Q29udGVudCwgZmlsZT86VEZpbGUpIHtcclxuICAgICAgaWYgKCF0aGlzLmFwcCkgcmV0dXJuO1xyXG4gICAgICBpZiAoIWZpbGUpIGZpbGUgPSB0aGlzLmFjdGl2ZUZpbGU7XHJcbiAgICAgIGlmICghZmlsZSkgcmV0dXJuO1xyXG4gICAgICB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYHVwZGF0ZUZyb250bWF0dGVyICcke2ZpbGUucGF0aH0nIGZyb250bWF0dGVyICcke3Byb3BlcnR5fScgdG8gJyR7bmV3Q29udGVudC50b1N0cmluZygpfSdgKTtcclxuICAgICAgICBpZiAodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KG5ld0NvbnRlbnQpKSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oYHVwZGF0ZUZyb250bWF0dGVyICcke2ZpbGUucGF0aH0nfCcke3Byb3BlcnR5fScgb2JqZWN0IG5vdCBzdXBwb3J0ZWQhYCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGZyb250bWF0dGVyW3Byb3BlcnR5XSA9IG5ld0NvbnRlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LHsnbXRpbWUnOmZpbGUuc3RhdC5tdGltZX0pOyAvLyBkbyBub3QgY2hhbmdlIHRoZSBtb2RpZnkgdGltZS5cclxuICAgIH1cclxuICAgIGFzeW5jIHNob3dDb25maXJtRGlhbG9nKG1lc3NhZ2U6c3RyaW5nLCB0aXRsZTpzdHJpbmcgPSAnQ29uZmlybScsIGJ1dHRvbjE6c3RyaW5nID0gJ1llcycsIGJ1dHRvbjI6c3RyaW5nID0gJ05vJykge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSAgYXdhaXQgbmV3IEFsZXJ0TW9kYWwodGhpcy5hcHAhLCB0aXRsZSwgbWVzc2FnZSwgYnV0dG9uMSwgYnV0dG9uMikub3BlbkFuZEdldFZhbHVlKCk7XHJcbiAgICAgIHJldHVybiByZXN1bHQucHJvY2VlZDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogKiBHZXQgdGhlIG9wdGlvbiBjb25maWcgZm9yIGEgc3BlY2lmaWMgcnVsZS4gT3B0aW9uYWwgdGhlIHNwZWNpZmljIHBhcmFtZXRlciBieSBwcm92aWRpbmcgYW4gb3B0aW9uIElELlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBydWxlSWRcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uSWRdXHJcbiAgICAgKiBAcmV0dXJuIHsqfSBcclxuICAgICAqIEBtZW1iZXJvZiBTY3JpcHRpbmdUb29sc1xyXG4gICAgICovXHJcbiAgICBnZXRPcHRpb25Db25maWcocnVsZUlkOnN0cmluZ3x1bmRlZmluZWQsIG9wdGlvbklkPzpzdHJpbmcpe1xyXG4gICAgICBpZiAoIXJ1bGVJZCB8fCBydWxlSWQgPT09IHVuZGVmaW5lZCB8fCAhdGhpcy5zZXR0aW5ncyApIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIGNvbnN0IHJ1bGUgPSB0aGlzLnNldHRpbmdzLnJ1bGVzLmZpbmQoKHJ1bGU6IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uKSA9PiBydWxlLmlkID09PSBydWxlSWQpO1xyXG4gICAgICBpZiAocnVsZSAmJiBydWxlLmhhc093blByb3BlcnR5KCdvcHRpb25zQ29uZmlnJykpIHtcclxuICAgICAgICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgICAgICAgY29uc3Qgb3B0aW9uQ29uZmlnID0gcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF1cclxuICAgICAgICAgIGlmIChvcHRpb25Db25maWcpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZ1tvcHRpb25JZF07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RmlsZXNJblZhdWx0KG1hdGNoaW5nOiBzdHJpbmcpOiBURmlsZVtdIHtcclxuICAgICAgICBtYXRjaGluZyA9IG1hdGNoaW5nLnJlcGxhY2UoL15cXC98XFwvJC9nLCBcIlwiKSArICcvJzsgLy8gRW5zdXJlIGl0IGVuZHMgd2l0aCBhICcvJ1xyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAhLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTsgLy8gUmV0cmlldmUgYWxsIG1hcmtkb3duIGZpbGVzXHJcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLnBhdGguaW5jbHVkZXMobWF0Y2hpbmcpKTtcclxuICAgICAgICByZXR1cm4gbWF0Y2hpbmdGaWxlcztcclxuICAgIH1cclxuXHJcbiAgICBnZXRGaWxlRnJvbVBhdGgocGF0aDogc3RyaW5nLCBmaWxlc0NoZWNrOiBURmlsZVtdIHwgdW5kZWZpbmVkKSB7XHJcbiAgICAgIGNvbnN0IGZpbGVzID0gZmlsZXNDaGVjayA/IGZpbGVzQ2hlY2sgOiB0aGlzLmFwcCEudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpOyAvLyBSZXRyaWV2ZSBhbGwgbWFya2Rvd24gZmlsZXNcclxuICAgICAgY29uc3QgbWF0Y2hpbmdGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IFxyXG4gICAgICAgIGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBcclxuICAgICAgICBmaWxlLnBhdGgudG9Mb2NhbGVMb3dlckNhc2UoKS5pbmNsdWRlcyhwYXRoLnRvTG9jYWxlTG93ZXJDYXNlKCkpXHJcbiAgICAgICk7XHJcbiAgICAgIHJldHVybiBtYXRjaGluZ0ZpbGVzLmxlbmd0aCA+IDAgPyBtYXRjaGluZ0ZpbGVzWzBdIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgY3JlYXRlRmlsZUZyb21QYXRoKGZpbGVOYW1lV2l0aFBhdGg6c3RyaW5nLCB0ZW1wbGF0ZUZpbGVXaXRoUGF0aDpzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGVOYW1lV2l0aFBhdGgucmVwbGFjZSgvXlxcL3xcXC8kL2csIFwiXCIpOyAvLyBSZW1vdmUgbGVhZGluZyBhbmQgdHJhaWxpbmcgc2xhc2hlc1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlRmlsZSA9IHRlbXBsYXRlRmlsZVdpdGhQYXRoLnJlcGxhY2UoL15cXC98XFwvJC9nLCBcIlwiKTsgLy8gUmVtb3ZlIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXNcclxuICAgICAgICBjb25zdCBmb2xkZXJQYXRoID0gdGhpcy5nZXRGb2xkZXJGcm9tUGF0aChmaWxlTmFtZSk7XHJcbiAgICAgICAgY29uc3QgZmlsZU5hbWVPbmx5ID0gZmlsZU5hbWUuc3BsaXQoJy8nKS5wb3AoKSB8fCBmaWxlTmFtZTsgLy8gR2V0IHRoZSBsYXN0IHBhcnQgb2YgdGhlIHBhdGggYXMgdGhlIGZpbGUgbmFtZVxyXG4gICAgICAgIGlmICghZm9sZGVyUGF0aCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3JNYW5hZ2VyKGBJbnZhbGlkIGZvbGRlciBwYXRoOiBcIiR7Zm9sZGVyUGF0aH1cImApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBmb2xkZXIgPSB0aGlzLmFwcCEudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpIGFzIFRGb2xkZXI7XHJcbiAgICAgICAgaWYgKCFmb2xkZXIpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgRm9sZGVyIFwiJHtmb2xkZXJQYXRofVwiIGRvZXNuJ3QgZXhpc3RgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgJHtmb2xkZXJQYXRofSBpcyBhIGZpbGUsIG5vdCBhIGZvbGRlcmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcCEudmF1bHQucmVhZCh0aGlzLmFwcCEudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRlbXBsYXRlRmlsZSkgYXMgVEZpbGUpO1xyXG4gICAgICAgIGNvbnN0IGZpbGVFeGlzdHMgPSB0aGlzLmFwcCEudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVOYW1lV2l0aFBhdGgpIGFzIFRGaWxlO1xyXG4gICAgICAgIGlmICghZmlsZUV4aXN0cykge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXBwIS52YXVsdC5jcmVhdGUoZm9sZGVyLnBhdGggKyAnLycgKyBmaWxlTmFtZU9ubHksIHRlbXBsYXRlQ29udGVudCk7IC8vIGNyZWF0ZSB0aGUgZmlsZSBmcm9tIHRoZSB0ZW1wbGF0ZVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmlsZUV4aXN0czsgLy8gcmV0dXJuIHRoZSBmaWxlIGlmIGl0IGFscmVhZHkgZXhpc3RzXHJcbiAgICB9OyAvLyBjcmVhdGUgdGhlIGZpbGUgaWYgaXQgZG9lcyBub3QgZXhpc3RcclxuXHJcbiAgICAvKipcclxuICAgICAqICogRmV0Y2hlcyBjdXN0b20gcHJvcGVydHkgaW5mb3JtYXRpb24gZnJvbSBhbGwgbWFya2Rvd24gZmlsZXMgaW4gdGhlIHZhdWx0LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4geyp9IFxyXG4gICAgICovXHJcbiAgICBmZXRjaEN1c3RvbVByb3BlcnR5SW5mb3MoYXBwOkFwcCk6IFJlY29yZDxzdHJpbmcsIFByb3BlcnR5SW5mbz4ge1xyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5SW5mb3M6IFJlY29yZDxzdHJpbmcsIFByb3BlcnR5SW5mbz4gPSB7fTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSBhcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpOyAvLyBSZXRyaWV2ZSBhbGwgbWFya2Rvd24gZmlsZXNcclxuICAgICAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgaWYgKG1ldGFkYXRhPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMobWV0YWRhdGEuZnJvbnRtYXR0ZXIpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnR5SW5mb3Nba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUluZm9zW2tleV0gPSB7IG5hbWU6IGtleSwgdHlwZTogJ3RleHQnIH07IC8vIERlZmF1bHQgdHlwZSBhcyAndGV4dCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcHJvcGVydHlJbmZvcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2hlcyBrbm93biBwcm9wZXJ0aWVzIGZyb20gdGhlIG1ldGFkYXRhIGNhY2hlLlxyXG4gICAgICogSWYgdGhlIG1ldGhvZCBnZXRBbGxQcm9wZXJ0eUluZm9zIGlzIG5vdCBhdmFpbGFibGUsIGl0IGZhbGxzIGJhY2sgdG8gZmV0Y2hDdXN0b21Qcm9wZXJ0eUluZm9zLlxyXG4gICAgICogQHBhcmFtIGFwcCBUaGUgT2JzaWRpYW4gYXBwIGluc3RhbmNlLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBmZXRjaEtub3duUHJvcGVydGllcyhhcHA6QXBwKSB7XHJcbiAgICAgIGxldCBwcm9wZXJ0eUluZm9zOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eUluZm8+ID0ge307XHJcbiAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgaWYgKHR5cGVvZiBhcHAubWV0YWRhdGFDYWNoZS5nZXRBbGxQcm9wZXJ0eUluZm9zID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICBwcm9wZXJ0eUluZm9zID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0QWxsUHJvcGVydHlJbmZvcygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHByb3BlcnR5SW5mb3MgPSB0aGlzLmZldGNoQ3VzdG9tUHJvcGVydHlJbmZvcyhhcHApO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIHNvcnQgdGhlIHByb3BlcnRpZXMgYnkgbmFtZVxyXG4gICAgICBwcm9wZXJ0eUluZm9zID0gT2JqZWN0LmZyb21FbnRyaWVzKFxyXG4gICAgICAgICAgT2JqZWN0LmVudHJpZXMocHJvcGVydHlJbmZvcykuc29ydCgoW2tleUFdLCBba2V5Ql0pID0+IGtleUEubG9jYWxlQ29tcGFyZShrZXlCKSlcclxuICAgICAgKTtcclxuICAgICAgLy8gcmVzdG9yZSB0byBrZWVwIHByb3BlcnRpZXMgdG8gY2FzZSBzZW5zaXRpdmVcclxuICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSB7fTtcclxuICAgICAgT2JqZWN0LmtleXMocHJvcGVydHlJbmZvcykuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIHRoaXMua25vd25Qcm9wZXJ0aWVzW3Byb3BlcnR5SW5mb3Nba2V5XS5uYW1lXSA9IHByb3BlcnR5SW5mb3Nba2V5XTtcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMua25vd25Qcm9wZXJ0aWVzKTtcclxuICAgICAgcmV0dXJuIHRoaXMua25vd25Qcm9wZXJ0aWVzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRLbm93blByb3BlcnRpZXMoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmtub3duUHJvcGVydGllcykge1xyXG4gICAgICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IHRoaXMuZmV0Y2hDdXN0b21Qcm9wZXJ0eUluZm9zKHRoaXMuYXBwISk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmtub3duUHJvcGVydGllcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgZXh0cmFjdExpbmtQYXJ0cyhsaW5rOiBzdHJpbmcpOiB7IHBhdGg6IHN0cmluZzsgdGl0bGU6IHN0cmluZyB9IHtcclxuICAgICAgLy8gUmVtb3ZlIGFsbCBzcXVhcmUgYnJhY2tldHMgZnJvbSB0aGUgc3RyaW5nXHJcbiAgICAgIGNvbnN0IGNsZWFuZWRMaW5rID0gbGluay5yZXBsYWNlKC9bXFxbXFxdXS9nLCBcIlwiKTtcclxuICBcclxuICAgICAgLy8gU3BsaXQgdGhlIHN0cmluZyBieSB0aGUgXCJ8XCIgY2hhcmFjdGVyXHJcbiAgICAgIGNvbnN0IHBhcnRzID0gY2xlYW5lZExpbmsuc3BsaXQoXCJ8XCIpO1xyXG4gIFxyXG4gICAgICAvLyBJZiBvbmx5IG9uZSBwYXJ0IGV4aXN0cywgdXNlIGl0IGFzIGJvdGggcGF0aCBhbmQgdGl0bGVcclxuICAgICAgY29uc3QgcGF0aCA9IHBhcnRzWzBdLnRyaW0oKTtcclxuICAgICAgY29uc3QgdGl0bGUgPSBwYXJ0cy5sZW5ndGggPiAxID8gcGFydHNbMV0udHJpbSgpIDogcGF0aDtcclxuICAgICAgLy9jb25zb2xlLmxvZyhgZXh0cmFjdExpbmtQYXJ0cygke2xpbmt9KSAtPiBwYXRoOiAke3BhdGh9LCB0aXRsZTogJHt0aXRsZX1gKTtcclxuICAgICAgcmV0dXJuIHsgcGF0aCwgdGl0bGUgfTtcclxuICAgIH1cclxuICAgIHJlbW92ZUxlYWRpbmdTbGFzaChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICByZXR1cm4gcGF0aC5yZXBsYWNlKC9eXFwvKy8sIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgYWRkTGVhZGluZ1NsYXNoKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgIHJldHVybiBwYXRoLnJlcGxhY2UoL14oPyFcXC8pLywgXCIvXCIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHN0cmluZyBjb21wbGllcyB3aXRoIElTTyBTdGFuZGFyZFxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gc3RyIEFueSBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgdG8gbG9vayBmb3JcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBpc0lTT1N0cmluZyhcclxuICAgICAgc3RyOiBzdHJpbmcsXHJcbiAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICB3aXRoTWlsbGlzZWNvbmRzPzogYm9vbGVhbjtcclxuICAgICAgICB3aXRoVGltZXpvbmU/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhUaW1lPzogYm9vbGVhbjtcclxuICAgICAgICB3aXRoRGF0ZT86IGJvb2xlYW47IFxyXG4gICAgICB9ID0ge31cclxuICAgICk6IGJvb2xlYW4ge1xyXG4gICAgICBjb25zdCB7XHJcbiAgICAgICAgd2l0aE1pbGxpc2Vjb25kcyA9IGZhbHNlLFxyXG4gICAgICAgIHdpdGhUaW1lem9uZSA9IGZhbHNlLFxyXG4gICAgICAgIHdpdGhUaW1lID0gdHJ1ZSxcclxuICAgICAgICB3aXRoRGF0ZSA9IHRydWUsIFxyXG4gICAgICB9ID0gb3B0aW9ucztcclxuICAgIFxyXG4gICAgICBsZXQgZGF0ZVJlZ2V4U3RyID0gXCJeKD86XFxcXGR7NH0tKD86MFsxLTldfDFbMC0yXSktKD86MFsxLTldfFsxMl1cXFxcZHwzWzAxXSkpXCI7XHJcbiAgICAgIGxldCB0aW1lUmVnZXhTdHIgPSBcIig/OlQoPzpbMDFdXFxcXGR8MlswLTNdKTpbMC01XVxcXFxkOlswLTVdXFxcXGRcIjtcclxuICAgIFxyXG4gICAgICBpZiAod2l0aE1pbGxpc2Vjb25kcykge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIlxcXFwuXFxcXGR7M31cIjtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGlmICh3aXRoVGltZXpvbmUpIHtcclxuICAgICAgICB0aW1lUmVnZXhTdHIgKz0gXCIoPzpafFsrLV0oPzpbMDFdXFxcXGR8MlswLTNdKTpbMC01XVxcXFxkKT8pP1wiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIik/XCI7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBsZXQgcmVnZXhTdHIgPSBcIlwiO1xyXG4gICAgICBpZiAod2l0aERhdGUgJiYgd2l0aFRpbWUpIHtcclxuICAgICAgICByZWdleFN0ciA9IGAke2RhdGVSZWdleFN0cn0ke3RpbWVSZWdleFN0cn0kYDtcclxuICAgICAgfSBlbHNlIGlmICh3aXRoRGF0ZSkge1xyXG4gICAgICAgIHJlZ2V4U3RyID0gYCR7ZGF0ZVJlZ2V4U3RyfSRgO1xyXG4gICAgICB9IGVsc2UgaWYgKHdpdGhUaW1lKSB7XHJcbiAgICAgICAgcmVnZXhTdHIgPSBgXiR7dGltZVJlZ2V4U3RyLnNsaWNlKDQpfSRgOyBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7IFxyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4U3RyKTtcclxuICAgICAgcmV0dXJuIHJlZ2V4LnRlc3Qoc3RyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVHJ5IHRvIGNvbnZlcnQgQW55IFR5cGVzIHRvIGEgc3BlY2lmaWMgVHlwZVxyXG4gICAgICogQHBhcmFtIGlucHV0IFxyXG4gICAgICogQHBhcmFtIHR5cGVTdHJpbmcgJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJyB8ICdzdHJpbmdbXSdcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICB0cnlDb252ZXJ0KGlucHV0OiBhbnksIHR5cGVTdHJpbmc6ICdzdHJpbmcnIHwgJ251bWJlcicgfCAnYm9vbGVhbicgfCAnc3RyaW5nW10nKTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IHN0cmluZ1tdIHwgdW5kZWZpbmVkIHtcclxuICAgICAgc3dpdGNoICh0eXBlU3RyaW5nKSB7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcclxuICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgIGNvbnN0IG51bSA9IE51bWJlcihpbnB1dCk7XHJcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGxvd2VyVmFsdWUgPSBpbnB1dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgIGlmIChsb3dlclZhbHVlID09PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAobG93ZXJWYWx1ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAgIGlmIChpbnB1dCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChpbnB1dCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNhc2UgJ3N0cmluZ1tdJzpcclxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSAmJiBpbnB1dC5ldmVyeShpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmb3JtYXRUb1lBTUxTYXZlU3RyaW5nKHRleHQ6c3RyaW5nLCByZXBsYWNlQnk6c3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkKTpzdHJpbmcge1xyXG4gICAgICBsZXQgcmVwbGFjZVN0cmluZyA9ICctJztcclxuICAgICAgaWYgKCFyZXBsYWNlQnkgJiYgdGhpcy5zZXR0aW5ncykge1xyXG4gICAgICAgIHJlcGxhY2VTdHJpbmcgPSB0aGlzLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQgfHwgJy0nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChyZXBsYWNlQnkpIHJlcGxhY2VTdHJpbmcgPSByZXBsYWNlQnk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvW15hLXpBLVowLTlcXC1fXFwvXHUwMEU0XHUwMEY2XHUwMEZDXHUwMERGXHUwMEM0XHUwMEQ2XHUwMERDXHUwMEUxXHUwMEU5XHUwMEVEXHUwMEYzXHUwMEZBXHUwMEZEXHUwMEMxXHUwMEM5XHUwMENEXHUwMEQzXHUwMERBXHUwMEREXHUwMEUwXHUwMEU4XHUwMEVDXHUwMEYyXHUwMEY5XHUwMEMwXHUwMEM4XHUwMENDXHUwMEQyXHUwMEQ5XHUwMEUyXHUwMEVBXHUwMEVFXHUwMEY0XHUwMEZCXHUwMEMyXHUwMENBXHUwMENFXHUwMEQ0XHUwMERCXHUwMEUzXHUwMEYxXHUwMEY1XHUwMEMzXHUwMEQxXHUwMEQ1XS9nLCByZXBsYWNlU3RyaW5nKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyBhIHN0cmluZyB0byBhIFlBTUwtc2FmZSBmb3JtYXQgYnkgYWRkaW5nIHF1b3RlcyB3aGVuIG5lY2Vzc2FyeS5cclxuICAgICAqIEBwYXJhbSBpbnB1dCBUaGUgc3RyaW5nLCBib29sZWFuLCBudW1iZXIgb3IgYXJyYXkgdG8gbWFrZSBZQU1MLXNhZmVcclxuICAgICAqIEByZXR1cm5zIFRoZSBzYWZlbHkgcXVvdGVkIHN0cmluZyB3aGVuIG5lZWRlZCwgb3IgdGhlIG9yaWdpbmFsIHN0cmluZyBpZiBzYWZlXHJcbiAgICAgKi9cclxuICAgIHRvWWFtbFNhZmVTdHJpbmcoaW5wdXQ6IHN0cmluZ3xudW1iZXJ8Ym9vbGVhbnxzdHJpbmdbXSk6IHN0cmluZ3xudW1iZXJ8c3RyaW5nW10ge1xyXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICBpbnB1dC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgaW5wdXRbaW5kZXhdID0gdGhpcy50b1lhbWxTYWZlU3RyaW5nKGl0ZW0pLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgIH1cclxuICAgICAgc3dpdGNoICh0eXBlb2YgaW5wdXQpIHtcclxuICAgICAgICBjYXNlICdudW1iZXInOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6IHJldHVybiBpbnB1dCA/ICd0cnVlJyA6ICdmYWxzZSc7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcclxuICAgICAgICAgIC8vIFRyaW0gd2hpdGVzcGFjZSBmaXJzdFxyXG4gICAgICAgICAgY29uc3QgdHJpbW1lZCA9IGlucHV0LnRyaW0oKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gRW1wdHkgc3RyaW5ncyBuZWVkIHF1b3Rlc1xyXG4gICAgICAgICAgaWYgKHRyaW1tZWQgPT09ICcnKSByZXR1cm4gJ1wiXCInO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBmb3Igc3BlY2lhbCBjaGFyYWN0ZXJzL3BhdHRlcm5zIHRoYXQgcmVxdWlyZSBxdW90aW5nXHJcbiAgICAgICAgICBjb25zdCBuZWVkc1F1b3RlcyA9IC9bOnt9XFxbXFxdLCYqIz98PD49ISVAYFwiJ1xcXFxdfF5bLT9cXG5dfFtcXHNcXG5dfF5beVluTl18XlswLTldfF5bKy1dfF4odHJ1ZXxmYWxzZXx5ZXN8bm98b258b2ZmKSQvaS50ZXN0KHRyaW1tZWQpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3RyaW5nIGlzIGFscmVhZHkgcHJvcGVybHkgcXVvdGVkXHJcbiAgICAgICAgICBjb25zdCBpc0FscmVhZHlRdW90ZWQgPSAodHJpbW1lZC5zdGFydHNXaXRoKCdcIicpICYmIHRyaW1tZWQuZW5kc1dpdGgoJ1wiJykpIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0cmltbWVkLnN0YXJ0c1dpdGgoXCInXCIpICYmIHRyaW1tZWQuZW5kc1dpdGgoXCInXCIpKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKCFuZWVkc1F1b3RlcyAmJiAhaXNBbHJlYWR5UXVvdGVkKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRyaW1tZWQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIHdlIGdldCBoZXJlLCB3ZSBuZWVkIHF1b3Rlc1xyXG4gICAgICAgICAgLy8gVXNlIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBhbnkgZXhpc3RpbmcgZG91YmxlIHF1b3Rlc1xyXG4gICAgICAgICAgaWYgKCFpc0FscmVhZHlRdW90ZWQpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gYFwiJHt0cmltbWVkLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKX1cImA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIGFscmVhZHkgcXVvdGVkLCByZXR1cm4gYXMtaXNcclxuICAgICAgICAgIHJldHVybiB0cmltbWVkO1xyXG4gICAgICAgIGRlZmF1bHQ6IFxyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgdG9ZYW1sU2FmZVN0cmluZygke2lucHV0fSkgaWYgb2YgdHlwZSAnJHt0eXBlb2YgaW5wdXR9J2ApO1xyXG4gICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVwbGFjZVNwYWNlcyh0ZXh0OnN0cmluZywgcmVwbGFjZUJ5OnN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCk6c3RyaW5nIHtcclxuICAgICAgbGV0IHJlcGxhY2VTdHJpbmcgPSAnXyc7XHJcbiAgICAgIGlmICghcmVwbGFjZUJ5ICYmIHRoaXMuc2V0dGluZ3MpIHtcclxuICAgICAgICByZXBsYWNlU3RyaW5nID0gdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50IHx8ICdfJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocmVwbGFjZUJ5KSByZXBsYWNlU3RyaW5nID0gcmVwbGFjZUJ5O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL1xccysvZywgcmVwbGFjZVN0cmluZyk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0Q2FtZWxDYXNlKHRleHQ6c3RyaW5nKTpzdHJpbmcge1xyXG4gICAgICBsZXQgdGV4dFBhcnRzID0gdGV4dC5zcGxpdCgnICcpO1xyXG4gICAgICBsZXQgY29udmVydGVkVGV4dFBhcnRzOnN0cmluZ1tdID0gW107XHJcbiAgICAgIHRleHRQYXJ0cy5mb3JFYWNoKCh0ZXh0LGluZGV4KSA9PiB7XHJcbiAgICAgICAgbGV0IG5ld1RleHRQYXJ0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChpbmRleD4wKSBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgY29udmVydGVkVGV4dFBhcnRzLnB1c2gobmV3VGV4dFBhcnQpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3JtYXRVcHBlckNhbWVsQ2FzZSh0ZXh0OnN0cmluZyk6c3RyaW5nIHtcclxuICAgICAgbGV0IHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoJyAnKTtcclxuICAgICAgbGV0IGNvbnZlcnRlZFRleHRQYXJ0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgICB0ZXh0UGFydHMuZm9yRWFjaCgodGV4dCxpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXdUZXh0UGFydCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgY29udmVydGVkVGV4dFBhcnRzLnB1c2gobmV3VGV4dFBhcnQpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIGdldCB0aGUgcGF0aCB0byBhIGZpbGUgZnJvbSBhIHN0cmluZyBjb250YWluaW5nIHRoZSBmdWxsIHBhcmgvbmFtZSBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBwYXRoIHN0cmluZ1xyXG4gICAgICogQHBhcmFtIHNlcGFyYXRvciBzdHJpbmcgZGVmYXVsdHMgdG8gJy8nXHJcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9sZGVyRnJvbVBhdGggKHBhdGg6c3RyaW5nfG51bGx8dW5kZWZpbmVkLCBzZXBhcmF0b3IgPSAnLycpIHtcclxuICAgICAgICBpZiAocGF0aCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKHBhdGggPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBjdXJyZW50UGF0aFBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGN1cnJlbnRQYXRoUGFydHMucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWU7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQYXRoUGFydHMuam9pbihzZXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIHJlbW92ZXMgZHVwbGljYXRlIHN0cmluZ3MgaW4gYW4gYXJyYXkgYW5kIGRlbGV0ZXMgZW1wdHkgc3RyaW5nc1xyXG4gICAgICogQHBhcmFtIHN0cmluZ0FycmF5IFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUR1cGxpY2F0ZVN0cmluZ3Moc3RyaW5nQXJyYXk6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICBpZiAoIXN0cmluZ0FycmF5KSByZXR1cm4gW107XHJcbiAgICAgIGNvbnN0IHVuaXF1ZVN0cmluZ3NTZXQgPSBuZXcgU2V0PHN0cmluZz4oc3RyaW5nQXJyYXkpO1xyXG4gICAgICB1bmlxdWVTdHJpbmdzU2V0LmRlbGV0ZSgnJyk7IC8vIHJlbW92ZSBlbXB0eSBzdHJpbmdzXHJcbiAgICAgIHJldHVybiBbLi4udW5pcXVlU3RyaW5nc1NldF07XHJcbiAgICB9XHJcbiAgfVxyXG4vKipcclxuICogZ2V0IHRoZSBwYXRoIHRvIGEgZmlsZSBmcm9tIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIGZ1bGwgcGFyaC9uYW1lIHN0cmluZ1xyXG4gKiBAcGFyYW0gcGF0aCBzdHJpbmdcclxuICogQHBhcmFtIHNlcGFyYXRvciBzdHJpbmcgZGVmYXVsdHMgdG8gJy8nXHJcbiAqIEByZXR1cm5zIHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRlckZyb21QYXRoIChwYXRoOnN0cmluZ3xudWxsfHVuZGVmaW5lZCwgc2VwYXJhdG9yID0gJy8nKSB7XHJcbiAgICBpZiAocGF0aCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAocGF0aCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgY29uc3QgY3VycmVudFBhdGhQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgIGN1cnJlbnRQYXRoUGFydHMucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWU7XHJcbiAgICByZXR1cm4gY3VycmVudFBhdGhQYXJ0cy5qb2luKHNlcGFyYXRvcik7XHJcbn1cclxuICAgICIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEVycm9yTWFuYWdlciB9IGZyb20gXCIuL0Vycm9yXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dVcGRhdGUobXNnOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlKFwiXCIsIDE1MDAwKTtcbiAgICBub3RpY2UubWVzc2FnZUVsLmlubmVySFRNTCA9IGA8Yj5Gcm9udG1hdHRlciBBdXRvbWF0ZSB1cGRhdGU8L2I+Ojxici8+JHttc2d9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0Vycm9yKGU6IEVycm9yIHwgRXJyb3JNYW5hZ2VyKTogdm9pZCB7XG4gICAgY29uc3Qgbm90aWNlID0gbmV3IE5vdGljZShcIlwiLCA4MDAwKTtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yTWFuYWdlciAmJiBlLmNvbnNvbGVfbXNnKSB7XG4gICAgICAgIG5vdGljZS5tZXNzYWdlRWwuaW5uZXJIVE1MID0gYDxiPkZyb250bWF0dGVyIEF1dG9tYXRlIEVycm9yPC9iPjo8YnIvPiR7ZS5tZXNzYWdlfTxici8+Q2hlY2sgY29uc29sZSBmb3IgbW9yZSBpbmZvcm1hdGlvbmA7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZyb250bWF0dGVyIEVycm9yOmAsIGUubWVzc2FnZSwgXCJcXG5cIiwgZS5jb25zb2xlX21zZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbm90aWNlLm1lc3NhZ2VFbC5pbm5lckhUTUwgPSBgPGI+RnJvbnRtYXR0ZXIgQXV0b21hdGUgRXJyb3I8L2I+Ojxici8+JHtlLm1lc3NhZ2V9YDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgbG9nRXJyb3IgfSBmcm9tIFwiLi9Mb2dcIjtcblxuZXhwb3J0IGNsYXNzIEVycm9yTWFuYWdlciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcihtc2c6IHN0cmluZywgcHVibGljIGNvbnNvbGVfbXNnPzogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVycm9yV3JhcHBlcjxUPihcbiAgICBmbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgICBtc2c6IHN0cmluZ1xuKTogUHJvbWlzZTxUPiB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGZuKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgRXJyb3JNYW5hZ2VyKSkge1xuICAgICAgICAgICAgbG9nRXJyb3IobmV3IEVycm9yTWFuYWdlcihtc2csIGUubWVzc2FnZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nRXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGwgYXMgVDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlcnJvcldyYXBwZXJTeW5jPFQ+KGZuOiAoKSA9PiBULCBtc2c6IHN0cmluZyk6IFQge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmbigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nRXJyb3IobmV3IEVycm9yTWFuYWdlcihtc2csIGUubWVzc2FnZSkpO1xuICAgICAgICByZXR1cm4gbnVsbCBhcyBUO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBNb2RhbCwgQXBwLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIGRpc3BsYXkgYW4gQWxlcnQgTW9kYWxcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbGVydE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSByZXNvbHZlUHJvbWlzZTogKHZhbHVlOiB7cHJvY2VlZDpib29sZWFuLCBkYXRhOmFueX0pID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHByb21pc2U6IFByb21pc2U8e3Byb2NlZWQ6Ym9vbGVhbiwgZGF0YTphbnl9PjtcclxuICAgIHByaXZhdGUgYnRuMVRleHQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgYnRuMlRleHQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgY2hlY2tib3hFbDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIHByaXZhdGUgYXNrQWdhaW5MYWJlbDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGJ0bjE6IHN0cmluZywgYnRuMjpzdHJpbmcsIGFza0FnYWluTGFiZWw/OiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcclxuICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgIHRoaXMuYnRuMVRleHQgPSBidG4xO1xyXG4gICAgICB0aGlzLmJ0bjJUZXh0ID0gYnRuMjtcclxuICAgICAgdGhpcy5hc2tBZ2FpbkxhYmVsID0gYXNrQWdhaW5MYWJlbDtcclxuICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gIFxyXG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiB0aGlzLnRpdGxlIH0pO1xyXG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IHRoaXMuZGVzY3JpcHRpb24gfSk7XHJcbiAgXHJcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gbmV3IFNldHRpbmcoY29udGVudEVsKTtcclxuICAgICAgaWYgKHRoaXMuYXNrQWdhaW5MYWJlbCkge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1JbmZvRGl2ID0gc2V0dGluZ3Muc2V0dGluZ0VsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NldHRpbmctaXRlbS1pbmZvJylbMF07XHJcbiAgICAgICAgaWYgKGl0ZW1JbmZvRGl2KSB7XHJcbiAgICAgICAgICB0aGlzLmNoZWNrYm94RWwgPSBpdGVtSW5mb0Rpdi5jcmVhdGVFbCgnaW5wdXQnLCB7IHR5cGU6ICdjaGVja2JveCcgfSk7XHJcbiAgICAgICAgICBjb25zdCBsYWJlbCA9IGl0ZW1JbmZvRGl2LmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogdGhpcy5hc2tBZ2FpbkxhYmVsIH0pO1xyXG4gICAgICAgICAgbGFiZWwuc3R5bGUubWFyZ2luTGVmdCA9ICc4cHgnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBzZXR0aW5ncy5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4xVGV4dClcclxuICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh7cHJvY2VlZDp0cnVlLCBkYXRhOnthc2tDb25maXJtYXRpb246IHRoaXMuY2hlY2tib3hFbD8uY2hlY2tlZH19KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgc2V0dGluZ3MuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KHRoaXMuYnRuMlRleHQpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh7cHJvY2VlZDpmYWxzZSwgZGF0YTp7YXNrQ29uZmlybWF0aW9uOiB0aGlzLmNoZWNrYm94RWw/LmNoZWNrZWR9fSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgYXN5bmMgb3BlbkFuZEdldFZhbHVlKCk6IFByb21pc2U8e3Byb2NlZWQ6Ym9vbGVhbiwgZGF0YTphbnl9PiB7XHJcbiAgICAgIHRoaXMub3BlbigpO1xyXG4gICAgICByZXR1cm4gdGhpcy5wcm9taXNlO1xyXG4gICAgfVxyXG4gIH0iLCAiaW1wb3J0IHsgQXBwLCByZW5kZXJSZXN1bHRzLCBTZWFyY2hDb21wb25lbnQsIFNldHRpbmcsIFRGaWxlLCBURm9sZGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBnZXRGb2xkZXJGcm9tUGF0aCwgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scyc7XHJcbmltcG9ydCB7IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgRm9sZGVyVGFnUnVsZURlZmluaXRpb24sIEZvbGRlclRhZ1NldHRpbmdzLCBGcm9udG1hdHRlckF1dG9tYXRlRXZlbnRzIH0gZnJvbSAnLi90eXBlcyc7XHJcbmltcG9ydCB7IEF1dG9jb21wbGV0ZU1vZGFsLCBhdXRvY29tcGxldGVNb2RhbFJlc3VsdCwgb3BlbkF1dG9jb21wbGV0ZU1vZGFsIH0gZnJvbSAnLi9hdXRvY29tcGxldGVNb2RhbCc7XHJcbmltcG9ydCB7IGNvZGVFZGl0b3JNb2RhbFJlc3VsdCB9IGZyb20gJy4vZWRpdG9yTW9kYWwnO1xyXG5pbXBvcnQgeyBGb2xkZXJTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdGVycy9Gb2xkZXJTdWdnZXN0ZXJcIjtcclxuaW1wb3J0IHsgRmlsZVN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0ZXJzL0ZpbGVTdWdnZXN0ZXJcIjtcclxuaW1wb3J0IHsgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0LCBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwgfSBmcm9tICcuL2RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJztcclxuaW1wb3J0IHsgdGVzdEZ1bmt0aW9uIH0gZnJvbSAnLi9zaW1wbGVBbGVydEJveCc7XHJcbmltcG9ydCB7IEFsZXJ0TW9kYWwgfSBmcm9tICcuL2FsZXJ0Qm94JztcclxuXHJcbmV4cG9ydCB0eXBlIEZyb250bWF0dGVyQXV0b21hdGVSdWxlVHlwZXMgPSAnYnVpbGRJbicgfCAnYnVpbGRJbi5pbnB1dFByb3BlcnR5JyB8ICdhdXRvY29tcGxldGUubW9kYWwnIHwgJ2F1dG9tYXRpb24nIHwgJ3NjcmlwdCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VsZW1lbnRzIHtcclxuICAgIHJlbW92ZUNvbnRlbnQ6IGJvb2xlYW47XHJcbiAgICBydWxlQWN0aXZlOiBib29sZWFuO1xyXG4gICAgbW9kaWZ5T25seTogYm9vbGVhbjtcclxuICAgIGlucHV0UHJvcGVydHk6IGJvb2xlYW47XHJcbiAgICBhZGRQcmVmaXg6IGJvb2xlYW47XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBib29sZWFuO1xyXG4gICAgc3BlY2lhbENoYXJhY3RlclJlcGxhY2VtZW50OiBib29sZWFuO1xyXG4gICAgY29udmVydFRvTG93ZXJDYXNlOiBib29sZWFuO1xyXG4gICAgcmVzdWx0QXNMaW5rOiBib29sZWFuO1xyXG4gICAgYWRkQ29udGVudDogYm9vbGVhbjtcclxuICAgIGV4Y2x1ZGVGb2xkZXJzOiBib29sZWFuO1xyXG4gICAgaW5jbHVkZUZvbGRlcnM6IGJvb2xlYW47XHJcbiAgICBzY3JpcHQ6IGJvb2xlYW47XHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBSdWxlRnVuY3Rpb24ge1xyXG4gICAgaWQ6c3RyaW5nO1xyXG4gICAgcnVsZVR5cGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlVHlwZXM7XHJcbiAgICBkZXNjcmlwdGlvbjpzdHJpbmc7XHJcbiAgICB0b29sdGlwPzogc3RyaW5nO1xyXG4gICAgaW5wdXRQcm9wZXJ0eT86IGJvb2xlYW47XHJcbiAgICBpc0xpdmVSdWxlPzogYm9vbGVhbjtcclxuICAgIHNvdXJjZTpzdHJpbmc7XHJcbiAgICB0eXBlOk9ic2lkaWFuUHJvcGVydHlUeXBlc1tdO1xyXG4gICAgZng6RnVuY3Rpb247XHJcbiAgICBjb25maWdFbGVtZW50czogQ29uZmlnRWxlbWVudHM7XHJcbiAgICBjb25maWdUYWI/OiAob3B0aW9uRWw6IEhUTUxFbGVtZW50LCBydWxlOkZvbGRlclRhZ1J1bGVEZWZpbml0aW9uLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDphbnkpID0+IHZvaWQ7IC8vIGZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgY29uZmlnIHRhYiBmb3IgdGhlIHJ1bGVcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHJ1bGVGdW5jdGlvbnM6UnVsZUZ1bmN0aW9uW109W107XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSdWxlRnVuY3Rpb25CeUlkIChpZCA6IHN0cmluZyk6UnVsZUZ1bmN0aW9uIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiBydWxlRnVuY3Rpb25zLmZpbmQocnVsZSA9PiBydWxlLmlkID09PSBpZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFwcGx5Rm9ybWF0T3B0aW9ucyh2YWx1ZTphbnksIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24pOmFueSB7XHJcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ2RhdGUnIHx8IHJ1bGUudHlwZSA9PT0gJ2RhdGV0aW1lJykgcmV0dXJuIHZhbHVlOyAvLyBsZWF2ZSBkYXRlIGFuZCBkYXRlVGltZSB1bnRvdWNoZWRcclxuICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xyXG4gICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICBpZiAocnVsZS5zcGFjZVJlcGxhY2VtZW50ICYmIHJ1bGUuc3BhY2VSZXBsYWNlbWVudCAhPT0gJycpIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxzKy9nLCBydWxlLnNwYWNlUmVwbGFjZW1lbnQpO1xyXG4gICAgICBpZiAocnVsZS5zcGVjaWFsQ2hhclJlcGxhY2VtZW50ICYmIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCAhPT0nJykgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XHJcbiAgICAgIGlmIChydWxlLmxvd2VyY2FzZVRhZ3MpIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKHJ1bGUucHJlZml4ICYmIHJ1bGUucHJlZml4ICE9PSAnJykgdmFsdWUgPSBydWxlLnByZWZpeCArIHZhbHVlO1xyXG4gICAgICBpZiAocnVsZS5hc0xpbmspIHZhbHVlID0gYFtbJHt2YWx1ZX1dXWA7XHJcbiAgICAgIHJldHVybiB2YWx1ZVxyXG4gICAgY2FzZSAnb2JqZWN0JzpcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcCh2YWx1ZSA9PiBhcHBseUZvcm1hdE9wdGlvbnModmFsdWUsIHJ1bGUpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG4gIHJldHVyblxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSdWxlUmVzdWx0KHJ1bGVGeDogRnVuY3Rpb24sIGFwcDogQXBwLCBydWxlOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgcnVsZUZ1bmN0aW9uOiBSdWxlRnVuY3Rpb24sIGN1cnJlbnRGaWxlOiBURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMsIGZyb250TWF0dGVyOmFueSk6UHJvbWlzZTxhbnk+IHtcclxuICBsZXQgcmVzdWx0OmFueSA9IHVuZGVmaW5lZDtcclxuICAvL2NvbnNvbGUubG9nKCdnZXRSdWxlUmVzdWx0JywgcnVsZUZ4LCBydWxlRnVuY3Rpb24sIGN1cnJlbnRGaWxlLCB0b29scywgZnJvbnRNYXR0ZXIpO1xyXG4gIHN3aXRjaCAocnVsZUZ1bmN0aW9uLnJ1bGVUeXBlKSB7XHJcbiAgICBjYXNlICdzY3JpcHQnOlxyXG4gICAgY2FzZSAnYnVpbGRJbic6XHJcbiAgICAgIHJlc3VsdCA9IGFwcGx5Rm9ybWF0T3B0aW9ucyhydWxlRngoYXBwLCBjdXJyZW50RmlsZSwgdG9vbHMpLCBydWxlKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdidWlsZEluLmlucHV0UHJvcGVydHknOlxyXG4gICAgICByZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMocnVsZUZ4KGFwcCwgY3VycmVudEZpbGUsIHRvb2xzLCBmcm9udE1hdHRlcltydWxlLmlucHV0UHJvcGVydHldKSwgcnVsZSk7XHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdhdXRvY29tcGxldGUubW9kYWwnOlxyXG4gICAgICBydWxlRngoYXBwLCBjdXJyZW50RmlsZSwgdG9vbHMpO1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdhdXRvY29tcGxldGUgbW9kYWwnLCBydWxlRngsIHJ1bGVGdW5jdGlvbiwgY3VycmVudEZpbGUsIHRvb2xzKTtcclxuICAgICAgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdhdXRvbWF0aW9uJzpcclxuICAgICAgLy9jb25zb2xlLmxvZygnYXV0b21hdGlvbicsIHJ1bGVGdW5jdGlvbiwgY3VycmVudEZpbGUsIHRvb2xzKTtcclxuICAgICAgcmVzdWx0ID0gYXBwbHlGb3JtYXRPcHRpb25zKHJ1bGVGeChhcHAsIGN1cnJlbnRGaWxlLCB0b29scyksIHJ1bGUpO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGVSdWxlIChldmVudDogRnJvbnRtYXR0ZXJBdXRvbWF0ZUV2ZW50cywgYXBwLCBzZXR0aW5ncywgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCwgcmV0dXJuUmVzdWx0OiBhbnksIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24sIGZyb250TWF0dGVyLCBvbGRQYXRoPzpzdHJpbmcpIHtcclxuICAvL2NvbnNvbGUubG9nKGBFdmVudDogJHtldmVudH0gZm9yIHJ1bGUgJHtydWxlLnByb3BlcnR5fXwke3J1bGUuY29udGVudH1gLCBydWxlKTtcclxuICBpZiAoIXJ1bGUuYWN0aXZlIHx8ICFjdXJyZW50RmlsZSkgcmV0dXJuIHJldHVyblJlc3VsdDtcclxuICBjb25zdCB0b29scyA9IG5ldyBTY3JpcHRpbmdUb29scyhhcHAsIHRoaXMsIHNldHRpbmdzLCBydWxlLCBmcm9udE1hdHRlciwgY3VycmVudEZpbGUpO1xyXG4gIGxldCBmeFJlc3VsdCA9IHJldHVyblJlc3VsdDtcclxuICBsZXQgb2xkUmVzdWx0OmFueTtcclxuICBsZXQgb2xkRmlsZTpURmlsZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcclxuICBpZiAob2xkUGF0aCkge1xyXG4gICAgbGV0IG9sZEZpbGVQYXJ0cyA9IG9sZFBhdGguc3BsaXQoJy8nKTtcclxuICAgIG9sZEZpbGUgPSB7XHJcbiAgICAgIHBhdGg6IG9sZFBhdGgsXHJcbiAgICAgIGV4dGVuc2lvbjogb2xkRmlsZVBhcnRzW29sZEZpbGVQYXJ0cy5sZW5ndGgtMV0uc3BsaXQoJy4nKVsxXSxcclxuICAgICAgbmFtZTogb2xkRmlsZVBhcnRzW29sZEZpbGVQYXJ0cy5sZW5ndGgtMV0uc3BsaXQoJy4nKVswXSxcclxuICAgICAgc3RhdDogY3VycmVudEZpbGUuc3RhdCxcclxuICAgICAgYmFzZW5hbWU6IGN1cnJlbnRGaWxlLmJhc2VuYW1lLFxyXG4gICAgICB2YXVsdDogY3VycmVudEZpbGUudmF1bHQsXHJcbiAgICAgIHBhcmVudDogY3VycmVudEZpbGUucGFyZW50XHJcbiAgICB9XHJcbiAgfVxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBmdW5jdGlvbkluZGV4ID0gcnVsZUZ1bmN0aW9ucy5maW5kSW5kZXgoZnggPT4gZnguaWQgPT09IHJ1bGUuY29udGVudCk7XHJcbiAgICBpZiAoZnVuY3Rpb25JbmRleD09PS0xKXtcclxuICAgICAgY29uc29sZS5lcnJvcihgUnVsZSBmdW5jdGlvbiAke3J1bGUuY29udGVudH0gbm90IGZvdW5kIWApO1xyXG4gICAgICByZXR1cm4gcmV0dXJuUmVzdWx0OyAvLyByZXR1cm4gdGhlIG9yaWdpbmFsIHZhbHVlIGlmIHRoZSBmdW5jdGlvbiBpcyBub3QgZm91bmRcclxuICAgIH1cclxuICAgIGNvbnN0IHJ1bGVGdW5jdGlvbkNvbmZpZyA9IHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF07XHJcbiAgICB0b29scy5zZXRDdXJyZW50Q29udGVudChmcm9udE1hdHRlcltydWxlLnByb3BlcnR5XSlcclxuICAgIHRvb2xzLnNldFJ1bGUocnVsZSk7XHJcbiAgICB0b29scy5zZXRGcm9udG1hdHRlcihmcm9udE1hdHRlcik7XHJcbiAgICBzd2l0Y2ggKHJ1bGVGdW5jdGlvbkNvbmZpZy5ydWxlVHlwZSkge1xyXG4gICAgICBjYXNlICdzY3JpcHQnOiBcclxuICAgICAgICBjb25zdCBjdXN0b21SdWxlRnVuY3Rpb24gPSBwYXJzZUpTQ29kZShydWxlLmpzQ29kZSk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjdXN0b21SdWxlRnVuY3Rpb24gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCBwYXJzZSBjdXN0b20gZnVuY3Rpb24gZm9yICR7cnVsZS5jb250ZW50fSFgKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnhSZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMoY3VzdG9tUnVsZUZ1bmN0aW9uKGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKSwgcnVsZSk7XHJcbiAgICAgICAgaWYgKG9sZEZpbGUpIHtcclxuICAgICAgICAgIG9sZFJlc3VsdCA9IGFwcGx5Rm9ybWF0T3B0aW9ucyhjdXN0b21SdWxlRnVuY3Rpb24oYXBwLCBvbGRGaWxlLCB0b29scyksIHJ1bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYnVpbGRJbic6ICBcclxuICAgICAgICBjb25zdCBydWxlRnVuY3Rpb24gPSBydWxlLnVzZUN1c3RvbUNvZGUgPyBwYXJzZUpTQ29kZShydWxlLmJ1aWxkSW5Db2RlKSA6IHJ1bGVGdW5jdGlvbkNvbmZpZy5meDtcclxuICAgICAgICBpZiAodHlwZW9mIHJ1bGVGdW5jdGlvbiAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgQ291bGQgbm90IHBhcnNlIGN1c3RvbSBmdW5jdGlvbiBmb3IgJHtydWxlLmNvbnRlbnR9IWApO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ4UmVzdWx0ID0gZ2V0UnVsZVJlc3VsdChydWxlRnVuY3Rpb24sIGFwcCwgcnVsZSwgcnVsZUZ1bmN0aW9uQ29uZmlnLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyKTtcclxuICAgICAgICBpZiAob2xkRmlsZSkge1xyXG4gICAgICAgICAgICBvbGRSZXN1bHQgPSBnZXRSdWxlUmVzdWx0KHJ1bGVGdW5jdGlvbiwgYXBwLCBydWxlLCBydWxlRnVuY3Rpb25Db25maWcsIG9sZEZpbGUsIHRvb2xzLCBmcm9udE1hdHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBleGVjdXRlUnVsZTogJHtydWxlLmNvbnRlbnR9ICR7cnVsZS5wcm9wZXJ0eX0gWyR7cnVsZS50eXBlfV09ICcke2Z4UmVzdWx0fSdgKVxyXG5cclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYXV0b2NvbXBsZXRlLm1vZGFsJzpcclxuICAgICAgICBmeFJlc3VsdCA9IGdldFJ1bGVSZXN1bHQocnVsZUZ1bmN0aW9uQ29uZmlnLmZ4LCBhcHAsIHJ1bGUsIHJ1bGVGdW5jdGlvbkNvbmZpZywgY3VycmVudEZpbGUsIHRvb2xzLCBmcm9udE1hdHRlcik7XHJcbiAgICAgICAgYnJlYWs7IC8vIGhhbmRsZWQgaW4gdGhlIGF1dG9jb21wbGV0ZSBtb2RhbFxyXG4gICAgICBjYXNlICdhdXRvbWF0aW9uJzpcclxuICAgICAgICBmeFJlc3VsdCA9IGdldFJ1bGVSZXN1bHQocnVsZUZ1bmN0aW9uQ29uZmlnLmZ4LCBhcHAsIHJ1bGUsIHJ1bGVGdW5jdGlvbkNvbmZpZywgY3VycmVudEZpbGUsIHRvb2xzLCBmcm9udE1hdHRlcik7XHJcbiAgICAgICAgYnJlYWs7IC8vIGhhbmRsZWQgaW4gdGhlIGF1dG9tYXRpb24gbW9kYWxcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcbiAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBleGVjdXRpbmcgcnVsZSAke3J1bGUucHJvcGVydHl9fCR7cnVsZS5jb250ZW50fSBmb3IgZmlsZSAke2N1cnJlbnRGaWxlLnBhdGh9OiAke2Vycm9yfWApO1xyXG4gICAgcmV0dXJuIHJldHVyblJlc3VsdDsgLy8gcmV0dXJuIHRoZSBvcmlnaW5hbCB2YWx1ZSBpZiB0aGVyZSBpcyBhbiBlcnJvclxyXG4gIH1cclxuXHJcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ251bWJlcicgfHwgcnVsZS50eXBlID09PSAnY2hlY2tib3gnIHx8IHJ1bGUudHlwZSA9PT0gJ2RhdGUnIHx8IHJ1bGUudHlwZSA9PT0gJ2RhdGV0aW1lJykge1xyXG4gICAgICByZXR1cm4gZnhSZXN1bHQ7XHJcbiAgfVxyXG4gIHN3aXRjaCAocnVsZS5hZGRDb250ZW50KSB7XHJcbiAgICAgIGNhc2UgJ292ZXJ3cml0ZSc6XHJcbiAgICAgICAgICByZXR1cm5SZXN1bHQgPSBmeFJlc3VsdDsgLy8gdXBkYXRlIG9yIGFkZCB0aGUgbmV3IHZhbHVlXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZW5kJzpcclxuICAgICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFmeFJlc3VsdCkgZnhSZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgICBpZiAodHlwZW9mIGZ4UmVzdWx0ID09PSAnc3RyaW5nJykgZnhSZXN1bHQgPSBbZnhSZXN1bHRdOyAvLyBjb252ZXJ0IHN0cmluZyB0byBhcnJheSBcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmV0dXJuUmVzdWx0KSkgcmV0dXJuUmVzdWx0ID0gW3JldHVyblJlc3VsdF07XHJcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG9sZFJlc3VsdCkpIG9sZFJlc3VsdCA9IFtvbGRSZXN1bHRdO1xyXG4gICAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IHJldHVyblJlc3VsdC5maWx0ZXIoKHZhbHVlKSA9PiAhb2xkUmVzdWx0LmluY2x1ZGVzKHZhbHVlKSlcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSB0b29scy5yZW1vdmVEdXBsaWNhdGVTdHJpbmdzKGZpbHRlcmVkLmNvbmNhdChmeFJlc3VsdCkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoIXJldHVyblJlc3VsdCkgcmV0dXJuUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0LnJlcGxhY2VBbGwocmV0dXJuUmVzdWx0LG9sZFJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0ICsgZnhSZXN1bHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnc3RhcnQnOlxyXG4gICAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgICBpZiAoIWZ4UmVzdWx0KSBmeFJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZnhSZXN1bHQgPT09ICdzdHJpbmcnKSBmeFJlc3VsdCA9IFtmeFJlc3VsdF07IC8vIGNvbnZlcnQgc3RyaW5nIHRvIGFycmF5IFxyXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXR1cm5SZXN1bHQpKSByZXR1cm5SZXN1bHQgPSBbcmV0dXJuUmVzdWx0XTtcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2xkUmVzdWx0KSkgb2xkUmVzdWx0ID0gW29sZFJlc3VsdF07XHJcbiAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gcmV0dXJuUmVzdWx0LmZpbHRlcigodmFsdWUpID0+ICFvbGRSZXN1bHQuaW5jbHVkZXModmFsdWUpKVxyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MoZnhSZXN1bHQuY29uY2F0KGZpbHRlcmVkKSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICghcmV0dXJuUmVzdWx0KSByZXR1cm5SZXN1bHQgPSAnJztcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSByZXR1cm5SZXN1bHQucmVwbGFjZUFsbChyZXR1cm5SZXN1bHQsb2xkUmVzdWx0KTtcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSBmeFJlc3VsdCArIHJldHVyblJlc3VsdDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gIH1cclxuICByZXR1cm4gcmV0dXJuUmVzdWx0O1xyXG5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVJ1bGUgKGFwcCwgc2V0dGluZ3MsIGN1cnJlbnRGaWxlOiBURmlsZSwgcmV0dXJuUmVzdWx0OiBhbnksIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24sIGZyb250TWF0dGVyKSB7XHJcbiAgY29uc3QgdG9vbHMgPSBuZXcgU2NyaXB0aW5nVG9vbHMoYXBwLCBzZXR0aW5ncywgZnJvbnRNYXR0ZXIpO1xyXG4gIGxldCBmeFJlc3VsdDphbnk7XHJcbiAgaWYgKHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpIHtcclxuICAgICAgY29uc3QgcnVsZUZ1bmN0aW9uID0gcGFyc2VKU0NvZGUocnVsZS5qc0NvZGUpO1xyXG4gICAgICBpZiAodHlwZW9mIHJ1bGVGdW5jdGlvbiAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuO1xyXG4gICAgICBmeFJlc3VsdCA9IHJ1bGVGdW5jdGlvbihhcHAsIGN1cnJlbnRGaWxlLCB0b29scyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZnVuY3Rpb25JbmRleCA9IHJ1bGVGdW5jdGlvbnMuZmluZEluZGV4KGZ4ID0+IGZ4LmlkID09PSBydWxlLmNvbnRlbnQpO1xyXG4gICAgICBpZiAoZnVuY3Rpb25JbmRleCE9PS0xKXtcclxuICAgICAgICAgIGNvbnN0IHJ1bGVGdW5jdGlvbiA9IHJ1bGUudXNlQ3VzdG9tQ29kZSA/IHBhcnNlSlNDb2RlKHJ1bGUuYnVpbGRJbkNvZGUpIDogcnVsZUZ1bmN0aW9uc1tmdW5jdGlvbkluZGV4XS5meDtcclxuICAgICAgICAgIGlmICh0eXBlb2YgcnVsZUZ1bmN0aW9uICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCBwYXJzZSBjdXN0b20gZnVuY3Rpb24gZm9yICR7cnVsZS5jb250ZW50fSFgKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF0uaW5wdXRQcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICBmeFJlc3VsdCA9IGFwcGx5Rm9ybWF0T3B0aW9ucyhydWxlRnVuY3Rpb24oYXBwLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyW3J1bGUuaW5wdXRQcm9wZXJ0eV0pLCBydWxlKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZ4UmVzdWx0ID0gYXBwbHlGb3JtYXRPcHRpb25zKHJ1bGVGdW5jdGlvbihhcHAsIGN1cnJlbnRGaWxlLCB0b29scyksIHJ1bGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgfVxyXG4gIHN3aXRjaCAocnVsZS5hZGRDb250ZW50KSB7XHJcbiAgICAgIGNhc2UgJ292ZXJ3cml0ZSc6XHJcbiAgICAgICAgICByZXR1cm5SZXN1bHQgPSBmeFJlc3VsdDsgLy8gdXBkYXRlIG9yIGFkZCB0aGUgbmV3IHZhbHVlXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZW5kJzpcclxuICAgICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFmeFJlc3VsdCkgZnhSZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgICBpZiAodHlwZW9mIGZ4UmVzdWx0ID09PSAnc3RyaW5nJykgZnhSZXN1bHQgPSBbZnhSZXN1bHRdOyAvLyBjb252ZXJ0IHN0cmluZyB0byBhcnJheSBcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmV0dXJuUmVzdWx0KSkgcmV0dXJuUmVzdWx0ID0gW3JldHVyblJlc3VsdF07XHJcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGZ4UmVzdWx0KSkgZnhSZXN1bHQgPSBbZnhSZXN1bHRdO1xyXG4gICAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IHJldHVyblJlc3VsdC5maWx0ZXIoKHZhbHVlKSA9PiAhZnhSZXN1bHQuaW5jbHVkZXModmFsdWUpKVxyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MoZmlsdGVyZWQpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoIXJldHVyblJlc3VsdCkgcmV0dXJuUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0LnJlcGxhY2VBbGwocmV0dXJuUmVzdWx0LGZ4UmVzdWx0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzdGFydCc6XHJcbiAgICAgICAgICBpZiAocnVsZS50eXBlID09PSAnbXVsdGl0ZXh0JyB8fCBydWxlLnR5cGUgPT09ICd0YWdzJyB8fCBydWxlLnR5cGUgPT09ICdhbGlhc2VzJykge1xyXG4gICAgICAgICAgICAgIGlmICghZnhSZXN1bHQpIGZ4UmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmeFJlc3VsdCA9PT0gJ3N0cmluZycpIGZ4UmVzdWx0ID0gW2Z4UmVzdWx0XTsgLy8gY29udmVydCBzdHJpbmcgdG8gYXJyYXkgXHJcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJldHVyblJlc3VsdCkpIHJldHVyblJlc3VsdCA9IFtyZXR1cm5SZXN1bHRdO1xyXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShmeFJlc3VsdCkpIGZ4UmVzdWx0ID0gW2Z4UmVzdWx0XTtcclxuICAgICAgICAgICAgICBsZXQgZmlsdGVyZWQgPSByZXR1cm5SZXN1bHQuZmlsdGVyKCh2YWx1ZSkgPT4gIWZ4UmVzdWx0LmluY2x1ZGVzKHZhbHVlKSlcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSB0b29scy5yZW1vdmVEdXBsaWNhdGVTdHJpbmdzKGZpbHRlcmVkKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFyZXR1cm5SZXN1bHQpIHJldHVyblJlc3VsdCA9ICcnO1xyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHJldHVyblJlc3VsdC5yZXBsYWNlQWxsKHJldHVyblJlc3VsdCxmeFJlc3VsdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICB9XHJcbiAgcmV0dXJuIHJldHVyblJlc3VsdDtcclxuXHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogRmlsdGVycyBhIGdpdmVuIGZpbGUgYW5kIHJldHVybnMgdHJ1ZSBpZiBpdCBpcyBpbmNsdWRlZCBpbiBhIGZvbGRlciBvciBmaWxlIGxpc3RcclxuICAgKiBAcGFyYW0gZmlsZSBcclxuICAgKiBAcGFyYW0gZmlsdGVyTW9kZSAnZXhjbHVkZSd8J2luY2x1ZGUnXHJcbiAgICogQHBhcmFtIHR5cGUgJ2ZvbGRlcnMnfCdmaWxlcydcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckZpbGUoZmlsZTogVEZpbGUsIGZpbGVMaXN0OiBhbnksIGZpbHRlck1vZGU6IHN0cmluZywgdHlwZTpzdHJpbmcpOmJvb2xlYW4ge1xyXG4gICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgY29uc3QgZmlsdGVyQXJyYXkgPSAodHlwZT09PSdmb2xkZXJzJykgPyBmaWxlTGlzdFtmaWx0ZXJNb2RlXS5zZWxlY3RlZEZvbGRlcnMgOiBmaWxlTGlzdFtmaWx0ZXJNb2RlXS5zZWxlY3RlZEZpbGVzO1xyXG4gICAgaWYgKGZpbHRlckFycmF5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIChmaWx0ZXJNb2RlID09PSAnaW5jbHVkZScpPyBmYWxzZSA6IHRydWU7XHJcbiAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcclxuICAgIGNvbnN0IGZpbGVGb2xkZXIgPSBnZXRGb2xkZXJGcm9tUGF0aChmaWxlLnBhdGgpO1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lICsgJy4nICsgZmlsZS5leHRlbnNpb247XHJcbiAgICBcclxuICAgIGlmICh0eXBlID09PSAnZmlsZXMnKSB7XHJcbiAgICAgICAgcmVzdWx0ID0gZmlsdGVyQXJyYXkuaW5jbHVkZXMoZmlsZVBhdGgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGUgPT09ICdmb2xkZXJzJykge1xyXG4gICAgICAgIGZvciAobGV0IHBhdGggb2YgZmlsdGVyQXJyYXkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gZmlsZUZvbGRlcj8uc3RhcnRzV2l0aChwYXRoLnNsaWNlKDEpKSB8fCBmYWxzZTsgLy8gcmVtb3ZlIHJvb3QgJy8nXHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybiAoZmlsdGVyTW9kZSA9PT0gJ2V4Y2x1ZGUnKT8gIXJlc3VsdCA6IHJlc3VsdDs7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gKGZpbHRlck1vZGUgPT09ICdleGNsdWRlJyk/ICFyZXN1bHQgOiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0lmRmlsZUFsbG93ZWQoZmlsZTogVEZpbGUsIHNldHRpbmdzPzpGb2xkZXJUYWdTZXR0aW5ncywgcnVsZT86Rm9sZGVyVGFnUnVsZURlZmluaXRpb24pOmJvb2xlYW4ge1xyXG4gICAgICBsZXQgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChzZXR0aW5ncyAmJiAhcnVsZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKGBjaGVjayBmaWxlICR7ZmlsZS5wYXRofSBhZ2FpbnN0IHNldHRpbmdzYCwgc2V0dGluZ3MuaW5jbHVkZSwgc2V0dGluZ3MuZXhjbHVkZSk7XHJcbiAgICAgICAgICBpZiAoc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgZXhjbHVkZSBmaWxlcyBsaXN0LlxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgc2V0dGluZ3MsICdleGNsdWRlJywgJ2ZpbGVzJyk7ICAgIFxyXG4gICAgICAgICAgfSAgICAgICAgXHJcbiAgICAgICAgICBpZiAoc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0LlxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgc2V0dGluZ3MsICdleGNsdWRlJywgJ2ZvbGRlcnMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChzZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZpbGVzIGluIHRoZSBpbmNsdWRlIGZpbGVzIGxpc3RcclxuICAgICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJGaWxlKGZpbGUsIHNldHRpbmdzLCAnaW5jbHVkZScsICdmaWxlcycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmb2xkZXJzIGluIHRoZSBpbmNsdWRlIGZvbGRlcnMgbGlzdFxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgc2V0dGluZ3MsICdpbmNsdWRlJywgJ2ZvbGRlcnMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7IC8vIGlmIHRoZSBmaWxlIGlzIGV4Y2x1ZGVkLCByZXR1cm4gZmFsc2VcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZmlsdGVyaW5nIGZpbGUgJHtmaWxlLnBhdGh9IGdsb2JhbGx5OiAke2Vycm9yfWApO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBkZWZhdWx0IHRvIGZhbHNlIGlmIHRoZXJlIGlzIGFuIGVycm9yXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKHJ1bGUpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhgY2hlY2sgZmlsZSAke2ZpbGUucGF0aH0gYWdhaW5zdCBydWxlYCwgcnVsZS5pbmNsdWRlLCBydWxlLmV4Y2x1ZGUpO1xyXG4gICAgICAgICAgaWYgKHJ1bGUuZXhjbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgZXhjbHVkZSBmaWxlcyBsaXN0LlxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgcnVsZSwgJ2V4Y2x1ZGUnLCAnZmlsZXMnKTtcclxuICAgICAgICAgIH0gICAgICAgIFxyXG4gICAgICAgICAgaWYgKHJ1bGUuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0LlxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgcnVsZSwgJ2V4Y2x1ZGUnLCAnZm9sZGVycycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHJ1bGUuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgaW5jbHVkZSBmaWxlcyBsaXN0XHJcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZmlsdGVyRmlsZShmaWxlLCBydWxlLCAnaW5jbHVkZScsICdmaWxlcycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHJ1bGUuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0XHJcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZmlsdGVyRmlsZShmaWxlLCBydWxlLCAnaW5jbHVkZScsICdmb2xkZXJzJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZpbHRlcmluZyBmaWxlICR7ZmlsZS5wYXRofSBieSBydWxlICR7cnVsZS5wcm9wZXJ0eX18JHtydWxlLmNvbnRlbnR9OiAke2Vycm9yfWApO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBkZWZhdWx0IHRvIGZhbHNlIGlmIHRoZXJlIGlzIGFuIGVycm9yXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlZmF1bHRDb25maWdFbGVtZW50cyhtb2RpZmllcnM6Q29uZmlnRWxlbWVudHMgfCBhbnkpOkNvbmZpZ0VsZW1lbnRzIHtcclxuICBjb25zdCBjb25maWdFbGVtZW50czogQ29uZmlnRWxlbWVudHMgPSB7XHJcbiAgICByZW1vdmVDb250ZW50OiB0cnVlLFxyXG4gICAgcnVsZUFjdGl2ZTogdHJ1ZSxcclxuICAgIG1vZGlmeU9ubHk6IHRydWUsXHJcbiAgICBpbnB1dFByb3BlcnR5OiBmYWxzZSxcclxuICAgIGFkZFByZWZpeDogdHJ1ZSxcclxuICAgIHNwYWNlUmVwbGFjZW1lbnQ6IHRydWUsXHJcbiAgICBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IHRydWUsXHJcbiAgICBjb252ZXJ0VG9Mb3dlckNhc2U6IHRydWUsXHJcbiAgICByZXN1bHRBc0xpbms6IHRydWUsXHJcbiAgICBhZGRDb250ZW50OiB0cnVlLFxyXG4gICAgZXhjbHVkZUZvbGRlcnM6IHRydWUsXHJcbiAgICBpbmNsdWRlRm9sZGVyczogdHJ1ZSwgXHJcbiAgICBzY3JpcHQ6IHRydWUsXHJcbiAgfVxyXG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb25maWdFbGVtZW50cywgbW9kaWZpZXJzKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERldGVybWluZXMgd2hldGhlciBhIHNwZWNpZmljIG9wdGlvbiBpcyBlbmFibGVkIGZvciBhIGdpdmVuIHJ1bGUgZnVuY3Rpb24uXHJcbiAqXHJcbiAqIEBwYXJhbSBydWxlRm4gLSBUaGUgcnVsZSBmdW5jdGlvbiBvYmplY3QsIHdoaWNoIG1heSBiZSB1bmRlZmluZWQuIElmIGRlZmluZWQsIGl0IHNob3VsZCBjb250YWluIGEgYGNvbmZpZ0VsZW1lbnRzYCBwcm9wZXJ0eS5cclxuICogQHBhcmFtIG9wdGlvbiAtIFRoZSBuYW1lIG9mIHRoZSBvcHRpb24gdG8gY2hlY2sgd2l0aGluIHRoZSBgY29uZmlnRWxlbWVudHNgIG9mIHRoZSBydWxlIGZ1bmN0aW9uLlxyXG4gKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyB1bmRlZmluZWQgaW4gdGhlIGBjb25maWdFbGVtZW50c2Agb3IgaWYgdGhlIG9wdGlvbiBpcyBleHBsaWNpdGx5IHNldCB0byBgdHJ1ZWAuXHJcbiAqICAgICAgICAgIFJldHVybnMgYGZhbHNlYCBpZiB0aGUgb3B0aW9uIGlzIGV4cGxpY2l0bHkgc2V0IHRvIGBmYWxzZWAuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdXNlUnVsZU9wdGlvbihydWxlRm4gOiBSdWxlRnVuY3Rpb24gfCB1bmRlZmluZWQsIG9wdGlvbiA6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGlmIChydWxlRm4/LmNvbmZpZ0VsZW1lbnRzW29wdGlvbl0gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7XHJcbiAgcmV0dXJuIHJ1bGVGbi5jb25maWdFbGVtZW50c1tvcHRpb25dO1xyXG59XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RlZmF1bHQnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnUGFzcyBwYXJhbWV0ZXInLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICB0eXBlOiBbJ3RleHQnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6IGZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICBpZDonZnVsbFBhdGgnLFxyXG4gIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgZGVzY3JpcHRpb246ICdGdWxsIHBhdGgsIGZpbGVuYW1lJyxcclxuICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBmaWxlIG5hbWVcXG4gICAgcmVzdWx0ID0gcmVzdWx0ICsgcGFydHMuam9pbignLycpO1xcbiAgfVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsJ211bHRpdGV4dCddLFxyXG4gIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgIHBhcnRzLnB1c2goZmlsZS5iYXNlbmFtZSk7XHJcbiAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZnVsbFBhdGhFeHQnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBwYXRoLCBmaWxlbmFtZSBhbmQgRXh0ZW5zaW9uJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCByZXN1bHQgPSBmaWxlLnBhdGg7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6IGZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7ZmlsZS5wYXRofWA7XHJcbiAgICAgICAgfVxyXG59KTtcclxuLypcclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidhbGlhc0Zyb21QYXRoJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnQW4gQWxpYXMgZnJvbSBldmVyeSBmb2xkZXIgb2YgdGhlIGZpbGUgUGF0aCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgbGV0IHBhdGhBcnJheSA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgcGF0aEFycmF5LnBvcCgpOyAvLyByZW1vdmUgRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uXFxuICBwYXRoQXJyYXkgPSBwYXRoQXJyYXkubWFwKChkaXIpID0+IHRvb2xzLmZvcm1hdFVwcGVyQ2FtZWxDYXNlKGRpcikpOyAvLyBjb252ZXJ0IHRvIFVwcGVyQ2FtZWxDYXNlXFxuICBjb25zdCBmaWxlTmFtZVBhcnRzID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XFxuICBpZiAoZmlsZU5hbWVQYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIGZpbGVOYW1lUGFydHMucG9wKCk7IC8vIHJlbW92ZSBFeHRlbnNpb25cXG4gIH1cXG4gIGNvbnN0IGZpbGVOYW1lID0gZmlsZU5hbWVQYXJ0cy5qb2luKCcuJyk7IC8vIHJlYnVpbGQgZmlsZSBOYW1lXFxuICBwYXRoQXJyYXkucHVzaCh0b29scy5mb3JtYXRVcHBlckNhbWVsQ2FzZShmaWxlTmFtZSkpOyAvLyBhZGQgZmlsZSBuYW1lIHdpdGhvdXQgZXh0ZW5zaW9uIGFuZCBpbiBVcHBlckNhbWVsQ2FzZVxcbiAgY29uc3QgcmVzdWx0ID0gcGF0aEFycmF5LmpvaW4oJy4nKSB8fCAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWydhbGlhc2VzJ10sXHJcbiAgICBmeDogZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgICAgIGxldCBwYXRoQXJyYXkgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgcGF0aEFycmF5LnBvcCgpOyAvLyByZW1vdmUgRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uXHJcbiAgICAgICAgICAgIHBhdGhBcnJheSA9IHBhdGhBcnJheS5tYXAoKGRpcikgPT4gdG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZGlyKSk7IC8vIGNvbnZlcnQgdG8gdXBwZXIgY2FtZWxDYXNlXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lUGFydHMgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgaWYgKGZpbGVOYW1lUGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBmaWxlTmFtZVBhcnRzLnBvcCgpOyAvLyByZW1vdmUgRXh0ZW5zaW9uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlTmFtZVBhcnRzLmpvaW4oJy4nKTsgLy8gcmVidWlsZCBmaWxlIE5hbWVcclxuICAgICAgICAgICAgcGF0aEFycmF5LnB1c2godG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZmlsZU5hbWUpKTsgLy8gYWRkIGZpbGUgbmFtZSB3aXRob3V0IGV4dGVuc2lvbiBhbmQgaW4gdXBwZXJDYW1lbENhc2VcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcGF0aEFycmF5LmpvaW4oJy4nKSB8fCAnJztcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbn0pO1xyXG4qL1xyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J3BhdGgnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBQYXRoJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2xpbmtUb0ZpbGUnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnTGluayB0byBmaWxlJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCdtdWx0aXRleHQnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe3Jlc3VsdEFzTGluazogZmFsc2V9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcclxuICAgICAgICBpZiAoIXJ1bGUpIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpO1xyXG4gICAgICAgIGNvbnN0IGFkZEV4dGVuc2lvbiA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdhZGRFeHRlbnNpb24nKSBcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTFdID09PSBmaWxlLmJhc2VuYW1lKSBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBsZXQgZmlsZU5hbWUgPSBhZGRFeHRlbnNpb24/IGZpbGUuYmFzZW5hbWUgKyAnLicgKyBmaWxlLmV4dGVuc2lvbiA6IGZpbGUuYmFzZW5hbWU7IFxyXG4gICAgICAgIHJldHVybiBgW1ske3BhcnRzLmpvaW4oJy8nKX0vJHtmaWxlTmFtZX18JHtmaWxlLmJhc2VuYW1lfV1dYDtcclxuICAgIH0sXHJcbiAgICBjb25maWdUYWI6IGZ1bmN0aW9uIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24sIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50KSB7XHJcblxyXG4gICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgICBhZGRFeHRlbnNpb246IHRydWVcclxuICAgICAgfSlcclxuICBcclxuICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgZmlsZSBleHRlbnNpb24nKVxyXG4gICAgICAgIC5zZXREZXNjKCdBZGQgZmlsZSBleHRlbnNpb24gdG8gcGF0aG5hbWUnKVxyXG4gICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2FkZEV4dGVuc2lvbicpIHx8IGZhbHNlKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdhZGRFeHRlbnNpb24nLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0gIFxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDoncGF0aEZvbGRlck5vdGVzJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1BhdGggKGZvbGRlciBub3RlcyknLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICAgIHJlc3VsdCA9IHJlc3VsdCArIHBhcnRzLmpvaW4oJy8nKTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsJ211bHRpdGV4dCddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTFdID09PSBmaWxlLmJhc2VuYW1lKSBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIHBhcmVudCBmb2xkZXIgaWYgc2FtZSBuYW1lIGFzIHRoZSBmaWxlXHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gIGlkOidmdWxsUGF0aEZvbGRlck5vdGVzJyxcclxuICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gIGRlc2NyaXB0aW9uOiAnRnVsbCBQYXRoIChjb21wbHkgd2l0aCBcImZvbGRlciBub3Rlc1wiKScsXHJcbiAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICAgIHJlc3VsdCA9IHJlc3VsdCArIHBhcnRzLmpvaW4oJy8nKTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXHJcbiAgICAgIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gPT09IGZpbGUuYmFzZW5hbWUpIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgcGFyZW50IGZvbGRlciBpZiBzYW1lIG5hbWUgYXMgdGhlIGZpbGVcclxuICAgICAgcGFydHMucHVzaChmaWxlLmJhc2VuYW1lKTsgLy8gYWRkIHRoZSBmaWxlIG5hbWUgYmFja1xyXG4gICAgICByZXR1cm4gcGFydHMuam9pbignLycpO1xyXG4gIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2Z1bGxQYXRoRXh0Rm9sZGVyTm90ZXMnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBQYXRoIHdpdGggRXh0ZW5zaW9uIChjb21wbHkgd2l0aCBcImZvbGRlciBub3Rlc1wiKScsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBmaWxlIG5hbWVcXG4gICAgcmVzdWx0ID0gcmVzdWx0ICsgcGFydHMuam9pbignLycpO1xcbiAgfVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICB0eXBlOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXHJcbiAgICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBwYXJlbnQgZm9sZGVyIGlmIHNhbWUgbmFtZSBhcyB0aGUgZmlsZVxyXG4gICAgICAgIHBhcnRzLnB1c2goZmlsZS5uYW1lKTsgLy8gYWRkIHRoZSBmaWxlIG5hbWUgYmFja1xyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidpc1Jvb3QnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRmlsZSBpbiBSb290IGZvbGRlcicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcXG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPT09IDE7XFxufVwiLFxyXG4gICAgdHlwZTogWydjaGVja2JveCddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZm9sZGVyJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1BhcmVudCBGb2xkZXInLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHJlc3VsdCA9IHBhcnRzW3BhcnRzLmxlbmd0aC0yXTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgcmVzdWx0ID0gcGFydHNbcGFydHMubGVuZ3RoLTJdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmb2xkZXJGb2xkZXJOb3RlcycsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdQYXJlbnQgRm9sZGVyIChjb21wbGllcyB3aXRoIFwiZm9sZGVyIG5vdGVzXCIpJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgaW5kZXggPSBwYXJ0cy5sZW5ndGgtMjsgLy8gaW5kZXggb2YgcGFyZW50IGZvbGRlclxcbiAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0yXT09PWZpbGUuYmFzZW5hbWUpIHtcXG4gICAgICBpbmRleC0tOyAvLyBmb2xkZXIgbm90ZSBwYXJlbnQgaXMgdGhlIGNoaWxkXFxuICB9XFxuICBpZiAoaW5kZXggPj0gMCkge1xcbiAgICByZXR1cm4gcGFydHNbaW5kZXhdOyAvLyBmaWxlIGluIGZvbGRlclxcbiAgfSBlbHNlIHtcXG4gICAgcmV0dXJuIHRvb2xzLmFwcD8udmF1bHQ/LmdldE5hbWUoKSB8fCAnVmF1bHQnOyAvLyBmaWxlIGluIHJvb3QgPSB2YXVsdFxcbiAgfVxcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICBjb25zdCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICBsZXQgaW5kZXggPSBwYXJ0cy5sZW5ndGgtMjsgLy8gaW5kZXggb2YgcGFyZW50IGZvbGRlclxyXG4gICAgICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTJdPT09ZmlsZS5iYXNlbmFtZSkge1xyXG4gICAgICAgICAgaW5kZXgtLTsgLy8gZm9sZGVyIG5vdGUgcGFyZW50IGlzIHRoZSBjaGlsZFxyXG4gICAgICB9XHJcbiAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzW2luZGV4XTsgLy8gZmlsZSBpbiBmb2xkZXJcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdG9vbHMuYXBwPy52YXVsdD8uZ2V0TmFtZSgpIHx8ICdWYXVsdCc7IC8vIGZpbGUgaW4gcm9vdCA9IHZhdWx0XHJcbiAgICAgIH1cclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZvbGRlcnMnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnQWxsIGZvbGRlcnMgb2YgdGhlIGZpbGUgYXMgYSBsaXN0JyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7IC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBmaWxlIG5hbWVcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWydtdWx0aXRleHQnLCd0YWdzJywnYWxpYXNlcyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIHJlc3VsdC5wb3AoKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidyb290Rm9sZGVyJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1Jvb3QgZm9sZGVyJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICByZXN1bHQgPSBwYXJ0c1swXTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICByZXN1bHQgPSBwYXJ0c1swXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonbmFtZScsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIG5hbWUgd2l0aG91dCBleHRlbnNpb24nLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xcbiAgcmVzdWx0LnBvcCgpOyAvLyByZW1vdmUgZXh0ZW5zaW9uXFxuICByZXN1bHQuam9pbignLicpOyAvLyByZWNvbnN0cnVjdCB0aGUgZmlsZSBuYW1lXFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBleHRlbnNpb25cclxuICAgICAgICByZXN1bHQuam9pbignLicpOyAvLyByZWNvbnN0cnVjdCB0aGUgZmlsZSBuYW1lXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonbmFtZUV4dCcsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIG5hbWUgd2l0aCBleHRlbnNpb24nLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZTtcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidnZXRQcm9wZXJ0eScsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4uaW5wdXRQcm9wZXJ0eScsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0dldCBhIHByb3BlcnR5JyxcclxuICAgIGlzTGl2ZVJ1bGU6IHRydWUsXHJcbiAgICBpbnB1dFByb3BlcnR5OiB0cnVlLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgY29uc3QgcmVzdWx0ID0gaW5wdXQ7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICdtdWx0aXRleHQnLCAndGFncycsICdhbGlhc2VzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzLCBpbnB1dD8pIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gaW5wdXQ7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZGF0ZVRpbWVDcmVhdGVkJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGUgKGFuZCBUaW1lKSBjcmVhdGVkJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHRpbWVPZmZzZXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lem9uZU9mZnNldCgpKjYwMDAwOyAvLyBnZXQgbG9jYWwgdGltZSBvZmZzZXRcXG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlKGZpbGUuc3RhdC5jdGltZS10aW1lT2Zmc2V0KTtcXG4gIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbFxcbn1cIixcclxuICAgIHR5cGU6IFsnZGF0ZScsICdkYXRldGltZSddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IFxyXG4gICAgICAgIGNvbnN0IHRpbWVPZmZzZXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lem9uZU9mZnNldCgpKjYwMDAwOyAvLyBnZXQgbG9jYWwgdGltZSBvZmZzZXRcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgRGF0ZShmaWxlLnN0YXQuY3RpbWUtdGltZU9mZnNldCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdC50b0lTT1N0cmluZygpLnNwbGl0KCdaJylbMF07IC8vIHJlbW92ZSBVVEMgc3ltYm9sXHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RhdGVUaW1lTW9kaWZpZWQnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRGF0ZSAoYW5kIFRpbWUpIG1vZGlmaWVkJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHRpbWVPZmZzZXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lem9uZU9mZnNldCgpKjYwMDAwO1xcbiAgY29uc3QgcmVzdWx0ID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lLXRpbWVPZmZzZXQpOyAvLyBBcHBseSBvZmZzZXQgdG8gR01UIFRpbWVzdGFtcFxcbiAgcmV0dXJuIHJlc3VsdC50b0lTT1N0cmluZygpLnNwbGl0KCdaJylbMF07IC8vIHJlbW92ZSBVVEMgc3ltYm9sXFxufVwiLFxyXG4gICAgdHlwZTogWydkYXRlJywgJ2RhdGV0aW1lJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgXHJcbiAgICAgICAgY29uc3QgdGltZU9mZnNldCA9IG5ldyBEYXRlKERhdGUubm93KCkpLmdldFRpbWV6b25lT2Zmc2V0KCkqNjAwMDA7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lLXRpbWVPZmZzZXQpOyAvLyBBcHBseSBvZmZzZXQgdG8gR01UIFRpbWVzdGFtcFxyXG4gICAgICAgIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbFxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmaWxlU2l6ZUJ5dGVzJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgc2l6ZSBpbiBieXRlcycsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5zdGF0LnNpemU7XFxuICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICB0eXBlOiBbJ251bWJlciddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBzaXplXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZS5zdGF0LnNpemU7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZpbGVTaXplU3RyaW5nJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgc2l6ZSBmb3JtYXR0ZWQgYXMgdGV4dCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxcbiAgbGV0IHNpemUgPWZpbGUuc3RhdC5zaXplO1xcbiAgY29uc3QgcHJlY2lzaW9uID0gMjsgLy8gbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzXFxuICBpZiAoc2l6ZSA+IDEwMjQpIHtcXG4gICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcXG4gICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XFxuICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XFxuICAgICAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQoc2l6ZSkudG9GaXhlZChwcmVjaXNpb24pICsgJyBHQic7XFxuICAgICAgfSBcXG4gICAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQoc2l6ZSkudG9GaXhlZChwcmVjaXNpb24pICsgJyBNQic7XFxuICAgIH1cXG4gICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgS0InO1xcbiAgfSAgIFxcbiAgcmV0dXJuIHNpemUgKyAnIEJ5dGVzJzsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0J10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHNpemVcclxuICAgICAgICBsZXQgc2l6ZSA9ZmlsZS5zdGF0LnNpemU7XHJcbiAgICAgICAgY29uc3QgcHJlY2lzaW9uID0gMjsgLy8gbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzXHJcbiAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBHQic7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgTUInO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBLQic7XHJcbiAgICAgICAgfSAgIFxyXG4gICAgICAgIHJldHVybiBzaXplICsgJyBCeXRlcyc7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICBpZDogJ2F1dG9jb21wbGV0ZS5tb2RhbCcsXHJcbiAgcnVsZVR5cGU6ICdhdXRvY29tcGxldGUubW9kYWwnLFxyXG4gIGRlc2NyaXB0aW9uOiAnQXV0b2NvbXBsZXRlIE1vZGFsIChhZHZhbmNlZCknLFxyXG4gIGlzTGl2ZVJ1bGU6IHRydWUsXHJcbiAgc291cmNlOiAnJyxcclxuICB0eXBlOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywnbXVsdGl0ZXh0J10sXHJcbiAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7cmVtb3ZlQ29udGVudDogZmFsc2UsICBpbnB1dFByb3BlcnR5OiBmYWxzZSwgYWRkUHJlZml4OiBmYWxzZSwgc3BhY2VSZXBsYWNlbWVudDogZmFsc2UsIHNwZWNpYWxDaGFyYWN0ZXJSZXBsYWNlbWVudDogZmFsc2UsIGNvbnZlcnRUb0xvd2VyQ2FzZTogZmFsc2UsIHJlc3VsdEFzTGluazogZmFsc2UsIGFkZENvbnRlbnQ6IGZhbHNlLCBzY3JpcHQ6IGZhbHNlfSksXHJcbiAgZng6IGFzeW5jIGZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgY29uc29sZS5sb2coYGF1dG9jb21wbGV0ZSBtb2RhbCwgd29yayBpbiBwcm9ncmVzcy4uLmApO1xyXG4gICAgY29uc3QgY3VycmVudENvbnRlbnQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpO1xyXG4gICAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcclxuICAgIGlmICghcnVsZSkgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyhydWxlLmlkKTtcclxuICAgIGlmICghcnVsZSkgcmV0dXJuIHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCkgfHwgJ2F1dG9jb21wbGV0ZS5tb2RhbCc7IC8vIHJldHVybiBjdXJyZW50IGNvbnRlbnQgaWYgbm90IGltcGxlbWVudGVkIHlldFxyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0b29scy5nZXRGcm9udG1hdHRlcigpO1xyXG4gICAgY29uc3QgaGFzQXV0b2NvbXBsZXRlUHJvcGVydGllcyA9IE9iamVjdC5rZXlzKGZyb250bWF0dGVyKS5zb21lKGtleSA9PiBcclxuICAgICAga2V5LnN0YXJ0c1dpdGgocnVsZS5wcm9wZXJ0eSArIG9wdGlvbnMucHJvcGVydHlEZWxpbWl0ZXIpICYmXHJcbiAgICAgIChmcm9udG1hdHRlcltrZXldID09PSB1bmRlZmluZWQgfHxcclxuICAgICAgZnJvbnRtYXR0ZXJba2V5XSA9PT0gbnVsbCB8fFxyXG4gICAgICBmcm9udG1hdHRlcltrZXldID09PSAnJylcclxuICAgICk7XHJcbiAgICBpZiAoIWhhc0F1dG9jb21wbGV0ZVByb3BlcnRpZXMpIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpIHx8ICdhdXRvY29tcGxldGUubW9kYWwnOyAvLyByZXR1cm4gY3VycmVudCBjb250ZW50IGlmIG5vdCBpbXBsZW1lbnRlZCB5ZXRcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZW5BdXRvY29tcGxldGVNb2RhbChcclxuICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICBydWxlLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgdG9vbHMuZ2V0QWN0aXZlRmlsZSgpLFxyXG4gICAgICAgIHRvb2xzLmdldEZyb250bWF0dGVyKClcclxuICAgICAgKTtcclxuICAgIGNvbnNvbGUubG9nKCdhdXRvY29tcGxldGUgbW9kYWwgcmVzdWx0JywgcmVzdWx0LCB0b29scy5nZXRGcm9udG1hdHRlcigpKTtcclxuICAgIGlmIChyZXN1bHQ/LnZhbHVlcykge1xyXG4gICAgICB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocmVzdWx0LnZhbHVlcykpIHtcclxuICAgICAgICAgIGZyb250bWF0dGVyW2tleV0gPSB2YWx1ZTsgLy8gc2V0IHRoZSBmcm9udG1hdHRlciB2YWx1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSx7J210aW1lJzpmaWxlLnN0YXQubXRpbWV9KTsgLy8gZG8gbm90IGNoYW5nZSB0aGUgbW9kaWZ5IHRpbWUuXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKSB8fCAnYXV0b2NvbXBsZXRlLm1vZGFsJzsgLy8gcmV0dXJuIGN1cnJlbnQgY29udGVudCBpZiBub3QgaW1wbGVtZW50ZWQgeWV0XHJcbiAgfSxcclxuICBjb25maWdUYWI6IGZ1bmN0aW9uIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24sIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50KSB7XHJcblxyXG4gICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgIHByb3BlcnR5RGVsaW1pdGVyOiAnLicsXHJcbiAgICB9KVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgLnNldE5hbWUoJ0RlbGltaXRlcicpXHJcbiAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIGRldGVybWluZSB3aGljaCBwcm9wZXJ0eSBzaG91bGQgYXBwZWFyIGluIHRoZSBtb2RhbCcpXHJcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3Byb3BlcnR5RGVsaW1pdGVyJykgfHwgJy4nKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3Byb3BlcnR5RGVsaW1pdGVyJywgdmFsdWUpO1xyXG4gICAgICAgIH0pKTtcclxuICB9XHJcbn0pXHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gIGlkOiAnYXV0b0xpbmsnLFxyXG4gIHJ1bGVUeXBlOiAnYXV0b21hdGlvbicsXHJcbiAgZGVzY3JpcHRpb246ICdBdXRvIExpbmsgKGFkdmFuY2VkKScsXHJcbiAgaXNMaXZlUnVsZTogdHJ1ZSxcclxuICBzb3VyY2U6ICcnLFxyXG4gIHR5cGU6IFsndGV4dCcsJ211bHRpdGV4dCddLFxyXG4gIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe3JlbW92ZUNvbnRlbnQ6IGZhbHNlLCAgaW5wdXRQcm9wZXJ0eTogZmFsc2UsIGFkZFByZWZpeDogZmFsc2UsIHNwYWNlUmVwbGFjZW1lbnQ6IGZhbHNlLCBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IGZhbHNlLCBjb252ZXJ0VG9Mb3dlckNhc2U6IGZhbHNlLCByZXN1bHRBc0xpbms6IGZhbHNlLCBzY3JpcHQ6IGZhbHNlfSksXHJcbiAgZng6IGFzeW5jIGZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgY29uc3QgY3VycmVudENvbnRlbnQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpO1xyXG4gICAgbGV0IG5ld0NvbnRlbnQgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xyXG4gICAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcclxuICAgIGlmICghcnVsZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBhdXRvTGluazogcnVsZSBub3QgZm91bmQsIHJldHVybmluZyBjdXJyZW50IGNvbnRlbnQgJHtjdXJyZW50Q29udGVudH1gKTtcclxuICAgICAgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gICAgfSBcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB0b29scy5nZXRPcHRpb25Db25maWcocnVsZS5pZCk7XHJcbiAgICBjb25zdCBmaWxlc1RvQ2hlY2sgPSB0b29scy5nZXRGaWxlc0luVmF1bHQob3B0aW9ucy5kZXN0aW5hdGlvbkZvbGRlcik7XHJcbiAgICBsZXQgbGlua3MgPSBjdXJyZW50Q29udGVudCB8fCBbXTtcclxuICAgIGlmICh0eXBlb2YgbGlua3MgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KGxpbmtzKSkge1xyXG4gICAgICBsaW5rcyA9IFtdOyAvLyBjb252ZXJ0IG9iamVjdCB0byBhcnJheVxyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbGlua3MgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIGxpbmtzID0gW2xpbmtzXTsgLy8gY29udmVydCB0byBhcnJheSBpZiBub3QgYWxyZWFkeSBhbiBhcnJheVxyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2coYGF1dG9MaW5rOiBsaW5rcyB0byBjaGVja2AsIGxpbmtzLCBmaWxlc1RvQ2hlY2spO1xyXG4gIFxyXG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIGxpbmtzKSAge1xyXG4gICAgICBsZXQgbGluayA9IHRvb2xzLmV4dHJhY3RMaW5rUGFydHMocGFydCk7XHJcbiAgICAgIGxldCBsaW5rRmlsZSA9IHRvb2xzLmdldEZpbGVGcm9tUGF0aChsaW5rLnBhdGgsIGZpbGVzVG9DaGVjayk7XHJcbiAgICAgIGlmICghbGlua0ZpbGUpIHsgLy8gY3JlYXRlIG5ldyBGaWxlXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuYXNrQ29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgQWxlcnRNb2RhbChhcHAsICdDcmVhdGUgbmV3IGZpbGUnLCBgRmlsZSAke2xpbmsucGF0aH0gZG9lcyBub3QgZXhpc3QuIERvIHlvdSB3YW50IHRvIGNyZWF0ZSBpdD9gLCAnQ3JlYXRlJywgJ0NhbmNlbCcsIFwiRG9uJ3QgYXNrIGFnYWluLlwiKS5vcGVuQW5kR2V0VmFsdWUoKTtcclxuICAgICAgICAgIGlmICghcmVzdWx0LnByb2NlZWQpIHJldHVybjsgLy8gZG8gbm90IGNyZWF0ZSB0aGUgZmlsZSBpZiB0aGUgdXNlciBkb2VzIG5vdCBjb25maXJtXHJcbiAgICAgICAgICBvcHRpb25zLmFza0NvbmZpcm1hdGlvbiA9ICFyZXN1bHQuZGF0YS5hc2tDb25maXJtYXRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxpbmsucGF0aCA9IG9wdGlvbnMuZGVzdGluYXRpb25Gb2xkZXIgKyAnLycgKyBsaW5rLnRpdGxlICsgJy5tZCc7IC8vIGFkZCB0aGUgZGVzdGluYXRpb24gZm9sZGVyIHRvIHRoZSBsaW5rIHBhdGhcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGBhdXRvTGluazogY3JlYXRpbmcgbmV3IGZpbGUgJHtsaW5rLnBhdGh9YCk7XHJcbiAgICAgICAgbGlua0ZpbGUgPSBhd2FpdCB0b29scy5jcmVhdGVGaWxlRnJvbVBhdGgobGluay5wYXRoLCBvcHRpb25zLmFkZFRlbXBsYXRlID8gb3B0aW9ucy50ZW1wbGF0ZUZpbGUgOiB1bmRlZmluZWQpOyAvLyBjcmVhdGUgdGhlIGZpbGUgaWYgaXQgZG9lcyBub3QgZXhpc3RcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGBhdXRvTGluazogbmV3IGZpbGUgY3JlYXRlZCAke2xpbmtGaWxlLnBhdGh9YCk7XHJcbiAgICAgICAgdG9vbHMudXBkYXRlRnJvbnRtYXR0ZXIocnVsZS5wcm9wZXJ0eSwgW2BbWyR7dG9vbHMucmVtb3ZlTGVhZGluZ1NsYXNoKGxpbmsucGF0aCl9fCR7bGluay50aXRsZX1dXWBdLCBsaW5rRmlsZSk7IC8vIGFkZCBsb2NhdGlvbiBvZiBuZXcgcGF0aCB0byBpdHNlbGZcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGBhdXRvTGluazogY3JlYXRpbmcgTGluayB0byBleGlzdGluZyBGaWxlICR7bGlua0ZpbGUucGF0aH1gKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAobGlua0ZpbGUpIHtcclxuICAgICAgICBsaW5rLnBhdGggPSBsaW5rRmlsZS5wYXRoO1xyXG4gICAgICAgIG5ld0NvbnRlbnQucHVzaChgW1ske3Rvb2xzLnJlbW92ZUxlYWRpbmdTbGFzaChsaW5rLnBhdGgpfXwke2xpbmsudGl0bGV9XV1gKTsgLy8gYWRkIHRoZSBmaWxlIHBhdGggdG8gdGhlIG5ldyBjb250ZW50XHJcbiAgICAgIH1cclxuICAgICAgLy9jb25zb2xlLmxvZyhgYXV0b0xpbms6IG5ldyBjb250ZW50YCwgbmV3Q29udGVudCk7XHJcbiAgICB9XHJcbiAgICAvL2NvbnNvbGUubG9nKGBhdXRvTGluazogd3JpdGUgY29udGVudGAsIG5ld0NvbnRlbnQpO1xyXG4gICAgdG9vbHMudXBkYXRlRnJvbnRtYXR0ZXIocnVsZS5wcm9wZXJ0eSwgbmV3Q29udGVudCk7IC8vIHVwZGF0ZSB0aGUgZnJvbnRtYXR0ZXIgd2l0aCB0aGUgbmV3IGNvbnRlbnRcclxuICAgIHJldHVybiBuZXdDb250ZW50OyAgICBcclxuICB9LFxyXG4gIGNvbmZpZ1RhYjogZnVuY3Rpb24gKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQpIHtcclxuXHJcbiAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgYWRkVGVtcGxhdGU6IHRydWUsXHJcbiAgICAgIGFza0NvbmZpcm1hdGlvbjogdHJ1ZSxcclxuICAgICAgZGVzdGluYXRpb25Gb2xkZXI6ICcvJyxcclxuICAgICAgdGVtcGxhdGVGaWxlOiAnJyxcclxuICAgIH0pXHJcblxyXG4gICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgIC5zZXROYW1lKCdBZGQgdGVtcGxhdGUgdG8gbmV3IGZpbGVzJylcclxuICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgYWRkIHRlbXBsYXRlIHRvIG5ldyBmaWxlcycpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdhZGRUZW1wbGF0ZScpIHx8IGZhbHNlKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2FkZFRlbXBsYXRlJywgdmFsdWUpO1xyXG4gICAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAuc2V0TmFtZSgnQXNrIGZvciBjb25maXJtYXRpb24nKVxyXG4gICAgICAuc2V0RGVzYygnQXNrIGZvciBjb25maXJtYXRpb24gYmVmb3JlIGNyZWF0aW5nIG5ldyBmaWxlcycpXHJcbiAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdhc2tDb25maXJtYXRpb24nKSB8fCBmYWxzZSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdhc2tDb25maXJtYXRpb24nLCB2YWx1ZSk7XHJcbiAgICAgICAgICB9KSk7XHJcblxyXG4gICAgbGV0IGRlc3RpbmF0aW9uRm9sZGVyRWw6U2VhcmNoQ29tcG9uZW50OyAgXHJcbiAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgLnNldE5hbWUoJ0Rlc3RpbmF0aW9uIEZvbGRlcicpXHJcbiAgICAgIC5zZXREZXNjKCdGb2xkZXIgdG8gcGxhY2UgbmV3IGZpbGVzJylcclxuICAgICAgLmFkZFNlYXJjaCgoY2IpID0+IHtcclxuICAgICAgICAgIGRlc3RpbmF0aW9uRm9sZGVyRWwgPSBjYjtcclxuICAgICAgICAgIG5ldyBGb2xkZXJTdWdnZXN0KHRoYXQuYXBwLCBjYi5pbnB1dEVsKTtcclxuICAgICAgICAgIGNiLnNldFBsYWNlaG9sZGVyKFwiZW50ZXIgZm9sZGVyIG9yIGJyb3dzZSAuLi5cIilcclxuICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2Rlc3RpbmF0aW9uRm9sZGVyJykgfHwgJycpXHJcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKChuZXdGb2xkZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgbmV3Rm9sZGVyID0gbmV3Rm9sZGVyLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICBuZXdGb2xkZXIgPSBuZXdGb2xkZXIucmVwbGFjZSgvXFwvJC8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdkZXN0aW5hdGlvbkZvbGRlcicsIG5ld0ZvbGRlcik7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICBjYi5jb250YWluZXJFbC5hZGRDbGFzcyhcImZyb250bWF0dGVyLWF1dG9tYXRlLXNlYXJjaFwiKTtcclxuICAgICAgfSlcclxuICAgICAgLmFkZEV4dHJhQnV0dG9uKChidXR0b24pID0+XHJcbiAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLXRyZWUnKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoJ1NlbGVjdCB0ZW1wbGF0ZSBmb2xkZXInKVxyXG4gICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgdGhhdC5hcHAsXHJcbiAgICAgICAgICAgICAgW3RoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdkZXN0aW5hdGlvbkZvbGRlcicpXSxcclxuICAgICAgICAgICAgICBbXSxcclxuICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICB0aXRsZTogJ1NlbGVjdCBmb2xkZXIgdG8gcGxhY2UgbmV3IGZpbGVzJyxcclxuICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICBkaXNwbGF5TW9kZTogJ2ZvbGRlcicsXHJcbiAgICAgICAgICAgICAgICAgIG9wdGlvblNlbGVjdGlvbk1vZGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICBvcHRpb25TaG93RmlsZXM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmZvbGRlcnMubGVuZ3RoID09PSAwIHx8ICFyZXN1bHQuZm9sZGVyc1swXSB8fCB0eXBlb2YgcmVzdWx0LmZvbGRlcnNbMF0gIT09ICdzdHJpbmcnKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEZvbGRlciA9IHJlc3VsdC5mb2xkZXJzWzBdLnRyaW0oKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7IC8vIHJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzICgvXlxcL3xcXC8kL2csIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZvbGRlciA9PT0gJycpIHNlbGVjdGVkRm9sZGVyID0gJy8nOyAvLyBpZiBlbXB0eSwgc2V0IHRvIHJvb3QgZm9sZGVyXHJcbiAgICAgICAgICAgICAgICAgIGlmICghc2VsZWN0ZWRGb2xkZXIpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25Gb2xkZXJFbC5zZXRWYWx1ZShzZWxlY3RlZEZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2Rlc3RpbmF0aW9uRm9sZGVyJywgc2VsZWN0ZWRGb2xkZXIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgXHJcbiAgICBsZXQgZGVzdGluYXRpb25GaWxlRWw6U2VhcmNoQ29tcG9uZW50OyAgXHJcbiAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgLnNldE5hbWUoJ1RlbXBsYXRlIEZpbGUnKVxyXG4gICAgICAuc2V0RGVzYygnU2VsZWN0IGEgdGVtcGxhdGUgZmlsZSB0byBhZGQgdG8gbmV3IGZpbGVzJylcclxuICAgICAgLmFkZFNlYXJjaCgoY2IpID0+IHtcclxuICAgICAgICAgIGRlc3RpbmF0aW9uRmlsZUVsID0gY2I7XHJcbiAgICAgICAgICBuZXcgRmlsZVN1Z2dlc3QoY2IuaW5wdXRFbCwgdGhhdC5wbHVnaW4sICcnKTtcclxuICAgICAgICAgIGNiLnNldFBsYWNlaG9sZGVyKFwiZW50ZXIgZm9sZGVyIG9yIGJyb3dzZSAuLi5cIilcclxuICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3RlbXBsYXRlRmlsZScpIHx8ICcnKVxyXG4gICAgICAgICAgICAgIC5vbkNoYW5nZSgobmV3RmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBuZXdGaWxlID0gbmV3RmlsZS50cmltKClcclxuICAgICAgICAgICAgICAgICAgbmV3RmlsZSA9IG5ld0ZpbGUucmVwbGFjZSgvXFwvJC8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCd0ZW1wbGF0ZUZpbGUnLCBuZXdGaWxlKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgIGNiLmNvbnRhaW5lckVsLmFkZENsYXNzKFwiZnJvbnRtYXR0ZXItYXV0b21hdGUtc2VhcmNoXCIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbikgPT5cclxuICAgICAgICBidXR0b25cclxuICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXItdHJlZScpXHJcbiAgICAgICAgICAuc2V0VG9vbHRpcCgnU2VsZWN0IHRlbXBsYXRlIGZpbGUnKVxyXG4gICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgdGhhdC5hcHAsXHJcbiAgICAgICAgICAgICAgW10sXHJcbiAgICAgICAgICAgICAgW3RoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3RlbXBsYXRlRmlsZScpXSxcclxuICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICB0aXRsZTogJ1NlbGVjdCB0ZW1wbGF0ZSBmb3IgbmV3IGZpbGVzJyxcclxuICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICBkaXNwbGF5TW9kZTogJ2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgb3B0aW9uU2hvd0ZpbGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmZpbGVzLmxlbmd0aCA9PT0gMCB8fCAhcmVzdWx0LmZpbGVzWzBdIHx8IHR5cGVvZiByZXN1bHQuZmlsZXNbMF0gIT09ICdzdHJpbmcnKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEZpbGUgPSByZXN1bHQuZmlsZXNbMF0udHJpbSgpLnJlcGxhY2UoL1xcLyQvLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKCFzZWxlY3RlZEZpbGUpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25GaWxlRWwuc2V0VmFsdWUoc2VsZWN0ZWRGaWxlKTtcclxuICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwndGVtcGxhdGVGaWxlJywgc2VsZWN0ZWRGaWxlKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH0pIiwgIlxyXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nLCBUQWJzdHJhY3RGaWxlLCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIHNldEljb24sQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBDb25zdHJ1Y3RvciB9IGZyb20gJ29ic2lkaWFuJzsgLy8gQWRkZWQgc2V0SWNvblxyXG5pbXBvcnQgeyBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzLCBQcm9wZXJ0eUluZm8gfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgcmVuZGVyVmFsdWVJbnB1dCwgdXBkYXRlUHJvcGVydHlJY29uIH0gZnJvbSAnLi91aUVsZW1lbnRzJzsgLy8gSW1wb3J0IHRoZSBmdW5jdGlvbiB0byByZW5kZXIgdmFsdWUgaW5wdXRcclxuXHJcblxyXG4vLyBEZWZpbmUgdGhlIHJlc3VsdCBzdHJ1Y3R1cmUgcmV0dXJuZWQgYnkgdGhlIG1vZGFsXHJcbmV4cG9ydCBpbnRlcmZhY2UgYXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQge1xyXG4gICAgdmFsdWVzOiB7fTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIE1vZGFsIGZvciBzZWxlY3RpbmcgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGZyb20gdGhlIHZhdWx0IHN0cnVjdHVyZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdXRvY29tcGxldGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuXHJcbiAgICBcclxuICAgIHByaXZhdGUgcmVzb2x2ZVByb21pc2UhOiAocmVzdWx0OiBhdXRvY29tcGxldGVNb2RhbFJlc3VsdCB8IG51bGwpID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHByb21pc2U6IFByb21pc2U8YXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQgfCBudWxsPjtcclxuXHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogYXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQgfCBudWxsKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IGFueTtcclxuICAgIHByaXZhdGUgb3B0aW9uczogYW55O1xyXG4gICAgcHJpdmF0ZSB0b29sczogU2NyaXB0aW5nVG9vbHM7XHJcbiAgICBwcml2YXRlIGV4cGVjdGVkVHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzO1xyXG4gICAgcHJpdmF0ZSBydWxlOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbjtcclxuICAgIHByaXZhdGUga25vd25Qcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eUluZm8+ID0ge307XHJcblxyXG4gICAgLy8gQ3VycmVudCBzdGF0ZSBiZWluZyBtb2RpZmllZCB3aXRoaW4gdGhlIG1vZGFsXHJcbiAgICBwcml2YXRlIGFjdGl2ZUZpbGU6IFRGaWxlIHwgVEZvbGRlciB8IHVuZGVmaW5lZFxyXG4gICAgcHJpdmF0ZSBmcm9udG1hdHRlcjogYW55OyAvLyBGcm9udG1hdHRlciBkYXRhIGZvciB0aGUgYWN0aXZlIGZpbGVcclxuXHJcbiAgICAvLyBVSSBFbGVtZW50c1xyXG4gICAgcHJpdmF0ZSBjb250ZW50Um9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBmdW5jdGlvblRlc3RCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcclxuICAgIHByaXZhdGUgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgcHJpdmF0ZSByZXN1bHQ6IGFueSA9IHt9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwuXHJcbiAgICAgKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBwbHVnaW4gLSBUaGUgcGx1Z2luIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIGV4cGVjdGVkVHlwZSAtIEV4cGVjdGVkIHJldHVybiB0eXBlLlxyXG4gICAgICogQHBhcmFtIGFjdGl2ZUZpbGUgLSBUaGUgY3VycmVudGx5IGFjdGl2ZSBmaWxlIG9yIGZvbGRlci5cclxuICAgICAqIEBwYXJhbSBmcm9udG1hdHRlciAtIEZyb250bWF0dGVyIGRhdGEgZm9yIHRoZSBhY3RpdmUgZmlsZS5cclxuICAgICAqIEBwYXJhbSBva0NhbGxiYWNrIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBcIk9LXCIuIFJlY2VpdmVzIHRoZSBzZWxlY3Rpb24gcmVzdWx0LlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBhcHA6IEFwcCxcclxuICAgICAgICBwbHVnaW46IGFueSxcclxuICAgICAgICBydWxlOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbixcclxuICAgICAgICBvcHRpb25zOiBhbnksXHJcbiAgICAgICAgYWN0aXZlRmlsZTogVEZpbGUgfCBURm9sZGVyIHwgdW5kZWZpbmVkLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBhbnksICAgXHJcbiAgICAgICAgb2tDYWxsYmFjaz86IChyZXN1bHQ6IGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIHN0YXRlIGZvciByZXNldFxyXG4gICAgICAgIHRoaXMudG9vbHM9IG5ldyBTY3JpcHRpbmdUb29scyhhcHAsIHRoaXMucGx1Z2luLCB0aGlzLmZyb250bWF0dGVyKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgPSBhY3RpdmVGaWxlO1xyXG4gICAgICAgIHRoaXMuZnJvbnRtYXR0ZXIgPSBmcm9udG1hdHRlcjsgLy8gU3RvcmUgZnJvbnRtYXR0ZXIgZGF0YVxyXG5cclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnJ1bGUgPSBydWxlO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7IC8vIFN0b3JlIG9wdGlvbnMgZm9yIHRoZSBtb2RhbFxyXG4gICAgICAgIHRoaXMuZXhwZWN0ZWRUeXBlID0gcnVsZS50eXBlOyAvLyBFeHBlY3RlZCB0eXBlIGZvciB0aGUgbW9kYWxcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChva0NhbGxiYWNrKSB0aGlzLm9rQ2FsbGJhY2sgPSBva0NhbGxiYWNrO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGN1cnJlbnQgc3RhdGUgZnJvbSBpbml0aWFsIHN0YXRlIGZvciBlZGl0aW5nXHJcbiAgICAgICAgdGhpcy5yZXNldFRvSW5pdGlhbCgpOyAvLyBVc2UgYSBtZXRob2QgZm9yIGluaXRpYWxpemF0aW9uIGFuZCByZXNldFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzdGF0ZSB0byB0aGUgaW5pdGlhbCBzdGF0ZSBwcm92aWRlZCBhdCBjb25zdHJ1Y3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRUb0luaXRpYWwoKTogdm9pZCB7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIGVtcHR5LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0VG9FbXB0eSgpOiB2b2lkIHtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGF3YWl0IHRoaXMudG9vbHMuZmV0Y2hLbm93blByb3BlcnRpZXModGhpcy5hcHApOyAvLyBJbml0aWFsaXplIGtub3duIHByb3BlcnRpZXNcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBpZiAoY29udGVudEVsLnBhcmVudEVsZW1lbnQpIGNvbnRlbnRFbC5wYXJlbnRFbGVtZW50LnN0eWxlLndpZHRoID0gJzkwMHB4JztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgXHJcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdjb2RlRWRpdG9yLW1vZGFsJyk7IFxyXG5cclxuICAgICAgICAvLyAtLS0gTW9kYWwgVGl0bGUgLS0tXHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1BsZWFzZSBjb21wbGV0ZSB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXMnIH0pOyAgICBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2JvZHknLCB7IHRleHQ6IGBGaWxlOiAke3RoaXMuYWN0aXZlRmlsZT8ucGF0aH1gIH0pOyBcclxuXHJcbiAgICAgICAgLy8gLS0tIFRyZWUgQ29udGFpbmVyIC0tLVxyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50ID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2NvZGVFZGl0b3ItY29udGFpbmVyJyB9KTtcclxuICAgICAgICAvLyBCYXNpYyBzdHlsaW5nIGZvciB0aGUgc2Nyb2xsYWJsZSB0cmVlIGFyZWFcclxuICAgICAgICAvLyB0aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLndpZHRoID0gJzYwMHB4JztcclxuICAgICAgICAvLyB0aGlzLmNvbnRlbnRSb290RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnNjAwcHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJztcclxuICAgICAgICAvL3RoaXMuZWRpdG9yUm9vdEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy5jb250ZW50Um9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JztcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5Q29udGFpbmVyRWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImNvZGVFZGl0b3Itb3B0aW9uc1wiIH0pO1xyXG4gICAgICAgIHByb3BlcnR5Q29udGFpbmVyRWwuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nOyAvLyBTdGFjayBpdGVtcyB2ZXJ0aWNhbGx5XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuZnJvbnRtYXR0ZXIpKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aCh0aGlzLnJ1bGUucHJvcGVydHkgKyB0aGlzLm9wdGlvbnMucHJvcGVydHlEZWxpbWl0ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dFbCA9IHByb3BlcnR5Q29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktc2V0dGluZy1yb3cgc2V0dGluZy1pdGVtJyB9KTtcclxuICAgICAgICAgICAgICAgIHJvd0VsLnN0eWxlLndpZHRoID0gJzEwMCUnOyAvLyBGdWxsIHdpZHRoXHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udHJvbEVsID0gcm93RWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZy1pdGVtLWNvbnRyb2wnIH0pO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sRWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmdhcCA9ICcwcHgnOyAvLyBQcmV2ZW50IGdhcCBmcm9tIGJlaW5nIGFkZGVkIHRvIHRoZSBsZWZ0IHNpZGVcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0Q29udGFpbmVyID0gY29udHJvbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LWxlZnQtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGxlZnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICAgICAgICAgIGxlZnRDb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgbGVmdENvbnRhaW5lci5zdHlsZS5taW5XaWR0aCA9ICcyNTBweCc7IFxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGljb25FbCA9IGxlZnRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ3Byb3BlcnR5LWljb24gc2V0dGluZy1pdGVtLWljb24nIH0pO1xyXG4gICAgICAgICAgICAgICAgaWNvbkVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgdXBkYXRlUHJvcGVydHlJY29uKGljb25FbCwgdGhpcy5rbm93blByb3BlcnRpZXNba2V5XS50eXBlKTsgLy8gVXBkYXRlIGljb24gYmFzZWQgb24gdHlwZVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VhcmNoQ29udGFpbmVyID0gbGVmdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1zZWFyY2gtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHNlYXJjaENvbnRhaW5lcilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoa2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignUHJvcGVydHkgbmFtZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpOyAvLyBEaXNhYmxlIHRoZSBpbnB1dCBmaWVsZFxyXG4gICAgICAgICAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuc3R5bGUuYm9yZGVyID0gJ25vbmUnOyAvLyBtYWtlIGJvcmRlciBpbnZpc2libGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1pZGRsZUNvbnRhaW5lciA9IGNvbnRyb2xFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1taWRkbGUtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gbWlkZGxlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXZhbHVlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9ICcxMDAlJzsgLy8gRnVsbCB3aWR0aCBmb3IgdmFsdWUgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBsZXQgcHJldmlld0NvbXBvbmVudCA9IHJlbmRlclZhbHVlSW5wdXQodmFsdWVDb250YWluZXIsIHRoaXMua25vd25Qcm9wZXJ0aWVzW2tleV0sIHRoaXMuZnJvbnRtYXR0ZXJba2V5XSwgdGhpcy5jaGFuZ2VDYWxsYmFjayk7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldmlld0NvbXBvbmVudC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzEwMCUnOyAvLyBNYWtlIHRoZSBpbnB1dCBmaWVsZCB0YWtlIGZ1bGwgd2lkdGhcclxuICAgICAgICAgICAgICAgIHByZXZpZXdDb21wb25lbnQuaW5wdXRFbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnOyAvLyBtYWtlIGl0IGludmlzaWJsZVxyXG4gICAgICAgICAgICAgICAgLy8gLS0tIHJpZ2h0IHBhcnQgLS0tXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVCdXR0b25Db250YWluZXIgPSBjb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktcmlnaHQtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZUJ1dHRvbkNvbnRhaW5lci5zdHlsZS5tYXJnaW5MZWZ0ID0gJ2F1dG8nOyAvLyBQdXNoIHRvIHRoZSByaWdodFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWN0aW9uIEJ1dHRvbnMgLS0tXHJcbiAgICAgICAgdGhpcy5jcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRlbnRFbCk7IC8vIENyZWF0ZSBPSyBhbmQgUmVzZXQgYnV0dG9uc1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZUNhbGxiYWNrID0gKHByb3BlcnR5SW5mbzogUHJvcGVydHlJbmZvIHwgdW5kZWZpbmVkLCB2YWx1ZTphbnkpID0+IHtcclxuICAgICAgICAvLyBTYXZlIHRoZSByZXN1bHQgdG8gdGhlIGN1cnJlbnQgc3RhdGVcclxuICAgICAgICBpZiAocHJvcGVydHlJbmZvKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzdWx0W3Byb3BlcnR5SW5mby5uYW1lXSA9IHZhbHVlOyAvLyBVcGRhdGUgdGhlIHJlc3VsdCB3aXRoIHRoZSBuZXcgdmFsdWVcclxuICAgICAgICB9XHJcbiAgICB9ICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIHRoZSBcIk9LXCIgYW5kIFwiUmVzZXRcIiBidXR0b25zLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIGJ1dHRvbnMgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBidXR0b25zRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1idXR0b25zJyB9KTtcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUubWFyZ2luVG9wID0gJzE1cHgnO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOyAvLyBVc2UgZmxleCBmb3IgYWxpZ25tZW50XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2ZsZXgtZW5kJzsgLy8gQWxpZ24gYnV0dG9ucyB0byB0aGUgcmlnaHRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuZ2FwID0gJzEwcHgnOyAvLyBTcGFjZSBiZXR3ZWVuIGJ1dHRvbnNcclxuXHJcbiAgICAgICAgLy8gUmVzZXQgQnV0dG9uIChVbmRvIFx1MjFBQVx1RkUwRilcclxuICAgICAgICBjb25zdCByZXNldEJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XHJcbiAgICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmb3IgY29uc2lzdGVuY3ksIG9yIHVzZSB0ZXh0XHJcbiAgICAgICAgc2V0SWNvbihyZXNldEJ1dHRvbiwgJ3Jlc2V0Jyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLmFyaWFMYWJlbCA9ICdSZXNldCBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgcmVzZXRCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFRvSW5pdGlhbCgpOyAvLyBSZXNldCBpbnRlcm5hbCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENsZWFyIEJ1dHRvbiAoQ2xlYXIgXHVEODNEXHVERUFFKVxyXG4gICAgICAgIGNvbnN0IGVtcHR5QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKGVtcHR5QnV0dG9uLCAnZXJhc2VyJyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIGVtcHR5QnV0dG9uLmFyaWFMYWJlbCA9ICdDbGVhciBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgZW1wdHlCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFRvRW1wdHkoKTsgLy8gQ2xlYXIgc3RhdGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBjYW5jZWwgQnV0dG9uXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDYW5jZWwnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIGRpc2NhcmQgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBjYW5jZWxCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYW5jZWwgQ2xpY2tlZCAtIFJldHVybmluZ1wiKTsgLy8gRGVidWcgbG9nXHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UobnVsbCk7IC8vIFJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCBudWxsXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBPSyBCdXR0b25cclxuICAgICAgICBjb25zdCBva0J1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnT0snLCBjbHM6ICdtb2QtY3RhJyB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYXJpYUxhYmVsID0gJ2Nsb3NlIGFuZCBzYXZlIGNoYW5nZXMnOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgb2tCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh7IHZhbHVlczogdGhpcy5yZXN1bHQgfSk7IC8vIFJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCB0aGUgcmVzdWx0XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgbW9kYWwgaXMgY2xvc2VkLiBDbGVhbnMgdXAgcmVzb3VyY2VzLlxyXG4gICAgICovXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciB0aGUgbW9kYWwncyBjb250ZW50XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbkFuZEdldFZhbHVlcygpOiBQcm9taXNlPGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHwgbnVsbD4ge1xyXG4gICAgICAgIHRoaXMub3BlbigpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2U7IC8vIFJldHVybiB0aGUgcHJvbWlzZVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIE9wZW5zIGFuIGF1dG9jb21wbGV0ZSBtb2RhbCBmb3Igc2VsZWN0aW5nIG9yIGVudGVyaW5nIHZhbHVlcyBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgcGFyYW1ldGVycy5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBhcHBsaWNhdGlvbiBpbnN0YW5jZS5cclxuICogQHBhcmFtIHBsdWdpbiAtIFRoZSBwbHVnaW4gaW5zdGFuY2UgdGhhdCBpcyBpbnZva2luZyB0aGUgbW9kYWwuXHJcbiAqIEBwYXJhbSBydWxlIC0gVGhlIGZvbGRlci10by10YWcgcnVsZSBkZWZpbml0aW9uIHRvIGJlIHVzZWQgaW4gdGhlIG1vZGFsLlxyXG4gKiBAcGFyYW0gYWN0aXZlRmlsZSAtIFRoZSBjdXJyZW50bHkgYWN0aXZlIGZpbGUgb3IgZm9sZGVyLCBpZiBhbnkuXHJcbiAqIEBwYXJhbSBmcm9udG1hdHRlciAtIFRoZSBmcm9udG1hdHRlciBkYXRhIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWN0aXZlIGZpbGUuXHJcbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZXN1bHQgb2YgdGhlIGF1dG9jb21wbGV0ZSBtb2RhbCwgb3IgYG51bGxgIGlmIG5vIHNlbGVjdGlvbiB3YXMgbWFkZS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQXV0b2NvbXBsZXRlTW9kYWwoXHJcbiAgICBhcHA6IEFwcCxcclxuICAgIHBsdWdpbjogYW55LFxyXG4gICAgcnVsZTogRm9sZGVyVGFnUnVsZURlZmluaXRpb24sXHJcbiAgICBvcHRpb25zOiBhbnksXHJcbiAgICBhY3RpdmVGaWxlOiBURmlsZSB8IFRGb2xkZXIgfCB1bmRlZmluZWQsXHJcbiAgICBmcm9udG1hdHRlcjogYW55XHJcbik6IFByb21pc2U8YXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQgfCBudWxsPiB7XHJcbiAgICAvLyBDcmVhdGUgYW5kIG9wZW4gdGhlIG1vZGFsIGluc3RhbmNlXHJcbiAgICBjb25zdCBtb2RhbCA9IG5ldyBBdXRvY29tcGxldGVNb2RhbChhcHAsIHBsdWdpbiwgcnVsZSwgb3B0aW9ucywgYWN0aXZlRmlsZSwgZnJvbnRtYXR0ZXIpO1xyXG4gICAgcmV0dXJuIGF3YWl0IG1vZGFsLm9wZW5BbmRHZXRWYWx1ZXMoKTsgLy8gV2FpdCBmb3IgdGhlIHByb21pc2UgdG8gcmVzb2x2ZVxyXG59IiwgImltcG9ydCB7IHNldEljb24sIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzLCBQcm9wZXJ0eUluZm8gfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclZhbHVlSW5wdXQoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwcm9wZXJ0eUluZm86IFByb3BlcnR5SW5mbyB8IHVuZGVmaW5lZCwgY3VycmVudFZhbHVlOiBhbnksIGNoYW5nZUNhbGxiYWNrOiAocHJvcGVydHlJbmZvOiBQcm9wZXJ0eUluZm8gfCB1bmRlZmluZWQsIHZhbHVlOiBhbnkpID0+IHZvaWQpIHtcclxuICAgIGxldCByZXR1cm5Db21wb25lbnQ7XHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpOyBcclxuXHJcbiAgICBpZiAoIXByb3BlcnR5SW5mbykge1xyXG4gICAgICAgICAgICBjb250YWluZXJFbC5zZXRUZXh0KCcnKTtcclxuICAgICAgICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3RleHQtbXV0ZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHR5cGUgPSBwcm9wZXJ0eUluZm8udHlwZTtcclxuXHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignTnVtZXJpYyBWYWx1ZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudFZhbHVlICE9PSB1bmRlZmluZWQgJiYgY3VycmVudFZhbHVlICE9PSBudWxsID8gU3RyaW5nKGN1cnJlbnRWYWx1ZSkgOiAnJylcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW1WYWx1ZSA9IHZhbHVlID09PSAnJyA/IHVuZGVmaW5lZCA6IHBhcnNlRmxvYXQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNhbGxiYWNrKHByb3BlcnR5SW5mbywgaXNOYU4obnVtVmFsdWUgYXMgbnVtYmVyKSA/IHVuZGVmaW5lZCA6IG51bVZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC50eXBlID0gJ251bWJlcic7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAndHJpLXN0YXRlLWNoZWNrYm94IGNsaWNrYWJsZS1pY29uJyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDaGVja2JveCBjaGFuZ2Ugc3RhdGUnKTtcclxuICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LnNldEF0dHJpYnV0ZSgncm9sZScsICdjaGVja2JveCcpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlQ2hlY2tib3hWaXN1YWwgPSAoc3RhdGU6IGJvb2xlYW4gfCB1bmRlZmluZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBpY29uTmFtZTogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgbGV0IGFyaWFTdGF0ZTogJ3RydWUnIHwgJ2ZhbHNlJyB8ICdtaXhlZCc7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdjaGVjay1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyaWFTdGF0ZSA9ICd0cnVlJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbk5hbWUgPSAnc3F1YXJlJztcclxuICAgICAgICAgICAgICAgICAgICBhcmlhU3RhdGUgPSAnZmFsc2UnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gdW5kZWZpbmVkIG9yIG51bGxcclxuICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdtaW51cy1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyaWFTdGF0ZSA9ICdtaXhlZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZXRJY29uKHJldHVybkNvbXBvbmVudCwgaWNvbk5hbWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgYXJpYVN0YXRlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5kYXRhc2V0LnN0YXRlID0gU3RyaW5nKHN0YXRlKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZUNoZWNrYm94VmlzdWFsKGN1cnJlbnRWYWx1ZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFN0YXRlID0gcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGU7XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dFN0YXRlOiBib29sZWFuIHwgdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09ICdmYWxzZScpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50U3RhdGUgPT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGF0ZSA9IHVuZGVmaW5lZDsgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyBcclxuICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSBmYWxzZTsgXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2hhbmdlQ2FsbGJhY2socHJvcGVydHlJbmZvLCAgbmV4dFN0YXRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVDaGVja2JveFZpc3VhbChuZXh0U3RhdGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2RhdGUnOlxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignWVlZWS1NTS1ERCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudFZhbHVlIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNhbGxiYWNrKHByb3BlcnR5SW5mbywgdmFsdWUgfHwgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC50eXBlID0gJ2RhdGUnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdkYXRldGltZSc6XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZWVlZLU1NLUREVEhIOm1tJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ2FsbGJhY2socHJvcGVydHlJbmZvLCB2YWx1ZSB8fCB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnZGF0ZXRpbWUtbG9jYWwnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdhbGlhc2VzJzpcclxuICAgICAgICBjYXNlICd0YWdzJzpcclxuICAgICAgICBjYXNlICdtdWx0aXRleHQnOlxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndmFsdWVzIChkaXZpZGVkIGJ5IGNvbW1hKScpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoQXJyYXkuaXNBcnJheShjdXJyZW50VmFsdWUpID8gY3VycmVudFZhbHVlLmpvaW4oJywgJykgOiAoY3VycmVudFZhbHVlIHx8ICcnKSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnJheVZhbHVlID0gdmFsdWUuc3BsaXQoJywnKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ2FsbGJhY2socHJvcGVydHlJbmZvLCBhcnJheVZhbHVlLmxlbmd0aCA+IDAgPyBhcnJheVZhbHVlIDogdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd0ZXh0JzpcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndmFsdWUnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKGN1cnJlbnRWYWx1ZSB8fCAnJylcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDYWxsYmFjayhwcm9wZXJ0eUluZm8sIHZhbHVlIHx8IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgaWYgKHR5cGUgIT09ICdjaGVja2JveCcpIHtcclxuICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnOyAvLyBtYWtlIGl0IGludmlzaWJsZVxyXG4gICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnN0eWxlLmJvcmRlciA9ICdub25lJztcclxuICAgIH1cclxuICAgIHJldHVybiByZXR1cm5Db21wb25lbnQ7XHJcbn0gXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVQcm9wZXJ0eUljb24oaWNvbkVsOiBIVE1MRWxlbWVudCwgdHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzIHwgdW5kZWZpbmVkKSB7XHJcbiAgICBsZXQgaWNvbk5hbWUgPSAnaGFzaCc7XHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICBjYXNlICd0ZXh0JzogaWNvbk5hbWUgPSAnYWxpZ24tbGVmdCc7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ251bWJlcic6IGljb25OYW1lID0gJ2JpbmFyeSc7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ211bHRpdGV4dCc6IGljb25OYW1lID0gJ2xpc3QnOyBicmVhaztcclxuICAgICAgICBjYXNlICdkYXRlJzogaWNvbk5hbWUgPSAnY2FsZW5kYXInOyBicmVhaztcclxuICAgICAgICBjYXNlICdkYXRldGltZSc6IGljb25OYW1lID0gJ2Nsb2NrJzsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnY2hlY2tib3gnOiBpY29uTmFtZSA9ICdjaGVjay1zcXVhcmUnOyBicmVhaztcclxuICAgICAgICBjYXNlICd0YWdzJzogaWNvbk5hbWUgPSAndGFncyc7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2FsaWFzZXMnOiBpY29uTmFtZSA9ICdmb3J3YXJkJzsgYnJlYWs7XHJcbiBcclxuICAgICAgICBkZWZhdWx0OiBpY29uTmFtZSA9ICdoZWxwLWNpcmNsZSc7XHJcbiAgICB9XHJcbiAgICBzZXRJY29uKGljb25FbCwgaWNvbk5hbWUpO1xyXG59IiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG4vLyBhbmQgVGVtcGxhdGVyIHBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL1NpbGVudFZvaWQxMy9UZW1wbGF0ZXIgd2hlcmUgSSBnb3QgdGhlIGNvZGUgZm9yIHRoZSBzdWdnZXN0ZXJzXG5cbmltcG9ydCB7IEFwcCwgVEFic3RyYWN0RmlsZSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgVGV4dElucHV0U3VnZ2VzdCB9IGZyb20gXCIuL3N1Z2dlc3RcIjtcblxuZXhwb3J0IGNsYXNzIEZvbGRlclN1Z2dlc3QgZXh0ZW5kcyBUZXh0SW5wdXRTdWdnZXN0PFRGb2xkZXI+IHtcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoYXBwLCBpbnB1dEVsKTtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhpbnB1dFN0cjogc3RyaW5nKTogVEZvbGRlcltdIHtcbiAgICAgICAgY29uc3QgYWJzdHJhY3RGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCk7XG4gICAgICAgIGNvbnN0IGZvbGRlcnM6IFRGb2xkZXJbXSA9IFtdO1xuICAgICAgICBjb25zdCBsb3dlckNhc2VJbnB1dFN0ciA9IGlucHV0U3RyLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgYWJzdHJhY3RGaWxlcy5mb3JFYWNoKChmb2xkZXI6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyICYmXG4gICAgICAgICAgICAgICAgZm9sZGVyLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlckNhc2VJbnB1dFN0cilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZvbGRlcnMucHVzaChmb2xkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9sZGVycy5zbGljZSgwLCAxMDAwKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGb2xkZXIsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aC5yZXBsYWNlKC9eKD8hXFwvKS8sIFwiL1wiKSk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURm9sZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9IGZpbGUucGF0aC5yZXBsYWNlKC9eKD8hXFwvKS8sIFwiL1wiKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnRyaWdnZXIoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn1cbiIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuLy8gYW5kIFRlbXBsYXRlciBwbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9TaWxlbnRWb2lkMTMvVGVtcGxhdGVyIHdoZXJlIEkgZ290IHRoZSBjb2RlIGZvciB0aGUgc3VnZ2VzdGVyc1xuXG5pbXBvcnQgeyBBcHAsIElTdWdnZXN0T3duZXIsIFNjb3BlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBjcmVhdGVQb3BwZXIsIEluc3RhbmNlIGFzIFBvcHBlckluc3RhbmNlIH0gZnJvbSBcIkBwb3BwZXJqcy9jb3JlXCI7XG5cbmNvbnN0IHdyYXBBcm91bmQgPSAodmFsdWU6IG51bWJlciwgc2l6ZTogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICByZXR1cm4gKCh2YWx1ZSAlIHNpemUpICsgc2l6ZSkgJSBzaXplO1xufTtcblxuY2xhc3MgU3VnZ2VzdDxUPiB7XG4gICAgcHJpdmF0ZSBvd25lcjogSVN1Z2dlc3RPd25lcjxUPjtcbiAgICBwcml2YXRlIHZhbHVlczogVFtdO1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvbnM6IEhUTUxEaXZFbGVtZW50W107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEl0ZW06IG51bWJlcjtcbiAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBvd25lcjogSVN1Z2dlc3RPd25lcjxUPixcbiAgICAgICAgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBzY29wZTogU2NvcGVcbiAgICApIHtcbiAgICAgICAgdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsID0gY29udGFpbmVyRWw7XG5cbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcImNsaWNrXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWl0ZW1cIixcbiAgICAgICAgICAgIHRoaXMub25TdWdnZXN0aW9uQ2xpY2suYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBjb250YWluZXJFbC5vbihcbiAgICAgICAgICAgIFwibW91c2Vtb3ZlXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWl0ZW1cIixcbiAgICAgICAgICAgIHRoaXMub25TdWdnZXN0aW9uTW91c2VvdmVyLmJpbmQodGhpcylcbiAgICAgICAgKTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd1VwXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtIC0gMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd0Rvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50LmlzQ29tcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0odGhpcy5zZWxlY3RlZEl0ZW0gKyAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVudGVyXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMudXNlU2VsZWN0ZWRJdGVtKGV2ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50LCBlbDogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsKTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgfVxuXG4gICAgb25TdWdnZXN0aW9uTW91c2VvdmVyKF9ldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnN1Z2dlc3Rpb25zLmluZGV4T2YoZWwpO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbShpdGVtLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgc2V0U3VnZ2VzdGlvbnModmFsdWVzOiBUW10pIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uRWxzOiBIVE1MRGl2RWxlbWVudFtdID0gW107XG5cbiAgICAgICAgdmFsdWVzLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdihcInN1Z2dlc3Rpb24taXRlbVwiKTtcbiAgICAgICAgICAgIHRoaXMub3duZXIucmVuZGVyU3VnZ2VzdGlvbih2YWx1ZSwgc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25FbHMucHVzaChzdWdnZXN0aW9uRWwpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25FbHM7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKDAsIGZhbHNlKTtcbiAgICB9XG5cbiAgICB1c2VTZWxlY3RlZEl0ZW0oZXZlbnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMudmFsdWVzW3RoaXMuc2VsZWN0ZWRJdGVtXTtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vd25lci5zZWxlY3RTdWdnZXN0aW9uKGN1cnJlbnRWYWx1ZSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0U2VsZWN0ZWRJdGVtKHNlbGVjdGVkSW5kZXg6IG51bWJlciwgc2Nyb2xsSW50b1ZpZXc6IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZEluZGV4ID0gd3JhcEFyb3VuZChcbiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXgsXG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBwcmV2U2VsZWN0ZWRTdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbbm9ybWFsaXplZEluZGV4XTtcblxuICAgICAgICBwcmV2U2VsZWN0ZWRTdWdnZXN0aW9uPy5yZW1vdmVDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuICAgICAgICBzZWxlY3RlZFN1Z2dlc3Rpb24/LmFkZENsYXNzKFwiaXMtc2VsZWN0ZWRcIik7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZEl0ZW0gPSBub3JtYWxpemVkSW5kZXg7XG5cbiAgICAgICAgaWYgKHNjcm9sbEludG9WaWV3KSB7XG4gICAgICAgICAgICBzZWxlY3RlZFN1Z2dlc3Rpb24uc2Nyb2xsSW50b1ZpZXcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVGV4dElucHV0U3VnZ2VzdDxUPiBpbXBsZW1lbnRzIElTdWdnZXN0T3duZXI8VD4ge1xuICAgIHByb3RlY3RlZCBhcHA6IEFwcDtcbiAgICBwcm90ZWN0ZWQgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICBwcml2YXRlIHBvcHBlcjogUG9wcGVySW5zdGFuY2U7XG4gICAgcHJpdmF0ZSBzY29wZTogU2NvcGU7XG4gICAgcHJpdmF0ZSBzdWdnZXN0RWw6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgc3VnZ2VzdDogU3VnZ2VzdDxUPjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5pbnB1dEVsID0gaW5wdXRFbDtcbiAgICAgICAgdGhpcy5zY29wZSA9IG5ldyBTY29wZSgpO1xuXG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsID0gY3JlYXRlRGl2KFwic3VnZ2VzdGlvbi1jb250YWluZXJcIik7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3RFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uXCIpO1xuICAgICAgICB0aGlzLnN1Z2dlc3QgPSBuZXcgU3VnZ2VzdCh0aGlzLCBzdWdnZXN0aW9uLCB0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVzY2FwZVwiLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCB0aGlzLm9uSW5wdXRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwub24oXG4gICAgICAgICAgICBcIm1vdXNlZG93blwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1jb250YWluZXJcIixcbiAgICAgICAgICAgIChldmVudDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25JbnB1dENoYW5nZWQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGlucHV0U3RyID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHIpO1xuXG4gICAgICAgIGlmICghc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB0aGlzLm9wZW4odGhpcy5hcHAuZG9tLmFwcENvbnRhaW5lckVsLCB0aGlzLmlucHV0RWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3Blbihjb250YWluZXI6IEhUTUxFbGVtZW50LCBpbnB1dEVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFwcC5rZXltYXAucHVzaFNjb3BlKHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnN1Z2dlc3RFbCk7XG4gICAgICAgIHRoaXMucG9wcGVyID0gY3JlYXRlUG9wcGVyKGlucHV0RWwsIHRoaXMuc3VnZ2VzdEVsLCB7XG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tLXN0YXJ0XCIsXG4gICAgICAgICAgICBtb2RpZmllcnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwic2FtZVdpZHRoXCIsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZuOiAoeyBzdGF0ZSwgaW5zdGFuY2UgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogcG9zaXRpb25pbmcgbmVlZHMgdG8gYmUgY2FsY3VsYXRlZCB0d2ljZSAtXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmaXJzdCBwYXNzIC0gcG9zaXRpb25pbmcgaXQgYWNjb3JkaW5nIHRvIHRoZSB3aWR0aCBvZiB0aGUgcG9wcGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWNvbmQgcGFzcyAtIHBvc2l0aW9uIGl0IHdpdGggdGhlIHdpZHRoIGJvdW5kIHRvIHRoZSByZWZlcmVuY2UgZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBlYXJseSBleGl0IHRvIGF2b2lkIGFuIGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFdpZHRoID0gYCR7c3RhdGUucmVjdHMucmVmZXJlbmNlLndpZHRofXB4YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zdHlsZXMucG9wcGVyLndpZHRoID09PSB0YXJnZXRXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnN0eWxlcy5wb3BwZXIud2lkdGggPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwaGFzZTogXCJiZWZvcmVXcml0ZVwiLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlczogW1wiY29tcHV0ZVN0eWxlc1wiXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYXBwLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoW10pO1xuICAgICAgICBpZiAodGhpcy5wb3BwZXIpIHRoaXMucG9wcGVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwuZGV0YWNoKCk7XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRbXTtcbiAgICBhYnN0cmFjdCByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IFQsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQ7XG4gICAgYWJzdHJhY3Qgc2VsZWN0U3VnZ2VzdGlvbihpdGVtOiBUKTogdm9pZDtcbn1cbiIsICJleHBvcnQgdmFyIHRvcCA9ICd0b3AnO1xuZXhwb3J0IHZhciBib3R0b20gPSAnYm90dG9tJztcbmV4cG9ydCB2YXIgcmlnaHQgPSAncmlnaHQnO1xuZXhwb3J0IHZhciBsZWZ0ID0gJ2xlZnQnO1xuZXhwb3J0IHZhciBhdXRvID0gJ2F1dG8nO1xuZXhwb3J0IHZhciBiYXNlUGxhY2VtZW50cyA9IFt0b3AsIGJvdHRvbSwgcmlnaHQsIGxlZnRdO1xuZXhwb3J0IHZhciBzdGFydCA9ICdzdGFydCc7XG5leHBvcnQgdmFyIGVuZCA9ICdlbmQnO1xuZXhwb3J0IHZhciBjbGlwcGluZ1BhcmVudHMgPSAnY2xpcHBpbmdQYXJlbnRzJztcbmV4cG9ydCB2YXIgdmlld3BvcnQgPSAndmlld3BvcnQnO1xuZXhwb3J0IHZhciBwb3BwZXIgPSAncG9wcGVyJztcbmV4cG9ydCB2YXIgcmVmZXJlbmNlID0gJ3JlZmVyZW5jZSc7XG5leHBvcnQgdmFyIHZhcmlhdGlvblBsYWNlbWVudHMgPSAvKiNfX1BVUkVfXyovYmFzZVBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50ICsgXCItXCIgKyBzdGFydCwgcGxhY2VtZW50ICsgXCItXCIgKyBlbmRdKTtcbn0sIFtdKTtcbmV4cG9ydCB2YXIgcGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9bXS5jb25jYXQoYmFzZVBsYWNlbWVudHMsIFthdXRvXSkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50LCBwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pOyAvLyBtb2RpZmllcnMgdGhhdCBuZWVkIHRvIHJlYWQgdGhlIERPTVxuXG5leHBvcnQgdmFyIGJlZm9yZVJlYWQgPSAnYmVmb3JlUmVhZCc7XG5leHBvcnQgdmFyIHJlYWQgPSAncmVhZCc7XG5leHBvcnQgdmFyIGFmdGVyUmVhZCA9ICdhZnRlclJlYWQnOyAvLyBwdXJlLWxvZ2ljIG1vZGlmaWVyc1xuXG5leHBvcnQgdmFyIGJlZm9yZU1haW4gPSAnYmVmb3JlTWFpbic7XG5leHBvcnQgdmFyIG1haW4gPSAnbWFpbic7XG5leHBvcnQgdmFyIGFmdGVyTWFpbiA9ICdhZnRlck1haW4nOyAvLyBtb2RpZmllciB3aXRoIHRoZSBwdXJwb3NlIHRvIHdyaXRlIHRvIHRoZSBET00gKG9yIHdyaXRlIGludG8gYSBmcmFtZXdvcmsgc3RhdGUpXG5cbmV4cG9ydCB2YXIgYmVmb3JlV3JpdGUgPSAnYmVmb3JlV3JpdGUnO1xuZXhwb3J0IHZhciB3cml0ZSA9ICd3cml0ZSc7XG5leHBvcnQgdmFyIGFmdGVyV3JpdGUgPSAnYWZ0ZXJXcml0ZSc7XG5leHBvcnQgdmFyIG1vZGlmaWVyUGhhc2VzID0gW2JlZm9yZVJlYWQsIHJlYWQsIGFmdGVyUmVhZCwgYmVmb3JlTWFpbiwgbWFpbiwgYWZ0ZXJNYWluLCBiZWZvcmVXcml0ZSwgd3JpdGUsIGFmdGVyV3JpdGVdOyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlTmFtZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50ID8gKGVsZW1lbnQubm9kZU5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3cobm9kZSkge1xuICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIGlmIChub2RlLnRvU3RyaW5nKCkgIT09ICdbb2JqZWN0IFdpbmRvd10nKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIG93bmVyRG9jdW1lbnQgPyBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdyA6IHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBub2RlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5FbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzSFRNTEVsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5IVE1MRWxlbWVudDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNTaGFkb3dSb290KG5vZGUpIHtcbiAgLy8gSUUgMTEgaGFzIG5vIFNoYWRvd1Jvb3RcbiAgaWYgKHR5cGVvZiBTaGFkb3dSb290ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLlNoYWRvd1Jvb3Q7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdDtcbn1cblxuZXhwb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfTsiLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gVGhpcyBtb2RpZmllciB0YWtlcyB0aGUgc3R5bGVzIHByZXBhcmVkIGJ5IHRoZSBgY29tcHV0ZVN0eWxlc2AgbW9kaWZpZXJcbi8vIGFuZCBhcHBsaWVzIHRoZW0gdG8gdGhlIEhUTUxFbGVtZW50cyBzdWNoIGFzIHBvcHBlciBhbmQgYXJyb3dcblxuZnVuY3Rpb24gYXBwbHlTdHlsZXMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlO1xuICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBzdHlsZSA9IHN0YXRlLnN0eWxlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHN0YXRlLmF0dHJpYnV0ZXNbbmFtZV0gfHwge307XG4gICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0byBleHRlbmQgdGhpcyBwcm9wZXJ0eSwgYnV0IGl0J3MgdGhlIG1vc3RcbiAgICAvLyBlZmZlY3RpdmUgd2F5IHRvIGFwcGx5IHN0eWxlcyB0byBhbiBIVE1MRWxlbWVudFxuICAgIC8vICRGbG93Rml4TWVbY2Fubm90LXdyaXRlXVxuXG5cbiAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuXG4gICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUgPT09IHRydWUgPyAnJyA6IHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZTtcbiAgdmFyIGluaXRpYWxTdHlsZXMgPSB7XG4gICAgcG9wcGVyOiB7XG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGxlZnQ6ICcwJyxcbiAgICAgIHRvcDogJzAnLFxuICAgICAgbWFyZ2luOiAnMCdcbiAgICB9LFxuICAgIGFycm93OiB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgIH0sXG4gICAgcmVmZXJlbmNlOiB7fVxuICB9O1xuICBPYmplY3QuYXNzaWduKHN0YXRlLmVsZW1lbnRzLnBvcHBlci5zdHlsZSwgaW5pdGlhbFN0eWxlcy5wb3BwZXIpO1xuICBzdGF0ZS5zdHlsZXMgPSBpbml0aWFsU3R5bGVzO1xuXG4gIGlmIChzdGF0ZS5lbGVtZW50cy5hcnJvdykge1xuICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMuYXJyb3cuc3R5bGUsIGluaXRpYWxTdHlsZXMuYXJyb3cpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTtcbiAgICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICAgIHZhciBzdHlsZVByb3BlcnRpZXMgPSBPYmplY3Qua2V5cyhzdGF0ZS5zdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkgPyBzdGF0ZS5zdHlsZXNbbmFtZV0gOiBpbml0aWFsU3R5bGVzW25hbWVdKTsgLy8gU2V0IGFsbCB2YWx1ZXMgdG8gYW4gZW1wdHkgc3RyaW5nIHRvIHVuc2V0IHRoZW1cblxuICAgICAgdmFyIHN0eWxlID0gc3R5bGVQcm9wZXJ0aWVzLnJlZHVjZShmdW5jdGlvbiAoc3R5bGUsIHByb3BlcnR5KSB7XG4gICAgICAgIHN0eWxlW3Byb3BlcnR5XSA9ICcnO1xuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgICB9LCB7fSk7IC8vIGFycm93IGlzIG9wdGlvbmFsICsgdmlydHVhbCBlbGVtZW50c1xuXG4gICAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZSk7XG4gICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXBwbHlTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGFwcGx5U3R5bGVzLFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsnY29tcHV0ZVN0eWxlcyddXG59OyIsICJpbXBvcnQgeyBhdXRvIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMF07XG59IiwgImV4cG9ydCB2YXIgbWF4ID0gTWF0aC5tYXg7XG5leHBvcnQgdmFyIG1pbiA9IE1hdGgubWluO1xuZXhwb3J0IHZhciByb3VuZCA9IE1hdGgucm91bmQ7IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVBU3RyaW5nKCkge1xuICB2YXIgdWFEYXRhID0gbmF2aWdhdG9yLnVzZXJBZ2VudERhdGE7XG5cbiAgaWYgKHVhRGF0YSAhPSBudWxsICYmIHVhRGF0YS5icmFuZHMgJiYgQXJyYXkuaXNBcnJheSh1YURhdGEuYnJhbmRzKSkge1xuICAgIHJldHVybiB1YURhdGEuYnJhbmRzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uYnJhbmQgKyBcIi9cIiArIGl0ZW0udmVyc2lvbjtcbiAgICB9KS5qb2luKCcgJyk7XG4gIH1cblxuICByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbn0iLCAiaW1wb3J0IGdldFVBU3RyaW5nIGZyb20gXCIuLi91dGlscy91c2VyQWdlbnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzTGF5b3V0Vmlld3BvcnQoKSB7XG4gIHJldHVybiAhL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChnZXRVQVN0cmluZygpKTtcbn0iLCAiaW1wb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBpc0xheW91dFZpZXdwb3J0IGZyb20gXCIuL2lzTGF5b3V0Vmlld3BvcnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBpbmNsdWRlU2NhbGUsIGlzRml4ZWRTdHJhdGVneSkge1xuICBpZiAoaW5jbHVkZVNjYWxlID09PSB2b2lkIDApIHtcbiAgICBpbmNsdWRlU2NhbGUgPSBmYWxzZTtcbiAgfVxuXG4gIGlmIChpc0ZpeGVkU3RyYXRlZ3kgPT09IHZvaWQgMCkge1xuICAgIGlzRml4ZWRTdHJhdGVneSA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIGNsaWVudFJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgc2NhbGVYID0gMTtcbiAgdmFyIHNjYWxlWSA9IDE7XG5cbiAgaWYgKGluY2x1ZGVTY2FsZSAmJiBpc0hUTUxFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgc2NhbGVYID0gZWxlbWVudC5vZmZzZXRXaWR0aCA+IDAgPyByb3VuZChjbGllbnRSZWN0LndpZHRoKSAvIGVsZW1lbnQub2Zmc2V0V2lkdGggfHwgMSA6IDE7XG4gICAgc2NhbGVZID0gZWxlbWVudC5vZmZzZXRIZWlnaHQgPiAwID8gcm91bmQoY2xpZW50UmVjdC5oZWlnaHQpIC8gZWxlbWVudC5vZmZzZXRIZWlnaHQgfHwgMSA6IDE7XG4gIH1cblxuICB2YXIgX3JlZiA9IGlzRWxlbWVudChlbGVtZW50KSA/IGdldFdpbmRvdyhlbGVtZW50KSA6IHdpbmRvdyxcbiAgICAgIHZpc3VhbFZpZXdwb3J0ID0gX3JlZi52aXN1YWxWaWV3cG9ydDtcblxuICB2YXIgYWRkVmlzdWFsT2Zmc2V0cyA9ICFpc0xheW91dFZpZXdwb3J0KCkgJiYgaXNGaXhlZFN0cmF0ZWd5O1xuICB2YXIgeCA9IChjbGllbnRSZWN0LmxlZnQgKyAoYWRkVmlzdWFsT2Zmc2V0cyAmJiB2aXN1YWxWaWV3cG9ydCA/IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQgOiAwKSkgLyBzY2FsZVg7XG4gIHZhciB5ID0gKGNsaWVudFJlY3QudG9wICsgKGFkZFZpc3VhbE9mZnNldHMgJiYgdmlzdWFsVmlld3BvcnQgPyB2aXN1YWxWaWV3cG9ydC5vZmZzZXRUb3AgOiAwKSkgLyBzY2FsZVk7XG4gIHZhciB3aWR0aCA9IGNsaWVudFJlY3Qud2lkdGggLyBzY2FsZVg7XG4gIHZhciBoZWlnaHQgPSBjbGllbnRSZWN0LmhlaWdodCAvIHNjYWxlWTtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgdG9wOiB5LFxuICAgIHJpZ2h0OiB4ICsgd2lkdGgsXG4gICAgYm90dG9tOiB5ICsgaGVpZ2h0LFxuICAgIGxlZnQ6IHgsXG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7IC8vIFJldHVybnMgdGhlIGxheW91dCByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC4gTGF5b3V0XG4vLyBtZWFucyBpdCBkb2Vzbid0IHRha2UgaW50byBhY2NvdW50IHRyYW5zZm9ybXMuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldExheW91dFJlY3QoZWxlbWVudCkge1xuICB2YXIgY2xpZW50UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KTsgLy8gVXNlIHRoZSBjbGllbnRSZWN0IHNpemVzIGlmIGl0J3Mgbm90IGJlZW4gdHJhbnNmb3JtZWQuXG4gIC8vIEZpeGVzIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvMTIyM1xuXG4gIHZhciB3aWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gIHZhciBoZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDtcblxuICBpZiAoTWF0aC5hYnMoY2xpZW50UmVjdC53aWR0aCAtIHdpZHRoKSA8PSAxKSB7XG4gICAgd2lkdGggPSBjbGllbnRSZWN0LndpZHRoO1xuICB9XG5cbiAgaWYgKE1hdGguYWJzKGNsaWVudFJlY3QuaGVpZ2h0IC0gaGVpZ2h0KSA8PSAxKSB7XG4gICAgaGVpZ2h0ID0gY2xpZW50UmVjdC5oZWlnaHQ7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHg6IGVsZW1lbnQub2Zmc2V0TGVmdCxcbiAgICB5OiBlbGVtZW50Lm9mZnNldFRvcCxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHRcbiAgfTtcbn0iLCAiaW1wb3J0IHsgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29udGFpbnMocGFyZW50LCBjaGlsZCkge1xuICB2YXIgcm9vdE5vZGUgPSBjaGlsZC5nZXRSb290Tm9kZSAmJiBjaGlsZC5nZXRSb290Tm9kZSgpOyAvLyBGaXJzdCwgYXR0ZW1wdCB3aXRoIGZhc3RlciBuYXRpdmUgbWV0aG9kXG5cbiAgaWYgKHBhcmVudC5jb250YWlucyhjaGlsZCkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSAvLyB0aGVuIGZhbGxiYWNrIHRvIGN1c3RvbSBpbXBsZW1lbnRhdGlvbiB3aXRoIFNoYWRvdyBET00gc3VwcG9ydFxuICBlbHNlIGlmIChyb290Tm9kZSAmJiBpc1NoYWRvd1Jvb3Qocm9vdE5vZGUpKSB7XG4gICAgICB2YXIgbmV4dCA9IGNoaWxkO1xuXG4gICAgICBkbyB7XG4gICAgICAgIGlmIChuZXh0ICYmIHBhcmVudC5pc1NhbWVOb2RlKG5leHQpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddOiBuZWVkIGEgYmV0dGVyIHdheSB0byBoYW5kbGUgdGhpcy4uLlxuXG5cbiAgICAgICAgbmV4dCA9IG5leHQucGFyZW50Tm9kZSB8fCBuZXh0Lmhvc3Q7XG4gICAgICB9IHdoaWxlIChuZXh0KTtcbiAgICB9IC8vIEdpdmUgdXAsIHRoZSByZXN1bHQgaXMgZmFsc2VcblxuXG4gIHJldHVybiBmYWxzZTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkge1xuICByZXR1cm4gZ2V0V2luZG93KGVsZW1lbnQpLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG59IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNUYWJsZUVsZW1lbnQoZWxlbWVudCkge1xuICByZXR1cm4gWyd0YWJsZScsICd0ZCcsICd0aCddLmluZGV4T2YoZ2V0Tm9kZU5hbWUoZWxlbWVudCkpID49IDA7XG59IiwgImltcG9ydCB7IGlzRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSB7XG4gIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl06IGFzc3VtZSBib2R5IGlzIGFsd2F5cyBhdmFpbGFibGVcbiAgcmV0dXJuICgoaXNFbGVtZW50KGVsZW1lbnQpID8gZWxlbWVudC5vd25lckRvY3VtZW50IDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gIGVsZW1lbnQuZG9jdW1lbnQpIHx8IHdpbmRvdy5kb2N1bWVudCkuZG9jdW1lbnRFbGVtZW50O1xufSIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgeyBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRQYXJlbnROb2RlKGVsZW1lbnQpIHtcbiAgaWYgKGdldE5vZGVOYW1lKGVsZW1lbnQpID09PSAnaHRtbCcpIHtcbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiAoLy8gdGhpcyBpcyBhIHF1aWNrZXIgKGJ1dCBsZXNzIHR5cGUgc2FmZSkgd2F5IHRvIHNhdmUgcXVpdGUgc29tZSBieXRlcyBmcm9tIHRoZSBidW5kbGVcbiAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dXG4gICAgLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgZWxlbWVudC5hc3NpZ25lZFNsb3QgfHwgLy8gc3RlcCBpbnRvIHRoZSBzaGFkb3cgRE9NIG9mIHRoZSBwYXJlbnQgb2YgYSBzbG90dGVkIG5vZGVcbiAgICBlbGVtZW50LnBhcmVudE5vZGUgfHwgKCAvLyBET00gRWxlbWVudCBkZXRlY3RlZFxuICAgIGlzU2hhZG93Um9vdChlbGVtZW50KSA/IGVsZW1lbnQuaG9zdCA6IG51bGwpIHx8IC8vIFNoYWRvd1Jvb3QgZGV0ZWN0ZWRcbiAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXTogSFRNTEVsZW1lbnQgaXMgYSBOb2RlXG4gICAgZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpIC8vIGZhbGxiYWNrXG5cbiAgKTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCwgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGlzVGFibGVFbGVtZW50IGZyb20gXCIuL2lzVGFibGVFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgZ2V0VUFTdHJpbmcgZnJvbSBcIi4uL3V0aWxzL3VzZXJBZ2VudC5qc1wiO1xuXG5mdW5jdGlvbiBnZXRUcnVlT2Zmc2V0UGFyZW50KGVsZW1lbnQpIHtcbiAgaWYgKCFpc0hUTUxFbGVtZW50KGVsZW1lbnQpIHx8IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvODM3XG4gIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24gPT09ICdmaXhlZCcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBlbGVtZW50Lm9mZnNldFBhcmVudDtcbn0gLy8gYC5vZmZzZXRQYXJlbnRgIHJlcG9ydHMgYG51bGxgIGZvciBmaXhlZCBlbGVtZW50cywgd2hpbGUgYWJzb2x1dGUgZWxlbWVudHNcbi8vIHJldHVybiB0aGUgY29udGFpbmluZyBibG9ja1xuXG5cbmZ1bmN0aW9uIGdldENvbnRhaW5pbmdCbG9jayhlbGVtZW50KSB7XG4gIHZhciBpc0ZpcmVmb3ggPSAvZmlyZWZveC9pLnRlc3QoZ2V0VUFTdHJpbmcoKSk7XG4gIHZhciBpc0lFID0gL1RyaWRlbnQvaS50ZXN0KGdldFVBU3RyaW5nKCkpO1xuXG4gIGlmIChpc0lFICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAvLyBJbiBJRSA5LCAxMCBhbmQgMTEgZml4ZWQgZWxlbWVudHMgY29udGFpbmluZyBibG9jayBpcyBhbHdheXMgZXN0YWJsaXNoZWQgYnkgdGhlIHZpZXdwb3J0XG4gICAgdmFyIGVsZW1lbnRDc3MgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuXG4gICAgaWYgKGVsZW1lbnRDc3MucG9zaXRpb24gPT09ICdmaXhlZCcpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjdXJyZW50Tm9kZSA9IGdldFBhcmVudE5vZGUoZWxlbWVudCk7XG5cbiAgaWYgKGlzU2hhZG93Um9vdChjdXJyZW50Tm9kZSkpIHtcbiAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLmhvc3Q7XG4gIH1cblxuICB3aGlsZSAoaXNIVE1MRWxlbWVudChjdXJyZW50Tm9kZSkgJiYgWydodG1sJywgJ2JvZHknXS5pbmRleE9mKGdldE5vZGVOYW1lKGN1cnJlbnROb2RlKSkgPCAwKSB7XG4gICAgdmFyIGNzcyA9IGdldENvbXB1dGVkU3R5bGUoY3VycmVudE5vZGUpOyAvLyBUaGlzIGlzIG5vbi1leGhhdXN0aXZlIGJ1dCBjb3ZlcnMgdGhlIG1vc3QgY29tbW9uIENTUyBwcm9wZXJ0aWVzIHRoYXRcbiAgICAvLyBjcmVhdGUgYSBjb250YWluaW5nIGJsb2NrLlxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9Db250YWluaW5nX2Jsb2NrI2lkZW50aWZ5aW5nX3RoZV9jb250YWluaW5nX2Jsb2NrXG5cbiAgICBpZiAoY3NzLnRyYW5zZm9ybSAhPT0gJ25vbmUnIHx8IGNzcy5wZXJzcGVjdGl2ZSAhPT0gJ25vbmUnIHx8IGNzcy5jb250YWluID09PSAncGFpbnQnIHx8IFsndHJhbnNmb3JtJywgJ3BlcnNwZWN0aXZlJ10uaW5kZXhPZihjc3Mud2lsbENoYW5nZSkgIT09IC0xIHx8IGlzRmlyZWZveCAmJiBjc3Mud2lsbENoYW5nZSA9PT0gJ2ZpbHRlcicgfHwgaXNGaXJlZm94ICYmIGNzcy5maWx0ZXIgJiYgY3NzLmZpbHRlciAhPT0gJ25vbmUnKSB7XG4gICAgICByZXR1cm4gY3VycmVudE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn0gLy8gR2V0cyB0aGUgY2xvc2VzdCBhbmNlc3RvciBwb3NpdGlvbmVkIGVsZW1lbnQuIEhhbmRsZXMgc29tZSBlZGdlIGNhc2VzLFxuLy8gc3VjaCBhcyB0YWJsZSBhbmNlc3RvcnMgYW5kIGNyb3NzIGJyb3dzZXIgYnVncy5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkge1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgb2Zmc2V0UGFyZW50ID0gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KTtcblxuICB3aGlsZSAob2Zmc2V0UGFyZW50ICYmIGlzVGFibGVFbGVtZW50KG9mZnNldFBhcmVudCkgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgIG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQob2Zmc2V0UGFyZW50KTtcbiAgfVxuXG4gIGlmIChvZmZzZXRQYXJlbnQgJiYgKGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdodG1sJyB8fCBnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpID09PSAnYm9keScgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG5cbiAgcmV0dXJuIG9mZnNldFBhcmVudCB8fCBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkgfHwgd2luZG93O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBbJ3RvcCcsICdib3R0b20nXS5pbmRleE9mKHBsYWNlbWVudCkgPj0gMCA/ICd4JyA6ICd5Jztcbn0iLCAiaW1wb3J0IHsgbWF4IGFzIG1hdGhNYXgsIG1pbiBhcyBtYXRoTWluIH0gZnJvbSBcIi4vbWF0aC5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhpbihtaW4sIHZhbHVlLCBtYXgpIHtcbiAgcmV0dXJuIG1hdGhNYXgobWluLCBtYXRoTWluKHZhbHVlLCBtYXgpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW5NYXhDbGFtcChtaW4sIHZhbHVlLCBtYXgpIHtcbiAgdmFyIHYgPSB3aXRoaW4obWluLCB2YWx1ZSwgbWF4KTtcbiAgcmV0dXJuIHYgPiBtYXggPyBtYXggOiB2O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRGcmVzaFNpZGVPYmplY3QoKSB7XG4gIHJldHVybiB7XG4gICAgdG9wOiAwLFxuICAgIHJpZ2h0OiAwLFxuICAgIGJvdHRvbTogMCxcbiAgICBsZWZ0OiAwXG4gIH07XG59IiwgImltcG9ydCBnZXRGcmVzaFNpZGVPYmplY3QgZnJvbSBcIi4vZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtZXJnZVBhZGRpbmdPYmplY3QocGFkZGluZ09iamVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZ2V0RnJlc2hTaWRlT2JqZWN0KCksIHBhZGRpbmdPYmplY3QpO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBleHBhbmRUb0hhc2hNYXAodmFsdWUsIGtleXMpIHtcbiAgcmV0dXJuIGtleXMucmVkdWNlKGZ1bmN0aW9uIChoYXNoTWFwLCBrZXkpIHtcbiAgICBoYXNoTWFwW2tleV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gaGFzaE1hcDtcbiAgfSwge30pO1xufSIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcIi4uL2RvbS11dGlscy9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB3aXRoaW4gfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgbWVyZ2VQYWRkaW5nT2JqZWN0IGZyb20gXCIuLi91dGlscy9tZXJnZVBhZGRpbmdPYmplY3QuanNcIjtcbmltcG9ydCBleHBhbmRUb0hhc2hNYXAgZnJvbSBcIi4uL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qc1wiO1xuaW1wb3J0IHsgbGVmdCwgcmlnaHQsIGJhc2VQbGFjZW1lbnRzLCB0b3AsIGJvdHRvbSB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciB0b1BhZGRpbmdPYmplY3QgPSBmdW5jdGlvbiB0b1BhZGRpbmdPYmplY3QocGFkZGluZywgc3RhdGUpIHtcbiAgcGFkZGluZyA9IHR5cGVvZiBwYWRkaW5nID09PSAnZnVuY3Rpb24nID8gcGFkZGluZyhPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHBhZGRpbmc7XG4gIHJldHVybiBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xufTtcblxuZnVuY3Rpb24gYXJyb3coX3JlZikge1xuICB2YXIgX3N0YXRlJG1vZGlmaWVyc0RhdGEkO1xuXG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cztcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciBheGlzID0gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KGJhc2VQbGFjZW1lbnQpO1xuICB2YXIgaXNWZXJ0aWNhbCA9IFtsZWZ0LCByaWdodF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwO1xuICB2YXIgbGVuID0gaXNWZXJ0aWNhbCA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICBpZiAoIWFycm93RWxlbWVudCB8fCAhcG9wcGVyT2Zmc2V0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBwYWRkaW5nT2JqZWN0ID0gdG9QYWRkaW5nT2JqZWN0KG9wdGlvbnMucGFkZGluZywgc3RhdGUpO1xuICB2YXIgYXJyb3dSZWN0ID0gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpO1xuICB2YXIgbWluUHJvcCA9IGF4aXMgPT09ICd5JyA/IHRvcCA6IGxlZnQ7XG4gIHZhciBtYXhQcm9wID0gYXhpcyA9PT0gJ3knID8gYm90dG9tIDogcmlnaHQ7XG4gIHZhciBlbmREaWZmID0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2xlbl0gKyBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbYXhpc10gLSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucG9wcGVyW2xlbl07XG4gIHZhciBzdGFydERpZmYgPSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2F4aXNdO1xuICB2YXIgYXJyb3dPZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQoYXJyb3dFbGVtZW50KTtcbiAgdmFyIGNsaWVudFNpemUgPSBhcnJvd09mZnNldFBhcmVudCA/IGF4aXMgPT09ICd5JyA/IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudEhlaWdodCB8fCAwIDogYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50V2lkdGggfHwgMCA6IDA7XG4gIHZhciBjZW50ZXJUb1JlZmVyZW5jZSA9IGVuZERpZmYgLyAyIC0gc3RhcnREaWZmIC8gMjsgLy8gTWFrZSBzdXJlIHRoZSBhcnJvdyBkb2Vzbid0IG92ZXJmbG93IHRoZSBwb3BwZXIgaWYgdGhlIGNlbnRlciBwb2ludCBpc1xuICAvLyBvdXRzaWRlIG9mIHRoZSBwb3BwZXIgYm91bmRzXG5cbiAgdmFyIG1pbiA9IHBhZGRpbmdPYmplY3RbbWluUHJvcF07XG4gIHZhciBtYXggPSBjbGllbnRTaXplIC0gYXJyb3dSZWN0W2xlbl0gLSBwYWRkaW5nT2JqZWN0W21heFByb3BdO1xuICB2YXIgY2VudGVyID0gY2xpZW50U2l6ZSAvIDIgLSBhcnJvd1JlY3RbbGVuXSAvIDIgKyBjZW50ZXJUb1JlZmVyZW5jZTtcbiAgdmFyIG9mZnNldCA9IHdpdGhpbihtaW4sIGNlbnRlciwgbWF4KTsgLy8gUHJldmVudHMgYnJlYWtpbmcgc3ludGF4IGhpZ2hsaWdodGluZy4uLlxuXG4gIHZhciBheGlzUHJvcCA9IGF4aXM7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSAoX3N0YXRlJG1vZGlmaWVyc0RhdGEkID0ge30sIF9zdGF0ZSRtb2RpZmllcnNEYXRhJFtheGlzUHJvcF0gPSBvZmZzZXQsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJC5jZW50ZXJPZmZzZXQgPSBvZmZzZXQgLSBjZW50ZXIsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJCk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudCxcbiAgICAgIGFycm93RWxlbWVudCA9IF9vcHRpb25zJGVsZW1lbnQgPT09IHZvaWQgMCA/ICdbZGF0YS1wb3BwZXItYXJyb3ddJyA6IF9vcHRpb25zJGVsZW1lbnQ7XG5cbiAgaWYgKGFycm93RWxlbWVudCA9PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIENTUyBzZWxlY3RvclxuXG5cbiAgaWYgKHR5cGVvZiBhcnJvd0VsZW1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMucG9wcGVyLnF1ZXJ5U2VsZWN0b3IoYXJyb3dFbGVtZW50KTtcblxuICAgIGlmICghYXJyb3dFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgaWYgKCFjb250YWlucyhzdGF0ZS5lbGVtZW50cy5wb3BwZXIsIGFycm93RWxlbWVudCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBzdGF0ZS5lbGVtZW50cy5hcnJvdyA9IGFycm93RWxlbWVudDtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2Fycm93JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgZm46IGFycm93LFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsncG9wcGVyT2Zmc2V0cyddLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ3ByZXZlbnRPdmVyZmxvdyddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRWYXJpYXRpb24ocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQuc3BsaXQoJy0nKVsxXTtcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBlbmQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciB1bnNldFNpZGVzID0ge1xuICB0b3A6ICdhdXRvJyxcbiAgcmlnaHQ6ICdhdXRvJyxcbiAgYm90dG9tOiAnYXV0bycsXG4gIGxlZnQ6ICdhdXRvJ1xufTsgLy8gUm91bmQgdGhlIG9mZnNldHMgdG8gdGhlIG5lYXJlc3Qgc3VpdGFibGUgc3VicGl4ZWwgYmFzZWQgb24gdGhlIERQUi5cbi8vIFpvb21pbmcgY2FuIGNoYW5nZSB0aGUgRFBSLCBidXQgaXQgc2VlbXMgdG8gcmVwb3J0IGEgdmFsdWUgdGhhdCB3aWxsXG4vLyBjbGVhbmx5IGRpdmlkZSB0aGUgdmFsdWVzIGludG8gdGhlIGFwcHJvcHJpYXRlIHN1YnBpeGVscy5cblxuZnVuY3Rpb24gcm91bmRPZmZzZXRzQnlEUFIoX3JlZiwgd2luKSB7XG4gIHZhciB4ID0gX3JlZi54LFxuICAgICAgeSA9IF9yZWYueTtcbiAgdmFyIGRwciA9IHdpbi5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gIHJldHVybiB7XG4gICAgeDogcm91bmQoeCAqIGRwcikgLyBkcHIgfHwgMCxcbiAgICB5OiByb3VuZCh5ICogZHByKSAvIGRwciB8fCAwXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXBUb1N0eWxlcyhfcmVmMikge1xuICB2YXIgX09iamVjdCRhc3NpZ24yO1xuXG4gIHZhciBwb3BwZXIgPSBfcmVmMi5wb3BwZXIsXG4gICAgICBwb3BwZXJSZWN0ID0gX3JlZjIucG9wcGVyUmVjdCxcbiAgICAgIHBsYWNlbWVudCA9IF9yZWYyLnBsYWNlbWVudCxcbiAgICAgIHZhcmlhdGlvbiA9IF9yZWYyLnZhcmlhdGlvbixcbiAgICAgIG9mZnNldHMgPSBfcmVmMi5vZmZzZXRzLFxuICAgICAgcG9zaXRpb24gPSBfcmVmMi5wb3NpdGlvbixcbiAgICAgIGdwdUFjY2VsZXJhdGlvbiA9IF9yZWYyLmdwdUFjY2VsZXJhdGlvbixcbiAgICAgIGFkYXB0aXZlID0gX3JlZjIuYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHMgPSBfcmVmMi5yb3VuZE9mZnNldHMsXG4gICAgICBpc0ZpeGVkID0gX3JlZjIuaXNGaXhlZDtcbiAgdmFyIF9vZmZzZXRzJHggPSBvZmZzZXRzLngsXG4gICAgICB4ID0gX29mZnNldHMkeCA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHgsXG4gICAgICBfb2Zmc2V0cyR5ID0gb2Zmc2V0cy55LFxuICAgICAgeSA9IF9vZmZzZXRzJHkgPT09IHZvaWQgMCA/IDAgOiBfb2Zmc2V0cyR5O1xuXG4gIHZhciBfcmVmMyA9IHR5cGVvZiByb3VuZE9mZnNldHMgPT09ICdmdW5jdGlvbicgPyByb3VuZE9mZnNldHMoe1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9KSA6IHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcblxuICB4ID0gX3JlZjMueDtcbiAgeSA9IF9yZWYzLnk7XG4gIHZhciBoYXNYID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneCcpO1xuICB2YXIgaGFzWSA9IG9mZnNldHMuaGFzT3duUHJvcGVydHkoJ3knKTtcbiAgdmFyIHNpZGVYID0gbGVmdDtcbiAgdmFyIHNpZGVZID0gdG9wO1xuICB2YXIgd2luID0gd2luZG93O1xuXG4gIGlmIChhZGFwdGl2ZSkge1xuICAgIHZhciBvZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQocG9wcGVyKTtcbiAgICB2YXIgaGVpZ2h0UHJvcCA9ICdjbGllbnRIZWlnaHQnO1xuICAgIHZhciB3aWR0aFByb3AgPSAnY2xpZW50V2lkdGgnO1xuXG4gICAgaWYgKG9mZnNldFBhcmVudCA9PT0gZ2V0V2luZG93KHBvcHBlcikpIHtcbiAgICAgIG9mZnNldFBhcmVudCA9IGdldERvY3VtZW50RWxlbWVudChwb3BwZXIpO1xuXG4gICAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uICE9PSAnc3RhdGljJyAmJiBwb3NpdGlvbiA9PT0gJ2Fic29sdXRlJykge1xuICAgICAgICBoZWlnaHRQcm9wID0gJ3Njcm9sbEhlaWdodCc7XG4gICAgICAgIHdpZHRoUHJvcCA9ICdzY3JvbGxXaWR0aCc7XG4gICAgICB9XG4gICAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYXN0XTogZm9yY2UgdHlwZSByZWZpbmVtZW50LCB3ZSBjb21wYXJlIG9mZnNldFBhcmVudCB3aXRoIHdpbmRvdyBhYm92ZSwgYnV0IEZsb3cgZG9lc24ndCBkZXRlY3QgaXRcblxuXG4gICAgb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50O1xuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gdG9wIHx8IChwbGFjZW1lbnQgPT09IGxlZnQgfHwgcGxhY2VtZW50ID09PSByaWdodCkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVZID0gYm90dG9tO1xuICAgICAgdmFyIG9mZnNldFkgPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC5oZWlnaHQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICAgIG9mZnNldFBhcmVudFtoZWlnaHRQcm9wXTtcbiAgICAgIHkgLT0gb2Zmc2V0WSAtIHBvcHBlclJlY3QuaGVpZ2h0O1xuICAgICAgeSAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCAocGxhY2VtZW50ID09PSB0b3AgfHwgcGxhY2VtZW50ID09PSBib3R0b20pICYmIHZhcmlhdGlvbiA9PT0gZW5kKSB7XG4gICAgICBzaWRlWCA9IHJpZ2h0O1xuICAgICAgdmFyIG9mZnNldFggPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC53aWR0aCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W3dpZHRoUHJvcF07XG4gICAgICB4IC09IG9mZnNldFggLSBwb3BwZXJSZWN0LndpZHRoO1xuICAgICAgeCAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1vblN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIHBvc2l0aW9uOiBwb3NpdGlvblxuICB9LCBhZGFwdGl2ZSAmJiB1bnNldFNpZGVzKTtcblxuICB2YXIgX3JlZjQgPSByb3VuZE9mZnNldHMgPT09IHRydWUgPyByb3VuZE9mZnNldHNCeURQUih7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0sIGdldFdpbmRvdyhwb3BwZXIpKSA6IHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcblxuICB4ID0gX3JlZjQueDtcbiAgeSA9IF9yZWY0Lnk7XG5cbiAgaWYgKGdwdUFjY2VsZXJhdGlvbikge1xuICAgIHZhciBfT2JqZWN0JGFzc2lnbjtcblxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIChfT2JqZWN0JGFzc2lnbiA9IHt9LCBfT2JqZWN0JGFzc2lnbltzaWRlWV0gPSBoYXNZID8gJzAnIDogJycsIF9PYmplY3QkYXNzaWduW3NpZGVYXSA9IGhhc1ggPyAnMCcgOiAnJywgX09iamVjdCRhc3NpZ24udHJhbnNmb3JtID0gKHdpbi5kZXZpY2VQaXhlbFJhdGlvIHx8IDEpIDw9IDEgPyBcInRyYW5zbGF0ZShcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4KVwiIDogXCJ0cmFuc2xhdGUzZChcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4LCAwKVwiLCBfT2JqZWN0JGFzc2lnbikpO1xuICB9XG5cbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywgKF9PYmplY3QkYXNzaWduMiA9IHt9LCBfT2JqZWN0JGFzc2lnbjJbc2lkZVldID0gaGFzWSA/IHkgKyBcInB4XCIgOiAnJywgX09iamVjdCRhc3NpZ24yW3NpZGVYXSA9IGhhc1ggPyB4ICsgXCJweFwiIDogJycsIF9PYmplY3QkYXNzaWduMi50cmFuc2Zvcm0gPSAnJywgX09iamVjdCRhc3NpZ24yKSk7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVTdHlsZXMoX3JlZjUpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjUuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjUub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJGdwdUFjY2VsZXJhdCA9IG9wdGlvbnMuZ3B1QWNjZWxlcmF0aW9uLFxuICAgICAgZ3B1QWNjZWxlcmF0aW9uID0gX29wdGlvbnMkZ3B1QWNjZWxlcmF0ID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkZ3B1QWNjZWxlcmF0LFxuICAgICAgX29wdGlvbnMkYWRhcHRpdmUgPSBvcHRpb25zLmFkYXB0aXZlLFxuICAgICAgYWRhcHRpdmUgPSBfb3B0aW9ucyRhZGFwdGl2ZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGFkYXB0aXZlLFxuICAgICAgX29wdGlvbnMkcm91bmRPZmZzZXRzID0gb3B0aW9ucy5yb3VuZE9mZnNldHMsXG4gICAgICByb3VuZE9mZnNldHMgPSBfb3B0aW9ucyRyb3VuZE9mZnNldHMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRyb3VuZE9mZnNldHM7XG4gIHZhciBjb21tb25TdHlsZXMgPSB7XG4gICAgcGxhY2VtZW50OiBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCksXG4gICAgdmFyaWF0aW9uOiBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KSxcbiAgICBwb3BwZXI6IHN0YXRlLmVsZW1lbnRzLnBvcHBlcixcbiAgICBwb3BwZXJSZWN0OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgZ3B1QWNjZWxlcmF0aW9uOiBncHVBY2NlbGVyYXRpb24sXG4gICAgaXNGaXhlZDogc3RhdGUub3B0aW9ucy5zdHJhdGVneSA9PT0gJ2ZpeGVkJ1xuICB9O1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMgIT0gbnVsbCkge1xuICAgIHN0YXRlLnN0eWxlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zdHlsZXMucG9wcGVyLCBtYXBUb1N0eWxlcyhPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIHtcbiAgICAgIG9mZnNldHM6IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyxcbiAgICAgIHBvc2l0aW9uOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgYWRhcHRpdmU6IGFkYXB0aXZlLFxuICAgICAgcm91bmRPZmZzZXRzOiByb3VuZE9mZnNldHNcbiAgICB9KSkpO1xuICB9XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEuYXJyb3cgIT0gbnVsbCkge1xuICAgIHN0YXRlLnN0eWxlcy5hcnJvdyA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnN0eWxlcy5hcnJvdywgbWFwVG9TdHlsZXMoT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCB7XG4gICAgICBvZmZzZXRzOiBzdGF0ZS5tb2RpZmllcnNEYXRhLmFycm93LFxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICBhZGFwdGl2ZTogZmFsc2UsXG4gICAgICByb3VuZE9mZnNldHM6IHJvdW5kT2Zmc2V0c1xuICAgIH0pKSk7XG4gIH1cblxuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXBsYWNlbWVudCc6IHN0YXRlLnBsYWNlbWVudFxuICB9KTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2NvbXB1dGVTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ2JlZm9yZVdyaXRlJyxcbiAgZm46IGNvbXB1dGVTdHlsZXMsXG4gIGRhdGE6IHt9XG59OyIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0V2luZG93LmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHBhc3NpdmUgPSB7XG4gIHBhc3NpdmU6IHRydWVcbn07XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBpbnN0YW5jZSA9IF9yZWYuaW5zdGFuY2UsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkc2Nyb2xsID0gb3B0aW9ucy5zY3JvbGwsXG4gICAgICBzY3JvbGwgPSBfb3B0aW9ucyRzY3JvbGwgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRzY3JvbGwsXG4gICAgICBfb3B0aW9ucyRyZXNpemUgPSBvcHRpb25zLnJlc2l6ZSxcbiAgICAgIHJlc2l6ZSA9IF9vcHRpb25zJHJlc2l6ZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHJlc2l6ZTtcbiAgdmFyIHdpbmRvdyA9IGdldFdpbmRvdyhzdGF0ZS5lbGVtZW50cy5wb3BwZXIpO1xuICB2YXIgc2Nyb2xsUGFyZW50cyA9IFtdLmNvbmNhdChzdGF0ZS5zY3JvbGxQYXJlbnRzLnJlZmVyZW5jZSwgc3RhdGUuc2Nyb2xsUGFyZW50cy5wb3BwZXIpO1xuXG4gIGlmIChzY3JvbGwpIHtcbiAgICBzY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24gKHNjcm9sbFBhcmVudCkge1xuICAgICAgc2Nyb2xsUGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAocmVzaXplKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmIChzY3JvbGwpIHtcbiAgICAgIHNjcm9sbFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2Nyb2xsUGFyZW50KSB7XG4gICAgICAgIHNjcm9sbFBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc2l6ZSkge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgfVxuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZXZlbnRMaXN0ZW5lcnMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGZ1bmN0aW9uIGZuKCkge30sXG4gIGVmZmVjdDogZWZmZWN0LFxuICBkYXRhOiB7fVxufTsiLCAidmFyIGhhc2ggPSB7XG4gIGxlZnQ6ICdyaWdodCcsXG4gIHJpZ2h0OiAnbGVmdCcsXG4gIGJvdHRvbTogJ3RvcCcsXG4gIHRvcDogJ2JvdHRvbSdcbn07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5yZXBsYWNlKC9sZWZ0fHJpZ2h0fGJvdHRvbXx0b3AvZywgZnVuY3Rpb24gKG1hdGNoZWQpIHtcbiAgICByZXR1cm4gaGFzaFttYXRjaGVkXTtcbiAgfSk7XG59IiwgInZhciBoYXNoID0ge1xuICBzdGFydDogJ2VuZCcsXG4gIGVuZDogJ3N0YXJ0J1xufTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL3N0YXJ0fGVuZC9nLCBmdW5jdGlvbiAobWF0Y2hlZCkge1xuICAgIHJldHVybiBoYXNoW21hdGNoZWRdO1xuICB9KTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvd1Njcm9sbChub2RlKSB7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3cobm9kZSk7XG4gIHZhciBzY3JvbGxMZWZ0ID0gd2luLnBhZ2VYT2Zmc2V0O1xuICB2YXIgc2Nyb2xsVG9wID0gd2luLnBhZ2VZT2Zmc2V0O1xuICByZXR1cm4ge1xuICAgIHNjcm9sbExlZnQ6IHNjcm9sbExlZnQsXG4gICAgc2Nyb2xsVG9wOiBzY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KSB7XG4gIC8vIElmIDxodG1sPiBoYXMgYSBDU1Mgd2lkdGggZ3JlYXRlciB0aGFuIHRoZSB2aWV3cG9ydCwgdGhlbiB0aGlzIHdpbGwgYmVcbiAgLy8gaW5jb3JyZWN0IGZvciBSVEwuXG4gIC8vIFBvcHBlciAxIGlzIGJyb2tlbiBpbiB0aGlzIGNhc2UgYW5kIG5ldmVyIGhhZCBhIGJ1ZyByZXBvcnQgc28gbGV0J3MgYXNzdW1lXG4gIC8vIGl0J3Mgbm90IGFuIGlzc3VlLiBJIGRvbid0IHRoaW5rIGFueW9uZSBldmVyIHNwZWNpZmllcyB3aWR0aCBvbiA8aHRtbD5cbiAgLy8gYW55d2F5LlxuICAvLyBCcm93c2VycyB3aGVyZSB0aGUgbGVmdCBzY3JvbGxiYXIgZG9lc24ndCBjYXVzZSBhbiBpc3N1ZSByZXBvcnQgYDBgIGZvclxuICAvLyB0aGlzIChlLmcuIEVkZ2UgMjAxOSwgSUUxMSwgU2FmYXJpKVxuICByZXR1cm4gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkubGVmdCArIGdldFdpbmRvd1Njcm9sbChlbGVtZW50KS5zY3JvbGxMZWZ0O1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBpc0xheW91dFZpZXdwb3J0IGZyb20gXCIuL2lzTGF5b3V0Vmlld3BvcnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFZpZXdwb3J0UmVjdChlbGVtZW50LCBzdHJhdGVneSkge1xuICB2YXIgd2luID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgaHRtbCA9IGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KTtcbiAgdmFyIHZpc3VhbFZpZXdwb3J0ID0gd2luLnZpc3VhbFZpZXdwb3J0O1xuICB2YXIgd2lkdGggPSBodG1sLmNsaWVudFdpZHRoO1xuICB2YXIgaGVpZ2h0ID0gaHRtbC5jbGllbnRIZWlnaHQ7XG4gIHZhciB4ID0gMDtcbiAgdmFyIHkgPSAwO1xuXG4gIGlmICh2aXN1YWxWaWV3cG9ydCkge1xuICAgIHdpZHRoID0gdmlzdWFsVmlld3BvcnQud2lkdGg7XG4gICAgaGVpZ2h0ID0gdmlzdWFsVmlld3BvcnQuaGVpZ2h0O1xuICAgIHZhciBsYXlvdXRWaWV3cG9ydCA9IGlzTGF5b3V0Vmlld3BvcnQoKTtcblxuICAgIGlmIChsYXlvdXRWaWV3cG9ydCB8fCAhbGF5b3V0Vmlld3BvcnQgJiYgc3RyYXRlZ3kgPT09ICdmaXhlZCcpIHtcbiAgICAgIHggPSB2aXN1YWxWaWV3cG9ydC5vZmZzZXRMZWZ0O1xuICAgICAgeSA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldFRvcDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KSxcbiAgICB5OiB5XG4gIH07XG59IiwgImltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbC5qc1wiO1xuaW1wb3J0IHsgbWF4IH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjsgLy8gR2V0cyB0aGUgZW50aXJlIHNpemUgb2YgdGhlIHNjcm9sbGFibGUgZG9jdW1lbnQgYXJlYSwgZXZlbiBleHRlbmRpbmcgb3V0c2lkZVxuLy8gb2YgdGhlIGA8aHRtbD5gIGFuZCBgPGJvZHk+YCByZWN0IGJvdW5kcyBpZiBob3Jpem9udGFsbHkgc2Nyb2xsYWJsZVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXREb2N1bWVudFJlY3QoZWxlbWVudCkge1xuICB2YXIgX2VsZW1lbnQkb3duZXJEb2N1bWVuO1xuXG4gIHZhciBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpO1xuICB2YXIgd2luU2Nyb2xsID0gZ2V0V2luZG93U2Nyb2xsKGVsZW1lbnQpO1xuICB2YXIgYm9keSA9IChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keTtcbiAgdmFyIHdpZHRoID0gbWF4KGh0bWwuc2Nyb2xsV2lkdGgsIGh0bWwuY2xpZW50V2lkdGgsIGJvZHkgPyBib2R5LnNjcm9sbFdpZHRoIDogMCwgYm9keSA/IGJvZHkuY2xpZW50V2lkdGggOiAwKTtcbiAgdmFyIGhlaWdodCA9IG1heChodG1sLnNjcm9sbEhlaWdodCwgaHRtbC5jbGllbnRIZWlnaHQsIGJvZHkgPyBib2R5LnNjcm9sbEhlaWdodCA6IDAsIGJvZHkgPyBib2R5LmNsaWVudEhlaWdodCA6IDApO1xuICB2YXIgeCA9IC13aW5TY3JvbGwuc2Nyb2xsTGVmdCArIGdldFdpbmRvd1Njcm9sbEJhclgoZWxlbWVudCk7XG4gIHZhciB5ID0gLXdpblNjcm9sbC5zY3JvbGxUb3A7XG5cbiAgaWYgKGdldENvbXB1dGVkU3R5bGUoYm9keSB8fCBodG1sKS5kaXJlY3Rpb24gPT09ICdydGwnKSB7XG4gICAgeCArPSBtYXgoaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuY2xpZW50V2lkdGggOiAwKSAtIHdpZHRoO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG59IiwgImltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzU2Nyb2xsUGFyZW50KGVsZW1lbnQpIHtcbiAgLy8gRmlyZWZveCB3YW50cyB1cyB0byBjaGVjayBgLXhgIGFuZCBgLXlgIHZhcmlhdGlvbnMgYXMgd2VsbFxuICB2YXIgX2dldENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLFxuICAgICAgb3ZlcmZsb3cgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5vdmVyZmxvdyxcbiAgICAgIG92ZXJmbG93WCA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93WCxcbiAgICAgIG92ZXJmbG93WSA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93WTtcblxuICByZXR1cm4gL2F1dG98c2Nyb2xsfG92ZXJsYXl8aGlkZGVuLy50ZXN0KG92ZXJmbG93ICsgb3ZlcmZsb3dZICsgb3ZlcmZsb3dYKTtcbn0iLCAiaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRTY3JvbGxQYXJlbnQobm9kZSkge1xuICBpZiAoWydodG1sJywgJ2JvZHknLCAnI2RvY3VtZW50J10uaW5kZXhPZihnZXROb2RlTmFtZShub2RlKSkgPj0gMCkge1xuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl06IGFzc3VtZSBib2R5IGlzIGFsd2F5cyBhdmFpbGFibGVcbiAgICByZXR1cm4gbm9kZS5vd25lckRvY3VtZW50LmJvZHk7XG4gIH1cblxuICBpZiAoaXNIVE1MRWxlbWVudChub2RlKSAmJiBpc1Njcm9sbFBhcmVudChub2RlKSkge1xuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgcmV0dXJuIGdldFNjcm9sbFBhcmVudChnZXRQYXJlbnROb2RlKG5vZGUpKTtcbn0iLCAiaW1wb3J0IGdldFNjcm9sbFBhcmVudCBmcm9tIFwiLi9nZXRTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbi8qXG5naXZlbiBhIERPTSBlbGVtZW50LCByZXR1cm4gdGhlIGxpc3Qgb2YgYWxsIHNjcm9sbCBwYXJlbnRzLCB1cCB0aGUgbGlzdCBvZiBhbmNlc29yc1xudW50aWwgd2UgZ2V0IHRvIHRoZSB0b3Agd2luZG93IG9iamVjdC4gVGhpcyBsaXN0IGlzIHdoYXQgd2UgYXR0YWNoIHNjcm9sbCBsaXN0ZW5lcnNcbnRvLCBiZWNhdXNlIGlmIGFueSBvZiB0aGVzZSBwYXJlbnQgZWxlbWVudHMgc2Nyb2xsLCB3ZSdsbCBuZWVkIHRvIHJlLWNhbGN1bGF0ZSB0aGVcbnJlZmVyZW5jZSBlbGVtZW50J3MgcG9zaXRpb24uXG4qL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsaXN0U2Nyb2xsUGFyZW50cyhlbGVtZW50LCBsaXN0KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgaWYgKGxpc3QgPT09IHZvaWQgMCkge1xuICAgIGxpc3QgPSBbXTtcbiAgfVxuXG4gIHZhciBzY3JvbGxQYXJlbnQgPSBnZXRTY3JvbGxQYXJlbnQoZWxlbWVudCk7XG4gIHZhciBpc0JvZHkgPSBzY3JvbGxQYXJlbnQgPT09ICgoX2VsZW1lbnQkb3duZXJEb2N1bWVuID0gZWxlbWVudC5vd25lckRvY3VtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2VsZW1lbnQkb3duZXJEb2N1bWVuLmJvZHkpO1xuICB2YXIgd2luID0gZ2V0V2luZG93KHNjcm9sbFBhcmVudCk7XG4gIHZhciB0YXJnZXQgPSBpc0JvZHkgPyBbd2luXS5jb25jYXQod2luLnZpc3VhbFZpZXdwb3J0IHx8IFtdLCBpc1Njcm9sbFBhcmVudChzY3JvbGxQYXJlbnQpID8gc2Nyb2xsUGFyZW50IDogW10pIDogc2Nyb2xsUGFyZW50O1xuICB2YXIgdXBkYXRlZExpc3QgPSBsaXN0LmNvbmNhdCh0YXJnZXQpO1xuICByZXR1cm4gaXNCb2R5ID8gdXBkYXRlZExpc3QgOiAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXTogaXNCb2R5IHRlbGxzIHVzIHRhcmdldCB3aWxsIGJlIGFuIEhUTUxFbGVtZW50IGhlcmVcbiAgdXBkYXRlZExpc3QuY29uY2F0KGxpc3RTY3JvbGxQYXJlbnRzKGdldFBhcmVudE5vZGUodGFyZ2V0KSkpO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZWN0VG9DbGllbnRSZWN0KHJlY3QpIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHJlY3QsIHtcbiAgICBsZWZ0OiByZWN0LngsXG4gICAgdG9wOiByZWN0LnksXG4gICAgcmlnaHQ6IHJlY3QueCArIHJlY3Qud2lkdGgsXG4gICAgYm90dG9tOiByZWN0LnkgKyByZWN0LmhlaWdodFxuICB9KTtcbn0iLCAiaW1wb3J0IHsgdmlld3BvcnQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRWaWV3cG9ydFJlY3QgZnJvbSBcIi4vZ2V0Vmlld3BvcnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRSZWN0IGZyb20gXCIuL2dldERvY3VtZW50UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2xpc3RTY3JvbGxQYXJlbnRzLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCB7IGlzRWxlbWVudCwgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcIi4vY29udGFpbnMuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHJlY3RUb0NsaWVudFJlY3QgZnJvbSBcIi4uL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IG1heCwgbWluIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcblxuZnVuY3Rpb24gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgc3RyYXRlZ3kpIHtcbiAgdmFyIHJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgZmFsc2UsIHN0cmF0ZWd5ID09PSAnZml4ZWQnKTtcbiAgcmVjdC50b3AgPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50VG9wO1xuICByZWN0LmxlZnQgPSByZWN0LmxlZnQgKyBlbGVtZW50LmNsaWVudExlZnQ7XG4gIHJlY3QuYm90dG9tID0gcmVjdC50b3AgKyBlbGVtZW50LmNsaWVudEhlaWdodDtcbiAgcmVjdC5yaWdodCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3Qud2lkdGggPSBlbGVtZW50LmNsaWVudFdpZHRoO1xuICByZWN0LmhlaWdodCA9IGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnggPSByZWN0LmxlZnQ7XG4gIHJlY3QueSA9IHJlY3QudG9wO1xuICByZXR1cm4gcmVjdDtcbn1cblxuZnVuY3Rpb24gZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgY2xpcHBpbmdQYXJlbnQsIHN0cmF0ZWd5KSB7XG4gIHJldHVybiBjbGlwcGluZ1BhcmVudCA9PT0gdmlld3BvcnQgPyByZWN0VG9DbGllbnRSZWN0KGdldFZpZXdwb3J0UmVjdChlbGVtZW50LCBzdHJhdGVneSkpIDogaXNFbGVtZW50KGNsaXBwaW5nUGFyZW50KSA/IGdldElubmVyQm91bmRpbmdDbGllbnRSZWN0KGNsaXBwaW5nUGFyZW50LCBzdHJhdGVneSkgOiByZWN0VG9DbGllbnRSZWN0KGdldERvY3VtZW50UmVjdChnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkpKTtcbn0gLy8gQSBcImNsaXBwaW5nIHBhcmVudFwiIGlzIGFuIG92ZXJmbG93YWJsZSBjb250YWluZXIgd2l0aCB0aGUgY2hhcmFjdGVyaXN0aWMgb2Zcbi8vIGNsaXBwaW5nIChvciBoaWRpbmcpIG92ZXJmbG93aW5nIGVsZW1lbnRzIHdpdGggYSBwb3NpdGlvbiBkaWZmZXJlbnQgZnJvbVxuLy8gYGluaXRpYWxgXG5cblxuZnVuY3Rpb24gZ2V0Q2xpcHBpbmdQYXJlbnRzKGVsZW1lbnQpIHtcbiAgdmFyIGNsaXBwaW5nUGFyZW50cyA9IGxpc3RTY3JvbGxQYXJlbnRzKGdldFBhcmVudE5vZGUoZWxlbWVudCkpO1xuICB2YXIgY2FuRXNjYXBlQ2xpcHBpbmcgPSBbJ2Fic29sdXRlJywgJ2ZpeGVkJ10uaW5kZXhPZihnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLnBvc2l0aW9uKSA+PSAwO1xuICB2YXIgY2xpcHBlckVsZW1lbnQgPSBjYW5Fc2NhcGVDbGlwcGluZyAmJiBpc0hUTUxFbGVtZW50KGVsZW1lbnQpID8gZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnQpIDogZWxlbWVudDtcblxuICBpZiAoIWlzRWxlbWVudChjbGlwcGVyRWxlbWVudCkpIHtcbiAgICByZXR1cm4gW107XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2Zsb3cvaXNzdWVzLzE0MTRcblxuXG4gIHJldHVybiBjbGlwcGluZ1BhcmVudHMuZmlsdGVyKGZ1bmN0aW9uIChjbGlwcGluZ1BhcmVudCkge1xuICAgIHJldHVybiBpc0VsZW1lbnQoY2xpcHBpbmdQYXJlbnQpICYmIGNvbnRhaW5zKGNsaXBwaW5nUGFyZW50LCBjbGlwcGVyRWxlbWVudCkgJiYgZ2V0Tm9kZU5hbWUoY2xpcHBpbmdQYXJlbnQpICE9PSAnYm9keSc7XG4gIH0pO1xufSAvLyBHZXRzIHRoZSBtYXhpbXVtIGFyZWEgdGhhdCB0aGUgZWxlbWVudCBpcyB2aXNpYmxlIGluIGR1ZSB0byBhbnkgbnVtYmVyIG9mXG4vLyBjbGlwcGluZyBwYXJlbnRzXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q2xpcHBpbmdSZWN0KGVsZW1lbnQsIGJvdW5kYXJ5LCByb290Qm91bmRhcnksIHN0cmF0ZWd5KSB7XG4gIHZhciBtYWluQ2xpcHBpbmdQYXJlbnRzID0gYm91bmRhcnkgPT09ICdjbGlwcGluZ1BhcmVudHMnID8gZ2V0Q2xpcHBpbmdQYXJlbnRzKGVsZW1lbnQpIDogW10uY29uY2F0KGJvdW5kYXJ5KTtcbiAgdmFyIGNsaXBwaW5nUGFyZW50cyA9IFtdLmNvbmNhdChtYWluQ2xpcHBpbmdQYXJlbnRzLCBbcm9vdEJvdW5kYXJ5XSk7XG4gIHZhciBmaXJzdENsaXBwaW5nUGFyZW50ID0gY2xpcHBpbmdQYXJlbnRzWzBdO1xuICB2YXIgY2xpcHBpbmdSZWN0ID0gY2xpcHBpbmdQYXJlbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjUmVjdCwgY2xpcHBpbmdQYXJlbnQpIHtcbiAgICB2YXIgcmVjdCA9IGdldENsaWVudFJlY3RGcm9tTWl4ZWRUeXBlKGVsZW1lbnQsIGNsaXBwaW5nUGFyZW50LCBzdHJhdGVneSk7XG4gICAgYWNjUmVjdC50b3AgPSBtYXgocmVjdC50b3AsIGFjY1JlY3QudG9wKTtcbiAgICBhY2NSZWN0LnJpZ2h0ID0gbWluKHJlY3QucmlnaHQsIGFjY1JlY3QucmlnaHQpO1xuICAgIGFjY1JlY3QuYm90dG9tID0gbWluKHJlY3QuYm90dG9tLCBhY2NSZWN0LmJvdHRvbSk7XG4gICAgYWNjUmVjdC5sZWZ0ID0gbWF4KHJlY3QubGVmdCwgYWNjUmVjdC5sZWZ0KTtcbiAgICByZXR1cm4gYWNjUmVjdDtcbiAgfSwgZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgZmlyc3RDbGlwcGluZ1BhcmVudCwgc3RyYXRlZ3kpKTtcbiAgY2xpcHBpbmdSZWN0LndpZHRoID0gY2xpcHBpbmdSZWN0LnJpZ2h0IC0gY2xpcHBpbmdSZWN0LmxlZnQ7XG4gIGNsaXBwaW5nUmVjdC5oZWlnaHQgPSBjbGlwcGluZ1JlY3QuYm90dG9tIC0gY2xpcHBpbmdSZWN0LnRvcDtcbiAgY2xpcHBpbmdSZWN0LnggPSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LnkgPSBjbGlwcGluZ1JlY3QudG9wO1xuICByZXR1cm4gY2xpcHBpbmdSZWN0O1xufSIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCwgc3RhcnQsIGVuZCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29tcHV0ZU9mZnNldHMoX3JlZikge1xuICB2YXIgcmVmZXJlbmNlID0gX3JlZi5yZWZlcmVuY2UsXG4gICAgICBlbGVtZW50ID0gX3JlZi5lbGVtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX3JlZi5wbGFjZW1lbnQ7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gcGxhY2VtZW50ID8gZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpIDogbnVsbDtcbiAgdmFyIHZhcmlhdGlvbiA9IHBsYWNlbWVudCA/IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpIDogbnVsbDtcbiAgdmFyIGNvbW1vblggPSByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCAvIDIgLSBlbGVtZW50LndpZHRoIC8gMjtcbiAgdmFyIGNvbW1vblkgPSByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHQgLyAyIC0gZWxlbWVudC5oZWlnaHQgLyAyO1xuICB2YXIgb2Zmc2V0cztcblxuICBzd2l0Y2ggKGJhc2VQbGFjZW1lbnQpIHtcbiAgICBjYXNlIHRvcDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IGNvbW1vblgsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55IC0gZWxlbWVudC5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgYm90dG9tOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgKyByZWZlcmVuY2UuaGVpZ2h0XG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIHJpZ2h0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggKyByZWZlcmVuY2Uud2lkdGgsXG4gICAgICAgIHk6IGNvbW1vbllcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgbGVmdDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IHJlZmVyZW5jZS54IC0gZWxlbWVudC53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IHJlZmVyZW5jZS54LFxuICAgICAgICB5OiByZWZlcmVuY2UueVxuICAgICAgfTtcbiAgfVxuXG4gIHZhciBtYWluQXhpcyA9IGJhc2VQbGFjZW1lbnQgPyBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCkgOiBudWxsO1xuXG4gIGlmIChtYWluQXhpcyAhPSBudWxsKSB7XG4gICAgdmFyIGxlbiA9IG1haW5BeGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgICBzd2l0Y2ggKHZhcmlhdGlvbikge1xuICAgICAgY2FzZSBzdGFydDpcbiAgICAgICAgb2Zmc2V0c1ttYWluQXhpc10gPSBvZmZzZXRzW21haW5BeGlzXSAtIChyZWZlcmVuY2VbbGVuXSAvIDIgLSBlbGVtZW50W2xlbl0gLyAyKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZW5kOlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdICsgKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2Zmc2V0cztcbn0iLCAiaW1wb3J0IGdldENsaXBwaW5nUmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldENsaXBwaW5nUmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGNvbXB1dGVPZmZzZXRzIGZyb20gXCIuL2NvbXB1dGVPZmZzZXRzLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi9yZWN0VG9DbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgeyBjbGlwcGluZ1BhcmVudHMsIHJlZmVyZW5jZSwgcG9wcGVyLCBib3R0b20sIHRvcCwgcmlnaHQsIGJhc2VQbGFjZW1lbnRzLCB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4uL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgbWVyZ2VQYWRkaW5nT2JqZWN0IGZyb20gXCIuL21lcmdlUGFkZGluZ09iamVjdC5qc1wiO1xuaW1wb3J0IGV4cGFuZFRvSGFzaE1hcCBmcm9tIFwiLi9leHBhbmRUb0hhc2hNYXAuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9vcHRpb25zID0gb3B0aW9ucyxcbiAgICAgIF9vcHRpb25zJHBsYWNlbWVudCA9IF9vcHRpb25zLnBsYWNlbWVudCxcbiAgICAgIHBsYWNlbWVudCA9IF9vcHRpb25zJHBsYWNlbWVudCA9PT0gdm9pZCAwID8gc3RhdGUucGxhY2VtZW50IDogX29wdGlvbnMkcGxhY2VtZW50LFxuICAgICAgX29wdGlvbnMkc3RyYXRlZ3kgPSBfb3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIHN0cmF0ZWd5ID0gX29wdGlvbnMkc3RyYXRlZ3kgPT09IHZvaWQgMCA/IHN0YXRlLnN0cmF0ZWd5IDogX29wdGlvbnMkc3RyYXRlZ3ksXG4gICAgICBfb3B0aW9ucyRib3VuZGFyeSA9IF9vcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucyRib3VuZGFyeSA9PT0gdm9pZCAwID8gY2xpcHBpbmdQYXJlbnRzIDogX29wdGlvbnMkYm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRyb290Qm91bmRhcnkgPSBfb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBfb3B0aW9ucyRyb290Qm91bmRhcnkgPT09IHZvaWQgMCA/IHZpZXdwb3J0IDogX29wdGlvbnMkcm9vdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkZWxlbWVudENvbnRlID0gX29wdGlvbnMuZWxlbWVudENvbnRleHQsXG4gICAgICBlbGVtZW50Q29udGV4dCA9IF9vcHRpb25zJGVsZW1lbnRDb250ZSA9PT0gdm9pZCAwID8gcG9wcGVyIDogX29wdGlvbnMkZWxlbWVudENvbnRlLFxuICAgICAgX29wdGlvbnMkYWx0Qm91bmRhcnkgPSBfb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gX29wdGlvbnMkYWx0Qm91bmRhcnkgPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRwYWRkaW5nID0gX29wdGlvbnMucGFkZGluZyxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucyRwYWRkaW5nID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkcGFkZGluZztcbiAgdmFyIHBhZGRpbmdPYmplY3QgPSBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xuICB2YXIgYWx0Q29udGV4dCA9IGVsZW1lbnRDb250ZXh0ID09PSBwb3BwZXIgPyByZWZlcmVuY2UgOiBwb3BwZXI7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW2FsdEJvdW5kYXJ5ID8gYWx0Q29udGV4dCA6IGVsZW1lbnRDb250ZXh0XTtcbiAgdmFyIGNsaXBwaW5nQ2xpZW50UmVjdCA9IGdldENsaXBwaW5nUmVjdChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50IDogZWxlbWVudC5jb250ZXh0RWxlbWVudCB8fCBnZXREb2N1bWVudEVsZW1lbnQoc3RhdGUuZWxlbWVudHMucG9wcGVyKSwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSwgc3RyYXRlZ3kpO1xuICB2YXIgcmVmZXJlbmNlQ2xpZW50UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChzdGF0ZS5lbGVtZW50cy5yZWZlcmVuY2UpO1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHJlZmVyZW5jZUNsaWVudFJlY3QsXG4gICAgZWxlbWVudDogcG9wcGVyUmVjdCxcbiAgICBzdHJhdGVneTogJ2Fic29sdXRlJyxcbiAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudFxuICB9KTtcbiAgdmFyIHBvcHBlckNsaWVudFJlY3QgPSByZWN0VG9DbGllbnRSZWN0KE9iamVjdC5hc3NpZ24oe30sIHBvcHBlclJlY3QsIHBvcHBlck9mZnNldHMpKTtcbiAgdmFyIGVsZW1lbnRDbGllbnRSZWN0ID0gZWxlbWVudENvbnRleHQgPT09IHBvcHBlciA/IHBvcHBlckNsaWVudFJlY3QgOiByZWZlcmVuY2VDbGllbnRSZWN0OyAvLyBwb3NpdGl2ZSA9IG92ZXJmbG93aW5nIHRoZSBjbGlwcGluZyByZWN0XG4gIC8vIDAgb3IgbmVnYXRpdmUgPSB3aXRoaW4gdGhlIGNsaXBwaW5nIHJlY3RcblxuICB2YXIgb3ZlcmZsb3dPZmZzZXRzID0ge1xuICAgIHRvcDogY2xpcHBpbmdDbGllbnRSZWN0LnRvcCAtIGVsZW1lbnRDbGllbnRSZWN0LnRvcCArIHBhZGRpbmdPYmplY3QudG9wLFxuICAgIGJvdHRvbTogZWxlbWVudENsaWVudFJlY3QuYm90dG9tIC0gY2xpcHBpbmdDbGllbnRSZWN0LmJvdHRvbSArIHBhZGRpbmdPYmplY3QuYm90dG9tLFxuICAgIGxlZnQ6IGNsaXBwaW5nQ2xpZW50UmVjdC5sZWZ0IC0gZWxlbWVudENsaWVudFJlY3QubGVmdCArIHBhZGRpbmdPYmplY3QubGVmdCxcbiAgICByaWdodDogZWxlbWVudENsaWVudFJlY3QucmlnaHQgLSBjbGlwcGluZ0NsaWVudFJlY3QucmlnaHQgKyBwYWRkaW5nT2JqZWN0LnJpZ2h0XG4gIH07XG4gIHZhciBvZmZzZXREYXRhID0gc3RhdGUubW9kaWZpZXJzRGF0YS5vZmZzZXQ7IC8vIE9mZnNldHMgY2FuIGJlIGFwcGxpZWQgb25seSB0byB0aGUgcG9wcGVyIGVsZW1lbnRcblxuICBpZiAoZWxlbWVudENvbnRleHQgPT09IHBvcHBlciAmJiBvZmZzZXREYXRhKSB7XG4gICAgdmFyIG9mZnNldCA9IG9mZnNldERhdGFbcGxhY2VtZW50XTtcbiAgICBPYmplY3Qua2V5cyhvdmVyZmxvd09mZnNldHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgdmFyIG11bHRpcGx5ID0gW3JpZ2h0LCBib3R0b21dLmluZGV4T2Yoa2V5KSA+PSAwID8gMSA6IC0xO1xuICAgICAgdmFyIGF4aXMgPSBbdG9wLCBib3R0b21dLmluZGV4T2Yoa2V5KSA+PSAwID8gJ3knIDogJ3gnO1xuICAgICAgb3ZlcmZsb3dPZmZzZXRzW2tleV0gKz0gb2Zmc2V0W2F4aXNdICogbXVsdGlwbHk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gb3ZlcmZsb3dPZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IHsgdmFyaWF0aW9uUGxhY2VtZW50cywgYmFzZVBsYWNlbWVudHMsIHBsYWNlbWVudHMgYXMgYWxsUGxhY2VtZW50cyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9vcHRpb25zID0gb3B0aW9ucyxcbiAgICAgIHBsYWNlbWVudCA9IF9vcHRpb25zLnBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5ID0gX29wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBfb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nID0gX29wdGlvbnMucGFkZGluZyxcbiAgICAgIGZsaXBWYXJpYXRpb25zID0gX29wdGlvbnMuZmxpcFZhcmlhdGlvbnMsXG4gICAgICBfb3B0aW9ucyRhbGxvd2VkQXV0b1AgPSBfb3B0aW9ucy5hbGxvd2VkQXV0b1BsYWNlbWVudHMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBfb3B0aW9ucyRhbGxvd2VkQXV0b1AgPT09IHZvaWQgMCA/IGFsbFBsYWNlbWVudHMgOiBfb3B0aW9ucyRhbGxvd2VkQXV0b1A7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24ocGxhY2VtZW50KTtcbiAgdmFyIHBsYWNlbWVudHMgPSB2YXJpYXRpb24gPyBmbGlwVmFyaWF0aW9ucyA/IHZhcmlhdGlvblBsYWNlbWVudHMgOiB2YXJpYXRpb25QbGFjZW1lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgcmV0dXJuIGdldFZhcmlhdGlvbihwbGFjZW1lbnQpID09PSB2YXJpYXRpb247XG4gIH0pIDogYmFzZVBsYWNlbWVudHM7XG4gIHZhciBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWxsb3dlZEF1dG9QbGFjZW1lbnRzLmluZGV4T2YocGxhY2VtZW50KSA+PSAwO1xuICB9KTtcblxuICBpZiAoYWxsb3dlZFBsYWNlbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgYWxsb3dlZFBsYWNlbWVudHMgPSBwbGFjZW1lbnRzO1xuICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXR5cGVdOiBGbG93IHNlZW1zIHRvIGhhdmUgcHJvYmxlbXMgd2l0aCB0d28gYXJyYXkgdW5pb25zLi4uXG5cblxuICB2YXIgb3ZlcmZsb3dzID0gYWxsb3dlZFBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICAgIHBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgfSlbZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpXTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvdmVyZmxvd3MpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gb3ZlcmZsb3dzW2FdIC0gb3ZlcmZsb3dzW2JdO1xuICB9KTtcbn0iLCAiaW1wb3J0IGdldE9wcG9zaXRlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBjb21wdXRlQXV0b1BsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZUF1dG9QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IGJvdHRvbSwgdG9wLCBzdGFydCwgcmlnaHQsIGxlZnQsIGF1dG8gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmZ1bmN0aW9uIGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHBsYWNlbWVudCkge1xuICBpZiAoZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpID09PSBhdXRvKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgdmFyIG9wcG9zaXRlUGxhY2VtZW50ID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgcmV0dXJuIFtnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChwbGFjZW1lbnQpLCBvcHBvc2l0ZVBsYWNlbWVudCwgZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQob3Bwb3NpdGVQbGFjZW1lbnQpXTtcbn1cblxuZnVuY3Rpb24gZmxpcChfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkYWx0QXhpcyxcbiAgICAgIHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyA9IG9wdGlvbnMuZmFsbGJhY2tQbGFjZW1lbnRzLFxuICAgICAgcGFkZGluZyA9IG9wdGlvbnMucGFkZGluZyxcbiAgICAgIGJvdW5kYXJ5ID0gb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IG9wdGlvbnMucm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBvcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkZmxpcFZhcmlhdGlvID0gb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIGZsaXBWYXJpYXRpb25zID0gX29wdGlvbnMkZmxpcFZhcmlhdGlvID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkZmxpcFZhcmlhdGlvLFxuICAgICAgYWxsb3dlZEF1dG9QbGFjZW1lbnRzID0gb3B0aW9ucy5hbGxvd2VkQXV0b1BsYWNlbWVudHM7XG4gIHZhciBwcmVmZXJyZWRQbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHByZWZlcnJlZFBsYWNlbWVudCk7XG4gIHZhciBpc0Jhc2VQbGFjZW1lbnQgPSBiYXNlUGxhY2VtZW50ID09PSBwcmVmZXJyZWRQbGFjZW1lbnQ7XG4gIHZhciBmYWxsYmFja1BsYWNlbWVudHMgPSBzcGVjaWZpZWRGYWxsYmFja1BsYWNlbWVudHMgfHwgKGlzQmFzZVBsYWNlbWVudCB8fCAhZmxpcFZhcmlhdGlvbnMgPyBbZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KV0gOiBnZXRFeHBhbmRlZEZhbGxiYWNrUGxhY2VtZW50cyhwcmVmZXJyZWRQbGFjZW1lbnQpKTtcbiAgdmFyIHBsYWNlbWVudHMgPSBbcHJlZmVycmVkUGxhY2VtZW50XS5jb25jYXQoZmFsbGJhY2tQbGFjZW1lbnRzKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgcmV0dXJuIGFjYy5jb25jYXQoZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpID09PSBhdXRvID8gY29tcHV0ZUF1dG9QbGFjZW1lbnQoc3RhdGUsIHtcbiAgICAgIHBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnM6IGZsaXBWYXJpYXRpb25zLFxuICAgICAgYWxsb3dlZEF1dG9QbGFjZW1lbnRzOiBhbGxvd2VkQXV0b1BsYWNlbWVudHNcbiAgICB9KSA6IHBsYWNlbWVudCk7XG4gIH0sIFtdKTtcbiAgdmFyIHJlZmVyZW5jZVJlY3QgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2U7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgY2hlY2tzTWFwID0gbmV3IE1hcCgpO1xuICB2YXIgbWFrZUZhbGxiYWNrQ2hlY2tzID0gdHJ1ZTtcbiAgdmFyIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHNbMF07XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHBsYWNlbWVudCA9IHBsYWNlbWVudHNbaV07XG5cbiAgICB2YXIgX2Jhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCk7XG5cbiAgICB2YXIgaXNTdGFydFZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpID09PSBzdGFydDtcbiAgICB2YXIgaXNWZXJ0aWNhbCA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihfYmFzZVBsYWNlbWVudCkgPj0gMDtcbiAgICB2YXIgbGVuID0gaXNWZXJ0aWNhbCA/ICd3aWR0aCcgOiAnaGVpZ2h0JztcbiAgICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KTtcbiAgICB2YXIgbWFpblZhcmlhdGlvblNpZGUgPSBpc1ZlcnRpY2FsID8gaXNTdGFydFZhcmlhdGlvbiA/IHJpZ2h0IDogbGVmdCA6IGlzU3RhcnRWYXJpYXRpb24gPyBib3R0b20gOiB0b3A7XG5cbiAgICBpZiAocmVmZXJlbmNlUmVjdFtsZW5dID4gcG9wcGVyUmVjdFtsZW5dKSB7XG4gICAgICBtYWluVmFyaWF0aW9uU2lkZSA9IGdldE9wcG9zaXRlUGxhY2VtZW50KG1haW5WYXJpYXRpb25TaWRlKTtcbiAgICB9XG5cbiAgICB2YXIgYWx0VmFyaWF0aW9uU2lkZSA9IGdldE9wcG9zaXRlUGxhY2VtZW50KG1haW5WYXJpYXRpb25TaWRlKTtcbiAgICB2YXIgY2hlY2tzID0gW107XG5cbiAgICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbX2Jhc2VQbGFjZW1lbnRdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICAgIGNoZWNrcy5wdXNoKG92ZXJmbG93W21haW5WYXJpYXRpb25TaWRlXSA8PSAwLCBvdmVyZmxvd1thbHRWYXJpYXRpb25TaWRlXSA8PSAwKTtcbiAgICB9XG5cbiAgICBpZiAoY2hlY2tzLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgcmV0dXJuIGNoZWNrO1xuICAgIH0pKSB7XG4gICAgICBmaXJzdEZpdHRpbmdQbGFjZW1lbnQgPSBwbGFjZW1lbnQ7XG4gICAgICBtYWtlRmFsbGJhY2tDaGVja3MgPSBmYWxzZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNoZWNrc01hcC5zZXQocGxhY2VtZW50LCBjaGVja3MpO1xuICB9XG5cbiAgaWYgKG1ha2VGYWxsYmFja0NoZWNrcykge1xuICAgIC8vIGAyYCBtYXkgYmUgZGVzaXJlZCBpbiBzb21lIGNhc2VzIFx1MjAxMyByZXNlYXJjaCBsYXRlclxuICAgIHZhciBudW1iZXJPZkNoZWNrcyA9IGZsaXBWYXJpYXRpb25zID8gMyA6IDE7XG5cbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChfaSkge1xuICAgICAgdmFyIGZpdHRpbmdQbGFjZW1lbnQgPSBwbGFjZW1lbnRzLmZpbmQoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgICAgICB2YXIgY2hlY2tzID0gY2hlY2tzTWFwLmdldChwbGFjZW1lbnQpO1xuXG4gICAgICAgIGlmIChjaGVja3MpIHtcbiAgICAgICAgICByZXR1cm4gY2hlY2tzLnNsaWNlKDAsIF9pKS5ldmVyeShmdW5jdGlvbiAoY2hlY2spIHtcbiAgICAgICAgICAgIHJldHVybiBjaGVjaztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChmaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IGZpdHRpbmdQbGFjZW1lbnQ7XG4gICAgICAgIHJldHVybiBcImJyZWFrXCI7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvciAodmFyIF9pID0gbnVtYmVyT2ZDaGVja3M7IF9pID4gMDsgX2ktLSkge1xuICAgICAgdmFyIF9yZXQgPSBfbG9vcChfaSk7XG5cbiAgICAgIGlmIChfcmV0ID09PSBcImJyZWFrXCIpIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdGF0ZS5wbGFjZW1lbnQgIT09IGZpcnN0Rml0dGluZ1BsYWNlbWVudCkge1xuICAgIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0uX3NraXAgPSB0cnVlO1xuICAgIHN0YXRlLnBsYWNlbWVudCA9IGZpcnN0Rml0dGluZ1BsYWNlbWVudDtcbiAgICBzdGF0ZS5yZXNldCA9IHRydWU7XG4gIH1cbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2ZsaXAnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogZmxpcCxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydvZmZzZXQnXSxcbiAgZGF0YToge1xuICAgIF9za2lwOiBmYWxzZVxuICB9XG59OyIsICJpbXBvcnQgeyB0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcblxuZnVuY3Rpb24gZ2V0U2lkZU9mZnNldHMob3ZlcmZsb3csIHJlY3QsIHByZXZlbnRlZE9mZnNldHMpIHtcbiAgaWYgKHByZXZlbnRlZE9mZnNldHMgPT09IHZvaWQgMCkge1xuICAgIHByZXZlbnRlZE9mZnNldHMgPSB7XG4gICAgICB4OiAwLFxuICAgICAgeTogMFxuICAgIH07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHRvcDogb3ZlcmZsb3cudG9wIC0gcmVjdC5oZWlnaHQgLSBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgcmlnaHQ6IG92ZXJmbG93LnJpZ2h0IC0gcmVjdC53aWR0aCArIHByZXZlbnRlZE9mZnNldHMueCxcbiAgICBib3R0b206IG92ZXJmbG93LmJvdHRvbSAtIHJlY3QuaGVpZ2h0ICsgcHJldmVudGVkT2Zmc2V0cy55LFxuICAgIGxlZnQ6IG92ZXJmbG93LmxlZnQgLSByZWN0LndpZHRoIC0gcHJldmVudGVkT2Zmc2V0cy54XG4gIH07XG59XG5cbmZ1bmN0aW9uIGlzQW55U2lkZUZ1bGx5Q2xpcHBlZChvdmVyZmxvdykge1xuICByZXR1cm4gW3RvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdF0uc29tZShmdW5jdGlvbiAoc2lkZSkge1xuICAgIHJldHVybiBvdmVyZmxvd1tzaWRlXSA+PSAwO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGlkZShfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBwcmV2ZW50ZWRPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wcmV2ZW50T3ZlcmZsb3c7XG4gIHZhciByZWZlcmVuY2VPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgZWxlbWVudENvbnRleHQ6ICdyZWZlcmVuY2UnXG4gIH0pO1xuICB2YXIgcG9wcGVyQWx0T3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGFsdEJvdW5kYXJ5OiB0cnVlXG4gIH0pO1xuICB2YXIgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocmVmZXJlbmNlT3ZlcmZsb3csIHJlZmVyZW5jZVJlY3QpO1xuICB2YXIgcG9wcGVyRXNjYXBlT2Zmc2V0cyA9IGdldFNpZGVPZmZzZXRzKHBvcHBlckFsdE92ZXJmbG93LCBwb3BwZXJSZWN0LCBwcmV2ZW50ZWRPZmZzZXRzKTtcbiAgdmFyIGlzUmVmZXJlbmNlSGlkZGVuID0gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0cyk7XG4gIHZhciBoYXNQb3BwZXJFc2NhcGVkID0gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKHBvcHBlckVzY2FwZU9mZnNldHMpO1xuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0ge1xuICAgIHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0czogcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzLFxuICAgIHBvcHBlckVzY2FwZU9mZnNldHM6IHBvcHBlckVzY2FwZU9mZnNldHMsXG4gICAgaXNSZWZlcmVuY2VIaWRkZW46IGlzUmVmZXJlbmNlSGlkZGVuLFxuICAgIGhhc1BvcHBlckVzY2FwZWQ6IGhhc1BvcHBlckVzY2FwZWRcbiAgfTtcbiAgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciwge1xuICAgICdkYXRhLXBvcHBlci1yZWZlcmVuY2UtaGlkZGVuJzogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgJ2RhdGEtcG9wcGVyLWVzY2FwZWQnOiBoYXNQb3BwZXJFc2NhcGVkXG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnaGlkZScsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsncHJldmVudE92ZXJmbG93J10sXG4gIGZuOiBoaWRlXG59OyIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgcGxhY2VtZW50cyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBmdW5jdGlvbiBkaXN0YW5jZUFuZFNraWRkaW5nVG9YWShwbGFjZW1lbnQsIHJlY3RzLCBvZmZzZXQpIHtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCk7XG4gIHZhciBpbnZlcnREaXN0YW5jZSA9IFtsZWZ0LCB0b3BdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IC0xIDogMTtcblxuICB2YXIgX3JlZiA9IHR5cGVvZiBvZmZzZXQgPT09ICdmdW5jdGlvbicgPyBvZmZzZXQoT2JqZWN0LmFzc2lnbih7fSwgcmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudFxuICB9KSkgOiBvZmZzZXQsXG4gICAgICBza2lkZGluZyA9IF9yZWZbMF0sXG4gICAgICBkaXN0YW5jZSA9IF9yZWZbMV07XG5cbiAgc2tpZGRpbmcgPSBza2lkZGluZyB8fCAwO1xuICBkaXN0YW5jZSA9IChkaXN0YW5jZSB8fCAwKSAqIGludmVydERpc3RhbmNlO1xuICByZXR1cm4gW2xlZnQsIHJpZ2h0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpID49IDAgPyB7XG4gICAgeDogZGlzdGFuY2UsXG4gICAgeTogc2tpZGRpbmdcbiAgfSA6IHtcbiAgICB4OiBza2lkZGluZyxcbiAgICB5OiBkaXN0YW5jZVxuICB9O1xufVxuXG5mdW5jdGlvbiBvZmZzZXQoX3JlZjIpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjIuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjIub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmMi5uYW1lO1xuICB2YXIgX29wdGlvbnMkb2Zmc2V0ID0gb3B0aW9ucy5vZmZzZXQsXG4gICAgICBvZmZzZXQgPSBfb3B0aW9ucyRvZmZzZXQgPT09IHZvaWQgMCA/IFswLCAwXSA6IF9vcHRpb25zJG9mZnNldDtcbiAgdmFyIGRhdGEgPSBwbGFjZW1lbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICBhY2NbcGxhY2VtZW50XSA9IGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgc3RhdGUucmVjdHMsIG9mZnNldCk7XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICB2YXIgX2RhdGEkc3RhdGUkcGxhY2VtZW50ID0gZGF0YVtzdGF0ZS5wbGFjZW1lbnRdLFxuICAgICAgeCA9IF9kYXRhJHN0YXRlJHBsYWNlbWVudC54LFxuICAgICAgeSA9IF9kYXRhJHN0YXRlJHBsYWNlbWVudC55O1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMgIT0gbnVsbCkge1xuICAgIHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cy54ICs9IHg7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnkgKz0geTtcbiAgfVxuXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBkYXRhO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnb2Zmc2V0JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXM6IFsncG9wcGVyT2Zmc2V0cyddLFxuICBmbjogb2Zmc2V0XG59OyIsICJpbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4uL3V0aWxzL2NvbXB1dGVPZmZzZXRzLmpzXCI7XG5cbmZ1bmN0aW9uIHBvcHBlck9mZnNldHMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcbiAgLy8gT2Zmc2V0cyBhcmUgdGhlIGFjdHVhbCBwb3NpdGlvbiB0aGUgcG9wcGVyIG5lZWRzIHRvIGhhdmUgdG8gYmVcbiAgLy8gcHJvcGVybHkgcG9zaXRpb25lZCBuZWFyIGl0cyByZWZlcmVuY2UgZWxlbWVudFxuICAvLyBUaGlzIGlzIHRoZSBtb3N0IGJhc2ljIHBsYWNlbWVudCwgYW5kIHdpbGwgYmUgYWRqdXN0ZWQgYnlcbiAgLy8gdGhlIG1vZGlmaWVycyBpbiB0aGUgbmV4dCBzdGVwXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBjb21wdXRlT2Zmc2V0cyh7XG4gICAgcmVmZXJlbmNlOiBzdGF0ZS5yZWN0cy5yZWZlcmVuY2UsXG4gICAgZWxlbWVudDogc3RhdGUucmVjdHMucG9wcGVyLFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAncG9wcGVyT2Zmc2V0cycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAncmVhZCcsXG4gIGZuOiBwb3BwZXJPZmZzZXRzLFxuICBkYXRhOiB7fVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0QWx0QXhpcyhheGlzKSB7XG4gIHJldHVybiBheGlzID09PSAneCcgPyAneScgOiAneCc7XG59IiwgImltcG9ydCB7IHRvcCwgbGVmdCwgcmlnaHQsIGJvdHRvbSwgc3RhcnQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRBbHRBeGlzIGZyb20gXCIuLi91dGlscy9nZXRBbHRBeGlzLmpzXCI7XG5pbXBvcnQgeyB3aXRoaW4sIHdpdGhpbk1heENsYW1wIH0gZnJvbSBcIi4uL3V0aWxzL3dpdGhpbi5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4uL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuLi91dGlscy9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCBnZXRGcmVzaFNpZGVPYmplY3QgZnJvbSBcIi4uL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qc1wiO1xuaW1wb3J0IHsgbWluIGFzIG1hdGhNaW4sIG1heCBhcyBtYXRoTWF4IH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcblxuZnVuY3Rpb24gcHJldmVudE92ZXJmbG93KF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICB2YXIgX29wdGlvbnMkbWFpbkF4aXMgPSBvcHRpb25zLm1haW5BeGlzLFxuICAgICAgY2hlY2tNYWluQXhpcyA9IF9vcHRpb25zJG1haW5BeGlzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkbWFpbkF4aXMsXG4gICAgICBfb3B0aW9ucyRhbHRBeGlzID0gb3B0aW9ucy5hbHRBeGlzLFxuICAgICAgY2hlY2tBbHRBeGlzID0gX29wdGlvbnMkYWx0QXhpcyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgX29wdGlvbnMkdGV0aGVyID0gb3B0aW9ucy50ZXRoZXIsXG4gICAgICB0ZXRoZXIgPSBfb3B0aW9ucyR0ZXRoZXIgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyR0ZXRoZXIsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXJPZmZzZXQgPSBvcHRpb25zLnRldGhlck9mZnNldCxcbiAgICAgIHRldGhlck9mZnNldCA9IF9vcHRpb25zJHRldGhlck9mZnNldCA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJHRldGhlck9mZnNldDtcbiAgdmFyIG92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgcGFkZGluZzogcGFkZGluZyxcbiAgICBhbHRCb3VuZGFyeTogYWx0Qm91bmRhcnlcbiAgfSk7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpO1xuICB2YXIgdmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciBpc0Jhc2VQbGFjZW1lbnQgPSAhdmFyaWF0aW9uO1xuICB2YXIgbWFpbkF4aXMgPSBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCk7XG4gIHZhciBhbHRBeGlzID0gZ2V0QWx0QXhpcyhtYWluQXhpcyk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciB0ZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXQgPT09ICdmdW5jdGlvbicgPyB0ZXRoZXJPZmZzZXQoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHN0YXRlLnBsYWNlbWVudFxuICB9KSkgOiB0ZXRoZXJPZmZzZXQ7XG4gIHZhciBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUgPSB0eXBlb2YgdGV0aGVyT2Zmc2V0VmFsdWUgPT09ICdudW1iZXInID8ge1xuICAgIG1haW5BeGlzOiB0ZXRoZXJPZmZzZXRWYWx1ZSxcbiAgICBhbHRBeGlzOiB0ZXRoZXJPZmZzZXRWYWx1ZVxuICB9IDogT2JqZWN0LmFzc2lnbih7XG4gICAgbWFpbkF4aXM6IDAsXG4gICAgYWx0QXhpczogMFxuICB9LCB0ZXRoZXJPZmZzZXRWYWx1ZSk7XG4gIHZhciBvZmZzZXRNb2RpZmllclN0YXRlID0gc3RhdGUubW9kaWZpZXJzRGF0YS5vZmZzZXQgPyBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldFtzdGF0ZS5wbGFjZW1lbnRdIDogbnVsbDtcbiAgdmFyIGRhdGEgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKCFwb3BwZXJPZmZzZXRzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNoZWNrTWFpbkF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkO1xuXG4gICAgdmFyIG1haW5TaWRlID0gbWFpbkF4aXMgPT09ICd5JyA/IHRvcCA6IGxlZnQ7XG4gICAgdmFyIGFsdFNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gYm90dG9tIDogcmlnaHQ7XG4gICAgdmFyIGxlbiA9IG1haW5BeGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG4gICAgdmFyIG9mZnNldCA9IHBvcHBlck9mZnNldHNbbWFpbkF4aXNdO1xuICAgIHZhciBtaW4gPSBvZmZzZXQgKyBvdmVyZmxvd1ttYWluU2lkZV07XG4gICAgdmFyIG1heCA9IG9mZnNldCAtIG92ZXJmbG93W2FsdFNpZGVdO1xuICAgIHZhciBhZGRpdGl2ZSA9IHRldGhlciA/IC1wb3BwZXJSZWN0W2xlbl0gLyAyIDogMDtcbiAgICB2YXIgbWluTGVuID0gdmFyaWF0aW9uID09PSBzdGFydCA/IHJlZmVyZW5jZVJlY3RbbGVuXSA6IHBvcHBlclJlY3RbbGVuXTtcbiAgICB2YXIgbWF4TGVuID0gdmFyaWF0aW9uID09PSBzdGFydCA/IC1wb3BwZXJSZWN0W2xlbl0gOiAtcmVmZXJlbmNlUmVjdFtsZW5dOyAvLyBXZSBuZWVkIHRvIGluY2x1ZGUgdGhlIGFycm93IGluIHRoZSBjYWxjdWxhdGlvbiBzbyB0aGUgYXJyb3cgZG9lc24ndCBnb1xuICAgIC8vIG91dHNpZGUgdGhlIHJlZmVyZW5jZSBib3VuZHNcblxuICAgIHZhciBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5hcnJvdztcbiAgICB2YXIgYXJyb3dSZWN0ID0gdGV0aGVyICYmIGFycm93RWxlbWVudCA/IGdldExheW91dFJlY3QoYXJyb3dFbGVtZW50KSA6IHtcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwXG4gICAgfTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nT2JqZWN0ID0gc3RhdGUubW9kaWZpZXJzRGF0YVsnYXJyb3cjcGVyc2lzdGVudCddID8gc3RhdGUubW9kaWZpZXJzRGF0YVsnYXJyb3cjcGVyc2lzdGVudCddLnBhZGRpbmcgOiBnZXRGcmVzaFNpZGVPYmplY3QoKTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nTWluID0gYXJyb3dQYWRkaW5nT2JqZWN0W21haW5TaWRlXTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nTWF4ID0gYXJyb3dQYWRkaW5nT2JqZWN0W2FsdFNpZGVdOyAvLyBJZiB0aGUgcmVmZXJlbmNlIGxlbmd0aCBpcyBzbWFsbGVyIHRoYW4gdGhlIGFycm93IGxlbmd0aCwgd2UgZG9uJ3Qgd2FudFxuICAgIC8vIHRvIGluY2x1ZGUgaXRzIGZ1bGwgc2l6ZSBpbiB0aGUgY2FsY3VsYXRpb24uIElmIHRoZSByZWZlcmVuY2UgaXMgc21hbGxcbiAgICAvLyBhbmQgbmVhciB0aGUgZWRnZSBvZiBhIGJvdW5kYXJ5LCB0aGUgcG9wcGVyIGNhbiBvdmVyZmxvdyBldmVuIGlmIHRoZVxuICAgIC8vIHJlZmVyZW5jZSBpcyBub3Qgb3ZlcmZsb3dpbmcgYXMgd2VsbCAoZS5nLiB2aXJ0dWFsIGVsZW1lbnRzIHdpdGggbm9cbiAgICAvLyB3aWR0aCBvciBoZWlnaHQpXG5cbiAgICB2YXIgYXJyb3dMZW4gPSB3aXRoaW4oMCwgcmVmZXJlbmNlUmVjdFtsZW5dLCBhcnJvd1JlY3RbbGVuXSk7XG4gICAgdmFyIG1pbk9mZnNldCA9IGlzQmFzZVBsYWNlbWVudCA/IHJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgLSBhZGRpdGl2ZSAtIGFycm93TGVuIC0gYXJyb3dQYWRkaW5nTWluIC0gbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWluTGVuIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIG1heE9mZnNldCA9IGlzQmFzZVBsYWNlbWVudCA/IC1yZWZlcmVuY2VSZWN0W2xlbl0gLyAyICsgYWRkaXRpdmUgKyBhcnJvd0xlbiArIGFycm93UGFkZGluZ01heCArIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcyA6IG1heExlbiArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzO1xuICAgIHZhciBhcnJvd09mZnNldFBhcmVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93ICYmIGdldE9mZnNldFBhcmVudChzdGF0ZS5lbGVtZW50cy5hcnJvdyk7XG4gICAgdmFyIGNsaWVudE9mZnNldCA9IGFycm93T2Zmc2V0UGFyZW50ID8gbWFpbkF4aXMgPT09ICd5JyA/IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudFRvcCB8fCAwIDogYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50TGVmdCB8fCAwIDogMDtcbiAgICB2YXIgb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQgPSBvZmZzZXRNb2RpZmllclN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBvZmZzZXRNb2RpZmllclN0YXRlW21haW5BeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJCA6IDA7XG4gICAgdmFyIHRldGhlck1pbiA9IG9mZnNldCArIG1pbk9mZnNldCAtIG9mZnNldE1vZGlmaWVyVmFsdWUgLSBjbGllbnRPZmZzZXQ7XG4gICAgdmFyIHRldGhlck1heCA9IG9mZnNldCArIG1heE9mZnNldCAtIG9mZnNldE1vZGlmaWVyVmFsdWU7XG4gICAgdmFyIHByZXZlbnRlZE9mZnNldCA9IHdpdGhpbih0ZXRoZXIgPyBtYXRoTWluKG1pbiwgdGV0aGVyTWluKSA6IG1pbiwgb2Zmc2V0LCB0ZXRoZXIgPyBtYXRoTWF4KG1heCwgdGV0aGVyTWF4KSA6IG1heCk7XG4gICAgcG9wcGVyT2Zmc2V0c1ttYWluQXhpc10gPSBwcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVttYWluQXhpc10gPSBwcmV2ZW50ZWRPZmZzZXQgLSBvZmZzZXQ7XG4gIH1cblxuICBpZiAoY2hlY2tBbHRBeGlzKSB7XG4gICAgdmFyIF9vZmZzZXRNb2RpZmllclN0YXRlJDI7XG5cbiAgICB2YXIgX21haW5TaWRlID0gbWFpbkF4aXMgPT09ICd4JyA/IHRvcCA6IGxlZnQ7XG5cbiAgICB2YXIgX2FsdFNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gYm90dG9tIDogcmlnaHQ7XG5cbiAgICB2YXIgX29mZnNldCA9IHBvcHBlck9mZnNldHNbYWx0QXhpc107XG5cbiAgICB2YXIgX2xlbiA9IGFsdEF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHZhciBfbWluID0gX29mZnNldCArIG92ZXJmbG93W19tYWluU2lkZV07XG5cbiAgICB2YXIgX21heCA9IF9vZmZzZXQgLSBvdmVyZmxvd1tfYWx0U2lkZV07XG5cbiAgICB2YXIgaXNPcmlnaW5TaWRlID0gW3RvcCwgbGVmdF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSAhPT0gLTE7XG5cbiAgICB2YXIgX29mZnNldE1vZGlmaWVyVmFsdWUgPSAoX29mZnNldE1vZGlmaWVyU3RhdGUkMiA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbYWx0QXhpc10pICE9IG51bGwgPyBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyIDogMDtcblxuICAgIHZhciBfdGV0aGVyTWluID0gaXNPcmlnaW5TaWRlID8gX21pbiA6IF9vZmZzZXQgLSByZWZlcmVuY2VSZWN0W19sZW5dIC0gcG9wcGVyUmVjdFtfbGVuXSAtIF9vZmZzZXRNb2RpZmllclZhbHVlICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLmFsdEF4aXM7XG5cbiAgICB2YXIgX3RldGhlck1heCA9IGlzT3JpZ2luU2lkZSA/IF9vZmZzZXQgKyByZWZlcmVuY2VSZWN0W19sZW5dICsgcG9wcGVyUmVjdFtfbGVuXSAtIF9vZmZzZXRNb2RpZmllclZhbHVlIC0gbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLmFsdEF4aXMgOiBfbWF4O1xuXG4gICAgdmFyIF9wcmV2ZW50ZWRPZmZzZXQgPSB0ZXRoZXIgJiYgaXNPcmlnaW5TaWRlID8gd2l0aGluTWF4Q2xhbXAoX3RldGhlck1pbiwgX29mZnNldCwgX3RldGhlck1heCkgOiB3aXRoaW4odGV0aGVyID8gX3RldGhlck1pbiA6IF9taW4sIF9vZmZzZXQsIHRldGhlciA/IF90ZXRoZXJNYXggOiBfbWF4KTtcblxuICAgIHBvcHBlck9mZnNldHNbYWx0QXhpc10gPSBfcHJldmVudGVkT2Zmc2V0O1xuICAgIGRhdGFbYWx0QXhpc10gPSBfcHJldmVudGVkT2Zmc2V0IC0gX29mZnNldDtcbiAgfVxuXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBkYXRhO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAncHJldmVudE92ZXJmbG93JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgZm46IHByZXZlbnRPdmVyZmxvdyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydvZmZzZXQnXVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0SFRNTEVsZW1lbnRTY3JvbGwoZWxlbWVudCkge1xuICByZXR1cm4ge1xuICAgIHNjcm9sbExlZnQ6IGVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICBzY3JvbGxUb3A6IGVsZW1lbnQuc2Nyb2xsVG9wXG4gIH07XG59IiwgImltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBnZXRIVE1MRWxlbWVudFNjcm9sbCBmcm9tIFwiLi9nZXRIVE1MRWxlbWVudFNjcm9sbC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Tm9kZVNjcm9sbChub2RlKSB7XG4gIGlmIChub2RlID09PSBnZXRXaW5kb3cobm9kZSkgfHwgIWlzSFRNTEVsZW1lbnQobm9kZSkpIHtcbiAgICByZXR1cm4gZ2V0V2luZG93U2Nyb2xsKG5vZGUpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBnZXRIVE1MRWxlbWVudFNjcm9sbChub2RlKTtcbiAgfVxufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldE5vZGVTY3JvbGwgZnJvbSBcIi4vZ2V0Tm9kZVNjcm9sbC5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnRTY2FsZWQoZWxlbWVudCkge1xuICB2YXIgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHZhciBzY2FsZVggPSByb3VuZChyZWN0LndpZHRoKSAvIGVsZW1lbnQub2Zmc2V0V2lkdGggfHwgMTtcbiAgdmFyIHNjYWxlWSA9IHJvdW5kKHJlY3QuaGVpZ2h0KSAvIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IHx8IDE7XG4gIHJldHVybiBzY2FsZVggIT09IDEgfHwgc2NhbGVZICE9PSAxO1xufSAvLyBSZXR1cm5zIHRoZSBjb21wb3NpdGUgcmVjdCBvZiBhbiBlbGVtZW50IHJlbGF0aXZlIHRvIGl0cyBvZmZzZXRQYXJlbnQuXG4vLyBDb21wb3NpdGUgbWVhbnMgaXQgdGFrZXMgaW50byBhY2NvdW50IHRyYW5zZm9ybXMgYXMgd2VsbCBhcyBsYXlvdXQuXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q29tcG9zaXRlUmVjdChlbGVtZW50T3JWaXJ0dWFsRWxlbWVudCwgb2Zmc2V0UGFyZW50LCBpc0ZpeGVkKSB7XG4gIGlmIChpc0ZpeGVkID09PSB2b2lkIDApIHtcbiAgICBpc0ZpeGVkID0gZmFsc2U7XG4gIH1cblxuICB2YXIgaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgPSBpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciBvZmZzZXRQYXJlbnRJc1NjYWxlZCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KSAmJiBpc0VsZW1lbnRTY2FsZWQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIGRvY3VtZW50RWxlbWVudCA9IGdldERvY3VtZW50RWxlbWVudChvZmZzZXRQYXJlbnQpO1xuICB2YXIgcmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50T3JWaXJ0dWFsRWxlbWVudCwgb2Zmc2V0UGFyZW50SXNTY2FsZWQsIGlzRml4ZWQpO1xuICB2YXIgc2Nyb2xsID0ge1xuICAgIHNjcm9sbExlZnQ6IDAsXG4gICAgc2Nyb2xsVG9wOiAwXG4gIH07XG4gIHZhciBvZmZzZXRzID0ge1xuICAgIHg6IDAsXG4gICAgeTogMFxuICB9O1xuXG4gIGlmIChpc09mZnNldFBhcmVudEFuRWxlbWVudCB8fCAhaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgJiYgIWlzRml4ZWQpIHtcbiAgICBpZiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSAhPT0gJ2JvZHknIHx8IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvMTA3OFxuICAgIGlzU2Nyb2xsUGFyZW50KGRvY3VtZW50RWxlbWVudCkpIHtcbiAgICAgIHNjcm9sbCA9IGdldE5vZGVTY3JvbGwob2Zmc2V0UGFyZW50KTtcbiAgICB9XG5cbiAgICBpZiAoaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpKSB7XG4gICAgICBvZmZzZXRzID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KG9mZnNldFBhcmVudCwgdHJ1ZSk7XG4gICAgICBvZmZzZXRzLnggKz0gb2Zmc2V0UGFyZW50LmNsaWVudExlZnQ7XG4gICAgICBvZmZzZXRzLnkgKz0gb2Zmc2V0UGFyZW50LmNsaWVudFRvcDtcbiAgICB9IGVsc2UgaWYgKGRvY3VtZW50RWxlbWVudCkge1xuICAgICAgb2Zmc2V0cy54ID0gZ2V0V2luZG93U2Nyb2xsQmFyWChkb2N1bWVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogcmVjdC5sZWZ0ICsgc2Nyb2xsLnNjcm9sbExlZnQgLSBvZmZzZXRzLngsXG4gICAgeTogcmVjdC50b3AgKyBzY3JvbGwuc2Nyb2xsVG9wIC0gb2Zmc2V0cy55LFxuICAgIHdpZHRoOiByZWN0LndpZHRoLFxuICAgIGhlaWdodDogcmVjdC5oZWlnaHRcbiAgfTtcbn0iLCAiaW1wb3J0IHsgbW9kaWZpZXJQaGFzZXMgfSBmcm9tIFwiLi4vZW51bXMuanNcIjsgLy8gc291cmNlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80OTg3NTI1NVxuXG5mdW5jdGlvbiBvcmRlcihtb2RpZmllcnMpIHtcbiAgdmFyIG1hcCA9IG5ldyBNYXAoKTtcbiAgdmFyIHZpc2l0ZWQgPSBuZXcgU2V0KCk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgbW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgbWFwLnNldChtb2RpZmllci5uYW1lLCBtb2RpZmllcik7XG4gIH0pOyAvLyBPbiB2aXNpdGluZyBvYmplY3QsIGNoZWNrIGZvciBpdHMgZGVwZW5kZW5jaWVzIGFuZCB2aXNpdCB0aGVtIHJlY3Vyc2l2ZWx5XG5cbiAgZnVuY3Rpb24gc29ydChtb2RpZmllcikge1xuICAgIHZpc2l0ZWQuYWRkKG1vZGlmaWVyLm5hbWUpO1xuICAgIHZhciByZXF1aXJlcyA9IFtdLmNvbmNhdChtb2RpZmllci5yZXF1aXJlcyB8fCBbXSwgbW9kaWZpZXIucmVxdWlyZXNJZkV4aXN0cyB8fCBbXSk7XG4gICAgcmVxdWlyZXMuZm9yRWFjaChmdW5jdGlvbiAoZGVwKSB7XG4gICAgICBpZiAoIXZpc2l0ZWQuaGFzKGRlcCkpIHtcbiAgICAgICAgdmFyIGRlcE1vZGlmaWVyID0gbWFwLmdldChkZXApO1xuXG4gICAgICAgIGlmIChkZXBNb2RpZmllcikge1xuICAgICAgICAgIHNvcnQoZGVwTW9kaWZpZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmVzdWx0LnB1c2gobW9kaWZpZXIpO1xuICB9XG5cbiAgbW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgaWYgKCF2aXNpdGVkLmhhcyhtb2RpZmllci5uYW1lKSkge1xuICAgICAgLy8gY2hlY2sgZm9yIHZpc2l0ZWQgb2JqZWN0XG4gICAgICBzb3J0KG1vZGlmaWVyKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvcmRlck1vZGlmaWVycyhtb2RpZmllcnMpIHtcbiAgLy8gb3JkZXIgYmFzZWQgb24gZGVwZW5kZW5jaWVzXG4gIHZhciBvcmRlcmVkTW9kaWZpZXJzID0gb3JkZXIobW9kaWZpZXJzKTsgLy8gb3JkZXIgYmFzZWQgb24gcGhhc2VcblxuICByZXR1cm4gbW9kaWZpZXJQaGFzZXMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBoYXNlKSB7XG4gICAgcmV0dXJuIGFjYy5jb25jYXQob3JkZXJlZE1vZGlmaWVycy5maWx0ZXIoZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgICByZXR1cm4gbW9kaWZpZXIucGhhc2UgPT09IHBoYXNlO1xuICAgIH0pKTtcbiAgfSwgW10pO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZWJvdW5jZShmbikge1xuICB2YXIgcGVuZGluZztcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXBlbmRpbmcpIHtcbiAgICAgIHBlbmRpbmcgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBwZW5kaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHJlc29sdmUoZm4oKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBlbmRpbmc7XG4gIH07XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1lcmdlQnlOYW1lKG1vZGlmaWVycykge1xuICB2YXIgbWVyZ2VkID0gbW9kaWZpZXJzLnJlZHVjZShmdW5jdGlvbiAobWVyZ2VkLCBjdXJyZW50KSB7XG4gICAgdmFyIGV4aXN0aW5nID0gbWVyZ2VkW2N1cnJlbnQubmFtZV07XG4gICAgbWVyZ2VkW2N1cnJlbnQubmFtZV0gPSBleGlzdGluZyA/IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLCBjdXJyZW50LCB7XG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5vcHRpb25zLCBjdXJyZW50Lm9wdGlvbnMpLFxuICAgICAgZGF0YTogT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcuZGF0YSwgY3VycmVudC5kYXRhKVxuICAgIH0pIDogY3VycmVudDtcbiAgICByZXR1cm4gbWVyZ2VkO1xuICB9LCB7fSk7IC8vIElFMTEgZG9lcyBub3Qgc3VwcG9ydCBPYmplY3QudmFsdWVzXG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKG1lcmdlZCkubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gbWVyZ2VkW2tleV07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0Q29tcG9zaXRlUmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBsaXN0U2Nyb2xsUGFyZW50cyBmcm9tIFwiLi9kb20tdXRpbHMvbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IG9yZGVyTW9kaWZpZXJzIGZyb20gXCIuL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzXCI7XG5pbXBvcnQgZGVib3VuY2UgZnJvbSBcIi4vdXRpbHMvZGVib3VuY2UuanNcIjtcbmltcG9ydCBtZXJnZUJ5TmFtZSBmcm9tIFwiLi91dGlscy9tZXJnZUJ5TmFtZS5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiO1xudmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgcGxhY2VtZW50OiAnYm90dG9tJyxcbiAgbW9kaWZpZXJzOiBbXSxcbiAgc3RyYXRlZ3k6ICdhYnNvbHV0ZSdcbn07XG5cbmZ1bmN0aW9uIGFyZVZhbGlkRWxlbWVudHMoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gIWFyZ3Muc29tZShmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHJldHVybiAhKGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ID09PSAnZnVuY3Rpb24nKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3BwZXJHZW5lcmF0b3IoZ2VuZXJhdG9yT3B0aW9ucykge1xuICBpZiAoZ2VuZXJhdG9yT3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgZ2VuZXJhdG9yT3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9nZW5lcmF0b3JPcHRpb25zID0gZ2VuZXJhdG9yT3B0aW9ucyxcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRNb2RpZmllcnMsXG4gICAgICBkZWZhdWx0TW9kaWZpZXJzID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmID09PSB2b2lkIDAgPyBbXSA6IF9nZW5lcmF0b3JPcHRpb25zJGRlZixcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZjIgPSBfZ2VuZXJhdG9yT3B0aW9ucy5kZWZhdWx0T3B0aW9ucyxcbiAgICAgIGRlZmF1bHRPcHRpb25zID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9PT0gdm9pZCAwID8gREVGQVVMVF9PUFRJT05TIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmMjtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVBvcHBlcihyZWZlcmVuY2UsIHBvcHBlciwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICB9XG5cbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICAgICAgb3JkZXJlZE1vZGlmaWVyczogW10sXG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMsIGRlZmF1bHRPcHRpb25zKSxcbiAgICAgIG1vZGlmaWVyc0RhdGE6IHt9LFxuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgcmVmZXJlbmNlOiByZWZlcmVuY2UsXG4gICAgICAgIHBvcHBlcjogcG9wcGVyXG4gICAgICB9LFxuICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICBzdHlsZXM6IHt9XG4gICAgfTtcbiAgICB2YXIgZWZmZWN0Q2xlYW51cEZucyA9IFtdO1xuICAgIHZhciBpc0Rlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHZhciBpbnN0YW5jZSA9IHtcbiAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIHNldE9wdGlvbnMoc2V0T3B0aW9uc0FjdGlvbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBzZXRPcHRpb25zQWN0aW9uID09PSAnZnVuY3Rpb24nID8gc2V0T3B0aW9uc0FjdGlvbihzdGF0ZS5vcHRpb25zKSA6IHNldE9wdGlvbnNBY3Rpb247XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgc3RhdGUub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBzdGF0ZS5vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgc3RhdGUuc2Nyb2xsUGFyZW50cyA9IHtcbiAgICAgICAgICByZWZlcmVuY2U6IGlzRWxlbWVudChyZWZlcmVuY2UpID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlKSA6IHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCA/IGxpc3RTY3JvbGxQYXJlbnRzKHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCkgOiBbXSxcbiAgICAgICAgICBwb3BwZXI6IGxpc3RTY3JvbGxQYXJlbnRzKHBvcHBlcilcbiAgICAgICAgfTsgLy8gT3JkZXJzIHRoZSBtb2RpZmllcnMgYmFzZWQgb24gdGhlaXIgZGVwZW5kZW5jaWVzIGFuZCBgcGhhc2VgXG4gICAgICAgIC8vIHByb3BlcnRpZXNcblxuICAgICAgICB2YXIgb3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyTW9kaWZpZXJzKG1lcmdlQnlOYW1lKFtdLmNvbmNhdChkZWZhdWx0TW9kaWZpZXJzLCBzdGF0ZS5vcHRpb25zLm1vZGlmaWVycykpKTsgLy8gU3RyaXAgb3V0IGRpc2FibGVkIG1vZGlmaWVyc1xuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobSkge1xuICAgICAgICAgIHJldHVybiBtLmVuYWJsZWQ7XG4gICAgICAgIH0pO1xuICAgICAgICBydW5Nb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlLnVwZGF0ZSgpO1xuICAgICAgfSxcbiAgICAgIC8vIFN5bmMgdXBkYXRlIFx1MjAxMyBpdCB3aWxsIGFsd2F5cyBiZSBleGVjdXRlZCwgZXZlbiBpZiBub3QgbmVjZXNzYXJ5LiBUaGlzXG4gICAgICAvLyBpcyB1c2VmdWwgZm9yIGxvdyBmcmVxdWVuY3kgdXBkYXRlcyB3aGVyZSBzeW5jIGJlaGF2aW9yIHNpbXBsaWZpZXMgdGhlXG4gICAgICAvLyBsb2dpYy5cbiAgICAgIC8vIEZvciBoaWdoIGZyZXF1ZW5jeSB1cGRhdGVzIChlLmcuIGByZXNpemVgIGFuZCBgc2Nyb2xsYCBldmVudHMpLCBhbHdheXNcbiAgICAgIC8vIHByZWZlciB0aGUgYXN5bmMgUG9wcGVyI3VwZGF0ZSBtZXRob2RcbiAgICAgIGZvcmNlVXBkYXRlOiBmdW5jdGlvbiBmb3JjZVVwZGF0ZSgpIHtcbiAgICAgICAgaWYgKGlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIF9zdGF0ZSRlbGVtZW50cyA9IHN0YXRlLmVsZW1lbnRzLFxuICAgICAgICAgICAgcmVmZXJlbmNlID0gX3N0YXRlJGVsZW1lbnRzLnJlZmVyZW5jZSxcbiAgICAgICAgICAgIHBvcHBlciA9IF9zdGF0ZSRlbGVtZW50cy5wb3BwZXI7IC8vIERvbid0IHByb2NlZWQgaWYgYHJlZmVyZW5jZWAgb3IgYHBvcHBlcmAgYXJlIG5vdCB2YWxpZCBlbGVtZW50c1xuICAgICAgICAvLyBhbnltb3JlXG5cbiAgICAgICAgaWYgKCFhcmVWYWxpZEVsZW1lbnRzKHJlZmVyZW5jZSwgcG9wcGVyKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBTdG9yZSB0aGUgcmVmZXJlbmNlIGFuZCBwb3BwZXIgcmVjdHMgdG8gYmUgcmVhZCBieSBtb2RpZmllcnNcblxuXG4gICAgICAgIHN0YXRlLnJlY3RzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogZ2V0Q29tcG9zaXRlUmVjdChyZWZlcmVuY2UsIGdldE9mZnNldFBhcmVudChwb3BwZXIpLCBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnKSxcbiAgICAgICAgICBwb3BwZXI6IGdldExheW91dFJlY3QocG9wcGVyKVxuICAgICAgICB9OyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byByZXNldCB0aGUgY3VycmVudCB1cGRhdGUgY3ljbGUuIFRoZVxuICAgICAgICAvLyBtb3N0IGNvbW1vbiB1c2UgY2FzZSBmb3IgdGhpcyBpcyB0aGUgYGZsaXBgIG1vZGlmaWVyIGNoYW5naW5nIHRoZVxuICAgICAgICAvLyBwbGFjZW1lbnQsIHdoaWNoIHRoZW4gbmVlZHMgdG8gcmUtcnVuIGFsbCB0aGUgbW9kaWZpZXJzLCBiZWNhdXNlIHRoZVxuICAgICAgICAvLyBsb2dpYyB3YXMgcHJldmlvdXNseSByYW4gZm9yIHRoZSBwcmV2aW91cyBwbGFjZW1lbnQgYW5kIGlzIHRoZXJlZm9yZVxuICAgICAgICAvLyBzdGFsZS9pbmNvcnJlY3RcblxuICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5wbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDsgLy8gT24gZWFjaCB1cGRhdGUgY3ljbGUsIHRoZSBgbW9kaWZpZXJzRGF0YWAgcHJvcGVydHkgZm9yIGVhY2ggbW9kaWZpZXJcbiAgICAgICAgLy8gaXMgZmlsbGVkIHdpdGggdGhlIGluaXRpYWwgZGF0YSBzcGVjaWZpZWQgYnkgdGhlIG1vZGlmaWVyLiBUaGlzIG1lYW5zXG4gICAgICAgIC8vIGl0IGRvZXNuJ3QgcGVyc2lzdCBhbmQgaXMgZnJlc2ggb24gZWFjaCB1cGRhdGUuXG4gICAgICAgIC8vIFRvIGVuc3VyZSBwZXJzaXN0ZW50IGRhdGEsIHVzZSBgJHtuYW1lfSNwZXJzaXN0ZW50YFxuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGUubW9kaWZpZXJzRGF0YVttb2RpZmllci5uYW1lXSA9IE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVyLmRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICBpZiAoc3RhdGUucmVzZXQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHN0YXRlLnJlc2V0ID0gZmFsc2U7XG4gICAgICAgICAgICBpbmRleCA9IC0xO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF9zdGF0ZSRvcmRlcmVkTW9kaWZpZSA9IHN0YXRlLm9yZGVyZWRNb2RpZmllcnNbaW5kZXhdLFxuICAgICAgICAgICAgICBmbiA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5mbixcbiAgICAgICAgICAgICAgX3N0YXRlJG9yZGVyZWRNb2RpZmllMiA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5vcHRpb25zLFxuICAgICAgICAgICAgICBfb3B0aW9ucyA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIgPT09IHZvaWQgMCA/IHt9IDogX3N0YXRlJG9yZGVyZWRNb2RpZmllMixcbiAgICAgICAgICAgICAgbmFtZSA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5uYW1lO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgc3RhdGUgPSBmbih7XG4gICAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgICAgb3B0aW9uczogX29wdGlvbnMsXG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZVxuICAgICAgICAgICAgfSkgfHwgc3RhdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gQXN5bmMgYW5kIG9wdGltaXN0aWNhbGx5IG9wdGltaXplZCB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgbm90IGJlIGV4ZWN1dGVkIGlmXG4gICAgICAvLyBub3QgbmVjZXNzYXJ5IChkZWJvdW5jZWQgdG8gcnVuIGF0IG1vc3Qgb25jZS1wZXItdGljaylcbiAgICAgIHVwZGF0ZTogZGVib3VuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICBpbnN0YW5jZS5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgIHJlc29sdmUoc3RhdGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pLFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICBpc0Rlc3Ryb3llZCA9IHRydWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICghYXJlVmFsaWRFbGVtZW50cyhyZWZlcmVuY2UsIHBvcHBlcikpIHtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG5cbiAgICBpbnN0YW5jZS5zZXRPcHRpb25zKG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBpZiAoIWlzRGVzdHJveWVkICYmIG9wdGlvbnMub25GaXJzdFVwZGF0ZSkge1xuICAgICAgICBvcHRpb25zLm9uRmlyc3RVcGRhdGUoc3RhdGUpO1xuICAgICAgfVxuICAgIH0pOyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byBleGVjdXRlIGFyYml0cmFyeSBjb2RlIGJlZm9yZSB0aGUgZmlyc3RcbiAgICAvLyB1cGRhdGUgY3ljbGUgcnVucy4gVGhleSB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSBzYW1lIG9yZGVyIGFzIHRoZSB1cGRhdGVcbiAgICAvLyBjeWNsZS4gVGhpcyBpcyB1c2VmdWwgd2hlbiBhIG1vZGlmaWVyIGFkZHMgc29tZSBwZXJzaXN0ZW50IGRhdGEgdGhhdFxuICAgIC8vIG90aGVyIG1vZGlmaWVycyBuZWVkIHRvIHVzZSwgYnV0IHRoZSBtb2RpZmllciBpcyBydW4gYWZ0ZXIgdGhlIGRlcGVuZGVudFxuICAgIC8vIG9uZS5cblxuICAgIGZ1bmN0aW9uIHJ1bk1vZGlmaWVyRWZmZWN0cygpIHtcbiAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICB2YXIgbmFtZSA9IF9yZWYubmFtZSxcbiAgICAgICAgICAgIF9yZWYkb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfcmVmJG9wdGlvbnMgPT09IHZvaWQgMCA/IHt9IDogX3JlZiRvcHRpb25zLFxuICAgICAgICAgICAgZWZmZWN0ID0gX3JlZi5lZmZlY3Q7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBlZmZlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB2YXIgY2xlYW51cEZuID0gZWZmZWN0KHtcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2UsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgbm9vcEZuID0gZnVuY3Rpb24gbm9vcEZuKCkge307XG5cbiAgICAgICAgICBlZmZlY3RDbGVhbnVwRm5zLnB1c2goY2xlYW51cEZuIHx8IG5vb3BGbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKSB7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiBmbigpO1xuICAgICAgfSk7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xufVxuZXhwb3J0IHZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgZGV0ZWN0T3ZlcmZsb3cgfTsiLCAiaW1wb3J0IHsgcG9wcGVyR2VuZXJhdG9yLCBkZXRlY3RPdmVyZmxvdyB9IGZyb20gXCIuL2NyZWF0ZVBvcHBlci5qc1wiO1xuaW1wb3J0IGV2ZW50TGlzdGVuZXJzIGZyb20gXCIuL21vZGlmaWVycy9ldmVudExpc3RlbmVycy5qc1wiO1xuaW1wb3J0IHBvcHBlck9mZnNldHMgZnJvbSBcIi4vbW9kaWZpZXJzL3BvcHBlck9mZnNldHMuanNcIjtcbmltcG9ydCBjb21wdXRlU3R5bGVzIGZyb20gXCIuL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzXCI7XG5pbXBvcnQgYXBwbHlTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzXCI7XG5pbXBvcnQgb2Zmc2V0IGZyb20gXCIuL21vZGlmaWVycy9vZmZzZXQuanNcIjtcbmltcG9ydCBmbGlwIGZyb20gXCIuL21vZGlmaWVycy9mbGlwLmpzXCI7XG5pbXBvcnQgcHJldmVudE92ZXJmbG93IGZyb20gXCIuL21vZGlmaWVycy9wcmV2ZW50T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBhcnJvdyBmcm9tIFwiLi9tb2RpZmllcnMvYXJyb3cuanNcIjtcbmltcG9ydCBoaWRlIGZyb20gXCIuL21vZGlmaWVycy9oaWRlLmpzXCI7XG52YXIgZGVmYXVsdE1vZGlmaWVycyA9IFtldmVudExpc3RlbmVycywgcG9wcGVyT2Zmc2V0cywgY29tcHV0ZVN0eWxlcywgYXBwbHlTdHlsZXMsIG9mZnNldCwgZmxpcCwgcHJldmVudE92ZXJmbG93LCBhcnJvdywgaGlkZV07XG52YXIgY3JlYXRlUG9wcGVyID0gLyojX19QVVJFX18qL3BvcHBlckdlbmVyYXRvcih7XG4gIGRlZmF1bHRNb2RpZmllcnM6IGRlZmF1bHRNb2RpZmllcnNcbn0pOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciwgcG9wcGVyR2VuZXJhdG9yLCBkZWZhdWx0TW9kaWZpZXJzLCBkZXRlY3RPdmVyZmxvdyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciBhcyBjcmVhdGVQb3BwZXJMaXRlIH0gZnJvbSBcIi4vcG9wcGVyLWxpdGUuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgKiBmcm9tIFwiLi9tb2RpZmllcnMvaW5kZXguanNcIjsiLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcbi8vIGFuZCBUZW1wbGF0ZXIgcGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vU2lsZW50Vm9pZDEzL1RlbXBsYXRlciB3aGVyZSBJIGdvdCB0aGUgY29kZSBmb3IgdGhlIHN1Z2dlc3RlcnNcblxuaW1wb3J0IHsgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5pbXBvcnQgeyBnZXRGaWxlc0Zyb21Gb2xkZXIgfSBmcm9tIFwiLi4vdG9vbHNcIjtcbmltcG9ydCBGb2xkZXJUYWdQbHVnaW4gZnJvbSBcIi4uLy4uL21haW5cIjtcbmltcG9ydCB7IGVycm9yV3JhcHBlclN5bmMgfSBmcm9tIFwiLi4vRXJyb3JcIjtcblxuZXhwb3J0IGVudW0gRmlsZVN1Z2dlc3RNb2RlIHtcbiAgICBUZW1wbGF0ZUZpbGVzLFxuICAgIFNjcmlwdEZpbGVzLFxufVxuXG5leHBvcnQgY2xhc3MgRmlsZVN1Z2dlc3QgZXh0ZW5kcyBUZXh0SW5wdXRTdWdnZXN0PFRGaWxlPiB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBGb2xkZXJUYWdQbHVnaW4sXG4gICAgICAgIHByaXZhdGUgZm9sZGVyOiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCwgaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgZ2V0X2Vycm9yX21zZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYEZvbGRlciAke3RoaXMuZm9sZGVyfSBkb2Vzbid0IGV4aXN0YDtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhpbnB1dF9zdHI6IHN0cmluZyk6IFRGaWxlW10ge1xuICAgICAgICBjb25zdCBhbGxfZmlsZXMgPSBlcnJvcldyYXBwZXJTeW5jKFxuICAgICAgICAgICAgKCkgPT4gZ2V0RmlsZXNGcm9tRm9sZGVyKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9sZGVyXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0X2Vycm9yX21zZygpXG4gICAgICAgICk7XG4gICAgICAgIGlmICghYWxsX2ZpbGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaWxlczogVEZpbGVbXSA9IFtdO1xuICAgICAgICBjb25zdCBsb3dlcl9pbnB1dF9zdHIgPSBpbnB1dF9zdHIudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBhbGxfZmlsZXMuZm9yRWFjaCgoZmlsZTogVEFic3RyYWN0RmlsZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJlxuICAgICAgICAgICAgICAgIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIgJiZcbiAgICAgICAgICAgICAgICBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlcl9pbnB1dF9zdHIpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmaWxlcy5zbGljZSgwLCAxMDAwKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChmaWxlLnBhdGgpO1xuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gZmlsZS5wYXRoO1xuICAgICAgICB0aGlzLmlucHV0RWwudHJpZ2dlcihcImlucHV0XCIpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIiwgImltcG9ydCBleHAgZnJvbSAnY29uc3RhbnRzJztcclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0LCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nOyAvLyBBZGRlZCBzZXRJY29uXHJcblxyXG4vLyBEZWZpbmUgdGhlIHN0cnVjdHVyZSBmb3IgdHJlZSBub2Rlc1xyXG5pbnRlcmZhY2UgVHJlZU5vZGUge1xyXG4gICAgcGF0aDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdHlwZTogc3RyaW5nOyAvLyAnZm9sZGVyJyB8ICdmaWxlJztcclxuICAgIGNoaWxkcmVuPzogVHJlZU5vZGVbXTtcclxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGxpc3QgaXRlbSBlbGVtZW50IChsaSlcclxuICAgIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgbGFiZWw6IEhUTUxMYWJlbEVsZW1lbnQ7XHJcbiAgICBjb250YWluZXI6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGNvbnRhaW5lciBkaXYgaG9sZGluZyBjaGVja2JveCBhbmQgbGFiZWxcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kZSA9ICdpbmNsdWRlJyB8ICdleGNsdWRlJzsgLy8gRGVmaW5lIHNlbGVjdGlvbiBtb2Rlc1xyXG5leHBvcnQgdHlwZSBEaXJlY3RvcnlEaXNwbGF5TW9kZSA9ICdmb2xkZXJzJyB8ICdmaWxlcycgfCAnZm9sZGVyJyB8ICdmaWxlJzsgLy8gRGVmaW5lIGRpc3BsYXkgbW9kZXNcclxuZXhwb3J0IGludGVyZmFjZSBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zIHtcclxuICAgIHRpdGxlPzogc3RyaW5nOyAvLyBUaXRsZSBvZiB0aGUgbW9kYWxcclxuICAgIHNlbGVjdGlvbk1vZGU6IERpcmVjdG9yeVNlbGVjdGlvbk1vZGU7IC8vICdpbmNsdWRlJyBvciAnZXhjbHVkZSdcclxuICAgIGRpc3BsYXlNb2RlOiBEaXJlY3RvcnlEaXNwbGF5TW9kZTsgLy8gJ2ZvbGRlcnMnIG9yICdmaWxlcydcclxuICAgIG9wdGlvblNlbGVjdGlvbk1vZGU6IGJvb2xlYW47IC8vIFNob3cgaW5jbHVkZS9leGNsdWRlIG9wdGlvblxyXG4gICAgb3B0aW9uU2hvd0ZpbGVzOiBib29sZWFuOyAvLyBTaG93IGZpbGVzIG9wdGlvblxyXG59XHJcbi8vIERlZmluZSB0aGUgcmVzdWx0IHN0cnVjdHVyZSByZXR1cm5lZCBieSB0aGUgbW9kYWxcclxuZXhwb3J0IGludGVyZmFjZSBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQge1xyXG4gICAgZm9sZGVyczogc3RyaW5nW107XHJcbiAgICBmaWxlczogc3RyaW5nW107XHJcbiAgICBtb2RlOiBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RlO1xyXG4gICAgZGlzcGxheTogRGlyZWN0b3J5RGlzcGxheU1vZGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnNpZGlhbiBNb2RhbCBmb3Igc2VsZWN0aW5nIGRpcmVjdG9yaWVzIGFuZCBmaWxlcyBmcm9tIHRoZSB2YXVsdCBzdHJ1Y3R1cmUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZvbGRlcnNTbmFwc2hvdDogUmVhZG9ubHlTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZpbGVzU25hcHNob3Q6IFJlYWRvbmx5U2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxNb2RlU25hcHNob3Q6IERpcmVjdG9yeVNlbGVjdGlvbk1vZGU7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxEaXNwbGF5U25hcHNob3Q6IERpcmVjdG9yeURpc3BsYXlNb2RlO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zOyAvLyBPcHRpb25zIGZvciB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZDtcclxuXHJcbiAgICAvLyBDdXJyZW50IHN0YXRlIGJlaW5nIG1vZGlmaWVkIHdpdGhpbiB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgY3VycmVudEZvbGRlcnM6IFNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RmlsZXM6IFNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50TW9kZTogRGlyZWN0b3J5U2VsZWN0aW9uTW9kZTtcclxuICAgIHByaXZhdGUgY3VycmVudERpc3BsYXk6IERpcmVjdG9yeURpc3BsYXlNb2RlO1xyXG4gICAgcHJpdmF0ZSBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGU6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIHNob3dGaWxlczogYm9vbGVhbiA9IGZhbHNlOyAvLyBTdGF0ZSBmb3Igc2hvd2luZyBmaWxlcyBpbiB0aGUgdHJlZVxyXG5cclxuICAgIC8vIFVJIEVsZW1lbnRzXHJcbiAgICBwcml2YXRlIHRyZWVSb290RWxlbWVudDogSFRNTEVsZW1lbnQ7IC8vIENvbnRhaW5lciBmb3IgdGhlIHRyZWUgdmlld1xyXG4gICAgcHJpdmF0ZSB0cmVlTm9kZXM6IE1hcDxzdHJpbmcsIFRyZWVOb2RlPiA9IG5ldyBNYXAoKTsgLy8gTWFwIHBhdGggdG8gbm9kZSBpbmZvIGZvciBxdWljayBhY2Nlc3NcclxuICAgIHByaXZhdGUgbW9kZURyb3Bkb3duOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7IC8vIFJlZmVyZW5jZSB0byB1cGRhdGUgZHJvcGRvd24gb24gcmVzZXRcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbEZvbGRlcnMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZm9sZGVyIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxGaWxlcyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmaWxlIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gICAgICogQHBhcmFtIG9rQ2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiT0tcIi4gUmVjZWl2ZXMgdGhlIHNlbGVjdGlvbiByZXN1bHQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGFwcDogQXBwLFxyXG4gICAgICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBpbml0aWFsRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgICAgIGluaXRpYWxPcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zLFxyXG4gICAgICAgIG9rQ2FsbGJhY2s6IChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHZvaWRcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgLy8gU3RvcmUgaW5pdGlhbCBzdGF0ZSBmb3IgcmVzZXRcclxuICAgICAgICB0aGlzLmluaXRpYWxGb2xkZXJzU25hcHNob3QgPSBuZXcgU2V0KGluaXRpYWxGb2xkZXJzKTtcclxuICAgICAgICB0aGlzLmluaXRpYWxGaWxlc1NuYXBzaG90ID0gbmV3IFNldChpbml0aWFsRmlsZXMpO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbE1vZGVTbmFwc2hvdCA9IGluaXRpYWxPcHRpb25zLnNlbGVjdGlvbk1vZGU7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRGlzcGxheVNuYXBzaG90ID0gaW5pdGlhbE9wdGlvbnMuZGlzcGxheU1vZGU7XHJcbiAgICAgICAgdGhpcy5zaG93RmlsZXMgPSBpbml0aWFsT3B0aW9ucy5kaXNwbGF5TW9kZT09PSdmaWxlcycgfHwgaW5pdGlhbE9wdGlvbnMuZGlzcGxheU1vZGU9PT0nZmlsZSd8fCBpbml0aWFsRmlsZXMubGVuZ3RoPjA7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gaW5pdGlhbE9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrID0gb2tDYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBjdXJyZW50IHN0YXRlIGZyb20gaW5pdGlhbCBzdGF0ZSBmb3IgZWRpdGluZ1xyXG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gVXNlIGEgbWV0aG9kIGZvciBpbml0aWFsaXphdGlvbiBhbmQgcmVzZXRcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gdGhlIGluaXRpYWwgc3RhdGUgcHJvdmlkZWQgYXQgY29uc3RydWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZvbGRlcnNTbmFwc2hvdCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZXMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZpbGVzU25hcHNob3QpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KFtdKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcyA9IG5ldyBTZXQoW10pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgY29udGVudFxyXG4gICAgICAgIGNvbnRlbnRFbC5hZGRDbGFzcygnZGlyZWN0b3J5LXNlbGVjdGlvbi1tb2RhbCcpOyBcclxuXHJcbiAgICAgICAgLy8gLS0tIE1vZGFsIFRpdGxlIC0tLVxyXG4gICAgICAgIGlmICh0aGlzLmluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSkge1xyXG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiB0aGlzLm9wdGlvbnMudGl0bGUgfHwgJ0luY2x1ZGUgb3IgRXhjbHVkZSBGb2xkZXJzIGFuZCBGaWxlcycgfSk7IFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IHRoaXMub3B0aW9ucy50aXRsZSB8fCBgJHt0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScgPyAnRXhjbHVkZScgOiAnSW5jbHVkZSd9IEZvbGRlcnMgYW5kIEZpbGVzYCB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU2V0dGluZ3MgQ29udHJvbHMgLS0tXHJcbiAgICAgICAgY29uc3QgY29udHJvbHNFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1jb250cm9scycgfSk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVNb2RlU2V0dGluZyhjb250cm9sc0VsKTsgLy8gQ3JlYXRlIG1vZGUgZHJvcGRvd25cclxuICAgICAgICB0aGlzLmNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udHJvbHNFbCk7IC8vIENyZWF0ZSBmaWxlIHRvZ2dsZVxyXG5cclxuICAgICAgICAvLyAtLS0gVHJlZSBDb250YWluZXIgLS0tXHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS12aWV3LWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gJzYwMHB4JztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JztcclxuXHJcbiAgICAgICAgLy8gLS0tIEJ1aWxkIGFuZCBSZW5kZXIgVHJlZSAtLS1cclxuICAgICAgICBpZiAoIXRoaXMudHJlZU5vZGVzLnNpemUpIHsgLy8gRW5zdXJlIHRoZSB0cmVlIGlzIG9ubHkgcmVuZGVyZWQgb25jZVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBJbml0aWFsIHJlbmRlcmluZyBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWN0aW9uIEJ1dHRvbnMgLS0tXHJcbiAgICAgICAgdGhpcy5jcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRlbnRFbCk7IC8vIENyZWF0ZSBPSyBhbmQgUmVzZXQgYnV0dG9uc1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgZHJvcGRvd24gc2V0dGluZyBmb3IgY2hvb3NpbmcgdGhlIHNlbGVjdGlvbiBtb2RlLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIHNldHRpbmcgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlTW9kZVNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZURyb3Bkb3duID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpIC8vIFN0b3JlIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1NlbGVjdGlvbiBNb2RlJykgLy8gU2V0dGluZyBOYW1lIGluIEdlcm1hblxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBpZiB0aGUgc2VsZWN0ZWQgZmlsZXMgYW5kIGZvbGRlcnMgc2hvdWxkIGJlIGV4Y2x1ZGVkIG9yIGluY2x1ZGVkLicpIFxyXG4gICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdleGNsdWRlJywgJ2V4Y2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdpbmNsdWRlJywgJ2luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSkgLy8gU2V0IGluaXRpYWwgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB2YWx1ZSBhcyAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7IC8vIFVwZGF0ZSB0cmVlIHZpc3VhbHMgYmFzZWQgb24gbmV3IG1vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBtb2RlIGRyb3Bkb3duIFVJIGVsZW1lbnQgdG8gcmVmbGVjdCB0aGUgY3VycmVudE1vZGUgc3RhdGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlTW9kZURyb3Bkb3duKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGRyb3Bkb3duQ29tcG9uZW50ID0gdGhpcy5tb2RlRHJvcGRvd24/LmNvbXBvbmVudHNbMF0gYXMgYW55OyAvLyBBY2Nlc3MgZHJvcGRvd24gY29tcG9uZW50XHJcbiAgICAgICAgaWYgKGRyb3Bkb3duQ29tcG9uZW50ICYmIHR5cGVvZiBkcm9wZG93bkNvbXBvbmVudC5zZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgZHJvcGRvd25Db21wb25lbnQuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIHRvZ2dsZSBzZXR0aW5nIGZvciBzaG93aW5nL2hpZGluZyBmaWxlcyBpbiB0aGUgdHJlZS5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBzZXR0aW5nIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5vcHRpb25TaG93RmlsZXMpIHtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnU2hvdyBGaWxlcycpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnU2hvdyBGaWxlcyB3aXRoaW4gdGhlIGRpcmVjdG9yeSB0cmVlLicpXHJcbiAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNob3dGaWxlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0ZpbGVzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIFwiT0tcIiBhbmQgXCJSZXNldFwiIGJ1dHRvbnMuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYnV0dG9ucyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWJ1dHRvbnMnIH0pO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTVweCc7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIFVzZSBmbGV4IGZvciBhbGlnbm1lbnRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1lbmQnOyAvLyBBbGlnbiBidXR0b25zIHRvIHRoZSByaWdodFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5nYXAgPSAnMTBweCc7IC8vIFNwYWNlIGJldHdlZW4gYnV0dG9uc1xyXG5cclxuICAgICAgICAvLyBSZXNldCBCdXR0b24gKFVuZG8gXHUyMUFBXHVGRTBGKVxyXG4gICAgICAgIGNvbnN0IHJlc2V0QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKHJlc2V0QnV0dG9uLCAncmVzZXQnKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgcmVzZXRCdXR0b24uYXJpYUxhYmVsID0gJ1Jlc2V0IHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICByZXNldEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFJlc2V0IGludGVybmFsIHN0YXRlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kZURyb3Bkb3duKCk7IC8vIFVwZGF0ZSBkcm9wZG93biBVSVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBSZS1yZW5kZXIgdHJlZSB3aXRoIHJlc2V0IHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgQnV0dG9uIChDbGVhciBcdUQ4M0RcdURFQUUpXHJcbiAgICAgICAgY29uc3QgZW1wdHlCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24oZW1wdHlCdXR0b24sICdlcmFzZXInKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgZW1wdHlCdXR0b24uYXJpYUxhYmVsID0gJ0NsZWFyIHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBlbXB0eUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOyAvLyBDbGVhciBzdGF0ZVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVEcm9wZG93bigpOyAvLyBVcGRhdGUgZHJvcGRvd24gVUlcclxuICAgICAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTsgLy8gUmUtcmVuZGVyIHRyZWUgd2l0aCByZXNldCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGNhbmNlbCBCdXR0b25cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NhbmNlbCcgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgZGlzY2FyZCBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkNhbmNlbCBDbGlja2VkIC0gUmV0dXJuaW5nXCIpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICAgICAgdGhpcy5va0NhbGxiYWNrKCBudWxsICk7IC8vIFBhc3MgdGhlIGZpbmFsIHNlbGVjdGlvbiBiYWNrXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBPSyBCdXR0b25cclxuICAgICAgICBjb25zdCBva0J1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnT0snLCBjbHM6ICdtb2QtY3RhJyB9KTtcclxuICAgICAgICBva0J1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIHNhdmUgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBva0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQnVpbGRzIHRoZSBsb2dpY2FsIHRyZWUgc3RydWN0dXJlIGRhdGEgZnJvbSB0aGUgdmF1bHQncyBmaWxlcyBhbmQgZm9sZGVycy5cclxuICAgICAqIEByZXR1cm5zIFRoZSByb290IG5vZGUgb2YgdGhlIHRyZWUgc3RydWN0dXJlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJ1aWxkVHJlZURhdGEoKTogVHJlZU5vZGUge1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHZpcnR1YWwgcm9vdCBub2RlIHJlcHJlc2VudGluZyB0aGUgdmF1bHRcclxuICAgICAgICBjb25zdCB2YXVsdFJvb3ROb2RlOiBUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgcGF0aDogJy8nLCAvLyBSb290IGZvbGRlciBwYXRoXHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuYXBwLnZhdWx0LmdldE5hbWUoKSB8fCAnVmF1bHQnLCAvLyBVc2UgdmF1bHQgbmFtZSBvciBkZWZhdWx0XHJcbiAgICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgIC8vIFBsYWNlaG9sZGVyIGVsZW1lbnRzLCB3aWxsIGJlIGFzc2lnbmVkIGR1cmluZyByZW5kZXJpbmdcclxuICAgICAgICAgICAgZWxlbWVudDogbnVsbCEsXHJcbiAgICAgICAgICAgIGNoZWNrYm94OiBudWxsISxcclxuICAgICAgICAgICAgbGFiZWw6IG51bGwhLFxyXG4gICAgICAgICAgICBjb250YWluZXI6IG51bGwhLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IGZvbGRlck5vZGVzID0gbmV3IE1hcDxzdHJpbmcsIFRyZWVOb2RlPigpO1xyXG4gICAgICAgIGZvbGRlck5vZGVzLnNldCgnLycsIHZhdWx0Um9vdE5vZGUpOyAvLyBBZGQgcm9vdCB0byB0aGUgbWFwXHJcblxyXG4gICAgICAgIC8vIFVzZSBnZXRGaWxlcygpIHRvIHJldHJpZXZlIGFsbCBURmlsZSBvYmplY3RzIChNYXJrZG93biwgaW1hZ2VzLCBwZGYsIGV0Yy4pXHJcbiAgICAgICAgY29uc3QgYWxsRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpO1xyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAxOiBDcmVhdGUgYWxsIGZvbGRlciBub2RlcyBiYXNlZCBvbiBmaWxlIHBhcmVudCBwYXRocyAtLS1cclxuICAgICAgICBhbGxGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudDtcclxuICAgICAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBwYXJlbnRGb2xkZXIucGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHAubGVuZ3RoID4gMCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcGFyZW50Tm9kZSA9IHZhdWx0Um9vdE5vZGU7IC8vIFN0YXJ0IGZyb20gdmF1bHQgcm9vdFxyXG4gICAgICAgICAgICBwYXRoUGFydHMuZm9yRWFjaChwYXJ0ID0+IHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY3VycmVudFBhdGggPT09ICcvJyA/IHBhcnQgOiBgJHtjdXJyZW50UGF0aH0vJHtwYXJ0fWA7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWZvbGRlck5vZGVzLmhhcyhjdXJyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGb2xkZXJOb2RlOiBUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogY3VycmVudFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveDogbnVsbCEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBudWxsISxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBudWxsISxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvbGRlck5vZGVzLnNldChjdXJyZW50UGF0aCwgbmV3Rm9sZGVyTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiEucHVzaChuZXdGb2xkZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gbmV3Rm9sZGVyTm9kZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGZvbGRlck5vZGVzLmdldChjdXJyZW50UGF0aCkhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFN0ZXAgMjogQWRkIGZpbGUgbm9kZXMgaWYgJ3Nob3dGaWxlcycgaXMgZW5hYmxlZCAtLS1cclxuICAgICAgICBpZiAodGhpcy5zaG93RmlsZXMpIHtcclxuICAgICAgICAgICAgYWxsRmlsZXMuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEZvbGRlciA9IGZpbGUucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gXCIvXCIgKyBwYXJlbnRGb2xkZXIucGF0aDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSBmb2xkZXJOb2Rlcy5nZXQocGFyZW50UGF0aCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZU5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrYm94OiBudWxsISxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogbnVsbCEsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBudWxsISxcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuIS5wdXNoKGZpbGVOb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAzOiBTb3J0IGNoaWxkcmVuIGFscGhhYmV0aWNhbGx5IChmb2xkZXJzIGZpcnN0LCB0aGVuIGZpbGVzKSAtLS1cclxuICAgICAgICBjb25zdCBzb3J0Tm9kZXMgPSAoYTogVHJlZU5vZGUsIGI6IFRyZWVOb2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmb2xkZXInICYmIGIudHlwZSA9PT0gJ2ZpbGUnKSByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmaWxlJyAmJiBiLnR5cGUgPT09ICdmb2xkZXInKSByZXR1cm4gMTtcclxuICAgICAgICAgICAgcmV0dXJuIGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZm9sZGVyTm9kZXMuZm9yRWFjaChub2RlID0+IG5vZGUuY2hpbGRyZW4/LnNvcnQoc29ydE5vZGVzKSk7XHJcblxyXG4gICAgICAgIHJldHVybiB2YXVsdFJvb3ROb2RlOyAvLyBSZXR1cm4gdGhlIHBvcHVsYXRlZCByb290IG5vZGVcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSBlbnRpcmUgdHJlZSBzdHJ1Y3R1cmUgaW4gdGhlIERPTSBiYXNlZCBvbiB0aGUgdHJlZSBkYXRhLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlbmRlclRyZWUoKSB7XHJcbiAgICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LmVtcHR5KCk7IC8vIENsZWFyIGV4aXN0aW5nIERPTSBlbGVtZW50c1xyXG4gICAgICAgICB0aGlzLnRyZWVOb2Rlcy5jbGVhcigpOyAvLyBDbGVhciB0aGUgbm9kZSBtYXBcclxuXHJcbiAgICAgICAgIGNvbnN0IHRyZWVEYXRhID0gdGhpcy5idWlsZFRyZWVEYXRhKCk7IC8vIEdldCB0aGUgc3RydWN0dXJlZCBkYXRhXHJcblxyXG4gICAgICAgICAvLyBDcmVhdGUgdGhlIHRvcC1sZXZlbCBsaXN0IGZvciB0aGUgdmF1bHQgY29udGVudHNcclxuICAgICAgICAgY29uc3Qgcm9vdFVsID0gdGhpcy50cmVlUm9vdEVsZW1lbnQuY3JlYXRlRWwoJ3VsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5hZGRDbGFzcygndHJlZS1yb290LXVsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5saXN0U3R5bGUgPSAnbm9uZSc7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVtb3ZlIGRlZmF1bHQgbGlzdCBpbmRlbnRhdGlvblxyXG5cclxuICAgICAgICAgLy8gUmVuZGVyIHRoZSByb290IGZvbGRlciBpdHNlbGZcclxuICAgICAgICAgLy90aGlzLnJlbmRlclRyZWVOb2RlKHRyZWVEYXRhLCByb290VWwsIDAsIHRoaXMuY3VycmVudE1vZGUgPT09ICdpbmNsdWRlJyA/IHRoaXMuY3VycmVudEZvbGRlcnMgOiB0aGlzLmN1cnJlbnRGaWxlcyk7XHJcbiAgICAgICAgIHRoaXMucmVuZGVyVHJlZU5vZGUodHJlZURhdGEsIHJvb3RVbCwgMCwgdGhpcy5jdXJyZW50Rm9sZGVycywgdGhpcy5jdXJyZW50RmlsZXMpOyAvL1RPRE86IGV4cGFuZCB0aGlzIHRvIGluY2x1ZGUgZmlsZXMgYXMgd2VsbFxyXG5cclxuICAgICAgICAgLy8gUmVuZGVyIGNoaWxkcmVuIG9mIHRoZSByb290IGZvbGRlclxyXG4gICAgICAgICB0cmVlRGF0YS5jaGlsZHJlbj8uZm9yRWFjaChjaGlsZE5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgLy90aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkTm9kZSwgcm9vdFVsLCAxLCB0aGlzLmN1cnJlbnRNb2RlID09PSAnaW5jbHVkZScgPyB0aGlzLmN1cnJlbnRGb2xkZXJzIDogdGhpcy5jdXJyZW50RmlsZXMpOyAvLyBTdGFydCByZW5kZXJpbmcgYXQgbGV2ZWwgMVxyXG4gICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlY3Vyc2l2ZWx5IHJlbmRlcnMgYSBzaW5nbGUgdHJlZSBub2RlIGFuZCBpdHMgY2hpbGRyZW4gaW4gdGhlIERPTS5cclxuICAgICAqIEBwYXJhbSBub2RlIC0gVGhlIFRyZWVOb2RlIGRhdGEgdG8gcmVuZGVyLlxyXG4gICAgICogQHBhcmFtIHBhcmVudEVsZW1lbnQgLSBUaGUgSFRNTCBgdWxgIGVsZW1lbnQgdG8gYXBwZW5kIHRoaXMgbm9kZSdzIGBsaWAgdG8uXHJcbiAgICAgKiBAcGFyYW0gbGV2ZWwgLSBUaGUgY3VycmVudCBpbmRlbnRhdGlvbiBsZXZlbC5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJUcmVlTm9kZShub2RlOiBUcmVlTm9kZSwgcGFyZW50RWxlbWVudDogSFRNTEVsZW1lbnQsIGxldmVsOiBudW1iZXIsIHNlbGVjdGVkUGF0aHM6IFNldDxzdHJpbmc+LCBzZWxlY3RlZGZpbGVzOiBTZXQ8c3RyaW5nPikge1xyXG4gICAgICAgIGNvbnN0IGxpID0gcGFyZW50RWxlbWVudC5jcmVhdGVFbCgnbGknKTtcclxuICAgICAgICBsaS5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7bGV2ZWwgKiAyMH1weGA7IC8vIEFwcGx5IGluZGVudGF0aW9uIGJhc2VkIG9uIGxldmVsXHJcbiAgICAgICAgbGkuYWRkQ2xhc3MoYHRyZWUtbm9kZS0ke25vZGUudHlwZX1gKTsgLy8gQWRkIGNsYXNzIGZvciB0eXBlIChmb2xkZXIvZmlsZSlcclxuXHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGkuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS1ub2RlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcclxuICAgICAgICBjb250YWluZXIuc3R5bGUucGFkZGluZyA9ICcycHggMCc7IC8vIEFkZCBzb21lIHZlcnRpY2FsIHBhZGRpbmdcclxuXHJcbiAgICAgICAgLy8gLS0tIFRvZ2dsZSBCdXR0b24gZm9yIEZvbGRlcnMgLS0tXHJcbiAgICAgICAgbGV0IHRvZ2dsZUJ1dHRvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgICAgICBsZXQgaXNDb2xsYXBzZWQgPSB0cnVlOyAvLyBEZWZhdWx0IHN0YXRlIGlzIGNvbGxhcHNlZFxyXG5cclxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24gPSBjb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ3RyZWUtdG9nZ2xlLWJ1dHRvbicgfSk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdcdTI1QjYnOyAvLyBSaWdodC1wb2ludGluZyB0cmlhbmdsZVxyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uc3R5bGUubWFyZ2luUmlnaHQgPSAnNXB4JztcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgZm9sZGVyIG9yIGFueSBvZiBpdHMgY2hpbGRyZW4gYXJlIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZEV4cGFuZCA9IHRoaXMuc2hvdWxkRXhwYW5kRm9sZGVyKG5vZGUsIHNlbGVjdGVkUGF0aHMsIHNlbGVjdGVkZmlsZXMpO1xyXG4gICAgICAgICAgICBpZiAoc2hvdWxkRXhwYW5kKSB7XHJcbiAgICAgICAgICAgICAgICBpc0NvbGxhcHNlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlzQ29sbGFwc2VkID0gIWlzQ29sbGFwc2VkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRvZ2dsZUJ1dHRvbikgdG9nZ2xlQnV0dG9uLnRleHRDb250ZW50ID0gaXNDb2xsYXBzZWQgPyAnXHUyNUI2JyA6ICdcdTI1QkMnOyAvLyBVcGRhdGUgdHJpYW5nbGUgZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5VbCkgY2hpbGRyZW5VbC5zdHlsZS5kaXNwbGF5ID0gaXNDb2xsYXBzZWQgPyAnbm9uZScgOiAnYmxvY2snOyAvLyBTaG93L2hpZGUgY2hpbGRyZW5cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLSBDaGVja2JveCAtLS1cclxuICAgICAgICBjb25zdCBjaGVja2JveCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCB7IHR5cGU6ICdjaGVja2JveCcgfSk7XHJcbiAgICAgICAgY2hlY2tib3guaWQgPSBgdHJlZS1jYi0ke25vZGUucGF0aC5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywgJy0nKX1gOyAvLyBDcmVhdGUgYSBzYWZlIElEXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC5wYXRoID0gbm9kZS5wYXRoOyAvLyBTdG9yZSBwYXRoIGluIGRhdGEgYXR0cmlidXRlXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC50eXBlID0gbm9kZS50eXBlOyAvLyBTdG9yZSB0eXBlXHJcblxyXG4gICAgICAgIC8vIC0tLSBMYWJlbCAtLS1cclxuICAgICAgICBjb25zdCBsYWJlbCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnKTtcclxuICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IGAke25vZGUudHlwZSA9PT0gJ2ZvbGRlcicgPyAnXHVEODNEXHVEQ0MxJyA6ICdcdUQ4M0RcdURDQzQnfSAke25vZGUubmFtZX1gO1xyXG4gICAgICAgIC8vIGxhYmVsLnRleHRDb250ZW50ID0gbm9kZS5uYW1lO1xyXG4gICAgICAgIGxhYmVsLmh0bWxGb3IgPSBjaGVja2JveC5pZDsgLy8gTGluayBsYWJlbCB0byBjaGVja2JveFxyXG4gICAgICAgIGxhYmVsLnN0eWxlLm1hcmdpbkxlZnQgPSAnNXB4JztcclxuICAgICAgICBsYWJlbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcbiAgICAgICAgbGFiZWwudGl0bGUgPSBub2RlLnBhdGg7IC8vIFNob3cgZnVsbCBwYXRoIG9uIGhvdmVyXHJcblxyXG4gICAgICAgIC8vIC0tLSBTdG9yZSByZWZlcmVuY2VzIGluIHRoZSBub2RlIG9iamVjdCBhbmQgbWFwIC0tLVxyXG4gICAgICAgIG5vZGUuZWxlbWVudCA9IGxpO1xyXG4gICAgICAgIG5vZGUuY2hlY2tib3ggPSBjaGVja2JveDtcclxuICAgICAgICBub2RlLmxhYmVsID0gbGFiZWw7XHJcbiAgICAgICAgbm9kZS5jb250YWluZXIgPSBjb250YWluZXI7IC8vIFN0b3JlIGNvbnRhaW5lciByZWZlcmVuY2VcclxuICAgICAgICB0aGlzLnRyZWVOb2Rlcy5zZXQobm9kZS5wYXRoLCBub2RlKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFNldCBpbml0aWFsIGNoZWNrZWQgc3RhdGUgYmFzZWQgb24gY3VycmVudCBzZWxlY3Rpb24gLS0tXHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicpIHtcclxuICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gdGhpcy5jdXJyZW50RmlsZXMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciBjaGVja2JveCBjaGFuZ2VzIC0tLVxyXG4gICAgICAgIGNoZWNrYm94Lm9uY2hhbmdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdGFyZ2V0LmRhdGFzZXQucGF0aCE7XHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0YXJnZXQuZGF0YXNldC50eXBlIGFzICdmb2xkZXInIHwgJ2ZpbGUnO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzZXRzXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXInKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc3BsYXlNb2RlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIHNlbGVjdGlvbiBpZiBvbmx5IG9uZSBmb2xkZXIgY2FuIGJlIHNlbGVjdGVkXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNwbGF5TW9kZSA9PT0gJ2ZpbGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEZpbGVzLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIHNlbGVjdGlvbiBpZiBvbmx5IG9uZSBmaWxlIGNhbiBiZSBzZWxlY3RlZFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2ZvbGRlcicpIHRoaXMuY3VycmVudEZvbGRlcnMuZGVsZXRlKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmN1cnJlbnRGaWxlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB2aXN1YWwgc3RhdGUgb2YgdGhlIGVudGlyZSB0cmVlIGFmdGVyIGEgY2hhbmdlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVHJlZUFwcGVhcmFuY2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyAtLS0gUmVuZGVyIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5IGlmIGl0J3MgYSBmb2xkZXIgLS0tXHJcbiAgICAgICAgbGV0IGNoaWxkcmVuVWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicgJiYgbm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY2hpbGRyZW5VbCA9IGxpLmNyZWF0ZUVsKCd1bCcpO1xyXG4gICAgICAgICAgICBjaGlsZHJlblVsLnN0eWxlLmxpc3RTdHlsZSA9ICdub25lJztcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVzZXQgcGFkZGluZyBmb3IgbmVzdGVkIGxpc3RcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzAnOyAvLyBQcmV2ZW50IGRvdWJsZSBpbmRlbnRhdGlvbiBmcm9tIGRlZmF1bHQgVUwgc3R5bGVzXHJcbiAgICAgICAgICAgIGNoaWxkcmVuVWwuc3R5bGUuZGlzcGxheSA9IGlzQ29sbGFwc2VkID8gJ25vbmUnIDogJ2Jsb2NrJzsgLy8gU2hvdy9oaWRlIGNoaWxkcmVuIGJhc2VkIG9uIGluaXRpYWwgc3RhdGVcclxuXHJcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB0aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkLCBjaGlsZHJlblVsISwgbGV2ZWwgKyAxLCBzZWxlY3RlZFBhdGhzLCBzZWxlY3RlZGZpbGVzKSk7IC8vIEluY3JlYXNlIGxldmVsIGZvciBjaGlsZHJlblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIZWxwZXIgbWV0aG9kIHRvIGRldGVybWluZSBpZiBhIGZvbGRlciBzaG91bGQgYmUgZXhwYW5kZWRcclxuICAgIHByaXZhdGUgc2hvdWxkRXhwYW5kRm9sZGVyKG5vZGU6IFRyZWVOb2RlLCBzZWxlY3RlZFBhdGhzOiBTZXQ8c3RyaW5nPiwgc2VsZWN0ZWRGaWxlczogU2V0PHN0cmluZz4pOiBib29sZWFuIHtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRQYXRocy5oYXMobm9kZS5wYXRoKSB8fCBzZWxlY3RlZEZpbGVzLmhhcyhub2RlLnBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBUaGUgZm9sZGVyIGl0c2VsZiBpcyBzZWxlY3RlZFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRFeHBhbmRGb2xkZXIoY2hpbGQsIHNlbGVjdGVkUGF0aHMsIHNlbGVjdGVkRmlsZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEEgY2hpbGQgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBOZWl0aGVyIHRoZSBmb2xkZXIgbm9yIGl0cyBjaGlsZHJlbiBhcmUgc2VsZWN0ZWRcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB2aXN1YWwgYXBwZWFyYW5jZSAoZW5hYmxlZC9kaXNhYmxlZC9zdHlsaW5nKSBvZiBhbGwgbm9kZXNcclxuICAgICAqIGluIHRoZSB0cmVlIGJhc2VkIG9uIHRoZSBjdXJyZW50IG1vZGUgYW5kIHNlbGVjdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlVHJlZUFwcGVhcmFuY2UoKSB7XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaXNEaXNhYmxlZCA9IGZhbHNlOyAvLyBTaG91bGQgdGhlIG5vZGUgYXBwZWFyIGRpc2FibGVkIChncmV5ZWQgb3V0KT9cclxuICAgICAgICAgICAgbGV0IGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IGZhbHNlOyAvLyBJcyB0aGUgbm9kZSBwYXJ0IG9mIHRoZSAnYWN0aXZlJyBzZXQgaW4gaW5jbHVkZSBtb2RlP1xyXG4gICAgICAgICAgICBsZXQgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkID0gZmFsc2U7IC8vIElzIHRoZSBub2RlIHBhcnQgb2YgdGhlICdpbmFjdGl2ZScgc2V0IGluIGV4Y2x1ZGUgbW9kZT9cclxuXHJcbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiBhbiBhbmNlc3RvciBGT0xERVIgb2YgdGhpcyBub2RlIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGxldCBhbmNlc3RvckZvbGRlclNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9IG5vZGUucGF0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnRQYXRoICE9PSAnLycpIHtcclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudFBhdGguc3Vic3RyaW5nKDAsIGN1cnJlbnRQYXRoLmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudFBhdGgpIGJyZWFrOyAvLyBTYWZldHkgYnJlYWsgYXQgcm9vdFxyXG4gICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gcGFyZW50UGF0aDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIG5vZGUgaXRzZWxmIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVTZWxlY3RlZCA9IG5vZGUudHlwZSA9PT0gJ2ZvbGRlcidcclxuICAgICAgICAgICAgICAgID8gdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMobm9kZS5wYXRoKVxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLmN1cnJlbnRGaWxlcy5oYXMobm9kZS5wYXRoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBBcHBseSBMb2dpYyBCYXNlZCBvbiBNb2RlIC0tLVxyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBFWENMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGV4Y2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBleGNsdWRlZC5cclxuICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlFeGNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9IGlzRWZmZWN0aXZlbHlFeGNsdWRlZDtcclxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gSU5DTFVERSBNb2RlXHJcbiAgICAgICAgICAgICAgICAvLyBJTkNMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGluY2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBOT1QgaW5jbHVkZWQuXHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgaW5jbHVkZWQgaWYgc2VsZWN0ZWQgT1IgcGFyZW50IHBhdGggaXMgaW5jbHVkZWRcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gbm9kZS5wYXRoLnN1YnN0cmluZygwLCBub2RlLnBhdGgubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQgPSB0aGlzLmlzUGF0aEVmZmVjdGl2ZWx5SW5jbHVkZWQocGFyZW50UGF0aCk7IC8vIENoZWNrIHBhcmVudCBmb2xkZXIgc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgaXNFZmZlY3RpdmVseUluY2x1ZGVkID0gbm9kZVNlbGVjdGVkIHx8IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkID0gIWlzRWZmZWN0aXZlbHlJbmNsdWRlZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEFwcGx5IFZpc3VhbCBTdHlsZXMgLS0tXHJcbiAgICAgICAgICAgIC8vIENoZWNrYm94IGl0c2VsZiBzaG91bGQgYWx3YXlzIGJlIGNsaWNrYWJsZSB0byBjaGFuZ2Ugc2VsZWN0aW9uIHN0YXRlXHJcbiAgICAgICAgICAgIG5vZGUuY2hlY2tib3guZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgbm9kZS5jaGVja2JveC5jaGVja2VkID0gbm9kZVNlbGVjdGVkO1xyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc3R5bGluZyB0byB0aGUgY29udGFpbmVyIChsYWJlbCwgaWNvbikgYmFzZWQgb24gZGlzYWJsZWQgc3RhdGVcclxuICAgICAgICAgICAgaWYgKGlzRGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuY29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAnMC41JztcclxuICAgICAgICAgICAgICAgIG5vZGUubGFiZWwuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbGluZS10aHJvdWdoJzsgLy8gTW9yZSBwcm9taW5lbnQgZGlzYWJsZWQgbG9va1xyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LmFkZENsYXNzKCdpcy1kaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5jb250YWluZXIuc3R5bGUub3BhY2l0eSA9ICcxJztcclxuICAgICAgICAgICAgICAgIG5vZGUubGFiZWwuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2lzLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBGSVggZm9yIEludmFsaWRDaGFyYWN0ZXJFcnJvciAtLS1cclxuICAgICAgICAgICAgLy8gUmVtb3ZlIGNsYXNzZXMgaW5kaXZpZHVhbGx5XHJcbiAgICAgICAgICAgIG5vZGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1pbmNsdWRlZCcsICdpcy1leGNsdWRlZCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIHNwZWNpZmljIGNsYXNzZXMgZm9yIHN0eWxpbmcgaW5jbHVkZWQvZXhjbHVkZWQgc3RhdGVzXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlID09PSAnaW5jbHVkZScgJiYgaXNFZmZlY3RpdmVseUluY2x1ZGVkKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQuYWRkQ2xhc3MoJ2lzLWluY2x1ZGVkJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnICYmIGlzRWZmZWN0aXZlbHlFeGNsdWRlZCkge1xyXG4gICAgICAgICAgICAgICAgIC8vIEFwcGx5IGV4Y2x1ZGVkIGNsYXNzIGV2ZW4gaWYgaXQncyBqdXN0IHZpc3VhbGx5IGRpc2FibGVkXHJcbiAgICAgICAgICAgICAgICAgLy8gVGhpcyBhbGxvd3Mgc3BlY2lmaWMgc3R5bGluZyBmb3IgZXhjbHVkZWQgaXRlbXMgYmV5b25kIGp1c3QgZ3JleWVkIG91dFxyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LmFkZENsYXNzKCdpcy1leGNsdWRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGEgZ2l2ZW4gcGF0aCBpcyBlZmZlY3RpdmVseSBpbmNsdWRlZFxyXG4gICAgICogaW4gdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHVuZGVyICdpbmNsdWRlJyBtb2RlLlxyXG4gICAgICogQSBwYXRoIGlzIGluY2x1ZGVkIGlmIGl0IChmaWxlIG9yIGZvbGRlcikgaXMgc2VsZWN0ZWQsIG9yIGlmIGFueSBvZiBpdHMgYW5jZXN0b3IgRk9MREVSUyBhcmUgc2VsZWN0ZWQuXHJcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmb2xkZXIgb3IgZmlsZSBwYXRoIHRvIGNoZWNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcGF0aCBzaG91bGQgYmUgY29uc2lkZXJlZCBpbmNsdWRlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlzUGF0aEVmZmVjdGl2ZWx5SW5jbHVkZWQocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gVGhpcyBjaGVjayBpcyBwcmltYXJpbHkgZm9yICdpbmNsdWRlJyBtb2RlIGxvZ2ljLlxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlICE9PSAnaW5jbHVkZScpIHtcclxuICAgICAgICAgICAgIC8vIEluICdleGNsdWRlJyBtb2RlLCBjb25jZXB0dWFsbHkgZXZlcnl0aGluZyBpcyBpbmNsdWRlZCB1bmxlc3MgZXhjbHVkZWQuXHJcbiAgICAgICAgICAgICAvLyBGb3IgaW50ZXJuYWwgY2hlY2tzLCB3ZSBtaWdodCBuZWVkIHRoZSBpbnZlcnNlIG9mIGV4Y2x1c2lvbi5cclxuICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc1BhdGhFZmZlY3RpdmVseUV4Y2x1ZGVkKHBhdGgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBhdGggaXRzZWxmIGlzIHNlbGVjdGVkIChhcHBsaWVzIHRvIGJvdGggZmlsZXMgYW5kIGZvbGRlcnMpXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGVzLmhhcyhwYXRoKSB8fCB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIGFueSBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWRcclxuICAgICAgICBsZXQgY3VycmVudCA9IHBhdGg7XHJcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09ICcvJykge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudC5zdWJzdHJpbmcoMCwgY3VycmVudC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEFuIGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSBjdXJyZW50KSBicmVhazsgLy8gUmVhY2hlZCByb290IG9yIGVycm9yXHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBOZWl0aGVyIHRoZSBwYXRoIG5vciBhbnkgYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICB9XHJcblxyXG4gICAgIC8qKlxyXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhIGdpdmVuIHBhdGggaXMgZWZmZWN0aXZlbHkgZXhjbHVkZWRcclxuICAgICAqIGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB1bmRlciAnZXhjbHVkZScgbW9kZS5cclxuICAgICAqIEEgcGF0aCBpcyBleGNsdWRlZCBpZiBpdCAoZmlsZSBvciBmb2xkZXIpIGlzIHNlbGVjdGVkLCBvciBpZiBhbnkgb2YgaXRzIGFuY2VzdG9yIEZPTERFUlMgYXJlIHNlbGVjdGVkLlxyXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZm9sZGVyIG9yIGZpbGUgcGF0aCB0byBjaGVjay5cclxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHBhdGggc2hvdWxkIGJlIGNvbnNpZGVyZWQgZXhjbHVkZWQsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpc1BhdGhFZmZlY3RpdmVseUV4Y2x1ZGVkKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgICAvLyBUaGlzIGNoZWNrIGlzIHByaW1hcmlseSBmb3IgJ2V4Y2x1ZGUnIG1vZGUgbG9naWMuXHJcbiAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlICE9PSAnZXhjbHVkZScpIHtcclxuICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBhdGggaXRzZWxmIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlcy5oYXMocGF0aCkgfHwgdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGF0aCkpIHtcclxuICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICAvLyBDaGVjayBpZiBhbnkgYW5jZXN0b3IgRk9MREVSIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgIGxldCBjdXJyZW50ID0gcGF0aDtcclxuICAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09ICcvJykge1xyXG4gICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IGN1cnJlbnQuc3Vic3RyaW5nKDAsIGN1cnJlbnQubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhcmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEFuIGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IGN1cnJlbnQpIGJyZWFrOyAvLyBSZWFjaGVkIHJvb3Qgb3IgZXJyb3JcclxuICAgICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE5laXRoZXIgdGhlIHBhdGggbm9yIGFueSBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWQgZm9yIGV4Y2x1c2lvblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbWJpbmVzIGJ1aWxkaW5nIHRoZSB0cmVlIGRhdGEsIHJlbmRlcmluZyB0aGUgRE9NLCBhbmQgYXBwbHlpbmcgaW5pdGlhbCBhcHBlYXJhbmNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJ1aWxkQW5kUmVuZGVyVHJlZSgpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnQnVpbGRpbmcgYW5kIHJlbmRlcmluZyB0cmVlLi4uJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJUcmVlKCk7IC8vIEJ1aWxkIGRhdGEgYW5kIHJlbmRlciBET00gZWxlbWVudHNcclxuICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7IC8vIEFwcGx5IHN0eWxlcyBiYXNlZCBvbiBjdXJyZW50IG1vZGUvc2VsZWN0aW9uXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIGNsb3NlZC4gQ2xlYW5zIHVwIHJlc291cmNlcy5cclxuICAgICAqL1xyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICAvLyBHYXRoZXIgdGhlIGZpbmFsIHN0YXRlIE9OTFkgd2hlbiBPSyBpcyBjbGlja2VkXHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGZvbGRlcnM6IEFycmF5LmZyb20odGhpcy5jdXJyZW50Rm9sZGVycyksXHJcbiAgICAgICAgICAgIGZpbGVzOiBBcnJheS5mcm9tKHRoaXMuY3VycmVudEZpbGVzKSxcclxuICAgICAgICAgICAgbW9kZTogdGhpcy5jdXJyZW50TW9kZSxcclxuICAgICAgICAgICAgZGlzcGxheTogdGhpcy5jdXJyZW50RGlzcGxheSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiT0sgQ2xpY2tlZCAtIFJldHVybmluZyBSZXN1bHQ6XCIsIHJlc3VsdCk7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgIHRoaXMub2tDYWxsYmFjayhyZXN1bHQpOyAvLyBQYXNzIHRoZSBmaW5hbCBzZWxlY3Rpb24gYmFja1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciB0aGUgbW9kYWwncyBjb250ZW50XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuY2xlYXIoKTsgLy8gQ2xlYXIgdGhlIG5vZGUgbWFwIHRvIGZyZWUgbWVtb3J5XHJcbiAgICAgICAgdGhpcy5tb2RlRHJvcGRvd24gPSBudWxsOyAvLyBDbGVhciByZWZlcmVuY2VcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBlYXNpbHkgb3BlbiB0aGUgRGlyZWN0b3J5IFNlbGVjdGlvbiBNb2RhbC5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBpbml0aWFsRm9sZGVycyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmb2xkZXIgcGF0aHMuXHJcbiAqIEBwYXJhbSBpbml0aWFsRmlsZXMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZmlsZSBwYXRocy5cclxuICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICBhcHA6IEFwcCxcclxuICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgIGluaXRpYWxGaWxlczogc3RyaW5nW10sXHJcbiAgICBvcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zLFxyXG4gICAgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4pOiB2b2lkIHtcclxuICAgIC8vIENyZWF0ZSBhbmQgb3BlbiB0aGUgbW9kYWwgaW5zdGFuY2VcclxuICAgIG5ldyBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICBhcHAsXHJcbiAgICAgICAgaW5pdGlhbEZvbGRlcnMsXHJcbiAgICAgICAgaW5pdGlhbEZpbGVzLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgb2tDYWxsYmFja1xyXG4gICAgKS5vcGVuKCk7XHJcbn1cclxuXHJcbi8qXHJcbi8vIC0tLSBFeGFtcGxlIFVzYWdlIGluIHlvdXIgUGx1Z2luJ3MgU2V0dGluZ3MgVGFiIC0tLVxyXG4vLyAoUGxhY2UgdGhpcyBpbiB5b3VyIHNldHRpbmdzIHRhYiBmaWxlLCBlLmcuLCBzZXR0aW5ncy50cylcclxuXHJcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLCBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfSBmcm9tICcuL0RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXHJcbmltcG9ydCBZb3VyUGx1Z2luIGZyb20gJy4vbWFpbic7IC8vIEFkanVzdCBwYXRoIHRvIHlvdXIgbWFpbiBwbHVnaW4gZmlsZVxyXG5cclxuLy8gLS0tIEV4YW1wbGUgUGx1Z2luIFNldHRpbmdzIEludGVyZmFjZSAoaW4geW91ciBtYWluLnRzIG9yIHNldHRpbmdzIGZpbGUpIC0tLVxyXG5leHBvcnQgaW50ZXJmYWNlIFlvdXJQbHVnaW5TZXR0aW5ncyB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdO1xyXG4gICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW107XHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAvLyAuLi4gb3RoZXIgc2V0dGluZ3MgZm9yIHlvdXIgcGx1Z2luXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBZb3VyUGx1Z2luU2V0dGluZ3MgPSB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnZXhjbHVkZScsIC8vIERlZmF1bHQgbW9kZSBpcyBvZnRlbiAnZXhjbHVkZSdcclxuICAgIC8vIC4uLiBvdGhlciBkZWZhdWx0IHNldHRpbmdzXHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgWW91clBsdWdpblNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IFlvdXJQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogWW91clBsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnRWluc3RlbGx1bmdlbiBmXHUwMEZDciBNZWluIFBsdWdpbicgfSk7IC8vIFNldHRpbmdzIFRpdGxlIGluIEdlcm1hblxyXG5cclxuICAgICAgICAvLyAtLS0gQnV0dG9uIHRvIE9wZW4gdGhlIE1vZGFsIC0tLVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVmVyemVpY2huaXNzZS9EYXRlaWVuIGtvbmZpZ3VyaWVyZW4nKSAvLyBTZXR0aW5nIE5hbWUgaW4gR2VybWFuXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdLbGlja2UgYXVmIGRlbiBCdXR0b24sIHVtIGRpZSBBdXN3YWhsIHp1IGJlYXJiZWl0ZW4uJykgLy8gU2V0dGluZyBEZXNjcmlwdGlvbiBpbiBHZXJtYW5cclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0F1c3dhaGwgXHUwMEY2ZmZuZW4nKSAvLyBCdXR0b24gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgY3VycmVudCBzZXR0aW5ncyB0byBwcmUtcG9wdWxhdGUgdGhlIG1vZGFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGb2xkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgfHwgJ2V4Y2x1ZGUnOyAvLyBVc2UgZGVmYXVsdCBpZiBub3Qgc2V0XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBtb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGb2xkZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE1vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBva0NhbGxiYWNrIGZ1bmN0aW9uOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0F1c3dhaGwgYmVzdFx1MDBFNHRpZ3Q6JywgcmVzdWx0KTsgLy8gTG9nIHJlc3VsdCBpbiBHZXJtYW4gY29uc29sZVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAtLS0gSU1QT1JUQU5UOiBTYXZlIHRoZSByZXN1bHRzIGJhY2sgdG8geW91ciBwbHVnaW4gc2V0dGluZ3MgLS0tXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGaWxlcyA9IHJlc3VsdC5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3Rpb25Nb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IC8vIFBlcnNpc3QgdGhlIGNoYW5nZXNcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3B0aW9uYWxseSwgcmUtcmVuZGVyIHRoZSBzZXR0aW5ncyB0YWIgdG8gc2hvdyB0aGUgdXBkYXRlZCBzZWxlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmUtcmVuZGVyIHNldHRpbmdzIHRhYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIC8vIC0tLSBEaXNwbGF5IEN1cnJlbnQgU2VsZWN0aW9uIChSZWFkLW9ubHkpIC0tLVxyXG4gICAgICAgICBjb25zdCBzZWxlY3Rpb25JbmZvRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5ncy1zZWxlY3Rpb24taW5mbycgfSk7XHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdBa3R1ZWxsZSBBdXN3YWhsOicgfSk7IC8vIFNlY3Rpb24gVGl0bGUgaW4gR2VybWFuXHJcbiAgICAgICAgIGNvbnN0IG1vZGVUZXh0ID0gYE1vZHVzOiAke3RoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgfHwgJ05pY2h0IGZlc3RnZWxlZ3QnfWA7IC8vIFRleHQgaW4gR2VybWFuXHJcbiAgICAgICAgIC8vIFRydW5jYXRlIGxvbmcgbGlzdHMgZm9yIGRpc3BsYXkgaWYgbmVjZXNzYXJ5XHJcbiAgICAgICAgIGNvbnN0IGZvbGRlclRleHQgPSBgQXVzZ2V3XHUwMEU0aGx0ZSBPcmRuZXI6ICR7KHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVycz8ubGVuZ3RoIHx8IDApfSBTdFx1MDBGQ2NrYDsgLy8gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgY29uc3QgZmlsZVRleHQgPSBgQXVzZ2V3XHUwMEU0aGx0ZSBEYXRlaWVuOiAkeyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzPy5sZW5ndGggfHwgMCl9IFN0XHUwMEZDY2tgOyAvLyBUZXh0IGluIEdlcm1hblxyXG5cclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBtb2RlVGV4dCB9KTtcclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBmb2xkZXJUZXh0IH0pO1xyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGZpbGVUZXh0IH0pO1xyXG4gICAgICAgICAvLyBZb3UgY291bGQgYWRkIGEgc21hbGwgYnV0dG9uL2xpbmsgaGVyZSB0byB2aWV3IHRoZSBmdWxsIGxpc3QgaWYgaXQncyBsb25nXHJcbiAgICB9XHJcbn1cclxuKi9cclxuIiwgImltcG9ydCB7IERpcmVjdG9yeURpc3BsYXlNb2RlLCBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RlIH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7XHJcblxyXG5leHBvcnQgY29uc3QgdmVyc2lvblN0cmluZyA9IFwiMC4wLjE3XCI7XHJcblxyXG5leHBvcnQgdHlwZSBPYnNpZGlhblByb3BlcnR5VHlwZXMgPSBcImFsaWFzZXNcInxcImNoZWNrYm94XCJ8XCJkYXRlXCJ8XCJkYXRldGltZVwifFwibXVsdGl0ZXh0XCJ8XCJudW1iZXJcInxcInRhZ3NcInxcInRleHRcIjtcclxuZXhwb3J0IHR5cGUgRnJvbnRtYXR0ZXJBdXRvbWF0ZUV2ZW50cyA9ICdjcmVhdGUnIHwgJ3JlbmFtZScgfCAnYWN0aXZlLWxlYWYtY2hhbmdlJyB8ICdkZWxldGUnIHwgJ21vZGlmeScgfCAncHJldmlldycgfCAnYWxsJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRmlsdGVyRmlsZXNBbmRGb2xkZXJzIHtcclxuICAgIHNlbGVjdGVkRm9sZGVyczogc3RyaW5nW10sXHJcbiAgICBzZWxlY3RlZEZpbGVzOiBzdHJpbmdbXSxcclxuICAgIG1vZGU6IERpcmVjdG9yeVNlbGVjdGlvbk1vZGUsXHJcbiAgICBkaXNwbGF5OiBEaXJlY3RvcnlEaXNwbGF5TW9kZVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9GSUxURVJfRklMRVNfQU5EX0ZPTERFUlM6IEZpbHRlckZpbGVzQW5kRm9sZGVycyA9IHtcclxuICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICBzZWxlY3RlZEZpbGVzOiBbXSxcclxuICAgIG1vZGU6ICdleGNsdWRlJyxcclxuICAgIGRpc3BsYXk6ICdmb2xkZXJzJyxcclxufVxyXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRlclRhZ1NldHRpbmdzIHtcclxuICAgIHRhZ1ByZWZpeDogc3RyaW5nO1xyXG4gICAgZXhjbHVkZVJvb3RGb2xkZXI6IGJvb2xlYW47XHJcbiAgICB0YWdzUHJvcGVydHlOYW1lOiBzdHJpbmc7XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBsb3dlcmNhc2VUYWdzOiBib29sZWFuO1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICBydWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXTtcclxuICAgIGxpdmVSdWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXTtcclxuICAgIHVzZVRleHRBcmVhOiBib29sZWFuO1xyXG4gICAgZXhjbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgaW5jbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgY29uZmlndXJlZFByb3BlcnRpZXM6IEFycmF5PHsgbmFtZTogc3RyaW5nOyB2YWx1ZTogYW55IH0+O1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRm9sZGVyVGFnU2V0dGluZ3MgPSB7XHJcbiAgICB0YWdQcmVmaXg6ICcnLFxyXG4gICAgZXhjbHVkZVJvb3RGb2xkZXI6IGZhbHNlLFxyXG4gICAgdGFnc1Byb3BlcnR5TmFtZTogJ3RhZ3MnLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogJ18nLFxyXG4gICAgc3BlY2lhbENoYXJSZXBsYWNlbWVudDogJ18nLFxyXG4gICAgbG93ZXJjYXNlVGFnczogZmFsc2UsXHJcbiAgICBrbm93blByb3BlcnRpZXM6IFtdLFxyXG4gICAgcnVsZXM6IFtdLFxyXG4gICAgbGl2ZVJ1bGVzOiBbXSxcclxuICAgIHVzZVRleHRBcmVhOiBmYWxzZSxcclxuICAgIGV4Y2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgICAgIG1vZGU6ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVycycsXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXJzJyxcclxuICAgIH0sXHJcbiAgICBjb25maWd1cmVkUHJvcGVydGllczogW11cclxufTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGVyVGFnUnVsZURlZmluaXRpb24ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGFjdGl2ZTogYm9vbGVhbjtcclxuICAgIGFkZENvbnRlbnQ6ICdvdmVyd3JpdGUnIHwgJ3N0YXJ0JyB8ICdlbmQnO1xyXG4gICAgYXNMaW5rOiBib29sZWFuO1xyXG4gICAgcHJvcGVydHk6IHN0cmluZztcclxuICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuO1xyXG4gICAgY3VzdG9tUHJvcGVydHk6IHN0cmluZztcclxuICAgIHR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcztcclxuICAgIHR5cGVQcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZDtcclxuICAgIGNvbnRlbnQ6IHN0cmluZztcclxuICAgIGJ1aWxkSW5Db2RlOiBzdHJpbmc7XHJcbiAgICBqc0NvZGU6IHN0cmluZztcclxuICAgIHNob3dDb250ZW50OiBib29sZWFuO1xyXG4gICAgZXhjbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgaW5jbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgcHJlZml4OiBzdHJpbmc7XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBsb3dlcmNhc2VUYWdzOiBib29sZWFuO1xyXG4gICAgaW5wdXRQcm9wZXJ0eTogc3RyaW5nO1xyXG4gICAgb25seU1vZGlmeTogYm9vbGVhbjtcclxuICAgIHVzZUN1c3RvbUNvZGU6IGJvb2xlYW47XHJcbiAgICBvcHRpb25Db25maWc/Ont9O1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9SVUxFX0RFRklOSVRJT04gOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiA9IHtcclxuICAgIGlkOiAnJyxcclxuICAgIGFjdGl2ZSA6IHRydWUsXHJcbiAgICBhc0xpbms6IGZhbHNlLFxyXG4gICAgYWRkQ29udGVudDogJ292ZXJ3cml0ZScsXHJcbiAgICBwcm9wZXJ0eSA6ICcnLFxyXG4gICAgdmFsdWU6ICcnLFxyXG4gICAgY3VzdG9tUHJvcGVydHkgOiAnJyxcclxuICAgIHR5cGU6ICd0ZXh0JyxcclxuICAgIHR5cGVQcm9wZXJ0eToge25hbWU6JycsdHlwZTondGV4dCcsIHNvdXJjZToncmVnaXN0ZXJlZCd9LFxyXG4gICAgY29udGVudDogJycsXHJcbiAgICBidWlsZEluQ29kZTogJycsXHJcbiAgICBqc0NvZGU6ICcnLFxyXG4gICAgc2hvd0NvbnRlbnQ6IGZhbHNlLFxyXG4gICAgZXhjbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2V4Y2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXJzJyxcclxuICAgIH0sXHJcbiAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXJzOiBbXSxcclxuICAgICAgICBzZWxlY3RlZEZpbGVzOiBbXSxcclxuICAgICAgICBtb2RlOiAnaW5jbHVkZScsXHJcbiAgICAgICAgZGlzcGxheTogJ2ZvbGRlcnMnLFxyXG4gICAgfSxcclxuICAgIHByZWZpeDogJycsXHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiAnJyxcclxuICAgIHNwZWNpYWxDaGFyUmVwbGFjZW1lbnQ6ICcnLFxyXG4gICAgbG93ZXJjYXNlVGFnczogZmFsc2UsXHJcbiAgICBpbnB1dFByb3BlcnR5OiAnJyxcclxuICAgIG9ubHlNb2RpZnk6IHRydWUsXHJcbiAgICB1c2VDdXN0b21Db2RlOiBmYWxzZSxcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgUHJvcGVydHlJbmZvID0ge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzO1xyXG4gICAgY291bnQ/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBQcm9wZXJ0eVR5cGVJbmZvID0ge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgICAgIHR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcztcclxuICAgIGNvdW50PzogbnVtYmVyO1xyXG4gICAgaXNBcnJheT86IGJvb2xlYW47XHJcbiAgICB2YWx1ZXM/OiBzdHJpbmdbXTtcclxuICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnIHwgJ2luZmVycmVkJztcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFByb3BlcnR5VHlwZSA9IHtcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIGljb246IHN0cmluZztcclxuICAgIGpzVHlwZTogc3RyaW5nO1xyXG59OyIsICJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgRHJvcGRvd25Db21wb25lbnQsIFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBzZXRJY29uLCBhcGlWZXJzaW9uLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLCBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfSBmcm9tICcuL2RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJztcclxuaW1wb3J0IHsgdmVyc2lvblN0cmluZywgRm9sZGVyVGFnUnVsZURlZmluaXRpb24sIERFRkFVTFRfUlVMRV9ERUZJTklUSU9OLCBQcm9wZXJ0eVR5cGVJbmZvLCBPYnNpZGlhblByb3BlcnR5VHlwZXMsIERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTLCBQcm9wZXJ0eUluZm99IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBnZXRSdWxlRnVuY3Rpb25CeUlkLCB1c2VSdWxlT3B0aW9uLCBydWxlRnVuY3Rpb25zLCBSdWxlRnVuY3Rpb24sIGV4ZWN1dGVSdWxlLCBjaGVja0lmRmlsZUFsbG93ZWQgfSBmcm9tICcuL3J1bGVzJztcclxuaW1wb3J0IHsgQWxlcnRNb2RhbCB9IGZyb20gJy4vYWxlcnRCb3gnO1xyXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcclxuaW1wb3J0IHsgY29kZUVkaXRvck1vZGFsLCBjb2RlRWRpdG9yTW9kYWxSZXN1bHQsIG9wZW5Db2RlRWRpdG9yTW9kYWwgfSBmcm9tICcuL2VkaXRvck1vZGFsJztcclxuaW1wb3J0IHsgY29weUZpbGVTeW5jIH0gZnJvbSAnZnMnO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vdG9vbHMnO1xyXG5pbXBvcnQgeyB1cGRhdGVQcm9wZXJ0eUljb24gfSBmcm9tICcuL3VpRWxlbWVudHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJ1bGVzVGFibGUgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogYW55O1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eUluZm8+ID0ge307IFxyXG4gICAgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcclxuICAgIHByb3BlcnRpZXNMaXN0RWw6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgc2V0dGluZ3NQYXJhbWV0ZXI6IHN0cmluZztcclxuICAgIHRvb2xzOiBTY3JpcHRpbmdUb29scztcclxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogYW55LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBzZXR0aW5nc1BhcmFtZXRlcjogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3NQYXJhbWV0ZXIgPSBzZXR0aW5nc1BhcmFtZXRlcjtcclxuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBIZWxwZXIgdG8gcmVuZGVyIG9uZSBydWxlXHJcblxyXG4gICAgcmVuZGVyUHJvcGVydHlSb3coY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBydWxlOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgY29uc3QgcnVsZUZuID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZChydWxlLmNvbnRlbnQpO1xyXG5cclxuICAgICAgICBjb25zdCByb3dFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXNldHRpbmctcm93IHNldHRpbmctaXRlbScgfSk7XHJcbiAgICAgICAgcm93RWwuaWQgPSBydWxlLmlkO1xyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xFbCA9IHJvd0VsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmctaXRlbS1jb250cm9sJyB9KTsgXHJcbiAgICAgICAgY29udHJvbEVsLnN0eWxlLmdhcCA9ICcwcHgnO1xyXG4gICAgICAgIGNvbnN0IGxlZnRDb250YWluZXIgPSBjb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktbGVmdC1jb250YWluZXInIH0pO1xyXG4gICAgICAgIGNvbnN0IGljb25FbCA9IGxlZnRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ3Byb3BlcnR5LWljb24gc2V0dGluZy1pdGVtLWljb24nIH0pOyBcclxuICAgICAgICBzZXRJY29uKGljb25FbCwgJ2hhc2gnKTsgLy8gU3RhbmRhcmQtSWNvblxyXG5cclxuXHJcbiAgICAgICAgY29uc3Qgc2VhcmNoQ29udGFpbmVyID0gbGVmdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1zZWFyY2gtY29udGFpbmVyJyB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbmFtZUlucHV0ID0gbmV3IFRleHRDb21wb25lbnQoc2VhcmNoQ29udGFpbmVyKVxyXG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1NlbGVjdCBwcm9wZXJ0eS4uLicpXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZShydWxlLnByb3BlcnR5IHx8ICcnKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyLCB2YWx1ZSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7IC8vIG1ha2UgaXQgaW52aXNpYmxlXHJcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXIsIG5hbWVJbnB1dC5nZXRWYWx1ZSgpLCBpbmRleCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXIsIG5hbWVJbnB1dC5nZXRWYWx1ZSgpLCBpbmRleCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRUYXJnZXQgPSBldmVudC5yZWxhdGVkVGFyZ2V0IGFzIE5vZGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRzRWwgPSBzZWFyY2hDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LXNlYXJjaC1yZXN1bHRzJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdHNFbCB8fCAhcmVzdWx0c0VsLmNvbnRhaW5zKHJlbGF0ZWRUYXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY3VycmVudFByb3BlcnR5SW5mbyA9IHRoaXMua25vd25Qcm9wZXJ0aWVzW3J1bGUucHJvcGVydHldO1xyXG4gICAgICAgIGlmIChjdXJyZW50UHJvcGVydHlJbmZvKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVByb3BlcnR5SWNvbihpY29uRWwsIGN1cnJlbnRQcm9wZXJ0eUluZm8udHlwZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChydWxlLnByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHNldEljb24oaWNvbkVsLCAnYWxlcnQtY2lyY2xlJyk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbWlkZGxlQ29udGFpbmVyID0gY29udHJvbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LW1pZGRsZS1jb250YWluZXInIH0pO1xyXG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gbWlkZGxlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXZhbHVlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlRmlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIodGhpcy5hY3RpdmVGaWxlLCBhc3luYyAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHJ1bGUudmFsdWUgPSBhd2FpdCBleGVjdXRlUnVsZSgncHJldmlldycsdGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLCB0aGlzLmFjdGl2ZUZpbGUsICcnLCBydWxlLCBmcm9udG1hdHRlcik7XHJcbiAgICAgICAgICAgIH0seydtdGltZSc6dGhpcy5hY3RpdmVGaWxlLnN0YXQubXRpbWV9KTsgLy8gZG8gbm90IGNoYW5nZSB0aGUgbW9kaWZ5IHRpbWUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByZXZpZXdDb21wb25lbnQgPSB0aGlzLnJlbmRlclZhbHVlSW5wdXQodmFsdWVDb250YWluZXIsIGN1cnJlbnRQcm9wZXJ0eUluZm8sIHJ1bGUudmFsdWUsIGluZGV4KTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvcGVydHlEZXZEcm9wZG93biA9ICBuZXcgRHJvcGRvd25Db21wb25lbnQobWlkZGxlQ29udGFpbmVyKTtcclxuICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLnNlbGVjdEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDozNSUnKTtcclxuICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLmFkZE9wdGlvbihcIlwiLCBcIlNlbGVjdCBhIGNvbnRlbnRcIik7XHJcbiAgICAgICAgZm9yIChsZXQgcnVsZUZ1bmN0aW9uIG9mIHJ1bGVGdW5jdGlvbnMpIHtcclxuICAgICAgICAgICAgaWYgKHJ1bGVGdW5jdGlvbi50eXBlLmNvbnRhaW5zKHJ1bGUudHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5RGV2RHJvcGRvd24uYWRkT3B0aW9uKHJ1bGVGdW5jdGlvbi5pZCwgcnVsZUZ1bmN0aW9uLmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLmFkZE9wdGlvbihcInNjcmlwdFwiLCBcIkphdmFTY3JpcHQgZnVuY3Rpb24gKGFkdmFuY2VkKVwiKTtcclxuICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLnNldFZhbHVlKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgcHJvcGVydHlEZXZEcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcnVsZUZ1bmN0aW9uID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHJ1bGVGdW5jdGlvbj8ucnVsZVR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdzY3JpcHQnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2xkT3JpZ2luYWxDb2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChydWxlLmJ1aWxkSW5Db2RlICE9PSAnJykgJiYgKHJ1bGUuYnVpbGRJbkNvZGUgIT09IG9sZE9yaWdpbmFsQ29kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZFByb2NlZWQgPSBhd2FpdCBuZXcgQWxlcnRNb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdPdmVyd3JpdGUgZXhpc3RpbmcgY29kZT8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSSBzZWVzIGxpa2UgeW91IGhhdmUgY3VzdG9tIGNvZGUgZm9yIHRoaXMgcnVsZSEgU2hvdWxkIHRoaXMgYmUgb3ZlcndyaXR0ZW4gYnkgZGVmYXVsdCBjb2RlIGZvciB0aGlzIHBhcmFtZXRlcj8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWWVzJywgJ05vJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkub3BlbkFuZEdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRQcm9jZWVkLnByb2NlZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmJ1aWxkSW5Db2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnVzZUN1c3RvbUNvZGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZTsgLy8ga2VlcCB0aGUgZXhpc3RpbmcgY29kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmJ1aWxkSW5Db2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudXNlQ3VzdG9tQ29kZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRJbic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHZhbHVlKT8uc291cmNlIHx8IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLnVzZUN1c3RvbUNvZGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1dG9jb21wbGV0ZS5tb2RhbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJ1bGUuaXNMaXZlUnVsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydWxlLmNvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIC8vcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheSA9IGAkeyhydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSA/ICdmbGV4JyA6ICdub25lJ31gO1xyXG4gICAgICAgICAgICAgICAgLy9zaG93SnNGdW5jdGlvbkJ1dHRvbihydWxlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChtaWRkbGVDb250YWluZXIpXHJcbiAgICAgICAgLnNldEljb24oJ2dlYXInKVxyXG4gICAgICAgIC5zZXRUb29sdGlwKCdvcGVuIHNldHRpbmdzJylcclxuICAgICAgICAuc2V0Q2xhc3MoJ3Byb3BlcnR5LWljb24tYnV0dG9uJylcclxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzZXR0aW5nc0NvbnRhaW5lcnMgPSBjb250YWluZXJFbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9wZXJ0eS1vcHRpb25zLWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb250YWluZXIgb2Ygc2V0dGluZ3NDb250YWluZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gcnVsZS5pZCkgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdkaXNwbGF5OiBub25lOycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wdGlvbkVMLnN0eWxlLmRpc3BsYXkgPSBvcHRpb25FTC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snID8gJ25vbmUnIDogJ2Jsb2NrJztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gLS0tIHJpZ2h0IHBhcnQ6IGVyYXNlIHJ1bGUgLS0tXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uQ29udGFpbmVyID0gY29udHJvbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LWRlbGV0ZS1idXR0b24tY29udGFpbmVyJyB9KTtcclxuICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGRlbGV0ZUJ1dHRvbkNvbnRhaW5lcilcclxuICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoLTInKVxyXG4gICAgICAgICAgICAuc2V0VG9vbHRpcCgncmVtb3ZlIHRoaXMgcnVsZScpXHJcbiAgICAgICAgICAgIC5zZXRDbGFzcygnbW9kLXN1YnRsZScpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXIgdGhlIHNldHRpbmdzIHRhYlxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29udHJvbEVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgY29udHJvbEVsLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcclxuICAgICAgICBjb250cm9sRWwuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnc3BhY2UtYmV0d2Vlbic7XHJcbiAgICAgICAgY29udHJvbEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG5cclxuICAgICAgICBsZWZ0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgbGVmdENvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XHJcbiAgICAgICAgbGVmdENvbnRhaW5lci5zdHlsZS5taW5XaWR0aCA9ICcxNTBweCc7IFxyXG4gICAgICAgIGljb25FbC5zdHlsZS5tYXJnaW5SaWdodCA9ICc4cHgnO1xyXG5cclxuICAgICAgICBzZWFyY2hDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOyBcclxuICAgICAgICBzZWFyY2hDb250YWluZXIuc3R5bGUuZmxleEdyb3cgPSAnMSc7XHJcblxyXG4gICAgICAgIHZhbHVlQ29udGFpbmVyLnN0eWxlLmZsZXhHcm93ID0gJzInOyBcclxuXHJcbiAgICAgICAgZGVsZXRlQnV0dG9uQ29udGFpbmVyLnN0eWxlLm1hcmdpbkxlZnQgPSAnYXV0byc7IFxyXG5cclxuICAgICAgICBjb25zdCBvcHRpb25FTCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LW9wdGlvbnMtY29udGFpbmVyJyB9KTsgLy8gb3B0aW9ucyBjb250YWluZXJcclxuICAgICAgICBvcHRpb25FTC5pZCA9IHJ1bGUuaWQ7XHJcbiAgICAgICAgb3B0aW9uRUwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICBpZiAodXNlUnVsZU9wdGlvbihydWxlRm4sJ3JlbW92ZUNvbnRlbnQnKSkge1xyXG4gICAgICAgICAgICBjb25zdCByZW1vdmVDb250ZW50QnV0dG9uID0gbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIGNvbnRlbnQnKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoYEJlZm9yZSBtYWtpbmcgY2hhbmdlcyB5b3UgbWlnaHQgY29uc2lkZXIgdG8gcmVtb3ZlIGNvbnRlbnQgZ2VuZXJhdGVkIGJ5IHRoaXMgcnVsZWApXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRXYXJuaW5nKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1JlbW92ZSBDb250ZW50JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvdW50ID0gdGhpcy5wbHVnaW4ucmVtb3ZlRnJvbnRtYXR0ZXJQYXJhbXNGcm9tQWxsRmlsZXMocnVsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQ3RhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDb250ZW50QnV0dG9uLnNldERlc2MoYFJlbW92ZWQgdGhpcyBydWxlIGZyb20gJHtjb3VudC5maWxlc30gZmlsZXMuYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHVzZVJ1bGVPcHRpb24ocnVsZUZuLCdydWxlQWN0aXZlJykpIHtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUnVsZSBhY3RpdmUnKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZWQsIHRoZSBydWxlIHdpbGwgYmUgZXhlY3V0ZWQnKVxyXG4gICAgICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHJ1bGUuYWN0aXZlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5hY3RpdmUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh1c2VSdWxlT3B0aW9uKHJ1bGVGbiwnbW9kaWZ5T25seScpKSB7XHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnTW9kaWZ5IG9ubHknKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnT25seSBtb2RpZnkgZXhpc3RpbmcgcHJvcGVydGllcycpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHJ1bGUub25seU1vZGlmeSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBydWxlLm9ubHlNb2RpZnkgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChydWxlLnR5cGUgPT09ICd0ZXh0JyB8fCBydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgIGlmICh1c2VSdWxlT3B0aW9uKHJ1bGVGbiwnaW5wdXRQcm9wZXJ0eScpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBydWxlRnVuY3Rpb24gPSBydWxlRnVuY3Rpb25zLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09PSBydWxlLmNvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICBpZiAocnVsZUZ1bmN0aW9uICYmIHJ1bGVGdW5jdGlvbi5pbnB1dFByb3BlcnR5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5wdXRQcm9wZXJ0aWVzRHJvcGRvd247XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXROYW1lKCdJbnB1dCBQcm9wZXJ0eScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXREZXNjKCdTZWxlY3QgYSBwcm9wZXJ0eSBhcyBpbnB1dCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BlcnRpZXNEcm9wZG93biA9IGRyb3Bkb3duO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShydWxlLmFkZENvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmlucHV0UHJvcGVydHkgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLmtub3duUHJvcGVydGllcykuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wZXJ0aWVzRHJvcGRvd24uYWRkT3B0aW9uKGl0ZW1bMV0ubmFtZSxpdGVtWzFdLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wZXJ0aWVzRHJvcGRvd24uc2V0VmFsdWUocnVsZS5pbnB1dFByb3BlcnR5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodXNlUnVsZU9wdGlvbihydWxlRm4sJ2FkZFByZWZpeCcpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUHJlZml4JylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGVzYygnT3B0aW9uYWwgcHJlZml4IHRvIGFkZCBiZWZvcmUgdGhlIGNvbnRlbnQgKGkuZS4gXCJwcmVmaXgvXCIpJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdubyBwcmVmaXgnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5wcmVmaXgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUucHJlZml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh1c2VSdWxlT3B0aW9uKHJ1bGVGbiwnc3BhY2VSZXBsYWNlbWVudCcpKSB7XHJcbiAgICAgICAgICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0TmFtZSgnU3BhY2UgcmVwbGFjZW1lbnQnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXREZXNjKCdDaGFyYWN0ZXIgdG8gcmVwbGFjZSBzcGFjZXMgaW4gZm9sZGVyIG5hbWVzIChzdWdnZXN0ZWQ6IFwiX1wiKScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignbm8gcmVwbGFjZW1lbnQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5zcGFjZVJlcGxhY2VtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnNwYWNlUmVwbGFjZW1lbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHVzZVJ1bGVPcHRpb24ocnVsZUZuLCdzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQnKSkge1xyXG4gICAgICAgICAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldE5hbWUoJ1NwZWNpYWwgY2hhcmFjdGVyIHJlcGxhY2VtZW50JylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChzdWdnZXN0ZWQ6IFwiLVwiKSAtIHByZXNlcnZlcyBsZXR0ZXJzIHdpdGggZGlhY3JpdGljcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignbm8gcmVwbGFjZW1lbnQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5zcGVjaWFsQ2hhclJlcGxhY2VtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHVzZVJ1bGVPcHRpb24ocnVsZUZuLCdjb252ZXJ0VG9Mb3dlckNhc2UnKSkge1xyXG4gICAgICAgICAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldE5hbWUoJ0NvbnZlcnQgdG8gbG93ZXJjYXNlJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGVzYygnQ29udmVydCB2YWx1ZXMgdG8gbG93ZXJjYXNlJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHJ1bGUubG93ZXJjYXNlVGFncylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5sb3dlcmNhc2VUYWdzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh1c2VSdWxlT3B0aW9uKHJ1bGVGbiwncmVzdWx0QXNMaW5rJykpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXROYW1lKCdSZXN1bHQgYXMgTGluaycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERlc2MoJ0Zvcm1hdCBSZXN1bHQgYXMgTGluaycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShydWxlLmFzTGluaylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5hc0xpbmsgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ3RleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgaWYgKHVzZVJ1bGVPcHRpb24ocnVsZUZuLCdhZGRDb250ZW50JykpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXROYW1lKCdBZGQgY29udGVudCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERlc2MoJ3NlbGVjdCBob3cgdGhlIGNvbnRlbnQgc2hvdWxkIGJlIHN0b3JlZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oXCJvdmVyd3JpdGVcIiwgXCJyZXBsYWNlIGNvbnRlbnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcInN0YXJ0XCIsIFwicGxhY2Ugb24gc3RhcnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcImVuZFwiLCBcInBsYWNlIG9uIGVuZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5hZGRDb250ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5hZGRDb250ZW50ID0gdmFsdWUgPT09ICdvdmVyd3JpdGUnID8gJ292ZXJ3cml0ZScgOiB2YWx1ZSA9PT0gJ3N0YXJ0JyA/ICdzdGFydCcgOiAnZW5kJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXNlUnVsZU9wdGlvbihydWxlRm4sJ2V4Y2x1ZGVGb2xkZXJzJykpIHtcclxuICAgICAgICAgICAgY29uc3QgZXhjbHVkZUVMID0gbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZSBGaWxlcyBhbmQgRm9sZGVycyBmcm9tIHRoaXMgcnVsZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoIHx8IDB9IGZvbGRlcnMgYW5kICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZpbGVzLmxlbmd0aCB8fCAwfSBmaWxlcyB3aWxsIGJlICR7cnVsZS5leGNsdWRlPy5tb2RlIHx8ICdleGNsdWRlJ31kLmApXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXIteCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdFeGNsdWRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZT8uc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZT8uc2VsZWN0ZWRGaWxlcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiAnZXhjbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiBydWxlLmV4Y2x1ZGU/LmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2hvd0ZpbGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJ1bGUuZXhjbHVkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5leGNsdWRlPU9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZSA6ICdleGNsdWRlJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5leGNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZS5tb2RlID0gJ2V4Y2x1ZGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmV4Y2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocnVsZS5leGNsdWRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGaWx0ZXJJbmRpY2F0b3IodGhpcy5hY3RpdmVGaWxlLCB0aGlzLnByb3BlcnRpZXNMaXN0RWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlRUwuc2V0RGVzYyhgQ3VycmVudGx5ICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoIHx8IDB9IGZvbGRlcnMgYW5kICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZpbGVzLmxlbmd0aCB8fCAwfSBmaWxlcyB3aWxsIGJlICR7cnVsZS5leGNsdWRlPy5tb2RlIHx8ICdleGNsdWRlJ31kLmApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTsgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHVzZVJ1bGVPcHRpb24ocnVsZUZuLCdpbmNsdWRlRm9sZGVycycpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluY2x1ZGVFTCA9IG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgRmlsZXMgYW5kIEZvbGRlcnMgZm9yIHRoaXMgcnVsZSAnKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoYEN1cnJlbnRseSAke3J1bGUuaW5jbHVkZT8uc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aCB8fCAwfSBmb2xkZXJzIGFuZCAke3J1bGUuaW5jbHVkZT8uc2VsZWN0ZWRGaWxlcy5sZW5ndGggfHwgMH0gZmlsZXMgd2lsbCBiZSAke3J1bGUuaW5jbHVkZT8ubW9kZSB8fCAnaW5jbHVkZSd9ZCBldmVuIGlmIHRoZXkgYXJlIGV4Y2x1ZGVkIGdsb2JhbGx5LmApXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2ZvbGRlci1jaGVjaycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKSAvLyBNYWtlcyB0aGUgYnV0dG9uIG1vcmUgcHJvbWluZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZT8uc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU1vZGU6IHJ1bGUuaW5jbHVkZT8uZGlzcGxheSB8fCAnZm9sZGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2VsZWN0aW9uTW9kZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2hvd0ZpbGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcnVsZS5pbmNsdWRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZSA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlIDogJ2luY2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcyA9IHJlc3VsdC5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmluY2x1ZGUubW9kZSA9ICdpbmNsdWRlJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmluY2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJ1bGUuaW5jbHVkZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGaWx0ZXJJbmRpY2F0b3IodGhpcy5hY3RpdmVGaWxlLCB0aGlzLnByb3BlcnRpZXNMaXN0RWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVFTC5zZXREZXNjKGBDdXJyZW50bHkgJHtydWxlLmluY2x1ZGU/LnNlbGVjdGVkRm9sZGVycy5sZW5ndGggfHwgMH0gZm9sZGVycyBhbmQgJHtydWxlLmluY2x1ZGU/LnNlbGVjdGVkRmlsZXMubGVuZ3RoIHx8IDB9IGZpbGVzIHdpbGwgYmUgJHtydWxlLmluY2x1ZGU/Lm1vZGUgfHwgJ2luY2x1ZGUnfWQuYClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IFxyXG4gICAgICAgIH0gICAgICBcclxuICAgICAgICBpZiAodXNlUnVsZU9wdGlvbihydWxlRm4sJ3NjcmlwdCcpKSB7XHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1NjcmlwdCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnZWRpdCB0aGUgc2NyaXB0IGZvciBvd24gbW9kaWZpY2F0aW9ucycpXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7IGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdKUyBFZGl0b3InKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkNvZGVFZGl0b3JNb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnID8gcnVsZS5qc0NvZGUgOiBydWxlLmJ1aWxkSW5Db2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS50eXBlUHJvcGVydHk/LnR5cGUgfHwgJ3RleHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWxlID8gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5hY3RpdmVGaWxlKT8uZnJvbnRtYXR0ZXIgfHwge30gOiB7fSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IGNvZGVFZGl0b3JNb2RhbFJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuanNDb2RlID0gcmVzdWx0LmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudXNlQ3VzdG9tQ29kZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSByZXN1bHQuY29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS51c2VDdXN0b21Db2RlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEN0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUudXNlQ3VzdG9tQ29kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0Q3RhKCk7IC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQ3RhKCk7IC8vIE1ha2VzIHRoZSBidXR0b24gbGVzcyBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJ1bGVGdW5jdGlvbiA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZS5jb250ZW50KTtcclxuICAgICAgICAgICAgaWYgKHJ1bGVGdW5jdGlvbiAmJiB0eXBlb2YgcnVsZUZ1bmN0aW9uLmNvbmZpZ1RhYiA9PT0nZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBydWxlRnVuY3Rpb24uY29uZmlnVGFiKG9wdGlvbkVMLCBydWxlLCB0aGlzLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldE9wdGlvbkNvbmZpZyhydWxlSWQ6c3RyaW5nLHByb3BlcnR5SWQ6c3RyaW5nKXtcclxuICAgICAgICBjb25zdCBydWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZmluZCgocnVsZTogRm9sZGVyVGFnUnVsZURlZmluaXRpb24pID0+IHJ1bGUuaWQgPT09IHJ1bGVJZCk7XHJcbiAgICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICAgICAgY29uc3Qgb3B0aW9uQ29uZmlnID0gcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbkNvbmZpZ1twcm9wZXJ0eUlkXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZ1twcm9wZXJ0eUlkXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHNldE9wdGlvbkNvbmZpZyhydWxlSWQ6c3RyaW5nLHByb3BlcnR5SWQ6c3RyaW5nLGNvbmZpZzphbnkpe1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5maW5kKChydWxlOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbikgPT4gcnVsZS5pZCA9PT0gcnVsZUlkKTtcclxuICAgICAgICBpZiAocnVsZSkge1xyXG4gICAgICAgICAgICBpZiAoIXJ1bGUub3B0aW9uc0NvbmZpZykgcnVsZS5vcHRpb25zQ29uZmlnID0ge31cclxuICAgICAgICAgICAgaWYgKCFydWxlLm9wdGlvbnNDb25maWdbcnVsZUlkXSkgcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF0gPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdW3Byb3BlcnR5SWRdID0gY29uZmlnO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0T3B0aW9uQ29uZmlnRGVmYXVsdHMocnVsZUlkOnN0cmluZywgZGVmYXVsdHM6YW55KXtcclxuICAgICAgICBjb25zdCBydWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZmluZCgocnVsZTogRm9sZGVyVGFnUnVsZURlZmluaXRpb24pID0+IHJ1bGUuaWQgPT09IHJ1bGVJZCk7XHJcbiAgICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICAgICAgaWYgKCFydWxlLm9wdGlvbnNDb25maWcpIHJ1bGUub3B0aW9uc0NvbmZpZyA9IHt9XHJcbiAgICAgICAgICAgIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMsIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdIHx8IHt9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBzZWFyY2hUZXJtOiBzdHJpbmcsIHJvd0luZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNsZWFyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXJFbCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkUHJvcGVydGllcyA9IE9iamVjdC5lbnRyaWVzKHRoaXMua25vd25Qcm9wZXJ0aWVzKVxyXG4gICAgICAgICAgICAuZmlsdGVyKChbbmFtZV0pID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpKTtcclxuXHJcbiAgICAgICAgaWYgKGZpbHRlcmVkUHJvcGVydGllcy5sZW5ndGggPT09IDAgJiYgc2VhcmNoVGVybSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmaWx0ZXJlZFByb3BlcnRpZXMubGVuZ3RoID09PSAwICYmICFzZWFyY2hUZXJtKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHNFbCA9IHNlYXJjaENvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXNlYXJjaC1yZXN1bHRzIG1lbnUnIH0pO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcbiAgICAgICAgcmVzdWx0c0VsLnN0eWxlLnRvcCA9ICcxMDAlJztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUubGVmdCA9ICcwJztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUud2lkdGggPSAnY2FsYygxMDAlICsgMTAwcHgpJztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUuekluZGV4ID0gJzEwJztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUubWF4SGVpZ2h0ID0gJzIwMHB4JztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xyXG5cclxuICAgICAgICBsZXQgYWN0aXZlSW5kZXggPSAtMTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlQWN0aXZlSXRlbSA9IChuZXdJbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gcmVzdWx0c0VsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51LWl0ZW0nKTtcclxuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gbmV3SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmFkZENsYXNzKCdwcm9wZXJ0eS1zZWFyY2gtaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zY3JvbGxJbnRvVmlldyh7IGJsb2NrOiAnbmVhcmVzdCcgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVtb3ZlQ2xhc3MoJ3Byb3BlcnR5LXNlYXJjaC1pcy1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFjdGl2ZUluZGV4ID0gbmV3SW5kZXg7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0QWN0aXZlSXRlbSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZUluZGV4ID49IDAgJiYgYWN0aXZlSW5kZXggPCBmaWx0ZXJlZFByb3BlcnRpZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbbmFtZSwgaW5mb10gPSBmaWx0ZXJlZFByb3BlcnRpZXNbYWN0aXZlSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1bcm93SW5kZXhdLnByb3BlcnR5ID0gbmFtZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW3Jvd0luZGV4XS50eXBlID0gaW5mby50eXBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1bcm93SW5kZXhdLnZhbHVlID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXJFbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmUtcmVuZGVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmaWx0ZXJlZFByb3BlcnRpZXMuZm9yRWFjaCgoW25hbWUsIGluZm9dLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtRWwgPSByZXN1bHRzRWwuY3JlYXRlRGl2KHsgY2xzOiAnbWVudS1pdGVtJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgaXRlbUljb24gPSBpdGVtRWwuY3JlYXRlU3Bhbih7IGNsczogJ21lbnUtaXRlbS1pY29uJyB9KTtcclxuICAgICAgICAgICAgdXBkYXRlUHJvcGVydHlJY29uKGl0ZW1JY29uLCBpbmZvLnR5cGUpO1xyXG4gICAgICAgICAgICBpdGVtRWwuY3JlYXRlU3Bhbih7IHRleHQ6IG5hbWUgfSk7XHJcblxyXG4gICAgICAgICAgICBpdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxlY3RBY3RpdmVJdGVtKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZWFyY2hDb250YWluZXJFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSByZXN1bHRzRWwucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpO1xyXG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdBcnJvd0Rvd24nKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVBY3RpdmVJdGVtKChhY3RpdmVJbmRleCArIDEpICUgaXRlbXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93VXAnKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVBY3RpdmVJdGVtKChhY3RpdmVJbmRleCAtIDEgKyBpdGVtcy5sZW5ndGgpICUgaXRlbXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZWN0QWN0aXZlSXRlbSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJTZWFyY2hSZXN1bHRzKHNlYXJjaENvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHNFbCA9IHNlYXJjaENvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5wcm9wZXJ0eS1zZWFyY2gtcmVzdWx0cycpO1xyXG4gICAgICAgIGlmIChyZXN1bHRzRWwpIHtcclxuICAgICAgICAgICAgcmVzdWx0c0VsLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJWYWx1ZUlucHV0KGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcHJvcGVydHlJbmZvOiBQcm9wZXJ0eUluZm8gfCB1bmRlZmluZWQsIGN1cnJlbnRWYWx1ZTogYW55LCBpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IHJldHVybkNvbXBvbmVudDtcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpOyBcclxuXHJcbiAgICAgICAgaWYgKCFwcm9wZXJ0eUluZm8pIHtcclxuICAgICAgICAgICAgIGNvbnRhaW5lckVsLnNldFRleHQoJycpO1xyXG4gICAgICAgICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3RleHQtbXV0ZWQnKTtcclxuICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHR5cGUgPSBwcm9wZXJ0eUluZm8udHlwZTtcclxuXHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ051bWVyaWMgVmFsdWUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50VmFsdWUgIT09IG51bGwgPyBTdHJpbmcoY3VycmVudFZhbHVlKSA6ICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtVmFsdWUgPSB2YWx1ZSA9PT0gJycgPyB1bmRlZmluZWQgOiBwYXJzZUZsb2F0KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gaXNOYU4obnVtVmFsdWUgYXMgbnVtYmVyKSA/IHVuZGVmaW5lZCA6IG51bVZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnbnVtYmVyJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0cmktc3RhdGUtY2hlY2tib3ggY2xpY2thYmxlLWljb24nIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDaGVja2JveCBjaGFuZ2Ugc3RhdGUnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnY2hlY2tib3gnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVDaGVja2JveFZpc3VhbCA9IChzdGF0ZTogYm9vbGVhbiB8IHVuZGVmaW5lZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpY29uTmFtZTogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhcmlhU3RhdGU6ICd0cnVlJyB8ICdmYWxzZScgfCAnbWl4ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdjaGVjay1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhU3RhdGUgPSAndHJ1ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbk5hbWUgPSAnc3F1YXJlJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYVN0YXRlID0gJ2ZhbHNlJztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyB1bmRlZmluZWQgb3IgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdtaW51cy1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhU3RhdGUgPSAnbWl4ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKHJldHVybkNvbXBvbmVudCwgaWNvbk5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsIGFyaWFTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGUgPSBTdHJpbmcoc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVDaGVja2JveFZpc3VhbChjdXJyZW50VmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudFN0YXRlID0gcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRTdGF0ZTogYm9vbGVhbiB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFN0YXRlID09PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gdW5kZWZpbmVkOyBcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gZmFsc2U7IFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gbmV4dFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDaGVja2JveFZpc3VhbChuZXh0U3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2RhdGUnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZWVlZLU1NLUREJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudFZhbHVlIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnZGF0ZSc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZWVlZLU1NLUREVEhIOm1tJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudFZhbHVlIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnZGF0ZXRpbWUtbG9jYWwnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2FsaWFzZXMnOlxyXG4gICAgICAgICAgICBjYXNlICd0YWdzJzpcclxuICAgICAgICAgICAgY2FzZSAnbXVsdGl0ZXh0JzpcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndmFsdWVzIChkaXZpZGVkIGJ5IGNvbW1hKScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKEFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSA/IGN1cnJlbnRWYWx1ZS5qb2luKCcsICcpIDogKGN1cnJlbnRWYWx1ZSB8fCAnJykpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnJheVZhbHVlID0gdmFsdWUuc3BsaXQoJywnKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW2luZGV4XS52YWx1ZSA9IGFycmF5VmFsdWUubGVuZ3RoID4gMCA/IGFycmF5VmFsdWUgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd2YWx1ZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKGN1cnJlbnRWYWx1ZSB8fCAnJylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW2luZGV4XS52YWx1ZSA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlICE9PSAnY2hlY2tib3gnKSB7XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd0cmFuc3BhcmVudCc7IC8vIG1ha2UgaXQgaW52aXNpYmxlXHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXR1cm5Db21wb25lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdXBkYXRlUHJldmlldyggcnVsZSwgcHJldmlld0NvbXBvbmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUZpbGUpIHtcclxuICAgICAgICAgICAgbGV0IHJ1bGVSZXN1bHQ7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcih0aGlzLmFjdGl2ZUZpbGUsIGFzeW5jIChmcm9udG1hdHRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcnVsZVJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVSdWxlKCdwcmV2aWV3Jyx0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MsIHRoaXMuYWN0aXZlRmlsZSwgJycsIHJ1bGUsIGZyb250bWF0dGVyKTtcclxuICAgICAgICAgICAgfSx7J210aW1lJzp0aGlzLmFjdGl2ZUZpbGUuc3RhdC5tdGltZX0pOyAgXHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiBydWxlUmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdvYmplY3QnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJ1bGVSZXN1bHQpKSBwcmV2aWV3Q29tcG9uZW50LmlucHV0RWwudmFsdWUgPSBydWxlUmVzdWx0LnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdDb21wb25lbnQuaW5wdXRFbC52YWx1ZSA9IHJ1bGVSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGNvbXBvbmVudEVsLnNldFRvb2x0aXAoY29tcG9uZW50RWwudmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgYXN5bmMgZGlzcGxheSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIHRoaXMua25vd25Qcm9wZXJ0aWVzID0gYXdhaXQgdGhpcy50b29scy5mZXRjaEtub3duUHJvcGVydGllcyh0aGlzLmFwcCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzTGlzdEVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdwcm9wZXJ0aWVzLWxpc3QnKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZm9yRWFjaCgocnVsZSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9wZXJ0eVJvdyh0aGlzLnByb3BlcnRpZXNMaXN0RWwsIHJ1bGUsIGluZGV4KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlRmlsdGVySW5kaWNhdG9yKGFjdGl2ZUZpbGUsIHRoaXMucHJvcGVydGllc0xpc3RFbCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGFkZEJ0bkNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmctaXRlbS1jb250cm9sJyB9KTtcclxuICAgICAgICBhZGRCdG5Db250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAncmlnaHQnO1xyXG4gICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQoYWRkQnRuQ29udGFpbmVyKVxyXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQWRkIFByb3BlcnR5JylcclxuICAgICAgICAgICAgLnNldEljb24oJ3BsdXMtY2lyY2xlJylcclxuICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHROYW1lID0gJyc7IC8vT2JqZWN0LmtleXModGhpcy5rbm93blByb3BlcnRpZXMpWzBdIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl0ucHVzaCh7IG5hbWU6IGRlZmF1bHROYW1lLCB2YWx1ZTogdW5kZWZpbmVkIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl0ucHVzaChPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiByYW5kb21VVUlEKCkudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5idXR0b25FbC5jbGFzc05hbWU9J3Byb3BlcnR5LXBsdXMtYnV0dG9uJztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUZpbHRlckluZGljYXRvcihhY3RpdmVGaWxlLCBwcm9wZXJ0aWVzTGlzdEVsOiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICAgIGlmIChhY3RpdmVGaWxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZvckVhY2goKHJ1bGUsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVJvd0VsID0gcHJvcGVydGllc0xpc3RFbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9wZXJ0eS1zZXR0aW5nLXJvdycpW2luZGV4XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5TGVmdERpdiA9IHByb3BlcnR5Um93RWwucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LWxlZnQtY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tJZkZpbGVBbGxvd2VkKGFjdGl2ZUZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLCBydWxlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5TGVmdERpdj8uYWRkQ2xhc3MoJ3Byb3BlcnR5LWxlZnQtY29udGFpbmVyLWFsbG93ZWQnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlMZWZ0RGl2Py5yZW1vdmVDbGFzcygncHJvcGVydHktbGVmdC1jb250YWluZXItYWxsb3dlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwgIlxyXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nLCBUQWJzdHJhY3RGaWxlLCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIHNldEljb24sQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBDb25zdHJ1Y3RvciB9IGZyb20gJ29ic2lkaWFuJzsgLy8gQWRkZWQgc2V0SWNvblxyXG4vL2ltcG9ydCAnY29kZW1pcnJvci9tb2RlL2phdmFzY3JpcHQvamF2YXNjcmlwdCc7XHJcbmltcG9ydCB7IE9ic2lkaWFuUHJvcGVydHlUeXBlcyB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBwYXJzZUpTQ29kZSwgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgdXBkYXRlUHJvcGVydHlJY29uIH0gZnJvbSAnLi91aUVsZW1lbnRzJztcclxuLy9pbXBvcnQgeyBjaGRpciB9IGZyb20gJ25vZGU6cHJvY2Vzcyc7XHJcbi8vaW1wb3J0IHsgRWRpdG9yVmlldyB9IGZyb20gJ0Bjb2RlbWlycm9yL3ZpZXcnO1xyXG4vL2ltcG9ydCB7IEVkaXRvclN0YXRlIH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xyXG5cclxuXHJcbi8vIERlZmluZSB0aGUgcmVzdWx0IHN0cnVjdHVyZSByZXR1cm5lZCBieSB0aGUgbW9kYWxcclxuZXhwb3J0IGludGVyZmFjZSBjb2RlRWRpdG9yTW9kYWxSZXN1bHQge1xyXG4gICAgY29kZTogc3RyaW5nO1xyXG4gICAgdHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzO1xyXG4gICAgY2hlY2tlZDogYm9vbGVhbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIE1vZGFsIGZvciBzZWxlY3RpbmcgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGZyb20gdGhlIHZhdWx0IHN0cnVjdHVyZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBjb2RlRWRpdG9yTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbENvZGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgc2NyaXB0aW5nVG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IGFueTtcclxuXHJcbiAgICAvLyBDdXJyZW50IHN0YXRlIGJlaW5nIG1vZGlmaWVkIHdpdGhpbiB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgY3VycmVudENvZGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgZXhwZWN0ZWRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBwcml2YXRlIGNoZWNrZWRTdWNjZXNzZnVsbHkgOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSB1c2VUZXh0QXJlYSA6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIGFjdGl2ZUZpbGU6IFRGaWxlIHwgVEZvbGRlciB8IG51bGxcclxuICAgIHByaXZhdGUgZnJvbnRtYXR0ZXI6IGFueTsgLy8gRnJvbnRtYXR0ZXIgZGF0YSBmb3IgdGhlIGFjdGl2ZSBmaWxlXHJcblxyXG4gICAgLy8gVUkgRWxlbWVudHNcclxuICAgIHByaXZhdGUgZWRpdG9yUm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBmdW5jdGlvblRlc3RCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcclxuICAgIHByaXZhdGUgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgcHJpdmF0ZSBjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IgfCBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwuXHJcbiAgICAgKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBwbHVnaW4gLSBUaGUgcGx1Z2luIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxDb2RlIC0gU3RyaW5nIHdpdGggdGhlIGluaXRpYWwgY29kZS5cclxuICAgICAqIEBwYXJhbSBleHBlY3RlZFR5cGUgLSBFeHBlY3RlZCByZXR1cm4gdHlwZS5cclxuICAgICAqIEBwYXJhbSBhY3RpdmVGaWxlIC0gVGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZSBvciBmb2xkZXIuXHJcbiAgICAgKiBAcGFyYW0gZnJvbnRtYXR0ZXIgLSBGcm9udG1hdHRlciBkYXRhIGZvciB0aGUgYWN0aXZlIGZpbGUuXHJcbiAgICAgKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsXHJcbiAgICAgICAgcGx1Z2luOiBhbnksXHJcbiAgICAgICAgaW5pdGlhbENvZGU6IHN0cmluZyxcclxuICAgICAgICBleHBlY3RlZFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcyxcclxuICAgICAgICBhY3RpdmVGaWxlOiBURmlsZSB8IFRGb2xkZXIgfCBudWxsLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBhbnksICAgXHJcbiAgICAgICAgb2tDYWxsYmFjazogKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIHN0YXRlIGZvciByZXNldFxyXG4gICAgICAgIHRoaXMuaW5pdGlhbENvZGUgPSBpbml0aWFsQ29kZTtcclxuICAgICAgICB0aGlzLmV4cGVjdGVkVHlwZSA9IGV4cGVjdGVkVHlwZTtcclxuICAgICAgICB0aGlzLnVzZVRleHRBcmVhID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVGaWxlID0gYWN0aXZlRmlsZTtcclxuICAgICAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7IC8vIFN0b3JlIGZyb250bWF0dGVyIGRhdGFcclxuICAgICAgICB0aGlzLmN1cnJlbnRUeXBlID0gZXhwZWN0ZWRUeXBlOyAvLyBJbml0aWFsaXplIGN1cnJlbnQgdHlwZSB0byBleHBlY3RlZCB0eXBlXHJcbiAgICAgICAgdGhpcy5jdXJyZW50Q29kZSA9IGluaXRpYWxDb2RlOyAvLyBJbml0aWFsaXplIGN1cnJlbnQgY29kZSB0byBpbml0aWFsIGNvZGVcclxuXHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgdGhpcy5zY3JpcHRpbmdUb29scz0gbmV3IFNjcmlwdGluZ1Rvb2xzKGFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuZnJvbnRtYXR0ZXIpO1xyXG4gICAgICAgIHRoaXMub2tDYWxsYmFjayA9IG9rQ2FsbGJhY2s7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgY3VycmVudCBzdGF0ZSBmcm9tIGluaXRpYWwgc3RhdGUgZm9yIGVkaXRpbmdcclxuICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFVzZSBhIG1ldGhvZCBmb3IgaW5pdGlhbGl6YXRpb24gYW5kIHJlc2V0XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIHRoZSBpbml0aWFsIHN0YXRlIHByb3ZpZGVkIGF0IGNvbnN0cnVjdGlvbi5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZXNldFNlbGVjdGlvblRvSW5pdGlhbCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRDb2RlID0gdGhpcy5pbml0aWFsQ29kZTtcclxuICAgICAgICB0aGlzLmNtRWRpdG9yPy5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRDb2RlKTsgLy8gU2V0IHRoZSBpbml0aWFsIGNvZGUgaW4gdGhlIGVkaXRvclxyXG4gICAgICAgIGlmICh0aGlzLmZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoJycpOyAvLyBDbGVhciB0aGUgcmVzdWx0IHRleHQgY29tcG9uZW50XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIGVtcHR5LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRDb2RlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMuY21FZGl0b3I/LnNldFZhbHVlKHRoaXMuY3VycmVudENvZGUpOyAvLyBTZXQgdGhlIGluaXRpYWwgY29kZSBpbiB0aGUgZWRpdG9yXHJcbiAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSB0aGlzLmZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5zZXRWYWx1ZSgnJyk7IC8vIENsZWFyIHRoZSByZXN1bHQgdGV4dCBjb21wb25lbnQgXHJcbiAgICB9XHJcblxyXG4gICAgbG9hZENvZGVNaXJyb3JNb2RlKG1vZGU6IHN0cmluZykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBWZXJ3ZW5kZSByZXF1aXJlIChrXHUwMEY2bm50ZSBpbiB6dWtcdTAwRkNuZnRpZ2VuIFZlcnNpb25lbiB3ZW5pZ2VyIHp1dmVybFx1MDBFNHNzaWcgc2VpbilcclxuICAgICAgICAgIHJlcXVpcmUoYG9ic2lkaWFuL2xpYi9jb2RlbWlycm9yL21vZGUvJHttb2RlfS8ke21vZGV9LmpzYCk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQ29kZU1pcnJvciBtb2RlICcke21vZGV9JyBsb2FkZWQgc3VjY2Vzc2Z1bGx5ICh1c2luZyByZXF1aXJlKS5gKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgQ29kZU1pcnJvciBtb2RlICcke21vZGV9JyAodXNpbmcgcmVxdWlyZSk6YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIG9wZW5lZC4gQnVpbGRzIHRoZSBVSS5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGlmIChjb250ZW50RWwucGFyZW50RWxlbWVudCkgY29udGVudEVsLnBhcmVudEVsZW1lbnQuc3R5bGUud2lkdGggPSAnOTAwcHgnO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciBwcmV2aW91cyBcclxuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoJ2NvZGVFZGl0b3ItbW9kYWwnKTsgXHJcblxyXG4gICAgICAgIC8vIC0tLSBNb2RhbCBUaXRsZSAtLS1cclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnSmF2YVNjcmlwdCBFZGl0b3InIH0pOyAgICBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2JvZHknLCB7IHRleHQ6IGBNYWtlIHN1cmUgeW91ciBjb2RlIHJlc3VsdHM6ICR7dGhpcy5leHBlY3RlZFR5cGV9YCB9KTsgXHJcblxyXG4gICAgICAgIC8vIC0tLSBUcmVlIENvbnRhaW5lciAtLS1cclxuICAgICAgICB0aGlzLmVkaXRvclJvb3RFbGVtZW50ID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2NvZGVFZGl0b3ItY29udGFpbmVyJyB9KTtcclxuICAgICAgICAvLyBCYXNpYyBzdHlsaW5nIGZvciB0aGUgc2Nyb2xsYWJsZSB0cmVlIGFyZWFcclxuICAgICAgICAvLyB0aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLndpZHRoID0gJzYwMHB4JztcclxuICAgICAgICB0aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLmhlaWdodCA9ICc2MDBweCc7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcbiAgICAgICAgLy90aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcclxuICAgICAgICB0aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMTBweCc7XHJcblxyXG4gICAgICAgIHRoaXMuY21FZGl0b3IgPSBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBydWxlT3B0aW9uc0RpdiA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiY29kZUVkaXRvci1vcHRpb25zXCIgfSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnVzZVRleHRBcmVhKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJ1bGVPcHRpb25zU2V0dGluZ3MgPSBuZXcgU2V0dGluZyh0aGlzLmVkaXRvclJvb3RFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHRBcmVhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignZW5kZXIgdmFsaWQgSlMgQ29kZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRBcmVhLmlucHV0RWwuc2V0QXR0cmlidXRlKCdzdHlsZScsIGBoZWlnaHQ6MTkwcHg7IHdpZHRoOjgwJTtgKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25UZXN0QnV0dG9uKSB0aGlzLmZ1bmN0aW9uVGVzdEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Q29kZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIGxldCB2aWV3ID0gbmV3IEVkaXRvclZpZXcoe1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6IEVkaXRvclN0YXRlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgIGRvYzogdGhpcy5jdXJyZW50Q29kZSwgIC8vIG9yIHNvbWUgc3RyaW5nIGNvbnRlbnRzXHJcbiAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IFtcclxuICAgICAgICAgICAgICAgICAgICBFZGl0b3JWaWV3LmxpbmVXcmFwcGluZywgLy8gQWRkIHlvdXIgZXh0ZW50aW9ucyBoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgamF2YXNjcmlwdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNjZW5lR3V0dGVyLCAvLyBvciBsZWF2ZSBlbXB0eSBmb3IgYmFzaWMgZWRpdG9yXHJcbiAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIHBhcmVudDogdGhpcy5lZGl0b3JSb290RWxlbWVudFxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIENvZGVNaXJyb3IgNVxyXG4gICAgICAgICAgICAvLyBDb2RlTWlycm9yLUJpYmxpb3RoZWsgYWJydWZlblxyXG4gICAgICAgICAgICBjb25zdCBDb2RlTWlycm9yID0gKHdpbmRvdyBhcyBhbnkpLkNvZGVNaXJyb3I7XHJcbiAgICAgICAgICAgIC8vIFNpY2hlcnN0ZWxsZW4sIGRhc3MgQ29kZU1pcnJvciBnZWxhZGVuIGlzdFxyXG4gICAgICAgICAgICBpZiAoQ29kZU1pcnJvcikge1xyXG4gICAgICAgICAgICAgICAgLy8gSmF2YVNjcmlwdC1Nb2R1cyBsYWRlbiAoZmFsbHMgbm9jaCBuaWNodCBnZWxhZGVuKVxyXG4gICAgICAgICAgICAgICAgaWYgKCFDb2RlTWlycm9yLm1vZGVzLmphdmFzY3JpcHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRDb2RlTWlycm9yTW9kZSgnamF2YXNjcmlwdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdqYXZhU2NyaXB0IHN1cHBvcnQgbG9hZGVkJylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgbGV0IGpzQ29kZSA9IHRoaXMuY3VycmVudENvZGU7XHJcbiAgICAgICAgICAgIHRoaXMuY21FZGl0b3IgPSBDb2RlTWlycm9yKHRoaXMuZWRpdG9yUm9vdEVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBqc0NvZGUgfHwgXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgICAgICAgICAgICAgIG1vZGU6IFwiamF2YXNjcmlwdFwiLFxyXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICB0aGVtZTogXCJvYnNpZGlhblwiLFxyXG4gICAgICAgICAgICAgICAgaW5kZW50VW5pdDogNCwgIFxyXG4gICAgICAgICAgICAgICAgbGluZVdyYXBwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlYWRPbmx5OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG91dGVySGVpZ2h0OiAnNjAwcHgnLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNtRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNtRWRpdG9yLm9uKCdjaGFuZ2UnLCAoY21FZGl0b3I6IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25UZXN0QnV0dG9uKSB0aGlzLmZ1bmN0aW9uVGVzdEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbUVkaXRvci5vbignYmx1cicsIChjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRDb2RlPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byBzYXZlIHRoZSBjb2RlXHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKHJ1bGVPcHRpb25zRGl2KVxyXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblRlc3RCdXR0b24gPSBidXR0b247XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiUnVuIENvZGVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIlJ1biB0aGUgY29kZSBhbmQgY2hlY2sgZm9yIGVycm9yc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY21FZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc0NvZGUgPSB0aGlzLmNtRWRpdG9yLmdldFZhbHVlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJGdW5jdGlvbiA9ICBwYXJzZUpTQ29kZShqc0NvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB1c2VyRnVuY3Rpb24gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVycm9ySGludCA9IFwiU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJGdW5jdGlvbi5jb250YWlucygnVW5leHBlY3RlZCB0b2tlbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ySGludCA9IFwiRGlkIHlvdSBtaXNzZWQgYSBzZW1pY29sb24gKDspP1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKGBTeW50YXggZXJyb3I6ICR7dXNlckZ1bmN0aW9ufSEgJHtlcnJvckhpbnR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB1c2VyRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYWN0aXZlRmlsZSwgdGhpcy5zY3JpcHRpbmdUb29scylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYCcke3Jlc3VsdC50b1N0cmluZygpfScgKCR7dHlwZW9mIHJlc3VsdH0pYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVR5cGVJY29ucyhyZXN1bHQsIHR5cGVzQ29udGFpbmVyLCB0aGlzLmV4cGVjdGVkVHlwZSwgdGhpcy5jdXJyZW50VHlwZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnJlbW92ZUNsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYFN5bnRheCBlcnJvcjogJHtlLm1lc3NhZ2V9ISBTZWUgY29uc29sZSBmb3IgZGV0YWlscyFgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTeW50YXggZXJyb3IuIFwiLCBlLCBqc0NvZGUsIHVzZXJGdW5jdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRTdWNjZXNzZnVsbHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTsgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic3ludGF4IGVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRTdWNjZXNzZnVsbHkgPSBmYWxzZTsgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQgPSB0ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2Z1bmN0aW9uIHJlc3VsdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICc1ODBweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVzQ29udGFpbmVyID0gcnVsZU9wdGlvbnNEaXYuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktaWNvbnMtY29udGFpbmVyJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIEFjdGlvbiBCdXR0b25zIC0tLVxyXG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250ZW50RWwpOyAvLyBDcmVhdGUgT0sgYW5kIFJlc2V0IGJ1dHRvbnNcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVUeXBlSWNvbnModmFsdWU6YW55LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBleHBlY3RlZFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgY3VycmVudFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgc2V0dGluZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IG5ld1R5cGUgPSB0eXBlb2YgdmFsdWU7XHJcbiAgICAgICAgY29uc3QgdHlwZUljb25zOiB7W2tleTpzdHJpbmddOiBPYnNpZGlhblByb3BlcnR5VHlwZXNbXX0gPSB7XHJcbiAgICAgICAgICAgICdzdHJpbmcnOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCcsJ2RhdGUnLCAnZGF0ZXRpbWUnXSxcclxuICAgICAgICAgICAgJ251bWJlcic6IFsnbnVtYmVyJ10sXHJcbiAgICAgICAgICAgICdib29sZWFuJzogWydjaGVja2JveCddLFxyXG4gICAgICAgICAgICAnb2JqZWN0JzogWyd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J11cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChuZXdUeXBlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2NyaXB0aW5nVG9vbHMuaXNJU09TdHJpbmcodmFsdWUsIHt3aXRoRGF0ZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlSWNvbnNbbmV3VHlwZV0uc3BsaWNlKHR5cGVJY29uc1tuZXdUeXBlXS5pbmRleE9mKCdkYXRlJyksIDEpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkludmFsaWQgZGF0ZSBmb3JtYXQ6XCIsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2NyaXB0aW5nVG9vbHMuaXNJU09TdHJpbmcodmFsdWUsIHt3aXRoRGF0ZTogdHJ1ZSwgd2l0aFRpbWU6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgdHlwZUljb25zW25ld1R5cGVdLnNwbGljZSh0eXBlSWNvbnNbbmV3VHlwZV0uaW5kZXhPZignZGF0ZXRpbWUnKSwgMSk7IFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkludmFsaWQgZGF0ZSBmb3JtYXQ6XCIsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb250YWluZXIuZW1wdHkoKTsgLy8gQ2xlYXIgdGhlIGNvbnRhaW5lciBiZWZvcmUgYWRkaW5nIG5ldyBpY29uc1xyXG4gICAgICAgIGZvciAobGV0IG9ic2lkaWFuVHlwZSBvZiB0eXBlSWNvbnNbbmV3VHlwZV0pIHtcclxuICAgICAgICAgICAgaWYgKG9ic2lkaWFuVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaWNvbkVsID0gY29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdwcm9wZXJ0eS1pY29uIHNldHRpbmctaXRlbS1pY29uJyB9KTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVByb3BlcnR5SWNvbihpY29uRWwsIG9ic2lkaWFuVHlwZSk7IC8vIFVwZGF0ZSB0aGUgaWNvbiBiYXNlZCBvbiB0aGUgdHlwZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgXCJPS1wiIGFuZCBcIlJlc2V0XCIgYnV0dG9ucy5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBidXR0b25zIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZUFjdGlvbkJ1dHRvbnMoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9uc0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbW9kYWwtYnV0dG9ucycgfSk7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLm1hcmdpblRvcCA9ICcxNXB4JztcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgLy8gVXNlIGZsZXggZm9yIGFsaWdubWVudFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdmbGV4LWVuZCc7IC8vIEFsaWduIGJ1dHRvbnMgdG8gdGhlIHJpZ2h0XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmdhcCA9ICcxMHB4JzsgLy8gU3BhY2UgYmV0d2VlbiBidXR0b25zXHJcblxyXG4gICAgICAgIC8vIFJlc2V0IEJ1dHRvbiAoVW5kbyBcdTIxQUFcdUZFMEYpXHJcbiAgICAgICAgY29uc3QgcmVzZXRCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24ocmVzZXRCdXR0b24sICdyZXNldCcpOyAvLyBVc2UgYSBzdWl0YWJsZSBpY29uIGxpa2UgJ3Jlc2V0JyBvciAndW5kbydcclxuICAgICAgICByZXNldEJ1dHRvbi5hcmlhTGFiZWwgPSAnUmVzZXQgc2VsZWN0aW9uJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIHJlc2V0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gUmVzZXQgaW50ZXJuYWwgc3RhdGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBDbGVhciBCdXR0b24gKENsZWFyIFx1RDgzRFx1REVBRSlcclxuICAgICAgICBjb25zdCBlbXB0eUJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XHJcbiAgICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmb3IgY29uc2lzdGVuY3ksIG9yIHVzZSB0ZXh0XHJcbiAgICAgICAgc2V0SWNvbihlbXB0eUJ1dHRvbiwgJ2VyYXNlcicpOyAvLyBVc2UgYSBzdWl0YWJsZSBpY29uIGxpa2UgJ3Jlc2V0JyBvciAndW5kbydcclxuICAgICAgICBlbXB0eUJ1dHRvbi5hcmlhTGFiZWwgPSAnQ2xlYXIgc2VsZWN0aW9uJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGVtcHR5QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk7IC8vIENsZWFyIHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gY2FuY2VsIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnQ2FuY2VsJyB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYXJpYUxhYmVsID0gJ2Nsb3NlIGFuZCBkaXNjYXJkIGNoYW5nZXMnOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsIENsaWNrZWQgLSBSZXR1cm5pbmdcIik7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgICAgICB0aGlzLm9rQ2FsbGJhY2soIG51bGwgKTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE9LIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycsIGNsczogJ21vZC1jdGEnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIHNhdmUgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBva0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIGNsb3NlZC4gQ2xlYW5zIHVwIHJlc291cmNlcy5cclxuICAgICAqL1xyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICAvLyBHYXRoZXIgdGhlIGZpbmFsIHN0YXRlIE9OTFkgd2hlbiBPSyBpcyBjbGlja2VkXHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBjb2RlRWRpdG9yTW9kYWxSZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuY3VycmVudENvZGUsXHJcbiAgICAgICAgICAgIGNoZWNrZWQ6IHRoaXMuY2hlY2tlZFN1Y2Nlc3NmdWxseSxcclxuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJPSyBDbGlja2VkIC0gUmV0dXJuaW5nIFJlc3VsdDpcIiwgcmVzdWx0KTsgLy8gRGVidWcgbG9nXHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrKHJlc3VsdCk7IC8vIFBhc3MgdGhlIGZpbmFsIHNlbGVjdGlvbiBiYWNrXHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7IC8vIENsZWFyIHRoZSBtb2RhbCdzIGNvbnRlbnRcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBlYXNpbHkgb3BlbiB0aGUgRGlyZWN0b3J5IFNlbGVjdGlvbiBNb2RhbC5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBpbml0aWFsQ29kZSAtIFN0cmluZyB3aXRoIHRoZSBpbml0aWFsIGNvZGUuXHJcbiAqIEBwYXJhbSBleHBlY3RlZFR5cGUgLSBFeHBlY3RlZCByZXR1cm4gdHlwZS5cclxuICogQHBhcmFtIG9rQ2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiT0tcIi4gUmVjZWl2ZXMgdGhlIHNlbGVjdGlvbiByZXN1bHQuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gb3BlbkNvZGVFZGl0b3JNb2RhbChcclxuICAgIGFwcDogQXBwLFxyXG4gICAgcGx1Z2luOiBhbnksXHJcbiAgICBpbml0aWFsQ29kZTogc3RyaW5nLFxyXG4gICAgZXhwZWN0ZWRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXMsXHJcbiAgICBhY3RpdmVGaWxlOiBURmlsZSB8IFRGb2xkZXIgfCBudWxsLFxyXG4gICAgZnJvbnRtYXR0ZXI6IGFueSxcclxuICAgIG9rQ2FsbGJhY2s6IChyZXN1bHQ6IGNvZGVFZGl0b3JNb2RhbFJlc3VsdCB8IG51bGwpID0+IHZvaWRcclxuKTogdm9pZCB7XHJcbiAgICAvLyBDcmVhdGUgYW5kIG9wZW4gdGhlIG1vZGFsIGluc3RhbmNlXHJcbiAgICBuZXcgY29kZUVkaXRvck1vZGFsKFxyXG4gICAgICAgIGFwcCxcclxuICAgICAgICBwbHVnaW4sXHJcbiAgICAgICAgaW5pdGlhbENvZGUsXHJcbiAgICAgICAgZXhwZWN0ZWRUeXBlLFxyXG4gICAgICAgIGFjdGl2ZUZpbGUsXHJcbiAgICAgICAgZnJvbnRtYXR0ZXIsXHJcbiAgICAgICAgb2tDYWxsYmFja1xyXG4gICAgKS5vcGVuKCk7XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBQTZJOzs7QUNBN0ksSUFBQUMsb0JBQWtHOzs7QUNBbEcsc0JBQWlEO0FBMEMxQyxTQUFTLGlDQUFpQyxLQUE4QjtBQUMzRSxNQUFJO0FBQ0EsVUFBTSxrQkFBbUIsSUFBWTtBQUNyQyxZQUFRLElBQUksbUJBQWtCLGVBQWU7QUFDN0MsV0FBTyxPQUFPLE9BQU8sZ0JBQWdCLFVBQVUsRUFBRSxJQUFLLENBQUMsV0FBZ0M7QUFBQSxNQUNuRixNQUFNLE1BQU07QUFBQSxNQUNaLE1BQU0sTUFBTTtBQUFBLE1BQ1osT0FBTyxNQUFNO0FBQUEsTUFDYixRQUFRO0FBQUEsSUFDWixFQUFFLEVBQUUsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLEtBQUssY0FBYyxFQUFFLElBQUksQ0FBQztBQUFB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QUM5QixTQUFLLElBQUksTUFBTSxpQkFBaUIsRUFBRSxRQUFRLFVBQVE7QUFDOUMsWUFBTTtBQUNOLFdBQUssMkJBQTJCLE1BQU0sTUFBTSxLQUFLO0FBQUEsSUFDckQsQ0FBQztBQUNELFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxNQUFNLDJCQUEyQixNQUFhLE1BQStCLE9BQU87QUFDaEYsUUFBSSxDQUFDLG1CQUFtQixNQUFNLEtBQUssVUFBVSxJQUFJO0FBQUc7QUFDcEQsVUFBTSxpQkFBaUIsS0FBSyxjQUFjLEtBQUssTUFBTSxrQkFBa0IsS0FBSyxJQUFJLENBQUM7QUFDakYsUUFBSSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQzVDLFNBQUssSUFBSSxZQUFZLG1CQUFtQixNQUFNLENBQUMsZ0JBQWdCO0FBQzNELFVBQUksTUFBTSxRQUFRLFlBQVksS0FBSyxRQUFRLENBQUM7QUFBRyxjQUFNLFNBQVMsWUFBWSxLQUFLLFFBQVEsRUFBRTtBQUN6RixrQkFBWSxLQUFLLFFBQVEsSUFBSSxXQUFXLEtBQUssS0FBSyxLQUFLLFVBQVUsTUFBTSxZQUFZLEtBQUssUUFBUSxHQUFHLE1BQU0sV0FBVztBQUNwSCxVQUFJLE1BQU0sUUFBUSxZQUFZLEtBQUssUUFBUSxDQUFDO0FBQUcsY0FBTSxTQUFTLFlBQVksS0FBSyxRQUFRLEVBQUU7QUFBQSxJQUM3RixHQUFFLEVBQUMsU0FBUSxLQUFLLEtBQUssTUFBSyxDQUFDO0FBQzNCLFdBQU87QUFBQSxFQUNYO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJmbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJuYW1lIiwgInN0eWxlIiwgIndpbmRvdyIsICJtaW4iLCAibWF4IiwgInRvUGFkZGluZ09iamVjdCIsICJwb3BwZXJPZmZzZXRzIiwgIm1pbiIsICJtYXgiLCAib2Zmc2V0IiwgImVmZmVjdCIsICJwb3BwZXIiLCAiZWZmZWN0IiwgIndpbmRvdyIsICJoYXNoIiwgImNsaXBwaW5nUGFyZW50cyIsICJyZWZlcmVuY2UiLCAicG9wcGVyT2Zmc2V0cyIsICJvZmZzZXQiLCAicGxhY2VtZW50cyIsICJwbGFjZW1lbnQiLCAicGxhY2VtZW50cyIsICJwbGFjZW1lbnQiLCAiX2xvb3AiLCAiX2kiLCAiY2hlY2tzIiwgIm9mZnNldCIsICJwb3BwZXJPZmZzZXRzIiwgIm9mZnNldCIsICJtaW4iLCAibWF4IiwgImZuIiwgIm1lcmdlZCIsICJkZWZhdWx0TW9kaWZpZXJzIiwgImNyZWF0ZVBvcHBlciIsICJyZWZlcmVuY2UiLCAicG9wcGVyIiwgIm9wdGlvbnMiLCAiZm4iLCAic3RhdGUiLCAiZWZmZWN0IiwgIm5vb3BGbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInZhbHVlIiwgImZyb250bWF0dGVyIiwgImpzQ29kZSIsICJydWxlIiwgInRleHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJqc0NvZGUiLCAicnVsZUZ1bmN0aW9uIiwgIl9hIiwgIl9iIiwgIl9jIiwgIl9kIiwgInJ1bGUiXQp9Cg==
