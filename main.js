/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/settings.ts
var import_obsidian4 = require("obsidian");

// src/frontmatter-tools.ts
var import_obsidian = require("obsidian");
function getPropertiesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get properties:", metadataManager);
    return Object.values(metadataManager.properties).map((value) => ({
      name: value.name,
      type: value.type,
      count: value.count,
      source: "registered"
    })).sort((a, b) => a.name.localeCompare(b.name));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
function getTypesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get types:", metadataManager);
    return Object.values(metadataManager.registeredTypeWidgets).map((value, index, array) => ({
      type: value.type,
      icon: value.icon,
      jsType: ""
    })).sort((a, b) => a.type.localeCompare(b.type));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
var SelectProperty = class extends import_obsidian.SuggestModal {
  constructor(app, knownProperties, property, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
    this.property = property;
    this.typedText = "";
    this.newTextFlag = true;
    this.knownProperties = knownProperties;
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    const result = this.knownProperties.filter((property) => property.name.toLowerCase().includes(query.toLowerCase()));
    this.newTextFlag = result.length === 0;
    this.typedText = query;
    return result;
  }
  onOpen() {
    if (this.property) {
      this.setPlaceholder(this.property.name);
    } else {
      this.setPlaceholder("no property selected!");
    }
    this.setTitle("Select or type a property name");
  }
  // Renders each suggestion item.
  renderSuggestion(property, el) {
    el.createEl("div", { text: property.name });
    el.createEl("small", { text: property.type });
  }
  onClose() {
    if (this.newTextFlag && this.property) {
      this.property.name = this.typedText;
      this.property.type = "text";
      this.onSubmit(this.property);
    }
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(property, evt) {
    if (evt instanceof KeyboardEvent) {
      console.log(`keyboard ${this.typedText} ${this.newTextFlag}`, property);
    }
    console.log("onChooseSuggestion", evt);
    this.onSubmit(property);
  }
};

// src/tools.ts
function parseJSCode(jsCode) {
  function parseFunction(jsCode2) {
    try {
      jsCode2 = cleanCodeString(jsCode2);
      var funcReg = /function *\(([^()]*)\)[ \n\t]*{(.*)}/gmi;
      var match = funcReg.exec(jsCode2.replace(/\n/g, " "));
      if (!match)
        return void 0;
      var args = match[1].split(",");
      args.push(match[2]);
      return new Function(...args);
    } catch (error) {
      console.error("error parsing JS function!", error);
      return error.message;
    }
  }
  ;
  return parseFunction(jsCode);
}
function cleanCodeString(codeString) {
  if (typeof codeString !== "string") {
    throw new TypeError("Input must be a string.");
  }
  let inMultiLineComment = false;
  let inSingleLineComment = false;
  let inString = null;
  let inRegExp = false;
  let cleanedCode = "";
  let i = 0;
  while (i < codeString.length) {
    const char = codeString[i];
    const nextChar = codeString[i + 1];
    if (inMultiLineComment) {
      if (char === "*" && nextChar === "/") {
        inMultiLineComment = false;
        i += 2;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inSingleLineComment) {
      if (char === "\n" || char === "\r") {
        inSingleLineComment = false;
        cleanedCode += char;
        i++;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inString) {
      if (char === inString) {
        inString = null;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (inRegExp) {
      if (char === "/") {
        inRegExp = false;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/" && nextChar === "*") {
      inMultiLineComment = true;
      i += 2;
      continue;
    }
    if (char === "/" && nextChar === "/") {
      inSingleLineComment = true;
      i += 2;
      continue;
    }
    if (char === '"' || char === "'") {
      inString = char;
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/") {
      const prevMeaningfulChar = cleanedCode.trim().slice(-1);
      if (prevMeaningfulChar === "" || ["(", ",", "=", ":", "[", "!", "&", "|", "?", "{", ";", "\n", "\r"].includes(prevMeaningfulChar)) {
        inRegExp = true;
        cleanedCode += char;
        i++;
        continue;
      }
    }
    cleanedCode += char;
    i++;
  }
  return cleanedCode;
}
var ScriptingTools = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Check if a string complies with ISO Standard
   * 
   * @param str Any string
   * @param options Options to look for
   * @returns 
   */
  isISOString(str, options = {}) {
    const {
      withMilliseconds = false,
      withTimezone = false,
      withTime = true,
      withDate = true
    } = options;
    let dateRegexStr = "^(?:\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01]))";
    let timeRegexStr = "(?:T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
    if (withMilliseconds) {
      timeRegexStr += "\\.\\d{3}";
    }
    if (withTimezone) {
      timeRegexStr += "(?:Z|[+-](?:[01]\\d|2[0-3]):[0-5]\\d)?)?";
    } else {
      timeRegexStr += ")?";
    }
    let regexStr = "";
    if (withDate && withTime) {
      regexStr = `${dateRegexStr}${timeRegexStr}$`;
    } else if (withDate) {
      regexStr = `${dateRegexStr}$`;
    } else if (withTime) {
      regexStr = `^${timeRegexStr.slice(4)}$`;
    } else {
      return false;
    }
    const regex = new RegExp(regexStr);
    return regex.test(str);
  }
  /**
   * Try to convert Any Types to a specific Type
   * @param input 
   * @param typeString 'string' | 'number' | 'boolean' | 'string[]'
   * @returns 
   */
  tryConvert(input, typeString) {
    switch (typeString) {
      case "string":
        if (typeof input === "string") {
          return input;
        }
        return void 0;
      case "number":
        const num = Number(input);
        if (!isNaN(num)) {
          return num;
        }
        return void 0;
      case "boolean":
        if (typeof input === "boolean") {
          return input;
        }
        if (typeof input === "string") {
          const lowerValue = input.toLowerCase();
          if (lowerValue === "true") {
            return true;
          }
          if (lowerValue === "false") {
            return false;
          }
        }
        if (typeof input === "number") {
          if (input === 1) {
            return true;
          }
          if (input === 0) {
            return false;
          }
        }
        return void 0;
      case "string[]":
        if (Array.isArray(input) && input.every((item) => typeof item === "string")) {
          return input;
        }
        return void 0;
      default:
        return void 0;
    }
  }
  formatToYAMLSaveString(text, replaceBy = void 0) {
    let replaceString = "-";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.specialCharReplacement || "-";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, replaceString);
  }
  /**
   * Converts a string to a YAML-safe format by adding quotes when necessary.
   * @param input The string, boolean, number or array to make YAML-safe
   * @returns The safely quoted string when needed, or the original string if safe
   */
  toYamlSafeString(input) {
    if (Array.isArray(input)) {
      input.forEach((item, index) => {
        input[index] = this.toYamlSafeString(item).toString();
      });
      return input;
    }
    switch (typeof input) {
      case "number":
        return input;
      case "boolean":
        return input ? "true" : "false";
      case "string":
        const trimmed = input.trim();
        if (trimmed === "")
          return '""';
        const needsQuotes = /[:{}\[\],&*#?|<>=!%@`"'\\]|^[-?\n]|[\s\n]|^[yYnN]|^[0-9]|^[+-]|^(true|false|yes|no|on|off)$/i.test(trimmed);
        const isAlreadyQuoted = trimmed.startsWith('"') && trimmed.endsWith('"') || trimmed.startsWith("'") && trimmed.endsWith("'");
        if (!needsQuotes && !isAlreadyQuoted) {
          return trimmed;
        }
        if (!isAlreadyQuoted) {
          return `"${trimmed.replace(/"/g, '\\"')}"`;
        }
        return trimmed;
      default:
        console.error(`toYamlSafeString(${input}) if of type '${typeof input}'`);
        return input;
    }
  }
  replaceSpaces(text, replaceBy = void 0) {
    let replaceString = "_";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.spaceReplacement || "_";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/\s+/g, replaceString);
  }
  formatCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      if (index > 0)
        newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  formatUpperCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  /**
   * get the path to a file from a string containing the full parh/name string
   * @param path string
   * @param separator string defaults to '/'
   * @returns string
   */
  getFoldersFromPath(path, separator = "/") {
    if (path === null)
      return null;
    if (path === void 0)
      return void 0;
    const currentPathParts = path.split("/");
    currentPathParts.pop();
    return currentPathParts.join(separator);
  }
};

// src/rules.ts
var ruleFunctions = [];
function getRuleFunctionById(id) {
  return ruleFunctions.find((rule) => rule.id === id);
}
ruleFunctions.push({
  id: "default",
  description: "Pass parameter",
  source: "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let result = "";
    return result;
  }
});
ruleFunctions.push({
  id: "fullPath",
  description: "Full path and filename",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const result = file.path;\n  return result;\n}",
  fx: function(app, file, tools) {
    return `${file.path}`;
  }
});
ruleFunctions.push({
  id: "aliasFromPath",
  description: "An Alias from every folder of the file Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  let pathArray = file.path.split('/');\n  pathArray.pop(); // remove File name with extension\n  pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir)); // convert to UpperCamelCase\n  const fileNameParts = file.name.split('.');\n  if (fileNameParts.length > 1) {\n    fileNameParts.pop(); // remove Extension\n  }\n  const fileName = fileNameParts.join('.'); // rebuild file Name\n  pathArray.push(tools.formatUpperCamelCase(fileName)); // add file name without extension and in UpperCamelCase\n  const result = pathArray.join('.') || '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let pathArray = file.path.split("/");
    pathArray.pop();
    pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir));
    const fileNameParts = file.name.split(".");
    if (fileNameParts.length > 1) {
      fileNameParts.pop();
    }
    const fileName = fileNameParts.join(".");
    pathArray.push(tools.formatUpperCamelCase(fileName));
    const result = pathArray.join(".") || "";
    return result;
  }
});
ruleFunctions.push({
  id: "path",
  description: "Full Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "folder",
  description: "Foldername",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[parts.length-2];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[parts.length - 2];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "folders",
  description: "All folders of the file as a list",
  source: "function (app, file, tools) { // do not change this line!\n  const path = file.path; // acquire file path\n  const result = path.split('/');\n  result.pop(); // remove file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const result = path.split("/");
    result.pop();
    return result;
  }
});
ruleFunctions.push({
  id: "rootFolder",
  description: "Root folder",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[0];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[0];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "name",
  description: "File name",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name.split('.');\n  result.pop(); // remove extension\n  result.join('.'); // reconstruct the file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name.split(".");
    result.pop();
    result.join(".");
    return result;
  }
});
ruleFunctions.push({
  id: "nameExt",
  description: "File name with extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name;\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name;
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeCreated",
  description: "Date (and Time) created",
  // TODO Check time zones. 
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file created\n  const dateTime = new Date(file.stat.ctime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.ctime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeModified",
  description: "Date (and Time) modified",
  //FIXME keep Date and time untouched when editing frontmatter properties
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file modified\n  const dateTime = new Date(file.stat.mtime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.mtime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeBytes",
  description: "File size in bytes",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  const result = file.stat.size;\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const result = file.stat.size;
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeString",
  description: "File size formatted as text",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  let size =file.stat.size;\n  const precision = 2; // number of decimal places\n  if (size > 1024) {\n    size = size / 1024;\n    if (size > 1024) {\n      size = size / 1024;\n      if (size > 1024) {\n        size = size / 1024;\n        return Number.parseFloat(size).toFixed(precision) + ' GB';\n      } \n      return Number.parseFloat(size).toFixed(precision) + ' MB';\n    }\n    return Number.parseFloat(size).toFixed(precision) + ' KB';\n  }   \n  return size + ' Bytes'; // return you result.\n}",
  fx: function(app, file, tools) {
    let size = file.stat.size;
    const precision = 2;
    if (size > 1024) {
      size = size / 1024;
      if (size > 1024) {
        size = size / 1024;
        if (size > 1024) {
          size = size / 1024;
          return size.toFixed(precision) + " GB";
        }
        return size.toFixed(precision) + " MB";
      }
      return size.toFixed(precision) + " KB";
    }
    return size + " Bytes";
  }
});

// src/types.ts
var DEFAULT_SETTINGS = {
  tagPrefix: "",
  excludeRootFolder: false,
  tagsPropertyName: "tags",
  spaceReplacement: "_",
  specialCharReplacement: "_",
  lowercaseTags: false,
  knownProperties: [],
  rules: [],
  useTextArea: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folder"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folder"
  },
  configuredProperties: []
};
var DEFAULT_RULE_DEFINITION = {
  id: "",
  active: true,
  property: "",
  customProperty: "",
  type: "string",
  typeProperty: { name: "", type: "", source: "registered" },
  content: "",
  buildInCode: "",
  jsCode: "",
  showContent: false
};

// src/alertBox.ts
var import_obsidian2 = require("obsidian");
var AlertModal = class extends import_obsidian2.Modal {
  constructor(app, title, description, btn1, btn2) {
    super(app);
    this.title = title;
    this.description = description;
    this.btn1Text = btn1;
    this.btn2Text = btn2;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: this.title });
    contentEl.createEl("p", { text: this.description });
    new import_obsidian2.Setting(contentEl).addButton((btn) => {
      btn.setButtonText(this.btn1Text).setCta().onClick(() => {
        this.close();
        this.resolvePromise(true);
      });
    }).addButton((btn) => {
      btn.setButtonText(this.btn2Text).onClick(() => {
        this.close();
        this.resolvePromise(false);
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  async openAndGetValue() {
    this.open();
    return this.promise;
  }
};

// src/directorySelectionModal.ts
var import_obsidian3 = require("obsidian");
var DirectorySelectionModal = class extends import_obsidian3.Modal {
  // Reference to update dropdown on reset
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param initialFolders - Array of initially selected folder paths.
   * @param initialFiles - Array of initially selected file paths.
   * @param initialMode - The initial selection mode ('include' or 'exclude').
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
    super(app);
    this.showFiles = false;
    // Container for the tree view
    this.treeNodes = /* @__PURE__ */ new Map();
    // Map path to node info for quick access
    this.modeDropdown = null;
    this.initialFoldersSnapshot = new Set(initialFolders);
    this.initialFilesSnapshot = new Set(initialFiles);
    this.initialModeSnapshot = initialMode;
    this.initialDisplaySnapshot = initialDisplay;
    this.showFiles = initialDisplay === "files" || initialFiles.length > 0;
    this.includeExcludeSelectable = includeExcludeSelectable;
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    this.currentFolders = new Set(this.initialFoldersSnapshot);
    this.currentFiles = new Set(this.initialFilesSnapshot);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    this.currentFolders = /* @__PURE__ */ new Set([]);
    this.currentFiles = /* @__PURE__ */ new Set([]);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("directory-selection-modal");
    if (this.includeExcludeSelectable) {
      contentEl.createEl("h2", { text: "Include or Exclude Folders and Files" });
    } else {
      contentEl.createEl("h2", { text: `${this.currentMode === "exclude" ? "Exclude" : "Include"} Folders and Files` });
    }
    const controlsEl = contentEl.createDiv({ cls: "modal-controls" });
    this.createModeSetting(controlsEl);
    this.createShowFilesSetting(controlsEl);
    this.treeRootElement = contentEl.createDiv({ cls: "tree-view-container" });
    this.treeRootElement.style.maxHeight = "600px";
    this.treeRootElement.style.overflowY = "auto";
    this.treeRootElement.style.border = "1px solid var(--background-modifier-border)";
    this.treeRootElement.style.padding = "10px";
    this.treeRootElement.style.marginTop = "10px";
    this.treeRootElement.style.marginBottom = "10px";
    this.buildAndRenderTree();
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the dropdown setting for choosing the selection mode.
   * @param containerEl - The HTML element to append the setting to.
   */
  createModeSetting(containerEl) {
    if (this.includeExcludeSelectable) {
      this.modeDropdown = new import_obsidian3.Setting(containerEl).setName("Selection Mode").setDesc("Choose if the selected files and folders should be excluded or included.").addDropdown((dropdown) => {
        dropdown.addOption("exclude", "exclude").addOption("include", "include").setValue(this.currentMode).onChange((value) => {
          this.currentMode = value;
          this.updateTreeAppearance();
        });
      });
    }
  }
  /**
   * Updates the mode dropdown UI element to reflect the currentMode state.
   */
  updateModeDropdown() {
    var _a;
    const dropdownComponent = (_a = this.modeDropdown) == null ? void 0 : _a.components[0];
    if (dropdownComponent && typeof dropdownComponent.setValue === "function") {
      dropdownComponent.setValue(this.currentMode);
    }
  }
  /**
   * Creates the toggle setting for showing/hiding files in the tree.
   * @param containerEl - The HTML element to append the setting to.
   */
  createShowFilesSetting(containerEl) {
    new import_obsidian3.Setting(containerEl).setName("Show Files").setDesc("Show Files within the directory tree.").addToggle((toggle) => {
      toggle.setValue(this.showFiles).onChange((value) => {
        this.showFiles = value;
        this.buildAndRenderTree();
      });
    });
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      console.log("Cancel Clicked - Returning");
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Builds the logical tree structure data from the vault's files and folders.
   * @returns The root node of the tree structure.
   */
  buildTreeData() {
    const vaultRootNode = {
      path: "/",
      name: this.app.vault.getName() || "Vault",
      // Use vault name or default
      type: "folder",
      children: [],
      // Placeholder elements, will be assigned during rendering if root is rendered
      element: null,
      checkbox: null,
      label: null,
      container: null
    };
    const folderNodes = /* @__PURE__ */ new Map();
    folderNodes.set("/", vaultRootNode);
    const allFiles = this.app.vault.getFiles();
    allFiles.forEach((file) => {
      const parentFolder = file.parent;
      if (!parentFolder)
        return;
      let currentPath = "";
      const pathParts = parentFolder.path.split("/").filter((p) => p.length > 0);
      let parentNode = vaultRootNode;
      pathParts.forEach((part) => {
        currentPath = currentPath === "/" ? part : `${currentPath}/${part}`;
        if (!folderNodes.has(currentPath)) {
          const newFolderNode = {
            path: currentPath,
            name: part,
            type: "folder",
            children: [],
            // Placeholders, assigned during rendering
            element: null,
            checkbox: null,
            label: null,
            container: null
          };
          folderNodes.set(currentPath, newFolderNode);
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(newFolderNode);
          parentNode = newFolderNode;
        } else {
          parentNode = folderNodes.get(currentPath);
        }
      });
    });
    if (this.showFiles) {
      allFiles.forEach((file) => {
        const parentFolder = file.parent;
        if (!parentFolder) {
          return;
        }
        const parentPath = "/" + parentFolder.path;
        const parentNode = folderNodes.get(parentPath);
        const fileNode = {
          path: file.path,
          name: file.name,
          type: "file",
          // Files don't have children
          // Placeholders, assigned during rendering
          element: null,
          checkbox: null,
          label: null,
          container: null
        };
        if (parentNode) {
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(fileNode);
        } else {
        }
      });
    }
    const sortNodes = (a, b) => {
      if (a.type === "folder" && b.type === "file")
        return -1;
      if (a.type === "file" && b.type === "folder")
        return 1;
      return a.name.localeCompare(b.name);
    };
    folderNodes.forEach((node) => {
      var _a;
      return (_a = node.children) == null ? void 0 : _a.sort(sortNodes);
    });
    return vaultRootNode;
  }
  /**
   * Renders the entire tree structure in the DOM based on the tree data.
   */
  renderTree() {
    var _a;
    this.treeRootElement.empty();
    this.treeNodes.clear();
    const treeData = this.buildTreeData();
    const rootUl = this.treeRootElement.createEl("ul");
    rootUl.addClass("tree-root-ul");
    rootUl.style.listStyle = "none";
    rootUl.style.paddingLeft = "0";
    (_a = treeData.children) == null ? void 0 : _a.forEach((childNode) => {
      this.renderTreeNode(childNode, rootUl, 0);
    });
  }
  /**
   * Recursively renders a single tree node and its children in the DOM.
   * @param node - The TreeNode data to render.
   * @param parentElement - The HTML `ul` element to append this node's `li` to.
   * @param level - The current indentation level.
   */
  renderTreeNode(node, parentElement, level) {
    const li = parentElement.createEl("li");
    li.style.marginLeft = `${level * 20}px`;
    li.addClass(`tree-node-${node.type}`);
    const container = li.createDiv({ cls: "tree-node-container" });
    container.style.display = "flex";
    container.style.alignItems = "center";
    container.style.padding = "2px 0";
    const checkbox = container.createEl("input", { type: "checkbox" });
    checkbox.id = `tree-cb-${node.path.replace(/[^a-zA-Z0-9]/g, "-")}`;
    checkbox.dataset.path = node.path;
    checkbox.dataset.type = node.type;
    const label = container.createEl("label");
    label.textContent = `${node.type === "folder" ? "\u{1F4C1}" : "\u{1F4C4}"} ${node.name}`;
    label.htmlFor = checkbox.id;
    label.style.marginLeft = "5px";
    label.style.cursor = "pointer";
    label.title = node.path;
    node.element = li;
    node.checkbox = checkbox;
    node.label = label;
    node.container = container;
    this.treeNodes.set(node.path, node);
    if (node.type === "folder") {
      checkbox.checked = this.currentFolders.has(node.path);
    } else {
      checkbox.checked = this.currentFiles.has(node.path);
    }
    checkbox.onchange = (event) => {
      const target = event.target;
      const path = target.dataset.path;
      const type = target.dataset.type;
      if (target.checked) {
        if (type === "folder")
          this.currentFolders.add(path);
        else
          this.currentFiles.add(path);
      } else {
        if (type === "folder")
          this.currentFolders.delete(path);
        else
          this.currentFiles.delete(path);
      }
      this.updateTreeAppearance();
    };
    if (node.type === "folder" && node.children && node.children.length > 0) {
      const childrenUl = li.createEl("ul");
      childrenUl.style.listStyle = "none";
      childrenUl.style.paddingLeft = "0";
      childrenUl.style.marginLeft = "0";
      node.children.forEach((child) => this.renderTreeNode(child, childrenUl, level + 1));
    }
  }
  /**
   * Updates the visual appearance (enabled/disabled/styling) of all nodes
   * in the tree based on the current mode and selections.
   */
  updateTreeAppearance() {
    this.treeNodes.forEach((node) => {
      let isDisabled = false;
      let isEffectivelyIncluded = false;
      let isEffectivelyExcluded = false;
      let ancestorFolderSelected = false;
      let currentPath = node.path;
      while (currentPath !== "/") {
        const parentPath = currentPath.substring(0, currentPath.lastIndexOf("/")) || "/";
        if (this.currentFolders.has(parentPath)) {
          ancestorFolderSelected = true;
          break;
        }
        if (parentPath === currentPath)
          break;
        currentPath = parentPath;
      }
      const nodeSelected = node.type === "folder" ? this.currentFolders.has(node.path) : this.currentFiles.has(node.path);
      if (this.currentMode === "exclude") {
        isEffectivelyExcluded = nodeSelected || ancestorFolderSelected;
        isDisabled = isEffectivelyExcluded;
      } else {
        if (node.type === "folder") {
          isEffectivelyIncluded = nodeSelected || ancestorFolderSelected;
        } else {
          const parentPath = node.path.substring(0, node.path.lastIndexOf("/")) || "/";
          const parentEffectivelyIncluded = this.isPathEffectivelyIncluded(parentPath);
          isEffectivelyIncluded = nodeSelected || parentEffectivelyIncluded;
        }
        isDisabled = !isEffectivelyIncluded;
      }
      node.checkbox.disabled = false;
      if (isDisabled) {
        node.container.style.opacity = "0.5";
        node.label.style.textDecoration = "line-through";
        node.element.addClass("is-disabled");
      } else {
        node.container.style.opacity = "1";
        node.label.style.textDecoration = "none";
        node.element.removeClass("is-disabled");
      }
      node.element.classList.remove("is-included", "is-excluded");
      if (this.currentMode === "include" && isEffectivelyIncluded) {
        node.element.addClass("is-included");
      } else if (this.currentMode === "exclude" && isEffectivelyExcluded) {
        node.element.addClass("is-excluded");
      }
    });
  }
  /**
   * Helper function to determine if a given path is effectively included
   * in the current selection under 'include' mode.
   * A path is included if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
   * @param path - The folder or file path to check.
   * @returns True if the path should be considered included, false otherwise.
   */
  isPathEffectivelyIncluded(path) {
    if (this.currentMode !== "include") {
      return !this.isPathEffectivelyExcluded(path);
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
  * Helper function to determine if a given path is effectively excluded
  * in the current selection under 'exclude' mode.
  * A path is excluded if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
  * @param path - The folder or file path to check.
  * @returns True if the path should be considered excluded, false otherwise.
  */
  isPathEffectivelyExcluded(path) {
    if (this.currentMode !== "exclude") {
      return false;
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
   * Combines building the tree data, rendering the DOM, and applying initial appearance.
   */
  buildAndRenderTree() {
    this.renderTree();
    this.updateTreeAppearance();
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      folders: Array.from(this.currentFolders),
      files: Array.from(this.currentFiles),
      mode: this.currentMode,
      display: this.currentDisplay
    };
    console.log("OK Clicked - Returning Result:", result);
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
    this.treeNodes.clear();
    this.modeDropdown = null;
  }
};
function openDirectorySelectionModal(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
  new DirectorySelectionModal(
    app,
    initialFolders,
    initialFiles,
    initialMode,
    initialDisplay,
    includeExcludeSelectable,
    okCallback
  ).open();
}

// src/settings.ts
var import_crypto = require("crypto");
var FolderTagSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(this.plugin.settings);
  }
  display() {
    this.knownProperties = getPropertiesFromMetadataManager(this.app);
    this.knownTypes = getTypesFromMetadataManager(this.app);
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Front matter automate V0.0.4 alpha" });
    new import_obsidian4.Setting(containerEl).setName("Tag prefix").setDesc("Optional prefix to add before folder path tags").addText((text) => text.setPlaceholder("prefix/").setValue(this.plugin.settings.tagPrefix).onChange(async (value) => {
      this.plugin.settings.tagPrefix = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude root folder").setDesc("If enabled, the root folder name will be excluded from the tag").addToggle((toggle) => toggle.setValue(this.plugin.settings.excludeRootFolder).onChange(async (value) => {
      this.plugin.settings.excludeRootFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Tags property name").setDesc('Frontmatter property name to store tags (default: "tags")').addText((text) => text.setPlaceholder("tags").setValue(this.plugin.settings.tagsPropertyName).onChange(async (value) => {
      this.plugin.settings.tagsPropertyName = value || "tags";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Space replacement").setDesc('Character to replace spaces in folder names (default: "_")').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.spaceReplacement).onChange(async (value) => {
      this.plugin.settings.spaceReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Special character replacement").setDesc('Character to replace special characters (default: "_") - preserves letters with diacritics').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.specialCharReplacement).onChange(async (value) => {
      this.plugin.settings.specialCharReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Convert to lowercase").setDesc("Convert all tags to lowercase").addToggle((toggle) => toggle.setValue(this.plugin.settings.lowercaseTags).onChange(async (value) => {
      this.plugin.settings.lowercaseTags = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude Files and Folders").setDesc(`Currently ${this.plugin.settings.exclude.selectedFolders.length} folders and ${this.plugin.settings.exclude.selectedFiles.length} files will be ${this.plugin.settings.exclude.mode}d.`).addButton((button) => {
      button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.exclude.selectedFolders || [],
          this.plugin.settings.exclude.selectedFiles || [],
          this.plugin.settings.exclude.mode || "exclude",
          this.plugin.settings.exclude.display || "folders",
          false,
          // include, exclude option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.exclude.selectedFolders = result.folders;
            this.plugin.settings.exclude.selectedFiles = result.files;
            this.plugin.settings.exclude.mode = result.mode;
            this.plugin.settings.exclude.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Include Files and Folders").setDesc(`Currently ${this.plugin.settings.include.selectedFolders.length} folders and ${this.plugin.settings.include.selectedFiles.length} files will be ${this.plugin.settings.include.mode}d even when in excluded Folders.`).addButton((button) => {
      button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.include.selectedFolders || [],
          this.plugin.settings.include.selectedFiles || [],
          this.plugin.settings.include.mode || "include",
          this.plugin.settings.include.display || "folders",
          false,
          // include, include option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.include.selectedFolders = result.folders;
            this.plugin.settings.include.selectedFiles = result.files;
            this.plugin.settings.include.mode = result.mode;
            this.plugin.settings.include.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Rules").setDesc("add rules to update selected parameters");
    this.rulesDiv = containerEl.createDiv({ cls: "obsidian-f2t-rule-area" });
    this.rulesControl = containerEl.createDiv({ cls: "obsidian-f2t-rule-controls" });
    this.plugin.settings.rules.forEach((rule) => {
      this.addRule(this.rulesDiv, rule.id);
    });
    new import_obsidian4.Setting(this.rulesControl).addButton(async (button) => {
      button.setIcon("square-plus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("add a rule");
      button.onClick(async () => {
        this.addRule(this.rulesDiv);
      });
    });
  }
  addRule(divEl, ruleUUID = "") {
    var _a;
    let cmEditor = null;
    if (ruleUUID === "") {
      ruleUUID = (0, import_crypto.randomUUID)().toString();
      this.plugin.settings.rules.push(Object.assign({}, DEFAULT_RULE_DEFINITION, {
        id: ruleUUID
      }));
    }
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleUUID);
    if (!rule)
      return;
    let propertyNameInput;
    let showFunctionButton;
    let propertyTypeDropdown;
    let propertyDevDropdown;
    let functionResultTextComponent;
    let functionTestButton;
    const rulesDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleLine" });
    rulesDiv.setAttribute("id", ruleUUID);
    const ruleOptionsDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleOptions" });
    ruleOptionsDiv.style.height = "350px;";
    ruleOptionsDiv.style.alignItems = "flex-end";
    if (this.plugin.settings.useTextArea) {
      const ruleOptionsSettings = new import_obsidian4.Setting(ruleOptionsDiv).addTextArea((textArea) => {
        textArea.setPlaceholder("ender valid JS Code");
        textArea.inputEl.setAttribute("style", `height:190px; width:80%;`);
        textArea.onChange(async (value) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
          rule.jsCode = value;
          await this.plugin.saveSettings();
        });
      });
    } else {
      let jsCode = rule.jsCode;
      if (rule.content !== "script") {
        if (rule.buildInCode === "") {
          rule.buildInCode = ((_a = getRuleFunctionById(rule.content)) == null ? void 0 : _a.source) || ruleFunctions[0].source;
        }
        jsCode = rule.buildInCode;
      }
      cmEditor = window.CodeMirror(ruleOptionsDiv, {
        value: jsCode || "function (app, file, tools) { // do not change this line!\n\n  return result; // return you result.\n}",
        mode: "javascript",
        lineNumbers: true,
        // theme: "obsidian",
        indentUnit: 2,
        lineWrapping: false,
        readOnly: false
      });
      if (cmEditor) {
        cmEditor.on("change", (cmEditor2) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
        });
        cmEditor.on("blur", (cmEditor2) => {
          if (rule.content === "script") {
            rule.jsCode = cmEditor2.getValue();
          } else {
            rule.buildInCode = cmEditor2.getValue();
          }
          this.plugin.saveSettings();
        });
      }
      ;
      new import_obsidian4.Setting(ruleOptionsDiv).addButton((button) => {
        functionTestButton = button;
        button.setWarning().setButtonText("Save & Test").onClick(async () => {
          if (cmEditor) {
            let jsCode2 = "";
            if (rule.content === "script") {
              rule.jsCode = cmEditor.getValue();
              jsCode2 = rule.jsCode;
            } else {
              rule.buildInCode = cmEditor.getValue();
              jsCode2 = rule.buildInCode;
            }
            await this.plugin.saveSettings();
            let userFunction = parseJSCode(jsCode2);
            if (typeof userFunction === "string") {
              let errorHint = "See console for details!";
              if (userFunction.contains("Unexpected token")) {
                errorHint = "Did you missed a semicolon (;)?";
              }
              if (functionResultTextComponent)
                functionResultTextComponent.setValue(`Syntax error: ${userFunction}! ${errorHint}`);
            } else {
              if (userFunction) {
                try {
                  const files = this.app.vault.getMarkdownFiles();
                  const result = userFunction(this.app, files[8], this.scriptingTools);
                  if (functionResultTextComponent)
                    functionResultTextComponent.setValue(result.toString());
                  button.buttonEl.removeClass("mod-warning");
                } catch (e) {
                  if (functionResultTextComponent) {
                    functionResultTextComponent.setValue(`Syntax error: ${e.message}! See console for details!`);
                  }
                  console.error("Syntax error. ", e, jsCode2, userFunction);
                }
              } else {
                console.error("syntax error");
              }
            }
          }
        });
      }).addText((text) => {
        functionResultTextComponent = text;
        text.setPlaceholder("function result").setDisabled(true);
        functionResultTextComponent.inputEl.style.width = "600px";
      });
    }
    function showJsFunctionButton(ruleId) {
      var _a2;
      const showCodeButton = ((_a2 = getRuleFunctionById(ruleId)) == null ? void 0 : _a2.source) !== "" || ruleId === "script";
      if (showCodeButton) {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "block";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "360px";
      } else {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "none";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "400px";
      }
    }
    const ruleSettings = new import_obsidian4.Setting(rulesDiv).addButton((button) => {
      button.buttonEl.setAttribute("style", "width:150px; justify-content: left; ");
      button.setButtonText(rule.property || "Select Parameter");
      button.onClick(() => {
        new SelectProperty(this.app, this.knownProperties, rule.typeProperty, (result) => {
          if (result.name !== "") {
            rule.typeProperty = result;
            rule.property = result.name;
            rule.type = result.type;
            if (this.knownProperties.filter((property) => property.name.toLowerCase().includes(rule.property.toLowerCase())).length === 0) {
            }
            ;
            button.setButtonText(result.name);
            this.plugin.saveSettings();
          }
          propertyTypeDropdown.setValue(result.type);
        }).open();
      });
    }).addDropdown((dropdown) => {
      propertyTypeDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:110px");
      dropdown.addOption("", "Select a type");
      dropdown.addOption("aliases", "Aliases");
      dropdown.addOption("checkbox", "Checkbox");
      dropdown.addOption("date", "Date");
      dropdown.addOption("datetime", "Date & Time");
      dropdown.addOption("multitext", "List");
      dropdown.addOption("number", "Number");
      dropdown.addOption("tags", "Tags");
      dropdown.addOption("text", "Text");
      if (rule.type)
        dropdown.setValue(rule.type);
      dropdown.onChange(async (value) => {
        if (value !== "") {
          rule.type = value;
          await this.plugin.saveSettings();
        }
      });
    }).addDropdown((dropdown) => {
      propertyDevDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:400px");
      dropdown.addOption("", "Select a content");
      for (let rule2 of ruleFunctions) {
        dropdown.addOption(rule2.id, rule2.description);
      }
      dropdown.addOption("script", "JavaScript script");
      dropdown.setValue(rule.content);
      dropdown.onChange(async (value) => {
        var _a2, _b, _c;
        let jsCode = "";
        if (value !== "") {
          if (value !== "script") {
            let oldOriginalCode = ((_a2 = getRuleFunctionById(rule.content)) == null ? void 0 : _a2.source) || ruleFunctions[0].source;
            if (rule.buildInCode !== "" && rule.buildInCode !== oldOriginalCode) {
              const shouldProceed = await new AlertModal(
                this.app,
                "Overwrite existing code?",
                "I sees like you have custom code for this rule! Should this be overwritten by default code for this parameter?",
                "Yes",
                "No"
              ).openAndGetValue();
              if (shouldProceed) {
                jsCode = rule.buildInCode = ((_b = getRuleFunctionById(value)) == null ? void 0 : _b.source) || ruleFunctions[0].source;
              } else {
                jsCode = rule.buildInCode;
              }
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            } else {
              jsCode = rule.buildInCode = ((_c = getRuleFunctionById(value)) == null ? void 0 : _c.source) || ruleFunctions[0].source;
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            }
          } else {
            cmEditor == null ? void 0 : cmEditor.setValue(rule.jsCode !== "" ? rule.jsCode : ruleFunctions[0].source);
          }
          rule.content = value;
          showJsFunctionButton(rule.content);
          await this.plugin.saveSettings();
        }
      });
      ruleOptionsDiv.style.display = `${rule.content === "script" && rule.showContent ? "flex" : "none"}`;
    }).addButton(async (button) => {
      showFunctionButton = button;
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-function");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("show & edit code");
      button.onClick(async () => {
        rule.showContent = !rule.showContent;
        ruleOptionsDiv.style.display = `${rule.showContent ? "flex" : "none"}`;
      });
      showFunctionButton.buttonEl.style.display = "none";
    }).addButton(async (button) => {
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-minus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("remove this rule");
      button.onClick(async () => {
        this.plugin.settings.rules.splice(this.plugin.settings.rules.findIndex((value) => value.id === ruleUUID));
        this.removeRule(rulesDiv);
        await this.plugin.saveSettings();
      });
    });
    showJsFunctionButton(rule.content);
    divEl.style.removeProperty("border-top");
  }
  removeRule(rulesDiv) {
    rulesDiv.remove();
  }
};

// main.ts
var FolderTagPlugin = class extends import_obsidian5.Plugin {
  //private oldFolderPaths = new Map<string, string | null>();
  async onload() {
    await this.loadSettings();
    this.tools = new ScriptingTools(this.settings);
    let noticeMessage = "Front Matter Automate 0.0.3\n loading ...";
    const loadingNotice = new import_obsidian5.Notice(noticeMessage, 0);
    noticeMessage = noticeMessage + "\n register events ...";
    loadingNotice.setMessage(noticeMessage);
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules, oldPath);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian5.MarkdownView) {
          const previousFile = this.app.workspace.getActiveFile();
          console.log(`closing file: `, previousFile == null ? void 0 : previousFile.path);
          if (previousFile)
            this.updateFrontmatterParameters(previousFile, this.settings.rules);
        }
      })
    );
    noticeMessage = noticeMessage + "\n initial processing ...";
    loadingNotice.setMessage(noticeMessage);
    this.app.vault.getMarkdownFiles().forEach((file) => {
    });
    noticeMessage = noticeMessage + "\ndone!";
    loadingNotice.setMessage(noticeMessage);
    setTimeout(() => {
      loadingNotice.hide();
    }, 2e3);
    this.addSettingTab(new FolderTagSettingTab(this.app, this));
  }
  async loadSettings() {
    let data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  formatTagName(name) {
    if (name === null)
      return null;
    if (name === void 0)
      return void 0;
    let formatted = name.replace(/\s+/g, this.settings.spaceReplacement);
    formatted = formatted.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, this.settings.specialCharReplacement);
    if (this.settings.lowercaseTags) {
      formatted = formatted.toLowerCase();
    }
    return formatted;
  }
  async updateFileTag(file, oldTagPath) {
    const newTagPath = this.getFolderPathForTag(file);
    const formattedNewPath = newTagPath ? this.formatTagName(newTagPath) : null;
    const newTag = formattedNewPath ? this.settings.tagPrefix + formattedNewPath : null;
    let oldTagToRemove;
    if (oldTagPath) {
      const formattedOldPath = this.formatTagName(oldTagPath);
      if (formattedOldPath) {
        oldTagToRemove = this.settings.tagPrefix + formattedOldPath;
      }
    }
    await this.updateFrontmatterTags(file, newTag, oldTagToRemove);
  }
  getFolderPathForTag(file) {
    const folder = file.parent;
    if (!folder || folder === this.app.vault.getRoot()) {
      return null;
    }
    let pathParts = [];
    let currentFolder = folder;
    while (currentFolder && currentFolder !== this.app.vault.getRoot()) {
      pathParts.unshift(currentFolder.name);
      currentFolder = currentFolder.parent;
    }
    if (this.settings.excludeRootFolder && pathParts.length > 0) {
      pathParts = pathParts.slice(1);
    }
    return pathParts.length > 0 ? pathParts.join("/") : null;
  }
  /**
   * Filters a given file and returns true if it is included in a folder or file list
   * @param file 
   * @param filterMode 'exclude'|'include'
   * @param type 'folders'|'files'
   * @returns 
   */
  filterFile(file, filterMode, type) {
    let result = false;
    const filterArray = type === "folders" ? this.settings[filterMode].selectedFolders : this.settings[filterMode].selectedFiles;
    if (filterArray.length === 0)
      return filterMode === "include" ? false : true;
    const filePath = file.path;
    const fileFolder = this.tools.getFoldersFromPath(file.path);
    const fileName = file.basename + "." + file.extension;
    if (type === "files") {
      result = filterArray.includes(filePath);
    }
    if (type === "folders") {
      filterArray.forEach((path) => {
        result = (fileFolder == null ? void 0 : fileFolder.startsWith(path.slice(1))) || false;
        if (result === true)
          return;
      });
    }
    ;
    return filterMode === "exclude" ? !result : result;
  }
  checkIfFileAllowed(file) {
    let result = false;
    if (this.settings.include.selectedFiles.length > 0) {
      result = this.filterFile(file, "include", "files");
      if (result === true)
        return result;
    }
    if (this.settings.include.selectedFolders.length > 0) {
      result = this.filterFile(file, "include", "folders");
      if (result === true)
        return result;
    }
    result = true;
    if (this.settings.exclude.selectedFiles.length > 0) {
      result = this.filterFile(file, "exclude", "files");
      if (result === false)
        return result;
    }
    if (this.settings.exclude.selectedFolders.length > 0) {
      result = this.filterFile(file, "exclude", "folders");
      if (result === false)
        return result;
    }
    return result;
  }
  formatValue(value, type) {
    switch (type) {
      case "text":
      case "tags":
      case "aliases":
      case "multitext":
        return this.tools.toYamlSafeString(value);
      case "date":
      case "datetime":
        if (typeof value === "number") {
          return new Date(value).toISOString();
        }
        return value.toString();
      case "checkbox":
        return value ? "true" : "false";
      case "number":
        return Number(value);
      default:
        return this.tools.toYamlSafeString(value);
    }
  }
  async updateFrontmatterParameters(file, rules, oldPath) {
    if (!this.checkIfFileAllowed(file)) {
      console.log(`file ${file.path} rejected!`);
      return;
    }
    const currentPathTag = this.formatTagName(this.tools.getFoldersFromPath(file.path));
    const oldPathTag = this.formatTagName(this.tools.getFoldersFromPath(oldPath));
    if (oldPathTag)
      console.log(`update file: "${oldPathTag}" to "${currentPathTag}"`);
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = (cache == null ? void 0 : cache.frontmatter) || {};
    let fxResult;
    const parameterTypes = {};
    rules.forEach((rule) => {
      if (rule.content === "script") {
        const ruleFunction = parseJSCode(rule.jsCode);
        if (typeof ruleFunction !== "function")
          return;
        fxResult = ruleFunction(this.app, file, this.tools);
      } else {
        const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
        if (functionIndex !== -1) {
          fxResult = ruleFunctions[functionIndex].fx(this.app, file, this.tools);
        }
      }
      frontmatter[rule.content] = fxResult;
      parameterTypes[rule.property] = rule.type;
    });
    if (!frontmatter.hasOwnProperty("tags"))
      frontmatter.tags = [];
    if (frontmatter.tags === null)
      frontmatter.tags = [];
    let indexOldPath = frontmatter.tags.indexOf(oldPathTag);
    let indexNewPath = frontmatter.tags.indexOf(currentPathTag);
    if (oldPath) {
      if (frontmatter.tags.includes(oldPathTag)) {
        if (currentPathTag !== "") {
          frontmatter.tags.splice(indexOldPath, 1, currentPathTag);
        } else {
          frontmatter.tags.splice(indexOldPath, 1);
        }
        console.log(`replace Tag "${oldPathTag}" by "${currentPathTag}"`, frontmatter.tags);
      } else {
        if (currentPathTag !== "" && indexNewPath === -1) {
          frontmatter.tags.push(currentPathTag);
          console.log(`add Tag "${currentPathTag}" can't find "${oldPathTag}"`, frontmatter.tags);
        }
      }
    } else {
      if (currentPathTag !== "") {
        if (indexNewPath < 0) {
          frontmatter.tags.push(currentPathTag);
          console.log(`add Tag "${currentPathTag}"`, frontmatter.tags);
        }
      }
    }
    let newFrontmatter = "---\n";
    Object.keys(frontmatter).forEach((key) => {
      if (typeof frontmatter[key] === "object") {
        if (Array.isArray(frontmatter[key])) {
          newFrontmatter += `${this.tools.toYamlSafeString(key)}:
`;
          for (let item of frontmatter[key]) {
            newFrontmatter += `  - ${this.formatValue(item, parameterTypes[key])}
`;
          }
        } else {
          console.error("Can't write objects to YAML", key, frontmatter[key]);
        }
      } else {
        newFrontmatter += `${this.tools.toYamlSafeString(key)}: ${this.formatValue(frontmatter[key], parameterTypes[key])}
`;
      }
    });
    newFrontmatter += "---\n";
    let endOfFrontmatter = content.indexOf("---\n", 3);
    content = newFrontmatter + content.slice(endOfFrontmatter + 4);
    await this.app.vault.modify(file, content);
  }
  async updateFrontmatterTags(file, newTag, oldTagToRemove) {
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    let existingTags = [];
    if (frontmatter && frontmatter[this.settings.tagsPropertyName]) {
      const tagsValue = frontmatter[this.settings.tagsPropertyName];
      if (Array.isArray(tagsValue)) {
        existingTags = tagsValue.filter((tag) => tag != null).map((tag) => String(tag));
      } else if (typeof tagsValue === "string") {
        existingTags = tagsValue.split(/,\s*/).map((tag) => tag.trim()).filter((tag) => tag.length > 0);
      }
    }
    existingTags = existingTags.filter((tag) => {
      if (tag == null)
        return false;
      if (!tag.startsWith(this.settings.tagPrefix))
        return true;
      const tagWithoutPrefix = tag.slice(this.settings.tagPrefix.length);
      return !tagWithoutPrefix.includes("/");
    });
    if (oldTagToRemove) {
      existingTags = existingTags.filter((tag) => tag !== oldTagToRemove);
    }
    if (newTag && !existingTags.includes(newTag)) {
      existingTags.push(newTag);
    }
    let newFrontmatter = {};
    if (frontmatter) {
      newFrontmatter = { ...frontmatter };
      delete newFrontmatter[this.settings.tagsPropertyName];
    }
    let newContent = "";
    if (content.startsWith("---")) {
      const frontmatterEnd = content.indexOf("---", 3) + 3;
      const bodyContent = content.slice(frontmatterEnd);
      let frontmatterContent = Object.entries(newFrontmatter).map(([key, value]) => `${key}: ${value}`).join("\n");
      if (existingTags.length > 0) {
        frontmatterContent += `
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n");
      }
      newContent = `---
${frontmatterContent}
---${bodyContent}`;
    } else {
      if (existingTags.length > 0) {
        newContent = `---
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n") + `
---

${content}`;
      } else {
        return;
      }
    }
    await this.app.vault.modify(file, newContent);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2Zyb250bWF0dGVyLXRvb2xzLnRzIiwgInNyYy90b29scy50cyIsICJzcmMvcnVsZXMudHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9hbGVydEJveC50cyIsICJzcmMvZGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgUGx1Z2luLCBNYXJrZG93blZpZXcsIFBsdWdpbk1hbmlmZXN0LCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIFRleHRDb21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBOb3RpY2V9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCAqIGFzIGZtVG9vbHMgZnJvbSAnLi9zcmMvZnJvbnRtYXR0ZXItdG9vbHMnO1xuaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbi8vaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzLXByb3BlcnRpZXMnO1xuaW1wb3J0IHsgcnVsZUZ1bmN0aW9ucyB9IGZyb20gJy4vc3JjL3J1bGVzJztcbmltcG9ydCB7IHBhcnNlSlNDb2RlLCBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vc3JjL3Rvb2xzJztcbmltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTLCBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgUHJvcGVydHlUeXBlSW5mb30gZnJvbSAnLi9zcmMvdHlwZXMnXG5pbXBvcnQgeyBydW5JbkNvbnRleHQgfSBmcm9tICd2bSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlclRhZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEZvbGRlclRhZ1NldHRpbmdzO1xuICAgIHByaXZhdGUgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xuICAgIC8vcHJpdmF0ZSBvbGRGb2xkZXJQYXRocyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmcgfCBudWxsPigpO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9ICdGcm9udCBNYXR0ZXIgQXV0b21hdGUgMC4wLjNcXG4gbG9hZGluZyAuLi4nO1xuICAgICAgICBjb25zdCBsb2FkaW5nTm90aWNlID0gbmV3IE5vdGljZShub3RpY2VNZXNzYWdlLDApXG4gICAgICAgIC8qXG4gICAgICAgIC8vIFN0b3JlIGluaXRpYWwgZm9sZGVyIHBhdGhzIGZvciBhbGwgZmlsZXNcbiAgICAgICAgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9sZEZvbGRlclBhdGhzLnNldChmaWxlLnBhdGgsIHRoaXMuZ2V0Rm9sZGVyUGF0aEZvclRhZyhmaWxlKSk7XG4gICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG4gcmVnaXN0ZXIgZXZlbnRzIC4uLic7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcbiAgICAgICAgLy8gRmlsZSBjcmVhdGlvbiBoYW5kbGVyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdjcmVhdGUnLCAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLm9sZEZvbGRlclBhdGhzLnNldChmaWxlLnBhdGgsIHRoaXMuZ2V0Rm9sZGVyUGF0aEZvclRhZyhmaWxlKSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy51cGRhdGVGaWxlVGFnKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycyhmaWxlLCB0aGlzLnNldHRpbmdzLnJ1bGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEZpbGUgcmVuYW1lL21vdmUgaGFuZGxlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbigncmVuYW1lJywgKGZpbGUsIG9sZFBhdGgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc3Qgb2xkVGFnUGF0aCA9IHRoaXMub2xkRm9sZGVyUGF0aHMuZ2V0KG9sZFBhdGgpID8/IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc3QgbmV3VGFnUGF0aCA9IHRoaXMuZ2V0Rm9sZGVyUGF0aEZvclRhZyhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLm9sZEZvbGRlclBhdGhzLnNldChmaWxlLnBhdGgsIG5ld1RhZ1BhdGgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycyhmaWxlLCB0aGlzLnNldHRpbmdzLnJ1bGVzLCBvbGRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIC8vIEFsd2F5cyB1cGRhdGUgd2hlbiBtb3ZpbmcgdG8vZnJvbSByb290IGZvbGRlclxuICAgICAgICAgICAgICAgICAgICBpZiAob2xkVGFnUGF0aCAhPT0gbmV3VGFnUGF0aCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgIChvbGRUYWdQYXRoICE9PSBudWxsICYmIG5ld1RhZ1BhdGggPT09IG51bGwpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgKG9sZFRhZ1BhdGggPT09IG51bGwgJiYgbmV3VGFnUGF0aCAhPT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy51cGRhdGVGaWxlVGFnKGZpbGUsIG9sZFRhZ1BhdGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBGaWxlIGNsb3NlIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsZWFmPy52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjbG9zaW5nIGZpbGU6IGAsIHByZXZpb3VzRmlsZT8ucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0ZpbGUpIHRoaXMudXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKHByZXZpb3VzRmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG4gaW5pdGlhbCBwcm9jZXNzaW5nIC4uLic7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcblxuICAgICAgICAvLyBJbml0aWFsIHByb2Nlc3Npbmcgb2YgZXhpc3RpbmcgZmlsZXNcbiAgICAgICAgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICAgICAgICAvL3RoaXMudXBkYXRlRmlsZVRhZyhmaWxlKTtcbiAgICAgICAgICAgIC8vdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgIH0pO1xuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG5kb25lISc7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgbG9hZGluZ05vdGljZS5oaWRlKCk7XG4gICAgICAgIH0sMjAwMClcblxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRm9sZGVyVGFnU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBkYXRhKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZm9ybWF0VGFnTmFtZShuYW1lOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZHtcbiAgICAgICAgaWYgKG5hbWUgPT09IG51bGwpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlyc3QgcmVwbGFjZSBzcGFjZXMgYWNjb3JkaW5nIHRvIHNldHRpbmdzXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSBuYW1lLnJlcGxhY2UoL1xccysvZywgdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRoZW4gcmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnMgKHByZXNlcnZpbmcgbGV0dGVycyB3aXRoIGRpYWNyaXRpY3MpXG4gICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHRoaXMuc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb252ZXJ0IHRvIGxvd2VyY2FzZSBpZiBjb25maWd1cmVkXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmxvd2VyY2FzZVRhZ3MpIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgdXBkYXRlRmlsZVRhZyhmaWxlOiBURmlsZSwgb2xkVGFnUGF0aD86IHN0cmluZyB8IG51bGwpIHtcbiAgICAgICAgY29uc3QgbmV3VGFnUGF0aCA9IHRoaXMuZ2V0Rm9sZGVyUGF0aEZvclRhZyhmaWxlKTtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkTmV3UGF0aCA9IG5ld1RhZ1BhdGggPyB0aGlzLmZvcm1hdFRhZ05hbWUobmV3VGFnUGF0aCkgOiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgbW92aW5nIHRvIHJvb3QsIG5ld1RhZyB3aWxsIGJlIG51bGxcbiAgICAgICAgY29uc3QgbmV3VGFnID0gZm9ybWF0dGVkTmV3UGF0aCA/IHRoaXMuc2V0dGluZ3MudGFnUHJlZml4ICsgZm9ybWF0dGVkTmV3UGF0aCA6IG51bGw7XG4gICAgICAgIFxuICAgICAgICAvLyBGb3JtYXQgdGhlIG9sZCB0YWcgZm9yIHJlbW92YWxcbiAgICAgICAgbGV0IG9sZFRhZ1RvUmVtb3ZlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChvbGRUYWdQYXRoKSB7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRPbGRQYXRoID0gdGhpcy5mb3JtYXRUYWdOYW1lKG9sZFRhZ1BhdGgpO1xuICAgICAgICAgICAgaWYgKGZvcm1hdHRlZE9sZFBhdGgpIHtcbiAgICAgICAgICAgICAgICBvbGRUYWdUb1JlbW92ZSA9IHRoaXMuc2V0dGluZ3MudGFnUHJlZml4ICsgZm9ybWF0dGVkT2xkUGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlRnJvbnRtYXR0ZXJUYWdzKGZpbGUsIG5ld1RhZywgb2xkVGFnVG9SZW1vdmUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Rm9sZGVyUGF0aEZvclRhZyhmaWxlOiBURmlsZSk6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBjb25zdCBmb2xkZXIgPSBmaWxlLnBhcmVudDtcbiAgICAgICAgaWYgKCFmb2xkZXIgfHwgZm9sZGVyID09PSB0aGlzLmFwcC52YXVsdC5nZXRSb290KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBhdGhQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGV0IGN1cnJlbnRGb2xkZXI6IFRGb2xkZXIgfCBudWxsID0gZm9sZGVyO1xuXG4gICAgICAgIHdoaWxlIChjdXJyZW50Rm9sZGVyICYmIGN1cnJlbnRGb2xkZXIgIT09IHRoaXMuYXBwLnZhdWx0LmdldFJvb3QoKSkge1xuICAgICAgICAgICAgcGF0aFBhcnRzLnVuc2hpZnQoY3VycmVudEZvbGRlci5uYW1lKTtcbiAgICAgICAgICAgIGN1cnJlbnRGb2xkZXIgPSBjdXJyZW50Rm9sZGVyLnBhcmVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmV4Y2x1ZGVSb290Rm9sZGVyICYmIHBhdGhQYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBwYXRoUGFydHMgPSBwYXRoUGFydHMuc2xpY2UoMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGF0aFBhcnRzLmxlbmd0aCA+IDAgPyBwYXRoUGFydHMuam9pbignLycpIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaWx0ZXJzIGEgZ2l2ZW4gZmlsZSBhbmQgcmV0dXJucyB0cnVlIGlmIGl0IGlzIGluY2x1ZGVkIGluIGEgZm9sZGVyIG9yIGZpbGUgbGlzdFxuICAgICAqIEBwYXJhbSBmaWxlIFxuICAgICAqIEBwYXJhbSBmaWx0ZXJNb2RlICdleGNsdWRlJ3wnaW5jbHVkZSdcbiAgICAgKiBAcGFyYW0gdHlwZSAnZm9sZGVycyd8J2ZpbGVzJ1xuICAgICAqIEByZXR1cm5zIFxuICAgICAqL1xuICAgIGZpbHRlckZpbGUoZmlsZTogVEZpbGUsIGZpbHRlck1vZGU6IHN0cmluZywgdHlwZTpzdHJpbmcpOmJvb2xlYW4ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IGZpbHRlckFycmF5ID0gKHR5cGU9PT0nZm9sZGVycycpID8gdGhpcy5zZXR0aW5nc1tmaWx0ZXJNb2RlXS5zZWxlY3RlZEZvbGRlcnMgOiB0aGlzLnNldHRpbmdzW2ZpbHRlck1vZGVdLnNlbGVjdGVkRmlsZXM7XG4gICAgICAgIGlmIChmaWx0ZXJBcnJheS5sZW5ndGggPT09IDApIHJldHVybiAoZmlsdGVyTW9kZSA9PT0gJ2luY2x1ZGUnKT8gZmFsc2UgOiB0cnVlO1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgY29uc3QgZmlsZUZvbGRlciA9IHRoaXMudG9vbHMuZ2V0Rm9sZGVyc0Zyb21QYXRoKGZpbGUucGF0aCk7XG4gICAgICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5iYXNlbmFtZSArICcuJyArIGZpbGUuZXh0ZW5zaW9uO1xuICAgICAgICBcbiAgICAgICAgaWYgKHR5cGUgPT09ICdmaWxlcycpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckFycmF5LmluY2x1ZGVzKGZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZSA9PT0gJ2ZvbGRlcnMnKSB7XG4gICAgICAgICAgICBmaWx0ZXJBcnJheS5mb3JFYWNoKHBhdGggPT4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZpbGVGb2xkZXI/LnN0YXJ0c1dpdGgocGF0aC5zbGljZSgxKSkgfHwgZmFsc2U7IC8vIHJlbW92ZSByb290ICcvJ1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKGZpbHRlck1vZGUgPT09ICdleGNsdWRlJyk/ICFyZXN1bHQgOiByZXN1bHQ7XG4gICAgfVxuXG4gICAgY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgaW5jbHVkZSBmaWxlcyBsaXN0XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZpbHRlckZpbGUoZmlsZSwgJ2luY2x1ZGUnLCAnZmlsZXMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybiByZXN1bHQ7IC8vIGZpbGUgaXMgaW4gaW5jbHVkZS1saXN0XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZpbHRlckZpbGUoZmlsZSwgJ2luY2x1ZGUnLCAnZm9sZGVycycpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gdHJ1ZSkgcmV0dXJuIHJlc3VsdDsgLy8gZmlsZSBpcyBpbiBhIGZvbGRlciBpbnNpZGUgdGhlIGluY2x1ZGUtbGlzdFxuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZmlsZXMgaW4gdGhlIGV4Y2x1ZGUgZmlsZXMgbGlzdC5cbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZmlsdGVyRmlsZShmaWxlLCAnZXhjbHVkZScsICdmaWxlcycpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHJldHVybiByZXN1bHQ7IC8vIGZpbGUgaXMgaW4gZXhjbHVkZS1saXN0XG4gICAgICAgIH0gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZm9sZGVycyBpbiB0aGUgaW5jbHVkZSBmb2xkZXJzIGxpc3QuXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZpbHRlckZpbGUoZmlsZSwgJ2V4Y2x1ZGUnLCAnZm9sZGVycycpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHJldHVybiByZXN1bHQ7IC8vIGZpbGUgaXMgaW4gYSBmb2xkZXIgaW5zaWRlIHRoZSBpbmNsdWRlLWxpc3RcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIGZvcm1hdFZhbHVlKHZhbHVlOmFueSwgdHlwZTpzdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd0ZXh0JzpcbiAgICAgICAgICAgIGNhc2UgJ3RhZ3MnOlxuICAgICAgICAgICAgY2FzZSAnYWxpYXNlcyc6XG4gICAgICAgICAgICBjYXNlICdtdWx0aXRleHQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgY2FzZSAnZGF0ZSc6XG4gICAgICAgICAgICBjYXNlICdkYXRldGltZSc6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPyAndHJ1ZScgOiAnZmFsc2UnO1xuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9vbHMudG9ZYW1sU2FmZVN0cmluZyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZTogVEZpbGUsIHJ1bGVzOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbltdLCBvbGRQYXRoPzogc3RyaW5nKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLmNoZWNrSWZGaWxlQWxsb3dlZChmaWxlKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYGZpbGUgJHtmaWxlLnBhdGh9IHJlamVjdGVkIWApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3VycmVudFBhdGhUYWcgPSB0aGlzLmZvcm1hdFRhZ05hbWUodGhpcy50b29scy5nZXRGb2xkZXJzRnJvbVBhdGgoZmlsZS5wYXRoKSk7XG4gICAgICAgIGNvbnN0IG9sZFBhdGhUYWcgPSB0aGlzLmZvcm1hdFRhZ05hbWUodGhpcy50b29scy5nZXRGb2xkZXJzRnJvbVBhdGgob2xkUGF0aCkpXG4gICAgICAgIGlmIChvbGRQYXRoVGFnKSBjb25zb2xlLmxvZyhgdXBkYXRlIGZpbGU6IFwiJHtvbGRQYXRoVGFnfVwiIHRvIFwiJHtjdXJyZW50UGF0aFRhZ31cImApO1xuICAgICAgICBsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyIHx8IHt9O1xuICAgICAgICBsZXQgZnhSZXN1bHQ6YW55O1xuICAgICAgICBjb25zdCBwYXJhbWV0ZXJUeXBlcyA9IHt9XG5cbiAgICAgICAgLy8gYXBwbHkgYWxsIHJ1bGVzIHRvIGZyb250bWF0dGVyXG4gICAgICAgIHJ1bGVzLmZvckVhY2gocnVsZSA9PiB7XG4gICAgICAgICAgICBpZiAocnVsZS5jb250ZW50ID09PSAnc2NyaXB0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJ1bGVGdW5jdGlvbiA9IHBhcnNlSlNDb2RlKHJ1bGUuanNDb2RlKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJ1bGVGdW5jdGlvbiAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGZ4UmVzdWx0ID0gcnVsZUZ1bmN0aW9uKHRoaXMuYXBwLCBmaWxlLCB0aGlzLnRvb2xzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnVuY3Rpb25JbmRleCA9IHJ1bGVGdW5jdGlvbnMuZmluZEluZGV4KGZ4ID0+IGZ4LmlkID09PSBydWxlLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvbkluZGV4IT09LTEpe1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGBleGVjdXRlIHJ1bGUgZm9yICR7cnVsZS5wcm9wZXJ0eX0gJHtydWxlLmNvbnRlbnR9IGZvciBmaWxlICR7ZmlsZS5wYXRofWApO1xuICAgICAgICAgICAgICAgICAgICBmeFJlc3VsdCA9IHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF0uZngodGhpcy5hcHAsIGZpbGUsIHRoaXMudG9vbHMpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJ1bGUuY29udGVudCwgcnVsZUZ1bmN0aW9uc1tmdW5jdGlvbkluZGV4XSA/IGZ4UmVzdWx0IDogJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZyb250bWF0dGVyW3J1bGUuY29udGVudF0gPSBmeFJlc3VsdDsgLy8gdXBkYXRlIG9yIGFkZCB0aGUgbmV3IHZhbHVlXG4gICAgICAgICAgICBwYXJhbWV0ZXJUeXBlc1tydWxlLnByb3BlcnR5XSA9IHJ1bGUudHlwZTsgLy8gYWRkIHR5cGVzIHRvIHBhcmFtZXRlciBsaXN0LlxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIHVwZGF0ZSBmb2xkZXIgdGFnXG4gICAgICAgIGlmICghZnJvbnRtYXR0ZXIuaGFzT3duUHJvcGVydHkoJ3RhZ3MnKSkgZnJvbnRtYXR0ZXIudGFncyA9IFtdO1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIudGFncyA9PT0gbnVsbCkgZnJvbnRtYXR0ZXIudGFncyA9IFtdO1xuICAgICAgICBsZXQgaW5kZXhPbGRQYXRoID0gZnJvbnRtYXR0ZXIudGFncy5pbmRleE9mKG9sZFBhdGhUYWcpO1xuICAgICAgICBsZXQgaW5kZXhOZXdQYXRoID0gZnJvbnRtYXR0ZXIudGFncy5pbmRleE9mKGN1cnJlbnRQYXRoVGFnKTtcbiAgICAgICAgaWYgKG9sZFBhdGgpIHsgXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIudGFncy5pbmNsdWRlcyhvbGRQYXRoVGFnKSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UGF0aFRhZyE9PScnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyLnRhZ3Muc3BsaWNlKGluZGV4T2xkUGF0aCwxLGN1cnJlbnRQYXRoVGFnKTsgLy8gcmVwbGFjZSB0aGUgdGFnXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXIudGFncy5zcGxpY2UoaW5kZXhPbGRQYXRoLDEpOyAvLyBkZWxldGUgdGhlIHRhZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgcmVwbGFjZSBUYWcgXCIke29sZFBhdGhUYWd9XCIgYnkgXCIke2N1cnJlbnRQYXRoVGFnfVwiYCxmcm9udG1hdHRlci50YWdzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXRoVGFnIT09JycgJiYgaW5kZXhOZXdQYXRoPT09LTEpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXIudGFncy5wdXNoKGN1cnJlbnRQYXRoVGFnKTsgLy8gYWRkIHRoZSB0YWdcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYGFkZCBUYWcgXCIke2N1cnJlbnRQYXRoVGFnfVwiIGNhbid0IGZpbmQgXCIke29sZFBhdGhUYWd9XCJgLGZyb250bWF0dGVyLnRhZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UGF0aFRhZyE9PScnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4TmV3UGF0aDwwKXsgLy8gbmV3IHBhdGggZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlci50YWdzLnB1c2goY3VycmVudFBhdGhUYWcpOyAvLyBhZGQgdGhlIHRhZ1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgYWRkIFRhZyBcIiR7Y3VycmVudFBhdGhUYWd9XCJgLGZyb250bWF0dGVyLnRhZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlYnVpbGQgZnJvbnRtYXR0ZXIgWUFNTFxuICAgICAgICBsZXQgbmV3RnJvbnRtYXR0ZXIgPSAnLS0tXFxuJztcbiAgICAgICAgT2JqZWN0LmtleXMoZnJvbnRtYXR0ZXIpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZnJvbnRtYXR0ZXJba2V5XSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmcm9udG1hdHRlcltrZXldKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgJHt0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcoa2V5KX06XFxuYDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBmcm9udG1hdHRlcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgICAtICR7dGhpcy5mb3JtYXRWYWx1ZShpdGVtLCBwYXJhbWV0ZXJUeXBlc1trZXldKX1cXG5gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbid0IHdyaXRlIG9iamVjdHMgdG8gWUFNTFwiLGtleSwgZnJvbnRtYXR0ZXJba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgJHt0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcoa2V5KX06ICR7dGhpcy5mb3JtYXRWYWx1ZShmcm9udG1hdHRlcltrZXldLCBwYXJhbWV0ZXJUeXBlc1trZXldKX1cXG5gXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIG5ld0Zyb250bWF0dGVyICs9ICctLS1cXG4nO1xuXG4gICAgICAgIGxldCBlbmRPZkZyb250bWF0dGVyID0gY29udGVudC5pbmRleE9mKCctLS1cXG4nLDMpO1xuICAgICAgICBjb250ZW50ID0gbmV3RnJvbnRtYXR0ZXIgKyBjb250ZW50LnNsaWNlKGVuZE9mRnJvbnRtYXR0ZXIrNCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coY29udGVudCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZUZyb250bWF0dGVyVGFncyhmaWxlOiBURmlsZSwgbmV3VGFnOiBzdHJpbmcgfCBudWxsLCBvbGRUYWdUb1JlbW92ZT86IHN0cmluZykge1xuICAgICAgICBsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHRhZ3MgKGhhbmRsaW5nIGJvdGggYXJyYXkgYW5kIHN0cmluZyBmb3JtYXRzKVxuICAgICAgICBsZXQgZXhpc3RpbmdUYWdzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lXSkge1xuICAgICAgICAgICAgY29uc3QgdGFnc1ZhbHVlID0gZnJvbnRtYXR0ZXJbdGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhZ3NWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBleGlzdGluZ1RhZ3MgPSB0YWdzVmFsdWUuZmlsdGVyKHRhZyA9PiB0YWcgIT0gbnVsbCkubWFwKHRhZyA9PiBTdHJpbmcodGFnKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YWdzVmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzID0gdGFnc1ZhbHVlLnNwbGl0KC8sXFxzKi8pXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodGFnID0+IHRhZy50cmltKCkpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodGFnID0+IHRhZy5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSBhbnkgZXhpc3RpbmcgZm9sZGVyIHBhdGggdGFncyAod2l0aCBjdXJyZW50IHByZWZpeClcbiAgICAgICAgZXhpc3RpbmdUYWdzID0gZXhpc3RpbmdUYWdzLmZpbHRlcih0YWcgPT4ge1xuICAgICAgICAgICAgaWYgKHRhZyA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXRhZy5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MudGFnUHJlZml4KSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBjb25zdCB0YWdXaXRob3V0UHJlZml4ID0gdGFnLnNsaWNlKHRoaXMuc2V0dGluZ3MudGFnUHJlZml4Lmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gIXRhZ1dpdGhvdXRQcmVmaXguaW5jbHVkZXMoJy8nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3BlY2lmaWNhbGx5IHJlbW92ZSB0aGUgb2xkIHRhZyBpZiBwcm92aWRlZFxuICAgICAgICBpZiAob2xkVGFnVG9SZW1vdmUpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nVGFncyA9IGV4aXN0aW5nVGFncy5maWx0ZXIodGFnID0+IHRhZyAhPT0gb2xkVGFnVG9SZW1vdmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRoZSBuZXcgdGFnIGlmIHByb3ZpZGVkIGFuZCBub3QgYWxyZWFkeSBwcmVzZW50XG4gICAgICAgIGlmIChuZXdUYWcgJiYgIWV4aXN0aW5nVGFncy5pbmNsdWRlcyhuZXdUYWcpKSB7XG4gICAgICAgICAgICBleGlzdGluZ1RhZ3MucHVzaChuZXdUYWcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyXG4gICAgICAgIGxldCBuZXdGcm9udG1hdHRlcjogYW55ID0ge307XG4gICAgICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICAgICAgbmV3RnJvbnRtYXR0ZXIgPSB7Li4uZnJvbnRtYXR0ZXJ9O1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBvbGQgdGFncyBwcm9wZXJ0eSB0byBlbnN1cmUgcHJvcGVyIGZvcm1hdHRpbmdcbiAgICAgICAgICAgIGRlbGV0ZSBuZXdGcm9udG1hdHRlclt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWVdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZWNvbnN0cnVjdCB0aGUgZnJvbnRtYXR0ZXIgd2l0aCBwcm9wZXIgWUFNTCBmb3JtYXRcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQgPSAnJztcbiAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgIC8vIFJlcGxhY2UgZXhpc3RpbmcgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyRW5kID0gY29udGVudC5pbmRleE9mKCctLS0nLCAzKSArIDM7XG4gICAgICAgICAgICBjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UoZnJvbnRtYXR0ZXJFbmQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBCdWlsZCBuZXcgZnJvbnRtYXR0ZXIgY29udGVudFxuICAgICAgICAgICAgbGV0IGZyb250bWF0dGVyQ29udGVudCA9IE9iamVjdC5lbnRyaWVzKG5ld0Zyb250bWF0dGVyKVxuICAgICAgICAgICAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4gYCR7a2V5fTogJHt2YWx1ZX1gKVxuICAgICAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIHRhZ3MgaW4gcHJvcGVyIFlBTUwgYXJyYXkgZm9ybWF0IGlmIHdlIGhhdmUgYW55XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlckNvbnRlbnQgKz0gYFxcbiR7dGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lfTpcXG5gICtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzLm1hcCh0YWcgPT4gYCAgLSAke3RhZ31gKS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbmV3Q29udGVudCA9IGAtLS1cXG4ke2Zyb250bWF0dGVyQ29udGVudH1cXG4tLS0ke2JvZHlDb250ZW50fWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBPbmx5IGNyZWF0ZSBmcm9udG1hdHRlciBpZiB3ZSBoYXZlIHRhZ3MgdG8gYWRkXG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50ID0gYC0tLVxcbiR7dGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lfTpcXG5gICtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzLm1hcCh0YWcgPT4gYCAgLSAke3RhZ31gKS5qb2luKCdcXG4nKSArXG4gICAgICAgICAgICAgICAgICAgIGBcXG4tLS1cXG5cXG4ke2NvbnRlbnR9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTm8gdGFncyB0byBhZGQsIHJldHVybiBvcmlnaW5hbCBjb250ZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVGV4dENvbXBvbmVudCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgZm1Ub29scyBmcm9tICcuL2Zyb250bWF0dGVyLXRvb2xzJztcclxuaW1wb3J0IHsgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scyc7XHJcbmltcG9ydCB7IGdldFJ1bGVGdW5jdGlvbkJ5SWQsIHJ1bGVGdW5jdGlvbnMsIFJ1bGVGdW5jdGlvbiB9IGZyb20gJy4vcnVsZXMnO1xyXG5pbXBvcnQgeyBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgREVGQVVMVF9SVUxFX0RFRklOSVRJT04sIFByb3BlcnR5VHlwZUluZm99IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSAnLi9hbGVydEJveCc7XHJcbmltcG9ydCB7IG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCwgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7IC8vIEFkanVzdCBwYXRoIGFzIG5lZWRlZFxyXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBGb2xkZXJUYWdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IGFueTsgLy9Gb2xkZXJUYWdQbHVnaW47XHJcbiAgICBydWxlc0RpdjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBydWxlc0NvbnRyb2w6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICBrbm93blR5cGVzOiBhbnk7XHJcbiAgICBzY3JpcHRpbmdUb29sczogU2NyaXB0aW5nVG9vbHM7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IGFueSAvKkZvbGRlclRhZ1BsdWdpbiovKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuc2NyaXB0aW5nVG9vbHMgPSBuZXcgU2NyaXB0aW5nVG9vbHModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSBmbVRvb2xzLmdldFByb3BlcnRpZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKHRoaXMuYXBwKTtcclxuICAgICAgICB0aGlzLmtub3duVHlwZXMgPSBmbVRvb2xzLmdldFR5cGVzRnJvbU1ldGFkYXRhTWFuYWdlcih0aGlzLmFwcCk7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdGcm9udCBtYXR0ZXIgYXV0b21hdGUgVjAuMC40IGFscGhhJyB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdUYWcgcHJlZml4JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ09wdGlvbmFsIHByZWZpeCB0byBhZGQgYmVmb3JlIGZvbGRlciBwYXRoIHRhZ3MnKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncHJlZml4LycpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnUHJlZml4KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ1ByZWZpeCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0V4Y2x1ZGUgcm9vdCBmb2xkZXInKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnSWYgZW5hYmxlZCwgdGhlIHJvb3QgZm9sZGVyIG5hbWUgd2lsbCBiZSBleGNsdWRlZCBmcm9tIHRoZSB0YWcnKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlUm9vdEZvbGRlcilcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlUm9vdEZvbGRlciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1RhZ3MgcHJvcGVydHkgbmFtZScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdGcm9udG1hdHRlciBwcm9wZXJ0eSBuYW1lIHRvIHN0b3JlIHRhZ3MgKGRlZmF1bHQ6IFwidGFnc1wiKScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd0YWdzJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWUgPSB2YWx1ZSB8fCAndGFncyc7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnU3BhY2UgcmVwbGFjZW1lbnQnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIHJlcGxhY2Ugc3BhY2VzIGluIGZvbGRlciBuYW1lcyAoZGVmYXVsdDogXCJfXCIpJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ18nKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNwYWNlUmVwbGFjZW1lbnQpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudCA9IHZhbHVlIHx8ICdfJztcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdTcGVjaWFsIGNoYXJhY3RlciByZXBsYWNlbWVudCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdDaGFyYWN0ZXIgdG8gcmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnMgKGRlZmF1bHQ6IFwiX1wiKSAtIHByZXNlcnZlcyBsZXR0ZXJzIHdpdGggZGlhY3JpdGljcycpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdfJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGVjaWFsQ2hhclJlcGxhY2VtZW50KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQgPSB2YWx1ZSB8fCAnXyc7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29udmVydCB0byBsb3dlcmNhc2UnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQ29udmVydCBhbGwgdGFncyB0byBsb3dlcmNhc2UnKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb3dlcmNhc2VUYWdzKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxvd2VyY2FzZVRhZ3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0V4Y2x1ZGUgRmlsZXMgYW5kIEZvbGRlcnMnKVxyXG4gICAgICAgIC5zZXREZXNjKGBDdXJyZW50bHkgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGh9IGZvbGRlcnMgYW5kICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aH0gZmlsZXMgd2lsbCBiZSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUubW9kZX1kLmApXHJcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXIteCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnRXhjbHVkZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUubW9kZSB8fCAnZXhjbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuZGlzcGxheSB8fCAnZm9sZGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBpbmNsdWRlLCBleGNsdWRlIG9wdGlvbiBoaWRkZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7ICAgICAgICAgIFxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnSW5jbHVkZSBGaWxlcyBhbmQgRm9sZGVycycpXHJcbiAgICAgICAgLnNldERlc2MoYEN1cnJlbnRseSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aH0gZm9sZGVycyBhbmQgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMubGVuZ3RofSBmaWxlcyB3aWxsIGJlICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5tb2RlfWQgZXZlbiB3aGVuIGluIGV4Y2x1ZGVkIEZvbGRlcnMuYClcclxuICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ2ZvbGRlci1jaGVjaycpXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnSW5jbHVkZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUubW9kZSB8fCAnaW5jbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuZGlzcGxheSB8fCAnZm9sZGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBpbmNsdWRlLCBpbmNsdWRlIG9wdGlvbiBoaWRkZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7ICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdSdWxlcycpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdhZGQgcnVsZXMgdG8gdXBkYXRlIHNlbGVjdGVkIHBhcmFtZXRlcnMnKTtcclxuXHJcbiAgICAgICAgdGhpcy5ydWxlc0RpdiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJvYnNpZGlhbi1mMnQtcnVsZS1hcmVhXCIgfSlcclxuICAgICAgICB0aGlzLnJ1bGVzQ29udHJvbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJvYnNpZGlhbi1mMnQtcnVsZS1jb250cm9sc1wiIH0pXHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZm9yRWFjaChydWxlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hZGRSdWxlKHRoaXMucnVsZXNEaXYscnVsZS5pZCk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5ydWxlc0NvbnRyb2wpXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYXN5bmMgKGJ1dHRvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEljb24oJ3NxdWFyZS1wbHVzJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0Q2xhc3MoJ29ic2lkaWFuLWYydC1zbWFsbEJ1dHRvbicpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldFRvb2x0aXAoJ2FkZCBhIHJ1bGUnKVxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUnVsZSh0aGlzLnJ1bGVzRGl2KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvKiBUT0RPIGFkZCBjbGVhciBhbGwgcnVsZXMgZnVuY3Rpb25hbGl0eSBcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihhc3luYyAoYnV0dG9uKSA9PiB7IFxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEljb24oJ3NxdWFyZS14Jyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0Q2xhc3MoJ29ic2lkaWFuLWYydC1zbWFsbEJ1dHRvbicpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldFRvb2x0aXAoJ3JlbW92ZSBhbGwgcnVsZXMnKVxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmVBbGxSdWxlcycpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAqL1xyXG4gICAgfVxyXG5cclxuICAgIGFkZFJ1bGUoZGl2RWw6IEhUTUxEaXZFbGVtZW50LCBydWxlVVVJRCA9ICcnKSB7XHJcbiAgICAgICAgbGV0IGNtRWRpdG9yOiBDb2RlTWlycm9yLkVkaXRvciB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgIGlmIChydWxlVVVJRCA9PT0gJycpe1xyXG4gICAgICAgICAgICBydWxlVVVJRCA9IHJhbmRvbVVVSUQoKS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5wdXNoKE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfUlVMRV9ERUZJTklUSU9OLCB7XHJcbiAgICAgICAgICAgICAgICBpZDogcnVsZVVVSUQsXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcnVsZTpGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZpbmQocnVsZSA9PiBydWxlLmlkID09PSBydWxlVVVJRCk7XHJcbiAgICAgICAgaWYoIXJ1bGUpIHJldHVybjtcclxuICAgICAgICBsZXQgcHJvcGVydHlOYW1lSW5wdXQgOiBUZXh0Q29tcG9uZW50O1xyXG4gICAgICAgIGxldCBzaG93RnVuY3Rpb25CdXR0b24gOiBCdXR0b25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IHByb3BlcnR5VHlwZURyb3Bkb3duIDogRHJvcGRvd25Db21wb25lbnQ7XHJcbiAgICAgICAgbGV0IHByb3BlcnR5RGV2RHJvcGRvd24gOiBEcm9wZG93bkNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBmdW5jdGlvblRlc3RCdXR0b246IEJ1dHRvbkNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBydWxlc0RpdiA9IGRpdkVsLmNyZWF0ZURpdih7IGNsczogXCJvYnNpZGlhbi1mMnQtcnVsZUxpbmVcIiB9KTtcclxuICAgICAgICBydWxlc0Rpdi5zZXRBdHRyaWJ1dGUoJ2lkJyxydWxlVVVJRClcclxuICAgICAgICBjb25zdCBydWxlT3B0aW9uc0RpdiA9IGRpdkVsLmNyZWF0ZURpdih7IGNsczogXCJvYnNpZGlhbi1mMnQtcnVsZU9wdGlvbnNcIiB9KTtcclxuICAgICAgICAvL3J1bGVPcHRpb25zRGl2LnN0eWxlLmRpc3BsYXk9ICdub25lJztcclxuICAgICAgICAvL3J1bGVPcHRpb25zRGl2LnN0eWxlLndpZHRoPSAnNzAwcHgnXHJcbiAgICAgICAgcnVsZU9wdGlvbnNEaXYuc3R5bGUuaGVpZ2h0PSAnMzUwcHg7JztcclxuICAgICAgICBydWxlT3B0aW9uc0Rpdi5zdHlsZS5hbGlnbkl0ZW1zPSAnZmxleC1lbmQnO1xyXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VUZXh0QXJlYSkge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlT3B0aW9uc1NldHRpbmdzID0gbmV3IFNldHRpbmcocnVsZU9wdGlvbnNEaXYpXHJcbiAgICAgICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dEFyZWEgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRBcmVhLnNldFBsYWNlaG9sZGVyKCdlbmRlciB2YWxpZCBKUyBDb2RlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWEuaW5wdXRFbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYGhlaWdodDoxOTBweDsgd2lkdGg6ODAlO2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRBcmVhLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25UZXN0QnV0dG9uKSBmdW5jdGlvblRlc3RCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoJ21vZC13YXJuaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuanNDb2RlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgQ29kZU1pcnJvciA1XHJcbiAgICAgICAgICAgIGxldCBqc0NvZGUgPSBydWxlLmpzQ29kZTtcclxuICAgICAgICAgICAgaWYgKHJ1bGUuY29udGVudCAhPT0gJ3NjcmlwdCcpIHtcclxuICAgICAgICAgICAgICAgIGlmIChydWxlLmJ1aWxkSW5Db2RlID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHJ1bGUuY29udGVudCk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuYnVpbGRJbkNvZGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY21FZGl0b3IgPSAod2luZG93IGFzIGFueSkuQ29kZU1pcnJvcihydWxlT3B0aW9uc0Rpdiwge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGpzQ29kZSB8fCBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcblxcbiAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgICAgICAgICAgICAgbW9kZTogXCJqYXZhc2NyaXB0XCIsXHJcbiAgICAgICAgICAgICAgICBsaW5lTnVtYmVyczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIC8vIHRoZW1lOiBcIm9ic2lkaWFuXCIsXHJcbiAgICAgICAgICAgICAgICBpbmRlbnRVbml0OiAyLCAgXHJcbiAgICAgICAgICAgICAgICBsaW5lV3JhcHBpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgcmVhZE9ubHk6IGZhbHNlLCAgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoY21FZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgIGNtRWRpdG9yLm9uKCdjaGFuZ2UnLCAoY21FZGl0b3I6IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uVGVzdEJ1dHRvbikgZnVuY3Rpb25UZXN0QnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjbUVkaXRvci5vbignYmx1cicsIChjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5jb250ZW50ID09PSAnc2NyaXB0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLmpzQ29kZSA9IGNtRWRpdG9yLmdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZSA9IGNtRWRpdG9yLmdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICAgICAgLy8gQWRkIGEgYnV0dG9uIHRvIHNhdmUgdGhlIGNvZGVcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcocnVsZU9wdGlvbnNEaXYpXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKChidXR0b24pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblRlc3RCdXR0b24gPSBidXR0b247XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiU2F2ZSAmIFRlc3RcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbUVkaXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGpzQ29kZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmpzQ29kZSA9IGNtRWRpdG9yLmdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5qc0NvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuYnVpbGRJbkNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXNlckZ1bmN0aW9uID0gIHBhcnNlSlNDb2RlKGpzQ29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHVzZXJGdW5jdGlvbiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXJyb3JIaW50ID0gXCJTZWUgY29uc29sZSBmb3IgZGV0YWlscyFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uLmNvbnRhaW5zKCdVbmV4cGVjdGVkIHRva2VuJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JIaW50ID0gXCJEaWQgeW91IG1pc3NlZCBhIHNlbWljb2xvbiAoOyk/XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5zZXRWYWx1ZShgU3ludGF4IGVycm9yOiAke3VzZXJGdW5jdGlvbn0hICR7ZXJyb3JIaW50fWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHVzZXJGdW5jdGlvbih0aGlzLmFwcCwgZmlsZXNbOF0sIHRoaXMuc2NyaXB0aW5nVG9vbHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKHJlc3VsdC50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5yZW1vdmVDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5zZXRWYWx1ZShgU3ludGF4IGVycm9yOiAke2UubWVzc2FnZX0hIFNlZSBjb25zb2xlIGZvciBkZXRhaWxzIWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlN5bnRheCBlcnJvci4gXCIsIGUsIGpzQ29kZSwgdXNlckZ1bmN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJzeW50YXggZXJyb3JcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQgPSB0ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2Z1bmN0aW9uIHJlc3VsdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LmlucHV0RWwuc3R5bGUud2lkdGggPSAnNjAwcHgnO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvd0pzRnVuY3Rpb25CdXR0b24ocnVsZUlkOnN0cmluZykge1xyXG4gICAgICAgICAgICBjb25zdCBzaG93Q29kZUJ1dHRvbjpib29sZWFuID0gXHJcbiAgICAgICAgICAgICAgICAoZ2V0UnVsZUZ1bmN0aW9uQnlJZChydWxlSWQpPy5zb3VyY2UgIT09ICcnKSB8fFxyXG4gICAgICAgICAgICAgICAgKHJ1bGVJZCA9PT0gJ3NjcmlwdCcpO1xyXG4gICAgICAgICAgICBpZiAoIHNob3dDb2RlQnV0dG9uICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNob3dGdW5jdGlvbkJ1dHRvbikgc2hvd0Z1bmN0aW9uQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlEZXZEcm9wZG93bikgcHJvcGVydHlEZXZEcm9wZG93bi5zZWxlY3RFbC5zdHlsZS53aWR0aCA9IFwiMzYwcHhcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChzaG93RnVuY3Rpb25CdXR0b24pIHNob3dGdW5jdGlvbkJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlEZXZEcm9wZG93bikgcHJvcGVydHlEZXZEcm9wZG93bi5zZWxlY3RFbC5zdHlsZS53aWR0aCA9IFwiNDAwcHhcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcnVsZVNldHRpbmdzID0gbmV3IFNldHRpbmcocnVsZXNEaXYpXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6MTUwcHg7IGp1c3RpZnktY29udGVudDogbGVmdDsgJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dChydWxlLnByb3BlcnR5IHx8ICdTZWxlY3QgUGFyYW1ldGVyJylcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgZm1Ub29scy5TZWxlY3RQcm9wZXJ0eSh0aGlzLmFwcCwgdGhpcy5rbm93blByb3BlcnRpZXMsIHJ1bGUudHlwZVByb3BlcnR5LCAocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubmFtZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudHlwZVByb3BlcnR5ID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5wcm9wZXJ0eSA9IHJlc3VsdC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS50eXBlID0gcmVzdWx0LnR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5rbm93blByb3BlcnRpZXMuZmlsdGVyKChwcm9wZXJ0eSkgPT4gcHJvcGVydHkubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHJ1bGUucHJvcGVydHkudG9Mb3dlckNhc2UoKSkpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcHJvcGVydHlUeXBlRHJvcGRvd24uc2V0RGlzYWJsZWQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KHJlc3VsdC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5VHlwZURyb3Bkb3duLnNldFZhbHVlKHJlc3VsdC50eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0aGUgc2V0dGluZ3MgdGFiIHRvIHNob3cgbmV3IHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSkub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcHJvcGVydHlUeXBlRHJvcGRvd24gPSBkcm9wZG93bjtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDoxMTBweCcpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiXCIsIFwiU2VsZWN0IGEgdHlwZVwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImFsaWFzZXNcIiwgXCJBbGlhc2VzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiY2hlY2tib3hcIiwgXCJDaGVja2JveFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImRhdGVcIiwgXCJEYXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZGF0ZXRpbWVcIiwgXCJEYXRlICYgVGltZVwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIm11bHRpdGV4dFwiLCBcIkxpc3RcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJudW1iZXJcIiwgXCJOdW1iZXJcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJ0YWdzXCIsIFwiVGFnc1wiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInRleHRcIiwgXCJUZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ1bGUudHlwZSkgZHJvcGRvd24uc2V0VmFsdWUocnVsZS50eXBlKTtcclxuICAgICAgICAgICAgICAgIC8vZHJvcGRvd24uc2V0RGlzYWJsZWQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudHlwZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcHJvcGVydHlEZXZEcm9wZG93biA9IGRyb3Bkb3duO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3dpZHRoOjQwMHB4Jyk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJcIiwgXCJTZWxlY3QgYSBjb250ZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgcnVsZSBvZiBydWxlRnVuY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKHJ1bGUuaWQsIHJ1bGUuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImZ1bGxQYXRoXCIsIFwiRnVsbCBwYXRoIGFuZCBmaWxlbmFtZVwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInBhdGhcIiwgXCJGdWxsIHBhdGhcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJyb290Rm9sZGVyXCIsIFwiUm9vdCBGb2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJuYW1lXCIsIFwiRmlsZW5hbWVcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJuYW1lRXh0XCIsIFwiRmlsZW5hbWUgd2l0aCBFeHRlbnNpb25cIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJhbGlhc0Zyb21QYXRoXCIsIFwiYWRkIGFuIEFsaWFzIGZvcm0gZnVsbCBwYXRoXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZGF0ZVRpbWVDcmVhdGVkXCIsIFwiRGF0ZSAoYW5kIFRpbWUpIGNyZWF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJkYXRlVGltZU1vZGlmaWVkXCIsIFwiRGF0ZSAoYW5kIFRpbWUpIG1vZGlmaWVkXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZmlsZVNpemVCeXRlc1wiLCBcIkZpbGUgU2l6ZSBpbiBCeXRlc1wiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImZpbGVTaXplU3RyaW5nXCIsIFwiRmlsZSBTaXplIGFzIFRleHRcIik7XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwic2NyaXB0XCIsIFwiSmF2YVNjcmlwdCBzY3JpcHRcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZShydWxlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGpzQ29kZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnc2NyaXB0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9sZE9yaWdpbmFsQ29kZSA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZS5jb250ZW50KT8uc291cmNlIHx8IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChydWxlLmJ1aWxkSW5Db2RlICE9PSAnJykgJiYgKHJ1bGUuYnVpbGRJbkNvZGUgIT09IG9sZE9yaWdpbmFsQ29kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRQcm9jZWVkID0gYXdhaXQgbmV3IEFsZXJ0TW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdPdmVyd3JpdGUgZXhpc3RpbmcgY29kZT8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0kgc2VlcyBsaWtlIHlvdSBoYXZlIGN1c3RvbSBjb2RlIGZvciB0aGlzIHJ1bGUhIFNob3VsZCB0aGlzIGJlIG92ZXJ3cml0dGVuIGJ5IGRlZmF1bHQgY29kZSBmb3IgdGhpcyBwYXJhbWV0ZXI/JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdZZXMnLCAnTm8nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkub3BlbkFuZEdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZFByb2NlZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5idWlsZEluQ29kZSA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQodmFsdWUpPy5zb3VyY2UgfHwgcnVsZUZ1bmN0aW9uc1swXS5zb3VyY2U7IC8vIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuYnVpbGRJbkNvZGU7IC8vIGtlZXAgdGhlIGV4aXN0aW5nIGNvZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY21FZGl0b3I/LnNldFZhbHVlKGpzQ29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5idWlsZEluQ29kZSA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQodmFsdWUpPy5zb3VyY2UgfHwgcnVsZUZ1bmN0aW9uc1swXS5zb3VyY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY21FZGl0b3I/LnNldFZhbHVlKGpzQ29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtRWRpdG9yPy5zZXRWYWx1ZShydWxlLmpzQ29kZSE9PScnID8gcnVsZS5qc0NvZGUgOiBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5jb250ZW50ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheSA9IGAkeyhydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSA/ICdmbGV4JyA6ICdub25lJ31gO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93SnNGdW5jdGlvbkJ1dHRvbihydWxlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJ1bGVPcHRpb25zRGl2LnN0eWxlLmRpc3BsYXkgPSBgJHsocnVsZS5jb250ZW50ID09PSAnc2NyaXB0JykgJiYgKHJ1bGUuc2hvd0NvbnRlbnQpID8gJ2ZsZXgnIDogJ25vbmUnfWA7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYXN5bmMgKGJ1dHRvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2hvd0Z1bmN0aW9uQnV0dG9uID0gYnV0dG9uO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDozMHB4Jyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0SWNvbignc3F1YXJlLWZ1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0Q2xhc3MoJ29ic2lkaWFuLWYydC1zbWFsbEJ1dHRvbicpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldFRvb2x0aXAoJ3Nob3cgJiBlZGl0IGNvZGUnKVxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUuc2hvd0NvbnRlbnQgPSAhcnVsZS5zaG93Q29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICBydWxlT3B0aW9uc0Rpdi5zdHlsZS5kaXNwbGF5ID0gYCR7KHJ1bGUuc2hvd0NvbnRlbnQpID8gJ2ZsZXgnIDogJ25vbmUnfWA7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgc2hvd0Z1bmN0aW9uQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihhc3luYyAoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3dpZHRoOjMwcHgnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRJY29uKCdzcXVhcmUtbWludXMnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDbGFzcygnb2JzaWRpYW4tZjJ0LXNtYWxsQnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0VG9vbHRpcCgncmVtb3ZlIHRoaXMgcnVsZScpXHJcbiAgICAgICAgICAgICAgICBidXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuc3BsaWNlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZpbmRJbmRleCh2YWx1ZSA9PiB2YWx1ZS5pZCA9PT0gcnVsZVVVSUQpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJ1bGUocnVsZXNEaXYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHNob3dKc0Z1bmN0aW9uQnV0dG9uKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgZGl2RWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2JvcmRlci10b3AnKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVSdWxlKHJ1bGVzRGl2OiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICAgIHJ1bGVzRGl2LnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxufSIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgU3VnZ2VzdE1vZGFsLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlUeXBlSW5mbywgUHJvcGVydHlUeXBlfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BST1BFUlRZX1RZUEVfSU5GTzogUHJvcGVydHlUeXBlSW5mbyA9IHtcclxuICAgIG5hbWUgOiBcIlwiLFxyXG4gICAgdHlwZSA6IFwiXCIsXHJcbiAgICBpc0FycmF5OiBmYWxzZSxcclxuICAgIHZhbHVlczogW10sXHJcbiAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJyxcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIGFsbCBhdmFpbGFibGUgcHJvcGVydGllcyB3aXRoIHRoZWlyIHR5cGUgaW5mb3JtYXRpb25cclxuICogQHBhcmFtIGFwcCBUaGUgT2JzaWRpYW4gQXBwIGluc3RhbmNlXHJcbiAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byBhbiBhcnJheSBvZiBQcm9wZXJ0eVR5cGVJbmZvXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUHJvcGVydGllc1dpdGhUeXBlcyhhcHA6IEFwcCk6IFByb21pc2U8UHJvcGVydHlUeXBlSW5mb1tdPiB7XHJcbiAgICAvLyBUcnkgdG8gZ2V0IHJlZ2lzdGVyZWQgcHJvcGVydGllcyAoZmFsbGJhY2sgdG8gZW1wdHkgYXJyYXkgaWYgQVBJIGNoYW5nZWQpXHJcbiAgICBjb25zdCByZWdpc3RlcmVkUHJvcHMgPSBhd2FpdCBnZXRSZWdpc3RlcmVkUHJvcGVydGllc1NhZmUoYXBwKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IGFkZGl0aW9uYWwgcHJvcGVydGllcyBmb3VuZCBpbiBub3Rlc1xyXG4gICAgY29uc3QgZmlsZVByb3BzID0gYXdhaXQgZ2V0UHJvcGVydGllc0Zyb21GaWxlcyhhcHApO1xyXG4gICAgXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgKGZhdm9yIHJlZ2lzdGVyZWQgcHJvcGVydGllcyB3aGVuIGR1cGxpY2F0ZXMgZXhpc3QpXHJcbiAgICBjb25zdCBjb21iaW5lZCA9IG5ldyBNYXA8c3RyaW5nLCBQcm9wZXJ0eVR5cGVJbmZvPigpO1xyXG4gICAgXHJcbiAgICAvLyBBZGQgcHJvcGVydGllcyBmb3VuZCBpbiBmaWxlcyBmaXJzdFxyXG4gICAgZmlsZVByb3BzLmZvckVhY2gocHJvcCA9PiB7XHJcbiAgICAgICAgY29tYmluZWQuc2V0KHByb3AubmFtZSwgcHJvcCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gVGhlbiBvdmVycmlkZSB3aXRoIHJlZ2lzdGVyZWQgcHJvcGVydGllcyAod2hpY2ggaGF2ZSBtb3JlIGNvbXBsZXRlIHR5cGUgaW5mbylcclxuICAgIHJlZ2lzdGVyZWRQcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xyXG4gICAgICAgIGNvbWJpbmVkLnNldChwcm9wLm5hbWUsIHByb3ApO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBBcnJheS5mcm9tKGNvbWJpbmVkLnZhbHVlcygpKS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBQcm9wZXJ0aWVzIGZyb20gTWV0YWRhdGFNYW5hZ2VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvcGVydGllc0Zyb21NZXRhZGF0YU1hbmFnZXIoYXBwOiBBcHApOiBQcm9wZXJ0eVR5cGVJbmZvW10ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YU1hbmFnZXIgPSAoYXBwIGFzIGFueSkubWV0YWRhdGFUeXBlTWFuYWdlcjtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImdldCBwcm9wZXJ0aWVzOlwiLG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobWV0YWRhdGFNYW5hZ2VyLnByb3BlcnRpZXMpLm1hcCggKHZhbHVlOmFueSk6UHJvcGVydHlUeXBlSW5mbyA9PiAoe1xyXG4gICAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxyXG4gICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXHJcbiAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgfSkpLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgYWNjZXNzIHByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YSBNYW5hZ2VyXCIsIGUpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IFR5cGVzIGZyb20gTWV0YWRhdGFNYW5hZ2VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKGFwcDogQXBwKTogYW55IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnZXQgdHlwZXM6XCIsbWV0YWRhdGFNYW5hZ2VyKTtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhtZXRhZGF0YU1hbmFnZXIucmVnaXN0ZXJlZFR5cGVXaWRnZXRzKS5tYXAoICh2YWx1ZTphbnksIGluZGV4LCBhcnJheSk6UHJvcGVydHlUeXBlICA9PiAoe1xyXG4gICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxyXG4gICAgICAgICAgICBpY29uOiB2YWx1ZS5pY29uLFxyXG4gICAgICAgICAgICBqc1R5cGU6ICcnLFxyXG4gICAgICAgIH0pKS5zb3J0KChhLCBiKSA9PiBhLnR5cGUubG9jYWxlQ29tcGFyZShiLnR5cGUpKTtcclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGFjY2VzcyBwcm9wZXJ0aWVzIGZyb20gTWV0YWRhdGEgTWFuYWdlclwiLCBlKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFNhZmUgbWV0aG9kIHRvIGdldCByZWdpc3RlcmVkIHByb3BlcnRpZXMgdGhhdCB3b24ndCB0aHJvdyBpZiBBUEkgY2hhbmdlc1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZFByb3BlcnRpZXNTYWZlKGFwcDogQXBwKTogUHJvbWlzZTxQcm9wZXJ0eVR5cGVJbmZvW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgY29uc29sZS5sb2cobWV0YWRhdGFNYW5hZ2VyKTtcclxuICAgICAgICBpZiAoIW1ldGFkYXRhTWFuYWdlcikgcmV0dXJuIFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgd2F5cyB0byBnZXQgcHJvcGVydGllcyBiYXNlZCBvbiBPYnNpZGlhbiB2ZXJzaW9uXHJcbiAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YU1hbmFnZXIuZ2V0QWxsRnJvbnRtYXR0ZXJUeXBlcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAvLyBPbGRlciBPYnNpZGlhbiB2ZXJzaW9uc1xyXG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlclR5cGVzID0gbWV0YWRhdGFNYW5hZ2VyLmdldEFsbEZyb250bWF0dGVyVHlwZXMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZyb250bWF0dGVyVHlwZXMubWFwKChuYW1lOiBzdHJpbmcpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsIC8vIERlZmF1bHQgdHlwZSBpZiB3ZSBjYW4ndCBnZXQgbW9yZSBpbmZvXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJ1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbWV0YWRhdGFNYW5hZ2VyLmdldFByb3BlcnRpZXMgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgLy8gTmV3ZXIgT2JzaWRpYW4gdmVyc2lvbnMgbWlnaHQgdXNlIHRoaXNcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG1ldGFkYXRhTWFuYWdlci5nZXRQcm9wZXJ0aWVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhwcm9wZXJ0aWVzKS5tYXAoKFtuYW1lLCB0eXBlXTogW3N0cmluZywgYW55XSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlb2YgdHlwZSA9PT0gJ3N0cmluZycgPyB0eXBlIDogJ3N0cmluZycsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJ1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZG4ndCBhY2Nlc3MgcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzOlwiLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNjYW5zIGZpbGVzIGZvciBhZGRpdGlvbmFsIHByb3BlcnRpZXMgd2l0aCB0eXBlIGluZmVyZW5jZVxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvcGVydGllc0Zyb21GaWxlcyhhcHA6IEFwcCk6IFByb21pc2U8UHJvcGVydHlUeXBlSW5mb1tdPiB7XHJcbiAgICBjb25zdCBmaWxlcyA9IGFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICBjb25zdCBwcm9wZXJ0eU1hcCA9IG5ldyBNYXA8c3RyaW5nLCB7IHZhbHVlczogU2V0PGFueT4sIHR5cGVzOiBTZXQ8c3RyaW5nPiB9PigpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMuc2xpY2UoMCwgMTAwMCkpIHsgLy8gTGltaXQgdG8gMTAwMCBmaWxlcyBmb3IgcGVyZm9ybWFuY2VcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3Bvc2l0aW9uJykgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9wZXJ0eU1hcC5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eU1hcC5zZXQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IG5ldyBTZXQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzOiBuZXcgU2V0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BEYXRhID0gcHJvcGVydHlNYXAuZ2V0KGtleSkhO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BEYXRhLnZhbHVlcy5hZGQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BEYXRhLnR5cGVzLmFkZChpbmZlclR5cGVGcm9tVmFsdWUodmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIEFycmF5LmZyb20ocHJvcGVydHlNYXAuZW50cmllcygpKS5tYXAoKFtuYW1lLCBkYXRhXSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHR5cGUgPSBkZXRlcm1pbmVQcmltYXJ5VHlwZShkYXRhLnR5cGVzKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICB0eXBlLFxyXG4gICAgICAgICAgICBpc0FycmF5OiBkYXRhLnR5cGVzLmhhcygnYXJyYXknKSxcclxuICAgICAgICAgICAgdmFsdWVzOiBkYXRhLnZhbHVlcy5zaXplID4gMCA/IEFycmF5LmZyb20oZGF0YS52YWx1ZXMpLm1hcChTdHJpbmcpIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBzb3VyY2U6ICdpbmZlcnJlZCdcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXRlcm1pbmVzIHRoZSBwcmltYXJ5IHR5cGUgZnJvbSBhIFNldCBvZiBvYnNlcnZlZCB0eXBlc1xyXG4gKiBAcGFyYW0gdHlwZXMgU2V0IG9mIG9ic2VydmVkIHR5cGVzIGZvciBhIHByb3BlcnR5XHJcbiAqIEByZXR1cm5zIFRoZSBtb3N0IHNwZWNpZmljIHR5cGUgd2UgY2FuIGRldGVybWluZVxyXG4gKi9cclxuZnVuY3Rpb24gZGV0ZXJtaW5lUHJpbWFyeVR5cGUodHlwZXM6IFNldDxzdHJpbmc+KTogc3RyaW5nIHtcclxuICAgIC8vIEhhbmRsZSBlbXB0eSBjYXNlIChzaG91bGRuJ3QgaGFwcGVuIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIHVzIHRvIGNoZWNrKVxyXG4gICAgaWYgKHR5cGVzLnNpemUgPT09IDApIHJldHVybiAnc3RyaW5nJztcclxuICAgIFxyXG4gICAgLy8gSWYgb25seSBvbmUgdHlwZSBvYnNlcnZlZCwgdXNlIHRoYXRcclxuICAgIGlmICh0eXBlcy5zaXplID09PSAxKSByZXR1cm4gdHlwZXMudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xyXG4gICAgXHJcbiAgICAvLyBQcmlvcml0eSBvcmRlciBmb3IgdHlwZSByZXNvbHV0aW9uXHJcbiAgICBjb25zdCB0eXBlUHJpb3JpdHkgPSBbXHJcbiAgICAgICAgJ2RhdGUnLFxyXG4gICAgICAgICdkYXRldGltZScsXHJcbiAgICAgICAgJ2Jvb2xlYW4nLFxyXG4gICAgICAgICdudW1iZXInLFxyXG4gICAgICAgICdhcnJheScsXHJcbiAgICAgICAgJ211bHRpdGV4dCcsXHJcbiAgICAgICAgJ3N0cmluZycgLy8gZmFsbGJhY2tcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8vIFJldHVybiB0aGUgaGlnaGVzdCBwcmlvcml0eSB0eXBlIHdlIGZpbmRcclxuICAgIGZvciAoY29uc3QgdHlwZSBvZiB0eXBlUHJpb3JpdHkpIHtcclxuICAgICAgICBpZiAodHlwZXMuaGFzKHR5cGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRmluYWwgZmFsbGJhY2tcclxuICAgIHJldHVybiAnc3RyaW5nJztcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIHR5cGUgaW5mZXJlbmNlIHdpdGggYmV0dGVyIGRhdGUgZGV0ZWN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmZlclR5cGVGcm9tVmFsdWUodmFsdWU6IGFueSk6IHN0cmluZyB7XHJcbiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiAnbnVsbCc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGFycmF5IGZpcnN0XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBhcnJheSBlbGVtZW50IHR5cGVzXHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRUeXBlcyA9IG5ldyBTZXQodmFsdWUubWFwKGluZmVyVHlwZUZyb21WYWx1ZSkpO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudFR5cGVzLnNpemUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgYXJyYXk8JHtlbGVtZW50VHlwZXMudmFsdWVzKCkubmV4dCgpLnZhbHVlfT5gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAnYXJyYXknO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBiYXNpYyB0eXBlc1xyXG4gICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcclxuICAgICAgICBjYXNlICdib29sZWFuJzogcmV0dXJuICdib29sZWFuJztcclxuICAgICAgICBjYXNlICdudW1iZXInOiByZXR1cm4gJ251bWJlcic7XHJcbiAgICAgICAgY2FzZSAnb2JqZWN0JzogcmV0dXJuICdvYmplY3QnOyAvLyBmb3IgZnV0dXJlIGV4cGFuc2lvblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBNdXN0IGJlIHN0cmluZyBhdCB0aGlzIHBvaW50IC0gY2hlY2sgZm9yIHNwZWNpYWwgc3RyaW5nIGZvcm1hdHNcclxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy8gSVNPIERhdGUgKFlZWVktTU0tREQpXHJcbiAgICAgICAgaWYgKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLy50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2RhdGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBJU08gRGF0ZVRpbWVcclxuICAgICAgICBpZiAoL15cXGR7NH0tXFxkezJ9LVxcZHsyfVtUIF1cXGR7Mn06XFxkezJ9OlxcZHsyfS8udGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdkYXRldGltZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE9ic2lkaWFuIHRhZ1xyXG4gICAgICAgIGlmICh2YWx1ZS5zdGFydHNXaXRoKCcjJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuICd0YWcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGVmYXVsdCB0byBzdHJpbmdcclxuICAgIHJldHVybiAnc3RyaW5nJztcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsdWUodmFsdWU6IHVua25vd24sIGluZGV4OiBudW1iZXIsIGFycmF5OiB1bmtub3duW10pOiB1bmtub3duIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignRnVuY3Rpb24gbm90IGltcGxlbWVudGVkLicpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2VsZWN0UHJvcGVydHkgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8UHJvcGVydHlUeXBlSW5mbz4ge1xyXG4gICAgcHJpdmF0ZSBvblN1Ym1pdDogKHJlc3VsdDogUHJvcGVydHlUeXBlSW5mbykgPT4gdm9pZDtcclxuICAgIHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvIHwgdW5kZWZpbmVkO1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOlByb3BlcnR5VHlwZUluZm9bXTtcclxuICAgIHR5cGVkVGV4dDogc3RyaW5nO1xyXG4gICAgbmV3VGV4dEZsYWc6IEJvb2xlYW47XHJcblxyXG4gICAgY29uc3RydWN0b3IgKGFwcDpBcHAsIGtub3duUHJvcGVydGllczpQcm9wZXJ0eVR5cGVJbmZvW10sIHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvIHwgdW5kZWZpbmVkLCBvblN1Ym1pdDogKHJlc3VsdDogUHJvcGVydHlUeXBlSW5mbykgPT4gdm9pZCkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xyXG4gICAgICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcclxuICAgICAgICB0aGlzLnR5cGVkVGV4dCA9ICcnO1xyXG4gICAgICAgIHRoaXMubmV3VGV4dEZsYWcgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMua25vd25Qcm9wZXJ0aWVzID0ga25vd25Qcm9wZXJ0aWVzO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJucyBhbGwgYXZhaWxhYmxlIHN1Z2dlc3Rpb25zLlxyXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFByb3BlcnR5VHlwZUluZm9bXSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5rbm93blByb3BlcnRpZXMuZmlsdGVyKChwcm9wZXJ0eSkgPT4gcHJvcGVydHkubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKTtcclxuICAgICAgICB0aGlzLm5ld1RleHRGbGFnID0gKHJlc3VsdC5sZW5ndGggPT09IDApO1xyXG4gICAgICAgIHRoaXMudHlwZWRUZXh0ID0gcXVlcnk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIG9uT3BlbigpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKHRoaXMucHJvcGVydHkubmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignbm8gcHJvcGVydHkgc2VsZWN0ZWQhJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0VGl0bGUoJ1NlbGVjdCBvciB0eXBlIGEgcHJvcGVydHkgbmFtZScpO1xyXG4gICAgfVxyXG4gICAgLy8gUmVuZGVycyBlYWNoIHN1Z2dlc3Rpb24gaXRlbS5cclxuICAgIHJlbmRlclN1Z2dlc3Rpb24ocHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8sIGVsOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICBlbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBwcm9wZXJ0eS5uYW1lIH0pO1xyXG4gICAgICBlbC5jcmVhdGVFbCgnc21hbGwnLCB7IHRleHQ6IHByb3BlcnR5LnR5cGUgfSk7XHJcbiAgICB9XHJcbiAgICBvbkNsb3NlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLm5ld1RleHRGbGFnICYmIHRoaXMucHJvcGVydHkpIHtcclxuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lID0gdGhpcy50eXBlZFRleHQ7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcGVydHkudHlwZSA9ICd0ZXh0JztcclxuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLnByb3BlcnR5KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGVyZm9ybSBhY3Rpb24gb24gdGhlIHNlbGVjdGVkIHN1Z2dlc3Rpb24uXHJcbiAgICBvbkNob29zZVN1Z2dlc3Rpb24ocHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZ0IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhga2V5Ym9hcmQgJHt0aGlzLnR5cGVkVGV4dH0gJHt0aGlzLm5ld1RleHRGbGFnfWAsIHByb3BlcnR5KVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZygnb25DaG9vc2VTdWdnZXN0aW9uJywgZXZ0KVxyXG4gICAgICAgIHRoaXMub25TdWJtaXQocHJvcGVydHkpO1xyXG4gICAgfVxyXG4gIH1cclxuIiwgImltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdzIH0gZnJvbSAnLi90eXBlcydcclxuLyoqXHJcbiAqIFBhcnNlIGEgSmF2YVNjcmlwdCBmdW5jdGlvbiwgY2xlYW4gY29tbWVudHMgYW5kIGRlZmluZSB0aGUgZnVuY3Rpb24gXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IGpzQ29kZVxyXG4gKiBAcmV0dXJuIHsqfSAgeyhGdW5jdGlvbiB8IHN0cmluZyB8IHVuZGVmaW5lZCl9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKU0NvZGUoanNDb2RlOnN0cmluZyk6IEZ1bmN0aW9uIHwgc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIGZ1bmN0aW9uIHBhcnNlRnVuY3Rpb24gKGpzQ29kZTogc3RyaW5nKTogRnVuY3Rpb24gfCBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAganNDb2RlID0gY2xlYW5Db2RlU3RyaW5nKGpzQ29kZSk7XHJcbiAgICAgICAgdmFyIGZ1bmNSZWcgPSAvZnVuY3Rpb24gKlxcKChbXigpXSopXFwpWyBcXG5cXHRdKnsoLiopfS9nbWk7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gZnVuY1JlZy5leGVjKGpzQ29kZS5yZXBsYWNlKC9cXG4vZywgJyAnKSk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB2YXIgYXJncyA9IG1hdGNoWzFdLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgYXJncy5wdXNoKG1hdGNoWzJdKTtcclxuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Vycm9yIHBhcnNpbmcgSlMgZnVuY3Rpb24hJywgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gZXJyb3IubWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHBhcnNlRnVuY3Rpb24oanNDb2RlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFucyBhIEphdmFTY3JpcHQvVHlwZVNjcmlwdCBjb2RlIHN0cmluZyBieSByZW1vdmluZyBjb21tZW50cy5cclxuICogVGhpcyBmdW5jdGlvbiBoYW5kbGVzIGJvdGggc2luZ2xlLWxpbmUgY29tbWVudHMgKGAvLyAuLi5gKSBhbmRcclxuICogbXVsdGktbGluZSBjb21tZW50cyAoYC8qIC4uLiAqXFwvYCkuIEl0IGFsc28gY29ycmVjdGx5IGhhbmRsZXNcclxuICogY29tbWVudHMgd2l0aGluIHN0cmluZ3MgYW5kIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb2RlU3RyaW5nIFRoZSBjb2RlIHN0cmluZyB0byBjbGVhbi5cclxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNsZWFuZWQgY29kZSBzdHJpbmcgd2l0aCBjb21tZW50cyByZW1vdmVkLlxyXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IElmIHRoZSBpbnB1dCBpcyBub3QgYSBzdHJpbmcuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5Db2RlU3RyaW5nKGNvZGVTdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBFbnN1cmUgdGhlIGlucHV0IGlzIGEgc3RyaW5nXHJcbiAgICBpZiAodHlwZW9mIGNvZGVTdHJpbmcgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0lucHV0IG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvLyBGbGFncyB0byB0cmFjayB0aGUgY3VycmVudCBwYXJzaW5nIGNvbnRleHRcclxuICAgIGxldCBpbk11bHRpTGluZUNvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGxldCBpblNpbmdsZUxpbmVDb21tZW50OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBsZXQgaW5TdHJpbmc6ICdcIicgfCBcIidcIiB8IG51bGwgPSBudWxsOyAvLyBUcmFja3MgaWYgaW5zaWRlIHNpbmdsZSBvciBkb3VibGUgcXVvdGVzXHJcbiAgICBsZXQgaW5SZWdFeHA6IGJvb2xlYW4gPSBmYWxzZTsgLy8gVHJhY2tzIGlmIGluc2lkZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsXHJcbiAgXHJcbiAgICAvLyBUaGUgcmVzdWx0aW5nIHN0cmluZyB3aXRob3V0IGNvbW1lbnRzXHJcbiAgICBsZXQgY2xlYW5lZENvZGU6IHN0cmluZyA9ICcnO1xyXG4gICAgLy8gQ3VycmVudCBpbmRleCBpbiB0aGUgaW5wdXQgc3RyaW5nXHJcbiAgICBsZXQgaTogbnVtYmVyID0gMDtcclxuICBcclxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgaW5wdXQgc3RyaW5nIGNoYXJhY3RlciBieSBjaGFyYWN0ZXJcclxuICAgIHdoaWxlIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgY29uc3QgY2hhcjogc3RyaW5nID0gY29kZVN0cmluZ1tpXTtcclxuICAgICAgY29uc3QgbmV4dENoYXI6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGNvZGVTdHJpbmdbaSArIDFdOyAvLyBVc2UgdW5kZWZpbmVkIGZvciBwb3RlbnRpYWwgZW5kIG9mIHN0cmluZ1xyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIG11bHRpLWxpbmUgY29tbWVudCAtLS1cclxuICAgICAgaWYgKGluTXVsdGlMaW5lQ29tbWVudCkge1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB0aGUgZW5kIG9mIHRoZSBtdWx0aS1saW5lIGNvbW1lbnQgJyovJ1xyXG4gICAgICAgIGlmIChjaGFyID09PSAnKicgJiYgbmV4dENoYXIgPT09ICcvJykge1xyXG4gICAgICAgICAgaW5NdWx0aUxpbmVDb21tZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcqLydcclxuICAgICAgICAgIGNvbnRpbnVlOyAvLyBNb3ZlIHRvIHRoZSBuZXh0IGl0ZXJhdGlvblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpKys7IC8vIFNraXAgdGhlIGNoYXJhY3RlciBpbnNpZGUgdGhlIGNvbW1lbnRcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHNpbmdsZS1saW5lIGNvbW1lbnQgLS0tXHJcbiAgICAgIGlmIChpblNpbmdsZUxpbmVDb21tZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBlbmQgb2YgdGhlIGxpbmUgKG5ld2xpbmUgb3IgY2FycmlhZ2UgcmV0dXJuKVxyXG4gICAgICAgIGlmIChjaGFyID09PSAnXFxuJyB8fCBjaGFyID09PSAnXFxyJykge1xyXG4gICAgICAgICAgaW5TaW5nbGVMaW5lQ29tbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gS2VlcCB0aGUgbmV3bGluZSBjaGFyYWN0ZXJcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpKys7IC8vIFNraXAgdGhlIGNoYXJhY3RlciBpbnNpZGUgdGhlIGNvbW1lbnRcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHN0cmluZyBsaXRlcmFsIC0tLVxyXG4gICAgICBpZiAoaW5TdHJpbmcpIHtcclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgY2xvc2VzIHRoZSBzdHJpbmdcclxuICAgICAgICBpZiAoY2hhciA9PT0gaW5TdHJpbmcpIHtcclxuICAgICAgICAgIGluU3RyaW5nID0gbnVsbDsgLy8gRXhpdCBzdHJpbmcgc3RhdGVcclxuICAgICAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICdcXFxcJykge1xyXG4gICAgICAgICAgLy8gSGFuZGxlIGVzY2FwZWQgY2hhcmFjdGVycyB3aXRoaW4gc3RyaW5ncyAoZS5nLiwgXCJpdFxcJ3NcIilcclxuICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEFkZCB0aGUgYmFja3NsYXNoXHJcbiAgICAgICAgICBpKys7IC8vIE1vdmUgdG8gdGhlIG5leHQgY2hhcmFjdGVyICh0aGUgZXNjYXBlZCBvbmUpXHJcbiAgICAgICAgICBpZiAoaSA8IGNvZGVTdHJpbmcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjb2RlU3RyaW5nW2ldOyAvLyBBZGQgdGhlIGVzY2FwZWQgY2hhcmFjdGVyXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpKys7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQWRkIHRoZSBjaGFyYWN0ZXIgdG8gdGhlIHJlc3VsdCBpZiBpdCdzIHBhcnQgb2YgdGhlIHN0cmluZ1xyXG4gICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgICAvLyAtLS0gU3RhdGU6IEluc2lkZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsIC0tLVxyXG4gICAgICAgaWYgKGluUmVnRXhwKSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBjaGFyYWN0ZXIgY2xvc2VzIHRoZSByZWdleCBsaXRlcmFsXHJcbiAgICAgICAgICAvLyBOb3RlOiBUaGlzIGRvZXNuJ3QgaGFuZGxlIHJlZ2V4IGZsYWdzIHBlcmZlY3RseSBidXQgY292ZXJzIGJhc2ljIGNhc2VzLlxyXG4gICAgICAgICAgaWYgKGNoYXIgPT09ICcvJykge1xyXG4gICAgICAgICAgICAgIGluUmVnRXhwID0gZmFsc2U7IC8vIEV4aXQgcmVnZXggc3RhdGVcclxuICAgICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAgICAgLy8gSGFuZGxlIGVzY2FwZWQgY2hhcmFjdGVycyB3aXRoaW4gcmVnZXggKGUuZy4sIC9cXC8vKVxyXG4gICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEFkZCB0aGUgYmFja3NsYXNoXHJcbiAgICAgICAgICAgICAgaSsrOyAvLyBNb3ZlIHRvIHRoZSBuZXh0IGNoYXJhY3RlclxyXG4gICAgICAgICAgICAgIGlmIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjb2RlU3RyaW5nW2ldOyAvLyBBZGQgdGhlIGVzY2FwZWQgY2hhcmFjdGVyXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIEFkZCB0aGUgY2hhcmFjdGVyIHRvIHRoZSByZXN1bHQgaWYgaXQncyBwYXJ0IG9mIHRoZSByZWdleFxyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyAtLS0gRGVmYXVsdCBTdGF0ZTogQ2hlY2sgZm9yIGNvbW1lbnQvc3RyaW5nL3JlZ2V4IHN0YXJ0cyAtLS1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIG11bHRpLWxpbmUgY29tbWVudCAnLyonXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycgJiYgbmV4dENoYXIgPT09ICcqJykge1xyXG4gICAgICAgIGluTXVsdGlMaW5lQ29tbWVudCA9IHRydWU7XHJcbiAgICAgICAgaSArPSAyOyAvLyBTa2lwIHRoZSAnLyonXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIHNpbmdsZS1saW5lIGNvbW1lbnQgJy8vJ1xyXG4gICAgICBpZiAoY2hhciA9PT0gJy8nICYmIG5leHRDaGFyID09PSAnLycpIHtcclxuICAgICAgICBpblNpbmdsZUxpbmVDb21tZW50ID0gdHJ1ZTtcclxuICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcvLydcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgc3RyaW5nIGxpdGVyYWwgKCcgb3IgXCIpXHJcbiAgICAgIGlmIChjaGFyID09PSAnXCInIHx8IGNoYXIgPT09IFwiJ1wiKSB7XHJcbiAgICAgICAgaW5TdHJpbmcgPSBjaGFyOyAvLyBFbnRlciBzdHJpbmcgc3RhdGUsIHJlbWVtYmVyaW5nIHRoZSBxdW90ZSB0eXBlXHJcbiAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBvcGVuaW5nIHF1b3RlXHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbCAnLydcclxuICAgICAgLy8gQmFzaWMgY2hlY2s6IGFzc3VtZXMgJy8nIGluZGljYXRlcyBhIHJlZ2V4IHN0YXJ0IGlmIG5vdCBwcmVjZWRlZCBieSBvcGVyYXRvcnMva2V5d29yZHNcclxuICAgICAgLy8gQSBtb3JlIHJvYnVzdCBzb2x1dGlvbiB3b3VsZCByZXF1aXJlIG1vcmUgY29tcGxleCBwYXJzaW5nLlxyXG4gICAgICBpZiAoY2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAvLyBWZXJ5IGJhc2ljIGNoZWNrIHRvIGRpZmZlcmVudGlhdGUgZGl2aXNpb24gZnJvbSByZWdleCBzdGFydC5cclxuICAgICAgICAgIC8vIFRoaXMgbWlnaHQgbmVlZCByZWZpbmVtZW50IGZvciBjb21wbGV4IGNhc2VzLlxyXG4gICAgICAgICAgY29uc3QgcHJldk1lYW5pbmdmdWxDaGFyID0gY2xlYW5lZENvZGUudHJpbSgpLnNsaWNlKC0xKTtcclxuICAgICAgICAgIGlmIChwcmV2TWVhbmluZ2Z1bENoYXIgPT09ICcnIHx8IFsnKCcsICcsJywgJz0nLCAnOicsICdbJywgJyEnLCAnJicsICd8JywgJz8nLCAneycsICc7JywgJ1xcbicsICdcXHInXS5pbmNsdWRlcyhwcmV2TWVhbmluZ2Z1bENoYXIpKSB7XHJcbiAgICAgICAgICAgICAgaW5SZWdFeHAgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIElmIG5vbmUgb2YgdGhlIGFib3ZlLCBpdCdzIHJlZ3VsYXIgY29kZTsgYWRkIGl0IHRvIHRoZSByZXN1bHRcclxuICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgaSsrO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLy8gUmV0dXJuIHRoZSBhY2N1bXVsYXRlZCBjbGVhbmVkIGNvZGUgc3RyaW5nXHJcbiAgICByZXR1cm4gY2xlYW5lZENvZGU7XHJcbiAgfVxyXG5cclxuXHJcbiAgZXhwb3J0IGNsYXNzIFNjcmlwdGluZ1Rvb2xzIHtcclxuICAgIHNldHRpbmdzOiBGb2xkZXJUYWdTZXR0aW5ncyB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncz86IEZvbGRlclRhZ1NldHRpbmdzIHwgdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHN0cmluZyBjb21wbGllcyB3aXRoIElTTyBTdGFuZGFyZFxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gc3RyIEFueSBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgdG8gbG9vayBmb3JcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBpc0lTT1N0cmluZyhcclxuICAgICAgc3RyOiBzdHJpbmcsXHJcbiAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICB3aXRoTWlsbGlzZWNvbmRzPzogYm9vbGVhbjtcclxuICAgICAgICB3aXRoVGltZXpvbmU/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhUaW1lPzogYm9vbGVhbjtcclxuICAgICAgICB3aXRoRGF0ZT86IGJvb2xlYW47IFxyXG4gICAgICB9ID0ge31cclxuICAgICk6IGJvb2xlYW4ge1xyXG4gICAgICBjb25zdCB7XHJcbiAgICAgICAgd2l0aE1pbGxpc2Vjb25kcyA9IGZhbHNlLFxyXG4gICAgICAgIHdpdGhUaW1lem9uZSA9IGZhbHNlLFxyXG4gICAgICAgIHdpdGhUaW1lID0gdHJ1ZSxcclxuICAgICAgICB3aXRoRGF0ZSA9IHRydWUsIFxyXG4gICAgICB9ID0gb3B0aW9ucztcclxuICAgIFxyXG4gICAgICBsZXQgZGF0ZVJlZ2V4U3RyID0gXCJeKD86XFxcXGR7NH0tKD86MFsxLTldfDFbMC0yXSktKD86MFsxLTldfFsxMl1cXFxcZHwzWzAxXSkpXCI7XHJcbiAgICAgIGxldCB0aW1lUmVnZXhTdHIgPSBcIig/OlQoPzpbMDFdXFxcXGR8MlswLTNdKTpbMC01XVxcXFxkOlswLTVdXFxcXGRcIjtcclxuICAgIFxyXG4gICAgICBpZiAod2l0aE1pbGxpc2Vjb25kcykge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIlxcXFwuXFxcXGR7M31cIjtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGlmICh3aXRoVGltZXpvbmUpIHtcclxuICAgICAgICB0aW1lUmVnZXhTdHIgKz0gXCIoPzpafFsrLV0oPzpbMDFdXFxcXGR8MlswLTNdKTpbMC01XVxcXFxkKT8pP1wiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIik/XCI7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBsZXQgcmVnZXhTdHIgPSBcIlwiO1xyXG4gICAgICBpZiAod2l0aERhdGUgJiYgd2l0aFRpbWUpIHtcclxuICAgICAgICByZWdleFN0ciA9IGAke2RhdGVSZWdleFN0cn0ke3RpbWVSZWdleFN0cn0kYDtcclxuICAgICAgfSBlbHNlIGlmICh3aXRoRGF0ZSkge1xyXG4gICAgICAgIHJlZ2V4U3RyID0gYCR7ZGF0ZVJlZ2V4U3RyfSRgO1xyXG4gICAgICB9IGVsc2UgaWYgKHdpdGhUaW1lKSB7XHJcbiAgICAgICAgcmVnZXhTdHIgPSBgXiR7dGltZVJlZ2V4U3RyLnNsaWNlKDQpfSRgOyBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7IFxyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4U3RyKTtcclxuICAgICAgcmV0dXJuIHJlZ2V4LnRlc3Qoc3RyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVHJ5IHRvIGNvbnZlcnQgQW55IFR5cGVzIHRvIGEgc3BlY2lmaWMgVHlwZVxyXG4gICAgICogQHBhcmFtIGlucHV0IFxyXG4gICAgICogQHBhcmFtIHR5cGVTdHJpbmcgJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJyB8ICdzdHJpbmdbXSdcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICB0cnlDb252ZXJ0KGlucHV0OiBhbnksIHR5cGVTdHJpbmc6ICdzdHJpbmcnIHwgJ251bWJlcicgfCAnYm9vbGVhbicgfCAnc3RyaW5nW10nKTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IHN0cmluZ1tdIHwgdW5kZWZpbmVkIHtcclxuICAgICAgc3dpdGNoICh0eXBlU3RyaW5nKSB7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcclxuICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgIGNvbnN0IG51bSA9IE51bWJlcihpbnB1dCk7XHJcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGxvd2VyVmFsdWUgPSBpbnB1dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgIGlmIChsb3dlclZhbHVlID09PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAobG93ZXJWYWx1ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAgIGlmIChpbnB1dCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChpbnB1dCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNhc2UgJ3N0cmluZ1tdJzpcclxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSAmJiBpbnB1dC5ldmVyeShpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmb3JtYXRUb1lBTUxTYXZlU3RyaW5nKHRleHQ6c3RyaW5nLCByZXBsYWNlQnk6c3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkKTpzdHJpbmcge1xyXG4gICAgICBsZXQgcmVwbGFjZVN0cmluZyA9ICctJztcclxuICAgICAgaWYgKCFyZXBsYWNlQnkgJiYgdGhpcy5zZXR0aW5ncykge1xyXG4gICAgICAgIHJlcGxhY2VTdHJpbmcgPSB0aGlzLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQgfHwgJy0nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChyZXBsYWNlQnkpIHJlcGxhY2VTdHJpbmcgPSByZXBsYWNlQnk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvW15hLXpBLVowLTlcXC1fXFwvXHUwMEU0XHUwMEY2XHUwMEZDXHUwMERGXHUwMEM0XHUwMEQ2XHUwMERDXHUwMEUxXHUwMEU5XHUwMEVEXHUwMEYzXHUwMEZBXHUwMEZEXHUwMEMxXHUwMEM5XHUwMENEXHUwMEQzXHUwMERBXHUwMEREXHUwMEUwXHUwMEU4XHUwMEVDXHUwMEYyXHUwMEY5XHUwMEMwXHUwMEM4XHUwMENDXHUwMEQyXHUwMEQ5XHUwMEUyXHUwMEVBXHUwMEVFXHUwMEY0XHUwMEZCXHUwMEMyXHUwMENBXHUwMENFXHUwMEQ0XHUwMERCXHUwMEUzXHUwMEYxXHUwMEY1XHUwMEMzXHUwMEQxXHUwMEQ1XS9nLCByZXBsYWNlU3RyaW5nKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyBhIHN0cmluZyB0byBhIFlBTUwtc2FmZSBmb3JtYXQgYnkgYWRkaW5nIHF1b3RlcyB3aGVuIG5lY2Vzc2FyeS5cclxuICAgICAqIEBwYXJhbSBpbnB1dCBUaGUgc3RyaW5nLCBib29sZWFuLCBudW1iZXIgb3IgYXJyYXkgdG8gbWFrZSBZQU1MLXNhZmVcclxuICAgICAqIEByZXR1cm5zIFRoZSBzYWZlbHkgcXVvdGVkIHN0cmluZyB3aGVuIG5lZWRlZCwgb3IgdGhlIG9yaWdpbmFsIHN0cmluZyBpZiBzYWZlXHJcbiAgICAgKi9cclxuICAgIHRvWWFtbFNhZmVTdHJpbmcoaW5wdXQ6IHN0cmluZ3xudW1iZXJ8Ym9vbGVhbnxzdHJpbmdbXSk6IHN0cmluZ3xudW1iZXJ8c3RyaW5nW10ge1xyXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICBpbnB1dC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgaW5wdXRbaW5kZXhdID0gdGhpcy50b1lhbWxTYWZlU3RyaW5nKGl0ZW0pLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgIH1cclxuICAgICAgc3dpdGNoICh0eXBlb2YgaW5wdXQpIHtcclxuICAgICAgICBjYXNlICdudW1iZXInOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6IHJldHVybiBpbnB1dCA/ICd0cnVlJyA6ICdmYWxzZSc7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcclxuICAgICAgICAgIC8vIFRyaW0gd2hpdGVzcGFjZSBmaXJzdFxyXG4gICAgICAgICAgY29uc3QgdHJpbW1lZCA9IGlucHV0LnRyaW0oKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gRW1wdHkgc3RyaW5ncyBuZWVkIHF1b3Rlc1xyXG4gICAgICAgICAgaWYgKHRyaW1tZWQgPT09ICcnKSByZXR1cm4gJ1wiXCInO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBmb3Igc3BlY2lhbCBjaGFyYWN0ZXJzL3BhdHRlcm5zIHRoYXQgcmVxdWlyZSBxdW90aW5nXHJcbiAgICAgICAgICBjb25zdCBuZWVkc1F1b3RlcyA9IC9bOnt9XFxbXFxdLCYqIz98PD49ISVAYFwiJ1xcXFxdfF5bLT9cXG5dfFtcXHNcXG5dfF5beVluTl18XlswLTldfF5bKy1dfF4odHJ1ZXxmYWxzZXx5ZXN8bm98b258b2ZmKSQvaS50ZXN0KHRyaW1tZWQpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3RyaW5nIGlzIGFscmVhZHkgcHJvcGVybHkgcXVvdGVkXHJcbiAgICAgICAgICBjb25zdCBpc0FscmVhZHlRdW90ZWQgPSAodHJpbW1lZC5zdGFydHNXaXRoKCdcIicpICYmIHRyaW1tZWQuZW5kc1dpdGgoJ1wiJykpIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0cmltbWVkLnN0YXJ0c1dpdGgoXCInXCIpICYmIHRyaW1tZWQuZW5kc1dpdGgoXCInXCIpKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKCFuZWVkc1F1b3RlcyAmJiAhaXNBbHJlYWR5UXVvdGVkKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRyaW1tZWQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIHdlIGdldCBoZXJlLCB3ZSBuZWVkIHF1b3Rlc1xyXG4gICAgICAgICAgLy8gVXNlIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBhbnkgZXhpc3RpbmcgZG91YmxlIHF1b3Rlc1xyXG4gICAgICAgICAgaWYgKCFpc0FscmVhZHlRdW90ZWQpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gYFwiJHt0cmltbWVkLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKX1cImA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIGFscmVhZHkgcXVvdGVkLCByZXR1cm4gYXMtaXNcclxuICAgICAgICAgIHJldHVybiB0cmltbWVkO1xyXG4gICAgICAgIGRlZmF1bHQ6IFxyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgdG9ZYW1sU2FmZVN0cmluZygke2lucHV0fSkgaWYgb2YgdHlwZSAnJHt0eXBlb2YgaW5wdXR9J2ApO1xyXG4gICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVwbGFjZVNwYWNlcyh0ZXh0OnN0cmluZywgcmVwbGFjZUJ5OnN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCk6c3RyaW5nIHtcclxuICAgICAgbGV0IHJlcGxhY2VTdHJpbmcgPSAnXyc7XHJcbiAgICAgIGlmICghcmVwbGFjZUJ5ICYmIHRoaXMuc2V0dGluZ3MpIHtcclxuICAgICAgICByZXBsYWNlU3RyaW5nID0gdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50IHx8ICdfJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocmVwbGFjZUJ5KSByZXBsYWNlU3RyaW5nID0gcmVwbGFjZUJ5O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL1xccysvZywgcmVwbGFjZVN0cmluZyk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0Q2FtZWxDYXNlKHRleHQ6c3RyaW5nKTpzdHJpbmcge1xyXG4gICAgICBsZXQgdGV4dFBhcnRzID0gdGV4dC5zcGxpdCgnICcpO1xyXG4gICAgICBsZXQgY29udmVydGVkVGV4dFBhcnRzOnN0cmluZ1tdID0gW107XHJcbiAgICAgIHRleHRQYXJ0cy5mb3JFYWNoKCh0ZXh0LGluZGV4KSA9PiB7XHJcbiAgICAgICAgbGV0IG5ld1RleHRQYXJ0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChpbmRleD4wKSBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgY29udmVydGVkVGV4dFBhcnRzLnB1c2gobmV3VGV4dFBhcnQpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3JtYXRVcHBlckNhbWVsQ2FzZSh0ZXh0OnN0cmluZyk6c3RyaW5nIHtcclxuICAgICAgbGV0IHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoJyAnKTtcclxuICAgICAgbGV0IGNvbnZlcnRlZFRleHRQYXJ0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgICB0ZXh0UGFydHMuZm9yRWFjaCgodGV4dCxpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXdUZXh0UGFydCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgY29udmVydGVkVGV4dFBhcnRzLnB1c2gobmV3VGV4dFBhcnQpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcnKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZ2V0IHRoZSBwYXRoIHRvIGEgZmlsZSBmcm9tIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIGZ1bGwgcGFyaC9uYW1lIHN0cmluZ1xyXG4gICAgICogQHBhcmFtIHBhdGggc3RyaW5nXHJcbiAgICAgKiBAcGFyYW0gc2VwYXJhdG9yIHN0cmluZyBkZWZhdWx0cyB0byAnLydcclxuICAgICAqIEByZXR1cm5zIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICBnZXRGb2xkZXJzRnJvbVBhdGggKHBhdGg6c3RyaW5nfG51bGx8dW5kZWZpbmVkLCBzZXBhcmF0b3IgPSAnLycpIHtcclxuICAgICAgICBpZiAocGF0aCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKHBhdGggPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBjdXJyZW50UGF0aFBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGN1cnJlbnRQYXRoUGFydHMucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWU7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQYXRoUGFydHMuam9pbihzZXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gIH0iLCAiaW1wb3J0IHsgQXBwLCByZW5kZXJSZXN1bHRzLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSdWxlRnVuY3Rpb24ge1xyXG4gICAgaWQ6c3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb246c3RyaW5nO1xyXG4gICAgdG9vbHRpcD86IHN0cmluZztcclxuICAgIHNvdXJjZTpzdHJpbmc7XHJcbiAgICBmeDpGdW5jdGlvbjtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHJ1bGVGdW5jdGlvbnM6UnVsZUZ1bmN0aW9uW109W107XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSdWxlRnVuY3Rpb25CeUlkIChpZCA6IHN0cmluZyk6UnVsZUZ1bmN0aW9uIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiBydWxlRnVuY3Rpb25zLmZpbmQocnVsZSA9PiBydWxlLmlkID09PSBpZCk7XHJcbn1cclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZGVmYXVsdCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1Bhc3MgcGFyYW1ldGVyJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6IGZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmdWxsUGF0aCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgcGF0aCBhbmQgZmlsZW5hbWUnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUucGF0aDtcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6IGZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7ZmlsZS5wYXRofWA7XHJcbiAgICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonYWxpYXNGcm9tUGF0aCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0FuIEFsaWFzIGZyb20gZXZlcnkgZm9sZGVyIG9mIHRoZSBmaWxlIFBhdGgnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGxldCBwYXRoQXJyYXkgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcXG4gIHBhdGhBcnJheS5wb3AoKTsgLy8gcmVtb3ZlIEZpbGUgbmFtZSB3aXRoIGV4dGVuc2lvblxcbiAgcGF0aEFycmF5ID0gcGF0aEFycmF5Lm1hcCgoZGlyKSA9PiB0b29scy5mb3JtYXRVcHBlckNhbWVsQ2FzZShkaXIpKTsgLy8gY29udmVydCB0byBVcHBlckNhbWVsQ2FzZVxcbiAgY29uc3QgZmlsZU5hbWVQYXJ0cyA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xcbiAgaWYgKGZpbGVOYW1lUGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBmaWxlTmFtZVBhcnRzLnBvcCgpOyAvLyByZW1vdmUgRXh0ZW5zaW9uXFxuICB9XFxuICBjb25zdCBmaWxlTmFtZSA9IGZpbGVOYW1lUGFydHMuam9pbignLicpOyAvLyByZWJ1aWxkIGZpbGUgTmFtZVxcbiAgcGF0aEFycmF5LnB1c2godG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZmlsZU5hbWUpKTsgLy8gYWRkIGZpbGUgbmFtZSB3aXRob3V0IGV4dGVuc2lvbiBhbmQgaW4gVXBwZXJDYW1lbENhc2VcXG4gIGNvbnN0IHJlc3VsdCA9IHBhdGhBcnJheS5qb2luKCcuJykgfHwgJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OiBmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICAgICAgbGV0IHBhdGhBcnJheSA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICBwYXRoQXJyYXkucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWUgd2l0aCBleHRlbnNpb25cclxuICAgICAgICAgICAgcGF0aEFycmF5ID0gcGF0aEFycmF5Lm1hcCgoZGlyKSA9PiB0b29scy5mb3JtYXRVcHBlckNhbWVsQ2FzZShkaXIpKTsgLy8gY29udmVydCB0byB1cHBlciBjYW1lbENhc2VcclxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWVQYXJ0cyA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBpZiAoZmlsZU5hbWVQYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGZpbGVOYW1lUGFydHMucG9wKCk7IC8vIHJlbW92ZSBFeHRlbnNpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGVOYW1lUGFydHMuam9pbignLicpOyAvLyByZWJ1aWxkIGZpbGUgTmFtZVxyXG4gICAgICAgICAgICBwYXRoQXJyYXkucHVzaCh0b29scy5mb3JtYXRVcHBlckNhbWVsQ2FzZShmaWxlTmFtZSkpOyAvLyBhZGQgZmlsZSBuYW1lIHdpdGhvdXQgZXh0ZW5zaW9uIGFuZCBpbiB1cHBlckNhbWVsQ2FzZVxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwYXRoQXJyYXkuam9pbignLicpIHx8ICcnO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J3BhdGgnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGdWxsIFBhdGgnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICAgIHJlc3VsdCA9IHJlc3VsdCArIHBhcnRzLmpvaW4oJy8nKTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZvbGRlcicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZvbGRlcm5hbWUnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHJlc3VsdCA9IHBhcnRzW3BhcnRzLmxlbmd0aC0yXTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgcmVzdWx0ID0gcGFydHNbcGFydHMubGVuZ3RoLTJdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmb2xkZXJzJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnQWxsIGZvbGRlcnMgb2YgdGhlIGZpbGUgYXMgYSBsaXN0JyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7IC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBmaWxlIG5hbWVcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDoncm9vdEZvbGRlcicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1Jvb3QgZm9sZGVyJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICByZXN1bHQgPSBwYXJ0c1swXTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgcmVzdWx0ID0gcGFydHNbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J25hbWUnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIG5hbWUnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xcbiAgcmVzdWx0LnBvcCgpOyAvLyByZW1vdmUgZXh0ZW5zaW9uXFxuICByZXN1bHQuam9pbignLicpOyAvLyByZWNvbnN0cnVjdCB0aGUgZmlsZSBuYW1lXFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBuYW1lXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgcmVzdWx0LnBvcCgpOyAvLyByZW1vdmUgZXh0ZW5zaW9uXHJcbiAgICAgICAgcmVzdWx0LmpvaW4oJy4nKTsgLy8gcmVjb25zdHJ1Y3QgdGhlIGZpbGUgbmFtZVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J25hbWVFeHQnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIG5hbWUgd2l0aCBleHRlbnNpb24nLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZTtcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWU7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZGF0ZVRpbWVDcmVhdGVkJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRGF0ZSAoYW5kIFRpbWUpIGNyZWF0ZWQnLCAvLyBUT0RPIENoZWNrIHRpbWUgem9uZXMuIFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBEYXRlIGFuZCBUaW1lciBmaWxlIGNyZWF0ZWRcXG4gIGNvbnN0IGRhdGVUaW1lID0gbmV3IERhdGUoZmlsZS5zdGF0LmN0aW1lKTtcXG4gIGNvbnN0IHJlc3VsdCA9IGRhdGVUaW1lLnRvSVNPU3RyaW5nKCkuc3BsaXQoJy4nKVswXTtcXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgXHJcbiAgICAgICAgLy8gYWNxdWlyZSBEYXRlIGFuZCBUaW1lciBmaWxlIGNyZWF0ZWRcclxuICAgICAgICBjb25zdCBkYXRlVGltZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5jdGltZSk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZGF0ZVRpbWUudG9JU09TdHJpbmcoKS5zcGxpdCgnLicpWzBdO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidkYXRlVGltZU1vZGlmaWVkJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRGF0ZSAoYW5kIFRpbWUpIG1vZGlmaWVkJywgLy9GSVhNRSBrZWVwIERhdGUgYW5kIHRpbWUgdW50b3VjaGVkIHdoZW4gZWRpdGluZyBmcm9udG1hdHRlciBwcm9wZXJ0aWVzXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIERhdGUgYW5kIFRpbWVyIGZpbGUgbW9kaWZpZWRcXG4gIGNvbnN0IGRhdGVUaW1lID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lKTtcXG4gIGNvbnN0IHJlc3VsdCA9IGRhdGVUaW1lLnRvSVNPU3RyaW5nKCkuc3BsaXQoJy4nKVswXTtcXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgXHJcbiAgICAgICAgLy8gYWNxdWlyZSBEYXRlIGFuZCBUaW1lciBmaWxlIGNyZWF0ZWRcclxuICAgICAgICBjb25zdCBkYXRlVGltZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZSk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZGF0ZVRpbWUudG9JU09TdHJpbmcoKS5zcGxpdCgnLicpWzBdO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmaWxlU2l6ZUJ5dGVzJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRmlsZSBzaXplIGluIGJ5dGVzJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBzaXplXFxuICBjb25zdCByZXN1bHQgPSBmaWxlLnN0YXQuc2l6ZTtcXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHNpemVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLnN0YXQuc2l6ZTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZmlsZVNpemVTdHJpbmcnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIHNpemUgZm9ybWF0dGVkIGFzIHRleHQnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHNpemVcXG4gIGxldCBzaXplID1maWxlLnN0YXQuc2l6ZTtcXG4gIGNvbnN0IHByZWNpc2lvbiA9IDI7IC8vIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xcbiAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgIHNpemUgPSBzaXplIC8gMTAyNDtcXG4gICAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICAgIGlmIChzaXplID4gMTAyNCkge1xcbiAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgR0InO1xcbiAgICAgIH0gXFxuICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgTUInO1xcbiAgICB9XFxuICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdChzaXplKS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEtCJztcXG4gIH0gICBcXG4gIHJldHVybiBzaXplICsgJyBCeXRlcyc7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHNpemVcclxuICAgICAgICBsZXQgc2l6ZSA9ZmlsZS5zdGF0LnNpemU7XHJcbiAgICAgICAgY29uc3QgcHJlY2lzaW9uID0gMjsgLy8gbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzXHJcbiAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBHQic7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgTUInO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBLQic7XHJcbiAgICAgICAgfSAgIFxyXG4gICAgICAgIHJldHVybiBzaXplICsgJyBCeXRlcyc7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pOyIsICJpbXBvcnQgKiBhcyBmbVRvb2xzIGZyb20gJy4vZnJvbnRtYXR0ZXItdG9vbHMnO1xyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGVyVGFnU2V0dGluZ3Mge1xyXG4gICAgdGFnUHJlZml4OiBzdHJpbmc7XHJcbiAgICBleGNsdWRlUm9vdEZvbGRlcjogYm9vbGVhbjtcclxuICAgIHRhZ3NQcm9wZXJ0eU5hbWU6IHN0cmluZztcclxuICAgIHNwYWNlUmVwbGFjZW1lbnQ6IHN0cmluZztcclxuICAgIHNwZWNpYWxDaGFyUmVwbGFjZW1lbnQ6IHN0cmluZztcclxuICAgIGxvd2VyY2FzZVRhZ3M6IGJvb2xlYW47XHJcbiAgICBrbm93blByb3BlcnRpZXM6IFByb3BlcnR5VHlwZUluZm9bXTtcclxuICAgIHJ1bGVzOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbltdO1xyXG4gICAgdXNlVGV4dEFyZWE6IGJvb2xlYW47XHJcbiAgICBleGNsdWRlOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBzZWxlY3RlZEZpbGVzOiBzdHJpbmdbXSxcclxuICAgICAgICBtb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZScsXHJcbiAgICAgICAgZGlzcGxheTogJ2ZvbGRlcicgfCAnZmlsZXMnXHJcbiAgICB9O1xyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogc3RyaW5nW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXInIHwgJ2ZpbGVzJ1xyXG4gICAgfTtcclxuICAgIGNvbmZpZ3VyZWRQcm9wZXJ0aWVzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgdmFsdWU6IGFueSB9PjtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEZvbGRlclRhZ1NldHRpbmdzID0ge1xyXG4gICAgdGFnUHJlZml4OiAnJyxcclxuICAgIGV4Y2x1ZGVSb290Rm9sZGVyOiBmYWxzZSxcclxuICAgIHRhZ3NQcm9wZXJ0eU5hbWU6ICd0YWdzJyxcclxuICAgIHNwYWNlUmVwbGFjZW1lbnQ6ICdfJyxcclxuICAgIHNwZWNpYWxDaGFyUmVwbGFjZW1lbnQ6ICdfJyxcclxuICAgIGxvd2VyY2FzZVRhZ3M6IGZhbHNlLFxyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBbXSxcclxuICAgIHJ1bGVzOiBbXSxcclxuICAgIHVzZVRleHRBcmVhOiBmYWxzZSxcclxuICAgIGV4Y2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgICAgIG1vZGU6ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVyJyxcclxuICAgIH0sXHJcbiAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXJzOiBbXSxcclxuICAgICAgICBzZWxlY3RlZEZpbGVzOiBbXSxcclxuICAgICAgICBtb2RlOiAnaW5jbHVkZScsXHJcbiAgICAgICAgZGlzcGxheTogJ2ZvbGRlcicsXHJcbiAgICB9LFxyXG4gICAgY29uZmlndXJlZFByb3BlcnRpZXM6IFtdLFxyXG59O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgYWN0aXZlOiBib29sZWFuO1xyXG4gICAgcHJvcGVydHk6IHN0cmluZztcclxuICAgIGN1c3RvbVByb3BlcnR5OiBzdHJpbmc7XHJcbiAgICB0eXBlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICB0eXBlUHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8gfCB1bmRlZmluZWQ7XHJcbiAgICBjb250ZW50OiBzdHJpbmc7XHJcbiAgICBidWlsZEluQ29kZTogc3RyaW5nO1xyXG4gICAganNDb2RlOiBzdHJpbmc7XHJcbiAgICBzaG93Q29udGVudDogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUlVMRV9ERUZJTklUSU9OIDogRm9sZGVyVGFnUnVsZURlZmluaXRpb24gPSB7XHJcbiAgICBpZDogJycsXHJcbiAgICBhY3RpdmUgOiB0cnVlLFxyXG4gICAgcHJvcGVydHkgOiAnJyxcclxuICAgIGN1c3RvbVByb3BlcnR5IDogJycsXHJcbiAgICB0eXBlOiAnc3RyaW5nJyxcclxuICAgIHR5cGVQcm9wZXJ0eToge25hbWU6JycsdHlwZTonJywgc291cmNlOidyZWdpc3RlcmVkJ30sXHJcbiAgICBjb250ZW50OiAnJyxcclxuICAgIGJ1aWxkSW5Db2RlOiAnJyxcclxuICAgIGpzQ29kZTogJycsXHJcbiAgICBzaG93Q29udGVudDogZmFsc2UsXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFByb3BlcnR5VHlwZUluZm8gPSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB0eXBlOiBzdHJpbmc7XHJcbiAgICBjb3VudD86IG51bWJlcjtcclxuICAgIGlzQXJyYXk/OiBib29sZWFuO1xyXG4gICAgdmFsdWVzPzogc3RyaW5nW107XHJcbiAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJyB8ICdpbmZlcnJlZCc7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBQcm9wZXJ0eVR5cGUgPSB7XHJcbiAgICB0eXBlOiBzdHJpbmc7XHJcbiAgICBpY29uOiBzdHJpbmc7XHJcbiAgICBqc1R5cGU6IHN0cmluZztcclxufTsiLCAiaW1wb3J0IHsgTW9kYWwsIEFwcCwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuLyoqXHJcbiAqIERpc3BsYXkgYSBBbGVydCBNb2RhbCBhc3luY2hyb25vdXNseSBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBc3luY0FsZXJ0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xyXG4gIHByaXZhdGUgZGVzY3JpcHRpb246IHN0cmluZztcclxuICBwcml2YXRlIGJ0bjFUZXh0OiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBidG4yVGV4dDogc3RyaW5nO1xyXG4gIHByaXZhdGUgb25ZZXM6ICgpID0+IHZvaWQ7XHJcbiAgcHJpdmF0ZSBvbk5vOiAoKSA9PiB2b2lkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgYnRuMTogc3RyaW5nLCBidG4yOnN0cmluZywgb25ZZXM6ICgpID0+IHZvaWQsIG9uTm86ICgpID0+IHZvaWQpIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICB0aGlzLmJ0bjFUZXh0ID0gYnRuMTtcclxuICAgIHRoaXMuYnRuMlRleHQgPSBidG4yO1xyXG4gICAgdGhpcy5vblllcyA9IG9uWWVzO1xyXG4gICAgdGhpcy5vbk5vID0gb25ObztcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IHRoaXMudGl0bGUgfSk7XHJcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IHRoaXMuZGVzY3JpcHRpb24gfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCh0aGlzLmJ0bjFUZXh0KVxyXG4gICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uWWVzKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSlcclxuICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4yVGV4dClcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbk5vKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIGRpc3BsYXkgYW4gQWxlcnQgTW9kYWxcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbGVydE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSByZXNvbHZlUHJvbWlzZTogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBwcm9taXNlOiBQcm9taXNlPGJvb2xlYW4+O1xyXG4gICAgcHJpdmF0ZSBidG4xVGV4dDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBidG4yVGV4dDogc3RyaW5nO1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGJ0bjE6IHN0cmluZywgYnRuMjpzdHJpbmcpIHtcclxuICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgIHRoaXMuYnRuMVRleHQgPSBidG4xO1xyXG4gICAgICB0aGlzLmJ0bjJUZXh0ID0gYnRuMjtcclxuICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gIFxyXG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiB0aGlzLnRpdGxlIH0pO1xyXG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IHRoaXMuZGVzY3JpcHRpb24gfSk7XHJcbiAgXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KHRoaXMuYnRuMVRleHQpXHJcbiAgICAgICAgICAgIC5zZXRDdGEoKVxyXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCh0aGlzLmJ0bjJUZXh0KVxyXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UoZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxuICBcclxuICAgIGFzeW5jIG9wZW5BbmRHZXRWYWx1ZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLnByb21pc2U7XHJcbiAgICB9XHJcbiAgfSIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nLCBUQWJzdHJhY3RGaWxlLCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7IC8vIEFkZGVkIHNldEljb25cclxuXHJcbi8vIERlZmluZSB0aGUgc3RydWN0dXJlIGZvciB0cmVlIG5vZGVzXHJcbmludGVyZmFjZSBUcmVlTm9kZSB7XHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB0eXBlOiAnZm9sZGVyJyB8ICdmaWxlJztcclxuICAgIGNoaWxkcmVuPzogVHJlZU5vZGVbXTtcclxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGxpc3QgaXRlbSBlbGVtZW50IChsaSlcclxuICAgIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgbGFiZWw6IEhUTUxMYWJlbEVsZW1lbnQ7XHJcbiAgICBjb250YWluZXI6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGNvbnRhaW5lciBkaXYgaG9sZGluZyBjaGVja2JveCBhbmQgbGFiZWxcclxufVxyXG5cclxuLy8gRGVmaW5lIHRoZSByZXN1bHQgc3RydWN0dXJlIHJldHVybmVkIGJ5IHRoZSBtb2RhbFxyXG5leHBvcnQgaW50ZXJmYWNlIERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB7XHJcbiAgICBmb2xkZXJzOiBzdHJpbmdbXTtcclxuICAgIGZpbGVzOiBzdHJpbmdbXTtcclxuICAgIG1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJztcclxuICAgIGRpc3BsYXk6ICdmb2xkZXJzJyB8ICdmaWxlcyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnNpZGlhbiBNb2RhbCBmb3Igc2VsZWN0aW5nIGRpcmVjdG9yaWVzIGFuZCBmaWxlcyBmcm9tIHRoZSB2YXVsdCBzdHJ1Y3R1cmUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZvbGRlcnNTbmFwc2hvdDogUmVhZG9ubHlTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZpbGVzU25hcHNob3Q6IFJlYWRvbmx5U2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxNb2RlU25hcHNob3Q6ICdpbmNsdWRlJyB8ICdleGNsdWRlJztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbERpc3BsYXlTbmFwc2hvdDogJ2ZvbGRlcnMnIHwgJ2ZpbGVzJztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZDtcclxuXHJcbiAgICAvLyBDdXJyZW50IHN0YXRlIGJlaW5nIG1vZGlmaWVkIHdpdGhpbiB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgY3VycmVudEZvbGRlcnM6IFNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RmlsZXM6IFNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50TW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RGlzcGxheTogJ2ZvbGRlcnMnIHwgJ2ZpbGVzJztcclxuICAgIHByaXZhdGUgaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSBzaG93RmlsZXM6IGJvb2xlYW4gPSBmYWxzZTsgLy8gU3RhdGUgZm9yIHNob3dpbmcgZmlsZXMgaW4gdGhlIHRyZWVcclxuXHJcbiAgICAvLyBVSSBFbGVtZW50c1xyXG4gICAgcHJpdmF0ZSB0cmVlUm9vdEVsZW1lbnQ6IEhUTUxFbGVtZW50OyAvLyBDb250YWluZXIgZm9yIHRoZSB0cmVlIHZpZXdcclxuICAgIHByaXZhdGUgdHJlZU5vZGVzOiBNYXA8c3RyaW5nLCBUcmVlTm9kZT4gPSBuZXcgTWFwKCk7IC8vIE1hcCBwYXRoIHRvIG5vZGUgaW5mbyBmb3IgcXVpY2sgYWNjZXNzXHJcbiAgICBwcml2YXRlIG1vZGVEcm9wZG93bjogU2V0dGluZyB8IG51bGwgPSBudWxsOyAvLyBSZWZlcmVuY2UgdG8gdXBkYXRlIGRyb3Bkb3duIG9uIHJlc2V0XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbC5cclxuICAgICAqIEBwYXJhbSBhcHAgLSBUaGUgT2JzaWRpYW4gQXBwIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxGb2xkZXJzIC0gQXJyYXkgb2YgaW5pdGlhbGx5IHNlbGVjdGVkIGZvbGRlciBwYXRocy5cclxuICAgICAqIEBwYXJhbSBpbml0aWFsRmlsZXMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZmlsZSBwYXRocy5cclxuICAgICAqIEBwYXJhbSBpbml0aWFsTW9kZSAtIFRoZSBpbml0aWFsIHNlbGVjdGlvbiBtb2RlICgnaW5jbHVkZScgb3IgJ2V4Y2x1ZGUnKS5cclxuICAgICAqIEBwYXJhbSBva0NhbGxiYWNrIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBcIk9LXCIuIFJlY2VpdmVzIHRoZSBzZWxlY3Rpb24gcmVzdWx0LlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBhcHA6IEFwcCxcclxuICAgICAgICBpbml0aWFsRm9sZGVyczogc3RyaW5nW10sXHJcbiAgICAgICAgaW5pdGlhbEZpbGVzOiBzdHJpbmdbXSxcclxuICAgICAgICBpbml0aWFsTW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnLFxyXG4gICAgICAgIGluaXRpYWxEaXNwbGF5OiAnZm9sZGVycycgfCAnZmlsZXMnLFxyXG4gICAgICAgIGluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZTogYm9vbGVhbixcclxuICAgICAgICBva0NhbGxiYWNrOiAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB2b2lkXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIC8vIFN0b3JlIGluaXRpYWwgc3RhdGUgZm9yIHJlc2V0XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRm9sZGVyc1NuYXBzaG90ID0gbmV3IFNldChpbml0aWFsRm9sZGVycyk7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRmlsZXNTbmFwc2hvdCA9IG5ldyBTZXQoaW5pdGlhbEZpbGVzKTtcclxuICAgICAgICB0aGlzLmluaXRpYWxNb2RlU25hcHNob3QgPSBpbml0aWFsTW9kZTtcclxuICAgICAgICB0aGlzLmluaXRpYWxEaXNwbGF5U25hcHNob3QgPSBpbml0aWFsRGlzcGxheTtcclxuICAgICAgICB0aGlzLnNob3dGaWxlcyA9IGluaXRpYWxEaXNwbGF5PT09J2ZpbGVzJyB8fCBpbml0aWFsRmlsZXMubGVuZ3RoPjA7XHJcbiAgICAgICAgdGhpcy5pbmNsdWRlRXhjbHVkZVNlbGVjdGFibGUgPSBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGU7XHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrID0gb2tDYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBjdXJyZW50IHN0YXRlIGZyb20gaW5pdGlhbCBzdGF0ZSBmb3IgZWRpdGluZ1xyXG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gVXNlIGEgbWV0aG9kIGZvciBpbml0aWFsaXphdGlvbiBhbmQgcmVzZXRcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gdGhlIGluaXRpYWwgc3RhdGUgcHJvdmlkZWQgYXQgY29uc3RydWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZvbGRlcnNTbmFwc2hvdCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZXMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZpbGVzU25hcHNob3QpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KFtdKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcyA9IG5ldyBTZXQoW10pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgY29udGVudFxyXG4gICAgICAgIGNvbnRlbnRFbC5hZGRDbGFzcygnZGlyZWN0b3J5LXNlbGVjdGlvbi1tb2RhbCcpOyBcclxuXHJcbiAgICAgICAgLy8gLS0tIE1vZGFsIFRpdGxlIC0tLVxyXG4gICAgICAgIGlmICh0aGlzLmluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSkge1xyXG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnSW5jbHVkZSBvciBFeGNsdWRlIEZvbGRlcnMgYW5kIEZpbGVzJyB9KTsgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogYCR7dGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnID8gJ0V4Y2x1ZGUnIDogJ0luY2x1ZGUnfSBGb2xkZXJzIGFuZCBGaWxlc2AgfSk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gLS0tIFNldHRpbmdzIENvbnRyb2xzIC0tLVxyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xzRWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbW9kYWwtY29udHJvbHMnIH0pO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlTW9kZVNldHRpbmcoY29udHJvbHNFbCk7IC8vIENyZWF0ZSBtb2RlIGRyb3Bkb3duXHJcbiAgICAgICAgdGhpcy5jcmVhdGVTaG93RmlsZXNTZXR0aW5nKGNvbnRyb2xzRWwpOyAvLyBDcmVhdGUgZmlsZSB0b2dnbGVcclxuXHJcbiAgICAgICAgLy8gLS0tIFRyZWUgQ29udGFpbmVyIC0tLVxyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50ID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ3RyZWUtdmlldy1jb250YWluZXInIH0pO1xyXG4gICAgICAgIC8vIEJhc2ljIHN0eWxpbmcgZm9yIHRoZSBzY3JvbGxhYmxlIHRyZWUgYXJlYVxyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm1heEhlaWdodCA9ICc2MDBweCc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMTBweCc7XHJcblxyXG4gICAgICAgIC8vIC0tLSBCdWlsZCBhbmQgUmVuZGVyIFRyZWUgLS0tXHJcbiAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTsgLy8gSW5pdGlhbCByZW5kZXJpbmcgYmFzZWQgb24gY3VycmVudCBzdGF0ZVxyXG5cclxuICAgICAgICAvLyAtLS0gQWN0aW9uIEJ1dHRvbnMgLS0tXHJcbiAgICAgICAgdGhpcy5jcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRlbnRFbCk7IC8vIENyZWF0ZSBPSyBhbmQgUmVzZXQgYnV0dG9uc1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgZHJvcGRvd24gc2V0dGluZyBmb3IgY2hvb3NpbmcgdGhlIHNlbGVjdGlvbiBtb2RlLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIHNldHRpbmcgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlTW9kZVNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZURyb3Bkb3duID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpIC8vIFN0b3JlIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1NlbGVjdGlvbiBNb2RlJykgLy8gU2V0dGluZyBOYW1lIGluIEdlcm1hblxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBpZiB0aGUgc2VsZWN0ZWQgZmlsZXMgYW5kIGZvbGRlcnMgc2hvdWxkIGJlIGV4Y2x1ZGVkIG9yIGluY2x1ZGVkLicpIFxyXG4gICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdleGNsdWRlJywgJ2V4Y2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdpbmNsdWRlJywgJ2luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSkgLy8gU2V0IGluaXRpYWwgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB2YWx1ZSBhcyAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7IC8vIFVwZGF0ZSB0cmVlIHZpc3VhbHMgYmFzZWQgb24gbmV3IG1vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBtb2RlIGRyb3Bkb3duIFVJIGVsZW1lbnQgdG8gcmVmbGVjdCB0aGUgY3VycmVudE1vZGUgc3RhdGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlTW9kZURyb3Bkb3duKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGRyb3Bkb3duQ29tcG9uZW50ID0gdGhpcy5tb2RlRHJvcGRvd24/LmNvbXBvbmVudHNbMF0gYXMgYW55OyAvLyBBY2Nlc3MgZHJvcGRvd24gY29tcG9uZW50XHJcbiAgICAgICAgaWYgKGRyb3Bkb3duQ29tcG9uZW50ICYmIHR5cGVvZiBkcm9wZG93bkNvbXBvbmVudC5zZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgZHJvcGRvd25Db21wb25lbnQuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIHRvZ2dsZSBzZXR0aW5nIGZvciBzaG93aW5nL2hpZGluZyBmaWxlcyBpbiB0aGUgdHJlZS5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBzZXR0aW5nIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdTaG93IEZpbGVzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1Nob3cgRmlsZXMgd2l0aGluIHRoZSBkaXJlY3RvcnkgdHJlZS4nKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zaG93RmlsZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93RmlsZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIHRoZSBcIk9LXCIgYW5kIFwiUmVzZXRcIiBidXR0b25zLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIGJ1dHRvbnMgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBidXR0b25zRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1idXR0b25zJyB9KTtcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUubWFyZ2luVG9wID0gJzE1cHgnO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOyAvLyBVc2UgZmxleCBmb3IgYWxpZ25tZW50XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2ZsZXgtZW5kJzsgLy8gQWxpZ24gYnV0dG9ucyB0byB0aGUgcmlnaHRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuZ2FwID0gJzEwcHgnOyAvLyBTcGFjZSBiZXR3ZWVuIGJ1dHRvbnNcclxuXHJcbiAgICAgICAgLy8gUmVzZXQgQnV0dG9uIChVbmRvIFx1MjFBQVx1RkUwRilcclxuICAgICAgICBjb25zdCByZXNldEJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XHJcbiAgICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmb3IgY29uc2lzdGVuY3ksIG9yIHVzZSB0ZXh0XHJcbiAgICAgICAgc2V0SWNvbihyZXNldEJ1dHRvbiwgJ3Jlc2V0Jyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLmFyaWFMYWJlbCA9ICdSZXNldCBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgcmVzZXRCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvblRvSW5pdGlhbCgpOyAvLyBSZXNldCBpbnRlcm5hbCBzdGF0ZVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVEcm9wZG93bigpOyAvLyBVcGRhdGUgZHJvcGRvd24gVUlcclxuICAgICAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTsgLy8gUmUtcmVuZGVyIHRyZWUgd2l0aCByZXNldCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENsZWFyIEJ1dHRvbiAoQ2xlYXIgXHVEODNEXHVERUFFKVxyXG4gICAgICAgIGNvbnN0IGVtcHR5QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKGVtcHR5QnV0dG9uLCAnZXJhc2VyJyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIGVtcHR5QnV0dG9uLmFyaWFMYWJlbCA9ICdDbGVhciBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgZW1wdHlCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvblRvRW1wdHkoKTsgLy8gQ2xlYXIgc3RhdGVcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RlRHJvcGRvd24oKTsgLy8gVXBkYXRlIGRyb3Bkb3duIFVJXHJcbiAgICAgICAgICAgIHRoaXMuYnVpbGRBbmRSZW5kZXJUcmVlKCk7IC8vIFJlLXJlbmRlciB0cmVlIHdpdGggcmVzZXQgc3RhdGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBjYW5jZWwgQnV0dG9uXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDYW5jZWwnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIGRpc2NhcmQgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBjYW5jZWxCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYW5jZWwgQ2xpY2tlZCAtIFJldHVybmluZ1wiKTsgLy8gRGVidWcgbG9nXHJcbiAgICAgICAgICAgIHRoaXMub2tDYWxsYmFjayggbnVsbCApOyAvLyBQYXNzIHRoZSBmaW5hbCBzZWxlY3Rpb24gYmFja1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gT0sgQnV0dG9uXHJcbiAgICAgICAgY29uc3Qgb2tCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ09LJywgY2xzOiAnbW9kLWN0YScgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgc2F2ZSBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIG9rQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCdWlsZHMgdGhlIGxvZ2ljYWwgdHJlZSBzdHJ1Y3R1cmUgZGF0YSBmcm9tIHRoZSB2YXVsdCdzIGZpbGVzIGFuZCBmb2xkZXJzLlxyXG4gICAgICogQHJldHVybnMgVGhlIHJvb3Qgbm9kZSBvZiB0aGUgdHJlZSBzdHJ1Y3R1cmUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYnVpbGRUcmVlRGF0YSgpOiBUcmVlTm9kZSB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgdmlydHVhbCByb290IG5vZGUgcmVwcmVzZW50aW5nIHRoZSB2YXVsdFxyXG4gICAgICAgIGNvbnN0IHZhdWx0Um9vdE5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgcGF0aDogJy8nLFxyXG4gICAgICAgICAgICAgbmFtZTogdGhpcy5hcHAudmF1bHQuZ2V0TmFtZSgpIHx8ICdWYXVsdCcsIC8vIFVzZSB2YXVsdCBuYW1lIG9yIGRlZmF1bHRcclxuICAgICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxyXG4gICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICAgLy8gUGxhY2Vob2xkZXIgZWxlbWVudHMsIHdpbGwgYmUgYXNzaWduZWQgZHVyaW5nIHJlbmRlcmluZyBpZiByb290IGlzIHJlbmRlcmVkXHJcbiAgICAgICAgICAgICBlbGVtZW50OiBudWxsISwgY2hlY2tib3g6IG51bGwhLCBsYWJlbDogbnVsbCEsIGNvbnRhaW5lcjogbnVsbCFcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGZvbGRlck5vZGVzID0gbmV3IE1hcDxzdHJpbmcsIFRyZWVOb2RlPigpO1xyXG4gICAgICAgIGZvbGRlck5vZGVzLnNldCgnLycsIHZhdWx0Um9vdE5vZGUpOyAvLyBBZGQgcm9vdCB0byB0aGUgbWFwXHJcblxyXG4gICAgICAgIC8vIFVzZSBnZXRGaWxlcygpIHRvIHJldHJpZXZlIGFsbCBURmlsZSBvYmplY3RzIChNYXJrZG93biwgaW1hZ2VzLCBwZGYsIGV0Yy4pXHJcbiAgICAgICAgY29uc3QgYWxsRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpO1xyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAxOiBDcmVhdGUgYWxsIGZvbGRlciBub2RlcyBiYXNlZCBvbiBmaWxlIHBhcmVudCBwYXRocyAtLS1cclxuICAgICAgICBhbGxGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIHBhcmVudCBmb2xkZXIgb2JqZWN0IGZvciB0aGUgZmlsZVxyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudDtcclxuICAgICAgICAgICAgLy8gRW5zdXJlIHBhcmVudEZvbGRlciBleGlzdHMgYmVmb3JlIHByb2NlZWRpbmcgKFNhZmV0eSBjaGVjaylcclxuICAgICAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICAvLyBTcGxpdCBwYXRoLCBmaWx0ZXIgZW1wdHkgc3RyaW5ncyAoaGFuZGxlcyByb290ICcvJylcclxuICAgICAgICAgICAgY29uc3QgcGF0aFBhcnRzID0gcGFyZW50Rm9sZGVyLnBhdGguc3BsaXQoJy8nKS5maWx0ZXIocCA9PiBwLmxlbmd0aCA+IDApO1xyXG5cclxuICAgICAgICAgICAgbGV0IHBhcmVudE5vZGUgPSB2YXVsdFJvb3ROb2RlOyAvLyBTdGFydCBmcm9tIHZhdWx0IHJvb3RcclxuICAgICAgICAgICAgcGF0aFBhcnRzLmZvckVhY2gocGFydCA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBDb25zdHJ1Y3QgdGhlIGZ1bGwgcGF0aCBmb3IgdGhlIGN1cnJlbnQgcGFydFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBjdXJyZW50UGF0aCA9PT0gJy8nID8gcGFydCA6IGAke2N1cnJlbnRQYXRofS8ke3BhcnR9YDtcclxuICAgICAgICAgICAgICAgIGlmICghZm9sZGVyTm9kZXMuaGFzKGN1cnJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgZm9sZGVyIG5vZGUgaWYgaXQgZG9lc24ndCBleGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZvbGRlck5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogY3VycmVudFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQbGFjZWhvbGRlcnMsIGFzc2lnbmVkIGR1cmluZyByZW5kZXJpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLCBjaGVja2JveDogbnVsbCEsIGxhYmVsOiBudWxsISwgY29udGFpbmVyOiBudWxsIVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVyTm9kZXMuc2V0KGN1cnJlbnRQYXRoLCBuZXdGb2xkZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgcGFyZW50Tm9kZSBoYXMgY2hpbGRyZW4gYXJyYXkgaW5pdGlhbGl6ZWRcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuIS5wdXNoKG5ld0ZvbGRlck5vZGUpOyAvLyBBZGQgdG8gcGFyZW50J3MgY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gbmV3Rm9sZGVyTm9kZTsgLy8gTW92ZSBkb3duIHRoZSB0cmVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvbGRlciBub2RlIGFscmVhZHkgZXhpc3RzLCBqdXN0IG1vdmUgZG93blxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUgPSBmb2xkZXJOb2Rlcy5nZXQoY3VycmVudFBhdGgpITtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBTdGVwIDI6IEFkZCBmaWxlIG5vZGVzIGlmICdzaG93RmlsZXMnIGlzIGVuYWJsZWQgLS0tXHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0ZpbGVzKSB7XHJcbiAgICAgICAgICAgICBhbGxGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgIC8vIEdldCBwYXJlbnQgZm9sZGVyIGFuZCBhZGQgc2FmZXR5IGNoZWNrIGZvciBudWxsXHJcbiAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS53YXJuKGBGaWxlIFwiJHtmaWxlLnBhdGh9XCIgc2VlbXMgdG8gaGF2ZSBubyBwYXJlbnQgZm9sZGVyLiBTa2lwcGluZy5gKTsgLy8gT3B0aW9uYWwgd2FybmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIFNraXAgdGhpcyBmaWxlIGlmIGl0IGhhcyBubyBwYXJlbnRcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IFwiL1wiK3BhcmVudEZvbGRlci5wYXRoOyAvLyBOb3cgc2FmZSB0byBhY2Nlc3MgLnBhdGhcclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gZm9sZGVyTm9kZXMuZ2V0KHBhcmVudFBhdGgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGZpbGUgbm9kZVxyXG4gICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVOb2RlOiBUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmaWxlJyxcclxuICAgICAgICAgICAgICAgICAgICAgLy8gRmlsZXMgZG9uJ3QgaGF2ZSBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgICAgICAvLyBQbGFjZWhvbGRlcnMsIGFzc2lnbmVkIGR1cmluZyByZW5kZXJpbmdcclxuICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbCEsIGNoZWNrYm94OiBudWxsISwgbGFiZWw6IG51bGwhLCBjb250YWluZXI6IG51bGwhXHJcbiAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgaWYgKHBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIGNoaWxkcmVuIGFycmF5IGV4aXN0c1xyXG4gICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBmaWxlIHRvIGl0cyBwYXJlbnQgZm9sZGVyJ3MgY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiEucHVzaChmaWxlTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBjYXNlIHNob3VsZCBpZGVhbGx5IG5vdCBoYXBwZW4gaWYgU3RlcCAxIHdvcmtlZCBjb3JyZWN0bHkgZm9yIGFsbCBmb2xkZXJzXHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihgQ291bGQgbm90IGZpbmQgcGFyZW50IG5vZGUgZm9yIHBhdGggXCIke3BhcmVudFBhdGh9XCIgd2hpbGUgYWRkaW5nIGZpbGUgXCIke2ZpbGUucGF0aH1cIi5gKTsgLy8gT3B0aW9uYWwgd2FybmluZ1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gLS0tIFN0ZXAgMzogU29ydCBjaGlsZHJlbiBhbHBoYWJldGljYWxseSAoZm9sZGVycyBmaXJzdCwgdGhlbiBmaWxlcykgLS0tXHJcbiAgICAgICAgY29uc3Qgc29ydE5vZGVzID0gKGE6IFRyZWVOb2RlLCBiOiBUcmVlTm9kZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYS50eXBlID09PSAnZm9sZGVyJyAmJiBiLnR5cGUgPT09ICdmaWxlJykgcmV0dXJuIC0xOyAvLyBGb2xkZXJzIGNvbWUgZmlyc3RcclxuICAgICAgICAgICAgaWYgKGEudHlwZSA9PT0gJ2ZpbGUnICYmIGIudHlwZSA9PT0gJ2ZvbGRlcicpIHJldHVybiAxOyAgLy8gRmlsZXMgY29tZSBhZnRlclxyXG4gICAgICAgICAgICByZXR1cm4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKTsgLy8gU29ydCBhbHBoYWJldGljYWxseSBieSBuYW1lXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gU29ydCBjaGlsZHJlbiBvZiBldmVyeSBmb2xkZXIgbm9kZVxyXG4gICAgICAgIGZvbGRlck5vZGVzLmZvckVhY2gobm9kZSA9PiBub2RlLmNoaWxkcmVuPy5zb3J0KHNvcnROb2RlcykpO1xyXG5cclxuICAgICAgICByZXR1cm4gdmF1bHRSb290Tm9kZTsgLy8gUmV0dXJuIHRoZSBwb3B1bGF0ZWQgcm9vdCBub2RlXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVycyB0aGUgZW50aXJlIHRyZWUgc3RydWN0dXJlIGluIHRoZSBET00gYmFzZWQgb24gdGhlIHRyZWUgZGF0YS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJUcmVlKCkge1xyXG4gICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5lbXB0eSgpOyAvLyBDbGVhciBleGlzdGluZyBET00gZWxlbWVudHNcclxuICAgICAgICAgdGhpcy50cmVlTm9kZXMuY2xlYXIoKTsgLy8gQ2xlYXIgdGhlIG5vZGUgbWFwXHJcblxyXG4gICAgICAgICBjb25zdCB0cmVlRGF0YSA9IHRoaXMuYnVpbGRUcmVlRGF0YSgpOyAvLyBHZXQgdGhlIHN0cnVjdHVyZWQgZGF0YVxyXG5cclxuICAgICAgICAgLy8gQ3JlYXRlIHRoZSB0b3AtbGV2ZWwgbGlzdCBmb3IgdGhlIHZhdWx0IGNvbnRlbnRzXHJcbiAgICAgICAgIGNvbnN0IHJvb3RVbCA9IHRoaXMudHJlZVJvb3RFbGVtZW50LmNyZWF0ZUVsKCd1bCcpO1xyXG4gICAgICAgICByb290VWwuYWRkQ2xhc3MoJ3RyZWUtcm9vdC11bCcpO1xyXG4gICAgICAgICByb290VWwuc3R5bGUubGlzdFN0eWxlID0gJ25vbmUnO1xyXG4gICAgICAgICByb290VWwuc3R5bGUucGFkZGluZ0xlZnQgPSAnMCc7IC8vIFJlbW92ZSBkZWZhdWx0IGxpc3QgaW5kZW50YXRpb25cclxuXHJcbiAgICAgICAgIC8vIFJlbmRlciBjaGlsZHJlbiBvZiB0aGUgdmlydHVhbCB2YXVsdCByb290IG5vZGVcclxuICAgICAgICAgdHJlZURhdGEuY2hpbGRyZW4/LmZvckVhY2goY2hpbGROb2RlID0+IHtcclxuICAgICAgICAgICAgIHRoaXMucmVuZGVyVHJlZU5vZGUoY2hpbGROb2RlLCByb290VWwsIDApOyAvLyBTdGFydCByZW5kZXJpbmcgYXQgbGV2ZWwgMFxyXG4gICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlY3Vyc2l2ZWx5IHJlbmRlcnMgYSBzaW5nbGUgdHJlZSBub2RlIGFuZCBpdHMgY2hpbGRyZW4gaW4gdGhlIERPTS5cclxuICAgICAqIEBwYXJhbSBub2RlIC0gVGhlIFRyZWVOb2RlIGRhdGEgdG8gcmVuZGVyLlxyXG4gICAgICogQHBhcmFtIHBhcmVudEVsZW1lbnQgLSBUaGUgSFRNTCBgdWxgIGVsZW1lbnQgdG8gYXBwZW5kIHRoaXMgbm9kZSdzIGBsaWAgdG8uXHJcbiAgICAgKiBAcGFyYW0gbGV2ZWwgLSBUaGUgY3VycmVudCBpbmRlbnRhdGlvbiBsZXZlbC5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJUcmVlTm9kZShub2RlOiBUcmVlTm9kZSwgcGFyZW50RWxlbWVudDogSFRNTEVsZW1lbnQsIGxldmVsOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBsaSA9IHBhcmVudEVsZW1lbnQuY3JlYXRlRWwoJ2xpJyk7XHJcbiAgICAgICAgbGkuc3R5bGUubWFyZ2luTGVmdCA9IGAke2xldmVsICogMjB9cHhgOyAvLyBBcHBseSBpbmRlbnRhdGlvbiBiYXNlZCBvbiBsZXZlbFxyXG4gICAgICAgIGxpLmFkZENsYXNzKGB0cmVlLW5vZGUtJHtub2RlLnR5cGV9YCk7IC8vIEFkZCBjbGFzcyBmb3IgdHlwZSAoZm9sZGVyL2ZpbGUpXHJcblxyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGxpLmNyZWF0ZURpdih7IGNsczogJ3RyZWUtbm9kZS1jb250YWluZXInIH0pO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMnB4IDAnOyAvLyBBZGQgc29tZSB2ZXJ0aWNhbCBwYWRkaW5nXHJcblxyXG4gICAgICAgIC8vIC0tLSBDaGVja2JveCAtLS1cclxuICAgICAgICBjb25zdCBjaGVja2JveCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCB7IHR5cGU6ICdjaGVja2JveCcgfSk7XHJcbiAgICAgICAgY2hlY2tib3guaWQgPSBgdHJlZS1jYi0ke25vZGUucGF0aC5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywgJy0nKX1gOyAvLyBDcmVhdGUgYSBzYWZlIElEXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC5wYXRoID0gbm9kZS5wYXRoOyAvLyBTdG9yZSBwYXRoIGluIGRhdGEgYXR0cmlidXRlXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC50eXBlID0gbm9kZS50eXBlOyAvLyBTdG9yZSB0eXBlXHJcblxyXG4gICAgICAgIC8vIC0tLSBMYWJlbCAtLS1cclxuICAgICAgICBjb25zdCBsYWJlbCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnKTtcclxuICAgICAgICAvLyBBZGQgaWNvbnMgZm9yIHZpc3VhbCBkaXN0aW5jdGlvbiAob3B0aW9uYWwpXHJcbiAgICAgICAgbGFiZWwudGV4dENvbnRlbnQgPSBgJHtub2RlLnR5cGUgPT09ICdmb2xkZXInID8gJ1x1RDgzRFx1RENDMScgOiAnXHVEODNEXHVEQ0M0J30gJHtub2RlLm5hbWV9YDtcclxuICAgICAgICBsYWJlbC5odG1sRm9yID0gY2hlY2tib3guaWQ7IC8vIExpbmsgbGFiZWwgdG8gY2hlY2tib3hcclxuICAgICAgICBsYWJlbC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzVweCc7XHJcbiAgICAgICAgbGFiZWwuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgIGxhYmVsLnRpdGxlID0gbm9kZS5wYXRoOyAvLyBTaG93IGZ1bGwgcGF0aCBvbiBob3ZlclxyXG5cclxuICAgICAgICAvLyAtLS0gU3RvcmUgcmVmZXJlbmNlcyBpbiB0aGUgbm9kZSBvYmplY3QgYW5kIG1hcCAtLS1cclxuICAgICAgICBub2RlLmVsZW1lbnQgPSBsaTtcclxuICAgICAgICBub2RlLmNoZWNrYm94ID0gY2hlY2tib3g7XHJcbiAgICAgICAgbm9kZS5sYWJlbCA9IGxhYmVsO1xyXG4gICAgICAgIG5vZGUuY29udGFpbmVyID0gY29udGFpbmVyOyAvLyBTdG9yZSBjb250YWluZXIgcmVmZXJlbmNlXHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuc2V0KG5vZGUucGF0aCwgbm9kZSk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBTZXQgaW5pdGlhbCBjaGVja2VkIHN0YXRlIGJhc2VkIG9uIGN1cnJlbnQgc2VsZWN0aW9uIC0tLVxyXG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdmb2xkZXInKSB7XHJcbiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhub2RlLnBhdGgpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIGZpbGVcclxuICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHRoaXMuY3VycmVudEZpbGVzLmhhcyhub2RlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gLS0tIEFkZCBldmVudCBsaXN0ZW5lciBmb3IgY2hlY2tib3ggY2hhbmdlcyAtLS1cclxuICAgICAgICBjaGVja2JveC5vbmNoYW5nZSA9IChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgICAgY29uc3QgcGF0aCA9IHRhcmdldC5kYXRhc2V0LnBhdGghO1xyXG4gICAgICAgICAgICBjb25zdCB0eXBlID0gdGFyZ2V0LmRhdGFzZXQudHlwZSBhcyAnZm9sZGVyJyB8ICdmaWxlJztcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY3VycmVudCBzZWxlY3Rpb24gc2V0c1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0LmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnZm9sZGVyJykgdGhpcy5jdXJyZW50Rm9sZGVycy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHRoaXMuY3VycmVudEZpbGVzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2ZvbGRlcicpIHRoaXMuY3VycmVudEZvbGRlcnMuZGVsZXRlKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5jdXJyZW50RmlsZXMuZGVsZXRlKHBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdmlzdWFsIHN0YXRlIG9mIHRoZSBlbnRpcmUgdHJlZSBhZnRlciBhIGNoYW5nZVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFJlbmRlciBjaGlsZHJlbiByZWN1cnNpdmVseSBpZiBpdCdzIGEgZm9sZGVyIC0tLVxyXG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdmb2xkZXInICYmIG5vZGUuY2hpbGRyZW4gJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuVWwgPSBsaS5jcmVhdGVFbCgndWwnKTtcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5saXN0U3R5bGUgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuVWwuc3R5bGUucGFkZGluZ0xlZnQgPSAnMCc7IC8vIFJlc2V0IHBhZGRpbmcgZm9yIG5lc3RlZCBsaXN0XHJcbiAgICAgICAgICAgIGNoaWxkcmVuVWwuc3R5bGUubWFyZ2luTGVmdCA9ICcwJzsgLy8gUHJldmVudCBkb3VibGUgaW5kZW50YXRpb24gZnJvbSBkZWZhdWx0IFVMIHN0eWxlc1xyXG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4gdGhpcy5yZW5kZXJUcmVlTm9kZShjaGlsZCwgY2hpbGRyZW5VbCwgbGV2ZWwgKyAxKSk7IC8vIEluY3JlYXNlIGxldmVsIGZvciBjaGlsZHJlblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB2aXN1YWwgYXBwZWFyYW5jZSAoZW5hYmxlZC9kaXNhYmxlZC9zdHlsaW5nKSBvZiBhbGwgbm9kZXNcclxuICAgICAqIGluIHRoZSB0cmVlIGJhc2VkIG9uIHRoZSBjdXJyZW50IG1vZGUgYW5kIHNlbGVjdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlVHJlZUFwcGVhcmFuY2UoKSB7XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaXNEaXNhYmxlZCA9IGZhbHNlOyAvLyBTaG91bGQgdGhlIG5vZGUgYXBwZWFyIGRpc2FibGVkIChncmV5ZWQgb3V0KT9cclxuICAgICAgICAgICAgbGV0IGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IGZhbHNlOyAvLyBJcyB0aGUgbm9kZSBwYXJ0IG9mIHRoZSAnYWN0aXZlJyBzZXQgaW4gaW5jbHVkZSBtb2RlP1xyXG4gICAgICAgICAgICBsZXQgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkID0gZmFsc2U7IC8vIElzIHRoZSBub2RlIHBhcnQgb2YgdGhlICdpbmFjdGl2ZScgc2V0IGluIGV4Y2x1ZGUgbW9kZT9cclxuXHJcbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiBhbiBhbmNlc3RvciBGT0xERVIgb2YgdGhpcyBub2RlIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGxldCBhbmNlc3RvckZvbGRlclNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9IG5vZGUucGF0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnRQYXRoICE9PSAnLycpIHtcclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudFBhdGguc3Vic3RyaW5nKDAsIGN1cnJlbnRQYXRoLmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudFBhdGgpIGJyZWFrOyAvLyBTYWZldHkgYnJlYWsgYXQgcm9vdFxyXG4gICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gcGFyZW50UGF0aDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIG5vZGUgaXRzZWxmIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVTZWxlY3RlZCA9IG5vZGUudHlwZSA9PT0gJ2ZvbGRlcidcclxuICAgICAgICAgICAgICAgID8gdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMobm9kZS5wYXRoKVxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLmN1cnJlbnRGaWxlcy5oYXMobm9kZS5wYXRoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBBcHBseSBMb2dpYyBCYXNlZCBvbiBNb2RlIC0tLVxyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBFWENMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGV4Y2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBleGNsdWRlZC5cclxuICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlFeGNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9IGlzRWZmZWN0aXZlbHlFeGNsdWRlZDtcclxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gSU5DTFVERSBNb2RlXHJcbiAgICAgICAgICAgICAgICAvLyBJTkNMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGluY2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBOT1QgaW5jbHVkZWQuXHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgaW5jbHVkZWQgaWYgc2VsZWN0ZWQgT1IgcGFyZW50IHBhdGggaXMgaW5jbHVkZWRcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gbm9kZS5wYXRoLnN1YnN0cmluZygwLCBub2RlLnBhdGgubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQgPSB0aGlzLmlzUGF0aEVmZmVjdGl2ZWx5SW5jbHVkZWQocGFyZW50UGF0aCk7IC8vIENoZWNrIHBhcmVudCBmb2xkZXIgc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgaXNFZmZlY3RpdmVseUluY2x1ZGVkID0gbm9kZVNlbGVjdGVkIHx8IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkID0gIWlzRWZmZWN0aXZlbHlJbmNsdWRlZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEFwcGx5IFZpc3VhbCBTdHlsZXMgLS0tXHJcbiAgICAgICAgICAgIC8vIENoZWNrYm94IGl0c2VsZiBzaG91bGQgYWx3YXlzIGJlIGNsaWNrYWJsZSB0byBjaGFuZ2Ugc2VsZWN0aW9uIHN0YXRlXHJcbiAgICAgICAgICAgIG5vZGUuY2hlY2tib3guZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIC8vIEFwcGx5IHN0eWxpbmcgdG8gdGhlIGNvbnRhaW5lciAobGFiZWwsIGljb24pIGJhc2VkIG9uIGRpc2FibGVkIHN0YXRlXHJcbiAgICAgICAgICAgIGlmIChpc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gJzAuNSc7XHJcbiAgICAgICAgICAgICAgICBub2RlLmxhYmVsLnN0eWxlLnRleHREZWNvcmF0aW9uID0gJ2xpbmUtdGhyb3VnaCc7IC8vIE1vcmUgcHJvbWluZW50IGRpc2FibGVkIGxvb2tcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnaXMtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuY29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAnMSc7XHJcbiAgICAgICAgICAgICAgICBub2RlLmxhYmVsLnN0eWxlLnRleHREZWNvcmF0aW9uID0gJ25vbmUnO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LnJlbW92ZUNsYXNzKCdpcy1kaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAtLS0gRklYIGZvciBJbnZhbGlkQ2hhcmFjdGVyRXJyb3IgLS0tXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBjbGFzc2VzIGluZGl2aWR1YWxseVxyXG4gICAgICAgICAgICBub2RlLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaW5jbHVkZWQnLCAnaXMtZXhjbHVkZWQnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBzcGVjaWZpYyBjbGFzc2VzIGZvciBzdHlsaW5nIGluY2x1ZGVkL2V4Y2x1ZGVkIHN0YXRlc1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2luY2x1ZGUnICYmIGlzRWZmZWN0aXZlbHlJbmNsdWRlZCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LmFkZENsYXNzKCdpcy1pbmNsdWRlZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudE1vZGUgPT09ICdleGNsdWRlJyAmJiBpc0VmZmVjdGl2ZWx5RXhjbHVkZWQpIHtcclxuICAgICAgICAgICAgICAgICAvLyBBcHBseSBleGNsdWRlZCBjbGFzcyBldmVuIGlmIGl0J3MganVzdCB2aXN1YWxseSBkaXNhYmxlZFxyXG4gICAgICAgICAgICAgICAgIC8vIFRoaXMgYWxsb3dzIHNwZWNpZmljIHN0eWxpbmcgZm9yIGV4Y2x1ZGVkIGl0ZW1zIGJleW9uZCBqdXN0IGdyZXllZCBvdXRcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnaXMtZXhjbHVkZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhIGdpdmVuIHBhdGggaXMgZWZmZWN0aXZlbHkgaW5jbHVkZWRcclxuICAgICAqIGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB1bmRlciAnaW5jbHVkZScgbW9kZS5cclxuICAgICAqIEEgcGF0aCBpcyBpbmNsdWRlZCBpZiBpdCAoZmlsZSBvciBmb2xkZXIpIGlzIHNlbGVjdGVkLCBvciBpZiBhbnkgb2YgaXRzIGFuY2VzdG9yIEZPTERFUlMgYXJlIHNlbGVjdGVkLlxyXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZm9sZGVyIG9yIGZpbGUgcGF0aCB0byBjaGVjay5cclxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHBhdGggc2hvdWxkIGJlIGNvbnNpZGVyZWQgaW5jbHVkZWQsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpc1BhdGhFZmZlY3RpdmVseUluY2x1ZGVkKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFRoaXMgY2hlY2sgaXMgcHJpbWFyaWx5IGZvciAnaW5jbHVkZScgbW9kZSBsb2dpYy5cclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSAhPT0gJ2luY2x1ZGUnKSB7XHJcbiAgICAgICAgICAgICAvLyBJbiAnZXhjbHVkZScgbW9kZSwgY29uY2VwdHVhbGx5IGV2ZXJ5dGhpbmcgaXMgaW5jbHVkZWQgdW5sZXNzIGV4Y2x1ZGVkLlxyXG4gICAgICAgICAgICAgLy8gRm9yIGludGVybmFsIGNoZWNrcywgd2UgbWlnaHQgbmVlZCB0aGUgaW52ZXJzZSBvZiBleGNsdXNpb24uXHJcbiAgICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNQYXRoRWZmZWN0aXZlbHlFeGNsdWRlZChwYXRoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYXRoIGl0c2VsZiBpcyBzZWxlY3RlZCAoYXBwbGllcyB0byBib3RoIGZpbGVzIGFuZCBmb2xkZXJzKVxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlcy5oYXMocGF0aCkgfHwgdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGF0aCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBhbnkgYW5jZXN0b3IgRk9MREVSIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSBwYXRoO1xyXG4gICAgICAgIHdoaWxlIChjdXJyZW50ICE9PSAnLycpIHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IGN1cnJlbnQuc3Vic3RyaW5nKDAsIGN1cnJlbnQubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBBbiBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudCkgYnJlYWs7IC8vIFJlYWNoZWQgcm9vdCBvciBlcnJvclxyXG4gICAgICAgICAgICBjdXJyZW50ID0gcGFyZW50UGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTsgLy8gTmVpdGhlciB0aGUgcGF0aCBub3IgYW55IGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZFxyXG4gICAgfVxyXG5cclxuICAgICAvKipcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgaWYgYSBnaXZlbiBwYXRoIGlzIGVmZmVjdGl2ZWx5IGV4Y2x1ZGVkXHJcbiAgICAgKiBpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24gdW5kZXIgJ2V4Y2x1ZGUnIG1vZGUuXHJcbiAgICAgKiBBIHBhdGggaXMgZXhjbHVkZWQgaWYgaXQgKGZpbGUgb3IgZm9sZGVyKSBpcyBzZWxlY3RlZCwgb3IgaWYgYW55IG9mIGl0cyBhbmNlc3RvciBGT0xERVJTIGFyZSBzZWxlY3RlZC5cclxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZvbGRlciBvciBmaWxlIHBhdGggdG8gY2hlY2suXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBwYXRoIHNob3VsZCBiZSBjb25zaWRlcmVkIGV4Y2x1ZGVkLCBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNQYXRoRWZmZWN0aXZlbHlFeGNsdWRlZChwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICAgLy8gVGhpcyBjaGVjayBpcyBwcmltYXJpbHkgZm9yICdleGNsdWRlJyBtb2RlIGxvZ2ljLlxyXG4gICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSAhPT0gJ2V4Y2x1ZGUnKSB7XHJcbiAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYXRoIGl0c2VsZiBpcyBzZWxlY3RlZFxyXG4gICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsZXMuaGFzKHBhdGgpIHx8IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhdGgpKSB7XHJcbiAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgLy8gQ2hlY2sgaWYgYW55IGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZFxyXG4gICAgICAgICBsZXQgY3VycmVudCA9IHBhdGg7XHJcbiAgICAgICAgIHdoaWxlIChjdXJyZW50ICE9PSAnLycpIHtcclxuICAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBjdXJyZW50LnN1YnN0cmluZygwLCBjdXJyZW50Lmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBBbiBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSBjdXJyZW50KSBicmVhazsgLy8gUmVhY2hlZCByb290IG9yIGVycm9yXHJcbiAgICAgICAgICAgICBjdXJyZW50ID0gcGFyZW50UGF0aDtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBOZWl0aGVyIHRoZSBwYXRoIG5vciBhbnkgYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkIGZvciBleGNsdXNpb25cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21iaW5lcyBidWlsZGluZyB0aGUgdHJlZSBkYXRhLCByZW5kZXJpbmcgdGhlIERPTSwgYW5kIGFwcGx5aW5nIGluaXRpYWwgYXBwZWFyYW5jZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBidWlsZEFuZFJlbmRlclRyZWUoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJUcmVlKCk7IC8vIEJ1aWxkIGRhdGEgYW5kIHJlbmRlciBET00gZWxlbWVudHNcclxuICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7IC8vIEFwcGx5IHN0eWxlcyBiYXNlZCBvbiBjdXJyZW50IG1vZGUvc2VsZWN0aW9uXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIGNsb3NlZC4gQ2xlYW5zIHVwIHJlc291cmNlcy5cclxuICAgICAqL1xyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICAvLyBHYXRoZXIgdGhlIGZpbmFsIHN0YXRlIE9OTFkgd2hlbiBPSyBpcyBjbGlja2VkXHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGZvbGRlcnM6IEFycmF5LmZyb20odGhpcy5jdXJyZW50Rm9sZGVycyksXHJcbiAgICAgICAgICAgIGZpbGVzOiBBcnJheS5mcm9tKHRoaXMuY3VycmVudEZpbGVzKSxcclxuICAgICAgICAgICAgbW9kZTogdGhpcy5jdXJyZW50TW9kZSxcclxuICAgICAgICAgICAgZGlzcGxheTogdGhpcy5jdXJyZW50RGlzcGxheSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiT0sgQ2xpY2tlZCAtIFJldHVybmluZyBSZXN1bHQ6XCIsIHJlc3VsdCk7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgIHRoaXMub2tDYWxsYmFjayhyZXN1bHQpOyAvLyBQYXNzIHRoZSBmaW5hbCBzZWxlY3Rpb24gYmFja1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciB0aGUgbW9kYWwncyBjb250ZW50XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuY2xlYXIoKTsgLy8gQ2xlYXIgdGhlIG5vZGUgbWFwIHRvIGZyZWUgbWVtb3J5XHJcbiAgICAgICAgdGhpcy5tb2RlRHJvcGRvd24gPSBudWxsOyAvLyBDbGVhciByZWZlcmVuY2VcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBlYXNpbHkgb3BlbiB0aGUgRGlyZWN0b3J5IFNlbGVjdGlvbiBNb2RhbC5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBpbml0aWFsRm9sZGVycyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmb2xkZXIgcGF0aHMuXHJcbiAqIEBwYXJhbSBpbml0aWFsRmlsZXMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZmlsZSBwYXRocy5cclxuICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICBhcHA6IEFwcCxcclxuICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgIGluaXRpYWxGaWxlczogc3RyaW5nW10sXHJcbiAgICBpbml0aWFsTW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnLFxyXG4gICAgaW5pdGlhbERpc3BsYXk6ICdmb2xkZXJzJyB8ICdmaWxlcycsXHJcbiAgICBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGU6IGJvb2xlYW4sXHJcbiAgICBva0NhbGxiYWNrOiAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB2b2lkXHJcbik6IHZvaWQge1xyXG4gICAgLy8gQ3JlYXRlIGFuZCBvcGVuIHRoZSBtb2RhbCBpbnN0YW5jZVxyXG4gICAgbmV3IERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgIGFwcCxcclxuICAgICAgICBpbml0aWFsRm9sZGVycyxcclxuICAgICAgICBpbml0aWFsRmlsZXMsXHJcbiAgICAgICAgaW5pdGlhbE1vZGUsXHJcbiAgICAgICAgaW5pdGlhbERpc3BsYXksXHJcbiAgICAgICAgaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlLFxyXG4gICAgICAgIG9rQ2FsbGJhY2tcclxuICAgICkub3BlbigpO1xyXG59XHJcblxyXG4vKlxyXG4vLyAtLS0gRXhhbXBsZSBVc2FnZSBpbiB5b3VyIFBsdWdpbidzIFNldHRpbmdzIFRhYiAtLS1cclxuLy8gKFBsYWNlIHRoaXMgaW4geW91ciBzZXR0aW5ncyB0YWIgZmlsZSwgZS5nLiwgc2V0dGluZ3MudHMpXHJcblxyXG5pbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCwgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi9EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7IC8vIEFkanVzdCBwYXRoIGFzIG5lZWRlZFxyXG5pbXBvcnQgWW91clBsdWdpbiBmcm9tICcuL21haW4nOyAvLyBBZGp1c3QgcGF0aCB0byB5b3VyIG1haW4gcGx1Z2luIGZpbGVcclxuXHJcbi8vIC0tLSBFeGFtcGxlIFBsdWdpbiBTZXR0aW5ncyBJbnRlcmZhY2UgKGluIHlvdXIgbWFpbi50cyBvciBzZXR0aW5ncyBmaWxlKSAtLS1cclxuZXhwb3J0IGludGVyZmFjZSBZb3VyUGx1Z2luU2V0dGluZ3Mge1xyXG4gICAgc2VsZWN0ZWRGb2xkZXJzOiBzdHJpbmdbXTtcclxuICAgIHNlbGVjdGVkRmlsZXM6IHN0cmluZ1tdO1xyXG4gICAgc2VsZWN0aW9uTW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnO1xyXG4gICAgLy8gLi4uIG90aGVyIHNldHRpbmdzIGZvciB5b3VyIHBsdWdpblxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogWW91clBsdWdpblNldHRpbmdzID0ge1xyXG4gICAgc2VsZWN0ZWRGb2xkZXJzOiBbXSxcclxuICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgc2VsZWN0aW9uTW9kZTogJ2V4Y2x1ZGUnLCAvLyBEZWZhdWx0IG1vZGUgaXMgb2Z0ZW4gJ2V4Y2x1ZGUnXHJcbiAgICAvLyAuLi4gb3RoZXIgZGVmYXVsdCBzZXR0aW5nc1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIFlvdXJQbHVnaW5TZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBZb3VyUGx1Z2luO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFlvdXJQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0VpbnN0ZWxsdW5nZW4gZlx1MDBGQ3IgTWVpbiBQbHVnaW4nIH0pOyAvLyBTZXR0aW5ncyBUaXRsZSBpbiBHZXJtYW5cclxuXHJcbiAgICAgICAgLy8gLS0tIEJ1dHRvbiB0byBPcGVuIHRoZSBNb2RhbCAtLS1cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1ZlcnplaWNobmlzc2UvRGF0ZWllbiBrb25maWd1cmllcmVuJykgLy8gU2V0dGluZyBOYW1lIGluIEdlcm1hblxyXG4gICAgICAgICAgICAuc2V0RGVzYygnS2xpY2tlIGF1ZiBkZW4gQnV0dG9uLCB1bSBkaWUgQXVzd2FobCB6dSBiZWFyYmVpdGVuLicpIC8vIFNldHRpbmcgRGVzY3JpcHRpb24gaW4gR2VybWFuXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdBdXN3YWhsIFx1MDBGNmZmbmVuJykgLy8gQnV0dG9uIFRleHQgaW4gR2VybWFuXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIGN1cnJlbnQgc2V0dGluZ3MgdG8gcHJlLXBvcHVsYXRlIHRoZSBtb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Rm9sZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVycyB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpbGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGaWxlcyB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudE1vZGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3Rpb25Nb2RlIHx8ICdleGNsdWRlJzsgLy8gVXNlIGRlZmF1bHQgaWYgbm90IHNldFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlbiB0aGUgbW9kYWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Rm9sZGVycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWxlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgb2tDYWxsYmFjayBmdW5jdGlvbjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBdXN3YWhsIGJlc3RcdTAwRTR0aWd0OicsIHJlc3VsdCk7IC8vIExvZyByZXN1bHQgaW4gR2VybWFuIGNvbnNvbGVcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLS0tIElNUE9SVEFOVDogU2F2ZSB0aGUgcmVzdWx0cyBiYWNrIHRvIHlvdXIgcGx1Z2luIHNldHRpbmdzIC0tLVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0aW9uTW9kZSA9IHJlc3VsdC5tb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyAvLyBQZXJzaXN0IHRoZSBjaGFuZ2VzXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wdGlvbmFsbHksIHJlLXJlbmRlciB0aGUgc2V0dGluZ3MgdGFiIHRvIHNob3cgdGhlIHVwZGF0ZWQgc2VsZWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlLXJlbmRlciBzZXR0aW5ncyB0YWJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAvLyAtLS0gRGlzcGxheSBDdXJyZW50IFNlbGVjdGlvbiAoUmVhZC1vbmx5KSAtLS1cclxuICAgICAgICAgY29uc3Qgc2VsZWN0aW9uSW5mb0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3Mtc2VsZWN0aW9uLWluZm8nIH0pO1xyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQWt0dWVsbGUgQXVzd2FobDonIH0pOyAvLyBTZWN0aW9uIFRpdGxlIGluIEdlcm1hblxyXG4gICAgICAgICBjb25zdCBtb2RlVGV4dCA9IGBNb2R1czogJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3Rpb25Nb2RlIHx8ICdOaWNodCBmZXN0Z2VsZWd0J31gOyAvLyBUZXh0IGluIEdlcm1hblxyXG4gICAgICAgICAvLyBUcnVuY2F0ZSBsb25nIGxpc3RzIGZvciBkaXNwbGF5IGlmIG5lY2Vzc2FyeVxyXG4gICAgICAgICBjb25zdCBmb2xkZXJUZXh0ID0gYEF1c2dld1x1MDBFNGhsdGUgT3JkbmVyOiAkeyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZvbGRlcnM/Lmxlbmd0aCB8fCAwKX0gU3RcdTAwRkNja2A7IC8vIFRleHQgaW4gR2VybWFuXHJcbiAgICAgICAgIGNvbnN0IGZpbGVUZXh0ID0gYEF1c2dld1x1MDBFNGhsdGUgRGF0ZWllbjogJHsodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGaWxlcz8ubGVuZ3RoIHx8IDApfSBTdFx1MDBGQ2NrYDsgLy8gVGV4dCBpbiBHZXJtYW5cclxuXHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogbW9kZVRleHQgfSk7XHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogZm9sZGVyVGV4dCB9KTtcclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBmaWxlVGV4dCB9KTtcclxuICAgICAgICAgLy8gWW91IGNvdWxkIGFkZCBhIHNtYWxsIGJ1dHRvbi9saW5rIGhlcmUgdG8gdmlldyB0aGUgZnVsbCBsaXN0IGlmIGl0J3MgbG9uZ1xyXG4gICAgfVxyXG59XHJcbiovXHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBMEg7OztBQ0ExSCxJQUFBQyxtQkFBa0c7OztBQ0FsRyxzQkFBaUQ7QUEwQzFDLFNBQVMsaUNBQWlDLEtBQThCO0FBQzNFLE1BQUk7QUFDQSxVQUFNLGtCQUFtQixJQUFZO0FBQ3JDLFlBQVEsSUFBSSxtQkFBa0IsZUFBZTtBQUM3QyxXQUFPLE9BQU8sT0FBTyxnQkFBZ0IsVUFBVSxFQUFFLElBQUssQ0FBQyxXQUFnQztBQUFBLE1BQ25GLE1BQU0sTUFBTTtBQUFBLE1BQ1osTUFBTSxNQUFNO0FBQUEsTUFDWixPQUFPLE1BQU07QUFBQSxNQUNiLFFBQVE7QUFBQSxJQUNaLEVBQUUsRUFBRSxLQUFLLENBQUMsR0FBRyxNQUFNLEVBQUUsS0FBSyxjQUFjLEVBQUUsSUFBSSxDQUFDO0FBQUEsRUFFbkQsU0FBUyxHQUFQO0FBQ0UsWUFBUSxNQUFNLG9EQUFvRCxDQUFDO0FBQ25FLFdBQU8sQ0FBQztBQUFBLEVBQ1o7QUFDSjtBQUlPLFNBQVMsNEJBQTRCLEtBQWU7QUFDdkQsTUFBSTtBQUNBLFVBQU0sa0JBQW1CLElBQVk7QUFDckMsWUFBUSxJQUFJLGNBQWEsZUFBZTtBQUN4QyxXQUFPLE9BQU8sT0FBTyxnQkFBZ0IscUJBQXFCLEVBQUUsSUFBSyxDQUFDLE9BQVcsT0FBTyxXQUF5QjtBQUFBLE1BQ3pHLE1BQU0sTUFBTTtBQUFBLE1BQ1osTUFBTSxNQUFNO0FBQUEsTUFDWixRQUFRO0FBQUEsSUFDWixFQUFFLEVBQUUsS0FBSyxDQUFD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Y0FBYyxRQUFRLE1BQU0sY0FBYztBQUdoRCxVQUFJLHFCQUFxQixPQUFPLFFBQVEsY0FBYyxFQUNqRCxJQUFJLENBQUMsQ0FBQyxLQUFLLEtBQUssTUFBTSxHQUFHLFFBQVEsT0FBTyxFQUN4QyxLQUFLLElBQUk7QUFHZCxVQUFJLGFBQWEsU0FBUyxHQUFHO0FBQ3pCLDhCQUFzQjtBQUFBLEVBQUssS0FBSyxTQUFTO0FBQUEsSUFDckMsYUFBYSxJQUFJLFNBQU8sT0FBTyxLQUFLLEVBQUUsS0FBSyxJQUFJO0FBQUEsTUFDdkQ7QUFFQSxtQkFBYTtBQUFBLEVBQVE7QUFBQSxLQUEwQjtBQUFBLElBQ25ELE9BQU87QUFFSCxVQUFJLGFBQWEsU0FBUyxHQUFHO0FBQ3pCLHFCQUFhO0FBQUEsRUFBUSxLQUFLLFNBQVM7QUFBQSxJQUMvQixhQUFhLElBQUksU0FBTyxPQUFPLEtBQUssRUFBRSxLQUFLLElBQUksSUFDL0M7QUFBQTtBQUFBO0FBQUEsRUFBWTtBQUFBLE1BQ3BCLE9BQU87QUFFSDtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBRUEsVUFBTSxLQUFLLElBQUksTUFBTSxPQUFPLE1BQU0sVUFBVTtBQUFBLEVBQ2hEO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAianNDb2RlIiwgInRleHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJydWxlIiwgImNtRWRpdG9yIiwgImpzQ29kZSIsICJfYSJdCn0K
