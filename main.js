/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/settings.ts
var import_obsidian4 = require("obsidian");

// src/frontmatter-tools.ts
var import_obsidian = require("obsidian");
function getPropertiesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get properties:", metadataManager);
    return Object.values(metadataManager.properties).map((value) => ({
      name: value.name,
      type: value.type,
      count: value.count,
      source: "registered"
    })).sort((a, b) => a.name.localeCompare(b.name));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
function getTypesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get types:", metadataManager);
    return Object.values(metadataManager.registeredTypeWidgets).map((value, index, array) => ({
      type: value.type,
      icon: value.icon,
      jsType: ""
    })).sort((a, b) => a.type.localeCompare(b.type));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
var SelectProperty = class extends import_obsidian.SuggestModal {
  constructor(app, knownProperties, property, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
    this.property = property;
    this.typedText = "";
    this.newTextFlag = true;
    this.knownProperties = knownProperties;
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    const result = this.knownProperties.filter((property) => property.name.toLowerCase().includes(query.toLowerCase()));
    this.newTextFlag = result.length === 0;
    this.typedText = query;
    return result;
  }
  onOpen() {
    if (this.property) {
      this.setPlaceholder(this.property.name);
    } else {
      this.setPlaceholder("no property selected!");
    }
    this.setTitle("Select or type a property name");
  }
  // Renders each suggestion item.
  renderSuggestion(property, el) {
    el.createEl("div", { text: property.name });
    el.createEl("small", { text: property.type });
  }
  onClose() {
    if (this.newTextFlag && this.property) {
      this.property.name = this.typedText;
      this.property.type = "text";
      this.onSubmit(this.property);
    }
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(property, evt) {
    if (evt instanceof KeyboardEvent) {
      console.log(`keyboard ${this.typedText} ${this.newTextFlag}`, property);
    }
    console.log("onChooseSuggestion", evt);
    this.onSubmit(property);
  }
};

// src/tools.ts
function parseJSCode(jsCode) {
  function parseFunction(jsCode2) {
    try {
      jsCode2 = cleanCodeString(jsCode2);
      var funcReg = /function *\(([^()]*)\)[ \n\t]*{(.*)}/gmi;
      var match = funcReg.exec(jsCode2.replace(/\n/g, " "));
      if (!match)
        return void 0;
      var args = match[1].split(",");
      args.push(match[2]);
      return new Function(...args);
    } catch (error) {
      console.error("error parsing JS function!", error);
      return error.message;
    }
  }
  ;
  return parseFunction(jsCode);
}
function cleanCodeString(codeString) {
  if (typeof codeString !== "string") {
    throw new TypeError("Input must be a string.");
  }
  let inMultiLineComment = false;
  let inSingleLineComment = false;
  let inString = null;
  let inRegExp = false;
  let cleanedCode = "";
  let i = 0;
  while (i < codeString.length) {
    const char = codeString[i];
    const nextChar = codeString[i + 1];
    if (inMultiLineComment) {
      if (char === "*" && nextChar === "/") {
        inMultiLineComment = false;
        i += 2;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inSingleLineComment) {
      if (char === "\n" || char === "\r") {
        inSingleLineComment = false;
        cleanedCode += char;
        i++;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inString) {
      if (char === inString) {
        inString = null;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (inRegExp) {
      if (char === "/") {
        inRegExp = false;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/" && nextChar === "*") {
      inMultiLineComment = true;
      i += 2;
      continue;
    }
    if (char === "/" && nextChar === "/") {
      inSingleLineComment = true;
      i += 2;
      continue;
    }
    if (char === '"' || char === "'") {
      inString = char;
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/") {
      const prevMeaningfulChar = cleanedCode.trim().slice(-1);
      if (prevMeaningfulChar === "" || ["(", ",", "=", ":", "[", "!", "&", "|", "?", "{", ";", "\n", "\r"].includes(prevMeaningfulChar)) {
        inRegExp = true;
        cleanedCode += char;
        i++;
        continue;
      }
    }
    cleanedCode += char;
    i++;
  }
  return cleanedCode;
}
var ScriptingTools = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Check if a string complies with ISO Standard
   * 
   * @param str Any string
   * @param options Options to look for
   * @returns 
   */
  isISOString(str, options = {}) {
    const {
      withMilliseconds = false,
      withTimezone = false,
      withTime = true,
      withDate = true
    } = options;
    let dateRegexStr = "^(?:\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01]))";
    let timeRegexStr = "(?:T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
    if (withMilliseconds) {
      timeRegexStr += "\\.\\d{3}";
    }
    if (withTimezone) {
      timeRegexStr += "(?:Z|[+-](?:[01]\\d|2[0-3]):[0-5]\\d)?)?";
    } else {
      timeRegexStr += ")?";
    }
    let regexStr = "";
    if (withDate && withTime) {
      regexStr = `${dateRegexStr}${timeRegexStr}$`;
    } else if (withDate) {
      regexStr = `${dateRegexStr}$`;
    } else if (withTime) {
      regexStr = `^${timeRegexStr.slice(4)}$`;
    } else {
      return false;
    }
    const regex = new RegExp(regexStr);
    return regex.test(str);
  }
  /**
   * Try to convert Any Types to a specific Type
   * @param input 
   * @param typeString 'string' | 'number' | 'boolean' | 'string[]'
   * @returns 
   */
  tryConvert(input, typeString) {
    switch (typeString) {
      case "string":
        if (typeof input === "string") {
          return input;
        }
        return void 0;
      case "number":
        const num = Number(input);
        if (!isNaN(num)) {
          return num;
        }
        return void 0;
      case "boolean":
        if (typeof input === "boolean") {
          return input;
        }
        if (typeof input === "string") {
          const lowerValue = input.toLowerCase();
          if (lowerValue === "true") {
            return true;
          }
          if (lowerValue === "false") {
            return false;
          }
        }
        if (typeof input === "number") {
          if (input === 1) {
            return true;
          }
          if (input === 0) {
            return false;
          }
        }
        return void 0;
      case "string[]":
        if (Array.isArray(input) && input.every((item) => typeof item === "string")) {
          return input;
        }
        return void 0;
      default:
        return void 0;
    }
  }
  formatToYAMLSaveString(text, replaceBy = void 0) {
    let replaceString = "-";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.specialCharReplacement || "-";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, replaceString);
  }
  /**
   * Converts a string to a YAML-safe format by adding quotes when necessary.
   * @param input The string, boolean, number or array to make YAML-safe
   * @returns The safely quoted string when needed, or the original string if safe
   */
  toYamlSafeString(input) {
    if (Array.isArray(input)) {
      input.forEach((item, index) => {
        input[index] = this.toYamlSafeString(item).toString();
      });
      return input;
    }
    switch (typeof input) {
      case "number":
        return input;
      case "boolean":
        return input ? "true" : "false";
      case "string":
        const trimmed = input.trim();
        if (trimmed === "")
          return '""';
        const needsQuotes = /[:{}\[\],&*#?|<>=!%@`"'\\]|^[-?\n]|[\s\n]|^[yYnN]|^[0-9]|^[+-]|^(true|false|yes|no|on|off)$/i.test(trimmed);
        const isAlreadyQuoted = trimmed.startsWith('"') && trimmed.endsWith('"') || trimmed.startsWith("'") && trimmed.endsWith("'");
        if (!needsQuotes && !isAlreadyQuoted) {
          return trimmed;
        }
        if (!isAlreadyQuoted) {
          return `"${trimmed.replace(/"/g, '\\"')}"`;
        }
        return trimmed;
      default:
        console.error(`toYamlSafeString(${input}) if of type '${typeof input}'`);
        return input;
    }
  }
  replaceSpaces(text, replaceBy = void 0) {
    let replaceString = "_";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.spaceReplacement || "_";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/\s+/g, replaceString);
  }
  formatCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      if (index > 0)
        newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  formatUpperCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  /**
   * get the path to a file from a string containing the full parh/name string
   * @param path string
   * @param separator string defaults to '/'
   * @returns string
   */
  getFoldersFromPath(path, separator = "/") {
    if (path === null)
      return null;
    if (path === void 0)
      return void 0;
    const currentPathParts = path.split("/");
    currentPathParts.pop();
    return currentPathParts.join(separator);
  }
};

// src/rules.ts
var ruleFunctions = [];
function getRuleFunctionById(id) {
  return ruleFunctions.find((rule) => rule.id === id);
}
ruleFunctions.push({
  id: "default",
  description: "Pass parameter",
  source: "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let result = "";
    return result;
  }
});
ruleFunctions.push({
  id: "fullPath",
  description: "Full path and filename",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const result = file.path;\n  return result;\n}",
  fx: function(app, file, tools) {
    return `${file.path}`;
  }
});
ruleFunctions.push({
  id: "aliasFromPath",
  description: "An Alias from every folder of the file Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  let pathArray = file.path.split('/');\n  pathArray.pop(); // remove File name with extension\n  pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir)); // convert to UpperCamelCase\n  const fileNameParts = file.name.split('.');\n  if (fileNameParts.length > 1) {\n    fileNameParts.pop(); // remove Extension\n  }\n  const fileName = fileNameParts.join('.'); // rebuild file Name\n  pathArray.push(tools.formatUpperCamelCase(fileName)); // add file name without extension and in UpperCamelCase\n  const result = pathArray.join('.') || '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let pathArray = file.path.split("/");
    pathArray.pop();
    pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir));
    const fileNameParts = file.name.split(".");
    if (fileNameParts.length > 1) {
      fileNameParts.pop();
    }
    const fileName = fileNameParts.join(".");
    pathArray.push(tools.formatUpperCamelCase(fileName));
    const result = pathArray.join(".") || "";
    return result;
  }
});
ruleFunctions.push({
  id: "path",
  description: "Full Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "folder",
  description: "Foldername",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[parts.length-2];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[parts.length - 2];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "folders",
  description: "All folders of the file as a list",
  source: "function (app, file, tools) { // do not change this line!\n  const path = file.path; // acquire file path\n  const result = path.split('/');\n  result.pop(); // remove file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const result = path.split("/");
    result.pop();
    return result;
  }
});
ruleFunctions.push({
  id: "rootFolder",
  description: "Root folder",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[0];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[0];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "name",
  description: "File name",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name.split('.');\n  result.pop(); // remove extension\n  result.join('.'); // reconstruct the file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name.split(".");
    result.pop();
    result.join(".");
    return result;
  }
});
ruleFunctions.push({
  id: "nameExt",
  description: "File name with extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name;\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name;
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeCreated",
  description: "Date (and Time) created",
  // TODO Check time zones. 
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file created\n  const dateTime = new Date(file.stat.ctime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.ctime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeModified",
  description: "Date (and Time) modified",
  //FIXME keep Date and time untouched when editing frontmatter properties
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file modified\n  const dateTime = new Date(file.stat.mtime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.mtime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeBytes",
  description: "File size in bytes",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  const result = file.stat.size;\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const result = file.stat.size;
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeString",
  description: "File size formatted as text",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  let size =file.stat.size;\n  const precision = 2; // number of decimal places\n  if (size > 1024) {\n    size = size / 1024;\n    if (size > 1024) {\n      size = size / 1024;\n      if (size > 1024) {\n        size = size / 1024;\n        return Number.parseFloat(size).toFixed(precision) + ' GB';\n      } \n      return Number.parseFloat(size).toFixed(precision) + ' MB';\n    }\n    return Number.parseFloat(size).toFixed(precision) + ' KB';\n  }   \n  return size + ' Bytes'; // return you result.\n}",
  fx: function(app, file, tools) {
    let size = file.stat.size;
    const precision = 2;
    if (size > 1024) {
      size = size / 1024;
      if (size > 1024) {
        size = size / 1024;
        if (size > 1024) {
          size = size / 1024;
          return size.toFixed(precision) + " GB";
        }
        return size.toFixed(precision) + " MB";
      }
      return size.toFixed(precision) + " KB";
    }
    return size + " Bytes";
  }
});

// src/types.ts
var DEFAULT_SETTINGS = {
  tagPrefix: "",
  excludeRootFolder: false,
  tagsPropertyName: "tags",
  spaceReplacement: "_",
  specialCharReplacement: "_",
  lowercaseTags: false,
  knownProperties: [],
  rules: [],
  useTextArea: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folder"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folder"
  },
  configuredProperties: []
};
var DEFAULT_RULE_DEFINITION = {
  id: "",
  active: true,
  property: "",
  customProperty: "",
  type: "string",
  typeProperty: { name: "", type: "", source: "registered" },
  content: "",
  buildInCode: "",
  jsCode: "",
  showContent: false
};

// src/alertBox.ts
var import_obsidian2 = require("obsidian");
var AlertModal = class extends import_obsidian2.Modal {
  constructor(app, title, description, btn1, btn2) {
    super(app);
    this.title = title;
    this.description = description;
    this.btn1Text = btn1;
    this.btn2Text = btn2;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: this.title });
    contentEl.createEl("p", { text: this.description });
    new import_obsidian2.Setting(contentEl).addButton((btn) => {
      btn.setButtonText(this.btn1Text).setCta().onClick(() => {
        this.close();
        this.resolvePromise(true);
      });
    }).addButton((btn) => {
      btn.setButtonText(this.btn2Text).onClick(() => {
        this.close();
        this.resolvePromise(false);
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  async openAndGetValue() {
    this.open();
    return this.promise;
  }
};

// src/directorySelectionModal.ts
var import_obsidian3 = require("obsidian");
var DirectorySelectionModal = class extends import_obsidian3.Modal {
  // Reference to update dropdown on reset
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param initialFolders - Array of initially selected folder paths.
   * @param initialFiles - Array of initially selected file paths.
   * @param initialMode - The initial selection mode ('include' or 'exclude').
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
    super(app);
    this.showFiles = false;
    // Container for the tree view
    this.treeNodes = /* @__PURE__ */ new Map();
    // Map path to node info for quick access
    this.modeDropdown = null;
    this.initialFoldersSnapshot = new Set(initialFolders);
    this.initialFilesSnapshot = new Set(initialFiles);
    this.initialModeSnapshot = initialMode;
    this.initialDisplaySnapshot = initialDisplay;
    this.showFiles = initialDisplay === "files" || initialFiles.length > 0;
    this.includeExcludeSelectable = includeExcludeSelectable;
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    this.currentFolders = new Set(this.initialFoldersSnapshot);
    this.currentFiles = new Set(this.initialFilesSnapshot);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    this.currentFolders = /* @__PURE__ */ new Set([]);
    this.currentFiles = /* @__PURE__ */ new Set([]);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("directory-selection-modal");
    if (this.includeExcludeSelectable) {
      contentEl.createEl("h2", { text: "Include or Exclude Folders and Files" });
    } else {
      contentEl.createEl("h2", { text: `${this.currentMode === "exclude" ? "Exclude" : "Include"} Folders and Files` });
    }
    const controlsEl = contentEl.createDiv({ cls: "modal-controls" });
    this.createModeSetting(controlsEl);
    this.createShowFilesSetting(controlsEl);
    this.treeRootElement = contentEl.createDiv({ cls: "tree-view-container" });
    this.treeRootElement.style.maxHeight = "600px";
    this.treeRootElement.style.overflowY = "auto";
    this.treeRootElement.style.border = "1px solid var(--background-modifier-border)";
    this.treeRootElement.style.padding = "10px";
    this.treeRootElement.style.marginTop = "10px";
    this.treeRootElement.style.marginBottom = "10px";
    this.buildAndRenderTree();
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the dropdown setting for choosing the selection mode.
   * @param containerEl - The HTML element to append the setting to.
   */
  createModeSetting(containerEl) {
    if (this.includeExcludeSelectable) {
      this.modeDropdown = new import_obsidian3.Setting(containerEl).setName("Selection Mode").setDesc("Choose if the selected files and folders should be excluded or included.").addDropdown((dropdown) => {
        dropdown.addOption("exclude", "exclude").addOption("include", "include").setValue(this.currentMode).onChange((value) => {
          this.currentMode = value;
          this.updateTreeAppearance();
        });
      });
    }
  }
  /**
   * Updates the mode dropdown UI element to reflect the currentMode state.
   */
  updateModeDropdown() {
    var _a;
    const dropdownComponent = (_a = this.modeDropdown) == null ? void 0 : _a.components[0];
    if (dropdownComponent && typeof dropdownComponent.setValue === "function") {
      dropdownComponent.setValue(this.currentMode);
    }
  }
  /**
   * Creates the toggle setting for showing/hiding files in the tree.
   * @param containerEl - The HTML element to append the setting to.
   */
  createShowFilesSetting(containerEl) {
    new import_obsidian3.Setting(containerEl).setName("Show Files").setDesc("Show Files within the directory tree.").addToggle((toggle) => {
      toggle.setValue(this.showFiles).onChange((value) => {
        this.showFiles = value;
        this.buildAndRenderTree();
      });
    });
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      console.log("Cancel Clicked - Returning");
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Builds the logical tree structure data from the vault's files and folders.
   * @returns The root node of the tree structure.
   */
  buildTreeData() {
    const vaultRootNode = {
      path: "/",
      name: this.app.vault.getName() || "Vault",
      // Use vault name or default
      type: "folder",
      children: [],
      // Placeholder elements, will be assigned during rendering if root is rendered
      element: null,
      checkbox: null,
      label: null,
      container: null
    };
    const folderNodes = /* @__PURE__ */ new Map();
    folderNodes.set("/", vaultRootNode);
    const allFiles = this.app.vault.getFiles();
    allFiles.forEach((file) => {
      const parentFolder = file.parent;
      if (!parentFolder)
        return;
      let currentPath = "";
      const pathParts = parentFolder.path.split("/").filter((p) => p.length > 0);
      let parentNode = vaultRootNode;
      pathParts.forEach((part) => {
        currentPath = currentPath === "/" ? part : `${currentPath}/${part}`;
        if (!folderNodes.has(currentPath)) {
          const newFolderNode = {
            path: currentPath,
            name: part,
            type: "folder",
            children: [],
            // Placeholders, assigned during rendering
            element: null,
            checkbox: null,
            label: null,
            container: null
          };
          folderNodes.set(currentPath, newFolderNode);
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(newFolderNode);
          parentNode = newFolderNode;
        } else {
          parentNode = folderNodes.get(currentPath);
        }
      });
    });
    if (this.showFiles) {
      allFiles.forEach((file) => {
        const parentFolder = file.parent;
        if (!parentFolder) {
          return;
        }
        const parentPath = "/" + parentFolder.path;
        const parentNode = folderNodes.get(parentPath);
        const fileNode = {
          path: file.path,
          name: file.name,
          type: "file",
          // Files don't have children
          // Placeholders, assigned during rendering
          element: null,
          checkbox: null,
          label: null,
          container: null
        };
        if (parentNode) {
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(fileNode);
        } else {
        }
      });
    }
    const sortNodes = (a, b) => {
      if (a.type === "folder" && b.type === "file")
        return -1;
      if (a.type === "file" && b.type === "folder")
        return 1;
      return a.name.localeCompare(b.name);
    };
    folderNodes.forEach((node) => {
      var _a;
      return (_a = node.children) == null ? void 0 : _a.sort(sortNodes);
    });
    return vaultRootNode;
  }
  /**
   * Renders the entire tree structure in the DOM based on the tree data.
   */
  renderTree() {
    var _a;
    this.treeRootElement.empty();
    this.treeNodes.clear();
    const treeData = this.buildTreeData();
    const rootUl = this.treeRootElement.createEl("ul");
    rootUl.addClass("tree-root-ul");
    rootUl.style.listStyle = "none";
    rootUl.style.paddingLeft = "0";
    (_a = treeData.children) == null ? void 0 : _a.forEach((childNode) => {
      this.renderTreeNode(childNode, rootUl, 0);
    });
  }
  /**
   * Recursively renders a single tree node and its children in the DOM.
   * @param node - The TreeNode data to render.
   * @param parentElement - The HTML `ul` element to append this node's `li` to.
   * @param level - The current indentation level.
   */
  renderTreeNode(node, parentElement, level) {
    const li = parentElement.createEl("li");
    li.style.marginLeft = `${level * 20}px`;
    li.addClass(`tree-node-${node.type}`);
    const container = li.createDiv({ cls: "tree-node-container" });
    container.style.display = "flex";
    container.style.alignItems = "center";
    container.style.padding = "2px 0";
    const checkbox = container.createEl("input", { type: "checkbox" });
    checkbox.id = `tree-cb-${node.path.replace(/[^a-zA-Z0-9]/g, "-")}`;
    checkbox.dataset.path = node.path;
    checkbox.dataset.type = node.type;
    const label = container.createEl("label");
    label.textContent = `${node.type === "folder" ? "\u{1F4C1}" : "\u{1F4C4}"} ${node.name}`;
    label.htmlFor = checkbox.id;
    label.style.marginLeft = "5px";
    label.style.cursor = "pointer";
    label.title = node.path;
    node.element = li;
    node.checkbox = checkbox;
    node.label = label;
    node.container = container;
    this.treeNodes.set(node.path, node);
    if (node.type === "folder") {
      checkbox.checked = this.currentFolders.has(node.path);
    } else {
      checkbox.checked = this.currentFiles.has(node.path);
    }
    checkbox.onchange = (event) => {
      const target = event.target;
      const path = target.dataset.path;
      const type = target.dataset.type;
      if (target.checked) {
        if (type === "folder")
          this.currentFolders.add(path);
        else
          this.currentFiles.add(path);
      } else {
        if (type === "folder")
          this.currentFolders.delete(path);
        else
          this.currentFiles.delete(path);
      }
      this.updateTreeAppearance();
    };
    if (node.type === "folder" && node.children && node.children.length > 0) {
      const childrenUl = li.createEl("ul");
      childrenUl.style.listStyle = "none";
      childrenUl.style.paddingLeft = "0";
      childrenUl.style.marginLeft = "0";
      node.children.forEach((child) => this.renderTreeNode(child, childrenUl, level + 1));
    }
  }
  /**
   * Updates the visual appearance (enabled/disabled/styling) of all nodes
   * in the tree based on the current mode and selections.
   */
  updateTreeAppearance() {
    this.treeNodes.forEach((node) => {
      let isDisabled = false;
      let isEffectivelyIncluded = false;
      let isEffectivelyExcluded = false;
      let ancestorFolderSelected = false;
      let currentPath = node.path;
      while (currentPath !== "/") {
        const parentPath = currentPath.substring(0, currentPath.lastIndexOf("/")) || "/";
        if (this.currentFolders.has(parentPath)) {
          ancestorFolderSelected = true;
          break;
        }
        if (parentPath === currentPath)
          break;
        currentPath = parentPath;
      }
      const nodeSelected = node.type === "folder" ? this.currentFolders.has(node.path) : this.currentFiles.has(node.path);
      if (this.currentMode === "exclude") {
        isEffectivelyExcluded = nodeSelected || ancestorFolderSelected;
        isDisabled = isEffectivelyExcluded;
      } else {
        if (node.type === "folder") {
          isEffectivelyIncluded = nodeSelected || ancestorFolderSelected;
        } else {
          const parentPath = node.path.substring(0, node.path.lastIndexOf("/")) || "/";
          const parentEffectivelyIncluded = this.isPathEffectivelyIncluded(parentPath);
          isEffectivelyIncluded = nodeSelected || parentEffectivelyIncluded;
        }
        isDisabled = !isEffectivelyIncluded;
      }
      node.checkbox.disabled = false;
      if (isDisabled) {
        node.container.style.opacity = "0.5";
        node.label.style.textDecoration = "line-through";
        node.element.addClass("is-disabled");
      } else {
        node.container.style.opacity = "1";
        node.label.style.textDecoration = "none";
        node.element.removeClass("is-disabled");
      }
      node.element.classList.remove("is-included", "is-excluded");
      if (this.currentMode === "include" && isEffectivelyIncluded) {
        node.element.addClass("is-included");
      } else if (this.currentMode === "exclude" && isEffectivelyExcluded) {
        node.element.addClass("is-excluded");
      }
    });
  }
  /**
   * Helper function to determine if a given path is effectively included
   * in the current selection under 'include' mode.
   * A path is included if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
   * @param path - The folder or file path to check.
   * @returns True if the path should be considered included, false otherwise.
   */
  isPathEffectivelyIncluded(path) {
    if (this.currentMode !== "include") {
      return !this.isPathEffectivelyExcluded(path);
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
  * Helper function to determine if a given path is effectively excluded
  * in the current selection under 'exclude' mode.
  * A path is excluded if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
  * @param path - The folder or file path to check.
  * @returns True if the path should be considered excluded, false otherwise.
  */
  isPathEffectivelyExcluded(path) {
    if (this.currentMode !== "exclude") {
      return false;
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
   * Combines building the tree data, rendering the DOM, and applying initial appearance.
   */
  buildAndRenderTree() {
    this.renderTree();
    this.updateTreeAppearance();
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      folders: Array.from(this.currentFolders),
      files: Array.from(this.currentFiles),
      mode: this.currentMode,
      display: this.currentDisplay
    };
    console.log("OK Clicked - Returning Result:", result);
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
    this.treeNodes.clear();
    this.modeDropdown = null;
  }
};
function openDirectorySelectionModal(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
  new DirectorySelectionModal(
    app,
    initialFolders,
    initialFiles,
    initialMode,
    initialDisplay,
    includeExcludeSelectable,
    okCallback
  ).open();
}

// src/settings.ts
var import_crypto = require("crypto");
var FolderTagSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(this.plugin.settings);
  }
  display() {
    this.knownProperties = getPropertiesFromMetadataManager(this.app);
    this.knownTypes = getTypesFromMetadataManager(this.app);
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Folder Path Tag Settings" });
    new import_obsidian4.Setting(containerEl).setName("Tag prefix").setDesc("Optional prefix to add before folder path tags").addText((text) => text.setPlaceholder("prefix/").setValue(this.plugin.settings.tagPrefix).onChange(async (value) => {
      this.plugin.settings.tagPrefix = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude root folder").setDesc("If enabled, the root folder name will be excluded from the tag").addToggle((toggle) => toggle.setValue(this.plugin.settings.excludeRootFolder).onChange(async (value) => {
      this.plugin.settings.excludeRootFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Tags property name").setDesc('Frontmatter property name to store tags (default: "tags")').addText((text) => text.setPlaceholder("tags").setValue(this.plugin.settings.tagsPropertyName).onChange(async (value) => {
      this.plugin.settings.tagsPropertyName = value || "tags";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Space replacement").setDesc('Character to replace spaces in folder names (default: "_")').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.spaceReplacement).onChange(async (value) => {
      this.plugin.settings.spaceReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Special character replacement").setDesc('Character to replace special characters (default: "_") - preserves letters with diacritics').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.specialCharReplacement).onChange(async (value) => {
      this.plugin.settings.specialCharReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Convert to lowercase").setDesc("Convert all tags to lowercase").addToggle((toggle) => toggle.setValue(this.plugin.settings.lowercaseTags).onChange(async (value) => {
      this.plugin.settings.lowercaseTags = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude Files and Folders").setDesc(`Currently ${this.plugin.settings.exclude.selectedFolders.length} folders and ${this.plugin.settings.exclude.selectedFiles.length} files will be ${this.plugin.settings.exclude.mode}d.`).addButton((button) => {
      button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.exclude.selectedFolders || [],
          this.plugin.settings.exclude.selectedFiles || [],
          this.plugin.settings.exclude.mode || "exclude",
          this.plugin.settings.exclude.display || "folders",
          false,
          // include, exclude option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.exclude.selectedFolders = result.folders;
            this.plugin.settings.exclude.selectedFiles = result.files;
            this.plugin.settings.exclude.mode = result.mode;
            this.plugin.settings.exclude.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Include Files and Folders").setDesc(`Currently ${this.plugin.settings.include.selectedFolders.length} folders and ${this.plugin.settings.include.selectedFiles.length} files will be ${this.plugin.settings.include.mode}d even when in excluded Folders.`).addButton((button) => {
      button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.include.selectedFolders || [],
          this.plugin.settings.include.selectedFiles || [],
          this.plugin.settings.include.mode || "include",
          this.plugin.settings.include.display || "folders",
          false,
          // include, include option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.include.selectedFolders = result.folders;
            this.plugin.settings.include.selectedFiles = result.files;
            this.plugin.settings.include.mode = result.mode;
            this.plugin.settings.include.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Rules").setDesc("add rules to update selected parameters");
    this.rulesDiv = containerEl.createDiv({ cls: "obsidian-f2t-rule-area" });
    this.rulesControl = containerEl.createDiv({ cls: "obsidian-f2t-rule-controls" });
    this.plugin.settings.rules.forEach((rule) => {
      this.addRule(this.rulesDiv, rule.id);
    });
    new import_obsidian4.Setting(this.rulesControl).addButton(async (button) => {
      button.setIcon("square-plus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("add a rule");
      button.onClick(async () => {
        this.addRule(this.rulesDiv);
      });
    });
  }
  addRule(divEl, ruleUUID = "") {
    var _a;
    let cmEditor = null;
    if (ruleUUID === "") {
      ruleUUID = (0, import_crypto.randomUUID)().toString();
      this.plugin.settings.rules.push(Object.assign({}, DEFAULT_RULE_DEFINITION, {
        id: ruleUUID
      }));
    }
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleUUID);
    if (!rule)
      return;
    let propertyNameInput;
    let showFunctionButton;
    let propertyTypeDropdown;
    let propertyDevDropdown;
    let functionResultTextComponent;
    let functionTestButton;
    const rulesDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleLine" });
    rulesDiv.setAttribute("id", ruleUUID);
    const ruleOptionsDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleOptions" });
    ruleOptionsDiv.style.height = "350px;";
    ruleOptionsDiv.style.alignItems = "flex-end";
    if (this.plugin.settings.useTextArea) {
      const ruleOptionsSettings = new import_obsidian4.Setting(ruleOptionsDiv).addTextArea((textArea) => {
        textArea.setPlaceholder("ender valid JS Code");
        textArea.inputEl.setAttribute("style", `height:190px; width:80%;`);
        textArea.onChange(async (value) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
          rule.jsCode = value;
          await this.plugin.saveSettings();
        });
      });
    } else {
      let jsCode = rule.jsCode;
      if (rule.content !== "script") {
        if (rule.buildInCode === "") {
          rule.buildInCode = ((_a = getRuleFunctionById(rule.content)) == null ? void 0 : _a.source) || ruleFunctions[0].source;
        }
        jsCode = rule.buildInCode;
      }
      cmEditor = window.CodeMirror(ruleOptionsDiv, {
        value: jsCode || "function (app, file, tools) { // do not change this line!\n\n  return result; // return you result.\n}",
        mode: "javascript",
        lineNumbers: true,
        // theme: "obsidian",
        indentUnit: 2,
        lineWrapping: false,
        readOnly: false
      });
      if (cmEditor) {
        cmEditor.on("change", (cmEditor2) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
        });
        cmEditor.on("blur", (cmEditor2) => {
          if (rule.content === "script") {
            rule.jsCode = cmEditor2.getValue();
          } else {
            rule.buildInCode = cmEditor2.getValue();
          }
          this.plugin.saveSettings();
        });
      }
      ;
      new import_obsidian4.Setting(ruleOptionsDiv).addButton((button) => {
        functionTestButton = button;
        button.setWarning().setButtonText("Save & Test").onClick(async () => {
          if (cmEditor) {
            let jsCode2 = "";
            if (rule.content === "script") {
              rule.jsCode = cmEditor.getValue();
              jsCode2 = rule.jsCode;
            } else {
              rule.buildInCode = cmEditor.getValue();
              jsCode2 = rule.buildInCode;
            }
            await this.plugin.saveSettings();
            let userFunction = parseJSCode(jsCode2);
            if (typeof userFunction === "string") {
              let errorHint = "See console for details!";
              if (userFunction.contains("Unexpected token")) {
                errorHint = "Did you missed a semicolon (;)?";
              }
              if (functionResultTextComponent)
                functionResultTextComponent.setValue(`Syntax error: ${userFunction}! ${errorHint}`);
            } else {
              if (userFunction) {
                try {
                  const files = this.app.vault.getMarkdownFiles();
                  const result = userFunction(this.app, files[8], this.scriptingTools);
                  if (functionResultTextComponent)
                    functionResultTextComponent.setValue(result.toString());
                  button.buttonEl.removeClass("mod-warning");
                } catch (e) {
                  if (functionResultTextComponent) {
                    functionResultTextComponent.setValue(`Syntax error: ${e.message}! See console for details!`);
                  }
                  console.error("Syntax error. ", e, jsCode2, userFunction);
                }
              } else {
                console.error("syntax error");
              }
            }
          }
        });
      }).addText((text) => {
        functionResultTextComponent = text;
        text.setPlaceholder("function result").setDisabled(true);
        functionResultTextComponent.inputEl.style.width = "600px";
      });
    }
    function showJsFunctionButton(ruleId) {
      var _a2;
      const showCodeButton = ((_a2 = getRuleFunctionById(ruleId)) == null ? void 0 : _a2.source) !== "" || ruleId === "script";
      if (showCodeButton) {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "block";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "360px";
      } else {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "none";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "400px";
      }
    }
    const ruleSettings = new import_obsidian4.Setting(rulesDiv).addButton((button) => {
      button.buttonEl.setAttribute("style", "width:150px; justify-content: left; ");
      button.setButtonText(rule.property || "Select Parameter");
      button.onClick(() => {
        new SelectProperty(this.app, this.knownProperties, rule.typeProperty, (result) => {
          if (result.name !== "") {
            rule.typeProperty = result;
            rule.property = result.name;
            rule.type = result.type;
            if (this.knownProperties.filter((property) => property.name.toLowerCase().includes(rule.property.toLowerCase())).length === 0) {
            }
            ;
            button.setButtonText(result.name);
            this.plugin.saveSettings();
          }
          propertyTypeDropdown.setValue(result.type);
        }).open();
      });
    }).addDropdown((dropdown) => {
      propertyTypeDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:110px");
      dropdown.addOption("", "Select a type");
      dropdown.addOption("aliases", "Aliases");
      dropdown.addOption("checkbox", "Checkbox");
      dropdown.addOption("date", "Date");
      dropdown.addOption("datetime", "Date & Time");
      dropdown.addOption("multitext", "List");
      dropdown.addOption("number", "Number");
      dropdown.addOption("tags", "Tags");
      dropdown.addOption("text", "Text");
      if (rule.type)
        dropdown.setValue(rule.type);
      dropdown.onChange(async (value) => {
        if (value !== "") {
          rule.type = value;
          await this.plugin.saveSettings();
        }
      });
    }).addDropdown((dropdown) => {
      propertyDevDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:400px");
      dropdown.addOption("", "Select a content");
      for (let rule2 of ruleFunctions) {
        dropdown.addOption(rule2.id, rule2.description);
      }
      dropdown.addOption("script", "JavaScript script");
      dropdown.setValue(rule.content);
      dropdown.onChange(async (value) => {
        var _a2, _b, _c;
        let jsCode = "";
        if (value !== "") {
          if (value !== "script") {
            let oldOriginalCode = ((_a2 = getRuleFunctionById(rule.content)) == null ? void 0 : _a2.source) || ruleFunctions[0].source;
            if (rule.buildInCode !== "" && rule.buildInCode !== oldOriginalCode) {
              const shouldProceed = await new AlertModal(
                this.app,
                "Overwrite existing code?",
                "I sees like you have custom code for this rule! Should this be overwritten by default code for this parameter?",
                "Yes",
                "No"
              ).openAndGetValue();
              if (shouldProceed) {
                jsCode = rule.buildInCode = ((_b = getRuleFunctionById(value)) == null ? void 0 : _b.source) || ruleFunctions[0].source;
              } else {
                jsCode = rule.buildInCode;
              }
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            } else {
              jsCode = rule.buildInCode = ((_c = getRuleFunctionById(value)) == null ? void 0 : _c.source) || ruleFunctions[0].source;
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            }
          } else {
            cmEditor == null ? void 0 : cmEditor.setValue(rule.jsCode !== "" ? rule.jsCode : ruleFunctions[0].source);
          }
          rule.content = value;
          showJsFunctionButton(rule.content);
          await this.plugin.saveSettings();
        }
      });
      ruleOptionsDiv.style.display = `${rule.content === "script" && rule.showContent ? "flex" : "none"}`;
    }).addButton(async (button) => {
      showFunctionButton = button;
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-function");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("show & edit code");
      button.onClick(async () => {
        rule.showContent = !rule.showContent;
        ruleOptionsDiv.style.display = `${rule.showContent ? "flex" : "none"}`;
      });
      showFunctionButton.buttonEl.style.display = "none";
    }).addButton(async (button) => {
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-minus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("remove this rule");
      button.onClick(async () => {
        this.plugin.settings.rules.splice(this.plugin.settings.rules.findIndex((value) => value.id === ruleUUID));
        this.removeRule(rulesDiv);
        await this.plugin.saveSettings();
      });
    });
    showJsFunctionButton(rule.content);
    divEl.style.removeProperty("border-top");
  }
  removeRule(rulesDiv) {
    rulesDiv.remove();
  }
};

// main.ts
var FolderTagPlugin = class extends import_obsidian5.Plugin {
  //private oldFolderPaths = new Map<string, string | null>();
  async onload() {
    await this.loadSettings();
    this.tools = new ScriptingTools(this.settings);
    let noticeMessage = "Property Updater Tools\n loading ...";
    const loadingNotice = new import_obsidian5.Notice(noticeMessage, 0);
    noticeMessage = noticeMessage + "\n register events ...";
    loadingNotice.setMessage(noticeMessage);
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules, oldPath);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian5.MarkdownView) {
          const previousFile = this.app.workspace.getActiveFile();
          console.log(`closing file: `, previousFile == null ? void 0 : previousFile.path);
          if (previousFile)
            this.updateFrontmatterParameters(previousFile, this.settings.rules);
        }
      })
    );
    noticeMessage = noticeMessage + "\n initial processing ...";
    loadingNotice.setMessage(noticeMessage);
    this.app.vault.getMarkdownFiles().forEach((file) => {
    });
    noticeMessage = noticeMessage + "\ndone!";
    loadingNotice.setMessage(noticeMessage);
    setTimeout(() => {
      loadingNotice.hide();
    }, 2e3);
    this.addSettingTab(new FolderTagSettingTab(this.app, this));
  }
  async loadSettings() {
    let data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  formatTagName(name) {
    if (name === null)
      return null;
    if (name === void 0)
      return void 0;
    let formatted = name.replace(/\s+/g, this.settings.spaceReplacement);
    formatted = formatted.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, this.settings.specialCharReplacement);
    if (this.settings.lowercaseTags) {
      formatted = formatted.toLowerCase();
    }
    return formatted;
  }
  async updateFileTag(file, oldTagPath) {
    const newTagPath = this.getFolderPathForTag(file);
    const formattedNewPath = newTagPath ? this.formatTagName(newTagPath) : null;
    const newTag = formattedNewPath ? this.settings.tagPrefix + formattedNewPath : null;
    let oldTagToRemove;
    if (oldTagPath) {
      const formattedOldPath = this.formatTagName(oldTagPath);
      if (formattedOldPath) {
        oldTagToRemove = this.settings.tagPrefix + formattedOldPath;
      }
    }
    await this.updateFrontmatterTags(file, newTag, oldTagToRemove);
  }
  getFolderPathForTag(file) {
    const folder = file.parent;
    if (!folder || folder === this.app.vault.getRoot()) {
      return null;
    }
    let pathParts = [];
    let currentFolder = folder;
    while (currentFolder && currentFolder !== this.app.vault.getRoot()) {
      pathParts.unshift(currentFolder.name);
      currentFolder = currentFolder.parent;
    }
    if (this.settings.excludeRootFolder && pathParts.length > 0) {
      pathParts = pathParts.slice(1);
    }
    return pathParts.length > 0 ? pathParts.join("/") : null;
  }
  /**
   * Filters a given file and returns true if it is included in a folder or file list
   * @param file 
   * @param filterMode 'exclude'|'include'
   * @param type 'folders'|'files'
   * @returns 
   */
  filterFile(file, filterMode, type) {
    let result = false;
    const filterArray = type === "folders" ? this.settings[filterMode].selectedFolders : this.settings[filterMode].selectedFiles;
    if (filterArray.length === 0)
      return filterMode === "include" ? false : true;
    const filePath = file.path;
    const fileFolder = this.tools.getFoldersFromPath(file.path);
    const fileName = file.basename + "." + file.extension;
    if (type === "files") {
      result = filterArray.includes(filePath);
    }
    if (type === "folders") {
      filterArray.forEach((path) => {
        result = (fileFolder == null ? void 0 : fileFolder.startsWith(path.slice(1))) || false;
        if (result === true)
          return;
      });
    }
    ;
    return filterMode === "exclude" ? !result : result;
  }
  checkIfFileAllowed(file) {
    let result = false;
    if (this.settings.include.selectedFiles.length > 0) {
      result = this.filterFile(file, "include", "files");
      if (result === true)
        return result;
    }
    if (this.settings.include.selectedFolders.length > 0) {
      result = this.filterFile(file, "include", "folders");
      if (result === true)
        return result;
    }
    result = true;
    if (this.settings.exclude.selectedFiles.length > 0) {
      result = this.filterFile(file, "exclude", "files");
      if (result === false)
        return result;
    }
    if (this.settings.exclude.selectedFolders.length > 0) {
      result = this.filterFile(file, "exclude", "folders");
      if (result === false)
        return result;
    }
    return result;
  }
  formatValue(value, type) {
    switch (type) {
      case "text":
      case "tags":
      case "aliases":
      case "multitext":
        return this.tools.toYamlSafeString(value);
      case "date":
      case "datetime":
        if (typeof value === "number") {
          return new Date(value).toISOString();
        }
        return value.toString();
      case "checkbox":
        return value ? "true" : "false";
      case "number":
        return Number(value);
      default:
        return this.tools.toYamlSafeString(value);
    }
  }
  async updateFrontmatterParameters(file, rules, oldPath) {
    if (!this.checkIfFileAllowed(file)) {
      console.log(`file ${file.path} rejected!`);
      return;
    }
    const currentPathTag = this.formatTagName(this.tools.getFoldersFromPath(file.path));
    const oldPathTag = this.formatTagName(this.tools.getFoldersFromPath(oldPath));
    if (oldPathTag)
      console.log(`update file: "${oldPathTag}" to "${currentPathTag}"`);
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = (cache == null ? void 0 : cache.frontmatter) || {};
    let fxResult;
    const parameterTypes = {};
    rules.forEach((rule) => {
      if (rule.content === "script") {
        const ruleFunction = parseJSCode(rule.jsCode);
        if (typeof ruleFunction !== "function")
          return;
        fxResult = ruleFunction(this.app, file, this.tools);
      } else {
        const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
        if (functionIndex !== -1) {
          fxResult = ruleFunctions[functionIndex].fx(this.app, file, this.tools);
        }
      }
      frontmatter[rule.content] = fxResult;
      parameterTypes[rule.property] = rule.type;
    });
    if (!frontmatter.hasOwnProperty("tags"))
      frontmatter.tags = [];
    if (frontmatter.tags === null)
      frontmatter.tags = [];
    if (oldPath) {
      if (frontmatter.tags.includes(oldPathTag)) {
        let index = frontmatter.tags.indexOf(oldPathTag);
        frontmatter.tags.splice(frontmatter.tags.indexOf(oldPathTag), 1, currentPathTag);
      } else {
        frontmatter.tags.push(currentPathTag);
      }
    } else {
      frontmatter.tags.push(currentPathTag);
    }
    let newFrontmatter = "---\n";
    Object.keys(frontmatter).forEach((key) => {
      if (typeof frontmatter[key] === "object") {
        if (Array.isArray(frontmatter[key])) {
          newFrontmatter += `${this.tools.toYamlSafeString(key)}:
`;
          for (let item of frontmatter[key]) {
            newFrontmatter += `  - ${this.formatValue(item, parameterTypes[key])}
`;
          }
        } else {
          console.error("Can't write objects to YAML", key, frontmatter[key]);
        }
      } else {
        newFrontmatter += `${this.tools.toYamlSafeString(key)}: ${this.formatValue(frontmatter[key], parameterTypes[key])}
`;
      }
    });
    newFrontmatter += "---\n";
    let endOfFrontmatter = content.indexOf("---\n", 3);
    content = newFrontmatter + content.slice(endOfFrontmatter + 4);
    await this.app.vault.modify(file, content);
  }
  async updateFrontmatterTags(file, newTag, oldTagToRemove) {
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    let existingTags = [];
    if (frontmatter && frontmatter[this.settings.tagsPropertyName]) {
      const tagsValue = frontmatter[this.settings.tagsPropertyName];
      if (Array.isArray(tagsValue)) {
        existingTags = tagsValue.filter((tag) => tag != null).map((tag) => String(tag));
      } else if (typeof tagsValue === "string") {
        existingTags = tagsValue.split(/,\s*/).map((tag) => tag.trim()).filter((tag) => tag.length > 0);
      }
    }
    existingTags = existingTags.filter((tag) => {
      if (tag == null)
        return false;
      if (!tag.startsWith(this.settings.tagPrefix))
        return true;
      const tagWithoutPrefix = tag.slice(this.settings.tagPrefix.length);
      return !tagWithoutPrefix.includes("/");
    });
    if (oldTagToRemove) {
      existingTags = existingTags.filter((tag) => tag !== oldTagToRemove);
    }
    if (newTag && !existingTags.includes(newTag)) {
      existingTags.push(newTag);
    }
    let newFrontmatter = {};
    if (frontmatter) {
      newFrontmatter = { ...frontmatter };
      delete newFrontmatter[this.settings.tagsPropertyName];
    }
    let newContent = "";
    if (content.startsWith("---")) {
      const frontmatterEnd = content.indexOf("---", 3) + 3;
      const bodyContent = content.slice(frontmatterEnd);
      let frontmatterContent = Object.entries(newFrontmatter).map(([key, value]) => `${key}: ${value}`).join("\n");
      if (existingTags.length > 0) {
        frontmatterContent += `
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n");
      }
      newContent = `---
${frontmatterContent}
---${bodyContent}`;
    } else {
      if (existingTags.length > 0) {
        newContent = `---
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n") + `
---

${content}`;
      } else {
        return;
      }
    }
    await this.app.vault.modify(file, newContent);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2Zyb250bWF0dGVyLXRvb2xzLnRzIiwgInNyYy90b29scy50cyIsICJzcmMvcnVsZXMudHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9hbGVydEJveC50cyIsICJzcmMvZGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgUGx1Z2luLCBNYXJrZG93blZpZXcsIFBsdWdpbk1hbmlmZXN0LCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIFRleHRDb21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBOb3RpY2V9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCAqIGFzIGZtVG9vbHMgZnJvbSAnLi9zcmMvZnJvbnRtYXR0ZXItdG9vbHMnO1xuaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbi8vaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzLXByb3BlcnRpZXMnO1xuaW1wb3J0IHsgcnVsZUZ1bmN0aW9ucyB9IGZyb20gJy4vc3JjL3J1bGVzJztcbmltcG9ydCB7IHBhcnNlSlNDb2RlLCBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vc3JjL3Rvb2xzJztcbmltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTLCBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgUHJvcGVydHlUeXBlSW5mb30gZnJvbSAnLi9zcmMvdHlwZXMnXG5pbXBvcnQgeyBydW5JbkNvbnRleHQgfSBmcm9tICd2bSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlclRhZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEZvbGRlclRhZ1NldHRpbmdzO1xuICAgIHByaXZhdGUgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xuICAgIC8vcHJpdmF0ZSBvbGRGb2xkZXJQYXRocyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmcgfCBudWxsPigpO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9ICdQcm9wZXJ0eSBVcGRhdGVyIFRvb2xzXFxuIGxvYWRpbmcgLi4uJztcbiAgICAgICAgY29uc3QgbG9hZGluZ05vdGljZSA9IG5ldyBOb3RpY2Uobm90aWNlTWVzc2FnZSwwKVxuICAgICAgICAvKlxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIGZvbGRlciBwYXRocyBmb3IgYWxsIGZpbGVzXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgKi9cbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuIHJlZ2lzdGVyIGV2ZW50cyAuLi4nO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG4gICAgICAgIC8vIEZpbGUgY3JlYXRpb24gaGFuZGxlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgKGZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSkpO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMudXBkYXRlRmlsZVRhZyhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBGaWxlIHJlbmFtZS9tb3ZlIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnN0IG9sZFRhZ1BhdGggPSB0aGlzLm9sZEZvbGRlclBhdGhzLmdldChvbGRQYXRoKSA/PyBudWxsO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnN0IG5ld1RhZ1BhdGggPSB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCBuZXdUYWdQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcywgb2xkUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgdXBkYXRlIHdoZW4gbW92aW5nIHRvL2Zyb20gcm9vdCBmb2xkZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFRhZ1BhdGggIT09IG5ld1RhZ1BhdGggfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAob2xkVGFnUGF0aCAhPT0gbnVsbCAmJiBuZXdUYWdQYXRoID09PSBudWxsKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgIChvbGRUYWdQYXRoID09PSBudWxsICYmIG5ld1RhZ1BhdGggIT09IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMudXBkYXRlRmlsZVRhZyhmaWxlLCBvbGRUYWdQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gRmlsZSBjbG9zZSBoYW5kbGVyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKGxlYWYpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobGVhZj8udmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c0ZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgY2xvc2luZyBmaWxlOiBgLCBwcmV2aW91c0ZpbGU/LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNGaWxlKSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycyhwcmV2aW91c0ZpbGUsIHRoaXMuc2V0dGluZ3MucnVsZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuIGluaXRpYWwgcHJvY2Vzc2luZyAuLi4nO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbCBwcm9jZXNzaW5nIG9mIGV4aXN0aW5nIGZpbGVzXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICAgICAgLy90aGlzLnVwZGF0ZUZpbGVUYWcoZmlsZSk7XG4gICAgICAgICAgICAvL3RoaXMudXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKGZpbGUsIHRoaXMuc2V0dGluZ3MucnVsZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuZG9uZSEnO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG4gICAgICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgICAgIGxvYWRpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICB9LDIwMDApXG5cbiAgICAgICAgLy8gQWRkIHNldHRpbmdzIHRhYlxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEZvbGRlclRhZ1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGxldCBkYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgZGF0YSk7XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZvcm1hdFRhZ05hbWUobmFtZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWR7XG4gICAgICAgIGlmIChuYW1lID09PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpcnN0IHJlcGxhY2Ugc3BhY2VzIGFjY29yZGluZyB0byBzZXR0aW5nc1xuICAgICAgICBsZXQgZm9ybWF0dGVkID0gbmFtZS5yZXBsYWNlKC9cXHMrL2csIHRoaXMuc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChwcmVzZXJ2aW5nIGxldHRlcnMgd2l0aCBkaWFjcml0aWNzKVxuICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZSgvW15hLXpBLVowLTlcXC1fXFwvXHUwMEU0XHUwMEY2XHUwMEZDXHUwMERGXHUwMEM0XHUwMEQ2XHUwMERDXHUwMEUxXHUwMEU5XHUwMEVEXHUwMEYzXHUwMEZBXHUwMEZEXHUwMEMxXHUwMEM5XHUwMENEXHUwMEQzXHUwMERBXHUwMEREXHUwMEUwXHUwMEU4XHUwMEVDXHUwMEYyXHUwMEY5XHUwMEMwXHUwMEM4XHUwMENDXHUwMEQyXHUwMEQ5XHUwMEUyXHUwMEVBXHUwMEVFXHUwMEY0XHUwMEZCXHUwMEMyXHUwMENBXHUwMENFXHUwMEQ0XHUwMERCXHUwMEUzXHUwMEYxXHUwMEY1XHUwMEMzXHUwMEQxXHUwMEQ1XS9nLCB0aGlzLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udmVydCB0byBsb3dlcmNhc2UgaWYgY29uZmlndXJlZFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5sb3dlcmNhc2VUYWdzKSB7XG4gICAgICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZUZpbGVUYWcoZmlsZTogVEZpbGUsIG9sZFRhZ1BhdGg/OiBzdHJpbmcgfCBudWxsKSB7XG4gICAgICAgIGNvbnN0IG5ld1RhZ1BhdGggPSB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSk7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZE5ld1BhdGggPSBuZXdUYWdQYXRoID8gdGhpcy5mb3JtYXRUYWdOYW1lKG5ld1RhZ1BhdGgpIDogbnVsbDtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1vdmluZyB0byByb290LCBuZXdUYWcgd2lsbCBiZSBudWxsXG4gICAgICAgIGNvbnN0IG5ld1RhZyA9IGZvcm1hdHRlZE5ld1BhdGggPyB0aGlzLnNldHRpbmdzLnRhZ1ByZWZpeCArIGZvcm1hdHRlZE5ld1BhdGggOiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gRm9ybWF0IHRoZSBvbGQgdGFnIGZvciByZW1vdmFsXG4gICAgICAgIGxldCBvbGRUYWdUb1JlbW92ZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob2xkVGFnUGF0aCkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkT2xkUGF0aCA9IHRoaXMuZm9ybWF0VGFnTmFtZShvbGRUYWdQYXRoKTtcbiAgICAgICAgICAgIGlmIChmb3JtYXR0ZWRPbGRQYXRoKSB7XG4gICAgICAgICAgICAgICAgb2xkVGFnVG9SZW1vdmUgPSB0aGlzLnNldHRpbmdzLnRhZ1ByZWZpeCArIGZvcm1hdHRlZE9sZFBhdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUZyb250bWF0dGVyVGFncyhmaWxlLCBuZXdUYWcsIG9sZFRhZ1RvUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEZvbGRlclBhdGhGb3JUYWcoZmlsZTogVEZpbGUpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZmlsZS5wYXJlbnQ7XG4gICAgICAgIGlmICghZm9sZGVyIHx8IGZvbGRlciA9PT0gdGhpcy5hcHAudmF1bHQuZ2V0Um9vdCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwYXRoUGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBjdXJyZW50Rm9sZGVyOiBURm9sZGVyIHwgbnVsbCA9IGZvbGRlcjtcblxuICAgICAgICB3aGlsZSAoY3VycmVudEZvbGRlciAmJiBjdXJyZW50Rm9sZGVyICE9PSB0aGlzLmFwcC52YXVsdC5nZXRSb290KCkpIHtcbiAgICAgICAgICAgIHBhdGhQYXJ0cy51bnNoaWZ0KGN1cnJlbnRGb2xkZXIubmFtZSk7XG4gICAgICAgICAgICBjdXJyZW50Rm9sZGVyID0gY3VycmVudEZvbGRlci5wYXJlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlUm9vdEZvbGRlciAmJiBwYXRoUGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcGF0aFBhcnRzID0gcGF0aFBhcnRzLnNsaWNlKDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBhdGhQYXJ0cy5sZW5ndGggPiAwID8gcGF0aFBhcnRzLmpvaW4oJy8nKSA6IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlsdGVycyBhIGdpdmVuIGZpbGUgYW5kIHJldHVybnMgdHJ1ZSBpZiBpdCBpcyBpbmNsdWRlZCBpbiBhIGZvbGRlciBvciBmaWxlIGxpc3RcbiAgICAgKiBAcGFyYW0gZmlsZSBcbiAgICAgKiBAcGFyYW0gZmlsdGVyTW9kZSAnZXhjbHVkZSd8J2luY2x1ZGUnXG4gICAgICogQHBhcmFtIHR5cGUgJ2ZvbGRlcnMnfCdmaWxlcydcbiAgICAgKiBAcmV0dXJucyBcbiAgICAgKi9cbiAgICBmaWx0ZXJGaWxlKGZpbGU6IFRGaWxlLCBmaWx0ZXJNb2RlOiBzdHJpbmcsIHR5cGU6c3RyaW5nKTpib29sZWFuIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBmaWx0ZXJBcnJheSA9ICh0eXBlPT09J2ZvbGRlcnMnKSA/IHRoaXMuc2V0dGluZ3NbZmlsdGVyTW9kZV0uc2VsZWN0ZWRGb2xkZXJzIDogdGhpcy5zZXR0aW5nc1tmaWx0ZXJNb2RlXS5zZWxlY3RlZEZpbGVzO1xuICAgICAgICBpZiAoZmlsdGVyQXJyYXkubGVuZ3RoID09PSAwKSByZXR1cm4gKGZpbHRlck1vZGUgPT09ICdpbmNsdWRlJyk/IGZhbHNlIDogdHJ1ZTtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIGNvbnN0IGZpbGVGb2xkZXIgPSB0aGlzLnRvb2xzLmdldEZvbGRlcnNGcm9tUGF0aChmaWxlLnBhdGgpO1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWUgKyAnLicgKyBmaWxlLmV4dGVuc2lvbjtcbiAgICAgICAgXG4gICAgICAgIGlmICh0eXBlID09PSAnZmlsZXMnKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJBcnJheS5pbmNsdWRlcyhmaWxlUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXJzJykge1xuICAgICAgICAgICAgZmlsdGVyQXJyYXkuZm9yRWFjaChwYXRoID0+IHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBmaWxlRm9sZGVyPy5zdGFydHNXaXRoKHBhdGguc2xpY2UoMSkpIHx8IGZhbHNlOyAvLyByZW1vdmUgcm9vdCAnLydcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChmaWx0ZXJNb2RlID09PSAnZXhjbHVkZScpPyAhcmVzdWx0IDogcmVzdWx0O1xuICAgIH1cblxuICAgIGNoZWNrSWZGaWxlQWxsb3dlZChmaWxlOiBURmlsZSkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZmlsZXMgaW4gdGhlIGluY2x1ZGUgZmlsZXMgbGlzdFxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdpbmNsdWRlJywgJ2ZpbGVzJyk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSB0cnVlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGluY2x1ZGUtbGlzdFxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmb2xkZXJzIGluIHRoZSBpbmNsdWRlIGZvbGRlcnMgbGlzdFxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdpbmNsdWRlJywgJ2ZvbGRlcnMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybiByZXN1bHQ7IC8vIGZpbGUgaXMgaW4gYSBmb2xkZXIgaW5zaWRlIHRoZSBpbmNsdWRlLWxpc3RcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZpbGVzIGluIHRoZSBleGNsdWRlIGZpbGVzIGxpc3QuXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZpbHRlckZpbGUoZmlsZSwgJ2V4Y2x1ZGUnLCAnZmlsZXMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGV4Y2x1ZGUtbGlzdFxuICAgICAgICB9ICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0LlxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdleGNsdWRlJywgJ2ZvbGRlcnMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGEgZm9sZGVyIGluc2lkZSB0aGUgaW5jbHVkZS1saXN0XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBmb3JtYXRWYWx1ZSh2YWx1ZTphbnksIHR5cGU6c3RyaW5nKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgICAgICBjYXNlICd0YWdzJzpcbiAgICAgICAgICAgIGNhc2UgJ2FsaWFzZXMnOlxuICAgICAgICAgICAgY2FzZSAnbXVsdGl0ZXh0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50b29scy50b1lhbWxTYWZlU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgJ2RhdGUnOlxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh2YWx1ZSkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID8gJ3RydWUnIDogJ2ZhbHNlJztcbiAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKGZpbGU6IFRGaWxlLCBydWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXSwgb2xkUGF0aD86IHN0cmluZykge1xuXG4gICAgICAgIGlmICghdGhpcy5jaGVja0lmRmlsZUFsbG93ZWQoZmlsZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBmaWxlICR7ZmlsZS5wYXRofSByZWplY3RlZCFgKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyc0Zyb21QYXRoKGZpbGUucGF0aCkpO1xuICAgICAgICBjb25zdCBvbGRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyc0Zyb21QYXRoKG9sZFBhdGgpKVxuICAgICAgICBpZiAob2xkUGF0aFRhZykgY29uc29sZS5sb2coYHVwZGF0ZSBmaWxlOiBcIiR7b2xkUGF0aFRhZ31cIiB0byBcIiR7Y3VycmVudFBhdGhUYWd9XCJgKTtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlciB8fCB7fTtcbiAgICAgICAgbGV0IGZ4UmVzdWx0OmFueTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVyVHlwZXMgPSB7fVxuXG4gICAgICAgIC8vIGFwcGx5IGFsbCBydWxlcyB0byBmcm9udG1hdHRlclxuICAgICAgICBydWxlcy5mb3JFYWNoKHJ1bGUgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBydWxlRnVuY3Rpb24gPSBwYXJzZUpTQ29kZShydWxlLmpzQ29kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBydWxlRnVuY3Rpb24gIT09ICdmdW5jdGlvbicpIHJldHVybjtcbiAgICAgICAgICAgICAgICBmeFJlc3VsdCA9IHJ1bGVGdW5jdGlvbih0aGlzLmFwcCwgZmlsZSwgdGhpcy50b29scyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uSW5kZXggPSBydWxlRnVuY3Rpb25zLmZpbmRJbmRleChmeCA9PiBmeC5pZCA9PT0gcnVsZS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25JbmRleCE9PS0xKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZXhlY3V0ZSBydWxlIGZvciAke3J1bGUucHJvcGVydHl9ICR7cnVsZS5jb250ZW50fSBmb3IgZmlsZSAke2ZpbGUucGF0aH1gKTtcbiAgICAgICAgICAgICAgICAgICAgZnhSZXN1bHQgPSBydWxlRnVuY3Rpb25zW2Z1bmN0aW9uSW5kZXhdLmZ4KHRoaXMuYXBwLCBmaWxlLCB0aGlzLnRvb2xzKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhydWxlLmNvbnRlbnQsIHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF0gPyBmeFJlc3VsdCA6ICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmcm9udG1hdHRlcltydWxlLmNvbnRlbnRdID0gZnhSZXN1bHQ7IC8vIHVwZGF0ZSBvciBhZGQgdGhlIG5ldyB2YWx1ZVxuICAgICAgICAgICAgcGFyYW1ldGVyVHlwZXNbcnVsZS5wcm9wZXJ0eV0gPSBydWxlLnR5cGU7IC8vIGFkZCB0eXBlcyB0byBwYXJhbWV0ZXIgbGlzdC5cbiAgICAgICAgfSlcblxuICAgICAgICAvLyB1cGRhdGUgZm9sZGVyIHRhZ1xuICAgICAgICBpZiAoIWZyb250bWF0dGVyLmhhc093blByb3BlcnR5KCd0YWdzJykpIGZyb250bWF0dGVyLnRhZ3MgPSBbXTtcbiAgICAgICAgaWYgKGZyb250bWF0dGVyLnRhZ3MgPT09IG51bGwpIGZyb250bWF0dGVyLnRhZ3MgPSBbXTtcbiAgICAgICAgaWYgKG9sZFBhdGgpIHsgXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIudGFncy5pbmNsdWRlcyhvbGRQYXRoVGFnKSkge1xuICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGZyb250bWF0dGVyLnRhZ3MuaW5kZXhPZihvbGRQYXRoVGFnKTtcbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlci50YWdzLnNwbGljZShmcm9udG1hdHRlci50YWdzLmluZGV4T2Yob2xkUGF0aFRhZyksMSxjdXJyZW50UGF0aFRhZyk7IC8vIHJlcGxhY2UgdGhlIHRhZ1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlci50YWdzLnB1c2goY3VycmVudFBhdGhUYWcpOyAvLyBhZGQgdGhlIHRhZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnJvbnRtYXR0ZXIudGFncy5wdXNoKGN1cnJlbnRQYXRoVGFnKTsgLy8gYWRkIHRoZSB0YWdcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlYnVpbGQgZnJvbnRtYXR0ZXIgWUFNTFxuICAgICAgICBsZXQgbmV3RnJvbnRtYXR0ZXIgPSAnLS0tXFxuJztcbiAgICAgICAgT2JqZWN0LmtleXMoZnJvbnRtYXR0ZXIpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZnJvbnRtYXR0ZXJba2V5XSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmcm9udG1hdHRlcltrZXldKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgJHt0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcoa2V5KX06XFxuYDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBmcm9udG1hdHRlcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgICAtICR7dGhpcy5mb3JtYXRWYWx1ZShpdGVtLCBwYXJhbWV0ZXJUeXBlc1trZXldKX1cXG5gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbid0IHdyaXRlIG9iamVjdHMgdG8gWUFNTFwiLGtleSwgZnJvbnRtYXR0ZXJba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlciArPSBgJHt0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcoa2V5KX06ICR7dGhpcy5mb3JtYXRWYWx1ZShmcm9udG1hdHRlcltrZXldLCBwYXJhbWV0ZXJUeXBlc1trZXldKX1cXG5gXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIG5ld0Zyb250bWF0dGVyICs9ICctLS1cXG4nO1xuXG4gICAgICAgIGxldCBlbmRPZkZyb250bWF0dGVyID0gY29udGVudC5pbmRleE9mKCctLS1cXG4nLDMpO1xuICAgICAgICBjb250ZW50ID0gbmV3RnJvbnRtYXR0ZXIgKyBjb250ZW50LnNsaWNlKGVuZE9mRnJvbnRtYXR0ZXIrNCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coY29udGVudCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZUZyb250bWF0dGVyVGFncyhmaWxlOiBURmlsZSwgbmV3VGFnOiBzdHJpbmcgfCBudWxsLCBvbGRUYWdUb1JlbW92ZT86IHN0cmluZykge1xuICAgICAgICBsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHRhZ3MgKGhhbmRsaW5nIGJvdGggYXJyYXkgYW5kIHN0cmluZyBmb3JtYXRzKVxuICAgICAgICBsZXQgZXhpc3RpbmdUYWdzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lXSkge1xuICAgICAgICAgICAgY29uc3QgdGFnc1ZhbHVlID0gZnJvbnRtYXR0ZXJbdGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhZ3NWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBleGlzdGluZ1RhZ3MgPSB0YWdzVmFsdWUuZmlsdGVyKHRhZyA9PiB0YWcgIT0gbnVsbCkubWFwKHRhZyA9PiBTdHJpbmcodGFnKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YWdzVmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzID0gdGFnc1ZhbHVlLnNwbGl0KC8sXFxzKi8pXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodGFnID0+IHRhZy50cmltKCkpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodGFnID0+IHRhZy5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSBhbnkgZXhpc3RpbmcgZm9sZGVyIHBhdGggdGFncyAod2l0aCBjdXJyZW50IHByZWZpeClcbiAgICAgICAgZXhpc3RpbmdUYWdzID0gZXhpc3RpbmdUYWdzLmZpbHRlcih0YWcgPT4ge1xuICAgICAgICAgICAgaWYgKHRhZyA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXRhZy5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MudGFnUHJlZml4KSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBjb25zdCB0YWdXaXRob3V0UHJlZml4ID0gdGFnLnNsaWNlKHRoaXMuc2V0dGluZ3MudGFnUHJlZml4Lmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gIXRhZ1dpdGhvdXRQcmVmaXguaW5jbHVkZXMoJy8nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3BlY2lmaWNhbGx5IHJlbW92ZSB0aGUgb2xkIHRhZyBpZiBwcm92aWRlZFxuICAgICAgICBpZiAob2xkVGFnVG9SZW1vdmUpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nVGFncyA9IGV4aXN0aW5nVGFncy5maWx0ZXIodGFnID0+IHRhZyAhPT0gb2xkVGFnVG9SZW1vdmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRoZSBuZXcgdGFnIGlmIHByb3ZpZGVkIGFuZCBub3QgYWxyZWFkeSBwcmVzZW50XG4gICAgICAgIGlmIChuZXdUYWcgJiYgIWV4aXN0aW5nVGFncy5pbmNsdWRlcyhuZXdUYWcpKSB7XG4gICAgICAgICAgICBleGlzdGluZ1RhZ3MucHVzaChuZXdUYWcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyXG4gICAgICAgIGxldCBuZXdGcm9udG1hdHRlcjogYW55ID0ge307XG4gICAgICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICAgICAgbmV3RnJvbnRtYXR0ZXIgPSB7Li4uZnJvbnRtYXR0ZXJ9O1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBvbGQgdGFncyBwcm9wZXJ0eSB0byBlbnN1cmUgcHJvcGVyIGZvcm1hdHRpbmdcbiAgICAgICAgICAgIGRlbGV0ZSBuZXdGcm9udG1hdHRlclt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWVdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZWNvbnN0cnVjdCB0aGUgZnJvbnRtYXR0ZXIgd2l0aCBwcm9wZXIgWUFNTCBmb3JtYXRcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQgPSAnJztcbiAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgIC8vIFJlcGxhY2UgZXhpc3RpbmcgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyRW5kID0gY29udGVudC5pbmRleE9mKCctLS0nLCAzKSArIDM7XG4gICAgICAgICAgICBjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UoZnJvbnRtYXR0ZXJFbmQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBCdWlsZCBuZXcgZnJvbnRtYXR0ZXIgY29udGVudFxuICAgICAgICAgICAgbGV0IGZyb250bWF0dGVyQ29udGVudCA9IE9iamVjdC5lbnRyaWVzKG5ld0Zyb250bWF0dGVyKVxuICAgICAgICAgICAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4gYCR7a2V5fTogJHt2YWx1ZX1gKVxuICAgICAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIHRhZ3MgaW4gcHJvcGVyIFlBTUwgYXJyYXkgZm9ybWF0IGlmIHdlIGhhdmUgYW55XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlckNvbnRlbnQgKz0gYFxcbiR7dGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lfTpcXG5gICtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzLm1hcCh0YWcgPT4gYCAgLSAke3RhZ31gKS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbmV3Q29udGVudCA9IGAtLS1cXG4ke2Zyb250bWF0dGVyQ29udGVudH1cXG4tLS0ke2JvZHlDb250ZW50fWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBPbmx5IGNyZWF0ZSBmcm9udG1hdHRlciBpZiB3ZSBoYXZlIHRhZ3MgdG8gYWRkXG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50ID0gYC0tLVxcbiR7dGhpcy5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lfTpcXG5gICtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdUYWdzLm1hcCh0YWcgPT4gYCAgLSAke3RhZ31gKS5qb2luKCdcXG4nKSArXG4gICAgICAgICAgICAgICAgICAgIGBcXG4tLS1cXG5cXG4ke2NvbnRlbnR9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTm8gdGFncyB0byBhZGQsIHJldHVybiBvcmlnaW5hbCBjb250ZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVGV4dENvbXBvbmVudCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgZm1Ub29scyBmcm9tICcuL2Zyb250bWF0dGVyLXRvb2xzJztcclxuaW1wb3J0IHsgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scyc7XHJcbmltcG9ydCB7IGdldFJ1bGVGdW5jdGlvbkJ5SWQsIHJ1bGVGdW5jdGlvbnMsIFJ1bGVGdW5jdGlvbiB9IGZyb20gJy4vcnVsZXMnO1xyXG5pbXBvcnQgeyBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgREVGQVVMVF9SVUxFX0RFRklOSVRJT04sIFByb3BlcnR5VHlwZUluZm99IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSAnLi9hbGVydEJveCc7XHJcbmltcG9ydCB7IG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCwgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7IC8vIEFkanVzdCBwYXRoIGFzIG5lZWRlZFxyXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBGb2xkZXJUYWdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IGFueTsgLy9Gb2xkZXJUYWdQbHVnaW47XHJcbiAgICBydWxlc0RpdjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBydWxlc0NvbnRyb2w6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICBrbm93blR5cGVzOiBhbnk7XHJcbiAgICBzY3JpcHRpbmdUb29sczogU2NyaXB0aW5nVG9vbHM7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IGFueSAvKkZvbGRlclRhZ1BsdWdpbiovKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuc2NyaXB0aW5nVG9vbHMgPSBuZXcgU2NyaXB0aW5nVG9vbHModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSBmbVRvb2xzLmdldFByb3BlcnRpZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKHRoaXMuYXBwKTtcclxuICAgICAgICB0aGlzLmtub3duVHlwZXMgPSBmbVRvb2xzLmdldFR5cGVzRnJvbU1ldGFkYXRhTWFuYWdlcih0aGlzLmFwcCk7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdGb2xkZXIgUGF0aCBUYWcgU2V0dGluZ3MnIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1RhZyBwcmVmaXgnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnT3B0aW9uYWwgcHJlZml4IHRvIGFkZCBiZWZvcmUgZm9sZGVyIHBhdGggdGFncycpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdwcmVmaXgvJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdQcmVmaXgpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnUHJlZml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZSByb290IGZvbGRlcicpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdJZiBlbmFibGVkLCB0aGUgcm9vdCBmb2xkZXIgbmFtZSB3aWxsIGJlIGV4Y2x1ZGVkIGZyb20gdGhlIHRhZycpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVSb290Rm9sZGVyKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVSb290Rm9sZGVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGFncyBwcm9wZXJ0eSBuYW1lJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0Zyb250bWF0dGVyIHByb3BlcnR5IG5hbWUgdG8gc3RvcmUgdGFncyAoZGVmYXVsdDogXCJ0YWdzXCIpJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3RhZ3MnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWUpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnc1Byb3BlcnR5TmFtZSA9IHZhbHVlIHx8ICd0YWdzJztcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdTcGFjZSByZXBsYWNlbWVudCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdDaGFyYWN0ZXIgdG8gcmVwbGFjZSBzcGFjZXMgaW4gZm9sZGVyIG5hbWVzIChkZWZhdWx0OiBcIl9cIiknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignXycpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudClcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50ID0gdmFsdWUgfHwgJ18nO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1NwZWNpYWwgY2hhcmFjdGVyIHJlcGxhY2VtZW50JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byByZXBsYWNlIHNwZWNpYWwgY2hhcmFjdGVycyAoZGVmYXVsdDogXCJfXCIpIC0gcHJlc2VydmVzIGxldHRlcnMgd2l0aCBkaWFjcml0aWNzJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ18nKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCA9IHZhbHVlIHx8ICdfJztcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdDb252ZXJ0IHRvIGxvd2VyY2FzZScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdDb252ZXJ0IGFsbCB0YWdzIHRvIGxvd2VyY2FzZScpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxvd2VyY2FzZVRhZ3MpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubG93ZXJjYXNlVGFncyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZSBGaWxlcyBhbmQgRm9sZGVycycpXHJcbiAgICAgICAgLnNldERlc2MoYEN1cnJlbnRseSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aH0gZm9sZGVycyBhbmQgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMubGVuZ3RofSBmaWxlcyB3aWxsIGJlICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5tb2RlfWQuYClcclxuICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ2ZvbGRlci14JylcclxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdFeGNsdWRlJylcclxuICAgICAgICAgICAgICAgIC5zZXRDdGEoKSAvLyBNYWtlcyB0aGUgYnV0dG9uIG1vcmUgcHJvbWluZW50XHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5tb2RlIHx8ICdleGNsdWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5kaXNwbGF5IHx8ICdmb2xkZXJzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsIC8vIGluY2x1ZGUsIGV4Y2x1ZGUgb3B0aW9uIGhpZGRlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcyA9IHJlc3VsdC5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUubW9kZSA9IHJlc3VsdC5tb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5kaXNwbGF5ID0gcmVzdWx0LmRpc3BsYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgICAgICAgICAgXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIEZpbGVzIGFuZCBGb2xkZXJzJylcclxuICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RofSBmb2xkZXJzIGFuZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHdpbGwgYmUgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGV9ZCBldmVuIHdoZW4gaW4gZXhjbHVkZWQgRm9sZGVycy5gKVxyXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLWNoZWNrJylcclxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdJbmNsdWRlJylcclxuICAgICAgICAgICAgICAgIC5zZXRDdGEoKSAvLyBNYWtlcyB0aGUgYnV0dG9uIG1vcmUgcHJvbWluZW50XHJcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5tb2RlIHx8ICdpbmNsdWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5kaXNwbGF5IHx8ICdmb2xkZXJzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsIC8vIGluY2x1ZGUsIGluY2x1ZGUgb3B0aW9uIGhpZGRlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcyA9IHJlc3VsdC5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUubW9kZSA9IHJlc3VsdC5tb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5kaXNwbGF5ID0gcmVzdWx0LmRpc3BsYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1J1bGVzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ2FkZCBydWxlcyB0byB1cGRhdGUgc2VsZWN0ZWQgcGFyYW1ldGVycycpO1xyXG5cclxuICAgICAgICB0aGlzLnJ1bGVzRGl2ID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm9ic2lkaWFuLWYydC1ydWxlLWFyZWFcIiB9KVxyXG4gICAgICAgIHRoaXMucnVsZXNDb250cm9sID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm9ic2lkaWFuLWYydC1ydWxlLWNvbnRyb2xzXCIgfSlcclxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5mb3JFYWNoKHJ1bGUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFkZFJ1bGUodGhpcy5ydWxlc0RpdixydWxlLmlkKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLnJ1bGVzQ29udHJvbClcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihhc3luYyAoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0SWNvbignc3F1YXJlLXBsdXMnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDbGFzcygnb2JzaWRpYW4tZjJ0LXNtYWxsQnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0VG9vbHRpcCgnYWRkIGEgcnVsZScpXHJcbiAgICAgICAgICAgICAgICBidXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRSdWxlKHRoaXMucnVsZXNEaXYpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8qIFRPRE8gYWRkIGNsZWFyIGFsbCBydWxlcyBmdW5jdGlvbmFsaXR5IFxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGFzeW5jIChidXR0b24pID0+IHsgXHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0SWNvbignc3F1YXJlLXgnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDbGFzcygnb2JzaWRpYW4tZjJ0LXNtYWxsQnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0VG9vbHRpcCgncmVtb3ZlIGFsbCBydWxlcycpXHJcbiAgICAgICAgICAgICAgICBidXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbW92ZUFsbFJ1bGVzJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICovXHJcbiAgICB9XHJcblxyXG4gICAgYWRkUnVsZShkaXZFbDogSFRNTERpdkVsZW1lbnQsIHJ1bGVVVUlEID0gJycpIHtcclxuICAgICAgICBsZXQgY21FZGl0b3I6IENvZGVNaXJyb3IuRWRpdG9yIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHJ1bGVVVUlEID09PSAnJyl7XHJcbiAgICAgICAgICAgIHJ1bGVVVUlEID0gcmFuZG9tVVVJRCgpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9SVUxFX0RFRklOSVRJT04sIHtcclxuICAgICAgICAgICAgICAgIGlkOiBydWxlVVVJRCxcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBydWxlOkZvbGRlclRhZ1J1bGVEZWZpbml0aW9uID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZmluZChydWxlID0+IHJ1bGUuaWQgPT09IHJ1bGVVVUlEKTtcclxuICAgICAgICBpZighcnVsZSkgcmV0dXJuO1xyXG4gICAgICAgIGxldCBwcm9wZXJ0eU5hbWVJbnB1dCA6IFRleHRDb21wb25lbnQ7XHJcbiAgICAgICAgbGV0IHNob3dGdW5jdGlvbkJ1dHRvbiA6IEJ1dHRvbkNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgcHJvcGVydHlUeXBlRHJvcGRvd24gOiBEcm9wZG93bkNvbXBvbmVudDtcclxuICAgICAgICBsZXQgcHJvcGVydHlEZXZEcm9wZG93biA6IERyb3Bkb3duQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQ6IFRleHRDb21wb25lbnQgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IGZ1bmN0aW9uVGVzdEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IHJ1bGVzRGl2ID0gZGl2RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm9ic2lkaWFuLWYydC1ydWxlTGluZVwiIH0pO1xyXG4gICAgICAgIHJ1bGVzRGl2LnNldEF0dHJpYnV0ZSgnaWQnLHJ1bGVVVUlEKVxyXG4gICAgICAgIGNvbnN0IHJ1bGVPcHRpb25zRGl2ID0gZGl2RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm9ic2lkaWFuLWYydC1ydWxlT3B0aW9uc1wiIH0pO1xyXG4gICAgICAgIC8vcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheT0gJ25vbmUnO1xyXG4gICAgICAgIC8vcnVsZU9wdGlvbnNEaXYuc3R5bGUud2lkdGg9ICc3MDBweCdcclxuICAgICAgICBydWxlT3B0aW9uc0Rpdi5zdHlsZS5oZWlnaHQ9ICczNTBweDsnO1xyXG4gICAgICAgIHJ1bGVPcHRpb25zRGl2LnN0eWxlLmFsaWduSXRlbXM9ICdmbGV4LWVuZCc7XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVRleHRBcmVhKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJ1bGVPcHRpb25zU2V0dGluZ3MgPSBuZXcgU2V0dGluZyhydWxlT3B0aW9uc0RpdilcclxuICAgICAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0QXJlYSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ2VuZGVyIHZhbGlkIEpTIENvZGUnKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5pbnB1dEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgaGVpZ2h0OjE5MHB4OyB3aWR0aDo4MCU7YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWEub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvblRlc3RCdXR0b24pIGZ1bmN0aW9uVGVzdEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5qc0NvZGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBDb2RlTWlycm9yIDVcclxuICAgICAgICAgICAgbGV0IGpzQ29kZSA9IHJ1bGUuanNDb2RlO1xyXG4gICAgICAgICAgICBpZiAocnVsZS5jb250ZW50ICE9PSAnc2NyaXB0Jykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ1bGUuYnVpbGRJbkNvZGUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZSA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZS5jb250ZW50KT8uc291cmNlIHx8IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5idWlsZEluQ29kZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjbUVkaXRvciA9ICh3aW5kb3cgYXMgYW55KS5Db2RlTWlycm9yKHJ1bGVPcHRpb25zRGl2LCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZToganNDb2RlIHx8IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuXFxuICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICAgICAgICAgICAgICBtb2RlOiBcImphdmFzY3JpcHRcIixcclxuICAgICAgICAgICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbWU6IFwib2JzaWRpYW5cIixcclxuICAgICAgICAgICAgICAgIGluZGVudFVuaXQ6IDIsICBcclxuICAgICAgICAgICAgICAgIGxpbmVXcmFwcGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICByZWFkT25seTogZmFsc2UsICBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjbUVkaXRvcikge1xyXG4gICAgICAgICAgICAgICAgY21FZGl0b3Iub24oJ2NoYW5nZScsIChjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25UZXN0QnV0dG9uKSBmdW5jdGlvblRlc3RCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoJ21vZC13YXJuaW5nJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNtRWRpdG9yLm9uKCdibHVyJywgKGNtRWRpdG9yOiBDb2RlTWlycm9yLkVkaXRvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuanNDb2RlID0gY21FZGl0b3IuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLmJ1aWxkSW5Db2RlID0gY21FZGl0b3IuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgYSBidXR0b24gdG8gc2F2ZSB0aGUgY29kZVxyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhydWxlT3B0aW9uc0RpdilcclxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uVGVzdEJ1dHRvbiA9IGJ1dHRvbjtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAuc2V0V2FybmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJTYXZlICYgVGVzdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNtRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQganNDb2RlID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5jb250ZW50ID09PSAnc2NyaXB0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuanNDb2RlID0gY21FZGl0b3IuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmpzQ29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZSA9IGNtRWRpdG9yLmdldFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5idWlsZEluQ29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1c2VyRnVuY3Rpb24gPSAgcGFyc2VKU0NvZGUoanNDb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdXNlckZ1bmN0aW9uID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcnJvckhpbnQgPSBcIlNlZSBjb25zb2xlIGZvciBkZXRhaWxzIVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRnVuY3Rpb24uY29udGFpbnMoJ1VuZXhwZWN0ZWQgdG9rZW4nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckhpbnQgPSBcIkRpZCB5b3UgbWlzc2VkIGEgc2VtaWNvbG9uICg7KT9cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKGBTeW50YXggZXJyb3I6ICR7dXNlckZ1bmN0aW9ufSEgJHtlcnJvckhpbnR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdXNlckZ1bmN0aW9uKHRoaXMuYXBwLCBmaWxlc1s4XSwgdGhpcy5zY3JpcHRpbmdUb29scyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUocmVzdWx0LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnJlbW92ZUNsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKGBTeW50YXggZXJyb3I6ICR7ZS5tZXNzYWdlfSEgU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMhYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU3ludGF4IGVycm9yLiBcIiwgZSwganNDb2RlLCB1c2VyRnVuY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcInN5bnRheCBlcnJvclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCA9IHRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZnVuY3Rpb24gcmVzdWx0JylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQodHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICc2MDBweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgfSkgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzaG93SnNGdW5jdGlvbkJ1dHRvbihydWxlSWQ6c3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNob3dDb2RlQnV0dG9uOmJvb2xlYW4gPSBcclxuICAgICAgICAgICAgICAgIChnZXRSdWxlRnVuY3Rpb25CeUlkKHJ1bGVJZCk/LnNvdXJjZSAhPT0gJycpIHx8XHJcbiAgICAgICAgICAgICAgICAocnVsZUlkID09PSAnc2NyaXB0Jyk7XHJcbiAgICAgICAgICAgIGlmICggc2hvd0NvZGVCdXR0b24gKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hvd0Z1bmN0aW9uQnV0dG9uKSBzaG93RnVuY3Rpb25CdXR0b24uYnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eURldkRyb3Bkb3duKSBwcm9wZXJ0eURldkRyb3Bkb3duLnNlbGVjdEVsLnN0eWxlLndpZHRoID0gXCIzNjBweFwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNob3dGdW5jdGlvbkJ1dHRvbikgc2hvd0Z1bmN0aW9uQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eURldkRyb3Bkb3duKSBwcm9wZXJ0eURldkRyb3Bkb3duLnNlbGVjdEVsLnN0eWxlLndpZHRoID0gXCI0MDBweFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBydWxlU2V0dGluZ3MgPSBuZXcgU2V0dGluZyhydWxlc0RpdilcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDoxNTBweDsganVzdGlmeS1jb250ZW50OiBsZWZ0OyAnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KHJ1bGUucHJvcGVydHkgfHwgJ1NlbGVjdCBQYXJhbWV0ZXInKVxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBmbVRvb2xzLlNlbGVjdFByb3BlcnR5KHRoaXMuYXBwLCB0aGlzLmtub3duUHJvcGVydGllcywgcnVsZS50eXBlUHJvcGVydHksIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5uYW1lICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS50eXBlUHJvcGVydHkgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnByb3BlcnR5ID0gcmVzdWx0Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnR5cGUgPSByZXN1bHQudHlwZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmtub3duUHJvcGVydGllcy5maWx0ZXIoKHByb3BlcnR5KSA9PiBwcm9wZXJ0eS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocnVsZS5wcm9wZXJ0eS50b0xvd2VyQ2FzZSgpKSkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wcm9wZXJ0eVR5cGVEcm9wZG93bi5zZXREaXNhYmxlZChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQocmVzdWx0Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlUeXBlRHJvcGRvd24uc2V0VmFsdWUocmVzdWx0LnR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuZGlzcGxheSgpOyAvLyBSZWZyZXNoIHRoZSBzZXR0aW5ncyB0YWIgdG8gc2hvdyBuZXcgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVR5cGVEcm9wZG93biA9IGRyb3Bkb3duO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3dpZHRoOjExMHB4Jyk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJcIiwgXCJTZWxlY3QgYSB0eXBlXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiYWxpYXNlc1wiLCBcIkFsaWFzZXNcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJjaGVja2JveFwiLCBcIkNoZWNrYm94XCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZGF0ZVwiLCBcIkRhdGVcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJkYXRldGltZVwiLCBcIkRhdGUgJiBUaW1lXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwibXVsdGl0ZXh0XCIsIFwiTGlzdFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIm51bWJlclwiLCBcIk51bWJlclwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInRhZ3NcIiwgXCJUYWdzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwidGV4dFwiLCBcIlRleHRcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAocnVsZS50eXBlKSBkcm9wZG93bi5zZXRWYWx1ZShydWxlLnR5cGUpO1xyXG4gICAgICAgICAgICAgICAgLy9kcm9wZG93bi5zZXREaXNhYmxlZCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS50eXBlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duID0gZHJvcGRvd247XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZWxlY3RFbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6NDAwcHgnKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIlwiLCBcIlNlbGVjdCBhIGNvbnRlbnRcIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBydWxlIG9mIHJ1bGVGdW5jdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24ocnVsZS5pZCwgcnVsZS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZnVsbFBhdGhcIiwgXCJGdWxsIHBhdGggYW5kIGZpbGVuYW1lXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwicGF0aFwiLCBcIkZ1bGwgcGF0aFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImZvbGRlclwiLCBcIkZvbGRlclwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInJvb3RGb2xkZXJcIiwgXCJSb290IEZvbGRlclwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIm5hbWVcIiwgXCJGaWxlbmFtZVwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIm5hbWVFeHRcIiwgXCJGaWxlbmFtZSB3aXRoIEV4dGVuc2lvblwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImFsaWFzRnJvbVBhdGhcIiwgXCJhZGQgYW4gQWxpYXMgZm9ybSBmdWxsIHBhdGhcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJkYXRlVGltZUNyZWF0ZWRcIiwgXCJEYXRlIChhbmQgVGltZSkgY3JlYXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImRhdGVUaW1lTW9kaWZpZWRcIiwgXCJEYXRlIChhbmQgVGltZSkgbW9kaWZpZWRcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJmaWxlU2l6ZUJ5dGVzXCIsIFwiRmlsZSBTaXplIGluIEJ5dGVzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZmlsZVNpemVTdHJpbmdcIiwgXCJGaWxlIFNpemUgYXMgVGV4dFwiKTtcclxuICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJzY3JpcHRcIiwgXCJKYXZhU2NyaXB0IHNjcmlwdFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQganNDb2RlID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICdzY3JpcHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2xkT3JpZ2luYWxDb2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZChydWxlLmNvbnRlbnQpPy5zb3VyY2UgfHwgcnVsZUZ1bmN0aW9uc1swXS5zb3VyY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHJ1bGUuYnVpbGRJbkNvZGUgIT09ICcnKSAmJiAocnVsZS5idWlsZEluQ29kZSAhPT0gb2xkT3JpZ2luYWxDb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZFByb2NlZWQgPSBhd2FpdCBuZXcgQWxlcnRNb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ092ZXJ3cml0ZSBleGlzdGluZyBjb2RlPycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSSBzZWVzIGxpa2UgeW91IGhhdmUgY3VzdG9tIGNvZGUgZm9yIHRoaXMgcnVsZSEgU2hvdWxkIHRoaXMgYmUgb3ZlcndyaXR0ZW4gYnkgZGVmYXVsdCBjb2RlIGZvciB0aGlzIHBhcmFtZXRlcj8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1llcycsICdObydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5vcGVuQW5kR2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkUHJvY2VlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmJ1aWxkSW5Db2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTsgLy8gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNDb2RlID0gcnVsZS5idWlsZEluQ29kZTsgLy8ga2VlcCB0aGUgZXhpc3RpbmcgY29kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbUVkaXRvcj8uc2V0VmFsdWUoanNDb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2F3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmJ1aWxkSW5Db2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZCh2YWx1ZSk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbUVkaXRvcj8uc2V0VmFsdWUoanNDb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2F3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY21FZGl0b3I/LnNldFZhbHVlKHJ1bGUuanNDb2RlIT09JycgPyBydWxlLmpzQ29kZSA6IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLmNvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9ydWxlT3B0aW9uc0Rpdi5zdHlsZS5kaXNwbGF5ID0gYCR7KHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpID8gJ2ZsZXgnIDogJ25vbmUnfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dKc0Z1bmN0aW9uQnV0dG9uKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheSA9IGAkeyhydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSAmJiAocnVsZS5zaG93Q29udGVudCkgPyAnZmxleCcgOiAnbm9uZSd9YDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihhc3luYyAoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzaG93RnVuY3Rpb25CdXR0b24gPSBidXR0b247XHJcbiAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3dpZHRoOjMwcHgnKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRJY29uKCdzcXVhcmUtZnVuY3Rpb24nKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDbGFzcygnb2JzaWRpYW4tZjJ0LXNtYWxsQnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0VG9vbHRpcCgnc2hvdyAmIGVkaXQgY29kZScpXHJcbiAgICAgICAgICAgICAgICBidXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZS5zaG93Q29udGVudCA9ICFydWxlLnNob3dDb250ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGVPcHRpb25zRGl2LnN0eWxlLmRpc3BsYXkgPSBgJHsocnVsZS5zaG93Q29udGVudCkgPyAnZmxleCcgOiAnbm9uZSd9YDtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBzaG93RnVuY3Rpb25CdXR0b24uYnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGFzeW5jIChidXR0b24pID0+IHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6MzBweCcpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEljb24oJ3NxdWFyZS1taW51cycpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldENsYXNzKCdvYnNpZGlhbi1mMnQtc21hbGxCdXR0b24nKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRUb29sdGlwKCdyZW1vdmUgdGhpcyBydWxlJylcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5zcGxpY2UodGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZmluZEluZGV4KHZhbHVlID0+IHZhbHVlLmlkID09PSBydWxlVVVJRCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUnVsZShydWxlc0Rpdik7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgc2hvd0pzRnVuY3Rpb25CdXR0b24ocnVsZS5jb250ZW50KTtcclxuICAgICAgICBkaXZFbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnYm9yZGVyLXRvcCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVJ1bGUocnVsZXNEaXY6IEhUTUxEaXZFbGVtZW50KSB7XHJcbiAgICAgICAgcnVsZXNEaXYucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eVR5cGVJbmZvLCBQcm9wZXJ0eVR5cGV9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUFJPUEVSVFlfVFlQRV9JTkZPOiBQcm9wZXJ0eVR5cGVJbmZvID0ge1xyXG4gICAgbmFtZSA6IFwiXCIsXHJcbiAgICB0eXBlIDogXCJcIixcclxuICAgIGlzQXJyYXk6IGZhbHNlLFxyXG4gICAgdmFsdWVzOiBbXSxcclxuICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldHMgYWxsIGF2YWlsYWJsZSBwcm9wZXJ0aWVzIHdpdGggdGhlaXIgdHlwZSBpbmZvcm1hdGlvblxyXG4gKiBAcGFyYW0gYXBwIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2VcclxuICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIGFuIGFycmF5IG9mIFByb3BlcnR5VHlwZUluZm9cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxQcm9wZXJ0aWVzV2l0aFR5cGVzKGFwcDogQXBwKTogUHJvbWlzZTxQcm9wZXJ0eVR5cGVJbmZvW10+IHtcclxuICAgIC8vIFRyeSB0byBnZXQgcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzIChmYWxsYmFjayB0byBlbXB0eSBhcnJheSBpZiBBUEkgY2hhbmdlZClcclxuICAgIGNvbnN0IHJlZ2lzdGVyZWRQcm9wcyA9IGF3YWl0IGdldFJlZ2lzdGVyZWRQcm9wZXJ0aWVzU2FmZShhcHApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgYWRkaXRpb25hbCBwcm9wZXJ0aWVzIGZvdW5kIGluIG5vdGVzXHJcbiAgICBjb25zdCBmaWxlUHJvcHMgPSBhd2FpdCBnZXRQcm9wZXJ0aWVzRnJvbUZpbGVzKGFwcCk7XHJcbiAgICBcclxuICAgIC8vIENvbWJpbmUgcmVzdWx0cyAoZmF2b3IgcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzIHdoZW4gZHVwbGljYXRlcyBleGlzdClcclxuICAgIGNvbnN0IGNvbWJpbmVkID0gbmV3IE1hcDxzdHJpbmcsIFByb3BlcnR5VHlwZUluZm8+KCk7XHJcbiAgICBcclxuICAgIC8vIEFkZCBwcm9wZXJ0aWVzIGZvdW5kIGluIGZpbGVzIGZpcnN0XHJcbiAgICBmaWxlUHJvcHMuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgICBjb21iaW5lZC5zZXQocHJvcC5uYW1lLCBwcm9wKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBUaGVuIG92ZXJyaWRlIHdpdGggcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzICh3aGljaCBoYXZlIG1vcmUgY29tcGxldGUgdHlwZSBpbmZvKVxyXG4gICAgcmVnaXN0ZXJlZFByb3BzLmZvckVhY2gocHJvcCA9PiB7XHJcbiAgICAgICAgY29tYmluZWQuc2V0KHByb3AubmFtZSwgcHJvcCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIEFycmF5LmZyb20oY29tYmluZWQudmFsdWVzKCkpLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IFByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YU1hbmFnZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9wZXJ0aWVzRnJvbU1ldGFkYXRhTWFuYWdlcihhcHA6IEFwcCk6IFByb3BlcnR5VHlwZUluZm9bXSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhTWFuYWdlciA9IChhcHAgYXMgYW55KS5tZXRhZGF0YVR5cGVNYW5hZ2VyO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0IHByb3BlcnRpZXM6XCIsbWV0YWRhdGFNYW5hZ2VyKTtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhtZXRhZGF0YU1hbmFnZXIucHJvcGVydGllcykubWFwKCAodmFsdWU6YW55KTpQcm9wZXJ0eVR5cGVJbmZvID0+ICh7XHJcbiAgICAgICAgICAgIG5hbWU6IHZhbHVlLm5hbWUsXHJcbiAgICAgICAgICAgIHR5cGU6IHZhbHVlLnR5cGUsXHJcbiAgICAgICAgICAgIGNvdW50OiB2YWx1ZS5jb3VudCxcclxuICAgICAgICAgICAgc291cmNlOiAncmVnaXN0ZXJlZCdcclxuICAgICAgICB9KSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZG4ndCBhY2Nlc3MgcHJvcGVydGllcyBmcm9tIE1ldGFkYXRhIE1hbmFnZXJcIiwgZSk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBHZXQgVHlwZXMgZnJvbSBNZXRhZGF0YU1hbmFnZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRUeXBlc0Zyb21NZXRhZGF0YU1hbmFnZXIoYXBwOiBBcHApOiBhbnkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YU1hbmFnZXIgPSAoYXBwIGFzIGFueSkubWV0YWRhdGFUeXBlTWFuYWdlcjtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImdldCB0eXBlczpcIixtZXRhZGF0YU1hbmFnZXIpO1xyXG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKG1ldGFkYXRhTWFuYWdlci5yZWdpc3RlcmVkVHlwZVdpZGdldHMpLm1hcCggKHZhbHVlOmFueSwgaW5kZXgsIGFycmF5KTpQcm9wZXJ0eVR5cGUgID0+ICh7XHJcbiAgICAgICAgICAgIHR5cGU6IHZhbHVlLnR5cGUsXHJcbiAgICAgICAgICAgIGljb246IHZhbHVlLmljb24sXHJcbiAgICAgICAgICAgIGpzVHlwZTogJycsXHJcbiAgICAgICAgfSkpLnNvcnQoKGEsIGIpID0+IGEudHlwZS5sb2NhbGVDb21wYXJlKGIudHlwZSkpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgYWNjZXNzIHByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YSBNYW5hZ2VyXCIsIGUpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogU2FmZSBtZXRob2QgdG8gZ2V0IHJlZ2lzdGVyZWQgcHJvcGVydGllcyB0aGF0IHdvbid0IHRocm93IGlmIEFQSSBjaGFuZ2VzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRSZWdpc3RlcmVkUHJvcGVydGllc1NhZmUoYXBwOiBBcHApOiBQcm9taXNlPFByb3BlcnR5VHlwZUluZm9bXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YU1hbmFnZXIgPSAoYXBwIGFzIGFueSkubWV0YWRhdGFUeXBlTWFuYWdlcjtcclxuICAgICAgICBjb25zb2xlLmxvZyhtZXRhZGF0YU1hbmFnZXIpO1xyXG4gICAgICAgIGlmICghbWV0YWRhdGFNYW5hZ2VyKSByZXR1cm4gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVHJ5IGRpZmZlcmVudCB3YXlzIHRvIGdldCBwcm9wZXJ0aWVzIGJhc2VkIG9uIE9ic2lkaWFuIHZlcnNpb25cclxuICAgICAgICBpZiAodHlwZW9mIG1ldGFkYXRhTWFuYWdlci5nZXRBbGxGcm9udG1hdHRlclR5cGVzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIC8vIE9sZGVyIE9ic2lkaWFuIHZlcnNpb25zXHJcbiAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyVHlwZXMgPSBtZXRhZGF0YU1hbmFnZXIuZ2V0QWxsRnJvbnRtYXR0ZXJUeXBlcygpO1xyXG4gICAgICAgICAgICByZXR1cm4gZnJvbnRtYXR0ZXJUeXBlcy5tYXAoKG5hbWU6IHN0cmluZykgPT4gKHtcclxuICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnc3RyaW5nJywgLy8gRGVmYXVsdCB0eXBlIGlmIHdlIGNhbid0IGdldCBtb3JlIGluZm9cclxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXRhZGF0YU1hbmFnZXIuZ2V0UHJvcGVydGllcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAvLyBOZXdlciBPYnNpZGlhbiB2ZXJzaW9ucyBtaWdodCB1c2UgdGhpc1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbWV0YWRhdGFNYW5hZ2VyLmdldFByb3BlcnRpZXMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpLm1hcCgoW25hbWUsIHR5cGVdOiBbc3RyaW5nLCBhbnldKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJyA/IHR5cGUgOiAnc3RyaW5nJyxcclxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGFjY2VzcyByZWdpc3RlcmVkIHByb3BlcnRpZXM6XCIsIGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtdO1xyXG59XHJcblxyXG4vKipcclxuICogU2NhbnMgZmlsZXMgZm9yIGFkZGl0aW9uYWwgcHJvcGVydGllcyB3aXRoIHR5cGUgaW5mZXJlbmNlXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRQcm9wZXJ0aWVzRnJvbUZpbGVzKGFwcDogQXBwKTogUHJvbWlzZTxQcm9wZXJ0eVR5cGVJbmZvW10+IHtcclxuICAgIGNvbnN0IGZpbGVzID0gYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgIGNvbnN0IHByb3BlcnR5TWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgdmFsdWVzOiBTZXQ8YW55PiwgdHlwZXM6IFNldDxzdHJpbmc+IH0+KCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcy5zbGljZSgwLCAxMDAwKSkgeyAvLyBMaW1pdCB0byAxMDAwIGZpbGVzIGZvciBwZXJmb3JtYW5jZVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjYWNoZS5mcm9udG1hdHRlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAncG9zaXRpb24nKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnR5TWFwLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5TWFwLnNldChrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogbmV3IFNldCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXM6IG5ldyBTZXQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcERhdGEgPSBwcm9wZXJ0eU1hcC5nZXQoa2V5KSE7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcERhdGEudmFsdWVzLmFkZCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcERhdGEudHlwZXMuYWRkKGluZmVyVHlwZUZyb21WYWx1ZSh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShwcm9wZXJ0eU1hcC5lbnRyaWVzKCkpLm1hcCgoW25hbWUsIGRhdGFdKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IGRldGVybWluZVByaW1hcnlUeXBlKGRhdGEudHlwZXMpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgICAgIGlzQXJyYXk6IGRhdGEudHlwZXMuaGFzKCdhcnJheScpLFxyXG4gICAgICAgICAgICB2YWx1ZXM6IGRhdGEudmFsdWVzLnNpemUgPiAwID8gQXJyYXkuZnJvbShkYXRhLnZhbHVlcykubWFwKFN0cmluZykgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHNvdXJjZTogJ2luZmVycmVkJ1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERldGVybWluZXMgdGhlIHByaW1hcnkgdHlwZSBmcm9tIGEgU2V0IG9mIG9ic2VydmVkIHR5cGVzXHJcbiAqIEBwYXJhbSB0eXBlcyBTZXQgb2Ygb2JzZXJ2ZWQgdHlwZXMgZm9yIGEgcHJvcGVydHlcclxuICogQHJldHVybnMgVGhlIG1vc3Qgc3BlY2lmaWMgdHlwZSB3ZSBjYW4gZGV0ZXJtaW5lXHJcbiAqL1xyXG5mdW5jdGlvbiBkZXRlcm1pbmVQcmltYXJ5VHlwZSh0eXBlczogU2V0PHN0cmluZz4pOiBzdHJpbmcge1xyXG4gICAgLy8gSGFuZGxlIGVtcHR5IGNhc2UgKHNob3VsZG4ndCBoYXBwZW4gYnV0IFR5cGVTY3JpcHQgd2FudHMgdXMgdG8gY2hlY2spXHJcbiAgICBpZiAodHlwZXMuc2l6ZSA9PT0gMCkgcmV0dXJuICdzdHJpbmcnO1xyXG4gICAgXHJcbiAgICAvLyBJZiBvbmx5IG9uZSB0eXBlIG9ic2VydmVkLCB1c2UgdGhhdFxyXG4gICAgaWYgKHR5cGVzLnNpemUgPT09IDEpIHJldHVybiB0eXBlcy52YWx1ZXMoKS5uZXh0KCkudmFsdWU7XHJcbiAgICBcclxuICAgIC8vIFByaW9yaXR5IG9yZGVyIGZvciB0eXBlIHJlc29sdXRpb25cclxuICAgIGNvbnN0IHR5cGVQcmlvcml0eSA9IFtcclxuICAgICAgICAnZGF0ZScsXHJcbiAgICAgICAgJ2RhdGV0aW1lJyxcclxuICAgICAgICAnYm9vbGVhbicsXHJcbiAgICAgICAgJ251bWJlcicsXHJcbiAgICAgICAgJ2FycmF5JyxcclxuICAgICAgICAnbXVsdGl0ZXh0JyxcclxuICAgICAgICAnc3RyaW5nJyAvLyBmYWxsYmFja1xyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIHRoZSBoaWdoZXN0IHByaW9yaXR5IHR5cGUgd2UgZmluZFxyXG4gICAgZm9yIChjb25zdCB0eXBlIG9mIHR5cGVQcmlvcml0eSkge1xyXG4gICAgICAgIGlmICh0eXBlcy5oYXModHlwZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGaW5hbCBmYWxsYmFja1xyXG4gICAgcmV0dXJuICdzdHJpbmcnO1xyXG59XHJcblxyXG4vKipcclxuICogRW5oYW5jZWQgdHlwZSBpbmZlcmVuY2Ugd2l0aCBiZXR0ZXIgZGF0ZSBkZXRlY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIGluZmVyVHlwZUZyb21WYWx1ZSh2YWx1ZTogYW55KTogc3RyaW5nIHtcclxuICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuICdudWxsJztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgYXJyYXkgZmlyc3RcclxuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIGFycmF5IGVsZW1lbnQgdHlwZXNcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudFR5cGVzID0gbmV3IFNldCh2YWx1ZS5tYXAoaW5mZXJUeXBlRnJvbVZhbHVlKSk7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50VHlwZXMuc2l6ZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGBhcnJheTwke2VsZW1lbnRUeXBlcy52YWx1ZXMoKS5uZXh0KCkudmFsdWV9PmA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICdhcnJheSc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGJhc2ljIHR5cGVzXHJcbiAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xyXG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOiByZXR1cm4gJ2Jvb2xlYW4nO1xyXG4gICAgICAgIGNhc2UgJ251bWJlcic6IHJldHVybiAnbnVtYmVyJztcclxuICAgICAgICBjYXNlICdvYmplY3QnOiByZXR1cm4gJ29iamVjdCc7IC8vIGZvciBmdXR1cmUgZXhwYW5zaW9uXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIE11c3QgYmUgc3RyaW5nIGF0IHRoaXMgcG9pbnQgLSBjaGVjayBmb3Igc3BlY2lhbCBzdHJpbmcgZm9ybWF0c1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAvLyBJU08gRGF0ZSAoWVlZWS1NTS1ERClcclxuICAgICAgICBpZiAoL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvLnRlc3QodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnZGF0ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIElTTyBEYXRlVGltZVxyXG4gICAgICAgIGlmICgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9W1QgXVxcZHsyfTpcXGR7Mn06XFxkezJ9Ly50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2RhdGV0aW1lJztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gT2JzaWRpYW4gdGFnXHJcbiAgICAgICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoJyMnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3RhZyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEZWZhdWx0IHRvIHN0cmluZ1xyXG4gICAgcmV0dXJuICdzdHJpbmcnO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWx1ZSh2YWx1ZTogdW5rbm93biwgaW5kZXg6IG51bWJlciwgYXJyYXk6IHVua25vd25bXSk6IHVua25vd24ge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQuJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTZWxlY3RQcm9wZXJ0eSBleHRlbmRzIFN1Z2dlc3RNb2RhbDxQcm9wZXJ0eVR5cGVJbmZvPiB7XHJcbiAgICBwcml2YXRlIG9uU3VibWl0OiAocmVzdWx0OiBQcm9wZXJ0eVR5cGVJbmZvKSA9PiB2b2lkO1xyXG4gICAgcHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8gfCB1bmRlZmluZWQ7XHJcbiAgICBrbm93blByb3BlcnRpZXM6UHJvcGVydHlUeXBlSW5mb1tdO1xyXG4gICAgdHlwZWRUZXh0OiBzdHJpbmc7XHJcbiAgICBuZXdUZXh0RmxhZzogQm9vbGVhbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoYXBwOkFwcCwga25vd25Qcm9wZXJ0aWVzOlByb3BlcnR5VHlwZUluZm9bXSwgcHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8gfCB1bmRlZmluZWQsIG9uU3VibWl0OiAocmVzdWx0OiBQcm9wZXJ0eVR5cGVJbmZvKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0eSA9IHByb3BlcnR5O1xyXG4gICAgICAgIHRoaXMudHlwZWRUZXh0ID0gJyc7XHJcbiAgICAgICAgdGhpcy5uZXdUZXh0RmxhZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSBrbm93blByb3BlcnRpZXM7XHJcbiAgICB9XHJcbiAgICAvLyBSZXR1cm5zIGFsbCBhdmFpbGFibGUgc3VnZ2VzdGlvbnMuXHJcbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogUHJvcGVydHlUeXBlSW5mb1tdIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmtub3duUHJvcGVydGllcy5maWx0ZXIoKHByb3BlcnR5KSA9PiBwcm9wZXJ0eS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpO1xyXG4gICAgICAgIHRoaXMubmV3VGV4dEZsYWcgPSAocmVzdWx0Lmxlbmd0aCA9PT0gMCk7XHJcbiAgICAgICAgdGhpcy50eXBlZFRleHQgPSBxdWVyeTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgb25PcGVuKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIodGhpcy5wcm9wZXJ0eS5uYW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKCdubyBwcm9wZXJ0eSBzZWxlY3RlZCEnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRUaXRsZSgnU2VsZWN0IG9yIHR5cGUgYSBwcm9wZXJ0eSBuYW1lJyk7XHJcbiAgICB9XHJcbiAgICAvLyBSZW5kZXJzIGVhY2ggc3VnZ2VzdGlvbiBpdGVtLlxyXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbywgZWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgIGVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IHByb3BlcnR5Lm5hbWUgfSk7XHJcbiAgICAgIGVsLmNyZWF0ZUVsKCdzbWFsbCcsIHsgdGV4dDogcHJvcGVydHkudHlwZSB9KTtcclxuICAgIH1cclxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV3VGV4dEZsYWcgJiYgdGhpcy5wcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BlcnR5Lm5hbWUgPSB0aGlzLnR5cGVkVGV4dDtcclxuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS50eXBlID0gJ3RleHQnO1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMucHJvcGVydHkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cclxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGlmIChldnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBrZXlib2FyZCAke3RoaXMudHlwZWRUZXh0fSAke3RoaXMubmV3VGV4dEZsYWd9YCwgcHJvcGVydHkpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdvbkNob29zZVN1Z2dlc3Rpb24nLCBldnQpXHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdChwcm9wZXJ0eSk7XHJcbiAgICB9XHJcbiAgfVxyXG4iLCAiaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJ1xyXG4vKipcclxuICogUGFyc2UgYSBKYXZhU2NyaXB0IGZ1bmN0aW9uLCBjbGVhbiBjb21tZW50cyBhbmQgZGVmaW5lIHRoZSBmdW5jdGlvbiBcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge3N0cmluZ30ganNDb2RlXHJcbiAqIEByZXR1cm4geyp9ICB7KEZ1bmN0aW9uIHwgc3RyaW5nIHwgdW5kZWZpbmVkKX1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpTQ29kZShqc0NvZGU6c3RyaW5nKTogRnVuY3Rpb24gfCBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgZnVuY3Rpb24gcGFyc2VGdW5jdGlvbiAoanNDb2RlOiBzdHJpbmcpOiBGdW5jdGlvbiB8IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICBqc0NvZGUgPSBjbGVhbkNvZGVTdHJpbmcoanNDb2RlKTtcclxuICAgICAgICB2YXIgZnVuY1JlZyA9IC9mdW5jdGlvbiAqXFwoKFteKCldKilcXClbIFxcblxcdF0qeyguKil9L2dtaTtcclxuICAgICAgICB2YXIgbWF0Y2ggPSBmdW5jUmVnLmV4ZWMoanNDb2RlLnJlcGxhY2UoL1xcbi9nLCAnICcpKTtcclxuICAgICAgICBpZiAoIW1hdGNoKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIHZhciBhcmdzID0gbWF0Y2hbMV0uc3BsaXQoJywnKTtcclxuICAgICAgICBhcmdzLnB1c2gobWF0Y2hbMl0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oLi4uYXJncyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignZXJyb3IgcGFyc2luZyBKUyBmdW5jdGlvbiEnLCBlcnJvcik7XHJcbiAgICAgICAgICAgIHJldHVybiBlcnJvci5tZXNzYWdlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gcGFyc2VGdW5jdGlvbihqc0NvZGUpO1xyXG59XHJcblxyXG4vKipcclxuICogQ2xlYW5zIGEgSmF2YVNjcmlwdC9UeXBlU2NyaXB0IGNvZGUgc3RyaW5nIGJ5IHJlbW92aW5nIGNvbW1lbnRzLlxyXG4gKiBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgYm90aCBzaW5nbGUtbGluZSBjb21tZW50cyAoYC8vIC4uLmApIGFuZFxyXG4gKiBtdWx0aS1saW5lIGNvbW1lbnRzIChgLyogLi4uICpcXC9gKS4gSXQgYWxzbyBjb3JyZWN0bHkgaGFuZGxlc1xyXG4gKiBjb21tZW50cyB3aXRoaW4gc3RyaW5ncyBhbmQgcmVndWxhciBleHByZXNzaW9ucy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IGNvZGVTdHJpbmcgVGhlIGNvZGUgc3RyaW5nIHRvIGNsZWFuLlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY2xlYW5lZCBjb2RlIHN0cmluZyB3aXRoIGNvbW1lbnRzIHJlbW92ZWQuXHJcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gSWYgdGhlIGlucHV0IGlzIG5vdCBhIHN0cmluZy5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkNvZGVTdHJpbmcoY29kZVN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIC8vIEVuc3VyZSB0aGUgaW5wdXQgaXMgYSBzdHJpbmdcclxuICAgIGlmICh0eXBlb2YgY29kZVN0cmluZyAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW5wdXQgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuICAgIH1cclxuICBcclxuICAgIC8vIEZsYWdzIHRvIHRyYWNrIHRoZSBjdXJyZW50IHBhcnNpbmcgY29udGV4dFxyXG4gICAgbGV0IGluTXVsdGlMaW5lQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgbGV0IGluU2luZ2xlTGluZUNvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGxldCBpblN0cmluZzogJ1wiJyB8IFwiJ1wiIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrcyBpZiBpbnNpZGUgc2luZ2xlIG9yIGRvdWJsZSBxdW90ZXNcclxuICAgIGxldCBpblJlZ0V4cDogYm9vbGVhbiA9IGZhbHNlOyAvLyBUcmFja3MgaWYgaW5zaWRlIGEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWxcclxuICBcclxuICAgIC8vIFRoZSByZXN1bHRpbmcgc3RyaW5nIHdpdGhvdXQgY29tbWVudHNcclxuICAgIGxldCBjbGVhbmVkQ29kZTogc3RyaW5nID0gJyc7XHJcbiAgICAvLyBDdXJyZW50IGluZGV4IGluIHRoZSBpbnB1dCBzdHJpbmdcclxuICAgIGxldCBpOiBudW1iZXIgPSAwO1xyXG4gIFxyXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBpbnB1dCBzdHJpbmcgY2hhcmFjdGVyIGJ5IGNoYXJhY3RlclxyXG4gICAgd2hpbGUgKGkgPCBjb2RlU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICBjb25zdCBjaGFyOiBzdHJpbmcgPSBjb2RlU3RyaW5nW2ldO1xyXG4gICAgICBjb25zdCBuZXh0Q2hhcjogc3RyaW5nIHwgdW5kZWZpbmVkID0gY29kZVN0cmluZ1tpICsgMV07IC8vIFVzZSB1bmRlZmluZWQgZm9yIHBvdGVudGlhbCBlbmQgb2Ygc3RyaW5nXHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgbXVsdGktbGluZSBjb21tZW50IC0tLVxyXG4gICAgICBpZiAoaW5NdWx0aUxpbmVDb21tZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBlbmQgb2YgdGhlIG11bHRpLWxpbmUgY29tbWVudCAnKi8nXHJcbiAgICAgICAgaWYgKGNoYXIgPT09ICcqJyAmJiBuZXh0Q2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICBpbk11bHRpTGluZUNvbW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAgIGkgKz0gMjsgLy8gU2tpcCB0aGUgJyovJ1xyXG4gICAgICAgICAgY29udGludWU7IC8vIE1vdmUgdG8gdGhlIG5leHQgaXRlcmF0aW9uXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGkrKzsgLy8gU2tpcCB0aGUgY2hhcmFjdGVyIGluc2lkZSB0aGUgY29tbWVudFxyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgc2luZ2xlLWxpbmUgY29tbWVudCAtLS1cclxuICAgICAgaWYgKGluU2luZ2xlTGluZUNvbW1lbnQpIHtcclxuICAgICAgICAvLyBDaGVjayBmb3IgdGhlIGVuZCBvZiB0aGUgbGluZSAobmV3bGluZSBvciBjYXJyaWFnZSByZXR1cm4pXHJcbiAgICAgICAgaWYgKGNoYXIgPT09ICdcXG4nIHx8IGNoYXIgPT09ICdcXHInKSB7XHJcbiAgICAgICAgICBpblNpbmdsZUxpbmVDb21tZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBLZWVwIHRoZSBuZXdsaW5lIGNoYXJhY3RlclxyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGkrKzsgLy8gU2tpcCB0aGUgY2hhcmFjdGVyIGluc2lkZSB0aGUgY29tbWVudFxyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgc3RyaW5nIGxpdGVyYWwgLS0tXHJcbiAgICAgIGlmIChpblN0cmluZykge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IGNoYXJhY3RlciBjbG9zZXMgdGhlIHN0cmluZ1xyXG4gICAgICAgIGlmIChjaGFyID09PSBpblN0cmluZykge1xyXG4gICAgICAgICAgaW5TdHJpbmcgPSBudWxsOyAvLyBFeGl0IHN0cmluZyBzdGF0ZVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAvLyBIYW5kbGUgZXNjYXBlZCBjaGFyYWN0ZXJzIHdpdGhpbiBzdHJpbmdzIChlLmcuLCBcIml0XFwnc1wiKVxyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBiYWNrc2xhc2hcclxuICAgICAgICAgIGkrKzsgLy8gTW92ZSB0byB0aGUgbmV4dCBjaGFyYWN0ZXIgKHRoZSBlc2NhcGVkIG9uZSlcclxuICAgICAgICAgIGlmIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNvZGVTdHJpbmdbaV07IC8vIEFkZCB0aGUgZXNjYXBlZCBjaGFyYWN0ZXJcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgdGhlIGNoYXJhY3RlciB0byB0aGUgcmVzdWx0IGlmIGl0J3MgcGFydCBvZiB0aGUgc3RyaW5nXHJcbiAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICBpKys7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWwgLS0tXHJcbiAgICAgICBpZiAoaW5SZWdFeHApIHtcclxuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IGNoYXJhY3RlciBjbG9zZXMgdGhlIHJlZ2V4IGxpdGVyYWxcclxuICAgICAgICAgIC8vIE5vdGU6IFRoaXMgZG9lc24ndCBoYW5kbGUgcmVnZXggZmxhZ3MgcGVyZmVjdGx5IGJ1dCBjb3ZlcnMgYmFzaWMgY2FzZXMuXHJcbiAgICAgICAgICBpZiAoY2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgaW5SZWdFeHAgPSBmYWxzZTsgLy8gRXhpdCByZWdleCBzdGF0ZVxyXG4gICAgICAgICAgfSBlbHNlIGlmIChjaGFyID09PSAnXFxcXCcpIHtcclxuICAgICAgICAgICAgICAvLyBIYW5kbGUgZXNjYXBlZCBjaGFyYWN0ZXJzIHdpdGhpbiByZWdleCAoZS5nLiwgL1xcLy8pXHJcbiAgICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBiYWNrc2xhc2hcclxuICAgICAgICAgICAgICBpKys7IC8vIE1vdmUgdG8gdGhlIG5leHQgY2hhcmFjdGVyXHJcbiAgICAgICAgICAgICAgaWYgKGkgPCBjb2RlU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNvZGVTdHJpbmdbaV07IC8vIEFkZCB0aGUgZXNjYXBlZCBjaGFyYWN0ZXJcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gQWRkIHRoZSBjaGFyYWN0ZXIgdG8gdGhlIHJlc3VsdCBpZiBpdCdzIHBhcnQgb2YgdGhlIHJlZ2V4XHJcbiAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBEZWZhdWx0IFN0YXRlOiBDaGVjayBmb3IgY29tbWVudC9zdHJpbmcvcmVnZXggc3RhcnRzIC0tLVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgbXVsdGktbGluZSBjb21tZW50ICcvKidcclxuICAgICAgaWYgKGNoYXIgPT09ICcvJyAmJiBuZXh0Q2hhciA9PT0gJyonKSB7XHJcbiAgICAgICAgaW5NdWx0aUxpbmVDb21tZW50ID0gdHJ1ZTtcclxuICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcvKidcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgc2luZ2xlLWxpbmUgY29tbWVudCAnLy8nXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycgJiYgbmV4dENoYXIgPT09ICcvJykge1xyXG4gICAgICAgIGluU2luZ2xlTGluZUNvbW1lbnQgPSB0cnVlO1xyXG4gICAgICAgIGkgKz0gMjsgLy8gU2tpcCB0aGUgJy8vJ1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSBzdHJpbmcgbGl0ZXJhbCAoJyBvciBcIilcclxuICAgICAgaWYgKGNoYXIgPT09ICdcIicgfHwgY2hhciA9PT0gXCInXCIpIHtcclxuICAgICAgICBpblN0cmluZyA9IGNoYXI7IC8vIEVudGVyIHN0cmluZyBzdGF0ZSwgcmVtZW1iZXJpbmcgdGhlIHF1b3RlIHR5cGVcclxuICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBBZGQgdGhlIG9wZW5pbmcgcXVvdGVcclxuICAgICAgICBpKys7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsICcvJ1xyXG4gICAgICAvLyBCYXNpYyBjaGVjazogYXNzdW1lcyAnLycgaW5kaWNhdGVzIGEgcmVnZXggc3RhcnQgaWYgbm90IHByZWNlZGVkIGJ5IG9wZXJhdG9ycy9rZXl3b3Jkc1xyXG4gICAgICAvLyBBIG1vcmUgcm9idXN0IHNvbHV0aW9uIHdvdWxkIHJlcXVpcmUgbW9yZSBjb21wbGV4IHBhcnNpbmcuXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycpIHtcclxuICAgICAgICAgIC8vIFZlcnkgYmFzaWMgY2hlY2sgdG8gZGlmZmVyZW50aWF0ZSBkaXZpc2lvbiBmcm9tIHJlZ2V4IHN0YXJ0LlxyXG4gICAgICAgICAgLy8gVGhpcyBtaWdodCBuZWVkIHJlZmluZW1lbnQgZm9yIGNvbXBsZXggY2FzZXMuXHJcbiAgICAgICAgICBjb25zdCBwcmV2TWVhbmluZ2Z1bENoYXIgPSBjbGVhbmVkQ29kZS50cmltKCkuc2xpY2UoLTEpO1xyXG4gICAgICAgICAgaWYgKHByZXZNZWFuaW5nZnVsQ2hhciA9PT0gJycgfHwgWycoJywgJywnLCAnPScsICc6JywgJ1snLCAnIScsICcmJywgJ3wnLCAnPycsICd7JywgJzsnLCAnXFxuJywgJ1xcciddLmluY2x1ZGVzKHByZXZNZWFuaW5nZnVsQ2hhcikpIHtcclxuICAgICAgICAgICAgICBpblJlZ0V4cCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gSWYgbm9uZSBvZiB0aGUgYWJvdmUsIGl0J3MgcmVndWxhciBjb2RlOyBhZGQgaXQgdG8gdGhlIHJlc3VsdFxyXG4gICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICBpKys7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvLyBSZXR1cm4gdGhlIGFjY3VtdWxhdGVkIGNsZWFuZWQgY29kZSBzdHJpbmdcclxuICAgIHJldHVybiBjbGVhbmVkQ29kZTtcclxuICB9XHJcblxyXG5cclxuICBleHBvcnQgY2xhc3MgU2NyaXB0aW5nVG9vbHMge1xyXG4gICAgc2V0dGluZ3M6IEZvbGRlclRhZ1NldHRpbmdzIHwgdW5kZWZpbmVkO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzPzogRm9sZGVyVGFnU2V0dGluZ3MgfCB1bmRlZmluZWQpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgc3RyaW5nIGNvbXBsaWVzIHdpdGggSVNPIFN0YW5kYXJkXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBzdHIgQW55IHN0cmluZ1xyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgT3B0aW9ucyB0byBsb29rIGZvclxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIGlzSVNPU3RyaW5nKFxyXG4gICAgICBzdHI6IHN0cmluZyxcclxuICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgIHdpdGhNaWxsaXNlY29uZHM/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhUaW1lem9uZT86IGJvb2xlYW47XHJcbiAgICAgICAgd2l0aFRpbWU/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhEYXRlPzogYm9vbGVhbjsgXHJcbiAgICAgIH0gPSB7fVxyXG4gICAgKTogYm9vbGVhbiB7XHJcbiAgICAgIGNvbnN0IHtcclxuICAgICAgICB3aXRoTWlsbGlzZWNvbmRzID0gZmFsc2UsXHJcbiAgICAgICAgd2l0aFRpbWV6b25lID0gZmFsc2UsXHJcbiAgICAgICAgd2l0aFRpbWUgPSB0cnVlLFxyXG4gICAgICAgIHdpdGhEYXRlID0gdHJ1ZSwgXHJcbiAgICAgIH0gPSBvcHRpb25zO1xyXG4gICAgXHJcbiAgICAgIGxldCBkYXRlUmVnZXhTdHIgPSBcIl4oPzpcXFxcZHs0fS0oPzowWzEtOV18MVswLTJdKS0oPzowWzEtOV18WzEyXVxcXFxkfDNbMDFdKSlcIjtcclxuICAgICAgbGV0IHRpbWVSZWdleFN0ciA9IFwiKD86VCg/OlswMV1cXFxcZHwyWzAtM10pOlswLTVdXFxcXGQ6WzAtNV1cXFxcZFwiO1xyXG4gICAgXHJcbiAgICAgIGlmICh3aXRoTWlsbGlzZWNvbmRzKSB7XHJcbiAgICAgICAgdGltZVJlZ2V4U3RyICs9IFwiXFxcXC5cXFxcZHszfVwiO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgaWYgKHdpdGhUaW1lem9uZSkge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIig/Olp8WystXSg/OlswMV1cXFxcZHwyWzAtM10pOlswLTVdXFxcXGQpPyk/XCI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGltZVJlZ2V4U3RyICs9IFwiKT9cIjtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGxldCByZWdleFN0ciA9IFwiXCI7XHJcbiAgICAgIGlmICh3aXRoRGF0ZSAmJiB3aXRoVGltZSkge1xyXG4gICAgICAgIHJlZ2V4U3RyID0gYCR7ZGF0ZVJlZ2V4U3RyfSR7dGltZVJlZ2V4U3RyfSRgO1xyXG4gICAgICB9IGVsc2UgaWYgKHdpdGhEYXRlKSB7XHJcbiAgICAgICAgcmVnZXhTdHIgPSBgJHtkYXRlUmVnZXhTdHJ9JGA7XHJcbiAgICAgIH0gZWxzZSBpZiAod2l0aFRpbWUpIHtcclxuICAgICAgICByZWdleFN0ciA9IGBeJHt0aW1lUmVnZXhTdHIuc2xpY2UoNCl9JGA7IFxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTsgXHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocmVnZXhTdHIpO1xyXG4gICAgICByZXR1cm4gcmVnZXgudGVzdChzdHIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUcnkgdG8gY29udmVydCBBbnkgVHlwZXMgdG8gYSBzcGVjaWZpYyBUeXBlXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgXHJcbiAgICAgKiBAcGFyYW0gdHlwZVN0cmluZyAnc3RyaW5nJyB8ICdudW1iZXInIHwgJ2Jvb2xlYW4nIHwgJ3N0cmluZ1tdJ1xyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHRyeUNvbnZlcnQoaW5wdXQ6IGFueSwgdHlwZVN0cmluZzogJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJyB8ICdzdHJpbmdbXScpOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuIHwgc3RyaW5nW10gfCB1bmRlZmluZWQge1xyXG4gICAgICBzd2l0Y2ggKHR5cGVTdHJpbmcpIHtcclxuICAgICAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgICAgY29uc3QgbnVtID0gTnVtYmVyKGlucHV0KTtcclxuICAgICAgICAgIGlmICghaXNOYU4obnVtKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjYXNlICdib29sZWFuJzpcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbG93ZXJWYWx1ZSA9IGlucHV0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgaWYgKGxvd2VyVmFsdWUgPT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChsb3dlclZhbHVlID09PSAnZmFsc2UnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGlucHV0ID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKGlucHV0ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nW10nOlxyXG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpICYmIGlucHV0LmV2ZXJ5KGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZvcm1hdFRvWUFNTFNhdmVTdHJpbmcodGV4dDpzdHJpbmcsIHJlcGxhY2VCeTpzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOnN0cmluZyB7XHJcbiAgICAgIGxldCByZXBsYWNlU3RyaW5nID0gJy0nO1xyXG4gICAgICBpZiAoIXJlcGxhY2VCeSAmJiB0aGlzLnNldHRpbmdzKSB7XHJcbiAgICAgICAgcmVwbGFjZVN0cmluZyA9IHRoaXMuc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCB8fCAnLSc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHJlcGxhY2VCeSkgcmVwbGFjZVN0cmluZyA9IHJlcGxhY2VCeTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHJlcGxhY2VTdHJpbmcpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIGEgc3RyaW5nIHRvIGEgWUFNTC1zYWZlIGZvcm1hdCBieSBhZGRpbmcgcXVvdGVzIHdoZW4gbmVjZXNzYXJ5LlxyXG4gICAgICogQHBhcmFtIGlucHV0IFRoZSBzdHJpbmcsIGJvb2xlYW4sIG51bWJlciBvciBhcnJheSB0byBtYWtlIFlBTUwtc2FmZVxyXG4gICAgICogQHJldHVybnMgVGhlIHNhZmVseSBxdW90ZWQgc3RyaW5nIHdoZW4gbmVlZGVkLCBvciB0aGUgb3JpZ2luYWwgc3RyaW5nIGlmIHNhZmVcclxuICAgICAqL1xyXG4gICAgdG9ZYW1sU2FmZVN0cmluZyhpbnB1dDogc3RyaW5nfG51bWJlcnxib29sZWFufHN0cmluZ1tdKTogc3RyaW5nfG51bWJlcnxzdHJpbmdbXSB7XHJcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSkge1xyXG4gICAgICAgIGlucHV0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICBpbnB1dFtpbmRleF0gPSB0aGlzLnRvWWFtbFNhZmVTdHJpbmcoaXRlbSkudG9TdHJpbmcoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgfVxyXG4gICAgICBzd2l0Y2ggKHR5cGVvZiBpbnB1dCkge1xyXG4gICAgICAgIGNhc2UgJ251bWJlcic6IHJldHVybiBpbnB1dDtcclxuICAgICAgICBjYXNlICdib29sZWFuJzogcmV0dXJuIGlucHV0ID8gJ3RydWUnIDogJ2ZhbHNlJztcclxuICAgICAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICAgICAgLy8gVHJpbSB3aGl0ZXNwYWNlIGZpcnN0XHJcbiAgICAgICAgICBjb25zdCB0cmltbWVkID0gaW5wdXQudHJpbSgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBFbXB0eSBzdHJpbmdzIG5lZWQgcXVvdGVzXHJcbiAgICAgICAgICBpZiAodHJpbW1lZCA9PT0gJycpIHJldHVybiAnXCJcIic7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIENoZWNrIGZvciBzcGVjaWFsIGNoYXJhY3RlcnMvcGF0dGVybnMgdGhhdCByZXF1aXJlIHF1b3RpbmdcclxuICAgICAgICAgIGNvbnN0IG5lZWRzUXVvdGVzID0gL1s6e31cXFtcXF0sJiojP3w8Pj0hJUBgXCInXFxcXF18XlstP1xcbl18W1xcc1xcbl18Xlt5WW5OXXxeWzAtOV18XlsrLV18Xih0cnVlfGZhbHNlfHllc3xub3xvbnxvZmYpJC9pLnRlc3QodHJpbW1lZCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzdHJpbmcgaXMgYWxyZWFkeSBwcm9wZXJseSBxdW90ZWRcclxuICAgICAgICAgIGNvbnN0IGlzQWxyZWFkeVF1b3RlZCA9ICh0cmltbWVkLnN0YXJ0c1dpdGgoJ1wiJykgJiYgdHJpbW1lZC5lbmRzV2l0aCgnXCInKSkgfHwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRyaW1tZWQuc3RhcnRzV2l0aChcIidcIikgJiYgdHJpbW1lZC5lbmRzV2l0aChcIidcIikpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIW5lZWRzUXVvdGVzICYmICFpc0FscmVhZHlRdW90ZWQpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdHJpbW1lZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gSWYgd2UgZ2V0IGhlcmUsIHdlIG5lZWQgcXVvdGVzXHJcbiAgICAgICAgICAvLyBVc2UgZG91YmxlIHF1b3RlcyBhbmQgZXNjYXBlIGFueSBleGlzdGluZyBkb3VibGUgcXVvdGVzXHJcbiAgICAgICAgICBpZiAoIWlzQWxyZWFkeVF1b3RlZCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBgXCIke3RyaW1tZWQucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpfVwiYDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gSWYgYWxyZWFkeSBxdW90ZWQsIHJldHVybiBhcy1pc1xyXG4gICAgICAgICAgcmV0dXJuIHRyaW1tZWQ7XHJcbiAgICAgICAgZGVmYXVsdDogXHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGB0b1lhbWxTYWZlU3RyaW5nKCR7aW5wdXR9KSBpZiBvZiB0eXBlICcke3R5cGVvZiBpbnB1dH0nYCk7XHJcbiAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXBsYWNlU3BhY2VzKHRleHQ6c3RyaW5nLCByZXBsYWNlQnk6c3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkKTpzdHJpbmcge1xyXG4gICAgICBsZXQgcmVwbGFjZVN0cmluZyA9ICdfJztcclxuICAgICAgaWYgKCFyZXBsYWNlQnkgJiYgdGhpcy5zZXR0aW5ncykge1xyXG4gICAgICAgIHJlcGxhY2VTdHJpbmcgPSB0aGlzLnNldHRpbmdzLnNwYWNlUmVwbGFjZW1lbnQgfHwgJ18nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChyZXBsYWNlQnkpIHJlcGxhY2VTdHJpbmcgPSByZXBsYWNlQnk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvXFxzKy9nLCByZXBsYWNlU3RyaW5nKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3JtYXRDYW1lbENhc2UodGV4dDpzdHJpbmcpOnN0cmluZyB7XHJcbiAgICAgIGxldCB0ZXh0UGFydHMgPSB0ZXh0LnNwbGl0KCcgJyk7XHJcbiAgICAgIGxldCBjb252ZXJ0ZWRUZXh0UGFydHM6c3RyaW5nW10gPSBbXTtcclxuICAgICAgdGV4dFBhcnRzLmZvckVhY2goKHRleHQsaW5kZXgpID0+IHtcclxuICAgICAgICBsZXQgbmV3VGV4dFBhcnQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKGluZGV4PjApIG5ld1RleHRQYXJ0ID0gbmV3VGV4dFBhcnQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuZXdUZXh0UGFydC5zbGljZSgxKTtcclxuICAgICAgICBjb252ZXJ0ZWRUZXh0UGFydHMucHVzaChuZXdUZXh0UGFydCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gY29udmVydGVkVGV4dFBhcnRzLmpvaW4oJycpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdFVwcGVyQ2FtZWxDYXNlKHRleHQ6c3RyaW5nKTpzdHJpbmcge1xyXG4gICAgICBsZXQgdGV4dFBhcnRzID0gdGV4dC5zcGxpdCgnICcpO1xyXG4gICAgICBsZXQgY29udmVydGVkVGV4dFBhcnRzOnN0cmluZ1tdID0gW107XHJcbiAgICAgIHRleHRQYXJ0cy5mb3JFYWNoKCh0ZXh0LGluZGV4KSA9PiB7XHJcbiAgICAgICAgbGV0IG5ld1RleHRQYXJ0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIG5ld1RleHRQYXJ0ID0gbmV3VGV4dFBhcnQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuZXdUZXh0UGFydC5zbGljZSgxKTtcclxuICAgICAgICBjb252ZXJ0ZWRUZXh0UGFydHMucHVzaChuZXdUZXh0UGFydCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gY29udmVydGVkVGV4dFBhcnRzLmpvaW4oJycpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBnZXQgdGhlIHBhdGggdG8gYSBmaWxlIGZyb20gYSBzdHJpbmcgY29udGFpbmluZyB0aGUgZnVsbCBwYXJoL25hbWUgc3RyaW5nXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBzZXBhcmF0b3Igc3RyaW5nIGRlZmF1bHRzIHRvICcvJ1xyXG4gICAgICogQHJldHVybnMgc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIGdldEZvbGRlcnNGcm9tUGF0aCAocGF0aDpzdHJpbmd8bnVsbHx1bmRlZmluZWQsIHNlcGFyYXRvciA9ICcvJykge1xyXG4gICAgICAgIGlmIChwYXRoID09PSBudWxsKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBpZiAocGF0aCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoUGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgY3VycmVudFBhdGhQYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIEZpbGUgbmFtZTtcclxuICAgICAgICByZXR1cm4gY3VycmVudFBhdGhQYXJ0cy5qb2luKHNlcGFyYXRvcik7XHJcbiAgICB9XHJcbiAgfSIsICJpbXBvcnQgeyBBcHAsIHJlbmRlclJlc3VsdHMsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vdG9vbHMnXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJ1bGVGdW5jdGlvbiB7XHJcbiAgICBpZDpzdHJpbmc7XHJcbiAgICBkZXNjcmlwdGlvbjpzdHJpbmc7XHJcbiAgICB0b29sdGlwPzogc3RyaW5nO1xyXG4gICAgc291cmNlOnN0cmluZztcclxuICAgIGZ4OkZ1bmN0aW9uO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcnVsZUZ1bmN0aW9uczpSdWxlRnVuY3Rpb25bXT1bXTtcclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJ1bGVGdW5jdGlvbkJ5SWQgKGlkIDogc3RyaW5nKTpSdWxlRnVuY3Rpb24gfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIHJ1bGVGdW5jdGlvbnMuZmluZChydWxlID0+IHJ1bGUuaWQgPT09IGlkKTtcclxufVxyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidkZWZhdWx0JyxcclxuICAgIGRlc2NyaXB0aW9uOiAnUGFzcyBwYXJhbWV0ZXInLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDogZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2Z1bGxQYXRoJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBwYXRoIGFuZCBmaWxlbmFtZScsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5wYXRoO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDogZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgICAgIHJldHVybiBgJHtmaWxlLnBhdGh9YDtcclxuICAgICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidhbGlhc0Zyb21QYXRoJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnQW4gQWxpYXMgZnJvbSBldmVyeSBmb2xkZXIgb2YgdGhlIGZpbGUgUGF0aCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgbGV0IHBhdGhBcnJheSA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgcGF0aEFycmF5LnBvcCgpOyAvLyByZW1vdmUgRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uXFxuICBwYXRoQXJyYXkgPSBwYXRoQXJyYXkubWFwKChkaXIpID0+IHRvb2xzLmZvcm1hdFVwcGVyQ2FtZWxDYXNlKGRpcikpOyAvLyBjb252ZXJ0IHRvIFVwcGVyQ2FtZWxDYXNlXFxuICBjb25zdCBmaWxlTmFtZVBhcnRzID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XFxuICBpZiAoZmlsZU5hbWVQYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIGZpbGVOYW1lUGFydHMucG9wKCk7IC8vIHJlbW92ZSBFeHRlbnNpb25cXG4gIH1cXG4gIGNvbnN0IGZpbGVOYW1lID0gZmlsZU5hbWVQYXJ0cy5qb2luKCcuJyk7IC8vIHJlYnVpbGQgZmlsZSBOYW1lXFxuICBwYXRoQXJyYXkucHVzaCh0b29scy5mb3JtYXRVcHBlckNhbWVsQ2FzZShmaWxlTmFtZSkpOyAvLyBhZGQgZmlsZSBuYW1lIHdpdGhvdXQgZXh0ZW5zaW9uIGFuZCBpbiBVcHBlckNhbWVsQ2FzZVxcbiAgY29uc3QgcmVzdWx0ID0gcGF0aEFycmF5LmpvaW4oJy4nKSB8fCAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6IGZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgICAgICBsZXQgcGF0aEFycmF5ID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgIHBhdGhBcnJheS5wb3AoKTsgLy8gcmVtb3ZlIEZpbGUgbmFtZSB3aXRoIGV4dGVuc2lvblxyXG4gICAgICAgICAgICBwYXRoQXJyYXkgPSBwYXRoQXJyYXkubWFwKChkaXIpID0+IHRvb2xzLmZvcm1hdFVwcGVyQ2FtZWxDYXNlKGRpcikpOyAvLyBjb252ZXJ0IHRvIHVwcGVyIGNhbWVsQ2FzZVxyXG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZVBhcnRzID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgIGlmIChmaWxlTmFtZVBhcnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgZmlsZU5hbWVQYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIEV4dGVuc2lvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZU5hbWVQYXJ0cy5qb2luKCcuJyk7IC8vIHJlYnVpbGQgZmlsZSBOYW1lXHJcbiAgICAgICAgICAgIHBhdGhBcnJheS5wdXNoKHRvb2xzLmZvcm1hdFVwcGVyQ2FtZWxDYXNlKGZpbGVOYW1lKSk7IC8vIGFkZCBmaWxlIG5hbWUgd2l0aG91dCBleHRlbnNpb24gYW5kIGluIHVwcGVyQ2FtZWxDYXNlXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhdGhBcnJheS5qb2luKCcuJykgfHwgJyc7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDoncGF0aCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgUGF0aCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBmaWxlIG5hbWVcXG4gICAgcmVzdWx0ID0gcmVzdWx0ICsgcGFydHMuam9pbignLycpO1xcbiAgfVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICByZXR1cm4gcGFydHMuam9pbignLycpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZm9sZGVyJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRm9sZGVybmFtZScsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcmVzdWx0ID0gcGFydHNbcGFydHMubGVuZ3RoLTJdO1xcbiAgfVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICByZXN1bHQgPSBwYXJ0c1twYXJ0cy5sZW5ndGgtMl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZvbGRlcnMnLFxyXG4gICAgZGVzY3JpcHRpb246ICdBbGwgZm9sZGVycyBvZiB0aGUgZmlsZSBhcyBhIGxpc3QnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDsgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIHJlc3VsdC5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIHJlc3VsdC5wb3AoKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidyb290Rm9sZGVyJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnUm9vdCBmb2xkZXInLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHJlc3VsdCA9IHBhcnRzWzBdO1xcbiAgfVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICByZXN1bHQgPSBwYXJ0c1swXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonbmFtZScsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgbmFtZScsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XFxuICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBleHRlbnNpb25cXG4gIHJlc3VsdC5qb2luKCcuJyk7IC8vIHJlY29uc3RydWN0IHRoZSBmaWxlIG5hbWVcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBleHRlbnNpb25cclxuICAgICAgICByZXN1bHQuam9pbignLicpOyAvLyByZWNvbnN0cnVjdCB0aGUgZmlsZSBuYW1lXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonbmFtZUV4dCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgbmFtZSB3aXRoIGV4dGVuc2lvbicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidkYXRlVGltZUNyZWF0ZWQnLFxyXG4gICAgZGVzY3JpcHRpb246ICdEYXRlIChhbmQgVGltZSkgY3JlYXRlZCcsIC8vIFRPRE8gQ2hlY2sgdGltZSB6b25lcy4gXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIERhdGUgYW5kIFRpbWVyIGZpbGUgY3JlYXRlZFxcbiAgY29uc3QgZGF0ZVRpbWUgPSBuZXcgRGF0ZShmaWxlLnN0YXQuY3RpbWUpO1xcbiAgY29uc3QgcmVzdWx0ID0gZGF0ZVRpbWUudG9JU09TdHJpbmcoKS5zcGxpdCgnLicpWzBdO1xcbiAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyBcclxuICAgICAgICAvLyBhY3F1aXJlIERhdGUgYW5kIFRpbWVyIGZpbGUgY3JlYXRlZFxyXG4gICAgICAgIGNvbnN0IGRhdGVUaW1lID0gbmV3IERhdGUoZmlsZS5zdGF0LmN0aW1lKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYXRlVGltZS50b0lTT1N0cmluZygpLnNwbGl0KCcuJylbMF07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RhdGVUaW1lTW9kaWZpZWQnLFxyXG4gICAgZGVzY3JpcHRpb246ICdEYXRlIChhbmQgVGltZSkgbW9kaWZpZWQnLCAvL0ZJWE1FIGtlZXAgRGF0ZSBhbmQgdGltZSB1bnRvdWNoZWQgd2hlbiBlZGl0aW5nIGZyb250bWF0dGVyIHByb3BlcnRpZXNcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgRGF0ZSBhbmQgVGltZXIgZmlsZSBtb2RpZmllZFxcbiAgY29uc3QgZGF0ZVRpbWUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpO1xcbiAgY29uc3QgcmVzdWx0ID0gZGF0ZVRpbWUudG9JU09TdHJpbmcoKS5zcGxpdCgnLicpWzBdO1xcbiAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyBcclxuICAgICAgICAvLyBhY3F1aXJlIERhdGUgYW5kIFRpbWVyIGZpbGUgY3JlYXRlZFxyXG4gICAgICAgIGNvbnN0IGRhdGVUaW1lID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYXRlVGltZS50b0lTT1N0cmluZygpLnNwbGl0KCcuJylbMF07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZpbGVTaXplQnl0ZXMnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIHNpemUgaW4gYnl0ZXMnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHNpemVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUuc3RhdC5zaXplO1xcbiAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGUuc3RhdC5zaXplO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmaWxlU2l6ZVN0cmluZycsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgc2l6ZSBmb3JtYXR0ZWQgYXMgdGV4dCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxcbiAgbGV0IHNpemUgPWZpbGUuc3RhdC5zaXplO1xcbiAgY29uc3QgcHJlY2lzaW9uID0gMjsgLy8gbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzXFxuICBpZiAoc2l6ZSA+IDEwMjQpIHtcXG4gICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcXG4gICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XFxuICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XFxuICAgICAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQoc2l6ZSkudG9GaXhlZChwcmVjaXNpb24pICsgJyBHQic7XFxuICAgICAgfSBcXG4gICAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQoc2l6ZSkudG9GaXhlZChwcmVjaXNpb24pICsgJyBNQic7XFxuICAgIH1cXG4gICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgS0InO1xcbiAgfSAgIFxcbiAgcmV0dXJuIHNpemUgKyAnIEJ5dGVzJzsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxyXG4gICAgICAgIGxldCBzaXplID1maWxlLnN0YXQuc2l6ZTtcclxuICAgICAgICBjb25zdCBwcmVjaXNpb24gPSAyOyAvLyBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXNcclxuICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcclxuICAgICAgICAgIGlmIChzaXplID4gMTAyNCkge1xyXG4gICAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICAgIGlmIChzaXplID4gMTAyNCkge1xyXG4gICAgICAgICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcclxuICAgICAgICAgICAgICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEdCJztcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBNQic7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEtCJztcclxuICAgICAgICB9ICAgXHJcbiAgICAgICAgcmV0dXJuIHNpemUgKyAnIEJ5dGVzJzsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXHJcbiAgICAgIH1cclxufSk7IiwgImltcG9ydCAqIGFzIGZtVG9vbHMgZnJvbSAnLi9mcm9udG1hdHRlci10b29scyc7XHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGb2xkZXJUYWdTZXR0aW5ncyB7XHJcbiAgICB0YWdQcmVmaXg6IHN0cmluZztcclxuICAgIGV4Y2x1ZGVSb290Rm9sZGVyOiBib29sZWFuO1xyXG4gICAgdGFnc1Byb3BlcnR5TmFtZTogc3RyaW5nO1xyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogc3RyaW5nO1xyXG4gICAgc3BlY2lhbENoYXJSZXBsYWNlbWVudDogc3RyaW5nO1xyXG4gICAgbG93ZXJjYXNlVGFnczogYm9vbGVhbjtcclxuICAgIGtub3duUHJvcGVydGllczogUHJvcGVydHlUeXBlSW5mb1tdO1xyXG4gICAgcnVsZXM6IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uW107XHJcbiAgICB1c2VUZXh0QXJlYTogYm9vbGVhbjtcclxuICAgIGV4Y2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgICAgIG1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVyJyB8ICdmaWxlcydcclxuICAgIH07XHJcbiAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBzZWxlY3RlZEZpbGVzOiBzdHJpbmdbXSxcclxuICAgICAgICBtb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZScsXHJcbiAgICAgICAgZGlzcGxheTogJ2ZvbGRlcicgfCAnZmlsZXMnXHJcbiAgICB9O1xyXG4gICAgY29uZmlndXJlZFByb3BlcnRpZXM6IEFycmF5PHsgbmFtZTogc3RyaW5nOyB2YWx1ZTogYW55IH0+O1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRm9sZGVyVGFnU2V0dGluZ3MgPSB7XHJcbiAgICB0YWdQcmVmaXg6ICcnLFxyXG4gICAgZXhjbHVkZVJvb3RGb2xkZXI6IGZhbHNlLFxyXG4gICAgdGFnc1Byb3BlcnR5TmFtZTogJ3RhZ3MnLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogJ18nLFxyXG4gICAgc3BlY2lhbENoYXJSZXBsYWNlbWVudDogJ18nLFxyXG4gICAgbG93ZXJjYXNlVGFnczogZmFsc2UsXHJcbiAgICBrbm93blByb3BlcnRpZXM6IFtdLFxyXG4gICAgcnVsZXM6IFtdLFxyXG4gICAgdXNlVGV4dEFyZWE6IGZhbHNlLFxyXG4gICAgZXhjbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2V4Y2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXInLFxyXG4gICAgfSxcclxuICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgICAgIG1vZGU6ICdpbmNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVyJyxcclxuICAgIH0sXHJcbiAgICBjb25maWd1cmVkUHJvcGVydGllczogW10sXHJcbn07XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uIHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBhY3RpdmU6IGJvb2xlYW47XHJcbiAgICBwcm9wZXJ0eTogc3RyaW5nO1xyXG4gICAgY3VzdG9tUHJvcGVydHk6IHN0cmluZztcclxuICAgIHR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgIHR5cGVQcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZDtcclxuICAgIGNvbnRlbnQ6IHN0cmluZztcclxuICAgIGJ1aWxkSW5Db2RlOiBzdHJpbmc7XHJcbiAgICBqc0NvZGU6IHN0cmluZztcclxuICAgIHNob3dDb250ZW50OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9SVUxFX0RFRklOSVRJT04gOiBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiA9IHtcclxuICAgIGlkOiAnJyxcclxuICAgIGFjdGl2ZSA6IHRydWUsXHJcbiAgICBwcm9wZXJ0eSA6ICcnLFxyXG4gICAgY3VzdG9tUHJvcGVydHkgOiAnJyxcclxuICAgIHR5cGU6ICdzdHJpbmcnLFxyXG4gICAgdHlwZVByb3BlcnR5OiB7bmFtZTonJyx0eXBlOicnLCBzb3VyY2U6J3JlZ2lzdGVyZWQnfSxcclxuICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgYnVpbGRJbkNvZGU6ICcnLFxyXG4gICAganNDb2RlOiAnJyxcclxuICAgIHNob3dDb250ZW50OiBmYWxzZSxcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgUHJvcGVydHlUeXBlSW5mbyA9IHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIGNvdW50PzogbnVtYmVyO1xyXG4gICAgaXNBcnJheT86IGJvb2xlYW47XHJcbiAgICB2YWx1ZXM/OiBzdHJpbmdbXTtcclxuICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnIHwgJ2luZmVycmVkJztcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFByb3BlcnR5VHlwZSA9IHtcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIGljb246IHN0cmluZztcclxuICAgIGpzVHlwZTogc3RyaW5nO1xyXG59OyIsICJpbXBvcnQgeyBNb2RhbCwgQXBwLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG4vKipcclxuICogRGlzcGxheSBhIEFsZXJ0IE1vZGFsIGFzeW5jaHJvbm91c2x5IFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFzeW5jQWxlcnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHRpdGxlOiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHByaXZhdGUgYnRuMVRleHQ6IHN0cmluZztcclxuICBwcml2YXRlIGJ0bjJUZXh0OiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBvblllczogKCkgPT4gdm9pZDtcclxuICBwcml2YXRlIG9uTm86ICgpID0+IHZvaWQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBidG4xOiBzdHJpbmcsIGJ0bjI6c3RyaW5nLCBvblllczogKCkgPT4gdm9pZCwgb25ObzogKCkgPT4gdm9pZCkge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgIHRoaXMuYnRuMVRleHQgPSBidG4xO1xyXG4gICAgdGhpcy5idG4yVGV4dCA9IGJ0bjI7XHJcbiAgICB0aGlzLm9uWWVzID0gb25ZZXM7XHJcbiAgICB0aGlzLm9uTm8gPSBvbk5vO1xyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblxyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogdGhpcy50aXRsZSB9KTtcclxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogdGhpcy5kZXNjcmlwdGlvbiB9KTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KHRoaXMuYnRuMVRleHQpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub25ZZXMoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG4gICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCh0aGlzLmJ0bjJUZXh0KVxyXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uTm8oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogZGlzcGxheSBhbiBBbGVydCBNb2RhbFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFsZXJ0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIHRpdGxlOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIHJlc29sdmVQcm9taXNlOiAodmFsdWU6IGJvb2xlYW4pID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHByb21pc2U6IFByb21pc2U8Ym9vbGVhbj47XHJcbiAgICBwcml2YXRlIGJ0bjFUZXh0OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGJ0bjJUZXh0OiBzdHJpbmc7XHJcbiAgXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgYnRuMTogc3RyaW5nLCBidG4yOnN0cmluZykge1xyXG4gICAgICBzdXBlcihhcHApO1xyXG4gICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgICAgdGhpcy5idG4xVGV4dCA9IGJ0bjE7XHJcbiAgICAgIHRoaXMuYnRuMlRleHQgPSBidG4yO1xyXG4gICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgXHJcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IHRoaXMudGl0bGUgfSk7XHJcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogdGhpcy5kZXNjcmlwdGlvbiB9KTtcclxuICBcclxuICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4xVGV4dClcclxuICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KHRoaXMuYnRuMlRleHQpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgYXN5bmMgb3BlbkFuZEdldFZhbHVlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICB0aGlzLm9wZW4oKTtcclxuICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcclxuICAgIH1cclxuICB9IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcsIFRBYnN0cmFjdEZpbGUsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJzsgLy8gQWRkZWQgc2V0SWNvblxyXG5cclxuLy8gRGVmaW5lIHRoZSBzdHJ1Y3R1cmUgZm9yIHRyZWUgbm9kZXNcclxuaW50ZXJmYWNlIFRyZWVOb2RlIHtcclxuICAgIHBhdGg6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHR5cGU6ICdmb2xkZXInIHwgJ2ZpbGUnO1xyXG4gICAgY2hpbGRyZW4/OiBUcmVlTm9kZVtdO1xyXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQ7IC8vIFJlZmVyZW5jZSB0byB0aGUgbGlzdCBpdGVtIGVsZW1lbnQgKGxpKVxyXG4gICAgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBsYWJlbDogSFRNTExhYmVsRWxlbWVudDtcclxuICAgIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7IC8vIFJlZmVyZW5jZSB0byB0aGUgY29udGFpbmVyIGRpdiBob2xkaW5nIGNoZWNrYm94IGFuZCBsYWJlbFxyXG59XHJcblxyXG4vLyBEZWZpbmUgdGhlIHJlc3VsdCBzdHJ1Y3R1cmUgcmV0dXJuZWQgYnkgdGhlIG1vZGFsXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHtcclxuICAgIGZvbGRlcnM6IHN0cmluZ1tdO1xyXG4gICAgZmlsZXM6IHN0cmluZ1tdO1xyXG4gICAgbW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnO1xyXG4gICAgZGlzcGxheTogJ2ZvbGRlcnMnIHwgJ2ZpbGVzJztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIE1vZGFsIGZvciBzZWxlY3RpbmcgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGZyb20gdGhlIHZhdWx0IHN0cnVjdHVyZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIC8vIEluaXRpYWwgc3RhdGUgcGFzc2VkIHRvIHRoZSBtb2RhbCAoc3RvcmVkIGZvciByZXNldCBmdW5jdGlvbmFsaXR5KVxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBpbml0aWFsRm9sZGVyc1NuYXBzaG90OiBSZWFkb25seVNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBpbml0aWFsRmlsZXNTbmFwc2hvdDogUmVhZG9ubHlTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbE1vZGVTbmFwc2hvdDogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBpbml0aWFsRGlzcGxheVNuYXBzaG90OiAnZm9sZGVycycgfCAnZmlsZXMnO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBva0NhbGxiYWNrOiAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB2b2lkO1xyXG5cclxuICAgIC8vIEN1cnJlbnQgc3RhdGUgYmVpbmcgbW9kaWZpZWQgd2l0aGluIHRoZSBtb2RhbFxyXG4gICAgcHJpdmF0ZSBjdXJyZW50Rm9sZGVyczogU2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIGN1cnJlbnRGaWxlczogU2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIGN1cnJlbnRNb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICBwcml2YXRlIGN1cnJlbnREaXNwbGF5OiAnZm9sZGVycycgfCAnZmlsZXMnO1xyXG4gICAgcHJpdmF0ZSBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGU6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIHNob3dGaWxlczogYm9vbGVhbiA9IGZhbHNlOyAvLyBTdGF0ZSBmb3Igc2hvd2luZyBmaWxlcyBpbiB0aGUgdHJlZVxyXG5cclxuICAgIC8vIFVJIEVsZW1lbnRzXHJcbiAgICBwcml2YXRlIHRyZWVSb290RWxlbWVudDogSFRNTEVsZW1lbnQ7IC8vIENvbnRhaW5lciBmb3IgdGhlIHRyZWUgdmlld1xyXG4gICAgcHJpdmF0ZSB0cmVlTm9kZXM6IE1hcDxzdHJpbmcsIFRyZWVOb2RlPiA9IG5ldyBNYXAoKTsgLy8gTWFwIHBhdGggdG8gbm9kZSBpbmZvIGZvciBxdWljayBhY2Nlc3NcclxuICAgIHByaXZhdGUgbW9kZURyb3Bkb3duOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7IC8vIFJlZmVyZW5jZSB0byB1cGRhdGUgZHJvcGRvd24gb24gcmVzZXRcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbEZvbGRlcnMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZm9sZGVyIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxGaWxlcyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmaWxlIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gICAgICogQHBhcmFtIG9rQ2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiT0tcIi4gUmVjZWl2ZXMgdGhlIHNlbGVjdGlvbiByZXN1bHQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGFwcDogQXBwLFxyXG4gICAgICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBpbml0aWFsRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgICAgIGluaXRpYWxNb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZScsXHJcbiAgICAgICAgaW5pdGlhbERpc3BsYXk6ICdmb2xkZXJzJyB8ICdmaWxlcycsXHJcbiAgICAgICAgaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlOiBib29sZWFuLFxyXG4gICAgICAgIG9rQ2FsbGJhY2s6IChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHZvaWRcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgLy8gU3RvcmUgaW5pdGlhbCBzdGF0ZSBmb3IgcmVzZXRcclxuICAgICAgICB0aGlzLmluaXRpYWxGb2xkZXJzU25hcHNob3QgPSBuZXcgU2V0KGluaXRpYWxGb2xkZXJzKTtcclxuICAgICAgICB0aGlzLmluaXRpYWxGaWxlc1NuYXBzaG90ID0gbmV3IFNldChpbml0aWFsRmlsZXMpO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbE1vZGVTbmFwc2hvdCA9IGluaXRpYWxNb2RlO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbERpc3BsYXlTbmFwc2hvdCA9IGluaXRpYWxEaXNwbGF5O1xyXG4gICAgICAgIHRoaXMuc2hvd0ZpbGVzID0gaW5pdGlhbERpc3BsYXk9PT0nZmlsZXMnIHx8IGluaXRpYWxGaWxlcy5sZW5ndGg+MDtcclxuICAgICAgICB0aGlzLmluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSA9IGluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZTtcclxuICAgICAgICB0aGlzLm9rQ2FsbGJhY2sgPSBva0NhbGxiYWNrO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGN1cnJlbnQgc3RhdGUgZnJvbSBpbml0aWFsIHN0YXRlIGZvciBlZGl0aW5nXHJcbiAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvblRvSW5pdGlhbCgpOyAvLyBVc2UgYSBtZXRob2QgZm9yIGluaXRpYWxpemF0aW9uIGFuZCByZXNldFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzdGF0ZSB0byB0aGUgaW5pdGlhbCBzdGF0ZSBwcm92aWRlZCBhdCBjb25zdHJ1Y3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Rm9sZGVycyA9IG5ldyBTZXQodGhpcy5pbml0aWFsRm9sZGVyc1NuYXBzaG90KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcyA9IG5ldyBTZXQodGhpcy5pbml0aWFsRmlsZXNTbmFwc2hvdCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50TW9kZSA9IHRoaXMuaW5pdGlhbE1vZGVTbmFwc2hvdDtcclxuICAgICAgICAvLyBOb3RlOiBzaG93RmlsZXMgaXMgbm90IHJlc2V0IGJ5IHRoaXMgYWN0aW9uLCB1c2VyIGNhbiB0b2dnbGUgaXQgaW5kZXBlbmRlbnRseVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzdGF0ZSB0byBlbXB0eS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZXNldFNlbGVjdGlvblRvRW1wdHkoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Rm9sZGVycyA9IG5ldyBTZXQoW10pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbGVzID0gbmV3IFNldChbXSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50TW9kZSA9IHRoaXMuaW5pdGlhbE1vZGVTbmFwc2hvdDtcclxuICAgICAgICAvLyBOb3RlOiBzaG93RmlsZXMgaXMgbm90IHJlc2V0IGJ5IHRoaXMgYWN0aW9uLCB1c2VyIGNhbiB0b2dnbGUgaXQgaW5kZXBlbmRlbnRseVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIG9wZW5lZC4gQnVpbGRzIHRoZSBVSS5cclxuICAgICAqL1xyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciBwcmV2aW91cyBjb250ZW50XHJcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdkaXJlY3Rvcnktc2VsZWN0aW9uLW1vZGFsJyk7IFxyXG5cclxuICAgICAgICAvLyAtLS0gTW9kYWwgVGl0bGUgLS0tXHJcbiAgICAgICAgaWYgKHRoaXMuaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdJbmNsdWRlIG9yIEV4Y2x1ZGUgRm9sZGVycyBhbmQgRmlsZXMnIH0pOyBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiBgJHt0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScgPyAnRXhjbHVkZScgOiAnSW5jbHVkZSd9IEZvbGRlcnMgYW5kIEZpbGVzYCB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU2V0dGluZ3MgQ29udHJvbHMgLS0tXHJcbiAgICAgICAgY29uc3QgY29udHJvbHNFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1jb250cm9scycgfSk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVNb2RlU2V0dGluZyhjb250cm9sc0VsKTsgLy8gQ3JlYXRlIG1vZGUgZHJvcGRvd25cclxuICAgICAgICB0aGlzLmNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udHJvbHNFbCk7IC8vIENyZWF0ZSBmaWxlIHRvZ2dsZVxyXG5cclxuICAgICAgICAvLyAtLS0gVHJlZSBDb250YWluZXIgLS0tXHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS12aWV3LWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgLy8gQmFzaWMgc3R5bGluZyBmb3IgdGhlIHNjcm9sbGFibGUgdHJlZSBhcmVhXHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gJzYwMHB4JztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JztcclxuXHJcbiAgICAgICAgLy8gLS0tIEJ1aWxkIGFuZCBSZW5kZXIgVHJlZSAtLS1cclxuICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBJbml0aWFsIHJlbmRlcmluZyBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXHJcblxyXG4gICAgICAgIC8vIC0tLSBBY3Rpb24gQnV0dG9ucyAtLS1cclxuICAgICAgICB0aGlzLmNyZWF0ZUFjdGlvbkJ1dHRvbnMoY29udGVudEVsKTsgLy8gQ3JlYXRlIE9LIGFuZCBSZXNldCBidXR0b25zXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIHRoZSBkcm9wZG93biBzZXR0aW5nIGZvciBjaG9vc2luZyB0aGUgc2VsZWN0aW9uIG1vZGUuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgc2V0dGluZyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVNb2RlU2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pbmNsdWRlRXhjbHVkZVNlbGVjdGFibGUpIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RlRHJvcGRvd24gPSBuZXcgU2V0dGluZyhjb250YWluZXJFbCkgLy8gU3RvcmUgcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnU2VsZWN0aW9uIE1vZGUnKSAvLyBTZXR0aW5nIE5hbWUgaW4gR2VybWFuXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnQ2hvb3NlIGlmIHRoZSBzZWxlY3RlZCBmaWxlcyBhbmQgZm9sZGVycyBzaG91bGQgYmUgZXhjbHVkZWQgb3IgaW5jbHVkZWQuJykgXHJcbiAgICAgICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2V4Y2x1ZGUnLCAnZXhjbHVkZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2luY2x1ZGUnLCAnaW5jbHVkZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRNb2RlKSAvLyBTZXQgaW5pdGlhbCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TW9kZSA9IHZhbHVlIGFzICdpbmNsdWRlJyB8ICdleGNsdWRlJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVHJlZUFwcGVhcmFuY2UoKTsgLy8gVXBkYXRlIHRyZWUgdmlzdWFscyBiYXNlZCBvbiBuZXcgbW9kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIG1vZGUgZHJvcGRvd24gVUkgZWxlbWVudCB0byByZWZsZWN0IHRoZSBjdXJyZW50TW9kZSBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGRhdGVNb2RlRHJvcGRvd24oKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZHJvcGRvd25Db21wb25lbnQgPSB0aGlzLm1vZGVEcm9wZG93bj8uY29tcG9uZW50c1swXSBhcyBhbnk7IC8vIEFjY2VzcyBkcm9wZG93biBjb21wb25lbnRcclxuICAgICAgICBpZiAoZHJvcGRvd25Db21wb25lbnQgJiYgdHlwZW9mIGRyb3Bkb3duQ29tcG9uZW50LnNldFZhbHVlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICBkcm9wZG93bkNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRNb2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgdG9nZ2xlIHNldHRpbmcgZm9yIHNob3dpbmcvaGlkaW5nIGZpbGVzIGluIHRoZSB0cmVlLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIHNldHRpbmcgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlU2hvd0ZpbGVzU2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1Nob3cgRmlsZXMnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnU2hvdyBGaWxlcyB3aXRoaW4gdGhlIGRpcmVjdG9yeSB0cmVlLicpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHtcclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNob3dGaWxlcylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dGaWxlcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIFwiT0tcIiBhbmQgXCJSZXNldFwiIGJ1dHRvbnMuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYnV0dG9ucyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWJ1dHRvbnMnIH0pO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTVweCc7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIFVzZSBmbGV4IGZvciBhbGlnbm1lbnRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1lbmQnOyAvLyBBbGlnbiBidXR0b25zIHRvIHRoZSByaWdodFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5nYXAgPSAnMTBweCc7IC8vIFNwYWNlIGJldHdlZW4gYnV0dG9uc1xyXG5cclxuICAgICAgICAvLyBSZXNldCBCdXR0b24gKFVuZG8gXHUyMUFBXHVGRTBGKVxyXG4gICAgICAgIGNvbnN0IHJlc2V0QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKHJlc2V0QnV0dG9uLCAncmVzZXQnKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgcmVzZXRCdXR0b24uYXJpYUxhYmVsID0gJ1Jlc2V0IHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICByZXNldEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFJlc2V0IGludGVybmFsIHN0YXRlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kZURyb3Bkb3duKCk7IC8vIFVwZGF0ZSBkcm9wZG93biBVSVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBSZS1yZW5kZXIgdHJlZSB3aXRoIHJlc2V0IHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgQnV0dG9uIChDbGVhciBcdUQ4M0RcdURFQUUpXHJcbiAgICAgICAgY29uc3QgZW1wdHlCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24oZW1wdHlCdXR0b24sICdlcmFzZXInKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgZW1wdHlCdXR0b24uYXJpYUxhYmVsID0gJ0NsZWFyIHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBlbXB0eUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOyAvLyBDbGVhciBzdGF0ZVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVEcm9wZG93bigpOyAvLyBVcGRhdGUgZHJvcGRvd24gVUlcclxuICAgICAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTsgLy8gUmUtcmVuZGVyIHRyZWUgd2l0aCByZXNldCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGNhbmNlbCBCdXR0b25cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NhbmNlbCcgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgZGlzY2FyZCBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhbmNlbCBDbGlja2VkIC0gUmV0dXJuaW5nXCIpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICAgICAgdGhpcy5va0NhbGxiYWNrKCBudWxsICk7IC8vIFBhc3MgdGhlIGZpbmFsIHNlbGVjdGlvbiBiYWNrXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBPSyBCdXR0b25cclxuICAgICAgICBjb25zdCBva0J1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnT0snLCBjbHM6ICdtb2QtY3RhJyB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYXJpYUxhYmVsID0gJ2Nsb3NlIGFuZCBzYXZlIGNoYW5nZXMnOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgb2tCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIEJ1aWxkcyB0aGUgbG9naWNhbCB0cmVlIHN0cnVjdHVyZSBkYXRhIGZyb20gdGhlIHZhdWx0J3MgZmlsZXMgYW5kIGZvbGRlcnMuXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgcm9vdCBub2RlIG9mIHRoZSB0cmVlIHN0cnVjdHVyZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBidWlsZFRyZWVEYXRhKCk6IFRyZWVOb2RlIHtcclxuICAgICAgICAvLyBDcmVhdGUgYSB2aXJ0dWFsIHJvb3Qgbm9kZSByZXByZXNlbnRpbmcgdGhlIHZhdWx0XHJcbiAgICAgICAgY29uc3QgdmF1bHRSb290Tm9kZTogVHJlZU5vZGUgPSB7XHJcbiAgICAgICAgICAgICBwYXRoOiAnLycsXHJcbiAgICAgICAgICAgICBuYW1lOiB0aGlzLmFwcC52YXVsdC5nZXROYW1lKCkgfHwgJ1ZhdWx0JywgLy8gVXNlIHZhdWx0IG5hbWUgb3IgZGVmYXVsdFxyXG4gICAgICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXHJcbiAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAvLyBQbGFjZWhvbGRlciBlbGVtZW50cywgd2lsbCBiZSBhc3NpZ25lZCBkdXJpbmcgcmVuZGVyaW5nIGlmIHJvb3QgaXMgcmVuZGVyZWRcclxuICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLCBjaGVja2JveDogbnVsbCEsIGxhYmVsOiBudWxsISwgY29udGFpbmVyOiBudWxsIVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZm9sZGVyTm9kZXMgPSBuZXcgTWFwPHN0cmluZywgVHJlZU5vZGU+KCk7XHJcbiAgICAgICAgZm9sZGVyTm9kZXMuc2V0KCcvJywgdmF1bHRSb290Tm9kZSk7IC8vIEFkZCByb290IHRvIHRoZSBtYXBcclxuXHJcbiAgICAgICAgLy8gVXNlIGdldEZpbGVzKCkgdG8gcmV0cmlldmUgYWxsIFRGaWxlIG9iamVjdHMgKE1hcmtkb3duLCBpbWFnZXMsIHBkZiwgZXRjLilcclxuICAgICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBTdGVwIDE6IENyZWF0ZSBhbGwgZm9sZGVyIG5vZGVzIGJhc2VkIG9uIGZpbGUgcGFyZW50IHBhdGhzIC0tLVxyXG4gICAgICAgIGFsbEZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgcGFyZW50IGZvbGRlciBvYmplY3QgZm9yIHRoZSBmaWxlXHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudEZvbGRlciA9IGZpbGUucGFyZW50O1xyXG4gICAgICAgICAgICAvLyBFbnN1cmUgcGFyZW50Rm9sZGVyIGV4aXN0cyBiZWZvcmUgcHJvY2VlZGluZyAoU2FmZXR5IGNoZWNrKVxyXG4gICAgICAgICAgICBpZiAoIXBhcmVudEZvbGRlcikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gJyc7XHJcbiAgICAgICAgICAgIC8vIFNwbGl0IHBhdGgsIGZpbHRlciBlbXB0eSBzdHJpbmdzIChoYW5kbGVzIHJvb3QgJy8nKVxyXG4gICAgICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBwYXJlbnRGb2xkZXIucGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHAubGVuZ3RoID4gMCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcGFyZW50Tm9kZSA9IHZhdWx0Um9vdE5vZGU7IC8vIFN0YXJ0IGZyb20gdmF1bHQgcm9vdFxyXG4gICAgICAgICAgICBwYXRoUGFydHMuZm9yRWFjaChwYXJ0ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIENvbnN0cnVjdCB0aGUgZnVsbCBwYXRoIGZvciB0aGUgY3VycmVudCBwYXJ0XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGN1cnJlbnRQYXRoID09PSAnLycgPyBwYXJ0IDogYCR7Y3VycmVudFBhdGh9LyR7cGFydH1gO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFmb2xkZXJOb2Rlcy5oYXMoY3VycmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBmb2xkZXIgbm9kZSBpZiBpdCBkb2Vzbid0IGV4aXN0XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Rm9sZGVyTm9kZTogVHJlZU5vZGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBjdXJyZW50UGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZm9sZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBsYWNlaG9sZGVycywgYXNzaWduZWQgZHVyaW5nIHJlbmRlcmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbCEsIGNoZWNrYm94OiBudWxsISwgbGFiZWw6IG51bGwhLCBjb250YWluZXI6IG51bGwhXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBmb2xkZXJOb2Rlcy5zZXQoY3VycmVudFBhdGgsIG5ld0ZvbGRlck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBwYXJlbnROb2RlIGhhcyBjaGlsZHJlbiBhcnJheSBpbml0aWFsaXplZFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFyZW50Tm9kZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4hLnB1c2gobmV3Rm9sZGVyTm9kZSk7IC8vIEFkZCB0byBwYXJlbnQncyBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUgPSBuZXdGb2xkZXJOb2RlOyAvLyBNb3ZlIGRvd24gdGhlIHRyZWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9sZGVyIG5vZGUgYWxyZWFkeSBleGlzdHMsIGp1c3QgbW92ZSBkb3duXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGZvbGRlck5vZGVzLmdldChjdXJyZW50UGF0aCkhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFN0ZXAgMjogQWRkIGZpbGUgbm9kZXMgaWYgJ3Nob3dGaWxlcycgaXMgZW5hYmxlZCAtLS1cclxuICAgICAgICBpZiAodGhpcy5zaG93RmlsZXMpIHtcclxuICAgICAgICAgICAgIGFsbEZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmVudCBmb2xkZXIgYW5kIGFkZCBzYWZldHkgY2hlY2sgZm9yIG51bGxcclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLndhcm4oYEZpbGUgXCIke2ZpbGUucGF0aH1cIiBzZWVtcyB0byBoYXZlIG5vIHBhcmVudCBmb2xkZXIuIFNraXBwaW5nLmApOyAvLyBPcHRpb25hbCB3YXJuaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU2tpcCB0aGlzIGZpbGUgaWYgaXQgaGFzIG5vIHBhcmVudFxyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gXCIvXCIrcGFyZW50Rm9sZGVyLnBhdGg7IC8vIE5vdyBzYWZlIHRvIGFjY2VzcyAucGF0aFxyXG4gICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSBmb2xkZXJOb2Rlcy5nZXQocGFyZW50UGF0aCk7XHJcblxyXG4gICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZmlsZSBub2RlXHJcbiAgICAgICAgICAgICAgICAgY29uc3QgZmlsZU5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAvLyBGaWxlcyBkb24ndCBoYXZlIGNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIFBsYWNlaG9sZGVycywgYXNzaWduZWQgZHVyaW5nIHJlbmRlcmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsISwgY2hlY2tib3g6IG51bGwhLCBsYWJlbDogbnVsbCEsIGNvbnRhaW5lcjogbnVsbCFcclxuICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICBpZiAocGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgY2hpbGRyZW4gYXJyYXkgZXhpc3RzXHJcbiAgICAgICAgICAgICAgICAgICAgIGlmICghcGFyZW50Tm9kZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGZpbGUgdG8gaXRzIHBhcmVudCBmb2xkZXIncyBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuIS5wdXNoKGZpbGVOb2RlKTtcclxuICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGNhc2Ugc2hvdWxkIGlkZWFsbHkgbm90IGhhcHBlbiBpZiBTdGVwIDEgd29ya2VkIGNvcnJlY3RseSBmb3IgYWxsIGZvbGRlcnNcclxuICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS53YXJuKGBDb3VsZCBub3QgZmluZCBwYXJlbnQgbm9kZSBmb3IgcGF0aCBcIiR7cGFyZW50UGF0aH1cIiB3aGlsZSBhZGRpbmcgZmlsZSBcIiR7ZmlsZS5wYXRofVwiLmApOyAvLyBPcHRpb25hbCB3YXJuaW5nXHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAzOiBTb3J0IGNoaWxkcmVuIGFscGhhYmV0aWNhbGx5IChmb2xkZXJzIGZpcnN0LCB0aGVuIGZpbGVzKSAtLS1cclxuICAgICAgICBjb25zdCBzb3J0Tm9kZXMgPSAoYTogVHJlZU5vZGUsIGI6IFRyZWVOb2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmb2xkZXInICYmIGIudHlwZSA9PT0gJ2ZpbGUnKSByZXR1cm4gLTE7IC8vIEZvbGRlcnMgY29tZSBmaXJzdFxyXG4gICAgICAgICAgICBpZiAoYS50eXBlID09PSAnZmlsZScgJiYgYi50eXBlID09PSAnZm9sZGVyJykgcmV0dXJuIDE7ICAvLyBGaWxlcyBjb21lIGFmdGVyXHJcbiAgICAgICAgICAgIHJldHVybiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpOyAvLyBTb3J0IGFscGhhYmV0aWNhbGx5IGJ5IG5hbWVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBTb3J0IGNoaWxkcmVuIG9mIGV2ZXJ5IGZvbGRlciBub2RlXHJcbiAgICAgICAgZm9sZGVyTm9kZXMuZm9yRWFjaChub2RlID0+IG5vZGUuY2hpbGRyZW4/LnNvcnQoc29ydE5vZGVzKSk7XHJcblxyXG4gICAgICAgIHJldHVybiB2YXVsdFJvb3ROb2RlOyAvLyBSZXR1cm4gdGhlIHBvcHVsYXRlZCByb290IG5vZGVcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSBlbnRpcmUgdHJlZSBzdHJ1Y3R1cmUgaW4gdGhlIERPTSBiYXNlZCBvbiB0aGUgdHJlZSBkYXRhLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlbmRlclRyZWUoKSB7XHJcbiAgICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LmVtcHR5KCk7IC8vIENsZWFyIGV4aXN0aW5nIERPTSBlbGVtZW50c1xyXG4gICAgICAgICB0aGlzLnRyZWVOb2Rlcy5jbGVhcigpOyAvLyBDbGVhciB0aGUgbm9kZSBtYXBcclxuXHJcbiAgICAgICAgIGNvbnN0IHRyZWVEYXRhID0gdGhpcy5idWlsZFRyZWVEYXRhKCk7IC8vIEdldCB0aGUgc3RydWN0dXJlZCBkYXRhXHJcblxyXG4gICAgICAgICAvLyBDcmVhdGUgdGhlIHRvcC1sZXZlbCBsaXN0IGZvciB0aGUgdmF1bHQgY29udGVudHNcclxuICAgICAgICAgY29uc3Qgcm9vdFVsID0gdGhpcy50cmVlUm9vdEVsZW1lbnQuY3JlYXRlRWwoJ3VsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5hZGRDbGFzcygndHJlZS1yb290LXVsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5saXN0U3R5bGUgPSAnbm9uZSc7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVtb3ZlIGRlZmF1bHQgbGlzdCBpbmRlbnRhdGlvblxyXG5cclxuICAgICAgICAgLy8gUmVuZGVyIGNoaWxkcmVuIG9mIHRoZSB2aXJ0dWFsIHZhdWx0IHJvb3Qgbm9kZVxyXG4gICAgICAgICB0cmVlRGF0YS5jaGlsZHJlbj8uZm9yRWFjaChjaGlsZE5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgdGhpcy5yZW5kZXJUcmVlTm9kZShjaGlsZE5vZGUsIHJvb3RVbCwgMCk7IC8vIFN0YXJ0IHJlbmRlcmluZyBhdCBsZXZlbCAwXHJcbiAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVjdXJzaXZlbHkgcmVuZGVycyBhIHNpbmdsZSB0cmVlIG5vZGUgYW5kIGl0cyBjaGlsZHJlbiBpbiB0aGUgRE9NLlxyXG4gICAgICogQHBhcmFtIG5vZGUgLSBUaGUgVHJlZU5vZGUgZGF0YSB0byByZW5kZXIuXHJcbiAgICAgKiBAcGFyYW0gcGFyZW50RWxlbWVudCAtIFRoZSBIVE1MIGB1bGAgZWxlbWVudCB0byBhcHBlbmQgdGhpcyBub2RlJ3MgYGxpYCB0by5cclxuICAgICAqIEBwYXJhbSBsZXZlbCAtIFRoZSBjdXJyZW50IGluZGVudGF0aW9uIGxldmVsLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlbmRlclRyZWVOb2RlKG5vZGU6IFRyZWVOb2RlLCBwYXJlbnRFbGVtZW50OiBIVE1MRWxlbWVudCwgbGV2ZWw6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IGxpID0gcGFyZW50RWxlbWVudC5jcmVhdGVFbCgnbGknKTtcclxuICAgICAgICBsaS5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7bGV2ZWwgKiAyMH1weGA7IC8vIEFwcGx5IGluZGVudGF0aW9uIGJhc2VkIG9uIGxldmVsXHJcbiAgICAgICAgbGkuYWRkQ2xhc3MoYHRyZWUtbm9kZS0ke25vZGUudHlwZX1gKTsgLy8gQWRkIGNsYXNzIGZvciB0eXBlIChmb2xkZXIvZmlsZSlcclxuXHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGkuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS1ub2RlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcclxuICAgICAgICBjb250YWluZXIuc3R5bGUucGFkZGluZyA9ICcycHggMCc7IC8vIEFkZCBzb21lIHZlcnRpY2FsIHBhZGRpbmdcclxuXHJcbiAgICAgICAgLy8gLS0tIENoZWNrYm94IC0tLVxyXG4gICAgICAgIGNvbnN0IGNoZWNrYm94ID0gY29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHsgdHlwZTogJ2NoZWNrYm94JyB9KTtcclxuICAgICAgICBjaGVja2JveC5pZCA9IGB0cmVlLWNiLSR7bm9kZS5wYXRoLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnLScpfWA7IC8vIENyZWF0ZSBhIHNhZmUgSURcclxuICAgICAgICBjaGVja2JveC5kYXRhc2V0LnBhdGggPSBub2RlLnBhdGg7IC8vIFN0b3JlIHBhdGggaW4gZGF0YSBhdHRyaWJ1dGVcclxuICAgICAgICBjaGVja2JveC5kYXRhc2V0LnR5cGUgPSBub2RlLnR5cGU7IC8vIFN0b3JlIHR5cGVcclxuXHJcbiAgICAgICAgLy8gLS0tIExhYmVsIC0tLVxyXG4gICAgICAgIGNvbnN0IGxhYmVsID0gY29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcpO1xyXG4gICAgICAgIC8vIEFkZCBpY29ucyBmb3IgdmlzdWFsIGRpc3RpbmN0aW9uIChvcHRpb25hbClcclxuICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IGAke25vZGUudHlwZSA9PT0gJ2ZvbGRlcicgPyAnXHVEODNEXHVEQ0MxJyA6ICdcdUQ4M0RcdURDQzQnfSAke25vZGUubmFtZX1gO1xyXG4gICAgICAgIGxhYmVsLmh0bWxGb3IgPSBjaGVja2JveC5pZDsgLy8gTGluayBsYWJlbCB0byBjaGVja2JveFxyXG4gICAgICAgIGxhYmVsLnN0eWxlLm1hcmdpbkxlZnQgPSAnNXB4JztcclxuICAgICAgICBsYWJlbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcbiAgICAgICAgbGFiZWwudGl0bGUgPSBub2RlLnBhdGg7IC8vIFNob3cgZnVsbCBwYXRoIG9uIGhvdmVyXHJcblxyXG4gICAgICAgIC8vIC0tLSBTdG9yZSByZWZlcmVuY2VzIGluIHRoZSBub2RlIG9iamVjdCBhbmQgbWFwIC0tLVxyXG4gICAgICAgIG5vZGUuZWxlbWVudCA9IGxpO1xyXG4gICAgICAgIG5vZGUuY2hlY2tib3ggPSBjaGVja2JveDtcclxuICAgICAgICBub2RlLmxhYmVsID0gbGFiZWw7XHJcbiAgICAgICAgbm9kZS5jb250YWluZXIgPSBjb250YWluZXI7IC8vIFN0b3JlIGNvbnRhaW5lciByZWZlcmVuY2VcclxuICAgICAgICB0aGlzLnRyZWVOb2Rlcy5zZXQobm9kZS5wYXRoLCBub2RlKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFNldCBpbml0aWFsIGNoZWNrZWQgc3RhdGUgYmFzZWQgb24gY3VycmVudCBzZWxlY3Rpb24gLS0tXHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicpIHtcclxuICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gdGhpcy5jdXJyZW50RmlsZXMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciBjaGVja2JveCBjaGFuZ2VzIC0tLVxyXG4gICAgICAgIGNoZWNrYm94Lm9uY2hhbmdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdGFyZ2V0LmRhdGFzZXQucGF0aCE7XHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0YXJnZXQuZGF0YXNldC50eXBlIGFzICdmb2xkZXInIHwgJ2ZpbGUnO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzZXRzXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXInKSB0aGlzLmN1cnJlbnRGb2xkZXJzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5jdXJyZW50RmlsZXMuYWRkKHBhdGgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnZm9sZGVyJykgdGhpcy5jdXJyZW50Rm9sZGVycy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgZWxzZSB0aGlzLmN1cnJlbnRGaWxlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB2aXN1YWwgc3RhdGUgb2YgdGhlIGVudGlyZSB0cmVlIGFmdGVyIGEgY2hhbmdlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVHJlZUFwcGVhcmFuY2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyAtLS0gUmVuZGVyIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5IGlmIGl0J3MgYSBmb2xkZXIgLS0tXHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicgJiYgbm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW5VbCA9IGxpLmNyZWF0ZUVsKCd1bCcpO1xyXG4gICAgICAgICAgICBjaGlsZHJlblVsLnN0eWxlLmxpc3RTdHlsZSA9ICdub25lJztcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVzZXQgcGFkZGluZyBmb3IgbmVzdGVkIGxpc3RcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzAnOyAvLyBQcmV2ZW50IGRvdWJsZSBpbmRlbnRhdGlvbiBmcm9tIGRlZmF1bHQgVUwgc3R5bGVzXHJcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB0aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkLCBjaGlsZHJlblVsLCBsZXZlbCArIDEpKTsgLy8gSW5jcmVhc2UgbGV2ZWwgZm9yIGNoaWxkcmVuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIHZpc3VhbCBhcHBlYXJhbmNlIChlbmFibGVkL2Rpc2FibGVkL3N0eWxpbmcpIG9mIGFsbCBub2Rlc1xyXG4gICAgICogaW4gdGhlIHRyZWUgYmFzZWQgb24gdGhlIGN1cnJlbnQgbW9kZSBhbmQgc2VsZWN0aW9ucy5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGRhdGVUcmVlQXBwZWFyYW5jZSgpIHtcclxuICAgICAgICB0aGlzLnRyZWVOb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBpc0Rpc2FibGVkID0gZmFsc2U7IC8vIFNob3VsZCB0aGUgbm9kZSBhcHBlYXIgZGlzYWJsZWQgKGdyZXllZCBvdXQpP1xyXG4gICAgICAgICAgICBsZXQgaXNFZmZlY3RpdmVseUluY2x1ZGVkID0gZmFsc2U7IC8vIElzIHRoZSBub2RlIHBhcnQgb2YgdGhlICdhY3RpdmUnIHNldCBpbiBpbmNsdWRlIG1vZGU/XHJcbiAgICAgICAgICAgIGxldCBpc0VmZmVjdGl2ZWx5RXhjbHVkZWQgPSBmYWxzZTsgLy8gSXMgdGhlIG5vZGUgcGFydCBvZiB0aGUgJ2luYWN0aXZlJyBzZXQgaW4gZXhjbHVkZSBtb2RlP1xyXG5cclxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIGFuIGFuY2VzdG9yIEZPTERFUiBvZiB0aGlzIG5vZGUgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgbGV0IGFuY2VzdG9yRm9sZGVyU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gbm9kZS5wYXRoO1xyXG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudFBhdGggIT09ICcvJykge1xyXG4gICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBjdXJyZW50UGF0aC5zdWJzdHJpbmcoMCwgY3VycmVudFBhdGgubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICBhbmNlc3RvckZvbGRlclNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSBjdXJyZW50UGF0aCkgYnJlYWs7IC8vIFNhZmV0eSBicmVhayBhdCByb290XHJcbiAgICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgbm9kZSBpdHNlbGYgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgY29uc3Qgbm9kZVNlbGVjdGVkID0gbm9kZS50eXBlID09PSAnZm9sZGVyJ1xyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhub2RlLnBhdGgpXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMuY3VycmVudEZpbGVzLmhhcyhub2RlLnBhdGgpO1xyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEFwcGx5IExvZ2ljIEJhc2VkIG9uIE1vZGUgLS0tXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScpIHtcclxuICAgICAgICAgICAgICAgIC8vIEVYQ0xVREUgTW9kZTogQSBub2RlIGlzIGNvbnNpZGVyZWQgZXhjbHVkZWQgaWYgaXQgT1IgYW4gYW5jZXN0b3IgRk9MREVSIGlzIHNlbGVjdGVkLlxyXG4gICAgICAgICAgICAgICAgLy8gVmlzdWFsbHkgZGlzYWJsZSAoZ3JleSBvdXQpIG5vZGVzIHRoYXQgYXJlIGV4Y2x1ZGVkLlxyXG4gICAgICAgICAgICAgICAgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkID0gbm9kZVNlbGVjdGVkIHx8IGFuY2VzdG9yRm9sZGVyU2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkID0gaXNFZmZlY3RpdmVseUV4Y2x1ZGVkO1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBJTkNMVURFIE1vZGVcclxuICAgICAgICAgICAgICAgIC8vIElOQ0xVREUgTW9kZTogQSBub2RlIGlzIGNvbnNpZGVyZWQgaW5jbHVkZWQgaWYgaXQgT1IgYW4gYW5jZXN0b3IgRk9MREVSIGlzIHNlbGVjdGVkLlxyXG4gICAgICAgICAgICAgICAgLy8gVmlzdWFsbHkgZGlzYWJsZSAoZ3JleSBvdXQpIG5vZGVzIHRoYXQgYXJlIE5PVCBpbmNsdWRlZC5cclxuICAgICAgICAgICAgICAgIGlmIChub2RlLnR5cGUgPT09ICdmb2xkZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNFZmZlY3RpdmVseUluY2x1ZGVkID0gbm9kZVNlbGVjdGVkIHx8IGFuY2VzdG9yRm9sZGVyU2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyBmaWxlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRmlsZSBpbmNsdWRlZCBpZiBzZWxlY3RlZCBPUiBwYXJlbnQgcGF0aCBpcyBpbmNsdWRlZFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBub2RlLnBhdGguc3Vic3RyaW5nKDAsIG5vZGUucGF0aC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50RWZmZWN0aXZlbHlJbmNsdWRlZCA9IHRoaXMuaXNQYXRoRWZmZWN0aXZlbHlJbmNsdWRlZChwYXJlbnRQYXRoKTsgLy8gQ2hlY2sgcGFyZW50IGZvbGRlciBzdGF0dXNcclxuICAgICAgICAgICAgICAgICAgICBpc0VmZmVjdGl2ZWx5SW5jbHVkZWQgPSBub2RlU2VsZWN0ZWQgfHwgcGFyZW50RWZmZWN0aXZlbHlJbmNsdWRlZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlzRGlzYWJsZWQgPSAhaXNFZmZlY3RpdmVseUluY2x1ZGVkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAtLS0gQXBwbHkgVmlzdWFsIFN0eWxlcyAtLS1cclxuICAgICAgICAgICAgLy8gQ2hlY2tib3ggaXRzZWxmIHNob3VsZCBhbHdheXMgYmUgY2xpY2thYmxlIHRvIGNoYW5nZSBzZWxlY3Rpb24gc3RhdGVcclxuICAgICAgICAgICAgbm9kZS5jaGVja2JveC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc3R5bGluZyB0byB0aGUgY29udGFpbmVyIChsYWJlbCwgaWNvbikgYmFzZWQgb24gZGlzYWJsZWQgc3RhdGVcclxuICAgICAgICAgICAgaWYgKGlzRGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuY29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAnMC41JztcclxuICAgICAgICAgICAgICAgIG5vZGUubGFiZWwuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbGluZS10aHJvdWdoJzsgLy8gTW9yZSBwcm9taW5lbnQgZGlzYWJsZWQgbG9va1xyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LmFkZENsYXNzKCdpcy1kaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5jb250YWluZXIuc3R5bGUub3BhY2l0eSA9ICcxJztcclxuICAgICAgICAgICAgICAgIG5vZGUubGFiZWwuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2lzLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBGSVggZm9yIEludmFsaWRDaGFyYWN0ZXJFcnJvciAtLS1cclxuICAgICAgICAgICAgLy8gUmVtb3ZlIGNsYXNzZXMgaW5kaXZpZHVhbGx5XHJcbiAgICAgICAgICAgIG5vZGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1pbmNsdWRlZCcsICdpcy1leGNsdWRlZCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIHNwZWNpZmljIGNsYXNzZXMgZm9yIHN0eWxpbmcgaW5jbHVkZWQvZXhjbHVkZWQgc3RhdGVzXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlID09PSAnaW5jbHVkZScgJiYgaXNFZmZlY3RpdmVseUluY2x1ZGVkKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQuYWRkQ2xhc3MoJ2lzLWluY2x1ZGVkJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnICYmIGlzRWZmZWN0aXZlbHlFeGNsdWRlZCkge1xyXG4gICAgICAgICAgICAgICAgIC8vIEFwcGx5IGV4Y2x1ZGVkIGNsYXNzIGV2ZW4gaWYgaXQncyBqdXN0IHZpc3VhbGx5IGRpc2FibGVkXHJcbiAgICAgICAgICAgICAgICAgLy8gVGhpcyBhbGxvd3Mgc3BlY2lmaWMgc3R5bGluZyBmb3IgZXhjbHVkZWQgaXRlbXMgYmV5b25kIGp1c3QgZ3JleWVkIG91dFxyXG4gICAgICAgICAgICAgICAgbm9kZS5lbGVtZW50LmFkZENsYXNzKCdpcy1leGNsdWRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGEgZ2l2ZW4gcGF0aCBpcyBlZmZlY3RpdmVseSBpbmNsdWRlZFxyXG4gICAgICogaW4gdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHVuZGVyICdpbmNsdWRlJyBtb2RlLlxyXG4gICAgICogQSBwYXRoIGlzIGluY2x1ZGVkIGlmIGl0IChmaWxlIG9yIGZvbGRlcikgaXMgc2VsZWN0ZWQsIG9yIGlmIGFueSBvZiBpdHMgYW5jZXN0b3IgRk9MREVSUyBhcmUgc2VsZWN0ZWQuXHJcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmb2xkZXIgb3IgZmlsZSBwYXRoIHRvIGNoZWNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcGF0aCBzaG91bGQgYmUgY29uc2lkZXJlZCBpbmNsdWRlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlzUGF0aEVmZmVjdGl2ZWx5SW5jbHVkZWQocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gVGhpcyBjaGVjayBpcyBwcmltYXJpbHkgZm9yICdpbmNsdWRlJyBtb2RlIGxvZ2ljLlxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlICE9PSAnaW5jbHVkZScpIHtcclxuICAgICAgICAgICAgIC8vIEluICdleGNsdWRlJyBtb2RlLCBjb25jZXB0dWFsbHkgZXZlcnl0aGluZyBpcyBpbmNsdWRlZCB1bmxlc3MgZXhjbHVkZWQuXHJcbiAgICAgICAgICAgICAvLyBGb3IgaW50ZXJuYWwgY2hlY2tzLCB3ZSBtaWdodCBuZWVkIHRoZSBpbnZlcnNlIG9mIGV4Y2x1c2lvbi5cclxuICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc1BhdGhFZmZlY3RpdmVseUV4Y2x1ZGVkKHBhdGgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBhdGggaXRzZWxmIGlzIHNlbGVjdGVkIChhcHBsaWVzIHRvIGJvdGggZmlsZXMgYW5kIGZvbGRlcnMpXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGVzLmhhcyhwYXRoKSB8fCB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIGFueSBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWRcclxuICAgICAgICBsZXQgY3VycmVudCA9IHBhdGg7XHJcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09ICcvJykge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudC5zdWJzdHJpbmcoMCwgY3VycmVudC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEFuIGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSBjdXJyZW50KSBicmVhazsgLy8gUmVhY2hlZCByb290IG9yIGVycm9yXHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBOZWl0aGVyIHRoZSBwYXRoIG5vciBhbnkgYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICB9XHJcblxyXG4gICAgIC8qKlxyXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVybWluZSBpZiBhIGdpdmVuIHBhdGggaXMgZWZmZWN0aXZlbHkgZXhjbHVkZWRcclxuICAgICAqIGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB1bmRlciAnZXhjbHVkZScgbW9kZS5cclxuICAgICAqIEEgcGF0aCBpcyBleGNsdWRlZCBpZiBpdCAoZmlsZSBvciBmb2xkZXIpIGlzIHNlbGVjdGVkLCBvciBpZiBhbnkgb2YgaXRzIGFuY2VzdG9yIEZPTERFUlMgYXJlIHNlbGVjdGVkLlxyXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZm9sZGVyIG9yIGZpbGUgcGF0aCB0byBjaGVjay5cclxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHBhdGggc2hvdWxkIGJlIGNvbnNpZGVyZWQgZXhjbHVkZWQsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpc1BhdGhFZmZlY3RpdmVseUV4Y2x1ZGVkKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgICAvLyBUaGlzIGNoZWNrIGlzIHByaW1hcmlseSBmb3IgJ2V4Y2x1ZGUnIG1vZGUgbG9naWMuXHJcbiAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRNb2RlICE9PSAnZXhjbHVkZScpIHtcclxuICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBhdGggaXRzZWxmIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlcy5oYXMocGF0aCkgfHwgdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGF0aCkpIHtcclxuICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICAvLyBDaGVjayBpZiBhbnkgYW5jZXN0b3IgRk9MREVSIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgIGxldCBjdXJyZW50ID0gcGF0aDtcclxuICAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09ICcvJykge1xyXG4gICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IGN1cnJlbnQuc3Vic3RyaW5nKDAsIGN1cnJlbnQubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhcmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEFuIGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IGN1cnJlbnQpIGJyZWFrOyAvLyBSZWFjaGVkIHJvb3Qgb3IgZXJyb3JcclxuICAgICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE5laXRoZXIgdGhlIHBhdGggbm9yIGFueSBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWQgZm9yIGV4Y2x1c2lvblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbWJpbmVzIGJ1aWxkaW5nIHRoZSB0cmVlIGRhdGEsIHJlbmRlcmluZyB0aGUgRE9NLCBhbmQgYXBwbHlpbmcgaW5pdGlhbCBhcHBlYXJhbmNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJ1aWxkQW5kUmVuZGVyVHJlZSgpIHtcclxuICAgICAgICB0aGlzLnJlbmRlclRyZWUoKTsgLy8gQnVpbGQgZGF0YSBhbmQgcmVuZGVyIERPTSBlbGVtZW50c1xyXG4gICAgICAgIHRoaXMudXBkYXRlVHJlZUFwcGVhcmFuY2UoKTsgLy8gQXBwbHkgc3R5bGVzIGJhc2VkIG9uIGN1cnJlbnQgbW9kZS9zZWxlY3Rpb25cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgbW9kYWwgaXMgY2xvc2VkLiBDbGVhbnMgdXAgcmVzb3VyY2VzLlxyXG4gICAgICovXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIC8vIEdhdGhlciB0aGUgZmluYWwgc3RhdGUgT05MWSB3aGVuIE9LIGlzIGNsaWNrZWRcclxuICAgICAgICBjb25zdCByZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCA9IHtcclxuICAgICAgICAgICAgZm9sZGVyczogQXJyYXkuZnJvbSh0aGlzLmN1cnJlbnRGb2xkZXJzKSxcclxuICAgICAgICAgICAgZmlsZXM6IEFycmF5LmZyb20odGhpcy5jdXJyZW50RmlsZXMpLFxyXG4gICAgICAgICAgICBtb2RlOiB0aGlzLmN1cnJlbnRNb2RlLFxyXG4gICAgICAgICAgICBkaXNwbGF5OiB0aGlzLmN1cnJlbnREaXNwbGF5LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJPSyBDbGlja2VkIC0gUmV0dXJuaW5nIFJlc3VsdDpcIiwgcmVzdWx0KTsgLy8gRGVidWcgbG9nXHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrKHJlc3VsdCk7IC8vIFBhc3MgdGhlIGZpbmFsIHNlbGVjdGlvbiBiYWNrXHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7IC8vIENsZWFyIHRoZSBtb2RhbCdzIGNvbnRlbnRcclxuICAgICAgICB0aGlzLnRyZWVOb2Rlcy5jbGVhcigpOyAvLyBDbGVhciB0aGUgbm9kZSBtYXAgdG8gZnJlZSBtZW1vcnlcclxuICAgICAgICB0aGlzLm1vZGVEcm9wZG93biA9IG51bGw7IC8vIENsZWFyIHJlZmVyZW5jZVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGVhc2lseSBvcGVuIHRoZSBEaXJlY3RvcnkgU2VsZWN0aW9uIE1vZGFsLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICogQHBhcmFtIGluaXRpYWxGb2xkZXJzIC0gQXJyYXkgb2YgaW5pdGlhbGx5IHNlbGVjdGVkIGZvbGRlciBwYXRocy5cclxuICogQHBhcmFtIGluaXRpYWxGaWxlcyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmaWxlIHBhdGhzLlxyXG4gKiBAcGFyYW0gaW5pdGlhbE1vZGUgLSBUaGUgaW5pdGlhbCBzZWxlY3Rpb24gbW9kZSAoJ2luY2x1ZGUnIG9yICdleGNsdWRlJykuXHJcbiAqIEBwYXJhbSBva0NhbGxiYWNrIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBcIk9LXCIuIFJlY2VpdmVzIHRoZSBzZWxlY3Rpb24gcmVzdWx0LlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgIGFwcDogQXBwLFxyXG4gICAgaW5pdGlhbEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgaW5pdGlhbEZpbGVzOiBzdHJpbmdbXSxcclxuICAgIGluaXRpYWxNb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZScsXHJcbiAgICBpbml0aWFsRGlzcGxheTogJ2ZvbGRlcnMnIHwgJ2ZpbGVzJyxcclxuICAgIGluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZTogYm9vbGVhbixcclxuICAgIG9rQ2FsbGJhY2s6IChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHZvaWRcclxuKTogdm9pZCB7XHJcbiAgICAvLyBDcmVhdGUgYW5kIG9wZW4gdGhlIG1vZGFsIGluc3RhbmNlXHJcbiAgICBuZXcgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgYXBwLFxyXG4gICAgICAgIGluaXRpYWxGb2xkZXJzLFxyXG4gICAgICAgIGluaXRpYWxGaWxlcyxcclxuICAgICAgICBpbml0aWFsTW9kZSxcclxuICAgICAgICBpbml0aWFsRGlzcGxheSxcclxuICAgICAgICBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGUsXHJcbiAgICAgICAgb2tDYWxsYmFja1xyXG4gICAgKS5vcGVuKCk7XHJcbn1cclxuXHJcbi8qXHJcbi8vIC0tLSBFeGFtcGxlIFVzYWdlIGluIHlvdXIgUGx1Z2luJ3MgU2V0dGluZ3MgVGFiIC0tLVxyXG4vLyAoUGxhY2UgdGhpcyBpbiB5b3VyIHNldHRpbmdzIHRhYiBmaWxlLCBlLmcuLCBzZXR0aW5ncy50cylcclxuXHJcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLCBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfSBmcm9tICcuL0RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXHJcbmltcG9ydCBZb3VyUGx1Z2luIGZyb20gJy4vbWFpbic7IC8vIEFkanVzdCBwYXRoIHRvIHlvdXIgbWFpbiBwbHVnaW4gZmlsZVxyXG5cclxuLy8gLS0tIEV4YW1wbGUgUGx1Z2luIFNldHRpbmdzIEludGVyZmFjZSAoaW4geW91ciBtYWluLnRzIG9yIHNldHRpbmdzIGZpbGUpIC0tLVxyXG5leHBvcnQgaW50ZXJmYWNlIFlvdXJQbHVnaW5TZXR0aW5ncyB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdO1xyXG4gICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW107XHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAvLyAuLi4gb3RoZXIgc2V0dGluZ3MgZm9yIHlvdXIgcGx1Z2luXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBZb3VyUGx1Z2luU2V0dGluZ3MgPSB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnZXhjbHVkZScsIC8vIERlZmF1bHQgbW9kZSBpcyBvZnRlbiAnZXhjbHVkZSdcclxuICAgIC8vIC4uLiBvdGhlciBkZWZhdWx0IHNldHRpbmdzXHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgWW91clBsdWdpblNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IFlvdXJQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogWW91clBsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnRWluc3RlbGx1bmdlbiBmXHUwMEZDciBNZWluIFBsdWdpbicgfSk7IC8vIFNldHRpbmdzIFRpdGxlIGluIEdlcm1hblxyXG5cclxuICAgICAgICAvLyAtLS0gQnV0dG9uIHRvIE9wZW4gdGhlIE1vZGFsIC0tLVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVmVyemVpY2huaXNzZS9EYXRlaWVuIGtvbmZpZ3VyaWVyZW4nKSAvLyBTZXR0aW5nIE5hbWUgaW4gR2VybWFuXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdLbGlja2UgYXVmIGRlbiBCdXR0b24sIHVtIGRpZSBBdXN3YWhsIHp1IGJlYXJiZWl0ZW4uJykgLy8gU2V0dGluZyBEZXNjcmlwdGlvbiBpbiBHZXJtYW5cclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0F1c3dhaGwgXHUwMEY2ZmZuZW4nKSAvLyBCdXR0b24gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgY3VycmVudCBzZXR0aW5ncyB0byBwcmUtcG9wdWxhdGUgdGhlIG1vZGFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGb2xkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgfHwgJ2V4Y2x1ZGUnOyAvLyBVc2UgZGVmYXVsdCBpZiBub3Qgc2V0XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBtb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGb2xkZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE1vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBva0NhbGxiYWNrIGZ1bmN0aW9uOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0F1c3dhaGwgYmVzdFx1MDBFNHRpZ3Q6JywgcmVzdWx0KTsgLy8gTG9nIHJlc3VsdCBpbiBHZXJtYW4gY29uc29sZVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAtLS0gSU1QT1JUQU5UOiBTYXZlIHRoZSByZXN1bHRzIGJhY2sgdG8geW91ciBwbHVnaW4gc2V0dGluZ3MgLS0tXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGaWxlcyA9IHJlc3VsdC5maWxlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3Rpb25Nb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IC8vIFBlcnNpc3QgdGhlIGNoYW5nZXNcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3B0aW9uYWxseSwgcmUtcmVuZGVyIHRoZSBzZXR0aW5ncyB0YWIgdG8gc2hvdyB0aGUgdXBkYXRlZCBzZWxlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmUtcmVuZGVyIHNldHRpbmdzIHRhYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIC8vIC0tLSBEaXNwbGF5IEN1cnJlbnQgU2VsZWN0aW9uIChSZWFkLW9ubHkpIC0tLVxyXG4gICAgICAgICBjb25zdCBzZWxlY3Rpb25JbmZvRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5ncy1zZWxlY3Rpb24taW5mbycgfSk7XHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdBa3R1ZWxsZSBBdXN3YWhsOicgfSk7IC8vIFNlY3Rpb24gVGl0bGUgaW4gR2VybWFuXHJcbiAgICAgICAgIGNvbnN0IG1vZGVUZXh0ID0gYE1vZHVzOiAke3RoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgfHwgJ05pY2h0IGZlc3RnZWxlZ3QnfWA7IC8vIFRleHQgaW4gR2VybWFuXHJcbiAgICAgICAgIC8vIFRydW5jYXRlIGxvbmcgbGlzdHMgZm9yIGRpc3BsYXkgaWYgbmVjZXNzYXJ5XHJcbiAgICAgICAgIGNvbnN0IGZvbGRlclRleHQgPSBgQXVzZ2V3XHUwMEU0aGx0ZSBPcmRuZXI6ICR7KHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVycz8ubGVuZ3RoIHx8IDApfSBTdFx1MDBGQ2NrYDsgLy8gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgY29uc3QgZmlsZVRleHQgPSBgQXVzZ2V3XHUwMEU0aGx0ZSBEYXRlaWVuOiAkeyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzPy5sZW5ndGggfHwgMCl9IFN0XHUwMEZDY2tgOyAvLyBUZXh0IGluIEdlcm1hblxyXG5cclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBtb2RlVGV4dCB9KTtcclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBmb2xkZXJUZXh0IH0pO1xyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGZpbGVUZXh0IH0pO1xyXG4gICAgICAgICAvLyBZb3UgY291bGQgYWRkIGEgc21hbGwgYnV0dG9uL2xpbmsgaGVyZSB0byB2aWV3IHRoZSBmdWxsIGxpc3QgaWYgaXQncyBsb25nXHJcbiAgICB9XHJcbn1cclxuKi9cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUEwSDs7O0FDQTFILElBQUFDLG1CQUFrRzs7O0FDQWxHLHNCQUFpRDtBQTBDMUMsU0FBUyxpQ0FBaUMsS0FBOEI7QUFDM0UsTUFBSTtBQUNBLFVBQU0sa0JBQW1CLElBQVk7QUFDckMsWUFBUSxJQUFJLG1CQUFrQixlQUFlO0FBQzdDLFdBQU8sT0FBTyxPQUFPLGdCQUFnQixVQUFVLEVBQUUsSUFBSyxDQUFDLFdBQWdDO0FBQUEsTUFDbkYsTUFBTSxNQUFNO0FBQUEsTUFDWixNQUFNLE1BQU07QUFBQSxNQUNaLE9BQU8sTUFBTTtBQUFBLE1BQ2IsUUFBUTtBQUFBLElBQ1osRUFBRSxFQUFFLEtBQUssQ0FBQyxHQUFHLE1BQU0sRUFBRSxLQUFLLGNBQWMsRUFBRSxJQUFJLENBQUM7QUFBQSxFQUVuRCxTQUFTLEdBQVA7QUFDRSxZQUFRLE1BQU0sb0RBQW9ELENBQUM7QUFDbkUsV0FBTyxDQUFDO0FBQUEsRUFDWjtBQUNKO0FBSU8sU0FBUyw0QkFBNEIsS0FBZTtBQUN2RCxNQUFJO0FBQ0EsVUFBTSxrQkFBbUIsSUFBWTtBQUNyQyxZQUFRLElBQUksY0FBYSxlQUFlO0FBQ3hDLFdBQU8sT0FBTyxPQUFP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LE9BQU8sS0FBSyxFQUFFLEtBQUssSUFBSTtBQUFBLE1BQ3ZEO0FBRUEsbUJBQWE7QUFBQSxFQUFRO0FBQUEsS0FBMEI7QUFBQSxJQUNuRCxPQUFPO0FBRUgsVUFBSSxhQUFhLFNBQVMsR0FBRztBQUN6QixxQkFBYTtBQUFBLEVBQVEsS0FBSyxTQUFTO0FBQUEsSUFDL0IsYUFBYSxJQUFJLFNBQU8sT0FBTyxLQUFLLEVBQUUsS0FBSyxJQUFJLElBQy9DO0FBQUE7QUFBQTtBQUFBLEVBQVk7QUFBQSxNQUNwQixPQUFPO0FBRUg7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFVBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLFVBQVU7QUFBQSxFQUNoRDtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImpzQ29kZSIsICJ0ZXh0IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicnVsZSIsICJjbUVkaXRvciIsICJqc0NvZGUiLCAiX2EiXQp9Cg==
