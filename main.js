/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/settings.ts
var import_obsidian4 = require("obsidian");

// src/frontmatter-tools.ts
var import_obsidian = require("obsidian");
function getPropertiesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get properties:", metadataManager);
    return Object.values(metadataManager.properties).map((value) => ({
      name: value.name,
      type: value.type,
      count: value.count,
      source: "registered"
    })).sort((a, b) => a.name.localeCompare(b.name));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
function getTypesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    console.log("get types:", metadataManager);
    return Object.values(metadataManager.registeredTypeWidgets).map((value, index, array) => ({
      type: value.type,
      icon: value.icon,
      jsType: ""
    })).sort((a, b) => a.type.localeCompare(b.type));
  } catch (e) {
    console.error("Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
var SelectProperty = class extends import_obsidian.SuggestModal {
  constructor(app, knownProperties, property, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
    this.property = property;
    this.typedText = "";
    this.newTextFlag = true;
    this.knownProperties = knownProperties;
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    const result = this.knownProperties.filter((property) => property.name.toLowerCase().includes(query.toLowerCase()));
    this.newTextFlag = result.length === 0;
    this.typedText = query;
    return result;
  }
  onOpen() {
    if (this.property) {
      this.setPlaceholder(this.property.name);
    } else {
      this.setPlaceholder("no property selected!");
    }
    this.setTitle("Select or type a property name");
  }
  // Renders each suggestion item.
  renderSuggestion(property, el) {
    el.createEl("div", { text: property.name });
    el.createEl("small", { text: property.type });
  }
  onClose() {
    if (this.newTextFlag && this.property) {
      this.property.name = this.typedText;
      this.property.type = "text";
      this.onSubmit(this.property);
    }
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(property, evt) {
    if (evt instanceof KeyboardEvent) {
      console.log(`keyboard ${this.typedText} ${this.newTextFlag}`, property);
    }
    console.log("onChooseSuggestion", evt);
    this.onSubmit(property);
  }
};

// src/tools.ts
function parseJSCode(jsCode) {
  function parseFunction(jsCode2) {
    try {
      jsCode2 = cleanCodeString(jsCode2);
      var funcReg = /function *\(([^()]*)\)[ \n\t]*{(.*)}/gmi;
      var match = funcReg.exec(jsCode2.replace(/\n/g, " "));
      if (!match)
        return void 0;
      var args = match[1].split(",");
      args.push(match[2]);
      return new Function(...args);
    } catch (error) {
      console.error("error parsing JS function!", error);
      return error.message;
    }
  }
  ;
  return parseFunction(jsCode);
}
function cleanCodeString(codeString) {
  if (typeof codeString !== "string") {
    throw new TypeError("Input must be a string.");
  }
  let inMultiLineComment = false;
  let inSingleLineComment = false;
  let inString = null;
  let inRegExp = false;
  let cleanedCode = "";
  let i = 0;
  while (i < codeString.length) {
    const char = codeString[i];
    const nextChar = codeString[i + 1];
    if (inMultiLineComment) {
      if (char === "*" && nextChar === "/") {
        inMultiLineComment = false;
        i += 2;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inSingleLineComment) {
      if (char === "\n" || char === "\r") {
        inSingleLineComment = false;
        cleanedCode += char;
        i++;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inString) {
      if (char === inString) {
        inString = null;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (inRegExp) {
      if (char === "/") {
        inRegExp = false;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/" && nextChar === "*") {
      inMultiLineComment = true;
      i += 2;
      continue;
    }
    if (char === "/" && nextChar === "/") {
      inSingleLineComment = true;
      i += 2;
      continue;
    }
    if (char === '"' || char === "'") {
      inString = char;
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/") {
      const prevMeaningfulChar = cleanedCode.trim().slice(-1);
      if (prevMeaningfulChar === "" || ["(", ",", "=", ":", "[", "!", "&", "|", "?", "{", ";", "\n", "\r"].includes(prevMeaningfulChar)) {
        inRegExp = true;
        cleanedCode += char;
        i++;
        continue;
      }
    }
    cleanedCode += char;
    i++;
  }
  return cleanedCode;
}
var ScriptingTools = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Check if a string complies with ISO Standard
   * 
   * @param str Any string
   * @param options Options to look for
   * @returns 
   */
  isISOString(str, options = {}) {
    const {
      withMilliseconds = false,
      withTimezone = false,
      withTime = true,
      withDate = true
    } = options;
    let dateRegexStr = "^(?:\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01]))";
    let timeRegexStr = "(?:T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
    if (withMilliseconds) {
      timeRegexStr += "\\.\\d{3}";
    }
    if (withTimezone) {
      timeRegexStr += "(?:Z|[+-](?:[01]\\d|2[0-3]):[0-5]\\d)?)?";
    } else {
      timeRegexStr += ")?";
    }
    let regexStr = "";
    if (withDate && withTime) {
      regexStr = `${dateRegexStr}${timeRegexStr}$`;
    } else if (withDate) {
      regexStr = `${dateRegexStr}$`;
    } else if (withTime) {
      regexStr = `^${timeRegexStr.slice(4)}$`;
    } else {
      return false;
    }
    const regex = new RegExp(regexStr);
    return regex.test(str);
  }
  /**
   * Try to convert Any Types to a specific Type
   * @param input 
   * @param typeString 'string' | 'number' | 'boolean' | 'string[]'
   * @returns 
   */
  tryConvert(input, typeString) {
    switch (typeString) {
      case "string":
        if (typeof input === "string") {
          return input;
        }
        return void 0;
      case "number":
        const num = Number(input);
        if (!isNaN(num)) {
          return num;
        }
        return void 0;
      case "boolean":
        if (typeof input === "boolean") {
          return input;
        }
        if (typeof input === "string") {
          const lowerValue = input.toLowerCase();
          if (lowerValue === "true") {
            return true;
          }
          if (lowerValue === "false") {
            return false;
          }
        }
        if (typeof input === "number") {
          if (input === 1) {
            return true;
          }
          if (input === 0) {
            return false;
          }
        }
        return void 0;
      case "string[]":
        if (Array.isArray(input) && input.every((item) => typeof item === "string")) {
          return input;
        }
        return void 0;
      default:
        return void 0;
    }
  }
  formatToYAMLSaveString(text, replaceBy = void 0) {
    let replaceString = "-";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.specialCharReplacement || "-";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, replaceString);
  }
  /**
   * Converts a string to a YAML-safe format by adding quotes when necessary.
   * @param input The string, boolean, number or array to make YAML-safe
   * @returns The safely quoted string when needed, or the original string if safe
   */
  toYamlSafeString(input) {
    if (Array.isArray(input)) {
      input.forEach((item, index) => {
        input[index] = this.toYamlSafeString(item).toString();
      });
      return input;
    }
    switch (typeof input) {
      case "number":
        return input;
      case "boolean":
        return input ? "true" : "false";
      case "string":
        const trimmed = input.trim();
        if (trimmed === "")
          return '""';
        const needsQuotes = /[:{}\[\],&*#?|<>=!%@`"'\\]|^[-?\n]|[\s\n]|^[yYnN]|^[0-9]|^[+-]|^(true|false|yes|no|on|off)$/i.test(trimmed);
        const isAlreadyQuoted = trimmed.startsWith('"') && trimmed.endsWith('"') || trimmed.startsWith("'") && trimmed.endsWith("'");
        if (!needsQuotes && !isAlreadyQuoted) {
          return trimmed;
        }
        if (!isAlreadyQuoted) {
          return `"${trimmed.replace(/"/g, '\\"')}"`;
        }
        return trimmed;
      default:
        console.error(`toYamlSafeString(${input}) if of type '${typeof input}'`);
        return input;
    }
  }
  replaceSpaces(text, replaceBy = void 0) {
    let replaceString = "_";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.spaceReplacement || "_";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/\s+/g, replaceString);
  }
  formatCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      if (index > 0)
        newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  formatUpperCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  /**
   * get the path to a file from a string containing the full parh/name string
   * @param path string
   * @param separator string defaults to '/'
   * @returns string
   */
  getFoldersFromPath(path, separator = "/") {
    if (path === null)
      return null;
    if (path === void 0)
      return void 0;
    const currentPathParts = path.split("/");
    currentPathParts.pop();
    return currentPathParts.join(separator);
  }
};

// src/rules.ts
var ruleFunctions = [];
function getRuleFunctionById(id) {
  return ruleFunctions.find((rule) => rule.id === id);
}
ruleFunctions.push({
  id: "default",
  description: "Pass parameter",
  source: "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let result = "";
    return result;
  }
});
ruleFunctions.push({
  id: "fullPath",
  description: "Full path and filename",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const result = file.path;\n  return result;\n}",
  fx: function(app, file, tools) {
    return `${file.path}`;
  }
});
ruleFunctions.push({
  id: "aliasFromPath",
  description: "An Alias from every folder of the file Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  let pathArray = file.path.split('/');\n  pathArray.pop(); // remove File name with extension\n  pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir)); // convert to UpperCamelCase\n  const fileNameParts = file.name.split('.');\n  if (fileNameParts.length > 1) {\n    fileNameParts.pop(); // remove Extension\n  }\n  const fileName = fileNameParts.join('.'); // rebuild file Name\n  pathArray.push(tools.formatUpperCamelCase(fileName)); // add file name without extension and in UpperCamelCase\n  const result = pathArray.join('.') || '';\n  return result;\n}",
  fx: function(app, file, tools) {
    let pathArray = file.path.split("/");
    pathArray.pop();
    pathArray = pathArray.map((dir) => tools.formatUpperCamelCase(dir));
    const fileNameParts = file.name.split(".");
    if (fileNameParts.length > 1) {
      fileNameParts.pop();
    }
    const fileName = fileNameParts.join(".");
    pathArray.push(tools.formatUpperCamelCase(fileName));
    const result = pathArray.join(".") || "";
    return result;
  }
});
ruleFunctions.push({
  id: "path",
  description: "Full Path",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    parts.pop(); // remove file name\n    result = result + parts.join('/');\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    return parts.join("/");
  }
});
ruleFunctions.push({
  id: "folder",
  description: "Foldername",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[parts.length-2];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[parts.length - 2];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "folders",
  description: "All folders of the file as a list",
  source: "function (app, file, tools) { // do not change this line!\n  const path = file.path; // acquire file path\n  const result = path.split('/');\n  result.pop(); // remove file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const result = path.split("/");
    result.pop();
    return result;
  }
});
ruleFunctions.push({
  id: "rootFolder",
  description: "Root folder",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  let result = '';\n  if (parts.length > 1) {\n    result = parts[0];\n  }\n  return result;\n}",
  fx: function(app, file, tools) {
    const path = file.path;
    const parts = path.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[0];
    }
    return result;
  }
});
ruleFunctions.push({
  id: "name",
  description: "File name",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name.split('.');\n  result.pop(); // remove extension\n  result.join('.'); // reconstruct the file name\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name.split(".");
    result.pop();
    result.join(".");
    return result;
  }
});
ruleFunctions.push({
  id: "nameExt",
  description: "File name with extension",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = file.name;\n  return result;\n}",
  fx: function(app, file, tools) {
    const result = file.name;
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeCreated",
  description: "Date (and Time) created",
  // TODO Check time zones. 
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file created\n  const dateTime = new Date(file.stat.ctime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.ctime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "dateTimeModified",
  description: "Date (and Time) modified",
  //FIXME keep Date and time untouched when editing frontmatter properties
  source: "function (app, file, tools) { // do not change this line!\n  // acquire Date and Timer file modified\n  const dateTime = new Date(file.stat.mtime);\n  const result = dateTime.toISOString().split('.')[0];\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const dateTime = new Date(file.stat.mtime);
    const result = dateTime.toISOString().split(".")[0];
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeBytes",
  description: "File size in bytes",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  const result = file.stat.size;\n  return result; // return you result.\n}",
  fx: function(app, file, tools) {
    const result = file.stat.size;
    return result;
  }
});
ruleFunctions.push({
  id: "fileSizeString",
  description: "File size formatted as text",
  source: "function (app, file, tools) { // do not change this line!\n  // acquire file size\n  let size =file.stat.size;\n  const precision = 2; // number of decimal places\n  if (size > 1024) {\n    size = size / 1024;\n    if (size > 1024) {\n      size = size / 1024;\n      if (size > 1024) {\n        size = size / 1024;\n        return Number.parseFloat(size).toFixed(precision) + ' GB';\n      } \n      return Number.parseFloat(size).toFixed(precision) + ' MB';\n    }\n    return Number.parseFloat(size).toFixed(precision) + ' KB';\n  }   \n  return size + ' Bytes'; // return you result.\n}",
  fx: function(app, file, tools) {
    let size = file.stat.size;
    const precision = 2;
    if (size > 1024) {
      size = size / 1024;
      if (size > 1024) {
        size = size / 1024;
        if (size > 1024) {
          size = size / 1024;
          return size.toFixed(precision) + " GB";
        }
        return size.toFixed(precision) + " MB";
      }
      return size.toFixed(precision) + " KB";
    }
    return size + " Bytes";
  }
});

// src/types.ts
var DEFAULT_SETTINGS = {
  tagPrefix: "",
  excludeRootFolder: false,
  tagsPropertyName: "tags",
  spaceReplacement: "_",
  specialCharReplacement: "_",
  lowercaseTags: false,
  knownProperties: [],
  rules: [],
  useTextArea: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folder"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folder"
  },
  configuredProperties: []
};
var DEFAULT_RULE_DEFINITION = {
  id: "",
  active: true,
  property: "",
  customProperty: "",
  type: "string",
  typeProperty: { name: "", type: "", source: "registered" },
  content: "",
  buildInCode: "",
  jsCode: "",
  showContent: false
};

// src/alertBox.ts
var import_obsidian2 = require("obsidian");
var AlertModal = class extends import_obsidian2.Modal {
  constructor(app, title, description, btn1, btn2) {
    super(app);
    this.title = title;
    this.description = description;
    this.btn1Text = btn1;
    this.btn2Text = btn2;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: this.title });
    contentEl.createEl("p", { text: this.description });
    new import_obsidian2.Setting(contentEl).addButton((btn) => {
      btn.setButtonText(this.btn1Text).setCta().onClick(() => {
        this.close();
        this.resolvePromise(true);
      });
    }).addButton((btn) => {
      btn.setButtonText(this.btn2Text).onClick(() => {
        this.close();
        this.resolvePromise(false);
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  async openAndGetValue() {
    this.open();
    return this.promise;
  }
};

// src/directorySelectionModal.ts
var import_obsidian3 = require("obsidian");
var DirectorySelectionModal = class extends import_obsidian3.Modal {
  // Reference to update dropdown on reset
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param initialFolders - Array of initially selected folder paths.
   * @param initialFiles - Array of initially selected file paths.
   * @param initialMode - The initial selection mode ('include' or 'exclude').
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
    super(app);
    this.showFiles = false;
    // Container for the tree view
    this.treeNodes = /* @__PURE__ */ new Map();
    // Map path to node info for quick access
    this.modeDropdown = null;
    this.initialFoldersSnapshot = new Set(initialFolders);
    this.initialFilesSnapshot = new Set(initialFiles);
    this.initialModeSnapshot = initialMode;
    this.initialDisplaySnapshot = initialDisplay;
    this.showFiles = initialDisplay === "files" || initialFiles.length > 0;
    this.includeExcludeSelectable = includeExcludeSelectable;
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    this.currentFolders = new Set(this.initialFoldersSnapshot);
    this.currentFiles = new Set(this.initialFilesSnapshot);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    this.currentFolders = /* @__PURE__ */ new Set([]);
    this.currentFiles = /* @__PURE__ */ new Set([]);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("directory-selection-modal");
    if (this.includeExcludeSelectable) {
      contentEl.createEl("h2", { text: "Include or Exclude Folders and Files" });
    } else {
      contentEl.createEl("h2", { text: `${this.currentMode === "exclude" ? "Exclude" : "Include"} Folders and Files` });
    }
    const controlsEl = contentEl.createDiv({ cls: "modal-controls" });
    this.createModeSetting(controlsEl);
    this.createShowFilesSetting(controlsEl);
    this.treeRootElement = contentEl.createDiv({ cls: "tree-view-container" });
    this.treeRootElement.style.maxHeight = "600px";
    this.treeRootElement.style.overflowY = "auto";
    this.treeRootElement.style.border = "1px solid var(--background-modifier-border)";
    this.treeRootElement.style.padding = "10px";
    this.treeRootElement.style.marginTop = "10px";
    this.treeRootElement.style.marginBottom = "10px";
    this.buildAndRenderTree();
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the dropdown setting for choosing the selection mode.
   * @param containerEl - The HTML element to append the setting to.
   */
  createModeSetting(containerEl) {
    if (this.includeExcludeSelectable) {
      this.modeDropdown = new import_obsidian3.Setting(containerEl).setName("Selection Mode").setDesc("Choose if the selected files and folders should be excluded or included.").addDropdown((dropdown) => {
        dropdown.addOption("exclude", "exclude").addOption("include", "include").setValue(this.currentMode).onChange((value) => {
          this.currentMode = value;
          this.updateTreeAppearance();
        });
      });
    }
  }
  /**
   * Updates the mode dropdown UI element to reflect the currentMode state.
   */
  updateModeDropdown() {
    var _a;
    const dropdownComponent = (_a = this.modeDropdown) == null ? void 0 : _a.components[0];
    if (dropdownComponent && typeof dropdownComponent.setValue === "function") {
      dropdownComponent.setValue(this.currentMode);
    }
  }
  /**
   * Creates the toggle setting for showing/hiding files in the tree.
   * @param containerEl - The HTML element to append the setting to.
   */
  createShowFilesSetting(containerEl) {
    new import_obsidian3.Setting(containerEl).setName("Show Files").setDesc("Show Files within the directory tree.").addToggle((toggle) => {
      toggle.setValue(this.showFiles).onChange((value) => {
        this.showFiles = value;
        this.buildAndRenderTree();
      });
    });
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian3.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      console.log("Cancel Clicked - Returning");
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Builds the logical tree structure data from the vault's files and folders.
   * @returns The root node of the tree structure.
   */
  buildTreeData() {
    const vaultRootNode = {
      path: "/",
      name: this.app.vault.getName() || "Vault",
      // Use vault name or default
      type: "folder",
      children: [],
      // Placeholder elements, will be assigned during rendering if root is rendered
      element: null,
      checkbox: null,
      label: null,
      container: null
    };
    const folderNodes = /* @__PURE__ */ new Map();
    folderNodes.set("/", vaultRootNode);
    const allFiles = this.app.vault.getFiles();
    allFiles.forEach((file) => {
      const parentFolder = file.parent;
      if (!parentFolder)
        return;
      let currentPath = "";
      const pathParts = parentFolder.path.split("/").filter((p) => p.length > 0);
      let parentNode = vaultRootNode;
      pathParts.forEach((part) => {
        currentPath = currentPath === "/" ? part : `${currentPath}/${part}`;
        if (!folderNodes.has(currentPath)) {
          const newFolderNode = {
            path: currentPath,
            name: part,
            type: "folder",
            children: [],
            // Placeholders, assigned during rendering
            element: null,
            checkbox: null,
            label: null,
            container: null
          };
          folderNodes.set(currentPath, newFolderNode);
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(newFolderNode);
          parentNode = newFolderNode;
        } else {
          parentNode = folderNodes.get(currentPath);
        }
      });
    });
    if (this.showFiles) {
      allFiles.forEach((file) => {
        const parentFolder = file.parent;
        if (!parentFolder) {
          return;
        }
        const parentPath = "/" + parentFolder.path;
        const parentNode = folderNodes.get(parentPath);
        const fileNode = {
          path: file.path,
          name: file.name,
          type: "file",
          // Files don't have children
          // Placeholders, assigned during rendering
          element: null,
          checkbox: null,
          label: null,
          container: null
        };
        if (parentNode) {
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(fileNode);
        } else {
        }
      });
    }
    const sortNodes = (a, b) => {
      if (a.type === "folder" && b.type === "file")
        return -1;
      if (a.type === "file" && b.type === "folder")
        return 1;
      return a.name.localeCompare(b.name);
    };
    folderNodes.forEach((node) => {
      var _a;
      return (_a = node.children) == null ? void 0 : _a.sort(sortNodes);
    });
    return vaultRootNode;
  }
  /**
   * Renders the entire tree structure in the DOM based on the tree data.
   */
  renderTree() {
    var _a;
    this.treeRootElement.empty();
    this.treeNodes.clear();
    const treeData = this.buildTreeData();
    const rootUl = this.treeRootElement.createEl("ul");
    rootUl.addClass("tree-root-ul");
    rootUl.style.listStyle = "none";
    rootUl.style.paddingLeft = "0";
    (_a = treeData.children) == null ? void 0 : _a.forEach((childNode) => {
      this.renderTreeNode(childNode, rootUl, 0);
    });
  }
  /**
   * Recursively renders a single tree node and its children in the DOM.
   * @param node - The TreeNode data to render.
   * @param parentElement - The HTML `ul` element to append this node's `li` to.
   * @param level - The current indentation level.
   */
  renderTreeNode(node, parentElement, level) {
    const li = parentElement.createEl("li");
    li.style.marginLeft = `${level * 20}px`;
    li.addClass(`tree-node-${node.type}`);
    const container = li.createDiv({ cls: "tree-node-container" });
    container.style.display = "flex";
    container.style.alignItems = "center";
    container.style.padding = "2px 0";
    const checkbox = container.createEl("input", { type: "checkbox" });
    checkbox.id = `tree-cb-${node.path.replace(/[^a-zA-Z0-9]/g, "-")}`;
    checkbox.dataset.path = node.path;
    checkbox.dataset.type = node.type;
    const label = container.createEl("label");
    label.textContent = `${node.type === "folder" ? "\u{1F4C1}" : "\u{1F4C4}"} ${node.name}`;
    label.htmlFor = checkbox.id;
    label.style.marginLeft = "5px";
    label.style.cursor = "pointer";
    label.title = node.path;
    node.element = li;
    node.checkbox = checkbox;
    node.label = label;
    node.container = container;
    this.treeNodes.set(node.path, node);
    if (node.type === "folder") {
      checkbox.checked = this.currentFolders.has(node.path);
    } else {
      checkbox.checked = this.currentFiles.has(node.path);
    }
    checkbox.onchange = (event) => {
      const target = event.target;
      const path = target.dataset.path;
      const type = target.dataset.type;
      if (target.checked) {
        if (type === "folder")
          this.currentFolders.add(path);
        else
          this.currentFiles.add(path);
      } else {
        if (type === "folder")
          this.currentFolders.delete(path);
        else
          this.currentFiles.delete(path);
      }
      this.updateTreeAppearance();
    };
    if (node.type === "folder" && node.children && node.children.length > 0) {
      const childrenUl = li.createEl("ul");
      childrenUl.style.listStyle = "none";
      childrenUl.style.paddingLeft = "0";
      childrenUl.style.marginLeft = "0";
      node.children.forEach((child) => this.renderTreeNode(child, childrenUl, level + 1));
    }
  }
  /**
   * Updates the visual appearance (enabled/disabled/styling) of all nodes
   * in the tree based on the current mode and selections.
   */
  updateTreeAppearance() {
    this.treeNodes.forEach((node) => {
      let isDisabled = false;
      let isEffectivelyIncluded = false;
      let isEffectivelyExcluded = false;
      let ancestorFolderSelected = false;
      let currentPath = node.path;
      while (currentPath !== "/") {
        const parentPath = currentPath.substring(0, currentPath.lastIndexOf("/")) || "/";
        if (this.currentFolders.has(parentPath)) {
          ancestorFolderSelected = true;
          break;
        }
        if (parentPath === currentPath)
          break;
        currentPath = parentPath;
      }
      const nodeSelected = node.type === "folder" ? this.currentFolders.has(node.path) : this.currentFiles.has(node.path);
      if (this.currentMode === "exclude") {
        isEffectivelyExcluded = nodeSelected || ancestorFolderSelected;
        isDisabled = isEffectivelyExcluded;
      } else {
        if (node.type === "folder") {
          isEffectivelyIncluded = nodeSelected || ancestorFolderSelected;
        } else {
          const parentPath = node.path.substring(0, node.path.lastIndexOf("/")) || "/";
          const parentEffectivelyIncluded = this.isPathEffectivelyIncluded(parentPath);
          isEffectivelyIncluded = nodeSelected || parentEffectivelyIncluded;
        }
        isDisabled = !isEffectivelyIncluded;
      }
      node.checkbox.disabled = false;
      if (isDisabled) {
        node.container.style.opacity = "0.5";
        node.label.style.textDecoration = "line-through";
        node.element.addClass("is-disabled");
      } else {
        node.container.style.opacity = "1";
        node.label.style.textDecoration = "none";
        node.element.removeClass("is-disabled");
      }
      node.element.classList.remove("is-included", "is-excluded");
      if (this.currentMode === "include" && isEffectivelyIncluded) {
        node.element.addClass("is-included");
      } else if (this.currentMode === "exclude" && isEffectivelyExcluded) {
        node.element.addClass("is-excluded");
      }
    });
  }
  /**
   * Helper function to determine if a given path is effectively included
   * in the current selection under 'include' mode.
   * A path is included if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
   * @param path - The folder or file path to check.
   * @returns True if the path should be considered included, false otherwise.
   */
  isPathEffectivelyIncluded(path) {
    if (this.currentMode !== "include") {
      return !this.isPathEffectivelyExcluded(path);
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
  * Helper function to determine if a given path is effectively excluded
  * in the current selection under 'exclude' mode.
  * A path is excluded if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
  * @param path - The folder or file path to check.
  * @returns True if the path should be considered excluded, false otherwise.
  */
  isPathEffectivelyExcluded(path) {
    if (this.currentMode !== "exclude") {
      return false;
    }
    if (this.currentFiles.has(path) || this.currentFolders.has(path)) {
      return true;
    }
    let current = path;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
   * Combines building the tree data, rendering the DOM, and applying initial appearance.
   */
  buildAndRenderTree() {
    this.renderTree();
    this.updateTreeAppearance();
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      folders: Array.from(this.currentFolders),
      files: Array.from(this.currentFiles),
      mode: this.currentMode,
      display: this.currentDisplay
    };
    console.log("OK Clicked - Returning Result:", result);
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
    this.treeNodes.clear();
    this.modeDropdown = null;
  }
};
function openDirectorySelectionModal(app, initialFolders, initialFiles, initialMode, initialDisplay, includeExcludeSelectable, okCallback) {
  new DirectorySelectionModal(
    app,
    initialFolders,
    initialFiles,
    initialMode,
    initialDisplay,
    includeExcludeSelectable,
    okCallback
  ).open();
}

// src/settings.ts
var import_crypto = require("crypto");
var FolderTagSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(this.plugin.settings);
  }
  display() {
    this.knownProperties = getPropertiesFromMetadataManager(this.app);
    this.knownTypes = getTypesFromMetadataManager(this.app);
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Folder Path Tag Settings" });
    new import_obsidian4.Setting(containerEl).setName("Tag prefix").setDesc("Optional prefix to add before folder path tags").addText((text) => text.setPlaceholder("prefix/").setValue(this.plugin.settings.tagPrefix).onChange(async (value) => {
      this.plugin.settings.tagPrefix = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude root folder").setDesc("If enabled, the root folder name will be excluded from the tag").addToggle((toggle) => toggle.setValue(this.plugin.settings.excludeRootFolder).onChange(async (value) => {
      this.plugin.settings.excludeRootFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Tags property name").setDesc('Frontmatter property name to store tags (default: "tags")').addText((text) => text.setPlaceholder("tags").setValue(this.plugin.settings.tagsPropertyName).onChange(async (value) => {
      this.plugin.settings.tagsPropertyName = value || "tags";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Space replacement").setDesc('Character to replace spaces in folder names (default: "_")').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.spaceReplacement).onChange(async (value) => {
      this.plugin.settings.spaceReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Special character replacement").setDesc('Character to replace special characters (default: "_") - preserves letters with diacritics').addText((text) => text.setPlaceholder("_").setValue(this.plugin.settings.specialCharReplacement).onChange(async (value) => {
      this.plugin.settings.specialCharReplacement = value || "_";
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Convert to lowercase").setDesc("Convert all tags to lowercase").addToggle((toggle) => toggle.setValue(this.plugin.settings.lowercaseTags).onChange(async (value) => {
      this.plugin.settings.lowercaseTags = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Exclude Files and Folders").setDesc(`Currently ${this.plugin.settings.exclude.selectedFolders.length} folders and ${this.plugin.settings.exclude.selectedFiles.length} files will be ${this.plugin.settings.exclude.mode}d.`).addButton((button) => {
      button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.exclude.selectedFolders || [],
          this.plugin.settings.exclude.selectedFiles || [],
          this.plugin.settings.exclude.mode || "exclude",
          this.plugin.settings.exclude.display || "folders",
          false,
          // include, exclude option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.exclude.selectedFolders = result.folders;
            this.plugin.settings.exclude.selectedFiles = result.files;
            this.plugin.settings.exclude.mode = result.mode;
            this.plugin.settings.exclude.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Include Files and Folders").setDesc(`Currently ${this.plugin.settings.include.selectedFolders.length} folders and ${this.plugin.settings.include.selectedFiles.length} files will be ${this.plugin.settings.include.mode}d even when in excluded Folders.`).addButton((button) => {
      button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.include.selectedFolders || [],
          this.plugin.settings.include.selectedFiles || [],
          this.plugin.settings.include.mode || "include",
          this.plugin.settings.include.display || "folders",
          false,
          // include, include option hidden
          (result) => {
            if (!result)
              return;
            this.plugin.settings.include.selectedFolders = result.folders;
            this.plugin.settings.include.selectedFiles = result.files;
            this.plugin.settings.include.mode = result.mode;
            this.plugin.settings.include.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian4.Setting(containerEl).setName("Rules").setDesc("add rules to update selected parameters");
    this.rulesDiv = containerEl.createDiv({ cls: "obsidian-f2t-rule-area" });
    this.rulesControl = containerEl.createDiv({ cls: "obsidian-f2t-rule-controls" });
    this.plugin.settings.rules.forEach((rule) => {
      this.addRule(this.rulesDiv, rule.id);
    });
    new import_obsidian4.Setting(this.rulesControl).addButton(async (button) => {
      button.setIcon("square-plus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("add a rule");
      button.onClick(async () => {
        this.addRule(this.rulesDiv);
      });
    });
  }
  addRule(divEl, ruleUUID = "") {
    var _a;
    let cmEditor = null;
    if (ruleUUID === "") {
      ruleUUID = (0, import_crypto.randomUUID)().toString();
      this.plugin.settings.rules.push(Object.assign({}, DEFAULT_RULE_DEFINITION, {
        id: ruleUUID
      }));
    }
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleUUID);
    if (!rule)
      return;
    let propertyNameInput;
    let showFunctionButton;
    let propertyTypeDropdown;
    let propertyDevDropdown;
    let functionResultTextComponent;
    let functionTestButton;
    const rulesDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleLine" });
    rulesDiv.setAttribute("id", ruleUUID);
    const ruleOptionsDiv = divEl.createDiv({ cls: "obsidian-f2t-ruleOptions" });
    ruleOptionsDiv.style.height = "350px;";
    ruleOptionsDiv.style.alignItems = "flex-end";
    if (this.plugin.settings.useTextArea) {
      const ruleOptionsSettings = new import_obsidian4.Setting(ruleOptionsDiv).addTextArea((textArea) => {
        textArea.setPlaceholder("ender valid JS Code");
        textArea.inputEl.setAttribute("style", `height:190px; width:80%;`);
        textArea.onChange(async (value) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
          rule.jsCode = value;
          await this.plugin.saveSettings();
        });
      });
    } else {
      let jsCode = rule.jsCode;
      if (rule.content !== "script") {
        if (rule.buildInCode === "") {
          rule.buildInCode = ((_a = getRuleFunctionById(rule.content)) == null ? void 0 : _a.source) || ruleFunctions[0].source;
        }
        jsCode = rule.buildInCode;
      }
      cmEditor = window.CodeMirror(ruleOptionsDiv, {
        value: jsCode || "function (app, file, tools) { // do not change this line!\n\n  return result; // return you result.\n}",
        mode: "javascript",
        lineNumbers: true,
        // theme: "obsidian",
        indentUnit: 2,
        lineWrapping: false,
        readOnly: false
      });
      if (cmEditor) {
        cmEditor.on("change", (cmEditor2) => {
          if (functionTestButton)
            functionTestButton.buttonEl.addClass("mod-warning");
        });
        cmEditor.on("blur", (cmEditor2) => {
          if (rule.content === "script") {
            rule.jsCode = cmEditor2.getValue();
          } else {
            rule.buildInCode = cmEditor2.getValue();
          }
          this.plugin.saveSettings();
        });
      }
      ;
      new import_obsidian4.Setting(ruleOptionsDiv).addButton((button) => {
        functionTestButton = button;
        button.setWarning().setButtonText("Save & Test").onClick(async () => {
          if (cmEditor) {
            let jsCode2 = "";
            if (rule.content === "script") {
              rule.jsCode = cmEditor.getValue();
              jsCode2 = rule.jsCode;
            } else {
              rule.buildInCode = cmEditor.getValue();
              jsCode2 = rule.buildInCode;
            }
            await this.plugin.saveSettings();
            let userFunction = parseJSCode(jsCode2);
            if (typeof userFunction === "string") {
              let errorHint = "See console for details!";
              if (userFunction.contains("Unexpected token")) {
                errorHint = "Did you missed a semicolon (;)?";
              }
              if (functionResultTextComponent)
                functionResultTextComponent.setValue(`Syntax error: ${userFunction}! ${errorHint}`);
            } else {
              if (userFunction) {
                try {
                  const files = this.app.vault.getMarkdownFiles();
                  const result = userFunction(this.app, files[8], this.scriptingTools);
                  if (functionResultTextComponent)
                    functionResultTextComponent.setValue(result.toString());
                  button.buttonEl.removeClass("mod-warning");
                } catch (e) {
                  if (functionResultTextComponent) {
                    functionResultTextComponent.setValue(`Syntax error: ${e.message}! See console for details!`);
                  }
                  console.error("Syntax error. ", e, jsCode2, userFunction);
                }
              } else {
                console.error("syntax error");
              }
            }
          }
        });
      }).addText((text) => {
        functionResultTextComponent = text;
        text.setPlaceholder("function result").setDisabled(true);
        functionResultTextComponent.inputEl.style.width = "600px";
      });
    }
    function showJsFunctionButton(ruleId) {
      var _a2;
      const showCodeButton = ((_a2 = getRuleFunctionById(ruleId)) == null ? void 0 : _a2.source) !== "" || ruleId === "script";
      if (showCodeButton) {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "block";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "360px";
      } else {
        if (showFunctionButton)
          showFunctionButton.buttonEl.style.display = "none";
        if (propertyDevDropdown)
          propertyDevDropdown.selectEl.style.width = "400px";
      }
    }
    const ruleSettings = new import_obsidian4.Setting(rulesDiv).addButton((button) => {
      button.buttonEl.setAttribute("style", "width:150px; justify-content: left; ");
      button.setButtonText(rule.property || "Select Parameter");
      button.onClick(() => {
        new SelectProperty(this.app, this.knownProperties, rule.typeProperty, (result) => {
          if (result.name !== "") {
            rule.typeProperty = result;
            rule.property = result.name;
            rule.type = result.type;
            if (this.knownProperties.filter((property) => property.name.toLowerCase().includes(rule.property.toLowerCase())).length === 0) {
            }
            ;
            button.setButtonText(result.name);
            this.plugin.saveSettings();
          }
          propertyTypeDropdown.setValue(result.type);
        }).open();
      });
    }).addDropdown((dropdown) => {
      propertyTypeDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:110px");
      dropdown.addOption("", "Select a type");
      dropdown.addOption("aliases", "Aliases");
      dropdown.addOption("checkbox", "Checkbox");
      dropdown.addOption("date", "Date");
      dropdown.addOption("datetime", "Date & Time");
      dropdown.addOption("multitext", "List");
      dropdown.addOption("number", "Number");
      dropdown.addOption("tags", "Tags");
      dropdown.addOption("text", "Text");
      if (rule.type)
        dropdown.setValue(rule.type);
      dropdown.onChange(async (value) => {
        if (value !== "") {
          rule.type = value;
          await this.plugin.saveSettings();
        }
      });
    }).addDropdown((dropdown) => {
      propertyDevDropdown = dropdown;
      dropdown.selectEl.setAttribute("style", "width:400px");
      dropdown.addOption("", "Select a content");
      for (let rule2 of ruleFunctions) {
        dropdown.addOption(rule2.id, rule2.description);
      }
      dropdown.addOption("script", "JavaScript script");
      dropdown.setValue(rule.content);
      dropdown.onChange(async (value) => {
        var _a2, _b, _c;
        let jsCode = "";
        if (value !== "") {
          if (value !== "script") {
            let oldOriginalCode = ((_a2 = getRuleFunctionById(rule.content)) == null ? void 0 : _a2.source) || ruleFunctions[0].source;
            if (rule.buildInCode !== "" && rule.buildInCode !== oldOriginalCode) {
              const shouldProceed = await new AlertModal(
                this.app,
                "Overwrite existing code?",
                "I sees like you have custom code for this rule! Should this be overwritten by default code for this parameter?",
                "Yes",
                "No"
              ).openAndGetValue();
              if (shouldProceed) {
                jsCode = rule.buildInCode = ((_b = getRuleFunctionById(value)) == null ? void 0 : _b.source) || ruleFunctions[0].source;
              } else {
                jsCode = rule.buildInCode;
              }
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            } else {
              jsCode = rule.buildInCode = ((_c = getRuleFunctionById(value)) == null ? void 0 : _c.source) || ruleFunctions[0].source;
              cmEditor == null ? void 0 : cmEditor.setValue(jsCode);
            }
          } else {
            cmEditor == null ? void 0 : cmEditor.setValue(rule.jsCode !== "" ? rule.jsCode : ruleFunctions[0].source);
          }
          rule.content = value;
          showJsFunctionButton(rule.content);
          await this.plugin.saveSettings();
        }
      });
      ruleOptionsDiv.style.display = `${rule.content === "script" && rule.showContent ? "flex" : "none"}`;
    }).addButton(async (button) => {
      showFunctionButton = button;
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-function");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("show & edit code");
      button.onClick(async () => {
        rule.showContent = !rule.showContent;
        ruleOptionsDiv.style.display = `${rule.showContent ? "flex" : "none"}`;
      });
      showFunctionButton.buttonEl.style.display = "none";
    }).addButton(async (button) => {
      button.buttonEl.setAttribute("style", "width:30px");
      button.setIcon("square-minus");
      button.setClass("obsidian-f2t-smallButton");
      button.setTooltip("remove this rule");
      button.onClick(async () => {
        this.plugin.settings.rules.splice(this.plugin.settings.rules.findIndex((value) => value.id === ruleUUID));
        this.removeRule(rulesDiv);
        await this.plugin.saveSettings();
      });
    });
    showJsFunctionButton(rule.content);
    divEl.style.removeProperty("border-top");
  }
  removeRule(rulesDiv) {
    rulesDiv.remove();
  }
};

// main.ts
var FolderTagPlugin = class extends import_obsidian5.Plugin {
  //private oldFolderPaths = new Map<string, string | null>();
  async onload() {
    await this.loadSettings();
    this.tools = new ScriptingTools(this.settings);
    let noticeMessage = "Property Updater Tools\n loading ...";
    const loadingNotice = new import_obsidian5.Notice(noticeMessage, 0);
    noticeMessage = noticeMessage + "\n register events ...";
    loadingNotice.setMessage(noticeMessage);
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian5.TFile && file.extension === "md") {
          this.updateFrontmatterParameters(file, this.settings.rules, oldPath);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian5.MarkdownView) {
          const previousFile = this.app.workspace.getActiveFile();
          console.log(`closing file: `, previousFile == null ? void 0 : previousFile.path);
          if (previousFile)
            this.updateFrontmatterParameters(previousFile, this.settings.rules);
        }
      })
    );
    noticeMessage = noticeMessage + "\n initial processing ...";
    loadingNotice.setMessage(noticeMessage);
    this.app.vault.getMarkdownFiles().forEach((file) => {
    });
    noticeMessage = noticeMessage + "\ndone!";
    loadingNotice.setMessage(noticeMessage);
    setTimeout(() => {
      loadingNotice.hide();
    }, 2e3);
    this.addSettingTab(new FolderTagSettingTab(this.app, this));
  }
  async loadSettings() {
    let data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  formatTagName(name) {
    if (name === null)
      return null;
    if (name === void 0)
      return void 0;
    let formatted = name.replace(/\s+/g, this.settings.spaceReplacement);
    formatted = formatted.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, this.settings.specialCharReplacement);
    if (this.settings.lowercaseTags) {
      formatted = formatted.toLowerCase();
    }
    return formatted;
  }
  async updateFileTag(file, oldTagPath) {
    const newTagPath = this.getFolderPathForTag(file);
    const formattedNewPath = newTagPath ? this.formatTagName(newTagPath) : null;
    const newTag = formattedNewPath ? this.settings.tagPrefix + formattedNewPath : null;
    let oldTagToRemove;
    if (oldTagPath) {
      const formattedOldPath = this.formatTagName(oldTagPath);
      if (formattedOldPath) {
        oldTagToRemove = this.settings.tagPrefix + formattedOldPath;
      }
    }
    await this.updateFrontmatterTags(file, newTag, oldTagToRemove);
  }
  getFolderPathForTag(file) {
    const folder = file.parent;
    if (!folder || folder === this.app.vault.getRoot()) {
      return null;
    }
    let pathParts = [];
    let currentFolder = folder;
    while (currentFolder && currentFolder !== this.app.vault.getRoot()) {
      pathParts.unshift(currentFolder.name);
      currentFolder = currentFolder.parent;
    }
    if (this.settings.excludeRootFolder && pathParts.length > 0) {
      pathParts = pathParts.slice(1);
    }
    return pathParts.length > 0 ? pathParts.join("/") : null;
  }
  /**
   * Filters a given file and returns true if it is included in a folder or file list
   * @param file 
   * @param filterMode 'exclude'|'include'
   * @param type 'folders'|'files'
   * @returns 
   */
  filterFile(file, filterMode, type) {
    let result = false;
    const filterArray = type === "folders" ? this.settings[filterMode].selectedFolders : this.settings[filterMode].selectedFiles;
    if (filterArray.length === 0)
      return filterMode === "include" ? false : true;
    const filePath = file.path;
    const fileFolder = this.tools.getFoldersFromPath(file.path);
    const fileName = file.basename + "." + file.extension;
    if (type === "files") {
      result = filterArray.includes(filePath);
    }
    if (type === "folders") {
      filterArray.forEach((path) => {
        result = (fileFolder == null ? void 0 : fileFolder.startsWith(path.slice(1))) || false;
        if (result === true)
          return;
      });
    }
    ;
    return filterMode === "exclude" ? !result : result;
  }
  checkIfFileAllowed(file) {
    let result = false;
    if (this.settings.include.selectedFiles.length > 0) {
      result = this.filterFile(file, "include", "files");
      if (result === true)
        return result;
    }
    if (this.settings.include.selectedFolders.length > 0) {
      result = this.filterFile(file, "include", "folders");
      if (result === true)
        return result;
    }
    result = true;
    if (this.settings.exclude.selectedFiles.length > 0) {
      result = this.filterFile(file, "exclude", "files");
      if (result === false)
        return result;
    }
    if (this.settings.exclude.selectedFolders.length > 0) {
      result = this.filterFile(file, "exclude", "folders");
      if (result === false)
        return result;
    }
    return result;
  }
  formatValue(value, type) {
    switch (type) {
      case "text":
      case "tags":
      case "aliases":
      case "multitext":
        return this.tools.toYamlSafeString(value);
      case "date":
      case "datetime":
        if (typeof value === "number") {
          return new Date(value).toISOString();
        }
        return value.toString();
      case "checkbox":
        return value ? "true" : "false";
      case "number":
        return Number(value);
      default:
        return this.tools.toYamlSafeString(value);
    }
  }
  async updateFrontmatterParameters(file, rules, oldPath) {
    if (!this.checkIfFileAllowed(file)) {
      console.log(`file ${file.path} rejected!`);
      return;
    }
    const currentPathTag = this.formatTagName(this.tools.getFoldersFromPath(file.path));
    const oldPathTag = this.formatTagName(this.tools.getFoldersFromPath(oldPath));
    if (oldPathTag)
      console.log(`update file: "${oldPathTag}" to "${currentPathTag}"`);
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = (cache == null ? void 0 : cache.frontmatter) || {};
    let fxResult;
    const parameterTypes = {};
    rules.forEach((rule) => {
      if (rule.content === "script") {
        const ruleFunction = parseJSCode(rule.jsCode);
        if (typeof ruleFunction !== "function")
          return;
        fxResult = ruleFunction(this.app, file, this.tools);
      } else {
        const functionIndex = ruleFunctions.findIndex((fx) => fx.id === rule.content);
        if (functionIndex !== -1) {
          fxResult = ruleFunctions[functionIndex].fx(this.app, file, this.tools);
        }
      }
      frontmatter[rule.content] = fxResult;
      parameterTypes[rule.property] = rule.type;
    });
    if (!frontmatter.hasOwnProperty("tags"))
      frontmatter.tags = [];
    if (frontmatter.tags === null)
      frontmatter.tags = [];
    if (oldPath) {
      if (frontmatter.tags.includes(oldPathTag)) {
        let index = frontmatter.tags.indexOf(oldPathTag);
        if (currentPathTag !== "") {
          frontmatter.tags.splice(frontmatter.tags.indexOf(oldPathTag), 1, currentPathTag);
        } else {
          frontmatter.tags.splice(frontmatter.tags.indexOf(oldPathTag), 1);
        }
        console.log(`replace Tag "${oldPathTag}" by "${currentPathTag}"`);
      } else {
        if (currentPathTag !== "")
          frontmatter.tags.push(currentPathTag);
        console.log(`add Tag "${currentPathTag}" can't find "${oldPathTag}"`);
      }
    } else {
      if (currentPathTag !== "") {
        if (frontmatter.tags.indexOf(currentPathTag) < 0) {
          frontmatter.tags.push(currentPathTag);
          console.log(`add Tag "${currentPathTag}"`);
        }
      }
    }
    let newFrontmatter = "---\n";
    Object.keys(frontmatter).forEach((key) => {
      if (typeof frontmatter[key] === "object") {
        if (Array.isArray(frontmatter[key])) {
          newFrontmatter += `${this.tools.toYamlSafeString(key)}:
`;
          for (let item of frontmatter[key]) {
            newFrontmatter += `  - ${this.formatValue(item, parameterTypes[key])}
`;
          }
        } else {
          console.error("Can't write objects to YAML", key, frontmatter[key]);
        }
      } else {
        newFrontmatter += `${this.tools.toYamlSafeString(key)}: ${this.formatValue(frontmatter[key], parameterTypes[key])}
`;
      }
    });
    newFrontmatter += "---\n";
    let endOfFrontmatter = content.indexOf("---\n", 3);
    content = newFrontmatter + content.slice(endOfFrontmatter + 4);
    await this.app.vault.modify(file, content);
  }
  async updateFrontmatterTags(file, newTag, oldTagToRemove) {
    let content = await this.app.vault.read(file);
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    let existingTags = [];
    if (frontmatter && frontmatter[this.settings.tagsPropertyName]) {
      const tagsValue = frontmatter[this.settings.tagsPropertyName];
      if (Array.isArray(tagsValue)) {
        existingTags = tagsValue.filter((tag) => tag != null).map((tag) => String(tag));
      } else if (typeof tagsValue === "string") {
        existingTags = tagsValue.split(/,\s*/).map((tag) => tag.trim()).filter((tag) => tag.length > 0);
      }
    }
    existingTags = existingTags.filter((tag) => {
      if (tag == null)
        return false;
      if (!tag.startsWith(this.settings.tagPrefix))
        return true;
      const tagWithoutPrefix = tag.slice(this.settings.tagPrefix.length);
      return !tagWithoutPrefix.includes("/");
    });
    if (oldTagToRemove) {
      existingTags = existingTags.filter((tag) => tag !== oldTagToRemove);
    }
    if (newTag && !existingTags.includes(newTag)) {
      existingTags.push(newTag);
    }
    let newFrontmatter = {};
    if (frontmatter) {
      newFrontmatter = { ...frontmatter };
      delete newFrontmatter[this.settings.tagsPropertyName];
    }
    let newContent = "";
    if (content.startsWith("---")) {
      const frontmatterEnd = content.indexOf("---", 3) + 3;
      const bodyContent = content.slice(frontmatterEnd);
      let frontmatterContent = Object.entries(newFrontmatter).map(([key, value]) => `${key}: ${value}`).join("\n");
      if (existingTags.length > 0) {
        frontmatterContent += `
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n");
      }
      newContent = `---
${frontmatterContent}
---${bodyContent}`;
    } else {
      if (existingTags.length > 0) {
        newContent = `---
${this.settings.tagsPropertyName}:
` + existingTags.map((tag) => `  - ${tag}`).join("\n") + `
---

${content}`;
      } else {
        return;
      }
    }
    await this.app.vault.modify(file, newContent);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2Zyb250bWF0dGVyLXRvb2xzLnRzIiwgInNyYy90b29scy50cyIsICJzcmMvcnVsZXMudHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9hbGVydEJveC50cyIsICJzcmMvZGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgUGx1Z2luLCBNYXJrZG93blZpZXcsIFBsdWdpbk1hbmlmZXN0LCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIFRleHRDb21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBOb3RpY2V9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCAqIGFzIGZtVG9vbHMgZnJvbSAnLi9zcmMvZnJvbnRtYXR0ZXItdG9vbHMnO1xuaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbi8vaW1wb3J0IHsgRm9sZGVyVGFnU2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzLXByb3BlcnRpZXMnO1xuaW1wb3J0IHsgcnVsZUZ1bmN0aW9ucyB9IGZyb20gJy4vc3JjL3J1bGVzJztcbmltcG9ydCB7IHBhcnNlSlNDb2RlLCBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vc3JjL3Rvb2xzJztcbmltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTLCBGb2xkZXJUYWdSdWxlRGVmaW5pdGlvbiwgUHJvcGVydHlUeXBlSW5mb30gZnJvbSAnLi9zcmMvdHlwZXMnXG5pbXBvcnQgeyBydW5JbkNvbnRleHQgfSBmcm9tICd2bSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlclRhZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEZvbGRlclRhZ1NldHRpbmdzO1xuICAgIHByaXZhdGUgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xuICAgIC8vcHJpdmF0ZSBvbGRGb2xkZXJQYXRocyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmcgfCBudWxsPigpO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9ICdQcm9wZXJ0eSBVcGRhdGVyIFRvb2xzXFxuIGxvYWRpbmcgLi4uJztcbiAgICAgICAgY29uc3QgbG9hZGluZ05vdGljZSA9IG5ldyBOb3RpY2Uobm90aWNlTWVzc2FnZSwwKVxuICAgICAgICAvKlxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIGZvbGRlciBwYXRocyBmb3IgYWxsIGZpbGVzXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgKi9cbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuIHJlZ2lzdGVyIGV2ZW50cyAuLi4nO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG4gICAgICAgIC8vIEZpbGUgY3JlYXRpb24gaGFuZGxlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgKGZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSkpO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMudXBkYXRlRmlsZVRhZyhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBGaWxlIHJlbmFtZS9tb3ZlIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnN0IG9sZFRhZ1BhdGggPSB0aGlzLm9sZEZvbGRlclBhdGhzLmdldChvbGRQYXRoKSA/PyBudWxsO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnN0IG5ld1RhZ1BhdGggPSB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5vbGRGb2xkZXJQYXRocy5zZXQoZmlsZS5wYXRoLCBuZXdUYWdQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcywgb2xkUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgdXBkYXRlIHdoZW4gbW92aW5nIHRvL2Zyb20gcm9vdCBmb2xkZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFRhZ1BhdGggIT09IG5ld1RhZ1BhdGggfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAob2xkVGFnUGF0aCAhPT0gbnVsbCAmJiBuZXdUYWdQYXRoID09PSBudWxsKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgIChvbGRUYWdQYXRoID09PSBudWxsICYmIG5ld1RhZ1BhdGggIT09IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMudXBkYXRlRmlsZVRhZyhmaWxlLCBvbGRUYWdQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gRmlsZSBjbG9zZSBoYW5kbGVyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKGxlYWYpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobGVhZj8udmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c0ZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgY2xvc2luZyBmaWxlOiBgLCBwcmV2aW91c0ZpbGU/LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNGaWxlKSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycyhwcmV2aW91c0ZpbGUsIHRoaXMuc2V0dGluZ3MucnVsZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuIGluaXRpYWwgcHJvY2Vzc2luZyAuLi4nO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbCBwcm9jZXNzaW5nIG9mIGV4aXN0aW5nIGZpbGVzXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICAgICAgLy90aGlzLnVwZGF0ZUZpbGVUYWcoZmlsZSk7XG4gICAgICAgICAgICAvL3RoaXMudXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKGZpbGUsIHRoaXMuc2V0dGluZ3MucnVsZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuZG9uZSEnO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG4gICAgICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgICAgIGxvYWRpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICB9LDIwMDApXG5cbiAgICAgICAgLy8gQWRkIHNldHRpbmdzIHRhYlxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEZvbGRlclRhZ1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGxldCBkYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgZGF0YSk7XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZvcm1hdFRhZ05hbWUobmFtZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWR7XG4gICAgICAgIGlmIChuYW1lID09PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpcnN0IHJlcGxhY2Ugc3BhY2VzIGFjY29yZGluZyB0byBzZXR0aW5nc1xuICAgICAgICBsZXQgZm9ybWF0dGVkID0gbmFtZS5yZXBsYWNlKC9cXHMrL2csIHRoaXMuc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChwcmVzZXJ2aW5nIGxldHRlcnMgd2l0aCBkaWFjcml0aWNzKVxuICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZSgvW15hLXpBLVowLTlcXC1fXFwvXHUwMEU0XHUwMEY2XHUwMEZDXHUwMERGXHUwMEM0XHUwMEQ2XHUwMERDXHUwMEUxXHUwMEU5XHUwMEVEXHUwMEYzXHUwMEZBXHUwMEZEXHUwMEMxXHUwMEM5XHUwMENEXHUwMEQzXHUwMERBXHUwMEREXHUwMEUwXHUwMEU4XHUwMEVDXHUwMEYyXHUwMEY5XHUwMEMwXHUwMEM4XHUwMENDXHUwMEQyXHUwMEQ5XHUwMEUyXHUwMEVBXHUwMEVFXHUwMEY0XHUwMEZCXHUwMEMyXHUwMENBXHUwMENFXHUwMEQ0XHUwMERCXHUwMEUzXHUwMEYxXHUwMEY1XHUwMEMzXHUwMEQxXHUwMEQ1XS9nLCB0aGlzLnNldHRpbmdzLnNwZWNpYWxDaGFyUmVwbGFjZW1lbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udmVydCB0byBsb3dlcmNhc2UgaWYgY29uZmlndXJlZFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5sb3dlcmNhc2VUYWdzKSB7XG4gICAgICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZUZpbGVUYWcoZmlsZTogVEZpbGUsIG9sZFRhZ1BhdGg/OiBzdHJpbmcgfCBudWxsKSB7XG4gICAgICAgIGNvbnN0IG5ld1RhZ1BhdGggPSB0aGlzLmdldEZvbGRlclBhdGhGb3JUYWcoZmlsZSk7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZE5ld1BhdGggPSBuZXdUYWdQYXRoID8gdGhpcy5mb3JtYXRUYWdOYW1lKG5ld1RhZ1BhdGgpIDogbnVsbDtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG1vdmluZyB0byByb290LCBuZXdUYWcgd2lsbCBiZSBudWxsXG4gICAgICAgIGNvbnN0IG5ld1RhZyA9IGZvcm1hdHRlZE5ld1BhdGggPyB0aGlzLnNldHRpbmdzLnRhZ1ByZWZpeCArIGZvcm1hdHRlZE5ld1BhdGggOiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gRm9ybWF0IHRoZSBvbGQgdGFnIGZvciByZW1vdmFsXG4gICAgICAgIGxldCBvbGRUYWdUb1JlbW92ZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob2xkVGFnUGF0aCkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkT2xkUGF0aCA9IHRoaXMuZm9ybWF0VGFnTmFtZShvbGRUYWdQYXRoKTtcbiAgICAgICAgICAgIGlmIChmb3JtYXR0ZWRPbGRQYXRoKSB7XG4gICAgICAgICAgICAgICAgb2xkVGFnVG9SZW1vdmUgPSB0aGlzLnNldHRpbmdzLnRhZ1ByZWZpeCArIGZvcm1hdHRlZE9sZFBhdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUZyb250bWF0dGVyVGFncyhmaWxlLCBuZXdUYWcsIG9sZFRhZ1RvUmVtb3ZlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEZvbGRlclBhdGhGb3JUYWcoZmlsZTogVEZpbGUpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZmlsZS5wYXJlbnQ7XG4gICAgICAgIGlmICghZm9sZGVyIHx8IGZvbGRlciA9PT0gdGhpcy5hcHAudmF1bHQuZ2V0Um9vdCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwYXRoUGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBjdXJyZW50Rm9sZGVyOiBURm9sZGVyIHwgbnVsbCA9IGZvbGRlcjtcblxuICAgICAgICB3aGlsZSAoY3VycmVudEZvbGRlciAmJiBjdXJyZW50Rm9sZGVyICE9PSB0aGlzLmFwcC52YXVsdC5nZXRSb290KCkpIHtcbiAgICAgICAgICAgIHBhdGhQYXJ0cy51bnNoaWZ0KGN1cnJlbnRGb2xkZXIubmFtZSk7XG4gICAgICAgICAgICBjdXJyZW50Rm9sZGVyID0gY3VycmVudEZvbGRlci5wYXJlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlUm9vdEZvbGRlciAmJiBwYXRoUGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcGF0aFBhcnRzID0gcGF0aFBhcnRzLnNsaWNlKDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBhdGhQYXJ0cy5sZW5ndGggPiAwID8gcGF0aFBhcnRzLmpvaW4oJy8nKSA6IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlsdGVycyBhIGdpdmVuIGZpbGUgYW5kIHJldHVybnMgdHJ1ZSBpZiBpdCBpcyBpbmNsdWRlZCBpbiBhIGZvbGRlciBvciBmaWxlIGxpc3RcbiAgICAgKiBAcGFyYW0gZmlsZSBcbiAgICAgKiBAcGFyYW0gZmlsdGVyTW9kZSAnZXhjbHVkZSd8J2luY2x1ZGUnXG4gICAgICogQHBhcmFtIHR5cGUgJ2ZvbGRlcnMnfCdmaWxlcydcbiAgICAgKiBAcmV0dXJucyBcbiAgICAgKi9cbiAgICBmaWx0ZXJGaWxlKGZpbGU6IFRGaWxlLCBmaWx0ZXJNb2RlOiBzdHJpbmcsIHR5cGU6c3RyaW5nKTpib29sZWFuIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBmaWx0ZXJBcnJheSA9ICh0eXBlPT09J2ZvbGRlcnMnKSA/IHRoaXMuc2V0dGluZ3NbZmlsdGVyTW9kZV0uc2VsZWN0ZWRGb2xkZXJzIDogdGhpcy5zZXR0aW5nc1tmaWx0ZXJNb2RlXS5zZWxlY3RlZEZpbGVzO1xuICAgICAgICBpZiAoZmlsdGVyQXJyYXkubGVuZ3RoID09PSAwKSByZXR1cm4gKGZpbHRlck1vZGUgPT09ICdpbmNsdWRlJyk/IGZhbHNlIDogdHJ1ZTtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIGNvbnN0IGZpbGVGb2xkZXIgPSB0aGlzLnRvb2xzLmdldEZvbGRlcnNGcm9tUGF0aChmaWxlLnBhdGgpO1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWUgKyAnLicgKyBmaWxlLmV4dGVuc2lvbjtcbiAgICAgICAgXG4gICAgICAgIGlmICh0eXBlID09PSAnZmlsZXMnKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJBcnJheS5pbmNsdWRlcyhmaWxlUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXJzJykge1xuICAgICAgICAgICAgZmlsdGVyQXJyYXkuZm9yRWFjaChwYXRoID0+IHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBmaWxlRm9sZGVyPy5zdGFydHNXaXRoKHBhdGguc2xpY2UoMSkpIHx8IGZhbHNlOyAvLyByZW1vdmUgcm9vdCAnLydcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChmaWx0ZXJNb2RlID09PSAnZXhjbHVkZScpPyAhcmVzdWx0IDogcmVzdWx0O1xuICAgIH1cblxuICAgIGNoZWNrSWZGaWxlQWxsb3dlZChmaWxlOiBURmlsZSkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZmlsZXMgaW4gdGhlIGluY2x1ZGUgZmlsZXMgbGlzdFxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdpbmNsdWRlJywgJ2ZpbGVzJyk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSB0cnVlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGluY2x1ZGUtbGlzdFxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmb2xkZXJzIGluIHRoZSBpbmNsdWRlIGZvbGRlcnMgbGlzdFxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdpbmNsdWRlJywgJ2ZvbGRlcnMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybiByZXN1bHQ7IC8vIGZpbGUgaXMgaW4gYSBmb2xkZXIgaW5zaWRlIHRoZSBpbmNsdWRlLWxpc3RcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZpbGVzIGluIHRoZSBleGNsdWRlIGZpbGVzIGxpc3QuXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZpbHRlckZpbGUoZmlsZSwgJ2V4Y2x1ZGUnLCAnZmlsZXMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGV4Y2x1ZGUtbGlzdFxuICAgICAgICB9ICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoPjApIHsgLy8gdGhlcmUgYXJlIGZvbGRlcnMgaW4gdGhlIGluY2x1ZGUgZm9sZGVycyBsaXN0LlxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maWx0ZXJGaWxlKGZpbGUsICdleGNsdWRlJywgJ2ZvbGRlcnMnKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gcmVzdWx0OyAvLyBmaWxlIGlzIGluIGEgZm9sZGVyIGluc2lkZSB0aGUgaW5jbHVkZS1saXN0XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBmb3JtYXRWYWx1ZSh2YWx1ZTphbnksIHR5cGU6c3RyaW5nKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgICAgICBjYXNlICd0YWdzJzpcbiAgICAgICAgICAgIGNhc2UgJ2FsaWFzZXMnOlxuICAgICAgICAgICAgY2FzZSAnbXVsdGl0ZXh0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50b29scy50b1lhbWxTYWZlU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICAgIGNhc2UgJ2RhdGUnOlxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh2YWx1ZSkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID8gJ3RydWUnIDogJ2ZhbHNlJztcbiAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKGZpbGU6IFRGaWxlLCBydWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXSwgb2xkUGF0aD86IHN0cmluZykge1xuXG4gICAgICAgIGlmICghdGhpcy5jaGVja0lmRmlsZUFsbG93ZWQoZmlsZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBmaWxlICR7ZmlsZS5wYXRofSByZWplY3RlZCFgKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyc0Zyb21QYXRoKGZpbGUucGF0aCkpO1xuICAgICAgICBjb25zdCBvbGRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyc0Zyb21QYXRoKG9sZFBhdGgpKVxuICAgICAgICBpZiAob2xkUGF0aFRhZykgY29uc29sZS5sb2coYHVwZGF0ZSBmaWxlOiBcIiR7b2xkUGF0aFRhZ31cIiB0byBcIiR7Y3VycmVudFBhdGhUYWd9XCJgKTtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlciB8fCB7fTtcbiAgICAgICAgbGV0IGZ4UmVzdWx0OmFueTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVyVHlwZXMgPSB7fVxuXG4gICAgICAgIC8vIGFwcGx5IGFsbCBydWxlcyB0byBmcm9udG1hdHRlclxuICAgICAgICBydWxlcy5mb3JFYWNoKHJ1bGUgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBydWxlRnVuY3Rpb24gPSBwYXJzZUpTQ29kZShydWxlLmpzQ29kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBydWxlRnVuY3Rpb24gIT09ICdmdW5jdGlvbicpIHJldHVybjtcbiAgICAgICAgICAgICAgICBmeFJlc3VsdCA9IHJ1bGVGdW5jdGlvbih0aGlzLmFwcCwgZmlsZSwgdGhpcy50b29scyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uSW5kZXggPSBydWxlRnVuY3Rpb25zLmZpbmRJbmRleChmeCA9PiBmeC5pZCA9PT0gcnVsZS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25JbmRleCE9PS0xKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZXhlY3V0ZSBydWxlIGZvciAke3J1bGUucHJvcGVydHl9ICR7cnVsZS5jb250ZW50fSBmb3IgZmlsZSAke2ZpbGUucGF0aH1gKTtcbiAgICAgICAgICAgICAgICAgICAgZnhSZXN1bHQgPSBydWxlRnVuY3Rpb25zW2Z1bmN0aW9uSW5kZXhdLmZ4KHRoaXMuYXBwLCBmaWxlLCB0aGlzLnRvb2xzKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhydWxlLmNvbnRlbnQsIHJ1bGVGdW5jdGlvbnNbZnVuY3Rpb25JbmRleF0gPyBmeFJlc3VsdCA6ICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmcm9udG1hdHRlcltydWxlLmNvbnRlbnRdID0gZnhSZXN1bHQ7IC8vIHVwZGF0ZSBvciBhZGQgdGhlIG5ldyB2YWx1ZVxuICAgICAgICAgICAgcGFyYW1ldGVyVHlwZXNbcnVsZS5wcm9wZXJ0eV0gPSBydWxlLnR5cGU7IC8vIGFkZCB0eXBlcyB0byBwYXJhbWV0ZXIgbGlzdC5cbiAgICAgICAgfSlcblxuICAgICAgICAvLyB1cGRhdGUgZm9sZGVyIHRhZ1xuICAgICAgICBpZiAoIWZyb250bWF0dGVyLmhhc093blByb3BlcnR5KCd0YWdzJykpIGZyb250bWF0dGVyLnRhZ3MgPSBbXTtcbiAgICAgICAgaWYgKGZyb250bWF0dGVyLnRhZ3MgPT09IG51bGwpIGZyb250bWF0dGVyLnRhZ3MgPSBbXTtcbiAgICAgICAgaWYgKG9sZFBhdGgpIHsgXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIudGFncy5pbmNsdWRlcyhvbGRQYXRoVGFnKSkge1xuICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGZyb250bWF0dGVyLnRhZ3MuaW5kZXhPZihvbGRQYXRoVGFnKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBhdGhUYWchPT0nJykge1xuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlci50YWdzLnNwbGljZShmcm9udG1hdHRlci50YWdzLmluZGV4T2Yob2xkUGF0aFRhZyksMSxjdXJyZW50UGF0aFRhZyk7IC8vIHJlcGxhY2UgdGhlIHRhZ1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyLnRhZ3Muc3BsaWNlKGZyb250bWF0dGVyLnRhZ3MuaW5kZXhPZihvbGRQYXRoVGFnKSwxKTsgLy8gZGVsZXRlIHRoZSB0YWdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHJlcGxhY2UgVGFnIFwiJHtvbGRQYXRoVGFnfVwiIGJ5IFwiJHtjdXJyZW50UGF0aFRhZ31cImApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBhdGhUYWchPT0nJykgZnJvbnRtYXR0ZXIudGFncy5wdXNoKGN1cnJlbnRQYXRoVGFnKTsgLy8gYWRkIHRoZSB0YWdcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgYWRkIFRhZyBcIiR7Y3VycmVudFBhdGhUYWd9XCIgY2FuJ3QgZmluZCBcIiR7b2xkUGF0aFRhZ31cImApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXRoVGFnIT09JycpIHtcbiAgICAgICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIudGFncy5pbmRleE9mKGN1cnJlbnRQYXRoVGFnKTwwKXtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXIudGFncy5wdXNoKGN1cnJlbnRQYXRoVGFnKTsgLy8gYWRkIHRoZSB0YWdcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYGFkZCBUYWcgXCIke2N1cnJlbnRQYXRoVGFnfVwiYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVidWlsZCBmcm9udG1hdHRlciBZQU1MXG4gICAgICAgIGxldCBuZXdGcm9udG1hdHRlciA9ICctLS1cXG4nO1xuICAgICAgICBPYmplY3Qua2V5cyhmcm9udG1hdHRlcikuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmcm9udG1hdHRlcltrZXldID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZyb250bWF0dGVyW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyICs9IGAke3RoaXMudG9vbHMudG9ZYW1sU2FmZVN0cmluZyhrZXkpfTpcXG5gO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGZyb250bWF0dGVyW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyICs9IGAgIC0gJHt0aGlzLmZvcm1hdFZhbHVlKGl0ZW0sIHBhcmFtZXRlclR5cGVzW2tleV0pfVxcbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2FuJ3Qgd3JpdGUgb2JqZWN0cyB0byBZQU1MXCIsa2V5LCBmcm9udG1hdHRlcltrZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyICs9IGAke3RoaXMudG9vbHMudG9ZYW1sU2FmZVN0cmluZyhrZXkpfTogJHt0aGlzLmZvcm1hdFZhbHVlKGZyb250bWF0dGVyW2tleV0sIHBhcmFtZXRlclR5cGVzW2tleV0pfVxcbmBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIgKz0gJy0tLVxcbic7XG5cbiAgICAgICAgbGV0IGVuZE9mRnJvbnRtYXR0ZXIgPSBjb250ZW50LmluZGV4T2YoJy0tLVxcbicsMyk7XG4gICAgICAgIGNvbnRlbnQgPSBuZXdGcm9udG1hdHRlciArIGNvbnRlbnQuc2xpY2UoZW5kT2ZGcm9udG1hdHRlcis0KTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjb250ZW50KTtcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgdXBkYXRlRnJvbnRtYXR0ZXJUYWdzKGZpbGU6IFRGaWxlLCBuZXdUYWc6IHN0cmluZyB8IG51bGwsIG9sZFRhZ1RvUmVtb3ZlPzogc3RyaW5nKSB7XG4gICAgICAgIGxldCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZXhpc3RpbmcgdGFncyAoaGFuZGxpbmcgYm90aCBhcnJheSBhbmQgc3RyaW5nIGZvcm1hdHMpXG4gICAgICAgIGxldCBleGlzdGluZ1RhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWVdKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdzVmFsdWUgPSBmcm9udG1hdHRlclt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFnc1ZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGV4aXN0aW5nVGFncyA9IHRhZ3NWYWx1ZS5maWx0ZXIodGFnID0+IHRhZyAhPSBudWxsKS5tYXAodGFnID0+IFN0cmluZyh0YWcpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRhZ3NWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBleGlzdGluZ1RhZ3MgPSB0YWdzVmFsdWUuc3BsaXQoLyxcXHMqLylcbiAgICAgICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gdGFnLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0YWcgPT4gdGFnLmxlbmd0aCA+IDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGFueSBleGlzdGluZyBmb2xkZXIgcGF0aCB0YWdzICh3aXRoIGN1cnJlbnQgcHJlZml4KVxuICAgICAgICBleGlzdGluZ1RhZ3MgPSBleGlzdGluZ1RhZ3MuZmlsdGVyKHRhZyA9PiB7XG4gICAgICAgICAgICBpZiAodGFnID09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghdGFnLnN0YXJ0c1dpdGgodGhpcy5zZXR0aW5ncy50YWdQcmVmaXgpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHRhZ1dpdGhvdXRQcmVmaXggPSB0YWcuc2xpY2UodGhpcy5zZXR0aW5ncy50YWdQcmVmaXgubGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiAhdGFnV2l0aG91dFByZWZpeC5pbmNsdWRlcygnLycpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTcGVjaWZpY2FsbHkgcmVtb3ZlIHRoZSBvbGQgdGFnIGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChvbGRUYWdUb1JlbW92ZSkge1xuICAgICAgICAgICAgZXhpc3RpbmdUYWdzID0gZXhpc3RpbmdUYWdzLmZpbHRlcih0YWcgPT4gdGFnICE9PSBvbGRUYWdUb1JlbW92ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGhlIG5ldyB0YWcgaWYgcHJvdmlkZWQgYW5kIG5vdCBhbHJlYWR5IHByZXNlbnRcbiAgICAgICAgaWYgKG5ld1RhZyAmJiAhZXhpc3RpbmdUYWdzLmluY2x1ZGVzKG5ld1RhZykpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nVGFncy5wdXNoKG5ld1RhZyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgbGV0IG5ld0Zyb250bWF0dGVyOiBhbnkgPSB7fTtcbiAgICAgICAgaWYgKGZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlciA9IHsuLi5mcm9udG1hdHRlcn07XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIG9sZCB0YWdzIHByb3BlcnR5IHRvIGVuc3VyZSBwcm9wZXIgZm9ybWF0dGluZ1xuICAgICAgICAgICAgZGVsZXRlIG5ld0Zyb250bWF0dGVyW3RoaXMuc2V0dGluZ3MudGFnc1Byb3BlcnR5TmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlY29uc3RydWN0IHRoZSBmcm9udG1hdHRlciB3aXRoIHByb3BlciBZQU1MIGZvcm1hdFxuICAgICAgICBsZXQgbmV3Q29udGVudCA9ICcnO1xuICAgICAgICBpZiAoY29udGVudC5zdGFydHNXaXRoKCctLS0nKSkge1xuICAgICAgICAgICAgLy8gUmVwbGFjZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJFbmQgPSBjb250ZW50LmluZGV4T2YoJy0tLScsIDMpICsgMztcbiAgICAgICAgICAgIGNvbnN0IGJvZHlDb250ZW50ID0gY29udGVudC5zbGljZShmcm9udG1hdHRlckVuZCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEJ1aWxkIG5ldyBmcm9udG1hdHRlciBjb250ZW50XG4gICAgICAgICAgICBsZXQgZnJvbnRtYXR0ZXJDb250ZW50ID0gT2JqZWN0LmVudHJpZXMobmV3RnJvbnRtYXR0ZXIpXG4gICAgICAgICAgICAgICAgLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBgJHtrZXl9OiAke3ZhbHVlfWApXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgdGFncyBpbiBwcm9wZXIgWUFNTCBhcnJheSBmb3JtYXQgaWYgd2UgaGF2ZSBhbnlcbiAgICAgICAgICAgIGlmIChleGlzdGluZ1RhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZyb250bWF0dGVyQ29udGVudCArPSBgXFxuJHt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWV9OlxcbmAgK1xuICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1RhZ3MubWFwKHRhZyA9PiBgICAtICR7dGFnfWApLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdDb250ZW50ID0gYC0tLVxcbiR7ZnJvbnRtYXR0ZXJDb250ZW50fVxcbi0tLSR7Ym9keUNvbnRlbnR9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE9ubHkgY3JlYXRlIGZyb250bWF0dGVyIGlmIHdlIGhhdmUgdGFncyB0byBhZGRcbiAgICAgICAgICAgIGlmIChleGlzdGluZ1RhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQgPSBgLS0tXFxuJHt0aGlzLnNldHRpbmdzLnRhZ3NQcm9wZXJ0eU5hbWV9OlxcbmAgK1xuICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1RhZ3MubWFwKHRhZyA9PiBgICAtICR7dGFnfWApLmpvaW4oJ1xcbicpICtcbiAgICAgICAgICAgICAgICAgICAgYFxcbi0tLVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBObyB0YWdzIHRvIGFkZCwgcmV0dXJuIG9yaWdpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUZXh0Q29tcG9uZW50IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBmbVRvb2xzIGZyb20gJy4vZnJvbnRtYXR0ZXItdG9vbHMnO1xyXG5pbXBvcnQgeyBwYXJzZUpTQ29kZSwgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgZ2V0UnVsZUZ1bmN0aW9uQnlJZCwgcnVsZUZ1bmN0aW9ucywgUnVsZUZ1bmN0aW9uIH0gZnJvbSAnLi9ydWxlcyc7XHJcbmltcG9ydCB7IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uLCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiwgUHJvcGVydHlUeXBlSW5mb30gZnJvbSAnLi90eXBlcyc7XHJcbmltcG9ydCB7IEFsZXJ0TW9kYWwgfSBmcm9tICcuL2FsZXJ0Qm94JztcclxuaW1wb3J0IHsgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLCBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfSBmcm9tICcuL2RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXHJcbmltcG9ydCB7IHJhbmRvbVVVSUQgfSBmcm9tICdjcnlwdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZvbGRlclRhZ1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogYW55OyAvL0ZvbGRlclRhZ1BsdWdpbjtcclxuICAgIHJ1bGVzRGl2OiBIVE1MRGl2RWxlbWVudDtcclxuICAgIHJ1bGVzQ29udHJvbDogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBrbm93blByb3BlcnRpZXM6IFByb3BlcnR5VHlwZUluZm9bXTtcclxuICAgIGtub3duVHlwZXM6IGFueTtcclxuICAgIHNjcmlwdGluZ1Rvb2xzOiBTY3JpcHRpbmdUb29scztcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogYW55IC8qRm9sZGVyVGFnUGx1Z2luKi8pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgdGhpcy5zY3JpcHRpbmdUb29scyA9IG5ldyBTY3JpcHRpbmdUb29scyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGZtVG9vbHMuZ2V0UHJvcGVydGllc0Zyb21NZXRhZGF0YU1hbmFnZXIodGhpcy5hcHApO1xyXG4gICAgICAgIHRoaXMua25vd25UeXBlcyA9IGZtVG9vbHMuZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKHRoaXMuYXBwKTtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0ZvbGRlciBQYXRoIFRhZyBTZXR0aW5ncycgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGFnIHByZWZpeCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdPcHRpb25hbCBwcmVmaXggdG8gYWRkIGJlZm9yZSBmb2xkZXIgcGF0aCB0YWdzJylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3ByZWZpeC8nKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ1ByZWZpeClcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdQcmVmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdFeGNsdWRlIHJvb3QgZm9sZGVyJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZWQsIHRoZSByb290IGZvbGRlciBuYW1lIHdpbGwgYmUgZXhjbHVkZWQgZnJvbSB0aGUgdGFnJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZVJvb3RGb2xkZXIpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZVJvb3RGb2xkZXIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdUYWdzIHByb3BlcnR5IG5hbWUnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnRnJvbnRtYXR0ZXIgcHJvcGVydHkgbmFtZSB0byBzdG9yZSB0YWdzIChkZWZhdWx0OiBcInRhZ3NcIiknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndGFncycpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnc1Byb3BlcnR5TmFtZSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdzUHJvcGVydHlOYW1lID0gdmFsdWUgfHwgJ3RhZ3MnO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1NwYWNlIHJlcGxhY2VtZW50JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byByZXBsYWNlIHNwYWNlcyBpbiBmb2xkZXIgbmFtZXMgKGRlZmF1bHQ6IFwiX1wiKScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdfJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNwYWNlUmVwbGFjZW1lbnQgPSB2YWx1ZSB8fCAnXyc7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnU3BlY2lhbCBjaGFyYWN0ZXIgcmVwbGFjZW1lbnQnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChkZWZhdWx0OiBcIl9cIikgLSBwcmVzZXJ2ZXMgbGV0dGVycyB3aXRoIGRpYWNyaXRpY3MnKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignXycpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudClcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGVjaWFsQ2hhclJlcGxhY2VtZW50ID0gdmFsdWUgfHwgJ18nO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0NvbnZlcnQgdG8gbG93ZXJjYXNlJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NvbnZlcnQgYWxsIHRhZ3MgdG8gbG93ZXJjYXNlJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubG93ZXJjYXNlVGFncylcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb3dlcmNhc2VUYWdzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgIC5zZXROYW1lKCdFeGNsdWRlIEZpbGVzIGFuZCBGb2xkZXJzJylcclxuICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMubGVuZ3RofSBmb2xkZXJzIGFuZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHdpbGwgYmUgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGV9ZC5gKVxyXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLXgnKVxyXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0V4Y2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGUgfHwgJ2V4Y2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwgLy8gaW5jbHVkZSwgZXhjbHVkZSBvcHRpb24gaGlkZGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5tb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLmRpc3BsYXkgPSByZXN1bHQuZGlzcGxheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyAgICAgICAgICBcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgRmlsZXMgYW5kIEZvbGRlcnMnKVxyXG4gICAgICAgIC5zZXREZXNjKGBDdXJyZW50bHkgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGh9IGZvbGRlcnMgYW5kICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aH0gZmlsZXMgd2lsbCBiZSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUubW9kZX1kIGV2ZW4gd2hlbiBpbiBleGNsdWRlZCBGb2xkZXJzLmApXHJcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXItY2hlY2snKVxyXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGUgfHwgJ2luY2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwgLy8gaW5jbHVkZSwgaW5jbHVkZSBvcHRpb24gaGlkZGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5tb2RlID0gcmVzdWx0Lm1vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLmRpc3BsYXkgPSByZXN1bHQuZGlzcGxheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnUnVsZXMnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnYWRkIHJ1bGVzIHRvIHVwZGF0ZSBzZWxlY3RlZCBwYXJhbWV0ZXJzJyk7XHJcblxyXG4gICAgICAgIHRoaXMucnVsZXNEaXYgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzaWRpYW4tZjJ0LXJ1bGUtYXJlYVwiIH0pXHJcbiAgICAgICAgdGhpcy5ydWxlc0NvbnRyb2wgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzaWRpYW4tZjJ0LXJ1bGUtY29udHJvbHNcIiB9KVxyXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZvckVhY2gocnVsZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkUnVsZSh0aGlzLnJ1bGVzRGl2LHJ1bGUuaWQpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMucnVsZXNDb250cm9sKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGFzeW5jIChidXR0b24pID0+IHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRJY29uKCdzcXVhcmUtcGx1cycpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldENsYXNzKCdvYnNpZGlhbi1mMnQtc21hbGxCdXR0b24nKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRUb29sdGlwKCdhZGQgYSBydWxlJylcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFJ1bGUodGhpcy5ydWxlc0Rpdik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLyogVE9ETyBhZGQgY2xlYXIgYWxsIHJ1bGVzIGZ1bmN0aW9uYWxpdHkgXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYXN5bmMgKGJ1dHRvbikgPT4geyBcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRJY29uKCdzcXVhcmUteCcpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldENsYXNzKCdvYnNpZGlhbi1mMnQtc21hbGxCdXR0b24nKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRUb29sdGlwKCdyZW1vdmUgYWxsIHJ1bGVzJylcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVtb3ZlQWxsUnVsZXMnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgKi9cclxuICAgIH1cclxuXHJcbiAgICBhZGRSdWxlKGRpdkVsOiBIVE1MRGl2RWxlbWVudCwgcnVsZVVVSUQgPSAnJykge1xyXG4gICAgICAgIGxldCBjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IgfCBudWxsID0gbnVsbDtcclxuICAgICAgICBpZiAocnVsZVVVSUQgPT09ICcnKXtcclxuICAgICAgICAgICAgcnVsZVVVSUQgPSByYW5kb21VVUlEKCkudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMucHVzaChPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiwge1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJ1bGVVVUlELFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24gPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5maW5kKHJ1bGUgPT4gcnVsZS5pZCA9PT0gcnVsZVVVSUQpO1xyXG4gICAgICAgIGlmKCFydWxlKSByZXR1cm47XHJcbiAgICAgICAgbGV0IHByb3BlcnR5TmFtZUlucHV0IDogVGV4dENvbXBvbmVudDtcclxuICAgICAgICBsZXQgc2hvd0Z1bmN0aW9uQnV0dG9uIDogQnV0dG9uQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBwcm9wZXJ0eVR5cGVEcm9wZG93biA6IERyb3Bkb3duQ29tcG9uZW50O1xyXG4gICAgICAgIGxldCBwcm9wZXJ0eURldkRyb3Bkb3duIDogRHJvcGRvd25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudDogVGV4dENvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgZnVuY3Rpb25UZXN0QnV0dG9uOiBCdXR0b25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgcnVsZXNEaXYgPSBkaXZFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzaWRpYW4tZjJ0LXJ1bGVMaW5lXCIgfSk7XHJcbiAgICAgICAgcnVsZXNEaXYuc2V0QXR0cmlidXRlKCdpZCcscnVsZVVVSUQpXHJcbiAgICAgICAgY29uc3QgcnVsZU9wdGlvbnNEaXYgPSBkaXZFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzaWRpYW4tZjJ0LXJ1bGVPcHRpb25zXCIgfSk7XHJcbiAgICAgICAgLy9ydWxlT3B0aW9uc0Rpdi5zdHlsZS5kaXNwbGF5PSAnbm9uZSc7XHJcbiAgICAgICAgLy9ydWxlT3B0aW9uc0Rpdi5zdHlsZS53aWR0aD0gJzcwMHB4J1xyXG4gICAgICAgIHJ1bGVPcHRpb25zRGl2LnN0eWxlLmhlaWdodD0gJzM1MHB4Oyc7XHJcbiAgICAgICAgcnVsZU9wdGlvbnNEaXYuc3R5bGUuYWxpZ25JdGVtcz0gJ2ZsZXgtZW5kJztcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlVGV4dEFyZWEpIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZU9wdGlvbnNTZXR0aW5ncyA9IG5ldyBTZXR0aW5nKHJ1bGVPcHRpb25zRGl2KVxyXG4gICAgICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHRBcmVhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignZW5kZXIgdmFsaWQgSlMgQ29kZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRBcmVhLmlucHV0RWwuc2V0QXR0cmlidXRlKCdzdHlsZScsIGBoZWlnaHQ6MTkwcHg7IHdpZHRoOjgwJTtgKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uVGVzdEJ1dHRvbikgZnVuY3Rpb25UZXN0QnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLmpzQ29kZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIENvZGVNaXJyb3IgNVxyXG4gICAgICAgICAgICBsZXQganNDb2RlID0gcnVsZS5qc0NvZGU7XHJcbiAgICAgICAgICAgIGlmIChydWxlLmNvbnRlbnQgIT09ICdzY3JpcHQnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocnVsZS5idWlsZEluQ29kZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICBydWxlLmJ1aWxkSW5Db2RlID0gZ2V0UnVsZUZ1bmN0aW9uQnlJZChydWxlLmNvbnRlbnQpPy5zb3VyY2UgfHwgcnVsZUZ1bmN0aW9uc1swXS5zb3VyY2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmJ1aWxkSW5Db2RlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNtRWRpdG9yID0gKHdpbmRvdyBhcyBhbnkpLkNvZGVNaXJyb3IocnVsZU9wdGlvbnNEaXYsIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBqc0NvZGUgfHwgXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG5cXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgICAgICAgICAgICAgIG1vZGU6IFwiamF2YXNjcmlwdFwiLFxyXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAvLyB0aGVtZTogXCJvYnNpZGlhblwiLFxyXG4gICAgICAgICAgICAgICAgaW5kZW50VW5pdDogMiwgIFxyXG4gICAgICAgICAgICAgICAgbGluZVdyYXBwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlYWRPbmx5OiBmYWxzZSwgIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNtRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICBjbUVkaXRvci5vbignY2hhbmdlJywgKGNtRWRpdG9yOiBDb2RlTWlycm9yLkVkaXRvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvblRlc3RCdXR0b24pIGZ1bmN0aW9uVGVzdEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY21FZGl0b3Iub24oJ2JsdXInLCAoY21FZGl0b3I6IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5qc0NvZGUgPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byBzYXZlIHRoZSBjb2RlXHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKHJ1bGVPcHRpb25zRGl2KVxyXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25UZXN0QnV0dG9uID0gYnV0dG9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRXYXJuaW5nKClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIlNhdmUgJiBUZXN0XCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21FZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc0NvZGUgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5qc0NvZGUgPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuanNDb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmJ1aWxkSW5Db2RlID0gY21FZGl0b3IuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmJ1aWxkSW5Db2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJGdW5jdGlvbiA9ICBwYXJzZUpTQ29kZShqc0NvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB1c2VyRnVuY3Rpb24gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVycm9ySGludCA9IFwiU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJGdW5jdGlvbi5jb250YWlucygnVW5leHBlY3RlZCB0b2tlbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ySGludCA9IFwiRGlkIHlvdSBtaXNzZWQgYSBzZW1pY29sb24gKDspP1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYFN5bnRheCBlcnJvcjogJHt1c2VyRnVuY3Rpb259ISAke2Vycm9ySGludH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB1c2VyRnVuY3Rpb24odGhpcy5hcHAsIGZpbGVzWzhdLCB0aGlzLnNjcmlwdGluZ1Rvb2xzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5zZXRWYWx1ZShyZXN1bHQudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwucmVtb3ZlQ2xhc3MoJ21vZC13YXJuaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYFN5bnRheCBlcnJvcjogJHtlLm1lc3NhZ2V9ISBTZWUgY29uc29sZSBmb3IgZGV0YWlscyFgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTeW50YXggZXJyb3IuIFwiLCBlLCBqc0NvZGUsIHVzZXJGdW5jdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwic3ludGF4IGVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50ID0gdGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdmdW5jdGlvbiByZXN1bHQnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXREaXNhYmxlZCh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzYwMHB4JztcclxuXHJcbiAgICAgICAgICAgICAgICB9KSBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNob3dKc0Z1bmN0aW9uQnV0dG9uKHJ1bGVJZDpzdHJpbmcpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2hvd0NvZGVCdXR0b246Ym9vbGVhbiA9IFxyXG4gICAgICAgICAgICAgICAgKGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZUlkKT8uc291cmNlICE9PSAnJykgfHxcclxuICAgICAgICAgICAgICAgIChydWxlSWQgPT09ICdzY3JpcHQnKTtcclxuICAgICAgICAgICAgaWYgKCBzaG93Q29kZUJ1dHRvbiApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzaG93RnVuY3Rpb25CdXR0b24pIHNob3dGdW5jdGlvbkJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5RGV2RHJvcGRvd24pIHByb3BlcnR5RGV2RHJvcGRvd24uc2VsZWN0RWwuc3R5bGUud2lkdGggPSBcIjM2MHB4XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hvd0Z1bmN0aW9uQnV0dG9uKSBzaG93RnVuY3Rpb25CdXR0b24uYnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5RGV2RHJvcGRvd24pIHByb3BlcnR5RGV2RHJvcGRvd24uc2VsZWN0RWwuc3R5bGUud2lkdGggPSBcIjQwMHB4XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHJ1bGVTZXR0aW5ncyA9IG5ldyBTZXR0aW5nKHJ1bGVzRGl2KVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3dpZHRoOjE1MHB4OyBqdXN0aWZ5LWNvbnRlbnQ6IGxlZnQ7ICcpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQocnVsZS5wcm9wZXJ0eSB8fCAnU2VsZWN0IFBhcmFtZXRlcicpXHJcbiAgICAgICAgICAgICAgICBidXR0b24ub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IGZtVG9vbHMuU2VsZWN0UHJvcGVydHkodGhpcy5hcHAsIHRoaXMua25vd25Qcm9wZXJ0aWVzLCBydWxlLnR5cGVQcm9wZXJ0eSwgKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lm5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnR5cGVQcm9wZXJ0eSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUucHJvcGVydHkgPSByZXN1bHQubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudHlwZSA9IHJlc3VsdC50eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMua25vd25Qcm9wZXJ0aWVzLmZpbHRlcigocHJvcGVydHkpID0+IHByb3BlcnR5Lm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhydWxlLnByb3BlcnR5LnRvTG93ZXJDYXNlKCkpKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Byb3BlcnR5VHlwZURyb3Bkb3duLnNldERpc2FibGVkKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dChyZXN1bHQubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVR5cGVEcm9wZG93bi5zZXRWYWx1ZShyZXN1bHQudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IG5ldyB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5VHlwZURyb3Bkb3duID0gZHJvcGRvd247XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZWxlY3RFbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6MTEwcHgnKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIlwiLCBcIlNlbGVjdCBhIHR5cGVcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJhbGlhc2VzXCIsIFwiQWxpYXNlc1wiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImNoZWNrYm94XCIsIFwiQ2hlY2tib3hcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJkYXRlXCIsIFwiRGF0ZVwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImRhdGV0aW1lXCIsIFwiRGF0ZSAmIFRpbWVcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJtdWx0aXRleHRcIiwgXCJMaXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwibnVtYmVyXCIsIFwiTnVtYmVyXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwidGFnc1wiLCBcIlRhZ3NcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJ0ZXh0XCIsIFwiVGV4dFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChydWxlLnR5cGUpIGRyb3Bkb3duLnNldFZhbHVlKHJ1bGUudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAvL2Ryb3Bkb3duLnNldERpc2FibGVkKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLnR5cGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5RGV2RHJvcGRvd24gPSBkcm9wZG93bjtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDo0MDBweCcpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiXCIsIFwiU2VsZWN0IGEgY29udGVudFwiKTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHJ1bGUgb2YgcnVsZUZ1bmN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihydWxlLmlkLCBydWxlLmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJmdWxsUGF0aFwiLCBcIkZ1bGwgcGF0aCBhbmQgZmlsZW5hbWVcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJwYXRoXCIsIFwiRnVsbCBwYXRoXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZm9sZGVyXCIsIFwiRm9sZGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwicm9vdEZvbGRlclwiLCBcIlJvb3QgRm9sZGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwibmFtZVwiLCBcIkZpbGVuYW1lXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwibmFtZUV4dFwiLCBcIkZpbGVuYW1lIHdpdGggRXh0ZW5zaW9uXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiYWxpYXNGcm9tUGF0aFwiLCBcImFkZCBhbiBBbGlhcyBmb3JtIGZ1bGwgcGF0aFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImRhdGVUaW1lQ3JlYXRlZFwiLCBcIkRhdGUgKGFuZCBUaW1lKSBjcmVhdGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiZGF0ZVRpbWVNb2RpZmllZFwiLCBcIkRhdGUgKGFuZCBUaW1lKSBtb2RpZmllZFwiKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImZpbGVTaXplQnl0ZXNcIiwgXCJGaWxlIFNpemUgaW4gQnl0ZXNcIik7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJmaWxlU2l6ZVN0cmluZ1wiLCBcIkZpbGUgU2l6ZSBhcyBUZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInNjcmlwdFwiLCBcIkphdmFTY3JpcHQgc2NyaXB0XCIpO1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUocnVsZS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBqc0NvZGUgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJ3NjcmlwdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvbGRPcmlnaW5hbENvZGUgPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHJ1bGUuY29udGVudCk/LnNvdXJjZSB8fCBydWxlRnVuY3Rpb25zWzBdLnNvdXJjZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocnVsZS5idWlsZEluQ29kZSAhPT0gJycpICYmIChydWxlLmJ1aWxkSW5Db2RlICE9PSBvbGRPcmlnaW5hbENvZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkUHJvY2VlZCA9IGF3YWl0IG5ldyBBbGVydE1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnT3ZlcndyaXRlIGV4aXN0aW5nIGNvZGU/JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJIHNlZXMgbGlrZSB5b3UgaGF2ZSBjdXN0b20gY29kZSBmb3IgdGhpcyBydWxlISBTaG91bGQgdGhpcyBiZSBvdmVyd3JpdHRlbiBieSBkZWZhdWx0IGNvZGUgZm9yIHRoaXMgcGFyYW1ldGVyPycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWWVzJywgJ05vJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLm9wZW5BbmRHZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRQcm9jZWVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuYnVpbGRJbkNvZGUgPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHZhbHVlKT8uc291cmNlIHx8IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlOyAvLyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc0NvZGUgPSBydWxlLmJ1aWxkSW5Db2RlOyAvLyBrZWVwIHRoZSBleGlzdGluZyBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtRWRpdG9yPy5zZXRWYWx1ZShqc0NvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQ29kZSA9IHJ1bGUuYnVpbGRJbkNvZGUgPSBnZXRSdWxlRnVuY3Rpb25CeUlkKHZhbHVlKT8uc291cmNlIHx8IHJ1bGVGdW5jdGlvbnNbMF0uc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtRWRpdG9yPy5zZXRWYWx1ZShqc0NvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbUVkaXRvcj8uc2V0VmFsdWUocnVsZS5qc0NvZGUhPT0nJyA/IHJ1bGUuanNDb2RlIDogcnVsZUZ1bmN0aW9uc1swXS5zb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuY29udGVudCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3J1bGVPcHRpb25zRGl2LnN0eWxlLmRpc3BsYXkgPSBgJHsocnVsZS5jb250ZW50ID09PSAnc2NyaXB0JykgPyAnZmxleCcgOiAnbm9uZSd9YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0pzRnVuY3Rpb25CdXR0b24ocnVsZS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBydWxlT3B0aW9uc0Rpdi5zdHlsZS5kaXNwbGF5ID0gYCR7KHJ1bGUuY29udGVudCA9PT0gJ3NjcmlwdCcpICYmIChydWxlLnNob3dDb250ZW50KSA/ICdmbGV4JyA6ICdub25lJ31gO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGFzeW5jIChidXR0b24pID0+IHtcclxuICAgICAgICAgICAgICAgIHNob3dGdW5jdGlvbkJ1dHRvbiA9IGJ1dHRvbjtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6MzBweCcpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEljb24oJ3NxdWFyZS1mdW5jdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldENsYXNzKCdvYnNpZGlhbi1mMnQtc21hbGxCdXR0b24nKTtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRUb29sdGlwKCdzaG93ICYgZWRpdCBjb2RlJylcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBydWxlLnNob3dDb250ZW50ID0gIXJ1bGUuc2hvd0NvbnRlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheSA9IGAkeyhydWxlLnNob3dDb250ZW50KSA/ICdmbGV4JyA6ICdub25lJ31gO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHNob3dGdW5jdGlvbkJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYXN5bmMgKGJ1dHRvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDozMHB4Jyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0SWNvbignc3F1YXJlLW1pbnVzJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0Q2xhc3MoJ29ic2lkaWFuLWYydC1zbWFsbEJ1dHRvbicpO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldFRvb2x0aXAoJ3JlbW92ZSB0aGlzIHJ1bGUnKVxyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLnNwbGljZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5maW5kSW5kZXgodmFsdWUgPT4gdmFsdWUuaWQgPT09IHJ1bGVVVUlEKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVSdWxlKHJ1bGVzRGl2KTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBzaG93SnNGdW5jdGlvbkJ1dHRvbihydWxlLmNvbnRlbnQpO1xyXG4gICAgICAgIGRpdkVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdib3JkZXItdG9wJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlUnVsZShydWxlc0RpdjogSFRNTERpdkVsZW1lbnQpIHtcclxuICAgICAgICBydWxlc0Rpdi5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBOb3RpY2UsIFN1Z2dlc3RNb2RhbCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5VHlwZUluZm8sIFByb3BlcnR5VHlwZX0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9QUk9QRVJUWV9UWVBFX0lORk86IFByb3BlcnR5VHlwZUluZm8gPSB7XHJcbiAgICBuYW1lIDogXCJcIixcclxuICAgIHR5cGUgOiBcIlwiLFxyXG4gICAgaXNBcnJheTogZmFsc2UsXHJcbiAgICB2YWx1ZXM6IFtdLFxyXG4gICAgc291cmNlOiAncmVnaXN0ZXJlZCcsXHJcbn07XHJcblxyXG4vKipcclxuICogR2V0cyBhbGwgYXZhaWxhYmxlIHByb3BlcnRpZXMgd2l0aCB0aGVpciB0eXBlIGluZm9ybWF0aW9uXHJcbiAqIEBwYXJhbSBhcHAgVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZVxyXG4gKiBAcmV0dXJucyBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gYXJyYXkgb2YgUHJvcGVydHlUeXBlSW5mb1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb3BlcnRpZXNXaXRoVHlwZXMoYXBwOiBBcHApOiBQcm9taXNlPFByb3BlcnR5VHlwZUluZm9bXT4ge1xyXG4gICAgLy8gVHJ5IHRvIGdldCByZWdpc3RlcmVkIHByb3BlcnRpZXMgKGZhbGxiYWNrIHRvIGVtcHR5IGFycmF5IGlmIEFQSSBjaGFuZ2VkKVxyXG4gICAgY29uc3QgcmVnaXN0ZXJlZFByb3BzID0gYXdhaXQgZ2V0UmVnaXN0ZXJlZFByb3BlcnRpZXNTYWZlKGFwcCk7XHJcbiAgICBcclxuICAgIC8vIEdldCBhZGRpdGlvbmFsIHByb3BlcnRpZXMgZm91bmQgaW4gbm90ZXNcclxuICAgIGNvbnN0IGZpbGVQcm9wcyA9IGF3YWl0IGdldFByb3BlcnRpZXNGcm9tRmlsZXMoYXBwKTtcclxuICAgIFxyXG4gICAgLy8gQ29tYmluZSByZXN1bHRzIChmYXZvciByZWdpc3RlcmVkIHByb3BlcnRpZXMgd2hlbiBkdXBsaWNhdGVzIGV4aXN0KVxyXG4gICAgY29uc3QgY29tYmluZWQgPSBuZXcgTWFwPHN0cmluZywgUHJvcGVydHlUeXBlSW5mbz4oKTtcclxuICAgIFxyXG4gICAgLy8gQWRkIHByb3BlcnRpZXMgZm91bmQgaW4gZmlsZXMgZmlyc3RcclxuICAgIGZpbGVQcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xyXG4gICAgICAgIGNvbWJpbmVkLnNldChwcm9wLm5hbWUsIHByb3ApO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIFRoZW4gb3ZlcnJpZGUgd2l0aCByZWdpc3RlcmVkIHByb3BlcnRpZXMgKHdoaWNoIGhhdmUgbW9yZSBjb21wbGV0ZSB0eXBlIGluZm8pXHJcbiAgICByZWdpc3RlcmVkUHJvcHMuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgICBjb21iaW5lZC5zZXQocHJvcC5uYW1lLCBwcm9wKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShjb21iaW5lZC52YWx1ZXMoKSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgUHJvcGVydGllcyBmcm9tIE1ldGFkYXRhTWFuYWdlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3BlcnRpZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKGFwcDogQXBwKTogUHJvcGVydHlUeXBlSW5mb1tdIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnZXQgcHJvcGVydGllczpcIixtZXRhZGF0YU1hbmFnZXIpO1xyXG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKG1ldGFkYXRhTWFuYWdlci5wcm9wZXJ0aWVzKS5tYXAoICh2YWx1ZTphbnkpOlByb3BlcnR5VHlwZUluZm8gPT4gKHtcclxuICAgICAgICAgICAgbmFtZTogdmFsdWUubmFtZSxcclxuICAgICAgICAgICAgdHlwZTogdmFsdWUudHlwZSxcclxuICAgICAgICAgICAgY291bnQ6IHZhbHVlLmNvdW50LFxyXG4gICAgICAgICAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJ1xyXG4gICAgICAgIH0pKS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGFjY2VzcyBwcm9wZXJ0aWVzIGZyb20gTWV0YWRhdGEgTWFuYWdlclwiLCBlKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEdldCBUeXBlcyBmcm9tIE1ldGFkYXRhTWFuYWdlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFR5cGVzRnJvbU1ldGFkYXRhTWFuYWdlcihhcHA6IEFwcCk6IGFueSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhTWFuYWdlciA9IChhcHAgYXMgYW55KS5tZXRhZGF0YVR5cGVNYW5hZ2VyO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0IHR5cGVzOlwiLG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobWV0YWRhdGFNYW5hZ2VyLnJlZ2lzdGVyZWRUeXBlV2lkZ2V0cykubWFwKCAodmFsdWU6YW55LCBpbmRleCwgYXJyYXkpOlByb3BlcnR5VHlwZSAgPT4gKHtcclxuICAgICAgICAgICAgdHlwZTogdmFsdWUudHlwZSxcclxuICAgICAgICAgICAgaWNvbjogdmFsdWUuaWNvbixcclxuICAgICAgICAgICAganNUeXBlOiAnJyxcclxuICAgICAgICB9KSkuc29ydCgoYSwgYikgPT4gYS50eXBlLmxvY2FsZUNvbXBhcmUoYi50eXBlKSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZG4ndCBhY2Nlc3MgcHJvcGVydGllcyBmcm9tIE1ldGFkYXRhIE1hbmFnZXJcIiwgZSk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBTYWZlIG1ldGhvZCB0byBnZXQgcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzIHRoYXQgd29uJ3QgdGhyb3cgaWYgQVBJIGNoYW5nZXNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldFJlZ2lzdGVyZWRQcm9wZXJ0aWVzU2FmZShhcHA6IEFwcCk6IFByb21pc2U8UHJvcGVydHlUeXBlSW5mb1tdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhTWFuYWdlciA9IChhcHAgYXMgYW55KS5tZXRhZGF0YVR5cGVNYW5hZ2VyO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgaWYgKCFtZXRhZGF0YU1hbmFnZXIpIHJldHVybiBbXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBUcnkgZGlmZmVyZW50IHdheXMgdG8gZ2V0IHByb3BlcnRpZXMgYmFzZWQgb24gT2JzaWRpYW4gdmVyc2lvblxyXG4gICAgICAgIGlmICh0eXBlb2YgbWV0YWRhdGFNYW5hZ2VyLmdldEFsbEZyb250bWF0dGVyVHlwZXMgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgLy8gT2xkZXIgT2JzaWRpYW4gdmVyc2lvbnNcclxuICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJUeXBlcyA9IG1ldGFkYXRhTWFuYWdlci5nZXRBbGxGcm9udG1hdHRlclR5cGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmcm9udG1hdHRlclR5cGVzLm1hcCgobmFtZTogc3RyaW5nKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLCAvLyBEZWZhdWx0IHR5cGUgaWYgd2UgY2FuJ3QgZ2V0IG1vcmUgaW5mb1xyXG4gICAgICAgICAgICAgICAgc291cmNlOiAncmVnaXN0ZXJlZCdcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG1ldGFkYXRhTWFuYWdlci5nZXRQcm9wZXJ0aWVzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIC8vIE5ld2VyIE9ic2lkaWFuIHZlcnNpb25zIG1pZ2h0IHVzZSB0aGlzXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBtZXRhZGF0YU1hbmFnZXIuZ2V0UHJvcGVydGllcygpO1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMocHJvcGVydGllcykubWFwKChbbmFtZSwgdHlwZV06IFtzdHJpbmcsIGFueV0pID0+ICh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZW9mIHR5cGUgPT09ICdzdHJpbmcnID8gdHlwZSA6ICdzdHJpbmcnLFxyXG4gICAgICAgICAgICAgICAgc291cmNlOiAncmVnaXN0ZXJlZCdcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgYWNjZXNzIHJlZ2lzdGVyZWQgcHJvcGVydGllczpcIiwgZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTY2FucyBmaWxlcyBmb3IgYWRkaXRpb25hbCBwcm9wZXJ0aWVzIHdpdGggdHlwZSBpbmZlcmVuY2VcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldFByb3BlcnRpZXNGcm9tRmlsZXMoYXBwOiBBcHApOiBQcm9taXNlPFByb3BlcnR5VHlwZUluZm9bXT4ge1xyXG4gICAgY29uc3QgZmlsZXMgPSBhcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgY29uc3QgcHJvcGVydHlNYXAgPSBuZXcgTWFwPHN0cmluZywgeyB2YWx1ZXM6IFNldDxhbnk+LCB0eXBlczogU2V0PHN0cmluZz4gfT4oKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzLnNsaWNlKDAsIDEwMDApKSB7IC8vIExpbWl0IHRvIDEwMDAgZmlsZXMgZm9yIHBlcmZvcm1hbmNlXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNhY2hlLmZyb250bWF0dGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdwb3NpdGlvbicpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcHJvcGVydHlNYXAuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlNYXAuc2V0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBuZXcgU2V0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlczogbmV3IFNldCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wRGF0YSA9IHByb3BlcnR5TWFwLmdldChrZXkpITtcclxuICAgICAgICAgICAgICAgICAgICBwcm9wRGF0YS52YWx1ZXMuYWRkKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBwcm9wRGF0YS50eXBlcy5hZGQoaW5mZXJUeXBlRnJvbVZhbHVlKHZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGZpbGUgJHtmaWxlLnBhdGh9OmAsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHByb3BlcnR5TWFwLmVudHJpZXMoKSkubWFwKChbbmFtZSwgZGF0YV0pID0+IHtcclxuICAgICAgICBjb25zdCB0eXBlID0gZGV0ZXJtaW5lUHJpbWFyeVR5cGUoZGF0YS50eXBlcyk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgdHlwZSxcclxuICAgICAgICAgICAgaXNBcnJheTogZGF0YS50eXBlcy5oYXMoJ2FycmF5JyksXHJcbiAgICAgICAgICAgIHZhbHVlczogZGF0YS52YWx1ZXMuc2l6ZSA+IDAgPyBBcnJheS5mcm9tKGRhdGEudmFsdWVzKS5tYXAoU3RyaW5nKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgc291cmNlOiAnaW5mZXJyZWQnXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRGV0ZXJtaW5lcyB0aGUgcHJpbWFyeSB0eXBlIGZyb20gYSBTZXQgb2Ygb2JzZXJ2ZWQgdHlwZXNcclxuICogQHBhcmFtIHR5cGVzIFNldCBvZiBvYnNlcnZlZCB0eXBlcyBmb3IgYSBwcm9wZXJ0eVxyXG4gKiBAcmV0dXJucyBUaGUgbW9zdCBzcGVjaWZpYyB0eXBlIHdlIGNhbiBkZXRlcm1pbmVcclxuICovXHJcbmZ1bmN0aW9uIGRldGVybWluZVByaW1hcnlUeXBlKHR5cGVzOiBTZXQ8c3RyaW5nPik6IHN0cmluZyB7XHJcbiAgICAvLyBIYW5kbGUgZW1wdHkgY2FzZSAoc2hvdWxkbid0IGhhcHBlbiBidXQgVHlwZVNjcmlwdCB3YW50cyB1cyB0byBjaGVjaylcclxuICAgIGlmICh0eXBlcy5zaXplID09PSAwKSByZXR1cm4gJ3N0cmluZyc7XHJcbiAgICBcclxuICAgIC8vIElmIG9ubHkgb25lIHR5cGUgb2JzZXJ2ZWQsIHVzZSB0aGF0XHJcbiAgICBpZiAodHlwZXMuc2l6ZSA9PT0gMSkgcmV0dXJuIHR5cGVzLnZhbHVlcygpLm5leHQoKS52YWx1ZTtcclxuICAgIFxyXG4gICAgLy8gUHJpb3JpdHkgb3JkZXIgZm9yIHR5cGUgcmVzb2x1dGlvblxyXG4gICAgY29uc3QgdHlwZVByaW9yaXR5ID0gW1xyXG4gICAgICAgICdkYXRlJyxcclxuICAgICAgICAnZGF0ZXRpbWUnLFxyXG4gICAgICAgICdib29sZWFuJyxcclxuICAgICAgICAnbnVtYmVyJyxcclxuICAgICAgICAnYXJyYXknLFxyXG4gICAgICAgICdtdWx0aXRleHQnLFxyXG4gICAgICAgICdzdHJpbmcnIC8vIGZhbGxiYWNrXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICAvLyBSZXR1cm4gdGhlIGhpZ2hlc3QgcHJpb3JpdHkgdHlwZSB3ZSBmaW5kXHJcbiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgdHlwZVByaW9yaXR5KSB7XHJcbiAgICAgICAgaWYgKHR5cGVzLmhhcyh0eXBlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZpbmFsIGZhbGxiYWNrXHJcbiAgICByZXR1cm4gJ3N0cmluZyc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCB0eXBlIGluZmVyZW5jZSB3aXRoIGJldHRlciBkYXRlIGRldGVjdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gaW5mZXJUeXBlRnJvbVZhbHVlKHZhbHVlOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gJ251bGwnO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBhcnJheSBmaXJzdFxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgYXJyYXkgZWxlbWVudCB0eXBlc1xyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50VHlwZXMgPSBuZXcgU2V0KHZhbHVlLm1hcChpbmZlclR5cGVGcm9tVmFsdWUpKTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnRUeXBlcy5zaXplID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYGFycmF5PCR7ZWxlbWVudFR5cGVzLnZhbHVlcygpLm5leHQoKS52YWx1ZX0+YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ2FycmF5JztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgYmFzaWMgdHlwZXNcclxuICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XHJcbiAgICAgICAgY2FzZSAnYm9vbGVhbic6IHJldHVybiAnYm9vbGVhbic7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzogcmV0dXJuICdudW1iZXInO1xyXG4gICAgICAgIGNhc2UgJ29iamVjdCc6IHJldHVybiAnb2JqZWN0JzsgLy8gZm9yIGZ1dHVyZSBleHBhbnNpb25cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gTXVzdCBiZSBzdHJpbmcgYXQgdGhpcyBwb2ludCAtIGNoZWNrIGZvciBzcGVjaWFsIHN0cmluZyBmb3JtYXRzXHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIC8vIElTTyBEYXRlIChZWVlZLU1NLUREKVxyXG4gICAgICAgIGlmICgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC8udGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdkYXRlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSVNPIERhdGVUaW1lXHJcbiAgICAgICAgaWYgKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn1bVCBdXFxkezJ9OlxcZHsyfTpcXGR7Mn0vLnRlc3QodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnZGF0ZXRpbWUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBPYnNpZGlhbiB0YWdcclxuICAgICAgICBpZiAodmFsdWUuc3RhcnRzV2l0aCgnIycpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAndGFnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERlZmF1bHQgdG8gc3RyaW5nXHJcbiAgICByZXR1cm4gJ3N0cmluZyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbHVlKHZhbHVlOiB1bmtub3duLCBpbmRleDogbnVtYmVyLCBhcnJheTogdW5rbm93bltdKTogdW5rbm93biB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIG5vdCBpbXBsZW1lbnRlZC4nKTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdFByb3BlcnR5IGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFByb3BlcnR5VHlwZUluZm8+IHtcclxuICAgIHByaXZhdGUgb25TdWJtaXQ6IChyZXN1bHQ6IFByb3BlcnR5VHlwZUluZm8pID0+IHZvaWQ7XHJcbiAgICBwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZDtcclxuICAgIGtub3duUHJvcGVydGllczpQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICB0eXBlZFRleHQ6IHN0cmluZztcclxuICAgIG5ld1RleHRGbGFnOiBCb29sZWFuO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yIChhcHA6QXBwLCBrbm93blByb3BlcnRpZXM6UHJvcGVydHlUeXBlSW5mb1tdLCBwcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZCwgb25TdWJtaXQ6IChyZXN1bHQ6IFByb3BlcnR5VHlwZUluZm8pID0+IHZvaWQpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcclxuICAgICAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7XHJcbiAgICAgICAgdGhpcy50eXBlZFRleHQgPSAnJztcclxuICAgICAgICB0aGlzLm5ld1RleHRGbGFnID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGtub3duUHJvcGVydGllcztcclxuICAgIH1cclxuICAgIC8vIFJldHVybnMgYWxsIGF2YWlsYWJsZSBzdWdnZXN0aW9ucy5cclxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBQcm9wZXJ0eVR5cGVJbmZvW10ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMua25vd25Qcm9wZXJ0aWVzLmZpbHRlcigocHJvcGVydHkpID0+IHByb3BlcnR5Lm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSk7XHJcbiAgICAgICAgdGhpcy5uZXdUZXh0RmxhZyA9IChyZXN1bHQubGVuZ3RoID09PSAwKTtcclxuICAgICAgICB0aGlzLnR5cGVkVGV4dCA9IHF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBvbk9wZW4oKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydHkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcih0aGlzLnByb3BlcnR5Lm5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ25vIHByb3BlcnR5IHNlbGVjdGVkIScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFRpdGxlKCdTZWxlY3Qgb3IgdHlwZSBhIHByb3BlcnR5IG5hbWUnKTtcclxuICAgIH1cclxuICAgIC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXHJcbiAgICByZW5kZXJTdWdnZXN0aW9uKHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvLCBlbDogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgZWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogcHJvcGVydHkubmFtZSB9KTtcclxuICAgICAgZWwuY3JlYXRlRWwoJ3NtYWxsJywgeyB0ZXh0OiBwcm9wZXJ0eS50eXBlIH0pO1xyXG4gICAgfVxyXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5uZXdUZXh0RmxhZyAmJiB0aGlzLnByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcGVydHkubmFtZSA9IHRoaXMudHlwZWRUZXh0O1xyXG4gICAgICAgICAgICB0aGlzLnByb3BlcnR5LnR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXQodGhpcy5wcm9wZXJ0eSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFBlcmZvcm0gYWN0aW9uIG9uIHRoZSBzZWxlY3RlZCBzdWdnZXN0aW9uLlxyXG4gICAgb25DaG9vc2VTdWdnZXN0aW9uKHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2dCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYGtleWJvYXJkICR7dGhpcy50eXBlZFRleHR9ICR7dGhpcy5uZXdUZXh0RmxhZ31gLCBwcm9wZXJ0eSlcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coJ29uQ2hvb3NlU3VnZ2VzdGlvbicsIGV2dClcclxuICAgICAgICB0aGlzLm9uU3VibWl0KHByb3BlcnR5KTtcclxuICAgIH1cclxuICB9XHJcbiIsICJpbXBvcnQgeyBGb2xkZXJUYWdTZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnXHJcbi8qKlxyXG4gKiBQYXJzZSBhIEphdmFTY3JpcHQgZnVuY3Rpb24sIGNsZWFuIGNvbW1lbnRzIGFuZCBkZWZpbmUgdGhlIGZ1bmN0aW9uIFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBqc0NvZGVcclxuICogQHJldHVybiB7Kn0gIHsoRnVuY3Rpb24gfCBzdHJpbmcgfCB1bmRlZmluZWQpfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSlNDb2RlKGpzQ29kZTpzdHJpbmcpOiBGdW5jdGlvbiB8IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgICBmdW5jdGlvbiBwYXJzZUZ1bmN0aW9uIChqc0NvZGU6IHN0cmluZyk6IEZ1bmN0aW9uIHwgc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgIGpzQ29kZSA9IGNsZWFuQ29kZVN0cmluZyhqc0NvZGUpO1xyXG4gICAgICAgIHZhciBmdW5jUmVnID0gL2Z1bmN0aW9uICpcXCgoW14oKV0qKVxcKVsgXFxuXFx0XSp7KC4qKX0vZ21pO1xyXG4gICAgICAgIHZhciBtYXRjaCA9IGZ1bmNSZWcuZXhlYyhqc0NvZGUucmVwbGFjZSgvXFxuL2csICcgJykpO1xyXG4gICAgICAgIGlmICghbWF0Y2gpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBtYXRjaFsxXS5zcGxpdCgnLCcpO1xyXG4gICAgICAgIGFyZ3MucHVzaChtYXRjaFsyXSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbiguLi5hcmdzKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdlcnJvciBwYXJzaW5nIEpTIGZ1bmN0aW9uIScsIGVycm9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVycm9yLm1lc3NhZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBwYXJzZUZ1bmN0aW9uKGpzQ29kZSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhbnMgYSBKYXZhU2NyaXB0L1R5cGVTY3JpcHQgY29kZSBzdHJpbmcgYnkgcmVtb3ZpbmcgY29tbWVudHMuXHJcbiAqIFRoaXMgZnVuY3Rpb24gaGFuZGxlcyBib3RoIHNpbmdsZS1saW5lIGNvbW1lbnRzIChgLy8gLi4uYCkgYW5kXHJcbiAqIG11bHRpLWxpbmUgY29tbWVudHMgKGAvKiAuLi4gKlxcL2ApLiBJdCBhbHNvIGNvcnJlY3RseSBoYW5kbGVzXHJcbiAqIGNvbW1lbnRzIHdpdGhpbiBzdHJpbmdzIGFuZCByZWd1bGFyIGV4cHJlc3Npb25zLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29kZVN0cmluZyBUaGUgY29kZSBzdHJpbmcgdG8gY2xlYW4uXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjbGVhbmVkIGNvZGUgc3RyaW5nIHdpdGggY29tbWVudHMgcmVtb3ZlZC5cclxuICogQHRocm93cyB7VHlwZUVycm9yfSBJZiB0aGUgaW5wdXQgaXMgbm90IGEgc3RyaW5nLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuQ29kZVN0cmluZyhjb2RlU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gRW5zdXJlIHRoZSBpbnB1dCBpcyBhIHN0cmluZ1xyXG4gICAgaWYgKHR5cGVvZiBjb2RlU3RyaW5nICE9PSAnc3RyaW5nJykge1xyXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnB1dCBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLy8gRmxhZ3MgdG8gdHJhY2sgdGhlIGN1cnJlbnQgcGFyc2luZyBjb250ZXh0XHJcbiAgICBsZXQgaW5NdWx0aUxpbmVDb21tZW50OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBsZXQgaW5TaW5nbGVMaW5lQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgbGV0IGluU3RyaW5nOiAnXCInIHwgXCInXCIgfCBudWxsID0gbnVsbDsgLy8gVHJhY2tzIGlmIGluc2lkZSBzaW5nbGUgb3IgZG91YmxlIHF1b3Rlc1xyXG4gICAgbGV0IGluUmVnRXhwOiBib29sZWFuID0gZmFsc2U7IC8vIFRyYWNrcyBpZiBpbnNpZGUgYSByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbFxyXG4gIFxyXG4gICAgLy8gVGhlIHJlc3VsdGluZyBzdHJpbmcgd2l0aG91dCBjb21tZW50c1xyXG4gICAgbGV0IGNsZWFuZWRDb2RlOiBzdHJpbmcgPSAnJztcclxuICAgIC8vIEN1cnJlbnQgaW5kZXggaW4gdGhlIGlucHV0IHN0cmluZ1xyXG4gICAgbGV0IGk6IG51bWJlciA9IDA7XHJcbiAgXHJcbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGlucHV0IHN0cmluZyBjaGFyYWN0ZXIgYnkgY2hhcmFjdGVyXHJcbiAgICB3aGlsZSAoaSA8IGNvZGVTdHJpbmcubGVuZ3RoKSB7XHJcbiAgICAgIGNvbnN0IGNoYXI6IHN0cmluZyA9IGNvZGVTdHJpbmdbaV07XHJcbiAgICAgIGNvbnN0IG5leHRDaGFyOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBjb2RlU3RyaW5nW2kgKyAxXTsgLy8gVXNlIHVuZGVmaW5lZCBmb3IgcG90ZW50aWFsIGVuZCBvZiBzdHJpbmdcclxuICBcclxuICAgICAgLy8gLS0tIFN0YXRlOiBJbnNpZGUgYSBtdWx0aS1saW5lIGNvbW1lbnQgLS0tXHJcbiAgICAgIGlmIChpbk11bHRpTGluZUNvbW1lbnQpIHtcclxuICAgICAgICAvLyBDaGVjayBmb3IgdGhlIGVuZCBvZiB0aGUgbXVsdGktbGluZSBjb21tZW50ICcqLydcclxuICAgICAgICBpZiAoY2hhciA9PT0gJyonICYmIG5leHRDaGFyID09PSAnLycpIHtcclxuICAgICAgICAgIGluTXVsdGlMaW5lQ29tbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgaSArPSAyOyAvLyBTa2lwIHRoZSAnKi8nXHJcbiAgICAgICAgICBjb250aW51ZTsgLy8gTW92ZSB0byB0aGUgbmV4dCBpdGVyYXRpb25cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaSsrOyAvLyBTa2lwIHRoZSBjaGFyYWN0ZXIgaW5zaWRlIHRoZSBjb21tZW50XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gLS0tIFN0YXRlOiBJbnNpZGUgYSBzaW5nbGUtbGluZSBjb21tZW50IC0tLVxyXG4gICAgICBpZiAoaW5TaW5nbGVMaW5lQ29tbWVudCkge1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB0aGUgZW5kIG9mIHRoZSBsaW5lIChuZXdsaW5lIG9yIGNhcnJpYWdlIHJldHVybilcclxuICAgICAgICBpZiAoY2hhciA9PT0gJ1xcbicgfHwgY2hhciA9PT0gJ1xccicpIHtcclxuICAgICAgICAgIGluU2luZ2xlTGluZUNvbW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEtlZXAgdGhlIG5ld2xpbmUgY2hhcmFjdGVyXHJcbiAgICAgICAgICBpKys7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaSsrOyAvLyBTa2lwIHRoZSBjaGFyYWN0ZXIgaW5zaWRlIHRoZSBjb21tZW50XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gLS0tIFN0YXRlOiBJbnNpZGUgYSBzdHJpbmcgbGl0ZXJhbCAtLS1cclxuICAgICAgaWYgKGluU3RyaW5nKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGNsb3NlcyB0aGUgc3RyaW5nXHJcbiAgICAgICAgaWYgKGNoYXIgPT09IGluU3RyaW5nKSB7XHJcbiAgICAgICAgICBpblN0cmluZyA9IG51bGw7IC8vIEV4aXQgc3RyaW5nIHN0YXRlXHJcbiAgICAgICAgfSBlbHNlIGlmIChjaGFyID09PSAnXFxcXCcpIHtcclxuICAgICAgICAgIC8vIEhhbmRsZSBlc2NhcGVkIGNoYXJhY3RlcnMgd2l0aGluIHN0cmluZ3MgKGUuZy4sIFwiaXRcXCdzXCIpXHJcbiAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBBZGQgdGhlIGJhY2tzbGFzaFxyXG4gICAgICAgICAgaSsrOyAvLyBNb3ZlIHRvIHRoZSBuZXh0IGNoYXJhY3RlciAodGhlIGVzY2FwZWQgb25lKVxyXG4gICAgICAgICAgaWYgKGkgPCBjb2RlU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY29kZVN0cmluZ1tpXTsgLy8gQWRkIHRoZSBlc2NhcGVkIGNoYXJhY3RlclxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFkZCB0aGUgY2hhcmFjdGVyIHRvIHRoZSByZXN1bHQgaWYgaXQncyBwYXJ0IG9mIHRoZSBzdHJpbmdcclxuICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICAgIGkrKztcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAgLy8gLS0tIFN0YXRlOiBJbnNpZGUgYSByZWd1bGFyIGV4cHJlc3Npb24gbGl0ZXJhbCAtLS1cclxuICAgICAgIGlmIChpblJlZ0V4cCkge1xyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGNsb3NlcyB0aGUgcmVnZXggbGl0ZXJhbFxyXG4gICAgICAgICAgLy8gTm90ZTogVGhpcyBkb2Vzbid0IGhhbmRsZSByZWdleCBmbGFncyBwZXJmZWN0bHkgYnV0IGNvdmVycyBiYXNpYyBjYXNlcy5cclxuICAgICAgICAgIGlmIChjaGFyID09PSAnLycpIHtcclxuICAgICAgICAgICAgICBpblJlZ0V4cCA9IGZhbHNlOyAvLyBFeGl0IHJlZ2V4IHN0YXRlXHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICdcXFxcJykge1xyXG4gICAgICAgICAgICAgIC8vIEhhbmRsZSBlc2NhcGVkIGNoYXJhY3RlcnMgd2l0aGluIHJlZ2V4IChlLmcuLCAvXFwvLylcclxuICAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBBZGQgdGhlIGJhY2tzbGFzaFxyXG4gICAgICAgICAgICAgIGkrKzsgLy8gTW92ZSB0byB0aGUgbmV4dCBjaGFyYWN0ZXJcclxuICAgICAgICAgICAgICBpZiAoaSA8IGNvZGVTdHJpbmcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY29kZVN0cmluZ1tpXTsgLy8gQWRkIHRoZSBlc2NhcGVkIGNoYXJhY3RlclxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBBZGQgdGhlIGNoYXJhY3RlciB0byB0aGUgcmVzdWx0IGlmIGl0J3MgcGFydCBvZiB0aGUgcmVnZXhcclxuICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgICAgICBpKys7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgIH1cclxuICBcclxuICAgICAgLy8gLS0tIERlZmF1bHQgU3RhdGU6IENoZWNrIGZvciBjb21tZW50L3N0cmluZy9yZWdleCBzdGFydHMgLS0tXHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSBtdWx0aS1saW5lIGNvbW1lbnQgJy8qJ1xyXG4gICAgICBpZiAoY2hhciA9PT0gJy8nICYmIG5leHRDaGFyID09PSAnKicpIHtcclxuICAgICAgICBpbk11bHRpTGluZUNvbW1lbnQgPSB0cnVlO1xyXG4gICAgICAgIGkgKz0gMjsgLy8gU2tpcCB0aGUgJy8qJ1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSBzaW5nbGUtbGluZSBjb21tZW50ICcvLydcclxuICAgICAgaWYgKGNoYXIgPT09ICcvJyAmJiBuZXh0Q2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgaW5TaW5nbGVMaW5lQ29tbWVudCA9IHRydWU7XHJcbiAgICAgICAgaSArPSAyOyAvLyBTa2lwIHRoZSAnLy8nXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIHN0cmluZyBsaXRlcmFsICgnIG9yIFwiKVxyXG4gICAgICBpZiAoY2hhciA9PT0gJ1wiJyB8fCBjaGFyID09PSBcIidcIikge1xyXG4gICAgICAgIGluU3RyaW5nID0gY2hhcjsgLy8gRW50ZXIgc3RyaW5nIHN0YXRlLCByZW1lbWJlcmluZyB0aGUgcXVvdGUgdHlwZVxyXG4gICAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7IC8vIEFkZCB0aGUgb3BlbmluZyBxdW90ZVxyXG4gICAgICAgIGkrKztcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWwgJy8nXHJcbiAgICAgIC8vIEJhc2ljIGNoZWNrOiBhc3N1bWVzICcvJyBpbmRpY2F0ZXMgYSByZWdleCBzdGFydCBpZiBub3QgcHJlY2VkZWQgYnkgb3BlcmF0b3JzL2tleXdvcmRzXHJcbiAgICAgIC8vIEEgbW9yZSByb2J1c3Qgc29sdXRpb24gd291bGQgcmVxdWlyZSBtb3JlIGNvbXBsZXggcGFyc2luZy5cclxuICAgICAgaWYgKGNoYXIgPT09ICcvJykge1xyXG4gICAgICAgICAgLy8gVmVyeSBiYXNpYyBjaGVjayB0byBkaWZmZXJlbnRpYXRlIGRpdmlzaW9uIGZyb20gcmVnZXggc3RhcnQuXHJcbiAgICAgICAgICAvLyBUaGlzIG1pZ2h0IG5lZWQgcmVmaW5lbWVudCBmb3IgY29tcGxleCBjYXNlcy5cclxuICAgICAgICAgIGNvbnN0IHByZXZNZWFuaW5nZnVsQ2hhciA9IGNsZWFuZWRDb2RlLnRyaW0oKS5zbGljZSgtMSk7XHJcbiAgICAgICAgICBpZiAocHJldk1lYW5pbmdmdWxDaGFyID09PSAnJyB8fCBbJygnLCAnLCcsICc9JywgJzonLCAnWycsICchJywgJyYnLCAnfCcsICc/JywgJ3snLCAnOycsICdcXG4nLCAnXFxyJ10uaW5jbHVkZXMocHJldk1lYW5pbmdmdWxDaGFyKSkge1xyXG4gICAgICAgICAgICAgIGluUmVnRXhwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBJZiBub25lIG9mIHRoZSBhYm92ZSwgaXQncyByZWd1bGFyIGNvZGU7IGFkZCBpdCB0byB0aGUgcmVzdWx0XHJcbiAgICAgIGNsZWFuZWRDb2RlICs9IGNoYXI7XHJcbiAgICAgIGkrKztcclxuICAgIH1cclxuICBcclxuICAgIC8vIFJldHVybiB0aGUgYWNjdW11bGF0ZWQgY2xlYW5lZCBjb2RlIHN0cmluZ1xyXG4gICAgcmV0dXJuIGNsZWFuZWRDb2RlO1xyXG4gIH1cclxuXHJcblxyXG4gIGV4cG9ydCBjbGFzcyBTY3JpcHRpbmdUb29scyB7XHJcbiAgICBzZXR0aW5nczogRm9sZGVyVGFnU2V0dGluZ3MgfCB1bmRlZmluZWQ7XHJcblxyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3M/OiBGb2xkZXJUYWdTZXR0aW5ncyB8IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYSBzdHJpbmcgY29tcGxpZXMgd2l0aCBJU08gU3RhbmRhcmRcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHN0ciBBbnkgc3RyaW5nXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBPcHRpb25zIHRvIGxvb2sgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgaXNJU09TdHJpbmcoXHJcbiAgICAgIHN0cjogc3RyaW5nLFxyXG4gICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgd2l0aE1pbGxpc2Vjb25kcz86IGJvb2xlYW47XHJcbiAgICAgICAgd2l0aFRpbWV6b25lPzogYm9vbGVhbjtcclxuICAgICAgICB3aXRoVGltZT86IGJvb2xlYW47XHJcbiAgICAgICAgd2l0aERhdGU/OiBib29sZWFuOyBcclxuICAgICAgfSA9IHt9XHJcbiAgICApOiBib29sZWFuIHtcclxuICAgICAgY29uc3Qge1xyXG4gICAgICAgIHdpdGhNaWxsaXNlY29uZHMgPSBmYWxzZSxcclxuICAgICAgICB3aXRoVGltZXpvbmUgPSBmYWxzZSxcclxuICAgICAgICB3aXRoVGltZSA9IHRydWUsXHJcbiAgICAgICAgd2l0aERhdGUgPSB0cnVlLCBcclxuICAgICAgfSA9IG9wdGlvbnM7XHJcbiAgICBcclxuICAgICAgbGV0IGRhdGVSZWdleFN0ciA9IFwiXig/OlxcXFxkezR9LSg/OjBbMS05XXwxWzAtMl0pLSg/OjBbMS05XXxbMTJdXFxcXGR8M1swMV0pKVwiO1xyXG4gICAgICBsZXQgdGltZVJlZ2V4U3RyID0gXCIoPzpUKD86WzAxXVxcXFxkfDJbMC0zXSk6WzAtNV1cXFxcZDpbMC01XVxcXFxkXCI7XHJcbiAgICBcclxuICAgICAgaWYgKHdpdGhNaWxsaXNlY29uZHMpIHtcclxuICAgICAgICB0aW1lUmVnZXhTdHIgKz0gXCJcXFxcLlxcXFxkezN9XCI7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBpZiAod2l0aFRpbWV6b25lKSB7XHJcbiAgICAgICAgdGltZVJlZ2V4U3RyICs9IFwiKD86WnxbKy1dKD86WzAxXVxcXFxkfDJbMC0zXSk6WzAtNV1cXFxcZCk/KT9cIjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aW1lUmVnZXhTdHIgKz0gXCIpP1wiO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgbGV0IHJlZ2V4U3RyID0gXCJcIjtcclxuICAgICAgaWYgKHdpdGhEYXRlICYmIHdpdGhUaW1lKSB7XHJcbiAgICAgICAgcmVnZXhTdHIgPSBgJHtkYXRlUmVnZXhTdHJ9JHt0aW1lUmVnZXhTdHJ9JGA7XHJcbiAgICAgIH0gZWxzZSBpZiAod2l0aERhdGUpIHtcclxuICAgICAgICByZWdleFN0ciA9IGAke2RhdGVSZWdleFN0cn0kYDtcclxuICAgICAgfSBlbHNlIGlmICh3aXRoVGltZSkge1xyXG4gICAgICAgIHJlZ2V4U3RyID0gYF4ke3RpbWVSZWdleFN0ci5zbGljZSg0KX0kYDsgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyBcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChyZWdleFN0cik7XHJcbiAgICAgIHJldHVybiByZWdleC50ZXN0KHN0cik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRyeSB0byBjb252ZXJ0IEFueSBUeXBlcyB0byBhIHNwZWNpZmljIFR5cGVcclxuICAgICAqIEBwYXJhbSBpbnB1dCBcclxuICAgICAqIEBwYXJhbSB0eXBlU3RyaW5nICdzdHJpbmcnIHwgJ251bWJlcicgfCAnYm9vbGVhbicgfCAnc3RyaW5nW10nXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgdHJ5Q29udmVydChpbnB1dDogYW55LCB0eXBlU3RyaW5nOiAnc3RyaW5nJyB8ICdudW1iZXInIHwgJ2Jvb2xlYW4nIHwgJ3N0cmluZ1tdJyk6IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBzdHJpbmdbXSB8IHVuZGVmaW5lZCB7XHJcbiAgICAgIHN3aXRjaCAodHlwZVN0cmluZykge1xyXG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICBjb25zdCBudW0gPSBOdW1iZXIoaW5wdXQpO1xyXG4gICAgICAgICAgaWYgKCFpc05hTihudW0pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudW07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICBjb25zdCBsb3dlclZhbHVlID0gaW5wdXQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICBpZiAobG93ZXJWYWx1ZSA9PT0gJ3RydWUnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKGxvd2VyVmFsdWUgPT09ICdmYWxzZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgICBpZiAoaW5wdXQgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAoaW5wdXQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjYXNlICdzdHJpbmdbXSc6XHJcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkgJiYgaW5wdXQuZXZlcnkoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZm9ybWF0VG9ZQU1MU2F2ZVN0cmluZyh0ZXh0OnN0cmluZywgcmVwbGFjZUJ5OnN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCk6c3RyaW5nIHtcclxuICAgICAgbGV0IHJlcGxhY2VTdHJpbmcgPSAnLSc7XHJcbiAgICAgIGlmICghcmVwbGFjZUJ5ICYmIHRoaXMuc2V0dGluZ3MpIHtcclxuICAgICAgICByZXBsYWNlU3RyaW5nID0gdGhpcy5zZXR0aW5ncy5zcGVjaWFsQ2hhclJlcGxhY2VtZW50IHx8ICctJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocmVwbGFjZUJ5KSByZXBsYWNlU3RyaW5nID0gcmVwbGFjZUJ5O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL1teYS16QS1aMC05XFwtX1xcL1x1MDBFNFx1MDBGNlx1MDBGQ1x1MDBERlx1MDBDNFx1MDBENlx1MDBEQ1x1MDBFMVx1MDBFOVx1MDBFRFx1MDBGM1x1MDBGQVx1MDBGRFx1MDBDMVx1MDBDOVx1MDBDRFx1MDBEM1x1MDBEQVx1MDBERFx1MDBFMFx1MDBFOFx1MDBFQ1x1MDBGMlx1MDBGOVx1MDBDMFx1MDBDOFx1MDBDQ1x1MDBEMlx1MDBEOVx1MDBFMlx1MDBFQVx1MDBFRVx1MDBGNFx1MDBGQlx1MDBDMlx1MDBDQVx1MDBDRVx1MDBENFx1MDBEQlx1MDBFM1x1MDBGMVx1MDBGNVx1MDBDM1x1MDBEMVx1MDBENV0vZywgcmVwbGFjZVN0cmluZyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBzdHJpbmcgdG8gYSBZQU1MLXNhZmUgZm9ybWF0IGJ5IGFkZGluZyBxdW90ZXMgd2hlbiBuZWNlc3NhcnkuXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgVGhlIHN0cmluZywgYm9vbGVhbiwgbnVtYmVyIG9yIGFycmF5IHRvIG1ha2UgWUFNTC1zYWZlXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgc2FmZWx5IHF1b3RlZCBzdHJpbmcgd2hlbiBuZWVkZWQsIG9yIHRoZSBvcmlnaW5hbCBzdHJpbmcgaWYgc2FmZVxyXG4gICAgICovXHJcbiAgICB0b1lhbWxTYWZlU3RyaW5nKGlucHV0OiBzdHJpbmd8bnVtYmVyfGJvb2xlYW58c3RyaW5nW10pOiBzdHJpbmd8bnVtYmVyfHN0cmluZ1tdIHtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgaW5wdXQuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgIGlucHV0W2luZGV4XSA9IHRoaXMudG9ZYW1sU2FmZVN0cmluZyhpdGVtKS50b1N0cmluZygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICB9XHJcbiAgICAgIHN3aXRjaCAodHlwZW9mIGlucHV0KSB7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzogcmV0dXJuIGlucHV0O1xyXG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOiByZXR1cm4gaW5wdXQgPyAndHJ1ZScgOiAnZmFsc2UnO1xyXG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICAvLyBUcmltIHdoaXRlc3BhY2UgZmlyc3RcclxuICAgICAgICAgIGNvbnN0IHRyaW1tZWQgPSBpbnB1dC50cmltKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIEVtcHR5IHN0cmluZ3MgbmVlZCBxdW90ZXNcclxuICAgICAgICAgIGlmICh0cmltbWVkID09PSAnJykgcmV0dXJuICdcIlwiJztcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIHNwZWNpYWwgY2hhcmFjdGVycy9wYXR0ZXJucyB0aGF0IHJlcXVpcmUgcXVvdGluZ1xyXG4gICAgICAgICAgY29uc3QgbmVlZHNRdW90ZXMgPSAvWzp7fVxcW1xcXSwmKiM/fDw+PSElQGBcIidcXFxcXXxeWy0/XFxuXXxbXFxzXFxuXXxeW3lZbk5dfF5bMC05XXxeWystXXxeKHRydWV8ZmFsc2V8eWVzfG5vfG9ufG9mZikkL2kudGVzdCh0cmltbWVkKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHN0cmluZyBpcyBhbHJlYWR5IHByb3Blcmx5IHF1b3RlZFxyXG4gICAgICAgICAgY29uc3QgaXNBbHJlYWR5UXVvdGVkID0gKHRyaW1tZWQuc3RhcnRzV2l0aCgnXCInKSAmJiB0cmltbWVkLmVuZHNXaXRoKCdcIicpKSB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodHJpbW1lZC5zdGFydHNXaXRoKFwiJ1wiKSAmJiB0cmltbWVkLmVuZHNXaXRoKFwiJ1wiKSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICghbmVlZHNRdW90ZXMgJiYgIWlzQWxyZWFkeVF1b3RlZCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB0cmltbWVkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBJZiB3ZSBnZXQgaGVyZSwgd2UgbmVlZCBxdW90ZXNcclxuICAgICAgICAgIC8vIFVzZSBkb3VibGUgcXVvdGVzIGFuZCBlc2NhcGUgYW55IGV4aXN0aW5nIGRvdWJsZSBxdW90ZXNcclxuICAgICAgICAgIGlmICghaXNBbHJlYWR5UXVvdGVkKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGBcIiR7dHJpbW1lZC5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBJZiBhbHJlYWR5IHF1b3RlZCwgcmV0dXJuIGFzLWlzXHJcbiAgICAgICAgICByZXR1cm4gdHJpbW1lZDtcclxuICAgICAgICBkZWZhdWx0OiBcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYHRvWWFtbFNhZmVTdHJpbmcoJHtpbnB1dH0pIGlmIG9mIHR5cGUgJyR7dHlwZW9mIGlucHV0fSdgKTtcclxuICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlcGxhY2VTcGFjZXModGV4dDpzdHJpbmcsIHJlcGxhY2VCeTpzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOnN0cmluZyB7XHJcbiAgICAgIGxldCByZXBsYWNlU3RyaW5nID0gJ18nO1xyXG4gICAgICBpZiAoIXJlcGxhY2VCeSAmJiB0aGlzLnNldHRpbmdzKSB7XHJcbiAgICAgICAgcmVwbGFjZVN0cmluZyA9IHRoaXMuc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudCB8fCAnXyc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHJlcGxhY2VCeSkgcmVwbGFjZVN0cmluZyA9IHJlcGxhY2VCeTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9cXHMrL2csIHJlcGxhY2VTdHJpbmcpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdENhbWVsQ2FzZSh0ZXh0OnN0cmluZyk6c3RyaW5nIHtcclxuICAgICAgbGV0IHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoJyAnKTtcclxuICAgICAgbGV0IGNvbnZlcnRlZFRleHRQYXJ0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgICB0ZXh0UGFydHMuZm9yRWFjaCgodGV4dCxpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXdUZXh0UGFydCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBpZiAoaW5kZXg+MCkgbmV3VGV4dFBhcnQgPSBuZXdUZXh0UGFydC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5ld1RleHRQYXJ0LnNsaWNlKDEpO1xyXG4gICAgICAgIGNvbnZlcnRlZFRleHRQYXJ0cy5wdXNoKG5ld1RleHRQYXJ0KTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBjb252ZXJ0ZWRUZXh0UGFydHMuam9pbignJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0VXBwZXJDYW1lbENhc2UodGV4dDpzdHJpbmcpOnN0cmluZyB7XHJcbiAgICAgIGxldCB0ZXh0UGFydHMgPSB0ZXh0LnNwbGl0KCcgJyk7XHJcbiAgICAgIGxldCBjb252ZXJ0ZWRUZXh0UGFydHM6c3RyaW5nW10gPSBbXTtcclxuICAgICAgdGV4dFBhcnRzLmZvckVhY2goKHRleHQsaW5kZXgpID0+IHtcclxuICAgICAgICBsZXQgbmV3VGV4dFBhcnQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgbmV3VGV4dFBhcnQgPSBuZXdUZXh0UGFydC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5ld1RleHRQYXJ0LnNsaWNlKDEpO1xyXG4gICAgICAgIGNvbnZlcnRlZFRleHRQYXJ0cy5wdXNoKG5ld1RleHRQYXJ0KTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBjb252ZXJ0ZWRUZXh0UGFydHMuam9pbignJyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGdldCB0aGUgcGF0aCB0byBhIGZpbGUgZnJvbSBhIHN0cmluZyBjb250YWluaW5nIHRoZSBmdWxsIHBhcmgvbmFtZSBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBwYXRoIHN0cmluZ1xyXG4gICAgICogQHBhcmFtIHNlcGFyYXRvciBzdHJpbmcgZGVmYXVsdHMgdG8gJy8nXHJcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9sZGVyc0Zyb21QYXRoIChwYXRoOnN0cmluZ3xudWxsfHVuZGVmaW5lZCwgc2VwYXJhdG9yID0gJy8nKSB7XHJcbiAgICAgICAgaWYgKHBhdGggPT09IG51bGwpIHJldHVybiBudWxsO1xyXG4gICAgICAgIGlmIChwYXRoID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFBhdGhQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBjdXJyZW50UGF0aFBhcnRzLnBvcCgpOyAvLyByZW1vdmUgRmlsZSBuYW1lO1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50UGF0aFBhcnRzLmpvaW4oc2VwYXJhdG9yKTtcclxuICAgIH1cclxuICB9IiwgImltcG9ydCB7IEFwcCwgcmVuZGVyUmVzdWx0cywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scydcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUnVsZUZ1bmN0aW9uIHtcclxuICAgIGlkOnN0cmluZztcclxuICAgIGRlc2NyaXB0aW9uOnN0cmluZztcclxuICAgIHRvb2x0aXA/OiBzdHJpbmc7XHJcbiAgICBzb3VyY2U6c3RyaW5nO1xyXG4gICAgZng6RnVuY3Rpb247XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBydWxlRnVuY3Rpb25zOlJ1bGVGdW5jdGlvbltdPVtdO1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnVsZUZ1bmN0aW9uQnlJZCAoaWQgOiBzdHJpbmcpOlJ1bGVGdW5jdGlvbiB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gcnVsZUZ1bmN0aW9ucy5maW5kKHJ1bGUgPT4gcnVsZS5pZCA9PT0gaWQpO1xyXG59XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RlZmF1bHQnLFxyXG4gICAgZGVzY3JpcHRpb246ICdQYXNzIHBhcmFtZXRlcicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OiBmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZnVsbFBhdGgnLFxyXG4gICAgZGVzY3JpcHRpb246ICdGdWxsIHBhdGggYW5kIGZpbGVuYW1lJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCByZXN1bHQgPSBmaWxlLnBhdGg7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OiBmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICAgICAgcmV0dXJuIGAke2ZpbGUucGF0aH1gO1xyXG4gICAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2FsaWFzRnJvbVBhdGgnLFxyXG4gICAgZGVzY3JpcHRpb246ICdBbiBBbGlhcyBmcm9tIGV2ZXJ5IGZvbGRlciBvZiB0aGUgZmlsZSBQYXRoJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBsZXQgcGF0aEFycmF5ID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICBwYXRoQXJyYXkucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWUgd2l0aCBleHRlbnNpb25cXG4gIHBhdGhBcnJheSA9IHBhdGhBcnJheS5tYXAoKGRpcikgPT4gdG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZGlyKSk7IC8vIGNvbnZlcnQgdG8gVXBwZXJDYW1lbENhc2VcXG4gIGNvbnN0IGZpbGVOYW1lUGFydHMgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcXG4gIGlmIChmaWxlTmFtZVBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgZmlsZU5hbWVQYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIEV4dGVuc2lvblxcbiAgfVxcbiAgY29uc3QgZmlsZU5hbWUgPSBmaWxlTmFtZVBhcnRzLmpvaW4oJy4nKTsgLy8gcmVidWlsZCBmaWxlIE5hbWVcXG4gIHBhdGhBcnJheS5wdXNoKHRvb2xzLmZvcm1hdFVwcGVyQ2FtZWxDYXNlKGZpbGVOYW1lKSk7IC8vIGFkZCBmaWxlIG5hbWUgd2l0aG91dCBleHRlbnNpb24gYW5kIGluIFVwcGVyQ2FtZWxDYXNlXFxuICBjb25zdCByZXN1bHQgPSBwYXRoQXJyYXkuam9pbignLicpIHx8ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDogZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgICAgIGxldCBwYXRoQXJyYXkgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgcGF0aEFycmF5LnBvcCgpOyAvLyByZW1vdmUgRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uXHJcbiAgICAgICAgICAgIHBhdGhBcnJheSA9IHBhdGhBcnJheS5tYXAoKGRpcikgPT4gdG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZGlyKSk7IC8vIGNvbnZlcnQgdG8gdXBwZXIgY2FtZWxDYXNlXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lUGFydHMgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgaWYgKGZpbGVOYW1lUGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBmaWxlTmFtZVBhcnRzLnBvcCgpOyAvLyByZW1vdmUgRXh0ZW5zaW9uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlTmFtZVBhcnRzLmpvaW4oJy4nKTsgLy8gcmVidWlsZCBmaWxlIE5hbWVcclxuICAgICAgICAgICAgcGF0aEFycmF5LnB1c2godG9vbHMuZm9ybWF0VXBwZXJDYW1lbENhc2UoZmlsZU5hbWUpKTsgLy8gYWRkIGZpbGUgbmFtZSB3aXRob3V0IGV4dGVuc2lvbiBhbmQgaW4gdXBwZXJDYW1lbENhc2VcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcGF0aEFycmF5LmpvaW4oJy4nKSB8fCAnJztcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidwYXRoJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBQYXRoJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIHBhcnRzLnBvcCgpO1xyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmb2xkZXInLFxyXG4gICAgZGVzY3JpcHRpb246ICdGb2xkZXJuYW1lJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICByZXN1bHQgPSBwYXJ0c1twYXJ0cy5sZW5ndGgtMl07XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHBhcnRzW3BhcnRzLmxlbmd0aC0yXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZm9sZGVycycsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0FsbCBmb2xkZXJzIG9mIHRoZSBmaWxlIGFzIGEgbGlzdCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoOyAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcmVzdWx0ID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgcmVzdWx0LnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcmVzdWx0LnBvcCgpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J3Jvb3RGb2xkZXInLFxyXG4gICAgZGVzY3JpcHRpb246ICdSb290IGZvbGRlcicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcmVzdWx0ID0gcGFydHNbMF07XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHBhcnRzWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOiduYW1lJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRmlsZSBuYW1lJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBuYW1lXFxuICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcXG4gIHJlc3VsdC5wb3AoKTsgLy8gcmVtb3ZlIGV4dGVuc2lvblxcbiAgcmVzdWx0LmpvaW4oJy4nKTsgLy8gcmVjb25zdHJ1Y3QgdGhlIGZpbGUgbmFtZVxcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgIHJlc3VsdC5wb3AoKTsgLy8gcmVtb3ZlIGV4dGVuc2lvblxyXG4gICAgICAgIHJlc3VsdC5qb2luKCcuJyk7IC8vIHJlY29uc3RydWN0IHRoZSBmaWxlIG5hbWVcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOiduYW1lRXh0JyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBuYW1lXFxuICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWU7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBuYW1lXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RhdGVUaW1lQ3JlYXRlZCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGUgKGFuZCBUaW1lKSBjcmVhdGVkJywgLy8gVE9ETyBDaGVjayB0aW1lIHpvbmVzLiBcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgRGF0ZSBhbmQgVGltZXIgZmlsZSBjcmVhdGVkXFxuICBjb25zdCBkYXRlVGltZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5jdGltZSk7XFxuICBjb25zdCByZXN1bHQgPSBkYXRlVGltZS50b0lTT1N0cmluZygpLnNwbGl0KCcuJylbMF07XFxuICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IFxyXG4gICAgICAgIC8vIGFjcXVpcmUgRGF0ZSBhbmQgVGltZXIgZmlsZSBjcmVhdGVkXHJcbiAgICAgICAgY29uc3QgZGF0ZVRpbWUgPSBuZXcgRGF0ZShmaWxlLnN0YXQuY3RpbWUpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGRhdGVUaW1lLnRvSVNPU3RyaW5nKCkuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZGF0ZVRpbWVNb2RpZmllZCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGUgKGFuZCBUaW1lKSBtb2RpZmllZCcsIC8vRklYTUUga2VlcCBEYXRlIGFuZCB0aW1lIHVudG91Y2hlZCB3aGVuIGVkaXRpbmcgZnJvbnRtYXR0ZXIgcHJvcGVydGllc1xyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBEYXRlIGFuZCBUaW1lciBmaWxlIG1vZGlmaWVkXFxuICBjb25zdCBkYXRlVGltZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZSk7XFxuICBjb25zdCByZXN1bHQgPSBkYXRlVGltZS50b0lTT1N0cmluZygpLnNwbGl0KCcuJylbMF07XFxuICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IFxyXG4gICAgICAgIC8vIGFjcXVpcmUgRGF0ZSBhbmQgVGltZXIgZmlsZSBjcmVhdGVkXHJcbiAgICAgICAgY29uc3QgZGF0ZVRpbWUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGRhdGVUaW1lLnRvSVNPU3RyaW5nKCkuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZmlsZVNpemVCeXRlcycsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgc2l6ZSBpbiBieXRlcycsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5zdGF0LnNpemU7XFxuICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBzaXplXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZS5zdGF0LnNpemU7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZpbGVTaXplU3RyaW5nJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRmlsZSBzaXplIGZvcm1hdHRlZCBhcyB0ZXh0JyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBzaXplXFxuICBsZXQgc2l6ZSA9ZmlsZS5zdGF0LnNpemU7XFxuICBjb25zdCBwcmVjaXNpb24gPSAyOyAvLyBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXNcXG4gIGlmIChzaXplID4gMTAyNCkge1xcbiAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XFxuICAgIGlmIChzaXplID4gMTAyNCkge1xcbiAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcXG4gICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcXG4gICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcXG4gICAgICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdChzaXplKS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEdCJztcXG4gICAgICB9IFxcbiAgICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdChzaXplKS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIE1CJztcXG4gICAgfVxcbiAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQoc2l6ZSkudG9GaXhlZChwcmVjaXNpb24pICsgJyBLQic7XFxuICB9ICAgXFxuICByZXR1cm4gc2l6ZSArICcgQnl0ZXMnOyAvLyByZXR1cm4geW91IHJlc3VsdC5cXG59XCIsXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBzaXplXHJcbiAgICAgICAgbGV0IHNpemUgPWZpbGUuc3RhdC5zaXplO1xyXG4gICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IDI7IC8vIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xyXG4gICAgICAgIGlmIChzaXplID4gMTAyNCkge1xyXG4gICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcclxuICAgICAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgR0InO1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIE1CJztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgS0InO1xyXG4gICAgICAgIH0gICBcclxuICAgICAgICByZXR1cm4gc2l6ZSArICcgQnl0ZXMnOyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgICAgfVxyXG59KTsiLCAiaW1wb3J0ICogYXMgZm1Ub29scyBmcm9tICcuL2Zyb250bWF0dGVyLXRvb2xzJztcclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRlclRhZ1NldHRpbmdzIHtcclxuICAgIHRhZ1ByZWZpeDogc3RyaW5nO1xyXG4gICAgZXhjbHVkZVJvb3RGb2xkZXI6IGJvb2xlYW47XHJcbiAgICB0YWdzUHJvcGVydHlOYW1lOiBzdHJpbmc7XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBsb3dlcmNhc2VUYWdzOiBib29sZWFuO1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICBydWxlczogRm9sZGVyVGFnUnVsZURlZmluaXRpb25bXTtcclxuICAgIHVzZVRleHRBcmVhOiBib29sZWFuO1xyXG4gICAgZXhjbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogc3RyaW5nW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXInIHwgJ2ZpbGVzJ1xyXG4gICAgfTtcclxuICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgICAgIG1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVyJyB8ICdmaWxlcydcclxuICAgIH07XHJcbiAgICBjb25maWd1cmVkUHJvcGVydGllczogQXJyYXk8eyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBhbnkgfT47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBGb2xkZXJUYWdTZXR0aW5ncyA9IHtcclxuICAgIHRhZ1ByZWZpeDogJycsXHJcbiAgICBleGNsdWRlUm9vdEZvbGRlcjogZmFsc2UsXHJcbiAgICB0YWdzUHJvcGVydHlOYW1lOiAndGFncycsXHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiAnXycsXHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiAnXycsXHJcbiAgICBsb3dlcmNhc2VUYWdzOiBmYWxzZSxcclxuICAgIGtub3duUHJvcGVydGllczogW10sXHJcbiAgICBydWxlczogW10sXHJcbiAgICB1c2VUZXh0QXJlYTogZmFsc2UsXHJcbiAgICBleGNsdWRlOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXJzOiBbXSxcclxuICAgICAgICBzZWxlY3RlZEZpbGVzOiBbXSxcclxuICAgICAgICBtb2RlOiAnZXhjbHVkZScsXHJcbiAgICAgICAgZGlzcGxheTogJ2ZvbGRlcicsXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXInLFxyXG4gICAgfSxcclxuICAgIGNvbmZpZ3VyZWRQcm9wZXJ0aWVzOiBbXSxcclxufTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGVyVGFnUnVsZURlZmluaXRpb24ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGFjdGl2ZTogYm9vbGVhbjtcclxuICAgIHByb3BlcnR5OiBzdHJpbmc7XHJcbiAgICBjdXN0b21Qcm9wZXJ0eTogc3RyaW5nO1xyXG4gICAgdHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgdHlwZVByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvIHwgdW5kZWZpbmVkO1xyXG4gICAgY29udGVudDogc3RyaW5nO1xyXG4gICAgYnVpbGRJbkNvZGU6IHN0cmluZztcclxuICAgIGpzQ29kZTogc3RyaW5nO1xyXG4gICAgc2hvd0NvbnRlbnQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiA6IEZvbGRlclRhZ1J1bGVEZWZpbml0aW9uID0ge1xyXG4gICAgaWQ6ICcnLFxyXG4gICAgYWN0aXZlIDogdHJ1ZSxcclxuICAgIHByb3BlcnR5IDogJycsXHJcbiAgICBjdXN0b21Qcm9wZXJ0eSA6ICcnLFxyXG4gICAgdHlwZTogJ3N0cmluZycsXHJcbiAgICB0eXBlUHJvcGVydHk6IHtuYW1lOicnLHR5cGU6JycsIHNvdXJjZToncmVnaXN0ZXJlZCd9LFxyXG4gICAgY29udGVudDogJycsXHJcbiAgICBidWlsZEluQ29kZTogJycsXHJcbiAgICBqc0NvZGU6ICcnLFxyXG4gICAgc2hvd0NvbnRlbnQ6IGZhbHNlLFxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBQcm9wZXJ0eVR5cGVJbmZvID0ge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdHlwZTogc3RyaW5nO1xyXG4gICAgY291bnQ/OiBudW1iZXI7XHJcbiAgICBpc0FycmF5PzogYm9vbGVhbjtcclxuICAgIHZhbHVlcz86IHN0cmluZ1tdO1xyXG4gICAgc291cmNlOiAncmVnaXN0ZXJlZCcgfCAnaW5mZXJyZWQnO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgUHJvcGVydHlUeXBlID0ge1xyXG4gICAgdHlwZTogc3RyaW5nO1xyXG4gICAgaWNvbjogc3RyaW5nO1xyXG4gICAganNUeXBlOiBzdHJpbmc7XHJcbn07IiwgImltcG9ydCB7IE1vZGFsLCBBcHAsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbi8qKlxyXG4gKiBEaXNwbGF5IGEgQWxlcnQgTW9kYWwgYXN5bmNocm9ub3VzbHkgXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXN5bmNBbGVydE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgdGl0bGU6IHN0cmluZztcclxuICBwcml2YXRlIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBidG4xVGV4dDogc3RyaW5nO1xyXG4gIHByaXZhdGUgYnRuMlRleHQ6IHN0cmluZztcclxuICBwcml2YXRlIG9uWWVzOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgb25ObzogKCkgPT4gdm9pZDtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGJ0bjE6IHN0cmluZywgYnRuMjpzdHJpbmcsIG9uWWVzOiAoKSA9PiB2b2lkLCBvbk5vOiAoKSA9PiB2b2lkKSB7XHJcbiAgICBzdXBlcihhcHApO1xyXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5idG4xVGV4dCA9IGJ0bjE7XHJcbiAgICB0aGlzLmJ0bjJUZXh0ID0gYnRuMjtcclxuICAgIHRoaXMub25ZZXMgPSBvblllcztcclxuICAgIHRoaXMub25ObyA9IG9uTm87XHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHJcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiB0aGlzLnRpdGxlIH0pO1xyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiB0aGlzLmRlc2NyaXB0aW9uIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4xVGV4dClcclxuICAgICAgICAgIC5zZXRDdGEoKVxyXG4gICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblllcygpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KHRoaXMuYnRuMlRleHQpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub25ObygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBvbkNsb3NlKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBkaXNwbGF5IGFuIEFsZXJ0IE1vZGFsXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQWxlcnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgdGl0bGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIHByaXZhdGUgcmVzb2x2ZVByb21pc2U6ICh2YWx1ZTogYm9vbGVhbikgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgcHJvbWlzZTogUHJvbWlzZTxib29sZWFuPjtcclxuICAgIHByaXZhdGUgYnRuMVRleHQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgYnRuMlRleHQ6IHN0cmluZztcclxuICBcclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBidG4xOiBzdHJpbmcsIGJ0bjI6c3RyaW5nKSB7XHJcbiAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICB0aGlzLmJ0bjFUZXh0ID0gYnRuMTtcclxuICAgICAgdGhpcy5idG4yVGV4dCA9IGJ0bjI7XHJcbiAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICBcclxuICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogdGhpcy50aXRsZSB9KTtcclxuICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiB0aGlzLmRlc2NyaXB0aW9uIH0pO1xyXG4gIFxyXG4gICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCh0aGlzLmJ0bjFUZXh0KVxyXG4gICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHRydWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4yVGV4dClcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhc3luYyBvcGVuQW5kR2V0VmFsdWUoKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgIHRoaXMub3BlbigpO1xyXG4gICAgICByZXR1cm4gdGhpcy5wcm9taXNlO1xyXG4gICAgfVxyXG4gIH0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0LCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nOyAvLyBBZGRlZCBzZXRJY29uXHJcblxyXG4vLyBEZWZpbmUgdGhlIHN0cnVjdHVyZSBmb3IgdHJlZSBub2Rlc1xyXG5pbnRlcmZhY2UgVHJlZU5vZGUge1xyXG4gICAgcGF0aDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdHlwZTogJ2ZvbGRlcicgfCAnZmlsZSc7XHJcbiAgICBjaGlsZHJlbj86IFRyZWVOb2RlW107XHJcbiAgICBlbGVtZW50OiBIVE1MRWxlbWVudDsgLy8gUmVmZXJlbmNlIHRvIHRoZSBsaXN0IGl0ZW0gZWxlbWVudCAobGkpXHJcbiAgICBjaGVja2JveDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIGxhYmVsOiBIVE1MTGFiZWxFbGVtZW50O1xyXG4gICAgY29udGFpbmVyOiBIVE1MRWxlbWVudDsgLy8gUmVmZXJlbmNlIHRvIHRoZSBjb250YWluZXIgZGl2IGhvbGRpbmcgY2hlY2tib3ggYW5kIGxhYmVsXHJcbn1cclxuXHJcbi8vIERlZmluZSB0aGUgcmVzdWx0IHN0cnVjdHVyZSByZXR1cm5lZCBieSB0aGUgbW9kYWxcclxuZXhwb3J0IGludGVyZmFjZSBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQge1xyXG4gICAgZm9sZGVyczogc3RyaW5nW107XHJcbiAgICBmaWxlczogc3RyaW5nW107XHJcbiAgICBtb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICBkaXNwbGF5OiAnZm9sZGVycycgfCAnZmlsZXMnO1xyXG59XHJcblxyXG4vKipcclxuICogT2JzaWRpYW4gTW9kYWwgZm9yIHNlbGVjdGluZyBkaXJlY3RvcmllcyBhbmQgZmlsZXMgZnJvbSB0aGUgdmF1bHQgc3RydWN0dXJlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgLy8gSW5pdGlhbCBzdGF0ZSBwYXNzZWQgdG8gdGhlIG1vZGFsIChzdG9yZWQgZm9yIHJlc2V0IGZ1bmN0aW9uYWxpdHkpXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxGb2xkZXJzU25hcHNob3Q6IFJlYWRvbmx5U2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxGaWxlc1NuYXBzaG90OiBSZWFkb25seVNldDxzdHJpbmc+O1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBpbml0aWFsTW9kZVNuYXBzaG90OiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxEaXNwbGF5U25hcHNob3Q6ICdmb2xkZXJzJyB8ICdmaWxlcyc7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IG9rQ2FsbGJhY2s6IChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHZvaWQ7XHJcblxyXG4gICAgLy8gQ3VycmVudCBzdGF0ZSBiZWluZyBtb2RpZmllZCB3aXRoaW4gdGhlIG1vZGFsXHJcbiAgICBwcml2YXRlIGN1cnJlbnRGb2xkZXJzOiBTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgY3VycmVudEZpbGVzOiBTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgY3VycmVudE1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJztcclxuICAgIHByaXZhdGUgY3VycmVudERpc3BsYXk6ICdmb2xkZXJzJyB8ICdmaWxlcyc7XHJcbiAgICBwcml2YXRlIGluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZTogYm9vbGVhbjtcclxuICAgIHByaXZhdGUgc2hvd0ZpbGVzOiBib29sZWFuID0gZmFsc2U7IC8vIFN0YXRlIGZvciBzaG93aW5nIGZpbGVzIGluIHRoZSB0cmVlXHJcblxyXG4gICAgLy8gVUkgRWxlbWVudHNcclxuICAgIHByaXZhdGUgdHJlZVJvb3RFbGVtZW50OiBIVE1MRWxlbWVudDsgLy8gQ29udGFpbmVyIGZvciB0aGUgdHJlZSB2aWV3XHJcbiAgICBwcml2YXRlIHRyZWVOb2RlczogTWFwPHN0cmluZywgVHJlZU5vZGU+ID0gbmV3IE1hcCgpOyAvLyBNYXAgcGF0aCB0byBub2RlIGluZm8gZm9yIHF1aWNrIGFjY2Vzc1xyXG4gICAgcHJpdmF0ZSBtb2RlRHJvcGRvd246IFNldHRpbmcgfCBudWxsID0gbnVsbDsgLy8gUmVmZXJlbmNlIHRvIHVwZGF0ZSBkcm9wZG93biBvbiByZXNldFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwuXHJcbiAgICAgKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBpbml0aWFsRm9sZGVycyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmb2xkZXIgcGF0aHMuXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbEZpbGVzIC0gQXJyYXkgb2YgaW5pdGlhbGx5IHNlbGVjdGVkIGZpbGUgcGF0aHMuXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbE1vZGUgLSBUaGUgaW5pdGlhbCBzZWxlY3Rpb24gbW9kZSAoJ2luY2x1ZGUnIG9yICdleGNsdWRlJykuXHJcbiAgICAgKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsXHJcbiAgICAgICAgaW5pdGlhbEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgICAgIGluaXRpYWxGaWxlczogc3RyaW5nW10sXHJcbiAgICAgICAgaW5pdGlhbE1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJyxcclxuICAgICAgICBpbml0aWFsRGlzcGxheTogJ2ZvbGRlcnMnIHwgJ2ZpbGVzJyxcclxuICAgICAgICBpbmNsdWRlRXhjbHVkZVNlbGVjdGFibGU6IGJvb2xlYW4sXHJcbiAgICAgICAgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIHN0YXRlIGZvciByZXNldFxyXG4gICAgICAgIHRoaXMuaW5pdGlhbEZvbGRlcnNTbmFwc2hvdCA9IG5ldyBTZXQoaW5pdGlhbEZvbGRlcnMpO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbEZpbGVzU25hcHNob3QgPSBuZXcgU2V0KGluaXRpYWxGaWxlcyk7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsTW9kZVNuYXBzaG90ID0gaW5pdGlhbE1vZGU7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRGlzcGxheVNuYXBzaG90ID0gaW5pdGlhbERpc3BsYXk7XHJcbiAgICAgICAgdGhpcy5zaG93RmlsZXMgPSBpbml0aWFsRGlzcGxheT09PSdmaWxlcycgfHwgaW5pdGlhbEZpbGVzLmxlbmd0aD4wO1xyXG4gICAgICAgIHRoaXMuaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlID0gaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlO1xyXG4gICAgICAgIHRoaXMub2tDYWxsYmFjayA9IG9rQ2FsbGJhY2s7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgY3VycmVudCBzdGF0ZSBmcm9tIGluaXRpYWwgc3RhdGUgZm9yIGVkaXRpbmdcclxuICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFVzZSBhIG1ldGhvZCBmb3IgaW5pdGlhbGl6YXRpb24gYW5kIHJlc2V0XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIHRoZSBpbml0aWFsIHN0YXRlIHByb3ZpZGVkIGF0IGNvbnN0cnVjdGlvbi5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZXNldFNlbGVjdGlvblRvSW5pdGlhbCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzID0gbmV3IFNldCh0aGlzLmluaXRpYWxGb2xkZXJzU25hcHNob3QpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbGVzID0gbmV3IFNldCh0aGlzLmluaXRpYWxGaWxlc1NuYXBzaG90KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRNb2RlID0gdGhpcy5pbml0aWFsTW9kZVNuYXBzaG90O1xyXG4gICAgICAgIC8vIE5vdGU6IHNob3dGaWxlcyBpcyBub3QgcmVzZXQgYnkgdGhpcyBhY3Rpb24sIHVzZXIgY2FuIHRvZ2dsZSBpdCBpbmRlcGVuZGVudGx5XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIGVtcHR5LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzID0gbmV3IFNldChbXSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZXMgPSBuZXcgU2V0KFtdKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRNb2RlID0gdGhpcy5pbml0aWFsTW9kZVNuYXBzaG90O1xyXG4gICAgICAgIC8vIE5vdGU6IHNob3dGaWxlcyBpcyBub3QgcmVzZXQgYnkgdGhpcyBhY3Rpb24sIHVzZXIgY2FuIHRvZ2dsZSBpdCBpbmRlcGVuZGVudGx5XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgbW9kYWwgaXMgb3BlbmVkLiBCdWlsZHMgdGhlIFVJLlxyXG4gICAgICovXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7IC8vIENsZWFyIHByZXZpb3VzIGNvbnRlbnRcclxuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoJ2RpcmVjdG9yeS1zZWxlY3Rpb24tbW9kYWwnKTsgXHJcblxyXG4gICAgICAgIC8vIC0tLSBNb2RhbCBUaXRsZSAtLS1cclxuICAgICAgICBpZiAodGhpcy5pbmNsdWRlRXhjbHVkZVNlbGVjdGFibGUpIHtcclxuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0luY2x1ZGUgb3IgRXhjbHVkZSBGb2xkZXJzIGFuZCBGaWxlcycgfSk7IFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IGAke3RoaXMuY3VycmVudE1vZGUgPT09ICdleGNsdWRlJyA/ICdFeGNsdWRlJyA6ICdJbmNsdWRlJ30gRm9sZGVycyBhbmQgRmlsZXNgIH0pOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLSBTZXR0aW5ncyBDb250cm9scyAtLS1cclxuICAgICAgICBjb25zdCBjb250cm9sc0VsID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWNvbnRyb2xzJyB9KTtcclxuICAgICAgICB0aGlzLmNyZWF0ZU1vZGVTZXR0aW5nKGNvbnRyb2xzRWwpOyAvLyBDcmVhdGUgbW9kZSBkcm9wZG93blxyXG4gICAgICAgIHRoaXMuY3JlYXRlU2hvd0ZpbGVzU2V0dGluZyhjb250cm9sc0VsKTsgLy8gQ3JlYXRlIGZpbGUgdG9nZ2xlXHJcblxyXG4gICAgICAgIC8vIC0tLSBUcmVlIENvbnRhaW5lciAtLS1cclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICd0cmVlLXZpZXctY29udGFpbmVyJyB9KTtcclxuICAgICAgICAvLyBCYXNpYyBzdHlsaW5nIGZvciB0aGUgc2Nyb2xsYWJsZSB0cmVlIGFyZWFcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSAnNjAwcHgnO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUucGFkZGluZyA9ICcxMHB4JztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnO1xyXG5cclxuICAgICAgICAvLyAtLS0gQnVpbGQgYW5kIFJlbmRlciBUcmVlIC0tLVxyXG4gICAgICAgIHRoaXMuYnVpbGRBbmRSZW5kZXJUcmVlKCk7IC8vIEluaXRpYWwgcmVuZGVyaW5nIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGVcclxuXHJcbiAgICAgICAgLy8gLS0tIEFjdGlvbiBCdXR0b25zIC0tLVxyXG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250ZW50RWwpOyAvLyBDcmVhdGUgT0sgYW5kIFJlc2V0IGJ1dHRvbnNcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIGRyb3Bkb3duIHNldHRpbmcgZm9yIGNob29zaW5nIHRoZSBzZWxlY3Rpb24gbW9kZS5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBzZXR0aW5nIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZU1vZGVTZXR0aW5nKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVEcm9wZG93biA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKSAvLyBTdG9yZSByZWZlcmVuY2VcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdTZWxlY3Rpb24gTW9kZScpIC8vIFNldHRpbmcgTmFtZSBpbiBHZXJtYW5cclxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdDaG9vc2UgaWYgdGhlIHNlbGVjdGVkIGZpbGVzIGFuZCBmb2xkZXJzIHNob3VsZCBiZSBleGNsdWRlZCBvciBpbmNsdWRlZC4nKSBcclxuICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25cclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZXhjbHVkZScsICdleGNsdWRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaW5jbHVkZScsICdpbmNsdWRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuY3VycmVudE1vZGUpIC8vIFNldCBpbml0aWFsIHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRNb2RlID0gdmFsdWUgYXMgJ2luY2x1ZGUnIHwgJ2V4Y2x1ZGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUcmVlQXBwZWFyYW5jZSgpOyAvLyBVcGRhdGUgdHJlZSB2aXN1YWxzIGJhc2VkIG9uIG5ldyBtb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyB0aGUgbW9kZSBkcm9wZG93biBVSSBlbGVtZW50IHRvIHJlZmxlY3QgdGhlIGN1cnJlbnRNb2RlIHN0YXRlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHVwZGF0ZU1vZGVEcm9wZG93bigpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBkcm9wZG93bkNvbXBvbmVudCA9IHRoaXMubW9kZURyb3Bkb3duPy5jb21wb25lbnRzWzBdIGFzIGFueTsgLy8gQWNjZXNzIGRyb3Bkb3duIGNvbXBvbmVudFxyXG4gICAgICAgIGlmIChkcm9wZG93bkNvbXBvbmVudCAmJiB0eXBlb2YgZHJvcGRvd25Db21wb25lbnQuc2V0VmFsdWUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgIGRyb3Bkb3duQ29tcG9uZW50LnNldFZhbHVlKHRoaXMuY3VycmVudE1vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIHRoZSB0b2dnbGUgc2V0dGluZyBmb3Igc2hvd2luZy9oaWRpbmcgZmlsZXMgaW4gdGhlIHRyZWUuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgc2V0dGluZyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVTaG93RmlsZXNTZXR0aW5nKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnU2hvdyBGaWxlcycpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdTaG93IEZpbGVzIHdpdGhpbiB0aGUgZGlyZWN0b3J5IHRyZWUuJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2hvd0ZpbGVzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0ZpbGVzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRBbmRSZW5kZXJUcmVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgXCJPS1wiIGFuZCBcIlJlc2V0XCIgYnV0dG9ucy5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBidXR0b25zIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZUFjdGlvbkJ1dHRvbnMoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9uc0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbW9kYWwtYnV0dG9ucycgfSk7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLm1hcmdpblRvcCA9ICcxNXB4JztcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgLy8gVXNlIGZsZXggZm9yIGFsaWdubWVudFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdmbGV4LWVuZCc7IC8vIEFsaWduIGJ1dHRvbnMgdG8gdGhlIHJpZ2h0XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmdhcCA9ICcxMHB4JzsgLy8gU3BhY2UgYmV0d2VlbiBidXR0b25zXHJcblxyXG4gICAgICAgIC8vIFJlc2V0IEJ1dHRvbiAoVW5kbyBcdTIxQUFcdUZFMEYpXHJcbiAgICAgICAgY29uc3QgcmVzZXRCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24ocmVzZXRCdXR0b24sICdyZXNldCcpOyAvLyBVc2UgYSBzdWl0YWJsZSBpY29uIGxpa2UgJ3Jlc2V0JyBvciAndW5kbydcclxuICAgICAgICByZXNldEJ1dHRvbi5hcmlhTGFiZWwgPSAnUmVzZXQgc2VsZWN0aW9uJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIHJlc2V0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gUmVzZXQgaW50ZXJuYWwgc3RhdGVcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RlRHJvcGRvd24oKTsgLy8gVXBkYXRlIGRyb3Bkb3duIFVJXHJcbiAgICAgICAgICAgIHRoaXMuYnVpbGRBbmRSZW5kZXJUcmVlKCk7IC8vIFJlLXJlbmRlciB0cmVlIHdpdGggcmVzZXQgc3RhdGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBDbGVhciBCdXR0b24gKENsZWFyIFx1RDgzRFx1REVBRSlcclxuICAgICAgICBjb25zdCBlbXB0eUJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XHJcbiAgICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmb3IgY29uc2lzdGVuY3ksIG9yIHVzZSB0ZXh0XHJcbiAgICAgICAgc2V0SWNvbihlbXB0eUJ1dHRvbiwgJ2VyYXNlcicpOyAvLyBVc2UgYSBzdWl0YWJsZSBpY29uIGxpa2UgJ3Jlc2V0JyBvciAndW5kbydcclxuICAgICAgICBlbXB0eUJ1dHRvbi5hcmlhTGFiZWwgPSAnQ2xlYXIgc2VsZWN0aW9uJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGVtcHR5QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk7IC8vIENsZWFyIHN0YXRlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kZURyb3Bkb3duKCk7IC8vIFVwZGF0ZSBkcm9wZG93biBVSVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBSZS1yZW5kZXIgdHJlZSB3aXRoIHJlc2V0IHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gY2FuY2VsIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnQ2FuY2VsJyB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYXJpYUxhYmVsID0gJ2Nsb3NlIGFuZCBkaXNjYXJkIGNoYW5nZXMnOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsIENsaWNrZWQgLSBSZXR1cm5pbmdcIik7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgICAgICB0aGlzLm9rQ2FsbGJhY2soIG51bGwgKTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE9LIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycsIGNsczogJ21vZC1jdGEnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIHNhdmUgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBva0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQnVpbGRzIHRoZSBsb2dpY2FsIHRyZWUgc3RydWN0dXJlIGRhdGEgZnJvbSB0aGUgdmF1bHQncyBmaWxlcyBhbmQgZm9sZGVycy5cclxuICAgICAqIEByZXR1cm5zIFRoZSByb290IG5vZGUgb2YgdGhlIHRyZWUgc3RydWN0dXJlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJ1aWxkVHJlZURhdGEoKTogVHJlZU5vZGUge1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHZpcnR1YWwgcm9vdCBub2RlIHJlcHJlc2VudGluZyB0aGUgdmF1bHRcclxuICAgICAgICBjb25zdCB2YXVsdFJvb3ROb2RlOiBUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgIHBhdGg6ICcvJyxcclxuICAgICAgICAgICAgIG5hbWU6IHRoaXMuYXBwLnZhdWx0LmdldE5hbWUoKSB8fCAnVmF1bHQnLCAvLyBVc2UgdmF1bHQgbmFtZSBvciBkZWZhdWx0XHJcbiAgICAgICAgICAgICB0eXBlOiAnZm9sZGVyJyxcclxuICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgIC8vIFBsYWNlaG9sZGVyIGVsZW1lbnRzLCB3aWxsIGJlIGFzc2lnbmVkIGR1cmluZyByZW5kZXJpbmcgaWYgcm9vdCBpcyByZW5kZXJlZFxyXG4gICAgICAgICAgICAgZWxlbWVudDogbnVsbCEsIGNoZWNrYm94OiBudWxsISwgbGFiZWw6IG51bGwhLCBjb250YWluZXI6IG51bGwhXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBmb2xkZXJOb2RlcyA9IG5ldyBNYXA8c3RyaW5nLCBUcmVlTm9kZT4oKTtcclxuICAgICAgICBmb2xkZXJOb2Rlcy5zZXQoJy8nLCB2YXVsdFJvb3ROb2RlKTsgLy8gQWRkIHJvb3QgdG8gdGhlIG1hcFxyXG5cclxuICAgICAgICAvLyBVc2UgZ2V0RmlsZXMoKSB0byByZXRyaWV2ZSBhbGwgVEZpbGUgb2JqZWN0cyAoTWFya2Rvd24sIGltYWdlcywgcGRmLCBldGMuKVxyXG4gICAgICAgIGNvbnN0IGFsbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFN0ZXAgMTogQ3JlYXRlIGFsbCBmb2xkZXIgbm9kZXMgYmFzZWQgb24gZmlsZSBwYXJlbnQgcGF0aHMgLS0tXHJcbiAgICAgICAgYWxsRmlsZXMuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgLy8gR2V0IHRoZSBwYXJlbnQgZm9sZGVyIG9iamVjdCBmb3IgdGhlIGZpbGVcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgIC8vIEVuc3VyZSBwYXJlbnRGb2xkZXIgZXhpc3RzIGJlZm9yZSBwcm9jZWVkaW5nIChTYWZldHkgY2hlY2spXHJcbiAgICAgICAgICAgIGlmICghcGFyZW50Rm9sZGVyKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBsZXQgY3VycmVudFBhdGggPSAnJztcclxuICAgICAgICAgICAgLy8gU3BsaXQgcGF0aCwgZmlsdGVyIGVtcHR5IHN0cmluZ3MgKGhhbmRsZXMgcm9vdCAnLycpXHJcbiAgICAgICAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IHBhcmVudEZvbGRlci5wYXRoLnNwbGl0KCcvJykuZmlsdGVyKHAgPT4gcC5sZW5ndGggPiAwKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYXJlbnROb2RlID0gdmF1bHRSb290Tm9kZTsgLy8gU3RhcnQgZnJvbSB2YXVsdCByb290XHJcbiAgICAgICAgICAgIHBhdGhQYXJ0cy5mb3JFYWNoKHBhcnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gQ29uc3RydWN0IHRoZSBmdWxsIHBhdGggZm9yIHRoZSBjdXJyZW50IHBhcnRcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY3VycmVudFBhdGggPT09ICcvJyA/IHBhcnQgOiBgJHtjdXJyZW50UGF0aH0vJHtwYXJ0fWA7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWZvbGRlck5vZGVzLmhhcyhjdXJyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGZvbGRlciBub2RlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGb2xkZXJOb2RlOiBUcmVlTm9kZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGN1cnJlbnRQYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGxhY2Vob2xkZXJzLCBhc3NpZ25lZCBkdXJpbmcgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsISwgY2hlY2tib3g6IG51bGwhLCBsYWJlbDogbnVsbCEsIGNvbnRhaW5lcjogbnVsbCFcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvbGRlck5vZGVzLnNldChjdXJyZW50UGF0aCwgbmV3Rm9sZGVyTm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIHBhcmVudE5vZGUgaGFzIGNoaWxkcmVuIGFycmF5IGluaXRpYWxpemVkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiEucHVzaChuZXdGb2xkZXJOb2RlKTsgLy8gQWRkIHRvIHBhcmVudCdzIGNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZSA9IG5ld0ZvbGRlck5vZGU7IC8vIE1vdmUgZG93biB0aGUgdHJlZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBGb2xkZXIgbm9kZSBhbHJlYWR5IGV4aXN0cywganVzdCBtb3ZlIGRvd25cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gZm9sZGVyTm9kZXMuZ2V0KGN1cnJlbnRQYXRoKSE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAyOiBBZGQgZmlsZSBub2RlcyBpZiAnc2hvd0ZpbGVzJyBpcyBlbmFibGVkIC0tLVxyXG4gICAgICAgIGlmICh0aGlzLnNob3dGaWxlcykge1xyXG4gICAgICAgICAgICAgYWxsRmlsZXMuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyZW50IGZvbGRlciBhbmQgYWRkIHNhZmV0eSBjaGVjayBmb3IgbnVsbFxyXG4gICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEZvbGRlciA9IGZpbGUucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgIGlmICghcGFyZW50Rm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihgRmlsZSBcIiR7ZmlsZS5wYXRofVwiIHNlZW1zIHRvIGhhdmUgbm8gcGFyZW50IGZvbGRlci4gU2tpcHBpbmcuYCk7IC8vIE9wdGlvbmFsIHdhcm5pbmdcclxuICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBTa2lwIHRoaXMgZmlsZSBpZiBpdCBoYXMgbm8gcGFyZW50XHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBcIi9cIitwYXJlbnRGb2xkZXIucGF0aDsgLy8gTm93IHNhZmUgdG8gYWNjZXNzIC5wYXRoXHJcbiAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGZvbGRlck5vZGVzLmdldChwYXJlbnRQYXRoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBmaWxlIG5vZGVcclxuICAgICAgICAgICAgICAgICBjb25zdCBmaWxlTm9kZTogVHJlZU5vZGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgbmFtZTogZmlsZS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZmlsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIEZpbGVzIGRvbid0IGhhdmUgY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgICAgICAgLy8gUGxhY2Vob2xkZXJzLCBhc3NpZ25lZCBkdXJpbmcgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLCBjaGVja2JveDogbnVsbCEsIGxhYmVsOiBudWxsISwgY29udGFpbmVyOiBudWxsIVxyXG4gICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgIGlmIChwYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBjaGlsZHJlbiBhcnJheSBleGlzdHNcclxuICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAvLyBBZGQgZmlsZSB0byBpdHMgcGFyZW50IGZvbGRlcidzIGNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4hLnB1c2goZmlsZU5vZGUpO1xyXG4gICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgY2FzZSBzaG91bGQgaWRlYWxseSBub3QgaGFwcGVuIGlmIFN0ZXAgMSB3b3JrZWQgY29ycmVjdGx5IGZvciBhbGwgZm9sZGVyc1xyXG4gICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBmaW5kIHBhcmVudCBub2RlIGZvciBwYXRoIFwiJHtwYXJlbnRQYXRofVwiIHdoaWxlIGFkZGluZyBmaWxlIFwiJHtmaWxlLnBhdGh9XCIuYCk7IC8vIE9wdGlvbmFsIHdhcm5pbmdcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLSBTdGVwIDM6IFNvcnQgY2hpbGRyZW4gYWxwaGFiZXRpY2FsbHkgKGZvbGRlcnMgZmlyc3QsIHRoZW4gZmlsZXMpIC0tLVxyXG4gICAgICAgIGNvbnN0IHNvcnROb2RlcyA9IChhOiBUcmVlTm9kZSwgYjogVHJlZU5vZGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGEudHlwZSA9PT0gJ2ZvbGRlcicgJiYgYi50eXBlID09PSAnZmlsZScpIHJldHVybiAtMTsgLy8gRm9sZGVycyBjb21lIGZpcnN0XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmaWxlJyAmJiBiLnR5cGUgPT09ICdmb2xkZXInKSByZXR1cm4gMTsgIC8vIEZpbGVzIGNvbWUgYWZ0ZXJcclxuICAgICAgICAgICAgcmV0dXJuIGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSk7IC8vIFNvcnQgYWxwaGFiZXRpY2FsbHkgYnkgbmFtZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFNvcnQgY2hpbGRyZW4gb2YgZXZlcnkgZm9sZGVyIG5vZGVcclxuICAgICAgICBmb2xkZXJOb2Rlcy5mb3JFYWNoKG5vZGUgPT4gbm9kZS5jaGlsZHJlbj8uc29ydChzb3J0Tm9kZXMpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHZhdWx0Um9vdE5vZGU7IC8vIFJldHVybiB0aGUgcG9wdWxhdGVkIHJvb3Qgbm9kZVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbmRlcnMgdGhlIGVudGlyZSB0cmVlIHN0cnVjdHVyZSBpbiB0aGUgRE9NIGJhc2VkIG9uIHRoZSB0cmVlIGRhdGEuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVuZGVyVHJlZSgpIHtcclxuICAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuZW1wdHkoKTsgLy8gQ2xlYXIgZXhpc3RpbmcgRE9NIGVsZW1lbnRzXHJcbiAgICAgICAgIHRoaXMudHJlZU5vZGVzLmNsZWFyKCk7IC8vIENsZWFyIHRoZSBub2RlIG1hcFxyXG5cclxuICAgICAgICAgY29uc3QgdHJlZURhdGEgPSB0aGlzLmJ1aWxkVHJlZURhdGEoKTsgLy8gR2V0IHRoZSBzdHJ1Y3R1cmVkIGRhdGFcclxuXHJcbiAgICAgICAgIC8vIENyZWF0ZSB0aGUgdG9wLWxldmVsIGxpc3QgZm9yIHRoZSB2YXVsdCBjb250ZW50c1xyXG4gICAgICAgICBjb25zdCByb290VWwgPSB0aGlzLnRyZWVSb290RWxlbWVudC5jcmVhdGVFbCgndWwnKTtcclxuICAgICAgICAgcm9vdFVsLmFkZENsYXNzKCd0cmVlLXJvb3QtdWwnKTtcclxuICAgICAgICAgcm9vdFVsLnN0eWxlLmxpc3RTdHlsZSA9ICdub25lJztcclxuICAgICAgICAgcm9vdFVsLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzAnOyAvLyBSZW1vdmUgZGVmYXVsdCBsaXN0IGluZGVudGF0aW9uXHJcblxyXG4gICAgICAgICAvLyBSZW5kZXIgY2hpbGRyZW4gb2YgdGhlIHZpcnR1YWwgdmF1bHQgcm9vdCBub2RlXHJcbiAgICAgICAgIHRyZWVEYXRhLmNoaWxkcmVuPy5mb3JFYWNoKGNoaWxkTm9kZSA9PiB7XHJcbiAgICAgICAgICAgICB0aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkTm9kZSwgcm9vdFVsLCAwKTsgLy8gU3RhcnQgcmVuZGVyaW5nIGF0IGxldmVsIDBcclxuICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWN1cnNpdmVseSByZW5kZXJzIGEgc2luZ2xlIHRyZWUgbm9kZSBhbmQgaXRzIGNoaWxkcmVuIGluIHRoZSBET00uXHJcbiAgICAgKiBAcGFyYW0gbm9kZSAtIFRoZSBUcmVlTm9kZSBkYXRhIHRvIHJlbmRlci5cclxuICAgICAqIEBwYXJhbSBwYXJlbnRFbGVtZW50IC0gVGhlIEhUTUwgYHVsYCBlbGVtZW50IHRvIGFwcGVuZCB0aGlzIG5vZGUncyBgbGlgIHRvLlxyXG4gICAgICogQHBhcmFtIGxldmVsIC0gVGhlIGN1cnJlbnQgaW5kZW50YXRpb24gbGV2ZWwuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVuZGVyVHJlZU5vZGUobm9kZTogVHJlZU5vZGUsIHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBsZXZlbDogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbGkgPSBwYXJlbnRFbGVtZW50LmNyZWF0ZUVsKCdsaScpO1xyXG4gICAgICAgIGxpLnN0eWxlLm1hcmdpbkxlZnQgPSBgJHtsZXZlbCAqIDIwfXB4YDsgLy8gQXBwbHkgaW5kZW50YXRpb24gYmFzZWQgb24gbGV2ZWxcclxuICAgICAgICBsaS5hZGRDbGFzcyhgdHJlZS1ub2RlLSR7bm9kZS50eXBlfWApOyAvLyBBZGQgY2xhc3MgZm9yIHR5cGUgKGZvbGRlci9maWxlKVxyXG5cclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBsaS5jcmVhdGVEaXYoeyBjbHM6ICd0cmVlLW5vZGUtY29udGFpbmVyJyB9KTtcclxuICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICBjb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzJweCAwJzsgLy8gQWRkIHNvbWUgdmVydGljYWwgcGFkZGluZ1xyXG5cclxuICAgICAgICAvLyAtLS0gQ2hlY2tib3ggLS0tXHJcbiAgICAgICAgY29uc3QgY2hlY2tib3ggPSBjb250YWluZXIuY3JlYXRlRWwoJ2lucHV0JywgeyB0eXBlOiAnY2hlY2tib3gnIH0pO1xyXG4gICAgICAgIGNoZWNrYm94LmlkID0gYHRyZWUtY2ItJHtub2RlLnBhdGgucmVwbGFjZSgvW15hLXpBLVowLTldL2csICctJyl9YDsgLy8gQ3JlYXRlIGEgc2FmZSBJRFxyXG4gICAgICAgIGNoZWNrYm94LmRhdGFzZXQucGF0aCA9IG5vZGUucGF0aDsgLy8gU3RvcmUgcGF0aCBpbiBkYXRhIGF0dHJpYnV0ZVxyXG4gICAgICAgIGNoZWNrYm94LmRhdGFzZXQudHlwZSA9IG5vZGUudHlwZTsgLy8gU3RvcmUgdHlwZVxyXG5cclxuICAgICAgICAvLyAtLS0gTGFiZWwgLS0tXHJcbiAgICAgICAgY29uc3QgbGFiZWwgPSBjb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJyk7XHJcbiAgICAgICAgLy8gQWRkIGljb25zIGZvciB2aXN1YWwgZGlzdGluY3Rpb24gKG9wdGlvbmFsKVxyXG4gICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gYCR7bm9kZS50eXBlID09PSAnZm9sZGVyJyA/ICdcdUQ4M0RcdURDQzEnIDogJ1x1RDgzRFx1RENDNCd9ICR7bm9kZS5uYW1lfWA7XHJcbiAgICAgICAgbGFiZWwuaHRtbEZvciA9IGNoZWNrYm94LmlkOyAvLyBMaW5rIGxhYmVsIHRvIGNoZWNrYm94XHJcbiAgICAgICAgbGFiZWwuc3R5bGUubWFyZ2luTGVmdCA9ICc1cHgnO1xyXG4gICAgICAgIGxhYmVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgICBsYWJlbC50aXRsZSA9IG5vZGUucGF0aDsgLy8gU2hvdyBmdWxsIHBhdGggb24gaG92ZXJcclxuXHJcbiAgICAgICAgLy8gLS0tIFN0b3JlIHJlZmVyZW5jZXMgaW4gdGhlIG5vZGUgb2JqZWN0IGFuZCBtYXAgLS0tXHJcbiAgICAgICAgbm9kZS5lbGVtZW50ID0gbGk7XHJcbiAgICAgICAgbm9kZS5jaGVja2JveCA9IGNoZWNrYm94O1xyXG4gICAgICAgIG5vZGUubGFiZWwgPSBsYWJlbDtcclxuICAgICAgICBub2RlLmNvbnRhaW5lciA9IGNvbnRhaW5lcjsgLy8gU3RvcmUgY29udGFpbmVyIHJlZmVyZW5jZVxyXG4gICAgICAgIHRoaXMudHJlZU5vZGVzLnNldChub2RlLnBhdGgsIG5vZGUpO1xyXG5cclxuICAgICAgICAvLyAtLS0gU2V0IGluaXRpYWwgY2hlY2tlZCBzdGF0ZSBiYXNlZCBvbiBjdXJyZW50IHNlbGVjdGlvbiAtLS1cclxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMobm9kZS5wYXRoKTtcclxuICAgICAgICB9IGVsc2UgeyAvLyBmaWxlXHJcbiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSB0aGlzLmN1cnJlbnRGaWxlcy5oYXMobm9kZS5wYXRoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLSBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGNoZWNrYm94IGNoYW5nZXMgLS0tXHJcbiAgICAgICAgY2hlY2tib3gub25jaGFuZ2UgPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhdGggPSB0YXJnZXQuZGF0YXNldC5wYXRoITtcclxuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHRhcmdldC5kYXRhc2V0LnR5cGUgYXMgJ2ZvbGRlcicgfCAnZmlsZSc7XHJcblxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHNldHNcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2ZvbGRlcicpIHRoaXMuY3VycmVudEZvbGRlcnMuYWRkKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmN1cnJlbnRGaWxlcy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXInKSB0aGlzLmN1cnJlbnRGb2xkZXJzLmRlbGV0ZShwYXRoKTtcclxuICAgICAgICAgICAgICAgICBlbHNlIHRoaXMuY3VycmVudEZpbGVzLmRlbGV0ZShwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHZpc3VhbCBzdGF0ZSBvZiB0aGUgZW50aXJlIHRyZWUgYWZ0ZXIgYSBjaGFuZ2VcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVUcmVlQXBwZWFyYW5jZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIC0tLSBSZW5kZXIgY2hpbGRyZW4gcmVjdXJzaXZlbHkgaWYgaXQncyBhIGZvbGRlciAtLS1cclxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJyAmJiBub2RlLmNoaWxkcmVuICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZHJlblVsID0gbGkuY3JlYXRlRWwoJ3VsJyk7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuVWwuc3R5bGUubGlzdFN0eWxlID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBjaGlsZHJlblVsLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzAnOyAvLyBSZXNldCBwYWRkaW5nIGZvciBuZXN0ZWQgbGlzdFxyXG4gICAgICAgICAgICBjaGlsZHJlblVsLnN0eWxlLm1hcmdpbkxlZnQgPSAnMCc7IC8vIFByZXZlbnQgZG91YmxlIGluZGVudGF0aW9uIGZyb20gZGVmYXVsdCBVTCBzdHlsZXNcclxuICAgICAgICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHRoaXMucmVuZGVyVHJlZU5vZGUoY2hpbGQsIGNoaWxkcmVuVWwsIGxldmVsICsgMSkpOyAvLyBJbmNyZWFzZSBsZXZlbCBmb3IgY2hpbGRyZW5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyB0aGUgdmlzdWFsIGFwcGVhcmFuY2UgKGVuYWJsZWQvZGlzYWJsZWQvc3R5bGluZykgb2YgYWxsIG5vZGVzXHJcbiAgICAgKiBpbiB0aGUgdHJlZSBiYXNlZCBvbiB0aGUgY3VycmVudCBtb2RlIGFuZCBzZWxlY3Rpb25zLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHVwZGF0ZVRyZWVBcHBlYXJhbmNlKCkge1xyXG4gICAgICAgIHRoaXMudHJlZU5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcclxuICAgICAgICAgICAgbGV0IGlzRGlzYWJsZWQgPSBmYWxzZTsgLy8gU2hvdWxkIHRoZSBub2RlIGFwcGVhciBkaXNhYmxlZCAoZ3JleWVkIG91dCk/XHJcbiAgICAgICAgICAgIGxldCBpc0VmZmVjdGl2ZWx5SW5jbHVkZWQgPSBmYWxzZTsgLy8gSXMgdGhlIG5vZGUgcGFydCBvZiB0aGUgJ2FjdGl2ZScgc2V0IGluIGluY2x1ZGUgbW9kZT9cclxuICAgICAgICAgICAgbGV0IGlzRWZmZWN0aXZlbHlFeGNsdWRlZCA9IGZhbHNlOyAvLyBJcyB0aGUgbm9kZSBwYXJ0IG9mIHRoZSAnaW5hY3RpdmUnIHNldCBpbiBleGNsdWRlIG1vZGU/XHJcblxyXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgYW4gYW5jZXN0b3IgRk9MREVSIG9mIHRoaXMgbm9kZSBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICBsZXQgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudFBhdGggPSBub2RlLnBhdGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50UGF0aCAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IGN1cnJlbnRQYXRoLnN1YnN0cmluZygwLCBjdXJyZW50UGF0aC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhcmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yRm9sZGVyU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IGN1cnJlbnRQYXRoKSBicmVhazsgLy8gU2FmZXR5IGJyZWFrIGF0IHJvb3RcclxuICAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IHBhcmVudFBhdGg7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBub2RlIGl0c2VsZiBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICBjb25zdCBub2RlU2VsZWN0ZWQgPSBub2RlLnR5cGUgPT09ICdmb2xkZXInXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKG5vZGUucGF0aClcclxuICAgICAgICAgICAgICAgIDogdGhpcy5jdXJyZW50RmlsZXMuaGFzKG5vZGUucGF0aCk7XHJcblxyXG4gICAgICAgICAgICAvLyAtLS0gQXBwbHkgTG9naWMgQmFzZWQgb24gTW9kZSAtLS1cclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgPT09ICdleGNsdWRlJykge1xyXG4gICAgICAgICAgICAgICAgLy8gRVhDTFVERSBNb2RlOiBBIG5vZGUgaXMgY29uc2lkZXJlZCBleGNsdWRlZCBpZiBpdCBPUiBhbiBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBWaXN1YWxseSBkaXNhYmxlIChncmV5IG91dCkgbm9kZXMgdGhhdCBhcmUgZXhjbHVkZWQuXHJcbiAgICAgICAgICAgICAgICBpc0VmZmVjdGl2ZWx5RXhjbHVkZWQgPSBub2RlU2VsZWN0ZWQgfHwgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZDtcclxuICAgICAgICAgICAgICAgIGlzRGlzYWJsZWQgPSBpc0VmZmVjdGl2ZWx5RXhjbHVkZWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIElOQ0xVREUgTW9kZVxyXG4gICAgICAgICAgICAgICAgLy8gSU5DTFVERSBNb2RlOiBBIG5vZGUgaXMgY29uc2lkZXJlZCBpbmNsdWRlZCBpZiBpdCBPUiBhbiBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBWaXN1YWxseSBkaXNhYmxlIChncmV5IG91dCkgbm9kZXMgdGhhdCBhcmUgTk9UIGluY2x1ZGVkLlxyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc0VmZmVjdGl2ZWx5SW5jbHVkZWQgPSBub2RlU2VsZWN0ZWQgfHwgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIGZpbGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBGaWxlIGluY2x1ZGVkIGlmIHNlbGVjdGVkIE9SIHBhcmVudCBwYXRoIGlzIGluY2x1ZGVkXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IG5vZGUucGF0aC5zdWJzdHJpbmcoMCwgbm9kZS5wYXRoLmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRFZmZlY3RpdmVseUluY2x1ZGVkID0gdGhpcy5pc1BhdGhFZmZlY3RpdmVseUluY2x1ZGVkKHBhcmVudFBhdGgpOyAvLyBDaGVjayBwYXJlbnQgZm9sZGVyIHN0YXR1c1xyXG4gICAgICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBwYXJlbnRFZmZlY3RpdmVseUluY2x1ZGVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9ICFpc0VmZmVjdGl2ZWx5SW5jbHVkZWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBBcHBseSBWaXN1YWwgU3R5bGVzIC0tLVxyXG4gICAgICAgICAgICAvLyBDaGVja2JveCBpdHNlbGYgc2hvdWxkIGFsd2F5cyBiZSBjbGlja2FibGUgdG8gY2hhbmdlIHNlbGVjdGlvbiBzdGF0ZVxyXG4gICAgICAgICAgICBub2RlLmNoZWNrYm94LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvLyBBcHBseSBzdHlsaW5nIHRvIHRoZSBjb250YWluZXIgKGxhYmVsLCBpY29uKSBiYXNlZCBvbiBkaXNhYmxlZCBzdGF0ZVxyXG4gICAgICAgICAgICBpZiAoaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZS5jb250YWluZXIuc3R5bGUub3BhY2l0eSA9ICcwLjUnO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5sYWJlbC5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICdsaW5lLXRocm91Z2gnOyAvLyBNb3JlIHByb21pbmVudCBkaXNhYmxlZCBsb29rXHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQuYWRkQ2xhc3MoJ2lzLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5sYWJlbC5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5yZW1vdmVDbGFzcygnaXMtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEZJWCBmb3IgSW52YWxpZENoYXJhY3RlckVycm9yIC0tLVxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgY2xhc3NlcyBpbmRpdmlkdWFsbHlcclxuICAgICAgICAgICAgbm9kZS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWluY2x1ZGVkJywgJ2lzLWV4Y2x1ZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgc3BlY2lmaWMgY2xhc3NlcyBmb3Igc3R5bGluZyBpbmNsdWRlZC9leGNsdWRlZCBzdGF0ZXNcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgPT09ICdpbmNsdWRlJyAmJiBpc0VmZmVjdGl2ZWx5SW5jbHVkZWQpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnaXMtaW5jbHVkZWQnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScgJiYgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgLy8gQXBwbHkgZXhjbHVkZWQgY2xhc3MgZXZlbiBpZiBpdCdzIGp1c3QgdmlzdWFsbHkgZGlzYWJsZWRcclxuICAgICAgICAgICAgICAgICAvLyBUaGlzIGFsbG93cyBzcGVjaWZpYyBzdHlsaW5nIGZvciBleGNsdWRlZCBpdGVtcyBiZXlvbmQganVzdCBncmV5ZWQgb3V0XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQuYWRkQ2xhc3MoJ2lzLWV4Y2x1ZGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgaWYgYSBnaXZlbiBwYXRoIGlzIGVmZmVjdGl2ZWx5IGluY2x1ZGVkXHJcbiAgICAgKiBpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24gdW5kZXIgJ2luY2x1ZGUnIG1vZGUuXHJcbiAgICAgKiBBIHBhdGggaXMgaW5jbHVkZWQgaWYgaXQgKGZpbGUgb3IgZm9sZGVyKSBpcyBzZWxlY3RlZCwgb3IgaWYgYW55IG9mIGl0cyBhbmNlc3RvciBGT0xERVJTIGFyZSBzZWxlY3RlZC5cclxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZvbGRlciBvciBmaWxlIHBhdGggdG8gY2hlY2suXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBwYXRoIHNob3VsZCBiZSBjb25zaWRlcmVkIGluY2x1ZGVkLCBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNQYXRoRWZmZWN0aXZlbHlJbmNsdWRlZChwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBUaGlzIGNoZWNrIGlzIHByaW1hcmlseSBmb3IgJ2luY2x1ZGUnIG1vZGUgbG9naWMuXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgIT09ICdpbmNsdWRlJykge1xyXG4gICAgICAgICAgICAgLy8gSW4gJ2V4Y2x1ZGUnIG1vZGUsIGNvbmNlcHR1YWxseSBldmVyeXRoaW5nIGlzIGluY2x1ZGVkIHVubGVzcyBleGNsdWRlZC5cclxuICAgICAgICAgICAgIC8vIEZvciBpbnRlcm5hbCBjaGVja3MsIHdlIG1pZ2h0IG5lZWQgdGhlIGludmVyc2Ugb2YgZXhjbHVzaW9uLlxyXG4gICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzUGF0aEVmZmVjdGl2ZWx5RXhjbHVkZWQocGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGF0aCBpdHNlbGYgaXMgc2VsZWN0ZWQgKGFwcGxpZXMgdG8gYm90aCBmaWxlcyBhbmQgZm9sZGVycylcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsZXMuaGFzKHBhdGgpIHx8IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYW55IGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZFxyXG4gICAgICAgIGxldCBjdXJyZW50ID0gcGF0aDtcclxuICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBjdXJyZW50LnN1YnN0cmluZygwLCBjdXJyZW50Lmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhcmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gQW4gYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IGN1cnJlbnQpIGJyZWFrOyAvLyBSZWFjaGVkIHJvb3Qgb3IgZXJyb3JcclxuICAgICAgICAgICAgY3VycmVudCA9IHBhcmVudFBhdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE5laXRoZXIgdGhlIHBhdGggbm9yIGFueSBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWRcclxuICAgIH1cclxuXHJcbiAgICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGEgZ2l2ZW4gcGF0aCBpcyBlZmZlY3RpdmVseSBleGNsdWRlZFxyXG4gICAgICogaW4gdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHVuZGVyICdleGNsdWRlJyBtb2RlLlxyXG4gICAgICogQSBwYXRoIGlzIGV4Y2x1ZGVkIGlmIGl0IChmaWxlIG9yIGZvbGRlcikgaXMgc2VsZWN0ZWQsIG9yIGlmIGFueSBvZiBpdHMgYW5jZXN0b3IgRk9MREVSUyBhcmUgc2VsZWN0ZWQuXHJcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmb2xkZXIgb3IgZmlsZSBwYXRoIHRvIGNoZWNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcGF0aCBzaG91bGQgYmUgY29uc2lkZXJlZCBleGNsdWRlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlzUGF0aEVmZmVjdGl2ZWx5RXhjbHVkZWQocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgIC8vIFRoaXMgY2hlY2sgaXMgcHJpbWFyaWx5IGZvciAnZXhjbHVkZScgbW9kZSBsb2dpYy5cclxuICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgIT09ICdleGNsdWRlJykge1xyXG4gICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGF0aCBpdHNlbGYgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGVzLmhhcyhwYXRoKSB8fCB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIC8vIENoZWNrIGlmIGFueSBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgbGV0IGN1cnJlbnQgPSBwYXRoO1xyXG4gICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudC5zdWJzdHJpbmcoMCwgY3VycmVudC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gQW4gYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudCkgYnJlYWs7IC8vIFJlYWNoZWQgcm9vdCBvciBlcnJvclxyXG4gICAgICAgICAgICAgY3VycmVudCA9IHBhcmVudFBhdGg7XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gTmVpdGhlciB0aGUgcGF0aCBub3IgYW55IGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZCBmb3IgZXhjbHVzaW9uXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29tYmluZXMgYnVpbGRpbmcgdGhlIHRyZWUgZGF0YSwgcmVuZGVyaW5nIHRoZSBET00sIGFuZCBhcHBseWluZyBpbml0aWFsIGFwcGVhcmFuY2UuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYnVpbGRBbmRSZW5kZXJUcmVlKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyVHJlZSgpOyAvLyBCdWlsZCBkYXRhIGFuZCByZW5kZXIgRE9NIGVsZW1lbnRzXHJcbiAgICAgICAgdGhpcy51cGRhdGVUcmVlQXBwZWFyYW5jZSgpOyAvLyBBcHBseSBzdHlsZXMgYmFzZWQgb24gY3VycmVudCBtb2RlL3NlbGVjdGlvblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBjbG9zZWQuIENsZWFucyB1cCByZXNvdXJjZXMuXHJcbiAgICAgKi9cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgLy8gR2F0aGVyIHRoZSBmaW5hbCBzdGF0ZSBPTkxZIHdoZW4gT0sgaXMgY2xpY2tlZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0ID0ge1xyXG4gICAgICAgICAgICBmb2xkZXJzOiBBcnJheS5mcm9tKHRoaXMuY3VycmVudEZvbGRlcnMpLFxyXG4gICAgICAgICAgICBmaWxlczogQXJyYXkuZnJvbSh0aGlzLmN1cnJlbnRGaWxlcyksXHJcbiAgICAgICAgICAgIG1vZGU6IHRoaXMuY3VycmVudE1vZGUsXHJcbiAgICAgICAgICAgIGRpc3BsYXk6IHRoaXMuY3VycmVudERpc3BsYXksXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIk9LIENsaWNrZWQgLSBSZXR1cm5pbmcgUmVzdWx0OlwiLCByZXN1bHQpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICB0aGlzLm9rQ2FsbGJhY2socmVzdWx0KTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgdGhlIG1vZGFsJ3MgY29udGVudFxyXG4gICAgICAgIHRoaXMudHJlZU5vZGVzLmNsZWFyKCk7IC8vIENsZWFyIHRoZSBub2RlIG1hcCB0byBmcmVlIG1lbW9yeVxyXG4gICAgICAgIHRoaXMubW9kZURyb3Bkb3duID0gbnVsbDsgLy8gQ2xlYXIgcmVmZXJlbmNlXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gZWFzaWx5IG9wZW4gdGhlIERpcmVjdG9yeSBTZWxlY3Rpb24gTW9kYWwuXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBUaGUgT2JzaWRpYW4gQXBwIGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gaW5pdGlhbEZvbGRlcnMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZm9sZGVyIHBhdGhzLlxyXG4gKiBAcGFyYW0gaW5pdGlhbEZpbGVzIC0gQXJyYXkgb2YgaW5pdGlhbGx5IHNlbGVjdGVkIGZpbGUgcGF0aHMuXHJcbiAqIEBwYXJhbSBpbml0aWFsTW9kZSAtIFRoZSBpbml0aWFsIHNlbGVjdGlvbiBtb2RlICgnaW5jbHVkZScgb3IgJ2V4Y2x1ZGUnKS5cclxuICogQHBhcmFtIG9rQ2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiT0tcIi4gUmVjZWl2ZXMgdGhlIHNlbGVjdGlvbiByZXN1bHQuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBpbml0aWFsRm9sZGVyczogc3RyaW5nW10sXHJcbiAgICBpbml0aWFsRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgaW5pdGlhbE1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJyxcclxuICAgIGluaXRpYWxEaXNwbGF5OiAnZm9sZGVycycgfCAnZmlsZXMnLFxyXG4gICAgaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlOiBib29sZWFuLFxyXG4gICAgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4pOiB2b2lkIHtcclxuICAgIC8vIENyZWF0ZSBhbmQgb3BlbiB0aGUgbW9kYWwgaW5zdGFuY2VcclxuICAgIG5ldyBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICBhcHAsXHJcbiAgICAgICAgaW5pdGlhbEZvbGRlcnMsXHJcbiAgICAgICAgaW5pdGlhbEZpbGVzLFxyXG4gICAgICAgIGluaXRpYWxNb2RlLFxyXG4gICAgICAgIGluaXRpYWxEaXNwbGF5LFxyXG4gICAgICAgIGluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSxcclxuICAgICAgICBva0NhbGxiYWNrXHJcbiAgICApLm9wZW4oKTtcclxufVxyXG5cclxuLypcclxuLy8gLS0tIEV4YW1wbGUgVXNhZ2UgaW4geW91ciBQbHVnaW4ncyBTZXR0aW5ncyBUYWIgLS0tXHJcbi8vIChQbGFjZSB0aGlzIGluIHlvdXIgc2V0dGluZ3MgdGFiIGZpbGUsIGUuZy4sIHNldHRpbmdzLnRzKVxyXG5cclxuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwsIERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB9IGZyb20gJy4vRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwnOyAvLyBBZGp1c3QgcGF0aCBhcyBuZWVkZWRcclxuaW1wb3J0IFlvdXJQbHVnaW4gZnJvbSAnLi9tYWluJzsgLy8gQWRqdXN0IHBhdGggdG8geW91ciBtYWluIHBsdWdpbiBmaWxlXHJcblxyXG4vLyAtLS0gRXhhbXBsZSBQbHVnaW4gU2V0dGluZ3MgSW50ZXJmYWNlIChpbiB5b3VyIG1haW4udHMgb3Igc2V0dGluZ3MgZmlsZSkgLS0tXHJcbmV4cG9ydCBpbnRlcmZhY2UgWW91clBsdWdpblNldHRpbmdzIHtcclxuICAgIHNlbGVjdGVkRm9sZGVyczogc3RyaW5nW107XHJcbiAgICBzZWxlY3RlZEZpbGVzOiBzdHJpbmdbXTtcclxuICAgIHNlbGVjdGlvbk1vZGU6ICdpbmNsdWRlJyB8ICdleGNsdWRlJztcclxuICAgIC8vIC4uLiBvdGhlciBzZXR0aW5ncyBmb3IgeW91ciBwbHVnaW5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFlvdXJQbHVnaW5TZXR0aW5ncyA9IHtcclxuICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICBzZWxlY3RlZEZpbGVzOiBbXSxcclxuICAgIHNlbGVjdGlvbk1vZGU6ICdleGNsdWRlJywgLy8gRGVmYXVsdCBtb2RlIGlzIG9mdGVuICdleGNsdWRlJ1xyXG4gICAgLy8gLi4uIG90aGVyIGRlZmF1bHQgc2V0dGluZ3NcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBZb3VyUGx1Z2luU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogWW91clBsdWdpbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBZb3VyUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdFaW5zdGVsbHVuZ2VuIGZcdTAwRkNyIE1laW4gUGx1Z2luJyB9KTsgLy8gU2V0dGluZ3MgVGl0bGUgaW4gR2VybWFuXHJcblxyXG4gICAgICAgIC8vIC0tLSBCdXR0b24gdG8gT3BlbiB0aGUgTW9kYWwgLS0tXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdWZXJ6ZWljaG5pc3NlL0RhdGVpZW4ga29uZmlndXJpZXJlbicpIC8vIFNldHRpbmcgTmFtZSBpbiBHZXJtYW5cclxuICAgICAgICAgICAgLnNldERlc2MoJ0tsaWNrZSBhdWYgZGVuIEJ1dHRvbiwgdW0gZGllIEF1c3dhaGwgenUgYmVhcmJlaXRlbi4nKSAvLyBTZXR0aW5nIERlc2NyaXB0aW9uIGluIEdlcm1hblxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQXVzd2FobCBcdTAwRjZmZm5lbicpIC8vIEJ1dHRvbiBUZXh0IGluIEdlcm1hblxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKSAvLyBNYWtlcyB0aGUgYnV0dG9uIG1vcmUgcHJvbWluZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXRyaWV2ZSBjdXJyZW50IHNldHRpbmdzIHRvIHByZS1wb3B1bGF0ZSB0aGUgbW9kYWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZvbGRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZvbGRlcnMgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRmlsZXMgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRNb2RlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0aW9uTW9kZSB8fCAnZXhjbHVkZSc7IC8vIFVzZSBkZWZhdWx0IGlmIG5vdCBzZXRcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZW4gdGhlIG1vZGFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZvbGRlcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmlsZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TW9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIG9rQ2FsbGJhY2sgZnVuY3Rpb246XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQXVzd2FobCBiZXN0XHUwMEU0dGlndDonLCByZXN1bHQpOyAvLyBMb2cgcmVzdWx0IGluIEdlcm1hbiBjb25zb2xlXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0tLSBJTVBPUlRBTlQ6IFNhdmUgdGhlIHJlc3VsdHMgYmFjayB0byB5b3VyIHBsdWdpbiBzZXR0aW5ncyAtLS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgLy8gUGVyc2lzdCB0aGUgY2hhbmdlc1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcHRpb25hbGx5LCByZS1yZW5kZXIgdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHNlbGVjdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXIgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgLy8gLS0tIERpc3BsYXkgQ3VycmVudCBTZWxlY3Rpb24gKFJlYWQtb25seSkgLS0tXHJcbiAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkluZm9FbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzLXNlbGVjdGlvbi1pbmZvJyB9KTtcclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0FrdHVlbGxlIEF1c3dhaGw6JyB9KTsgLy8gU2VjdGlvbiBUaXRsZSBpbiBHZXJtYW5cclxuICAgICAgICAgY29uc3QgbW9kZVRleHQgPSBgTW9kdXM6ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0aW9uTW9kZSB8fCAnTmljaHQgZmVzdGdlbGVndCd9YDsgLy8gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgLy8gVHJ1bmNhdGUgbG9uZyBsaXN0cyBmb3IgZGlzcGxheSBpZiBuZWNlc3NhcnlcclxuICAgICAgICAgY29uc3QgZm9sZGVyVGV4dCA9IGBBdXNnZXdcdTAwRTRobHRlIE9yZG5lcjogJHsodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzPy5sZW5ndGggfHwgMCl9IFN0XHUwMEZDY2tgOyAvLyBUZXh0IGluIEdlcm1hblxyXG4gICAgICAgICBjb25zdCBmaWxlVGV4dCA9IGBBdXNnZXdcdTAwRTRobHRlIERhdGVpZW46ICR7KHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRmlsZXM/Lmxlbmd0aCB8fCAwKX0gU3RcdTAwRkNja2A7IC8vIFRleHQgaW4gR2VybWFuXHJcblxyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IG1vZGVUZXh0IH0pO1xyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGZvbGRlclRleHQgfSk7XHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogZmlsZVRleHQgfSk7XHJcbiAgICAgICAgIC8vIFlvdSBjb3VsZCBhZGQgYSBzbWFsbCBidXR0b24vbGluayBoZXJlIHRvIHZpZXcgdGhlIGZ1bGwgbGlzdCBpZiBpdCdz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QUNyQyxhQUFhLElBQUksU0FBTyxPQUFPLEtBQUssRUFBRSxLQUFLLElBQUk7QUFBQSxNQUN2RDtBQUVBLG1CQUFhO0FBQUEsRUFBUTtBQUFBLEtBQTBCO0FBQUEsSUFDbkQsT0FBTztBQUVILFVBQUksYUFBYSxTQUFTLEdBQUc7QUFDekIscUJBQWE7QUFBQSxFQUFRLEtBQUssU0FBUztBQUFBLElBQy9CLGFBQWEsSUFBSSxTQUFPLE9BQU8sS0FBSyxFQUFFLEtBQUssSUFBSSxJQUMvQztBQUFBO0FBQUE7QUFBQSxFQUFZO0FBQUEsTUFDcEIsT0FBTztBQUVIO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxVQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxVQUFVO0FBQUEsRUFDaEQ7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJqc0NvZGUiLCAidGV4dCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInJ1bGUiLCAiY21FZGl0b3IiLCAianNDb2RlIiwgIl9hIl0KfQo=
