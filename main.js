/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FolderTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian30 = require("obsidian");

// src/settings.ts
var import_obsidian12 = require("obsidian");

// src/frontmatter-tools.ts
var import_obsidian2 = require("obsidian");

// src/Log.ts
var import_obsidian = require("obsidian");

// src/Error.ts
var ErrorManager = class extends Error {
  constructor(msg, console_msg) {
    super(msg);
    this.console_msg = console_msg;
    this.name = this.constructor.name;
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, this.constructor);
    }
  }
};
function errorWrapperSync(fn2, msg) {
  try {
    return fn2();
  } catch (e) {
    if (e instanceof Error) {
      logError(new ErrorManager(msg, e.message));
    } else {
      logError(new ErrorManager(msg, String(e)));
    }
    return null;
  }
}

// src/Log.ts
var LOG = 0;
var ALERT = 1;
var ERROR = 2;
var WARNING = 3;
var INFO = 4;
var DEBUG = 5;
var TRACE = 6;
function logError(e) {
  const notice = new import_obsidian.Notice("", 8e3);
  if (e instanceof ErrorManager && e.console_msg) {
    notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}<br/>Check console for more information`;
    console.error(`Frontmatter Error:`, e.message, "\n", e.console_msg);
  } else {
    notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}`;
  }
}
var Logger = class {
  constructor() {
    this.logLevel = INFO;
  }
  setLevel(level) {
    if (typeof level === "number") {
      this.logLevel = level;
      this.log(LOG, `Log level set to ${this.getLevelName(this.logLevel)}`);
    } else {
      const levelName = level.toUpperCase();
      const levelIndex = this.getLevelNames().indexOf(levelName) + 1;
      if (levelIndex >= 0) {
        this.setLevel(levelIndex);
      } else {
        this.log(WARNING, `Invalid log level name: ${levelName}`);
      }
    }
  }
  getLevel() {
    return this.logLevel;
  }
  getLevelByName(levelName) {
    const levelIndex = this.getLevelNames().indexOf(levelName.toUpperCase()) + 1;
    if (levelIndex >= 0) {
      return levelIndex;
    } else {
      this.log(WARNING, `Invalid log level name: ${levelName}`);
      return INFO;
    }
  }
  getLevelByIndex(levelIndex) {
    if (levelIndex >= ALERT && levelIndex <= TRACE) {
      return levelIndex;
    } else {
      this.log(WARNING, `Invalid log level index: ${levelIndex}`);
      return INFO;
    }
  }
  getLevelByValue(levelValue) {
    if (levelValue >= ALERT && levelValue <= TRACE) {
      return levelValue;
    } else {
      this.log(WARNING, `Invalid log level value: ${levelValue}`);
      return INFO;
    }
  }
  shouldLog(level) {
    if (level === 0)
      return true;
    return level <= this.logLevel;
  }
  getLevelName(level) {
    switch (level) {
      case ALERT:
        return "ALERT";
      case ERROR:
        return "ERROR";
      case WARNING:
        return "WARNING";
      case INFO:
        return "INFO";
      case DEBUG:
        return "DEBUG";
      case TRACE:
        return "TRACE";
      default:
        return "LOG";
    }
  }
  getLevelNames() {
    return [ALERT, ERROR, WARNING, INFO, DEBUG, TRACE].map((level) => this.getLevelName(level));
  }
  log(level, ...msg) {
    if (!this.shouldLog(level))
      return;
    const levelName = this.getLevelName(level);
    let color = "";
    switch (level) {
      case ALERT:
        color = "background: #d32f2f; color: white; font-weight: bold";
        break;
      case ERROR:
        color = "color: #d32f2f; font-weight: bold";
        break;
      case WARNING:
        color = "color: #fbc02d; font-weight: bold";
        break;
      case INFO:
        color = "color: #1976d2; font-weight: bold";
        break;
      case DEBUG:
        color = "color: #388e3c;";
        break;
      case TRACE:
        color = "color: #616161;";
        break;
      default:
        color = "";
        break;
    }
    const prefix = `%c[${levelName}]`;
    const err = new Error();
    let caller = "";
    if (err.stack) {
      const stackLines = err.stack.split("\n");
      if (stackLines.length >= 3) {
        caller = stackLines[2].trim();
      }
    }
    switch (level) {
      case ALERT:
      case ERROR:
        console.groupCollapsed(prefix, color, ...msg);
        console.log("Caller Stack:", err);
        console.groupEnd();
        break;
      case WARNING:
        console.groupCollapsed(prefix, color, ...msg);
        console.log("Caller Stack:", err);
        console.groupEnd();
        break;
      case INFO:
        console.info(prefix, color, ...msg);
        break;
      case DEBUG:
      case TRACE:
      default:
        console.groupCollapsed(prefix, color, ...msg);
        console.log("Caller Stack:", err);
        console.groupEnd();
        break;
    }
    if (level === ALERT || level === ERROR) {
      new import_obsidian.Notice(`<b>Frontmatter Automate ${levelName}</b>:<br/>${msg.join(" ")}`, 8e3);
    }
  }
  groupCollapsed(level, ...msg) {
    if (!this.shouldLog(level))
      return;
    const levelName = this.getLevelName(level);
    let color = "";
    switch (level) {
      case ALERT:
        color = "background: #d32f2f; color: white; font-weight: bold";
        break;
      case ERROR:
        color = "color: #d32f2f; font-weight: bold";
        break;
      case WARNING:
        color = "color: #fbc02d; font-weight: bold";
        break;
      case INFO:
        color = "color: #1976d2; font-weight: bold";
        break;
      case DEBUG:
        color = "color: #388e3c;";
        break;
      case TRACE:
        color = "color: #616161;";
        break;
      default:
        color = "";
        break;
    }
    const prefix = `%c[${levelName}]`;
    console.groupCollapsed(prefix, color, ...msg);
  }
  groupEnd() {
    console.groupEnd();
  }
  logUpdate(msg) {
    new import_obsidian.Notice(`<b>Frontmatter Automate update</b>:<br/>${msg}`, 15e3);
  }
  logError(e) {
    const notice = new import_obsidian.Notice("", 8e3);
    if (e instanceof ErrorManager && e.console_msg) {
      notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}<br/>Check console for more information`;
      logger.log(ERROR, `Frontmatter Error:`, e.message, "\n", e.console_msg);
    } else {
      notice.messageEl.innerHTML = `<b>Frontmatter Automate Error</b>:<br/>${e.message}`;
    }
  }
};
var logger = new Logger();

// src/frontmatter-tools.ts
function getPropertiesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    logger.log(DEBUG, "get properties:", metadataManager);
    return Object.values(metadataManager.properties).map((value) => ({
      name: value.name,
      type: value.type,
      count: value.count,
      source: "registered"
    })).sort((a, b) => a.name.localeCompare(b.name));
  } catch (e) {
    logger.log(ERROR, "Couldn't access properties from Metadata Manager", e);
    return [];
  }
}
function getTypesFromMetadataManager(app) {
  try {
    const metadataManager = app.metadataTypeManager;
    logger.log(DEBUG, "get types:", metadataManager);
    return Object.values(metadataManager.registeredTypeWidgets).map((value, index, array) => ({
      type: value.type,
      icon: value.icon,
      jsType: ""
    })).sort((a, b) => a.type.localeCompare(b.type));
  } catch (e) {
    logger.log(ERROR, "Couldn't access properties from Metadata Manager", e);
    return [];
  }
}

// src/tools.ts
var import_obsidian4 = require("obsidian");

// src/alertBox.ts
var import_obsidian3 = require("obsidian");
var AlertModal = class extends import_obsidian3.Modal {
  constructor(app, title, description, btn1, btn2, askAgainLabel) {
    super(app);
    this.title = title;
    this.description = description;
    this.btn1Text = btn1;
    this.btn2Text = btn2;
    this.askAgainLabel = askAgainLabel;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: this.title });
    contentEl.createEl("p", { text: this.description });
    const settings = new import_obsidian3.Setting(contentEl);
    if (this.askAgainLabel) {
      const itemInfoDiv = settings.settingEl.getElementsByClassName("setting-item-info")[0];
      if (itemInfoDiv) {
        this.checkboxEl = itemInfoDiv.createEl("input", { type: "checkbox" });
        const label = itemInfoDiv.createEl("label", { text: this.askAgainLabel });
        label.style.marginLeft = "8px";
      }
    }
    settings.addButton((btn) => {
      btn.setButtonText(this.btn1Text).setCta().onClick(() => {
        var _a;
        this.close();
        this.resolvePromise({ proceed: true, data: { askConfirmation: (_a = this.checkboxEl) == null ? void 0 : _a.checked } });
      });
    });
    settings.addButton((btn) => {
      btn.setButtonText(this.btn2Text).onClick(() => {
        var _a;
        this.close();
        this.resolvePromise({ proceed: false, data: { askConfirmation: (_a = this.checkboxEl) == null ? void 0 : _a.checked } });
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  async openAndGetValue() {
    this.open();
    return this.promise;
  }
};

// src/rules/rules.ts
var RulePrototype = class {
  constructor(app, plugin) {
    this.rulesConfigDiv = void 0;
    this.ruleType = "buildIn";
    this.isLiveRule = false;
    // If true, the rule is a live rule and will be executed on file change
    this.type = ["text"];
    // Types that are supported by this rule
    this.configElements = {};
    // Elements that are used to configure the rule
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = ''\n  return result;\n}";
    this.scriptingTools = new ScriptingTools(app, plugin);
  }
  getSource() {
    return this.source;
  }
  fx(app, file, tools, input) {
    if (input === void 0 || input === null)
      input = tools.getCurrentContent();
    return input;
  }
  /**
   * Configures the settings tab for a specific rule in the plugin.
   *
   * @param optionEL - The HTML element where the configuration options will be rendered.
   * @param rule - The settings object for the frontmatter automation rule.
   * @param that - The context or reference to the calling object.
   * @param previewComponent - The component used to render a preview of the rule's effect.
   */
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
  }
  defaultConfigElements(modifiers) {
    const configElements = {
      removeContent: true,
      ruleActive: true,
      modifyOnly: true,
      inputProperty: false,
      addPrefix: true,
      spaceReplacement: true,
      specialCharacterReplacement: true,
      convertToLowerCase: true,
      resultAsLink: true,
      addContent: true,
      excludeFolders: true,
      includeFolders: true,
      script: true
    };
    return Object.assign({}, configElements, modifiers);
  }
  /**
   * Checks if a specific rule option is enabled.
   *
   * @param {string} option - The name of the rule option to check.
   * @returns {boolean} - Returns true if the option is enabled, false otherwise.
   */
  useRuleOption(option) {
    if (this.configElements[option] === void 0) {
      return false;
    }
    return this.configElements[option] || false;
  }
  /**
   * Checks if the rule has any configuration options.
   *
   * @returns {boolean} - Returns true if the rule has options, false otherwise.
   */
  hasOwnConfigTab() {
    return Object.getPrototypeOf(this).configTab !== RulePrototype.prototype.configTab;
  }
  /**
   * Executes the `fx` function based on the `ruleType`.
   * Handles different function signatures dynamically.
   * 
   * @param {App} app - The Obsidian app instance.
   * @param {any} file - The file to pass to the rule's `fx` function.
   * @param {ScriptingTools} tools - The scripting tools to pass to the rule's `fx` function.
   * @param {any} [input] - Optional input for rules that require it (e.g., `buildIn.inputProperty`).
   * @returns {string} - The result of the `fx` function.
  */
  execute(app, file, tools, input) {
    switch (this.ruleType) {
      case "formatter":
      case "linkFormatter":
        return this.fx(app, file, tools, input);
      case "buildIn.inputProperty":
        return this.fx(app, file, tools, input);
      case "autocomplete.modal":
      case "automation":
        let result = "";
        this.fx(app, file, tools).then((res) => {
          result = res;
        }).catch((err) => {
          logger.log(ERROR, `Error executing async automation rule: ${err}`);
        });
        return result;
      default:
        return this.fx(app, file, tools);
    }
  }
};
var Rules = class {
  constructor(app, plugin) {
    this.app = void 0;
    this.plugin = void 0;
    this.tools = void 0;
    this.plugin = plugin;
    this.app = app;
    this.tools = void 0;
    this.rules = [];
  }
  init(app, plugin, tools) {
    this.app = app;
    this.plugin = plugin;
    this.tools = tools;
  }
  /**
   * Registers a new rule by adding it to the list of existing rules.
   *
   * @param rule - The rule prototype to be registered. This should conform to the `RulePrototype` interface.
   */
  registerRule(rule) {
    this.rules.push(rule);
  }
  /**
   * Retrieves a list of rules filtered by the specified rule type and property type.
   *
   * @param ruleType - The type of rule to filter by.
   * @param propertyType - The property type to filter by within the rule's type array.
   * @returns An array of objects containing the `id` and `name` of each matching rule, sorted alphabetically by name.
   */
  getRulesByType(ruleType, propertyType) {
    return this.rules.filter((rule) => rule.ruleType === ruleType && (!propertyType || rule.type.includes(propertyType))).map((rule) => ({ id: rule.id, name: rule.name })).sort((a, b) => a.name.localeCompare(b.name));
  }
  /**
   * Retrieves a rule object by its unique identifier.
   *
   * @param id - The unique identifier of the rule to retrieve.
   * @returns The rule object matching the provided ID, or `undefined` if no matching rule is found.
   * @throws Logs a warning to the console if the rule with the specified ID is not found.
   */
  getRuleById(id) {
    const ruleObject = this.rules.find((rule) => rule.id === id);
    if (!ruleObject) {
      logger.log(WARNING, `Rule with id "${id}" not found.`);
      return void 0;
    }
    return ruleObject;
  }
  /**
   * Retrieves the source code of a rule by its unique identifier.
   *
   * @param id - The unique identifier of the rule for which to retrieve the source code.
   * @returns The source code of the rule, or `undefined` if the rule is not found.
   */
  getSource(id) {
    const ruleObject = this.getRuleById(id);
    if (!ruleObject) {
      logger.log(WARNING, `Source for rule with id "${id}" not found.`);
      return void 0;
    }
    return ruleObject.getSource();
  }
  /**
   * Executes the `fx` function of a rule matching the given `id` and returns its result.
   * 
   * @param {string} id - The unique identifier of the rule to execute.
   * @param {App} app - The Obsidian app instance.
   * @param {any} file - The file to pass to the rule's `fx` function.
   * @param {ScriptingTools} tools - The scripting tools to pass to the rule's `fx` function.
   * @param {any} [input] - Optional input for rules that require it.
   * @returns {string | null} - The result of the `fx` function, or `null` if the rule is not found.
  */
  executeRuleById(id, ruleSettings, app, file, tools, input) {
    const rule = this.rules.find((rule2) => rule2.id === id);
    if (!rule) {
      logger.log(WARNING, `Rule with id "${id}" not found.`);
      return null;
    }
    return this.executeRule(ruleSettings, rule, app, file, tools, input);
  }
  /**
   * Executes the `fx` function of a given rule and returns its result.
   *
   * @param rule - The rule to execute.
   * @param app - The Obsidian app instance.
   * @param file - The file to pass to the rule's `fx` function.
   * @param tools - The scripting tools to pass to the rule's `fx` function.
   * @param input - Optional input for rules that require it.
   * @returns {string | null} - The result of the `fx` function, or `null` if the rule is not found.
   */
  executeRule(ruleSettings, rule, app, file, tools, input) {
    switch (rule.ruleType) {
      case "formatter":
      case "linkFormatter":
      case "buildIn.inputProperty":
        return rule.execute(app, file, tools, input);
      case "automation":
        return rule.execute(app, file, tools);
      default:
        if (ruleSettings.useCustomCode && ruleSettings.buildInCode && ruleSettings.buildInCode !== "") {
          const code = parseJSCode(ruleSettings.buildInCode);
          if (typeof code === "function") {
            return code(app, file, tools);
          } else {
            logger.log(ERROR, `Invalid custom code for rule "${ruleSettings.content}": ${ruleSettings.buildInCode}`);
            return `Invalid custom code for rule "${ruleSettings.id}"`;
          }
        } else {
          return rule.execute(app, file, tools, input);
        }
    }
  }
  applyFormatOptions(value, rule, activeFile, tools) {
    if (rule.type === "number" || rule.type === "checkbox" || rule.type === "date" || rule.type === "datetime")
      return value;
    switch (typeof value) {
      case "boolean":
      case "number":
        return value;
      case "string":
        if (rule.formatters && rule.formatters.length > 0) {
          rule.formatters.forEach((formatterId) => {
            value = this.executeRuleById(formatterId, rule, this.app, activeFile, tools, value);
          });
        }
        if (rule.linkFormatter && rule.linkFormatter !== "") {
          value = this.executeRuleById(rule.linkFormatter, rule, this.app, activeFile, tools, value);
        }
        return value;
      case "object":
        if (Array.isArray(value)) {
          return value.map((value2) => this.applyFormatOptions(value2, rule, activeFile, tools));
        }
        return value;
    }
    return;
  }
  mergeResult(result, oldResult, returnResult, rule) {
    if (!this.tools) {
      console.warn("Tools are not available for merging results.");
      return result;
    }
    switch (rule.addContent) {
      case "overwrite":
        returnResult = result;
        break;
      case "end":
        if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
          if (!result)
            result = [];
          if (typeof result === "string")
            result = [result];
          if (!Array.isArray(returnResult))
            returnResult = [returnResult];
          if (!Array.isArray(oldResult))
            oldResult = [oldResult];
          let filtered = returnResult.filter((value) => !oldResult.includes(value));
          returnResult = this.tools.removeDuplicateStrings(filtered.concat(result));
        } else {
          if (!returnResult)
            returnResult = "";
          returnResult = returnResult.replaceAll(returnResult, oldResult);
          returnResult = returnResult + result;
        }
        break;
      case "start":
        if (rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
          if (!result)
            result = [];
          if (typeof result === "string")
            result = [result];
          if (!Array.isArray(returnResult))
            returnResult = [returnResult];
          if (!Array.isArray(oldResult))
            oldResult = [oldResult];
          let filtered = returnResult.filter((value) => !oldResult.includes(value));
          returnResult = this.tools.removeDuplicateStrings(result.concat(filtered));
        } else {
          if (!returnResult)
            returnResult = "";
          returnResult = returnResult.replaceAll(returnResult, oldResult);
          returnResult = result + returnResult;
        }
        break;
    }
    return returnResult;
  }
  /**
   * Builds the configuration tab for a specific rule by its ID.
   *
   * @param id - The unique identifier of the rule for which the configuration tab is being built.
   * @param optionEL - The HTML element where the configuration tab will be rendered.
   * @param rule - The definition of the rule, containing its properties and settings.
   * @param that - A reference to the current context or object, typically used for maintaining scope.
   * @param previewComponent - A component used to render a preview of the rule's effect or configuration.
   *
   * @remarks
   * If a rule with the specified ID is found, its `configTab` method is invoked to build the configuration tab.
   * If no rule is found, a warning is logged to the console.
   */
  buildConfigTab(id, optionEL, rule, that, previewComponent) {
    const ruleInstance = this.rules.find((rule2) => rule2.id === id);
    if (ruleInstance) {
      ruleInstance.configTab(optionEL, rule, that, previewComponent);
    } else {
      console.warn(`Rule with id "${id}" not found for config tab.`);
    }
  }
};
var rulesManager = new Rules();

// src/tools.ts
function parseJSCode(jsCode) {
  function parseFunction(jsCode2) {
    try {
      jsCode2 = cleanCodeString(jsCode2);
      var funcReg = /function *\(([^()]*)\)[ \n\t]*{(.*)}/gmi;
      var match = funcReg.exec(jsCode2.replace(/\n/g, " "));
      if (!match)
        return void 0;
      var args = match[1].split(",");
      args.push(match[2]);
      return new Function(...args);
    } catch (error) {
      logger.log(ERROR, "error parsing JS function!", error);
      return error.message;
    }
  }
  ;
  return parseFunction(jsCode);
}
function cleanCodeString(codeString) {
  if (typeof codeString !== "string") {
    throw new TypeError("Input must be a string.");
  }
  let inMultiLineComment = false;
  let inSingleLineComment = false;
  let inString = null;
  let inRegExp = false;
  let cleanedCode = "";
  let i = 0;
  while (i < codeString.length) {
    const char = codeString[i];
    const nextChar = codeString[i + 1];
    if (inMultiLineComment) {
      if (char === "*" && nextChar === "/") {
        inMultiLineComment = false;
        i += 2;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inSingleLineComment) {
      if (char === "\n" || char === "\r") {
        inSingleLineComment = false;
        cleanedCode += char;
        i++;
        continue;
      } else {
        i++;
        continue;
      }
    }
    if (inString) {
      if (char === inString) {
        inString = null;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (inRegExp) {
      if (char === "/") {
        inRegExp = false;
      } else if (char === "\\") {
        cleanedCode += char;
        i++;
        if (i < codeString.length) {
          cleanedCode += codeString[i];
        }
        i++;
        continue;
      }
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/" && nextChar === "*") {
      inMultiLineComment = true;
      i += 2;
      continue;
    }
    if (char === "/" && nextChar === "/") {
      inSingleLineComment = true;
      i += 2;
      continue;
    }
    if (char === '"' || char === "'") {
      inString = char;
      cleanedCode += char;
      i++;
      continue;
    }
    if (char === "/") {
      const prevMeaningfulChar = cleanedCode.trim().slice(-1);
      if (prevMeaningfulChar === "" || ["(", ",", "=", ":", "[", "!", "&", "|", "?", "{", ";", "\n", "\r"].includes(prevMeaningfulChar)) {
        inRegExp = true;
        cleanedCode += char;
        i++;
        continue;
      }
    }
    cleanedCode += char;
    i++;
  }
  return cleanedCode;
}
function resolveFolder(app, folder_str) {
  folder_str = (0, import_obsidian4.normalizePath)(folder_str);
  const folder = app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new ErrorManager(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian4.TFolder)) {
    throw new ErrorManager(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function getFilesFromFolder(app, folder_str) {
  const folder = resolveFolder(app, folder_str);
  const files = [];
  import_obsidian4.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian4.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.path.localeCompare(b.path);
  });
  return files;
}
var ScriptingTools = class {
  constructor(app, plugin, settings, rule, frontmatter, activeFile) {
    this.knownProperties = {};
    this.app = app;
    this.plugin = plugin;
    this.settings = settings;
    this.rule = rule;
    this.frontmatter = frontmatter;
    this.activeFile = activeFile;
  }
  /**
   * Retrieves the frontmatter object associated with the current instance.
   *
   * @returns The frontmatter data.
   */
  getFrontmatter() {
    return this.frontmatter;
  }
  /**
   * Sets the frontmatter property for the current instance.
   *
   * @param frontmatter - The frontmatter object to assign.
   */
  setFrontmatter(frontmatter) {
    this.frontmatter = frontmatter;
  }
  /**
   * Sets a property in the frontmatter object. If the frontmatter does not exist, it initializes it as an empty object.
   *
   * @param key - The property name to set in the frontmatter.
   * @param value - The value to assign to the specified property.
   */
  setFrontmatterProperty(key, value) {
    if (!this.frontmatter)
      this.frontmatter = {};
    this.frontmatter[key] = value;
  }
  /**
   * Retrieves the value of a specified property from the frontmatter object.
   *
   * @param key - The name of the property to retrieve from the frontmatter.
   * @returns The value associated with the specified key in the frontmatter, or `undefined` if the key does not exist.
   */
  getFrontmatterProperty(key) {
    return this.frontmatter[key];
  }
  /**
   * Sets the currently active file.
   *
   * @param file - The file to set as active. Must be an instance of `TFile`.
   */
  setActiveFile(file) {
    this.activeFile = file;
  }
  /**
   * Returns the currently active file.
   *
   * @returns The active file object, or `undefined` if no file is active.
   */
  getActiveFile() {
    return this.activeFile;
  }
  /**
   * Sets the current rule configuration for the frontmatter automation.
   *
   * @param rule - The rule settings to apply, represented by a `FrontmatterAutomateRuleSettings` object.
   */
  setRule(rule) {
    this.rule = rule;
  }
  /**
   * Retrieves the current rule associated with this instance.
   *
   * @returns The rule object or value stored in the `rule` property.
   */
  getRule() {
    return this.rule;
  }
  /**
   * Retrieves a rule function based on the provided rule settings.
   *
   * @param rule - Optional. The rule settings to use for retrieving the rule function.
   *               If not provided, the method uses the instance's default rule.
   * @returns The rule function associated with the specified rule settings, or `undefined` if no rule is found.
   */
  getRuleFunction(rule) {
    if (!rule)
      rule = this.rule;
    if (rule) {
      return rulesManager.getRuleById(rule.content);
    }
  }
  /**
   * Sets the current content to the provided value.
   *
   * @param content - The content to set as the current content. Can be of any type.
   */
  setCurrentContent(content) {
    this.currentContent = content;
  }
  /**
   * Retrieves the current content stored in the instance.
   *
   * @returns The current content.
   */
  getCurrentContent() {
    return this.currentContent;
  }
  /**
   * Updates the specified frontmatter property of a given file with new content.
   *
   * If no file is provided, the currently active file is used. If neither is available, the method returns early.
   * The method logs the update operation and only supports updating properties with primitive values or arrays.
   * If `newContent` is an object (but not an array), a warning is issued and the update is not performed.
   * The file's modification time (`mtime`) is preserved and not changed during the update.
   *
   * @param property - The frontmatter property to update.
   * @param newContent - The new value to assign to the property. Objects (except arrays) are not supported.
   * @param file - (Optional) The file whose frontmatter should be updated. If omitted, the active file is used.
   */
  updateFrontmatter(property, newContent, file) {
    if (!this.app)
      return;
    if (!file)
      file = this.activeFile;
    if (!file)
      return;
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      logger.log(DEBUG, `updateFrontmatter '${file.path}' frontmatter '${property}' to '${newContent.toString()}'`);
      if (typeof newContent === "object" && !Array.isArray(newContent)) {
        logger.log(WARNING, `updateFrontmatter '${file.path}'|'${property}' object not supported!`);
      } else {
        frontmatter[property] = newContent;
      }
    }, { "mtime": file.stat.mtime });
  }
  /**
   * Displays a confirmation dialog with customizable message, title, and button labels.
   *
   * @param message - The message to display in the confirmation dialog.
   * @param title - The title of the dialog window. Defaults to 'Confirm'.
   * @param button1 - The label for the confirmation button. Defaults to 'Yes'.
   * @param button2 - The label for the cancellation button. Defaults to 'No'.
   * @returns A promise that resolves to a boolean indicating whether the user confirmed (true) or cancelled (false).
   */
  async showConfirmDialog(message, title = "Confirm", button1 = "Yes", button2 = "No") {
    const result = await new AlertModal(this.app, title, message, button1, button2).openAndGetValue();
    return result.proceed;
  }
  /**
   * * Get the option config for a specific rule. Optional the specific parameter by providing an option ID.
   *
   * @param {string} ruleId
   * @param {string} [optionId]
   * @return {*} 
   */
  getOptionConfig(ruleId, optionId) {
    if (!ruleId || ruleId === void 0 || !this.settings)
      return void 0;
    const rule = this.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule && rule.hasOwnProperty("optionsConfig")) {
      const optionConfig = rule.optionsConfig[ruleId];
      if (optionConfig) {
        if (optionId) {
          logger.log(TRACE, `getOptionConfig: ${ruleId} option '${optionId}'`, rule, optionConfig[optionId]);
          return optionConfig[optionId];
        } else {
          return optionConfig;
        }
      }
    }
    return void 0;
  }
  /**
   * Retrieves all markdown files in the vault whose paths include the specified matching string.
   *
   * The `matching` parameter is normalized to ensure it ends with a single '/' character,
   * and is used to filter files whose paths contain this substring.
   *
   * @param folderPath - The folder path or substring to match within file paths.
   * @returns An array of `TFile` objects whose paths include the normalized `matching` string.
   */
  getFilesInVault(folderPath) {
    folderPath = folderPath.replace(/^\/|\/$/g, "") + "/";
    const files = this.app.vault.getMarkdownFiles();
    const matchingFiles = files.filter((file) => file instanceof import_obsidian4.TFile && file.path.includes(folderPath));
    return matchingFiles;
  }
  /**
   * Creates a mock `TFile` object from a given file path string.
   *
   * This method parses the provided path to construct a `TFile`-like object,
   * extracting the file name, extension, and base name. The returned object
   * contains placeholder values for file statistics and parent, as these details
   * are unknown. If the input path is empty or undefined, the method returns `undefined`.
   *
   * @param path - The file path string to generate the mock `TFile` from.
   * @returns A mock `TFile` object representing the file at the given path, or `undefined` if the path is invalid.
   */
  getMockFileFromPath(path2) {
    if (!path2)
      return void 0;
    let oldFile;
    let oldFileParts = path2.split("/");
    oldFile = {
      path: path2,
      extension: oldFileParts[oldFileParts.length - 1].split(".")[1],
      name: oldFileParts[oldFileParts.length - 1],
      stat: { mtime: 0, ctime: 0, size: 0 },
      // stats are unknown
      basename: this.removeAllExtensions(oldFileParts[oldFileParts.length - 1]),
      vault: this.app.vault,
      parent: null
      // parent is unknown
    };
    return oldFile;
  }
  /**
   * Retrieves a `TFile` object from a given file path.
   *
   * @param path - The file path to search for. If `undefined`, the function returns `undefined`.
   * @param filesCheck - An optional array of `TFile` objects to search within. If not provided, all markdown files in the vault are used.
   * @returns The matching `TFile` if found; otherwise, `undefined`.
   */
  getTFileFromPath(path2, filesCheck = void 0) {
    if (!path2)
      return void 0;
    const files = filesCheck ? filesCheck : this.app.vault.getMarkdownFiles();
    const matchingFiles = files.filter(
      (file) => file instanceof import_obsidian4.TFile && file.path.toLocaleLowerCase() === path2.toLocaleLowerCase()
    );
    return matchingFiles.length > 0 ? matchingFiles[0] : void 0;
  }
  /**
   * Creates a new file at the specified path using the content from a template file.
   * If the file already exists, returns the existing file instead of creating a new one.
   *
   * @param fileNameWithPath - The full path (including file name) where the new file should be created.
   * @param templateFileWithPath - The full path to the template file whose content will be used.
   * @returns A promise that resolves to the newly created file or the existing file if it already exists.
   * @throws {ErrorManager} If the folder path is invalid, does not exist, or is not a folder.
   */
  async createFileFromPath(fileNameWithPath, templateFileWithPath) {
    const fileName = fileNameWithPath.replace(/^\/|\/$/g, "");
    const templateFile = templateFileWithPath.replace(/^\/|\/$/g, "");
    const folderPath = this.getFolderFromPath(fileName);
    const fileNameOnly = fileName.split("/").pop() || fileName;
    if (!folderPath) {
      throw new ErrorManager(`Invalid folder path: "${folderPath}"`);
    }
    const folder = this.app.vault.getAbstractFileByPath(folderPath);
    if (!folder) {
      throw new ErrorManager(`Folder "${folderPath}" doesn't exist`);
    }
    if (!(folder instanceof import_obsidian4.TFolder)) {
      throw new ErrorManager(`${folderPath} is a file, not a folder`);
    }
    const templateContent = await this.app.vault.read(this.app.vault.getAbstractFileByPath(templateFile));
    const fileExists = this.app.vault.getAbstractFileByPath(fileNameWithPath);
    if (!fileExists) {
      return await this.app.vault.create(folder.path + "/" + fileNameOnly, templateContent);
    }
    return fileExists;
  }
  // create the file if it does not exist
  /**
   * * Fetches custom property information from all markdown files in the vault.
   *
   * @return {*} 
   */
  fetchCustomPropertyInfos(app) {
    const propertyInfos = {};
    const files = app.vault.getMarkdownFiles();
    files.forEach((file) => {
      const metadata = app.metadataCache.getFileCache(file);
      if (metadata == null ? void 0 : metadata.frontmatter) {
        Object.keys(metadata.frontmatter).forEach((key) => {
          if (!propertyInfos[key]) {
            propertyInfos[key] = { name: key, type: "text" };
          }
        });
      }
    });
    return propertyInfos;
  }
  /**
   * Fetches known properties from the metadata cache.
   * If the method getAllPropertyInfos is not available, it falls back to fetchCustomPropertyInfos.
   * @param app The Obsidian app instance.
   */
  async fetchKnownProperties(app) {
    let propertyInfos = {};
    if (typeof app.metadataCache.getAllPropertyInfos === "function") {
      propertyInfos = app.metadataCache.getAllPropertyInfos();
    } else {
      propertyInfos = this.fetchCustomPropertyInfos(app);
    }
    propertyInfos = Object.fromEntries(
      Object.entries(propertyInfos).sort(([keyA], [keyB]) => keyA.localeCompare(keyB))
    );
    this.knownProperties = {};
    Object.keys(propertyInfos).forEach((key) => {
      this.knownProperties[propertyInfos[key].name] = propertyInfos[key];
    });
    logger.log(DEBUG, this.knownProperties);
    return this.knownProperties;
  }
  /**
   * Retrieves the known properties, initializing them if they have not been loaded yet.
   * If the properties are not already cached, this method fetches them using `fetchCustomPropertyInfos`
   * and stores them for future access.
   *
   * @returns The cached or newly fetched known properties.
   */
  getKnownProperties() {
    if (!this.knownProperties) {
      this.knownProperties = this.fetchCustomPropertyInfos(this.app);
    }
    return this.knownProperties;
  }
  /**
   * Extracts the path and title from a given link string.
   *
   * The input link is expected to be in the format `[[path|title]]` or `[[path]]`.
   * This function removes square brackets, splits the link by the `|` character,
   * and determines the path and title. If the title is not provided, the path is
   * used as the title.
   *
   * @param link - The link string to extract parts from, typically in the format `[[path|title]]` or `[[path]]`.
   * @returns An object containing the `path` and `title` extracted from the link.
   */
  extractLinkParts(link) {
    const cleanedLink = link.replace(/[\[\]]/g, "");
    const parts = cleanedLink.split("|");
    const path2 = parts[0].trim();
    const title = parts.length > 1 ? parts[1].trim() : path2;
    return { path: path2, title };
  }
  /**
   * Extracts the path, title, and file name from a given file link string.
   *
   * Splits the input string by the "/" character to separate the file name from its path.
   * The title is derived from the file name by removing all extensions and trimming whitespace.
   *
   * @param link - The file link string to extract parts from.
   * @returns An object containing:
   *   - `path`: The directory path portion of the link (excluding the file name).
   *   - `title`: The file name without extensions and trimmed.
   *   - `fileName`: The full file name (with extensions, if any).
   */
  extractPathParts(link) {
    const parts = link.split("/");
    const fileName = parts.pop() || "";
    const title = this.removeAllExtensions(fileName).trim();
    const path2 = parts.join("/").trim();
    return { path: path2, title, fileName };
  }
  /**
   * Removes one or more leading slashes from the beginning of the given path string.
   *
   * @param path - The input string from which to remove leading slashes.
   * @returns The input string without any leading slashes.
   */
  removeLeadingSlash(path2) {
    return path2.replace(/^\/+/, "");
  }
  /**
   * Ensures that the given path string starts with a leading slash ('/').
   * If the path already begins with a slash, it is returned unchanged.
   *
   * @param path - The input path string to modify.
   * @returns The path string guaranteed to start with a leading slash.
   */
  addLeadingSlash(path2) {
    return path2.replace(/^(?!\/)/, "/");
  }
  /**
   * Check if a string complies with ISO Standard
   * 
   * @param str Any string
   * @param options Options to look for
   * @returns 
   */
  isISOString(str, options = {}) {
    const {
      withMilliseconds = false,
      withTimezone = false,
      withTime = true,
      withDate = true
    } = options;
    let dateRegexStr = "^(?:\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01]))";
    let timeRegexStr = "(?:T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
    if (withMilliseconds) {
      timeRegexStr += "\\.\\d{3}";
    }
    if (withTimezone) {
      timeRegexStr += "(?:Z|[+-](?:[01]\\d|2[0-3]):[0-5]\\d)?)?";
    } else {
      timeRegexStr += ")?";
    }
    let regexStr = "";
    if (withDate && withTime) {
      regexStr = `${dateRegexStr}${timeRegexStr}$`;
    } else if (withDate) {
      regexStr = `${dateRegexStr}$`;
    } else if (withTime) {
      regexStr = `^${timeRegexStr.slice(4)}$`;
    } else {
      return false;
    }
    const regex = new RegExp(regexStr);
    return regex.test(str);
  }
  /**
   * Try to convert Any Types to a specific Type
   * @param input 
   * @param typeString 'string' | 'number' | 'boolean' | 'string[]'
   * @returns 
   */
  tryConvert(input, typeString) {
    switch (typeString) {
      case "string":
        if (typeof input === "string") {
          return input;
        }
        return void 0;
      case "number":
        const num = Number(input);
        if (!isNaN(num)) {
          return num;
        }
        return void 0;
      case "boolean":
        if (typeof input === "boolean") {
          return input;
        }
        if (typeof input === "string") {
          const lowerValue = input.toLowerCase();
          if (lowerValue === "true") {
            return true;
          }
          if (lowerValue === "false") {
            return false;
          }
        }
        if (typeof input === "number") {
          if (input === 1) {
            return true;
          }
          if (input === 0) {
            return false;
          }
        }
        return void 0;
      case "string[]":
        if (Array.isArray(input) && input.every((item) => typeof item === "string")) {
          return input;
        }
        return void 0;
      default:
        return void 0;
    }
  }
  /**
   * Formats a given text string to be safe for use in YAML by replacing special characters.
   *
   * Replaces all characters that are not alphanumeric, dash, underscore, slash, or certain accented characters
   * with a specified replacement string. If no replacement string is provided, it uses the value from settings,
   * or defaults to `'-'`.
   *
   * @param text - The input string to format.
   * @param replaceBy - Optional. The string to replace special characters with. If not provided, uses the value from settings or `'-'`.
   * @returns The formatted string safe for YAML usage.
   */
  formatToYAMLSaveString(text, replaceBy = void 0) {
    let replaceString = "-";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.specialCharReplacement || "-";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, replaceString);
  }
  /**
   * Converts a string to a YAML-safe format by adding quotes when necessary.
   * @param input The string, boolean, number or array to make YAML-safe
   * @returns The safely quoted string when needed, or the original string if safe
   */
  toYamlSafeString(input) {
    if (Array.isArray(input)) {
      input.forEach((item, index) => {
        input[index] = this.toYamlSafeString(item).toString();
      });
      return input;
    }
    switch (typeof input) {
      case "number":
        return input;
      case "boolean":
        return input ? "true" : "false";
      case "string":
        const trimmed = input.trim();
        if (trimmed === "")
          return '""';
        const needsQuotes = /[:{}\[\],&*#?|<>=!%@`"'\\]|^[-?\n]|[\s\n]|^[yYnN]|^[0-9]|^[+-]|^(true|false|yes|no|on|off)$/i.test(trimmed);
        const isAlreadyQuoted = trimmed.startsWith('"') && trimmed.endsWith('"') || trimmed.startsWith("'") && trimmed.endsWith("'");
        if (!needsQuotes && !isAlreadyQuoted) {
          return trimmed;
        }
        if (!isAlreadyQuoted) {
          return `"${trimmed.replace(/"/g, '\\"')}"`;
        }
        return trimmed;
      default:
        logger.log(ERROR, `toYamlSafeString(${input}) if of type '${typeof input}'`);
        return input;
    }
  }
  /**
   * Converts an input string or array of strings into a Markdown Link format.
   * 
   * @param input - The input to be converted. Can be a string or an array of strings.
   * @param replaceSpaces - Optional parameter to specify a replacement for spaces in the path or title.
   *                        If provided, spaces will be replaced with this value.
   * @returns A string in Markdown Link format if the input is a single string, or a concatenated string
   *          of Markdown Links if the input is an array of strings.
   * 
   * The Markdown Link format is `[title](path)`, where:
   * - `path` is the formatted path of the link.
   * - `title` is the formatted title of the link.
   * 
   * If the input is an array, each element is converted to a WikiLink and joined with a comma.
   */
  toMarkdownLink(input, replaceSpaces) {
    if (Array.isArray(input)) {
      return input.map((item) => this.toWikiLink(item)).join(", ");
    }
    if (typeof input === "string") {
      const { path: path2, title, fileName } = this.extractPathParts(input);
      const formattedPath = this.replaceSpaces(input, replaceSpaces);
      const formattedTitle = this.replaceSpaces(title, replaceSpaces);
      return `[[${formattedPath}|${formattedTitle}]]`;
    }
    return input;
  }
  /**
   * Converts an input string or array of strings into a WikiLink format string or array of strings.
   * 
   * @param input - The input to be converted. Can be a string or an array of strings.
   * @param replaceSpaces - Optional parameter to specify a replacement for spaces in the path or title.
   *                        If provided, spaces will be replaced with this value.
   * @returns A string in WikiLink format if the input is a single string, or a concatenated string
   *          of WikiLinks if the input is an array of strings.
   * 
   * The WikiLink format is `[[fileName]]`, where:
   * - `fileName` is the formatted unique fileName of the link.
   * 
   * If the input is an array, each element is converted to a WikiLink and joined with a comma.
   */
  toWikiLink(input, replaceSpaces = " ") {
    if (Array.isArray(input)) {
      return input.flatMap((item) => this.toWikiLink(item));
    }
    if (typeof input === "string") {
      const { path: path2, title } = this.extractLinkParts(input);
      const formattedTitle = this.replaceSpaces(this.removeAllExtensions(title), replaceSpaces);
      return `[[${formattedTitle}]]`;
    }
    return input;
  }
  /**
   * Replaces all whitespace characters in the given text with a specified replacement string.
   *
   * @param text - The input string in which spaces will be replaced.
   * @param replaceBy - Optional. The string to replace spaces with. If not provided, uses the value from `this.settings.spaceReplacement` or defaults to '_'.
   * @returns The modified string with spaces replaced by the specified replacement string.
   */
  replaceSpaces(text, replaceBy = void 0) {
    let replaceString = "_";
    if (!replaceBy && this.settings) {
      replaceString = this.settings.spaceReplacement || "_";
    } else {
      if (replaceBy)
        replaceString = replaceBy;
    }
    return text.replace(/\s+/g, replaceString);
  }
  /**
   * Removes the ALL file extension(s) from a given file name.
   *
   * @param fileName - The name of the file, including its extension.
   * @returns The file name without its extension.
   */
  removeAllExtensions(fileName) {
    return fileName.split(".")[0];
  }
  /**
   * Removes the last file extension(s) from a given file name.
   *
   * @param fileName - The name of the file, including its extension.
   * @returns The file name without its extension.
   */
  removeExtensions(fileName) {
    const result = fileName.split(".");
    result.pop();
    if (result.length === 0)
      return fileName;
    return result.join(".") || fileName;
  }
  /**
   * Converts a given string to camelCase format.
   *
   * Splits the input text by spaces, lowercases the first word,
   * and capitalizes the first letter of each subsequent word,
   * then joins them together without spaces.
   *
   * @param text - The input string to be converted.
   * @returns The camelCase formatted string.
   */
  formatUpperCamelCase(text) {
    let textParts = text.split(" ");
    let convertedTextParts = [];
    textParts.forEach((text2, index) => {
      let newTextPart = text2.toLowerCase();
      newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
      convertedTextParts.push(newTextPart);
    });
    return convertedTextParts.join("");
  }
  /**
   * get the path to a file from a string containing the full parh/name string
   * @param path string
   * @param separator string defaults to '/'
   * @returns string
   */
  getFolderFromPath(path2, separator = "/") {
    if (path2 === null)
      return null;
    if (path2 === void 0)
      return void 0;
    const currentPathParts = path2.split("/");
    currentPathParts.pop();
    return currentPathParts.join(separator);
  }
  /**
   * removes duplicate strings in an array and deletes empty strings
   * @param stringArray 
   * @returns 
   */
  removeDuplicateStrings(stringArray) {
    if (!stringArray)
      return [];
    const uniqueStringsSet = new Set(stringArray);
    uniqueStringsSet.delete("");
    return [...uniqueStringsSet];
  }
};
function getFolderFromPath(path2, separator = "/") {
  if (path2 === null)
    return null;
  if (path2 === void 0)
    return void 0;
  const currentPathParts = path2.split("/");
  currentPathParts.pop();
  return currentPathParts.join(separator);
}

// src/types.ts
var versionString = "0.0.26";
var DEFAULT_FILTER_FILES_AND_FOLDERS = {
  selectedFolders: [],
  selectedFiles: [],
  mode: "exclude",
  display: "folders"
};
var DEFAULT_FRONTMATTER_AUTOMATE_SETTINGS = {
  tagPrefix: "",
  excludeRootFolder: false,
  tagsPropertyName: "tags",
  spaceReplacement: "",
  specialCharReplacement: "",
  lowercaseTags: false,
  knownProperties: [],
  rules: [],
  useTextArea: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folders"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folders"
  },
  configuredProperties: [],
  debugLevel: WARNING,
  delayCreateEvent: 0,
  // default to no delay
  folderConfig: { folders: [], rows: [] }
};
var DEFAULT_RULE_DEFINITION = {
  id: "",
  active: true,
  asLink: false,
  //deprecated
  addContent: "overwrite",
  property: "",
  value: "",
  customProperty: "",
  type: "text",
  typeProperty: { name: "", type: "text", source: "registered" },
  content: "",
  buildInCode: "",
  jsCode: "",
  showContent: false,
  exclude: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "exclude",
    display: "folders"
  },
  include: {
    selectedFolders: [],
    selectedFiles: [],
    mode: "include",
    display: "folders"
  },
  prefix: "",
  spaceReplacement: "",
  specialCharReplacement: "",
  lowercaseTags: false,
  //deprecated
  formatter: "toOriginal",
  //deprecated
  formatters: ["toOriginal"],
  linkFormatter: "toOriginalLink",
  inputProperty: "",
  onlyModify: true,
  useCustomCode: false
};

// src/directorySelectionModal.ts
var import_obsidian5 = require("obsidian");
var DirectorySelectionModal = class extends import_obsidian5.Modal {
  // Reference to update dropdown on reset
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param initialFolders - Array of initially selected folder paths.
   * @param initialFiles - Array of initially selected file paths.
   * @param initialMode - The initial selection mode ('include' or 'exclude').
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, initialFolders, initialFiles, initialOptions, okCallback) {
    super(app);
    this.showFiles = false;
    // Container for the tree view
    this.treeNodes = /* @__PURE__ */ new Map();
    // Map path to node info for quick access
    this.modeDropdown = null;
    this.initialFoldersSnapshot = new Set(initialFolders);
    this.initialFilesSnapshot = new Set(initialFiles);
    this.initialModeSnapshot = initialOptions.selectionMode;
    this.initialDisplaySnapshot = initialOptions.displayMode;
    this.showFiles = initialOptions.displayMode === "files" || initialOptions.displayMode === "file" || initialFiles.length > 0;
    this.options = initialOptions;
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    this.currentFolders = new Set(this.initialFoldersSnapshot);
    this.currentFiles = new Set(this.initialFilesSnapshot);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    this.currentFolders = /* @__PURE__ */ new Set([]);
    this.currentFiles = /* @__PURE__ */ new Set([]);
    this.currentMode = this.initialModeSnapshot;
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("directory-selection-modal");
    if (this.includeExcludeSelectable) {
      contentEl.createEl("h2", { text: this.options.title || "Include or Exclude Folders and Files" });
    } else {
      contentEl.createEl("h2", { text: this.options.title || `${this.currentMode === "exclude" ? "Exclude" : "Include"} Folders and Files` });
    }
    const controlsEl = contentEl.createDiv({ cls: "modal-controls" });
    this.createModeSetting(controlsEl);
    this.createShowFilesSetting(controlsEl);
    this.treeRootElement = contentEl.createDiv({ cls: "tree-view-container" });
    this.treeRootElement.style.maxHeight = "600px";
    this.treeRootElement.style.overflowY = "auto";
    this.treeRootElement.style.border = "1px solid var(--background-modifier-border)";
    this.treeRootElement.style.padding = "10px";
    this.treeRootElement.style.marginTop = "10px";
    this.treeRootElement.style.marginBottom = "10px";
    if (!this.treeNodes.size) {
      this.buildAndRenderTree();
    }
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the dropdown setting for choosing the selection mode.
   * @param containerEl - The HTML element to append the setting to.
   */
  createModeSetting(containerEl) {
    if (this.includeExcludeSelectable) {
      this.modeDropdown = new import_obsidian5.Setting(containerEl).setName("Selection Mode").setDesc("Choose if the selected files and folders should be excluded or included.").addDropdown((dropdown) => {
        dropdown.addOption("exclude", "exclude").addOption("include", "include").setValue(this.currentMode).onChange((value) => {
          this.currentMode = value;
          this.updateTreeAppearance();
        });
      });
    }
  }
  /**
   * Updates the mode dropdown UI element to reflect the currentMode state.
   */
  updateModeDropdown() {
    var _a;
    const dropdownComponent = (_a = this.modeDropdown) == null ? void 0 : _a.components[0];
    if (dropdownComponent && typeof dropdownComponent.setValue === "function") {
      dropdownComponent.setValue(this.currentMode);
    }
  }
  /**
   * Creates the toggle setting for showing/hiding files in the tree.
   * @param containerEl - The HTML element to append the setting to.
   */
  createShowFilesSetting(containerEl) {
    if (this.options.optionShowFiles) {
      new import_obsidian5.Setting(containerEl).setName("Show Files").setDesc("Show Files within the directory tree.").addToggle((toggle) => {
        toggle.setValue(this.showFiles).onChange((value) => {
          this.showFiles = value;
          this.buildAndRenderTree();
        });
      });
    }
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian5.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian5.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
      this.updateModeDropdown();
      this.buildAndRenderTree();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    okButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Builds the logical tree structure data from the vault's files and folders.
   * @returns The root node of the tree structure.
   */
  buildTreeData() {
    const vaultRootNode = {
      path: "/",
      // Root folder path
      name: this.app.vault.getName() || "Vault",
      // Use vault name or default
      type: "folder",
      children: [],
      // Placeholder elements, will be assigned during rendering
      element: null,
      checkbox: null,
      label: null,
      container: null
    };
    const folderNodes = /* @__PURE__ */ new Map();
    folderNodes.set("/", vaultRootNode);
    const allFiles = this.app.vault.getFiles();
    allFiles.forEach((file) => {
      const parentFolder = file.parent;
      if (!parentFolder)
        return;
      let currentPath = "";
      const pathParts = parentFolder.path.split("/").filter((p) => p.length > 0);
      let parentNode = vaultRootNode;
      pathParts.forEach((part) => {
        currentPath = currentPath === "/" ? part : `${currentPath}/${part}`;
        if (!folderNodes.has(currentPath)) {
          const newFolderNode = {
            path: currentPath,
            name: part,
            type: "folder",
            children: [],
            element: null,
            checkbox: null,
            label: null,
            container: null
          };
          folderNodes.set(currentPath, newFolderNode);
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(newFolderNode);
          parentNode = newFolderNode;
        } else {
          parentNode = folderNodes.get(currentPath);
        }
      });
    });
    if (this.showFiles) {
      allFiles.forEach((file) => {
        const parentFolder = file.parent;
        let parentPath = "";
        if (parentFolder) {
          parentPath = "/" + (parentFolder.path === "/" ? "" : parentFolder.path);
        }
        const parentNode = folderNodes.get(parentPath);
        const fileNode = {
          path: file.path,
          name: file.name,
          type: "file",
          element: null,
          checkbox: null,
          label: null,
          container: null
        };
        if (parentNode) {
          if (!parentNode.children) {
            parentNode.children = [];
          }
          parentNode.children.push(fileNode);
        }
      });
    }
    const sortNodes = (a, b) => {
      if (a.type === "folder" && b.type === "file")
        return -1;
      if (a.type === "file" && b.type === "folder")
        return 1;
      return a.name.localeCompare(b.name);
    };
    folderNodes.forEach((node) => {
      var _a;
      return (_a = node.children) == null ? void 0 : _a.sort(sortNodes);
    });
    return vaultRootNode;
  }
  /**
   * Renders the entire tree structure in the DOM based on the tree data.
   */
  renderTree() {
    var _a;
    this.treeRootElement.empty();
    this.treeNodes.clear();
    const treeData = this.buildTreeData();
    const rootUl = this.treeRootElement.createEl("ul");
    rootUl.addClass("tree-root-ul");
    rootUl.style.listStyle = "none";
    rootUl.style.paddingLeft = "0";
    this.renderTreeNode(treeData, rootUl, 0, this.currentFolders, this.currentFiles);
    (_a = treeData.children) == null ? void 0 : _a.forEach((childNode) => {
    });
  }
  /**
   * Recursively renders a single tree node and its children in the DOM.
   * @param node - The TreeNode data to render.
   * @param parentElement - The HTML `ul` element to append this node's `li` to.
   * @param level - The current indentation level.
   */
  renderTreeNode(node, parentElement, level, selectedPaths, selectedfiles) {
    const li = parentElement.createEl("li");
    li.style.marginLeft = `${level * 20}px`;
    li.addClass(`tree-node-${node.type}`);
    const container = li.createDiv({ cls: "tree-node-container" });
    container.style.display = "flex";
    container.style.alignItems = "center";
    container.style.padding = "2px 0";
    let toggleButton = null;
    let isCollapsed = true;
    if (node.type === "folder") {
      toggleButton = container.createSpan({ cls: "tree-toggle-button" });
      toggleButton.textContent = "\u25B6";
      toggleButton.style.cursor = "pointer";
      toggleButton.style.marginRight = "5px";
      const shouldExpand = this.shouldExpandFolder(node, selectedPaths, selectedfiles);
      if (shouldExpand) {
        isCollapsed = false;
      }
      toggleButton.onclick = () => {
        isCollapsed = !isCollapsed;
        if (toggleButton)
          toggleButton.textContent = isCollapsed ? "\u25B6" : "\u25BC";
        if (childrenUl)
          childrenUl.style.display = isCollapsed ? "none" : "block";
      };
    }
    const checkbox = container.createEl("input", { type: "checkbox" });
    checkbox.id = `tree-cb-${node.path.replace(/[^a-zA-Z0-9]/g, "-")}`;
    checkbox.dataset.path = node.path;
    checkbox.dataset.type = node.type;
    const label = container.createEl("label");
    label.textContent = `${node.type === "folder" ? "\u{1F4C1}" : "\u{1F4C4}"} ${node.name}`;
    label.htmlFor = checkbox.id;
    label.style.marginLeft = "5px";
    label.style.cursor = "pointer";
    label.title = node.path;
    node.element = li;
    node.checkbox = checkbox;
    node.label = label;
    node.container = container;
    this.treeNodes.set(node.path, node);
    if (node.type === "folder") {
      checkbox.checked = this.currentFolders.has(node.path);
    } else {
      checkbox.checked = this.currentFiles.has(node.path);
    }
    checkbox.onchange = (event) => {
      const target = event.target;
      const path2 = target.dataset.path;
      const type = target.dataset.type;
      if (target.checked) {
        if (type === "folder") {
          if (this.options.displayMode === "folder") {
            this.currentFolders.clear();
          }
          this.currentFolders.add(path2);
        } else {
          if (this.options.displayMode === "file") {
            this.currentFiles.clear();
          }
          this.currentFiles.add(path2);
        }
      } else {
        if (type === "folder")
          this.currentFolders.delete(path2);
        else
          this.currentFiles.delete(path2);
      }
      this.updateTreeAppearance();
    };
    let childrenUl = null;
    if (node.type === "folder" && node.children && node.children.length > 0) {
      childrenUl = li.createEl("ul");
      childrenUl.style.listStyle = "none";
      childrenUl.style.paddingLeft = "0";
      childrenUl.style.marginLeft = "0";
      childrenUl.style.display = isCollapsed ? "none" : "block";
      node.children.forEach((child) => this.renderTreeNode(child, childrenUl, level + 1, selectedPaths, selectedfiles));
    }
  }
  // Helper method to determine if a folder should be expanded
  shouldExpandFolder(node, selectedPaths, selectedFiles) {
    if (selectedPaths.has(node.path) || selectedFiles.has(node.path)) {
      return true;
    }
    if (node.children) {
      for (const child of node.children) {
        if (this.shouldExpandFolder(child, selectedPaths, selectedFiles)) {
          return true;
        }
      }
    }
    return false;
  }
  /**
   * Updates the visual appearance (enabled/disabled/styling) of all nodes
   * in the tree based on the current mode and selections.
   */
  updateTreeAppearance() {
    this.treeNodes.forEach((node) => {
      let isDisabled = false;
      let isEffectivelyIncluded = false;
      let isEffectivelyExcluded = false;
      let ancestorFolderSelected = false;
      let currentPath = node.path;
      while (currentPath !== "/") {
        const parentPath = currentPath.substring(0, currentPath.lastIndexOf("/")) || "/";
        if (this.currentFolders.has(parentPath)) {
          ancestorFolderSelected = true;
          break;
        }
        if (parentPath === currentPath)
          break;
        currentPath = parentPath;
      }
      const nodeSelected = node.type === "folder" ? this.currentFolders.has(node.path) : this.currentFiles.has(node.path);
      if (this.currentMode === "exclude") {
        isEffectivelyExcluded = nodeSelected || ancestorFolderSelected;
        isDisabled = isEffectivelyExcluded;
      } else {
        if (node.type === "folder") {
          isEffectivelyIncluded = nodeSelected || ancestorFolderSelected;
        } else {
          const parentPath = node.path.substring(0, node.path.lastIndexOf("/")) || "/";
          const parentEffectivelyIncluded = this.isPathEffectivelyIncluded(parentPath);
          isEffectivelyIncluded = nodeSelected || parentEffectivelyIncluded;
        }
        isDisabled = !isEffectivelyIncluded;
      }
      node.checkbox.disabled = false;
      node.checkbox.checked = nodeSelected;
      if (isDisabled) {
        node.element.addClass("is-disabled");
      } else {
        node.element.removeClass("is-disabled");
      }
      node.element.classList.remove("is-included", "is-excluded");
      if (this.currentMode === "include" && isEffectivelyIncluded) {
        node.element.addClass("is-included");
      } else if (this.currentMode === "exclude" && isEffectivelyExcluded) {
        node.element.addClass("is-excluded");
      }
    });
  }
  /**
   * Helper function to determine if a given path is effectively included
   * in the current selection under 'include' mode.
   * A path is included if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
   * @param path - The folder or file path to check.
   * @returns True if the path should be considered included, false otherwise.
   */
  isPathEffectivelyIncluded(path2) {
    if (this.currentMode !== "include") {
      return !this.isPathEffectivelyExcluded(path2);
    }
    if (this.currentFiles.has(path2) || this.currentFolders.has(path2)) {
      return true;
    }
    let current = path2;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
  * Helper function to determine if a given path is effectively excluded
  * in the current selection under 'exclude' mode.
  * A path is excluded if it (file or folder) is selected, or if any of its ancestor FOLDERS are selected.
  * @param path - The folder or file path to check.
  * @returns True if the path should be considered excluded, false otherwise.
  */
  isPathEffectivelyExcluded(path2) {
    if (this.currentMode !== "exclude") {
      return false;
    }
    if (this.currentFiles.has(path2) || this.currentFolders.has(path2)) {
      return true;
    }
    let current = path2;
    while (current !== "/") {
      const parentPath = current.substring(0, current.lastIndexOf("/")) || "/";
      if (this.currentFolders.has(parentPath)) {
        return true;
      }
      if (parentPath === current)
        break;
      current = parentPath;
    }
    return false;
  }
  /**
   * Combines building the tree data, rendering the DOM, and applying initial appearance.
   */
  buildAndRenderTree() {
    this.renderTree();
    this.updateTreeAppearance();
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      folders: Array.from(this.currentFolders),
      files: Array.from(this.currentFiles),
      mode: this.currentMode,
      display: this.currentDisplay
    };
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
    this.treeNodes.clear();
    this.modeDropdown = null;
  }
};
function openDirectorySelectionModal(app, initialFolders, initialFiles, options, okCallback) {
  new DirectorySelectionModal(
    app,
    initialFolders,
    initialFiles,
    options,
    okCallback
  ).open();
}

// src/settings-properties.ts
var import_obsidian11 = require("obsidian");

// src/rules.ts
function executeRuleObject(event, app, plugin, settings, currentFile, currentContent, rule, frontMatter, oldLocationResults) {
  var _a;
  if (!rule)
    return currentContent;
  if (!rule.active)
    return currentContent;
  if (!currentFile)
    return currentContent;
  if (!checkIfFileAllowed(currentFile, settings, rule))
    return currentContent;
  const tools = new ScriptingTools(app, plugin, settings, rule, frontMatter);
  let result = currentContent;
  let oldResult = void 0;
  tools.setCurrentContent(frontMatter[rule.property]);
  tools.setRule(rule);
  tools.setFrontmatter(frontMatter);
  tools.setActiveFile(currentFile);
  const ruleObject = rulesManager.getRuleById(rule.content);
  if (!ruleObject)
    return currentContent;
  result = rulesManager.executeRule(rule, ruleObject, app, currentFile, tools, frontMatter);
  result = rulesManager.applyFormatOptions(result, rule, currentFile, tools);
  if (oldLocationResults && oldLocationResults.length > 0 && rule.addContent !== "overwrite") {
    oldResult = (_a = oldLocationResults.find((res) => res.ruleId === rule.id)) == null ? void 0 : _a.result;
    if (!oldResult) {
      logger.log(ERROR, `executeRuleObject: Old result for rule ${rule.property}|${rule.content} not found!`, oldLocationResults);
      return result;
    }
    oldResult = rulesManager.applyFormatOptions(oldResult, rule, currentFile, tools);
    logger.log(DEBUG, `executeRuleObject: Merging result for rule ${rule.property}|${rule.content} with old result`, oldResult, result);
    result = rulesManager.mergeResult(result, oldResult, currentContent, rule);
  } else {
    result = rulesManager.mergeResult(result, result, currentContent, rule);
  }
  return result;
}
function filterFile(file, fileList, filterMode, type) {
  let result = false;
  const filterArray = type === "folders" ? fileList[filterMode].selectedFolders : fileList[filterMode].selectedFiles;
  if (filterArray.length === 0)
    return filterMode === "include" ? false : true;
  const filePath = file.path;
  const fileFolder = getFolderFromPath(file.path);
  const fileName = file.basename + "." + file.extension;
  if (type === "files") {
    result = filterArray.includes(filePath);
  }
  if (type === "folders") {
    for (let path2 of filterArray) {
      result = (fileFolder == null ? void 0 : fileFolder.startsWith(path2.slice(1))) || false;
      if (result === true)
        return filterMode === "exclude" ? !result : result;
    }
    ;
  }
  ;
  return filterMode === "exclude" ? !result : result;
}
function checkIfFileAllowed(file, settings, rule) {
  let result = true;
  if (!file)
    return false;
  if (settings) {
    try {
      if (settings.exclude.selectedFiles.length > 0) {
        result = filterFile(file, settings, "exclude", "files");
      }
      if (result && settings.exclude.selectedFolders.length > 0) {
        result = filterFile(file, settings, "exclude", "folders");
      }
      if (!result && settings.include.selectedFiles.length > 0) {
        result = filterFile(file, settings, "include", "files");
      }
      if (!result && settings.include.selectedFolders.length > 0) {
        result = filterFile(file, settings, "include", "folders");
      }
    } catch (error) {
      logger.log(ERROR, `Error filtering file ${file.path} globally: ${error}`);
      return false;
    }
  }
  if (rule) {
    try {
      if (result && rule.exclude.selectedFiles.length > 0) {
        result = filterFile(file, rule, "exclude", "files");
      }
      if (result && rule.exclude.selectedFolders.length > 0) {
        result = filterFile(file, rule, "exclude", "folders");
      }
      if (!result && rule.include.selectedFiles.length > 0) {
        result = filterFile(file, rule, "include", "files");
      }
      if (!result && rule.include.selectedFolders.length > 0) {
        result = filterFile(file, rule, "include", "folders");
      }
    } catch (error) {
      logger.log(ERROR, `Error filtering file ${file.path} by rule ${rule.property}|${rule.content}: ${error}`);
      return false;
    }
  }
  return result;
}

// src/settings-properties.ts
var import_crypto = require("crypto");

// src/editorModal.ts
var import_obsidian7 = require("obsidian");

// src/uiElements.ts
var import_obsidian6 = require("obsidian");
function renderValueInput(containerEl, propertyInfo, currentValue, changeCallback) {
  let returnComponent;
  containerEl.empty();
  if (!propertyInfo) {
    containerEl.setText("");
    containerEl.addClass("text-muted");
    return;
  }
  const type = propertyInfo.type;
  switch (type) {
    case "number":
      returnComponent = new import_obsidian6.TextComponent(containerEl).setPlaceholder("Numeric Value").setValue(currentValue !== void 0 && currentValue !== null ? String(currentValue) : "").onChange(async (value) => {
        const numValue = value === "" ? void 0 : parseFloat(value);
        changeCallback(propertyInfo, isNaN(numValue) ? void 0 : numValue);
      });
      returnComponent.inputEl.type = "number";
      break;
    case "checkbox":
      returnComponent = containerEl.createDiv({ cls: "tri-state-checkbox clickable-icon" });
      returnComponent.setAttribute("aria-label", "Checkbox change state");
      returnComponent.setAttribute("role", "checkbox");
      const updateCheckboxVisual = (state) => {
        let iconName;
        let ariaState;
        if (state === true) {
          iconName = "check-square";
          ariaState = "true";
        } else if (state === false) {
          iconName = "square";
          ariaState = "false";
        } else {
          iconName = "minus-square";
          ariaState = "mixed";
        }
        (0, import_obsidian6.setIcon)(returnComponent, iconName);
        returnComponent.setAttribute("aria-checked", ariaState);
        returnComponent.dataset.state = String(state);
      };
      updateCheckboxVisual(currentValue);
      returnComponent.addEventListener("click", async () => {
        let currentState = returnComponent.dataset.state;
        let nextState;
        if (currentState === "false") {
          nextState = true;
        } else if (currentState === "true") {
          nextState = void 0;
        } else {
          nextState = false;
        }
        changeCallback(propertyInfo, nextState);
        updateCheckboxVisual(nextState);
      });
      break;
    case "date":
      returnComponent = new import_obsidian6.TextComponent(containerEl).setPlaceholder("YYYY-MM-DD").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      returnComponent.inputEl.type = "date";
      break;
    case "datetime":
      returnComponent = new import_obsidian6.TextComponent(containerEl).setPlaceholder("YYYY-MM-DDTHH:mm").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      returnComponent.inputEl.type = "datetime-local";
      break;
    case "aliases":
    case "tags":
    case "multitext":
      returnComponent = new import_obsidian6.TextComponent(containerEl).setPlaceholder("values (divided by comma)").setValue(Array.isArray(currentValue) ? currentValue.join(", ") : currentValue || "").onChange(async (value) => {
        const arrayValue = value.split(",").map((s) => s.trim()).filter((s) => s);
        changeCallback(propertyInfo, arrayValue.length > 0 ? arrayValue : void 0);
      });
      break;
    case "text":
    default:
      returnComponent = new import_obsidian6.TextComponent(containerEl).setPlaceholder("value").setValue(currentValue || "").onChange(async (value) => {
        changeCallback(propertyInfo, value || void 0);
      });
      break;
  }
  if (type !== "checkbox") {
    returnComponent.inputEl.style.backgroundColor = "transparent";
    returnComponent.inputEl.style.width = "100%";
    returnComponent.inputEl.style.border = "none";
  }
  return returnComponent;
}
function updatePropertyIcon(iconEl, type) {
  let iconName = "hash";
  switch (type) {
    case "text":
      iconName = "align-left";
      break;
    case "number":
      iconName = "binary";
      break;
    case "multitext":
      iconName = "list";
      break;
    case "date":
      iconName = "calendar";
      break;
    case "datetime":
      iconName = "clock";
      break;
    case "checkbox":
      iconName = "check-square";
      break;
    case "tags":
      iconName = "tags";
      break;
    case "aliases":
      iconName = "forward";
      break;
    default:
      iconName = "help-circle";
  }
  (0, import_obsidian6.setIcon)(iconEl, iconName);
}

// src/editorModal.ts
var codeEditorModal = class extends import_obsidian7.Modal {
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param plugin - The plugin instance.
   * @param initialCode - String with the initial code.
   * @param expectedType - Expected return type.
   * @param activeFile - The currently active file or folder.
   * @param frontmatter - Frontmatter data for the active file.
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, plugin, initialCode, expectedType, activeFile, frontmatter, okCallback) {
    super(app);
    this.initialCode = initialCode;
    this.expectedType = expectedType;
    this.useTextArea = false;
    this.checkedSuccessfully = false;
    this.activeFile = activeFile;
    this.frontmatter = frontmatter;
    this.currentType = expectedType;
    this.currentCode = initialCode;
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(
      app,
      this.plugin,
      this.plugin.settings,
      void 0,
      this.frontmatter,
      this.activeFile instanceof import_obsidian7.TFile ? this.activeFile : void 0
    );
    this.okCallback = okCallback;
    this.resetSelectionToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetSelectionToInitial() {
    var _a;
    this.currentCode = this.initialCode;
    (_a = this.cmEditor) == null ? void 0 : _a.setValue(this.currentCode);
    if (this.functionResultTextComponent)
      this.functionResultTextComponent.setValue("");
  }
  /**
   * Resets the current selection state to empty.
   */
  resetSelectionToEmpty() {
    var _a;
    this.currentCode = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    (_a = this.cmEditor) == null ? void 0 : _a.setValue(this.currentCode);
    if (this.functionResultTextComponent)
      this.functionResultTextComponent.setValue("");
  }
  loadCodeMirrorMode(mode) {
    try {
      require(`obsidian/lib/codemirror/mode/${mode}/${mode}.js`);
      logger.log(DEBUG, `CodeMirror mode '${mode}' loaded successfully (using require).`);
    } catch (error) {
      logger.log(ERROR, `Failed to load CodeMirror mode '${mode}' (using require):`, error);
    }
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  async onOpen() {
    const { contentEl } = this;
    if (contentEl.parentElement)
      contentEl.parentElement.style.width = "900px";
    contentEl.empty();
    contentEl.addClass("codeEditor-modal");
    contentEl.createEl("h2", { text: "JavaScript Editor" });
    contentEl.createEl("body", { text: `Make sure your code results: ${this.expectedType}` });
    this.editorRootElement = contentEl.createDiv({ cls: "codeEditor-container" });
    this.editorRootElement.style.height = "600px";
    this.editorRootElement.style.overflowY = "auto";
    this.editorRootElement.style.padding = "10px";
    this.editorRootElement.style.marginTop = "10px";
    this.editorRootElement.style.marginBottom = "10px";
    this.cmEditor = null;
    const ruleOptionsDiv = contentEl.createDiv({ cls: "codeEditor-options" });
    if (this.useTextArea) {
      const ruleOptionsSettings = new import_obsidian7.Setting(this.editorRootElement).addTextArea((textArea) => {
        textArea.setPlaceholder("ender valid JS Code");
        textArea.inputEl.setAttribute("style", `height:190px; width:80%;`);
        textArea.onChange(async (value) => {
          if (this.functionTestButton)
            this.functionTestButton.buttonEl.addClass("mod-warning");
          this.currentCode = value;
        });
      });
    } else {
      const CodeMirror = window.CodeMirror;
      if (CodeMirror) {
        if (!CodeMirror.modes.javascript) {
          await this.loadCodeMirrorMode("javascript");
          logger.log(TRACE, "javaScript support loaded");
        }
      }
      let jsCode = this.currentCode;
      this.cmEditor = CodeMirror(this.editorRootElement, {
        value: jsCode || "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result; // return you result.\n}",
        mode: "javascript",
        lineNumbers: true,
        theme: "obsidian",
        indentUnit: 4,
        lineWrapping: false,
        readOnly: false,
        outerHeight: "600px"
      });
      if (this.cmEditor) {
        this.cmEditor.on("change", (cmEditor) => {
          if (this.functionTestButton)
            this.functionTestButton.buttonEl.addClass("mod-warning");
        });
        this.cmEditor.on("blur", (cmEditor) => {
          this.currentCode = cmEditor.getValue();
        });
      }
      ;
      new import_obsidian7.Setting(ruleOptionsDiv).addButton((button) => {
        this.functionTestButton = button;
        button.setWarning().setButtonText("Run Code").setTooltip("Run the code and check for errors").onClick(async () => {
          if (this.cmEditor) {
            let jsCode2 = this.cmEditor.getValue();
            let userFunction = parseJSCode(jsCode2);
            if (typeof userFunction === "string") {
              let errorHint = "See console for details!";
              if (userFunction.contains("Unexpected token")) {
                errorHint = "Did you missed a semicolon (;)?";
              }
              if (this.functionResultTextComponent)
                this.functionResultTextComponent.setValue(`Syntax error: ${userFunction}! ${errorHint}`);
              this.checkedSuccessfully = false;
              button.buttonEl.addClass("mod-warning");
            } else {
              if (userFunction) {
                try {
                  const result = userFunction(this.app, this.activeFile, this.scriptingTools);
                  if (this.functionResultTextComponent)
                    this.functionResultTextComponent.setValue(`'${result.toString()}' (${typeof result})`);
                  this.updateTypeIcons(result, typesContainer, this.expectedType, this.currentType, this.plugin.settings);
                  button.buttonEl.removeClass("mod-warning");
                  this.checkedSuccessfully = true;
                } catch (e) {
                  if (this.functionResultTextComponent) {
                    const errorMessage = e instanceof Error ? e.message : String(e);
                    this.functionResultTextComponent.setValue(`Syntax error: ${errorMessage}! See console for details!`);
                  }
                  logger.log(ERROR, "Syntax error. ", e, jsCode2, userFunction);
                  this.checkedSuccessfully = false;
                  button.buttonEl.addClass("mod-warning");
                }
              } else {
                logger.log(ERROR, "syntax error");
                this.checkedSuccessfully = false;
              }
            }
          }
        });
      }).addText((text) => {
        this.functionResultTextComponent = text;
        text.setPlaceholder("function result").setDisabled(true);
        this.functionResultTextComponent.inputEl.style.width = "580px";
      });
      const typesContainer = ruleOptionsDiv.createDiv({ cls: "property-icons-container" });
    }
    this.createActionButtons(contentEl);
  }
  updateTypeIcons(value, container, expectedType, currentType, settings) {
    const newType = typeof value;
    const typeIcons = {
      "string": ["text", "tags", "aliases", "multitext", "date", "datetime"],
      "number": ["number"],
      "boolean": ["checkbox"],
      "object": ["tags", "aliases", "multitext"]
    };
    if (newType === "string") {
      if (!this.scriptingTools.isISOString(value, { withDate: true })) {
        typeIcons[newType].splice(typeIcons[newType].indexOf("date"), 1);
      }
      if (!this.scriptingTools.isISOString(value, { withDate: true, withTime: true })) {
        typeIcons[newType].splice(typeIcons[newType].indexOf("datetime"), 1);
      }
    }
    container.empty();
    for (let obsidianType of typeIcons[newType]) {
      if (obsidianType) {
        const iconEl = container.createSpan({ cls: "property-icon setting-item-icon" });
        updatePropertyIcon(iconEl, obsidianType);
      }
    }
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian7.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetSelectionToInitial();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian7.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetSelectionToEmpty();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      logger.log(TRACE, "Cancel Clicked - Returning");
      this.okCallback(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.close();
    };
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const result = {
      code: this.currentCode,
      checked: this.checkedSuccessfully,
      type: "text"
    };
    logger.log(TRACE, "OK Clicked - Returning Result:", result);
    this.okCallback(result);
    const { contentEl } = this;
    contentEl.empty();
  }
};
function openCodeEditorModal(app, plugin, initialCode, expectedType, activeFile, frontmatter, okCallback) {
  new codeEditorModal(
    app,
    plugin,
    initialCode,
    expectedType,
    activeFile,
    frontmatter,
    okCallback
  ).open();
}

// src/uiMultiPropertySetting.ts
var import_obsidian8 = require("obsidian");
var MultiPropertySetting = class {
  constructor(container) {
    this.name = "";
    this.desc = "";
    this.value = [];
    this.onChangeCb = () => {
    };
    this.options = [];
    this.extraButtonCallbacks = [];
    this.container = container;
    this.settingEl = container.createDiv();
  }
  setName(name) {
    this.name = name;
    return this;
  }
  setDesc(desc) {
    this.desc = desc;
    return this;
  }
  setValue(value) {
    this.value = value.length ? [...value] : [""];
    this.render();
    return this;
  }
  setOptions(options) {
    this.options = options;
    this.render();
    return this;
  }
  onChange(cb) {
    this.onChangeCb = cb;
    return this;
  }
  /**
   * Allows adding extra buttons to each row.
   * The callback receives the Setting and the row index.
   */
  addExtraButton(cb) {
    this.extraButtonCallbacks.push(cb);
    this.render();
    return this;
  }
  styleDisabled(el, disabled) {
    if (disabled) {
      el.extraSettingsEl.addClass("mod-disabled");
      el.extraSettingsEl.setAttr("aria-disabled", "true");
      el.extraSettingsEl.tabIndex = -1;
      el.extraSettingsEl.removeAttribute("aria-label");
    } else {
      el.extraSettingsEl.removeClass("mod-disabled");
      el.extraSettingsEl.setAttr("aria-disabled", "false");
    }
  }
  render() {
    this.settingEl.empty();
    const arr = this.value;
    arr.forEach((selected, idx) => {
      const setting = new import_obsidian8.Setting(this.settingEl).setName(idx === 0 ? this.name : "").setDesc(idx === 0 ? this.desc : "").addDropdown((dd) => {
        this.options.forEach((item) => {
          if (typeof item === "string") {
            dd.addOption(item, item);
          } else {
            dd.addOption(item.id, item.name);
          }
        });
        dd.setValue(selected || "");
        dd.onChange((value) => {
          arr[idx] = value;
          this.value = arr;
          this.onChangeCb([...arr]);
          this.render();
        });
      });
      if (idx > 0) {
        setting.settingEl.style.borderTop = "none";
        setting.settingEl.style.padding = "0 0 0.75em";
      } else {
        setting.settingEl.style.borderTop = "1px solid var(--background-modifier-border)";
        setting.settingEl.style.padding = "0.75em 0";
      }
      const settingControl = setting.controlEl;
      if (settingControl) {
        settingControl.style.gap = "0.1em";
      }
      setting.addExtraButton((btn) => {
        btn.setIcon("arrow-up").setTooltip("Move up").setDisabled(idx === 0).onClick(() => {
          [arr[idx - 1], arr[idx]] = [arr[idx], arr[idx - 1]];
          this.value = arr;
          this.onChangeCb([...arr]);
          this.render();
        });
        this.styleDisabled(btn, idx === 0);
      });
      setting.addExtraButton((btn) => {
        btn.setIcon("arrow-down").setTooltip("Move down").setDisabled(idx === arr.length - 1).onClick(() => {
          [arr[idx], arr[idx + 1]] = [arr[idx + 1], arr[idx]];
          this.value = arr;
          this.onChangeCb([...arr]);
          this.render();
        });
        this.styleDisabled(btn, idx === arr.length - 1);
      });
      setting.addExtraButton((btn) => {
        btn.setIcon("minus-circle").setTooltip("Remove property").setDisabled(arr.length === 1).onClick(() => {
          arr.splice(idx, 1);
          this.value = arr.length ? arr : [""];
          this.onChangeCb([...this.value]);
          this.render();
        });
        this.styleDisabled(btn, arr.length === 1);
      });
      this.extraButtonCallbacks.forEach((cb) => cb(setting, idx));
    });
    const plusButton = new import_obsidian8.Setting(this.settingEl).addExtraButton((btn) => {
      btn.setIcon("plus-circle").setTooltip("Add property").setDisabled(arr[arr.length - 1] === "" || !arr[arr.length - 1]).onClick(() => {
        if (arr[arr.length - 1] !== "" && arr[arr.length - 1]) {
          arr.push("");
          this.value = arr;
          this.onChangeCb([...arr]);
          this.render();
        }
      });
      this.styleDisabled(btn, arr[arr.length - 1] === "" || !arr[arr.length - 1]);
    });
    plusButton.settingEl.style.borderTop = "none";
    plusButton.settingEl.style.padding = "0 0 0.75em";
  }
};

// src/uiTreeHierarchySortableSettings.ts
var import_obsidian9 = require("obsidian");
var ROOT_FOLDER = void 0;
var TreeHierarchySortableSettings = class {
  constructor(container, data, rowRenderCb) {
    this.title = "";
    this.description = "";
    this.filter = "";
    this.onChangeCb = () => {
    };
    this.onRowCreatedCb = () => {
    };
    this.onRowDeletedCb = () => {
    };
    this.onDeleteBtCb = () => {
    };
    this.onRenderedCb = () => {
    };
    this.extraButtonCbs = [];
    this.container = container;
    this.settingEl = container.createDiv({ cls: "FMA-folder-list-setting" });
    this.data = data || { folders: [], rows: [] };
    this.rowRenderCb = rowRenderCb;
    this.render();
  }
  setTitle(title) {
    this.title = title;
    this.render();
    return this;
  }
  setDescription(description) {
    this.description = description;
    this.render();
    return this;
  }
  addExtraButtonToHeader(cb) {
    this.extraButtonCbs.push(cb);
    this.render();
    return this;
  }
  onDeleteBt(cb) {
    this.onDeleteBtCb = cb;
    return this;
  }
  addRow(folderId, keywords = [], payload) {
    const newRow = {
      id: crypto.randomUUID(),
      folderId,
      keywords,
      disabled: false,
      payload
    };
    if (!folderId) {
      this.data.rows.push(newRow);
      this.onChangeCb(this.data);
      this.render();
      return this;
    }
    const lastIdx = this.data.rows.map((r) => r.folderId).lastIndexOf(folderId);
    if (lastIdx === -1) {
      this.data.rows.unshift(newRow);
    } else {
      this.data.rows.splice(lastIdx + 1, 0, newRow);
    }
    this.onRowCreatedCb(newRow);
    this.onChangeCb(this.data);
    this.render();
    return this;
  }
  addFolder(name, parentId) {
    const newFolder = {
      id: crypto.randomUUID(),
      name,
      parentId,
      disabled: false,
      // Default to enabled
      collapsed: false
      // Default to expanded
    };
    this.data.folders.push(newFolder);
    this.onChangeCb(this.data);
    this.render();
    return this;
  }
  setData(data) {
    this.data = data;
    this.render();
    return this;
  }
  onChange(cb) {
    this.onChangeCb = cb;
    return this;
  }
  onRowCreated(cb) {
    this.onRowCreatedCb = cb;
    return this;
  }
  onRowDeleted(cb) {
    this.onRowDeletedCb = cb;
    return this;
  }
  onRendered(cb) {
    this.onRenderedCb = cb;
    return this;
  }
  moveRow(rowId, targetRowId) {
    const fromIdx = this.data.rows.findIndex((r) => r.id === rowId);
    if (fromIdx === -1)
      return;
    if (rowId === targetRowId)
      return;
    const moved = this.data.rows[fromIdx];
    const row = this.data.rows[fromIdx];
    this.onRowDeletedCb(row);
    logger.log(TRACE, `removing id${rowId} from ${fromIdx}`, this.data.rows);
    this.data.rows.splice(fromIdx, 1);
    let insertIdx;
    if (targetRowId) {
      insertIdx = this.data.rows.findIndex((r) => r.id === targetRowId);
      if (insertIdx === -1) {
        insertIdx = this.data.rows.length;
      }
      const targetRow = this.data.rows[insertIdx];
      if (fromIdx <= insertIdx && moved.folderId === (targetRow == null ? void 0 : targetRow.folderId))
        insertIdx++;
      moved.folderId = targetRow == null ? void 0 : targetRow.folderId;
    } else {
      insertIdx = this.data.rows.length;
    }
    logger.log(TRACE, `Inserting moved row id${rowId} at ${insertIdx}`, this.data.rows);
    this.data.rows.splice(insertIdx, 0, moved);
    this.onChangeCb(this.data);
    this.render();
  }
  moveRowToFolder(rowId, folderId) {
    const fromIdx = this.data.rows.findIndex((r) => r.id === rowId);
    if (fromIdx === -1)
      return;
    const moved = this.data.rows[fromIdx];
    this.data.rows.splice(fromIdx, 1);
    moved.folderId = folderId;
    this.data.rows.push(moved);
    this.onChangeCb(this.data);
    this.render();
  }
  moveFolderToFolder(folderId, targetFolderId) {
    if (folderId === targetFolderId)
      return;
    const fromIdx = this.data.folders.findIndex((f) => f.id === folderId);
    if (fromIdx === -1)
      return;
    const moved = this.data.folders[fromIdx];
    this.data.folders.splice(fromIdx, 1);
    moved.parentId = targetFolderId;
    this.data.folders.push(moved);
    this.onChangeCb(this.data);
    this.render();
  }
  propagateFolderDisabled(folderId, disabled) {
    for (const folder of this.data.folders) {
      if (folder.parentId === folderId) {
        folder.disabled = disabled;
        this.propagateFolderDisabled(folder.id, disabled);
      }
    }
    for (const row of this.data.rows) {
      if (row.folderId === folderId) {
        row.disabled = disabled;
      }
    }
  }
  render() {
    this.settingEl.empty();
    const headerSetting = new import_obsidian9.Setting(this.settingEl).setClass("FMA-folder-list-root-header");
    headerSetting.settingEl.createSpan({ cls: "FMA-folder-list-drag-handle", text: " " });
    headerSetting.settingEl.style.borderTop = "1px solid var(--background-modifier-border)";
    headerSetting.settingEl.style.padding = "0.75em 0";
    headerSetting.setName(this.title || "");
    headerSetting.setDesc(this.description || "");
    const filterInput = new import_obsidian9.SearchComponent(headerSetting.controlEl);
    filterInput.setPlaceholder("Filter folders/rows...");
    filterInput.setValue(this.filter);
    filterInput.inputEl.style.width = "200px";
    filterInput.onChange((val) => {
      this.filter = val;
      this.renderList();
    });
    headerSetting.addExtraButton((btn) => {
      btn.setIcon("plus-circle").setTooltip("Add row to root").onClick(() => {
        this.addRow(void 0, []);
      });
    });
    headerSetting.addExtraButton((btn) => {
      btn.setIcon("folder").setTooltip("Add folder to root").onClick(() => {
        this.addFolder(this.getNextFolderName(), void 0);
      });
    });
    headerSetting.addExtraButton((btn) => {
      btn.setIcon("trash").setTooltip("Drop here to delete row or folder").onClick(() => {
        this.onDeleteBtCb();
        this.onChangeCb(this.data);
        this.render();
      });
      const binEl = btn.extraSettingsEl;
      binEl.addEventListener("dragover", (e) => {
        e.preventDefault();
        binEl.classList.add("FMA-bin-drop-target");
      });
      binEl.addEventListener("dragleave", (e) => {
        binEl.classList.remove("FMA-bin-drop-target");
      });
      binEl.addEventListener("drop", (e) => {
        var _a;
        e.preventDefault();
        binEl.classList.remove("FMA-bin-drop-target");
        const data = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
        if (!data)
          return;
        const { type, id } = JSON.parse(data);
        if (type === "row") {
          this.data.rows = this.data.rows.filter((r) => r.id !== id);
        } else if (type === "folder") {
          this.deleteFolderAndContents(id);
        }
        this.onChangeCb(this.data);
        this.render();
      });
    });
    this.extraButtonCbs.forEach((cb) => {
      cb(headerSetting);
    });
    this.renderList();
  }
  renderList() {
    const oldList = this.settingEl.querySelector(".FMA-folder-list-content");
    if (oldList)
      oldList.remove();
    const listEl = this.settingEl.createDiv({ cls: "FMA-folder-list-content" });
    this.renderFolder(void 0, listEl, 0);
    this.renderRows(void 0, listEl, 0);
    const dropZone = new import_obsidian9.Setting(listEl).setClass("FMA-folder-list-drop-zone");
    dropZone.settingEl.addEventListener("dragover", (e) => this.onDragOver(e, "root", "folder-dropzone"));
    dropZone.settingEl.addEventListener("drop", (e) => {
      var _a;
      e.preventDefault();
      e.stopPropagation();
      const data = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
      if (!data)
        return;
      const { type, id } = JSON.parse(data);
      if (type === "row") {
        this.moveRowToFolder(id, void 0);
      } else if (type === "folder") {
        this.moveFolderToFolder(id, void 0);
      }
    });
    dropZone.settingEl.addEventListener("dragenter", (e) => {
      e.preventDefault();
      e.stopPropagation();
      dropZone.settingEl.classList.add("FMA-dropzone-target");
    });
    dropZone.settingEl.addEventListener("dragleave", (e) => {
      e.preventDefault();
      e.stopPropagation();
      dropZone.settingEl.classList.remove("FMA-dropzone-target");
    });
    this.onRenderedCb();
  }
  renderFolder(parentId, parentEl, depth) {
    if (!this.data || !this.data.folders)
      return;
    const folders = this.data.folders.filter((f) => f.parentId === parentId);
    folders.forEach((folder) => {
      const setting = new import_obsidian9.Setting(parentEl).setClass("FMA-folder-list-folder-setting");
      setting.nameEl.empty();
      setting.settingEl.style.marginLeft = `${depth * 20}px`;
      const dragHandle = setting.nameEl.createSpan({ cls: "FMA-folder-list-drag-handle" });
      dragHandle.setText("\u2630");
      dragHandle.draggable = true;
      dragHandle.style.marginRight = "0.5em";
      dragHandle.addEventListener("dragstart", (e) => this.onDragStart(e, "folder", folder.id));
      dragHandle.addEventListener("dragover", (e) => this.onDragOver(e, "folder", folder.id));
      dragHandle.addEventListener("drop", (e) => this.onDrop(e, "folder", folder.id));
      setting.addToggle((toggle) => {
        toggle.setValue(!folder.disabled).onChange((val) => {
          folder.disabled = !val;
          this.propagateFolderDisabled(folder.id, folder.disabled);
          this.onChangeCb(this.data);
          this.renderList();
        });
      }).setTooltip("Disable all rules in this folder and subfolders");
      const nameInput = new import_obsidian9.TextComponent(setting.nameEl);
      nameInput.setValue(folder.name);
      nameInput.inputEl.style.maxWidth = "100%";
      nameInput.inputEl.style.border = "0";
      nameInput.inputEl.style.marginRight = "0.5em";
      nameInput.onChange((val) => {
        folder.name = val;
        this.onChangeCb(this.data);
      });
      setting.addExtraButton((btn) => {
        btn.setIcon("plus-circle").setTooltip("Add row to folder").onClick(() => {
          this.addRow(folder.id, []);
        });
      });
      setting.addExtraButton((btn) => {
        btn.setIcon("folder").setTooltip("Add subfolder").onClick(() => {
          this.addFolder(this.getNextFolderName(), folder.id);
        });
      });
      setting.addExtraButton((btn) => {
        var _a;
        const isCollapsed = (_a = folder.collapsed) != null ? _a : false;
        btn.setIcon(isCollapsed ? "chevron-right" : "chevron-down").setTooltip(isCollapsed ? "Expand" : "Collapse").onClick(() => {
          folder.collapsed = !isCollapsed;
          this.onChangeCb(this.data);
          this.renderList();
        });
      });
      setting.settingEl._dragEnterCount = 0;
      setting.settingEl.addEventListener("dragenter", (e) => {
        setting.settingEl._dragEnterCount++;
        setting.settingEl.classList.add("FMA-drop-target");
      });
      setting.settingEl.addEventListener("dragleave", (e) => {
        setting.settingEl._dragEnterCount--;
        if (setting.settingEl._dragEnterCount <= 0) {
          setting.settingEl.classList.remove("FMA-drop-target");
          setting.settingEl._dragEnterCount = 0;
        }
      });
      setting.settingEl.addEventListener("dragover", (e) => this.onDragOver(e, "folder", folder.id));
      setting.settingEl.addEventListener("drop", (e) => this.onDrop(e, "folder", folder.id));
      setting.settingEl.addEventListener("dragleave", (e) => this.onDragLeave(e));
      if (folder.disabled)
        setting.settingEl.classList.add("FMA-mod-FolderList-disabled");
      if (!folder.collapsed) {
        this.renderFolder(folder.id, parentEl, depth + 1);
        this.renderRows(folder.id, parentEl, depth + 1);
      }
    });
  }
  renderRows(folderId, parentEl, depth) {
    if (!this.data || !this.data.rows)
      return;
    const rows = this.data.rows.filter((r) => r.folderId === folderId && this.rowMatchesFilter(r));
    rows.forEach((row) => {
      const setting = new import_obsidian9.Setting(parentEl).setClass("FMA-folder-list-row-setting");
      setting.nameEl.empty();
      setting.settingEl.style.marginLeft = `${depth * 20}px`;
      if (setting.nameEl.parentElement) {
        setting.nameEl.parentElement.style.marginInlineEnd = "0px";
        setting.nameEl.parentElement.style.width = "100%";
        setting.nameEl.parentElement.style.display = "flex";
        setting.nameEl.parentElement.style.flexDirection = "column";
      }
      setting.nameEl.style.display = "flex";
      setting.nameEl.style.width = "100%";
      const dragHandle = setting.nameEl.createSpan({ cls: "FMA-folder-list-drag-handle" });
      dragHandle.setText("\u2261");
      dragHandle.draggable = true;
      dragHandle.style.marginRight = "0.5em";
      dragHandle.addEventListener("dragstart", (e) => this.onDragStart(e, "row", row.id));
      dragHandle.addEventListener("dragover", (e) => this.onDragOver(e, "row", row.id));
      dragHandle.addEventListener("drop", (e) => this.onDrop(e, "row", row.id));
      if (row.disabled)
        setting.settingEl.addClass("FMA-mod-FolderList-disabled");
      this.rowRenderCb(row, setting.nameEl);
      setting.settingEl.addEventListener("dragover", (e) => this.onDragOver(e, "row", row.id));
      setting.settingEl.addEventListener("drop", (e) => this.onDrop(e, "row", row.id));
      setting.settingEl.addEventListener("dragleave", (e) => this.onDragLeave(e));
    });
  }
  // --- Drag & Drop Handlers (simplified, expand as needed) ---
  onDragStart(e, type, id) {
    var _a;
    (_a = e.dataTransfer) == null ? void 0 : _a.setData("text/plain", JSON.stringify({ type, id }));
  }
  onDragOver(e, type, id) {
    var _a;
    e.preventDefault();
    const target = e.currentTarget;
    const data = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (type === "row" && data) {
      const { type: dragType } = JSON.parse(data);
      if (dragType === "folder") {
        return;
      }
    }
    if (type === "folder") {
      target.classList.add("FMA-drop-target");
    }
    if (type === "row") {
      target.classList.add("FMA-drop-target");
    }
  }
  onDragLeave(e) {
    const target = e.currentTarget;
    target.classList.remove("FMA-drop-target");
  }
  onDrop(e, type, targetId) {
    var _a;
    e.preventDefault();
    e.stopPropagation();
    const target = e.currentTarget;
    target.classList.remove("FMA-drop-target");
    const data = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (!data)
      return;
    const { type: dragType, id: dragId } = JSON.parse(data);
    if (dragType === "row") {
      if (type === "folder") {
        this.moveRowToFolder(dragId, targetId);
        return;
      }
      if (type === "row") {
        this.moveRow(dragId, targetId);
        return;
      }
      if (type === "root" && targetId === "row-dropzone") {
        return;
      }
    }
    if (dragType === "folder") {
      if (type === "folder") {
        this.moveFolderToFolder(dragId, targetId);
        return;
      }
      if (type === "root" && targetId === "folder-dropzone") {
        this.moveFolderToFolder(dragId, void 0);
        return;
      }
    }
  }
  rowMatchesFilter(row) {
    if (!this.filter)
      return true;
    return row.keywords.some((k) => k.toLowerCase().includes(this.filter.toLowerCase()));
  }
  getNextFolderName() {
    let i = 1;
    let name;
    do {
      name = `Folder ${i++}`;
    } while (this.data.folders.some((f) => f.name === name));
    return name;
  }
  deleteFolderAndContents(folderId) {
    const subfolders = this.data.folders.filter((f) => f.parentId === folderId);
    subfolders.forEach((f) => this.deleteFolderAndContents(f.id));
    const rowsToDelete = this.data.rows.filter((r) => r.folderId === folderId);
    rowsToDelete.forEach((row) => this.onRowDeletedCb(row));
    this.data.folders = this.data.folders.filter((f) => f.id !== folderId);
    this.data.rows = this.data.rows.filter((r) => r.folderId !== folderId);
  }
};

// src/uiMarkdownHelpModal.ts
var import_obsidian10 = require("obsidian");
var path = __toESM(require("path"));
var MarkdownHelpModal = class extends import_obsidian10.Modal {
  constructor(app, plugin, markdown, sourcePath) {
    super(app);
    this.markdown = "";
    this.sourcePath = "";
    this.app = app;
    this.plugin = plugin;
    this.markdown = markdown;
    this.sourcePath = sourcePath;
  }
  async onOpen() {
    const { contentEl, modalEl } = this;
    modalEl.addClass("FMA-markdown-help-modal--wide");
    try {
      this.markdown = await this.readPluginDocFile(this.sourcePath);
    } catch (error) {
      logger.log(ERROR, "Error loading markdown:", error);
      this.markdown = "Could not load documentation file: " + this.sourcePath;
    }
    contentEl.empty();
    await import_obsidian10.MarkdownRenderer.render(this.app, this.markdown, contentEl, this.sourcePath, this);
    contentEl.addEventListener("click", async (evt) => {
      const target = evt.target;
      if (target.tagName === "A") {
        const href = target.getAttribute("href");
        if (href && href.endsWith(".md") && !href.match(/^https?:\/\//) && !href.startsWith("/")) {
          evt.preventDefault();
          try {
            const currentDir = this.sourcePath ? path.dirname(this.sourcePath) : "";
            const resolvedPath = path.normalize(path.join(currentDir, href)).replace(/\\/g, "/");
            const newMarkdown = await this.readPluginDocFile(resolvedPath);
            this.markdown = newMarkdown;
            this.sourcePath = resolvedPath;
            contentEl.empty();
            await import_obsidian10.MarkdownRenderer.render(this.app, this.markdown, contentEl, this.sourcePath, this);
          } catch (e) {
            contentEl.empty();
            contentEl.createEl("div", { text: "Could not load: " + href });
          }
        }
      }
    });
  }
  async fetchMarkdownFromGitHub(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error("Could not load file from GitHub");
    return await response.text();
  }
  async readPluginDocFile(filename) {
    const pluginId = this.plugin.manifest.id;
    const filePath = path.posix.join(".obsidian", "plugins", pluginId, "doc", filename);
    try {
      return await this.app.vault.adapter.read(filePath);
    } catch (error) {
      const message = error instanceof Error ? error.message : String(error);
      throw new Error(`Failed to read file '${filePath}': ${message}`);
    }
  }
};

// src/settings-properties.ts
var RulesTable = class extends import_obsidian11.PluginSettingTab {
  constructor(app, plugin, container, settings) {
    super(app, plugin);
    this.knownProperties = {};
    this.activeFile = null;
    this.plugin = plugin;
    this.container = container;
    this.settings = settings;
    this.tools = new ScriptingTools(app, plugin);
    this.activeFile = this.app.workspace.getActiveFile();
  }
  // Helper to render one rule
  renderPropertyRow(containerEl, rule) {
    const rowEl = containerEl.createDiv({ cls: "property-setting-row setting-item" });
    rowEl.style.width = "100%";
    rowEl.id = rule.id;
    const controlEl = rowEl.createDiv({ cls: "setting-item-control" });
    controlEl.style.width = "100%";
    controlEl.style.display = "flex";
    controlEl.style.gap = "0px";
    const leftContainer = controlEl.createDiv({ cls: "property-left-container" });
    const iconEl = leftContainer.createSpan({ cls: "property-icon setting-item-icon" });
    (0, import_obsidian11.setIcon)(iconEl, "hash");
    const searchContainer = leftContainer.createDiv({ cls: "property-search-container" });
    const nameInput = new import_obsidian11.TextComponent(searchContainer).setPlaceholder("Select property...").setValue(rule.property || "").onChange(async (value) => {
      this.renderSearchResults(searchContainer, value, rule);
    });
    nameInput.inputEl.style.border = "none";
    nameInput.inputEl.addEventListener("focus", () => {
      this.renderSearchResults(searchContainer, nameInput.getValue(), rule);
    });
    nameInput.inputEl.addEventListener("input", () => {
      this.renderSearchResults(searchContainer, nameInput.getValue(), rule);
    });
    nameInput.inputEl.addEventListener("blur", (event) => {
      setTimeout(() => {
        const relatedTarget = event.relatedTarget;
        const resultsEl = searchContainer.querySelector(".property-search-results");
        if (!resultsEl || !resultsEl.contains(relatedTarget)) {
          this.clearSearchResults(searchContainer);
        }
      }, 100);
    });
    const currentPropertyInfo = this.knownProperties[rule.property];
    if (currentPropertyInfo) {
      updatePropertyIcon(iconEl, currentPropertyInfo.type);
    } else if (rule.property) {
      (0, import_obsidian11.setIcon)(iconEl, "alert-circle");
    }
    const middleContainer = controlEl.createDiv({ cls: "property-middle-container" });
    const valueContainer = middleContainer.createDiv({ cls: "FMA-property-value-container" });
    if (this.activeFile) {
      this.app.fileManager.processFrontMatter(this.activeFile, async (frontmatter) => {
        rule.value = await executeRuleObject("preview", this.app, this, this.plugin.settings, this.activeFile, "", rule, frontmatter);
      }, { "mtime": this.activeFile.stat.mtime });
    }
    const previewComponent = this.renderValueInput(valueContainer, currentPropertyInfo, rule.value, rule);
    this.updatePreview(rule, previewComponent);
    const propertyDevDropdown = new import_obsidian11.DropdownComponent(middleContainer);
    propertyDevDropdown.selectEl.style.minWidth = "35%";
    propertyDevDropdown.selectEl.style.maxWidth = "50%";
    propertyDevDropdown.addOption("", "Select a content");
    rulesManager.getRulesByType("buildIn", rule.type).forEach((rule2) => {
      propertyDevDropdown.addOption(rule2.id, rule2.name);
    });
    propertyDevDropdown.setValue(rule.content);
    propertyDevDropdown.onChange(async (value) => {
      if (value !== "") {
        const ruleFunction = rulesManager.getRuleById(value);
        switch (ruleFunction == null ? void 0 : ruleFunction.ruleType) {
          case "script":
          case "buildIn.inputProperty":
          case "buildIn":
            let oldOriginalCode = rulesManager.getSource(value) || rulesManager.getSource("default") || "";
            if (rule.buildInCode !== "" && rule.buildInCode !== oldOriginalCode) {
              const shouldProceed = await new AlertModal(
                this.app,
                "Overwrite existing code?",
                "I sees like you have custom code for this rule! Should this be overwritten by default code for this parameter?",
                "Yes",
                "No"
              ).openAndGetValue();
              if (shouldProceed.proceed) {
                rule.buildInCode = rulesManager.getSource(value) || rulesManager.getSource("default") || "";
                rule.useCustomCode = false;
              } else {
                rule.buildInCode;
              }
              await this.plugin.saveSettings();
            } else {
              rule.buildInCode = rulesManager.getSource(value) || rulesManager.getSource("default") || "";
              rule.useCustomCode = false;
              await this.plugin.saveSettings();
            }
            await this.plugin.saveSettings();
            break;
          case "automation":
          case "autocomplete.modal":
            break;
          default:
        }
        rule.content = value;
        await this.plugin.saveSettings();
        this.updatePreview(rule, previewComponent);
        this.renderPropertyOptions(optionEL, rule, previewComponent);
      }
    });
    const leftContainerEl = controlEl.createDiv({ cls: "FMA-property-right-container" });
    new import_obsidian11.ButtonComponent(leftContainerEl).setIcon("gear").setTooltip("open settings").setClass("property-icon-button").onClick(async () => {
      let settingsContainers = containerEl.getElementsByClassName("property-options-container");
      for (let container of settingsContainers) {
        if (container.getAttribute("id") !== rule.id)
          container.setAttribute("style", "display: none;");
      }
      this.renderPropertyOptions(optionEL, rule, previewComponent);
      optionEL.style.display = optionEL.style.display === "block" ? "none" : "block";
    });
    controlEl.style.display = "flex";
    controlEl.style.alignItems = "center";
    controlEl.style.justifyContent = "space-between";
    controlEl.style.width = "100%";
    leftContainer.style.display = "flex";
    leftContainer.style.alignItems = "center";
    leftContainer.style.minWidth = "100px";
    iconEl.style.marginRight = "8px";
    searchContainer.style.position = "relative";
    let optionEL;
    if (containerEl.parentElement) {
      optionEL = containerEl.parentElement.createDiv({ cls: "property-options-container" });
      optionEL.id = rule.id;
      optionEL.style.display = "none";
    } else {
      optionEL = containerEl.createDiv({ cls: "property-options-container" });
      optionEL.id = rule.id;
      optionEL.style.display = "none";
    }
  }
  renderPropertyOptions(optionEL, rule, previewComponent) {
    var _a, _b, _c, _d, _e, _f;
    if (!(previewComponent instanceof import_obsidian11.TextComponent))
      return;
    optionEL.empty();
    const ruleFn = rulesManager.getRuleById(rule.content);
    if (!ruleFn)
      return;
    if (ruleFn.useRuleOption("removeContent")) {
      const removeContentButton = new import_obsidian11.Setting(optionEL).setName("Remove content").setDesc(`Before making changes you might consider to remove content generated by this rule`).addButton(
        (button) => {
          button.setWarning().setButtonText("Remove Content").setCta().onClick(() => {
            let count = this.plugin.removeFrontmatterParamsFromAllFiles(rule);
            button.removeCta();
            button.setDisabled(true);
            removeContentButton.setDesc(`Removed this rule from ${count.files} files.`);
          });
        }
      );
    }
    if (ruleFn.useRuleOption("ruleActive")) {
      new import_obsidian11.Setting(optionEL).setName("Rule active").setDesc("If enabled, the rule will be executed").addToggle(
        (toggle) => toggle.setValue(rule.active).onChange(async (value) => {
          rule.active = value;
          await this.plugin.saveSettings();
        })
      );
    }
    if (ruleFn.useRuleOption("modifyOnly")) {
      new import_obsidian11.Setting(optionEL).setName("Modify only").setDesc("Only modify existing properties").addToggle((toggle) => toggle.setValue(rule.onlyModify).onChange(async (value) => {
        rule.onlyModify = value;
        await this.plugin.saveSettings();
        this.updatePreview(rule, previewComponent);
      }));
    }
    if (rule.type === "text" || rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
      let formatRule = rulesManager.getRuleById(rule.formatter);
      const formatterRules = rulesManager.getRulesByType("formatter") || [];
      let formatOptionsButton;
      if (ruleFn.useRuleOption("convertToLowerCase")) {
        const multiProp = new MultiPropertySetting(optionEL).setName("Format output").setDesc("Format output using selected options.").setOptions(formatterRules).setValue(rule.formatters || ["toOriginal"]).onChange((formatter) => {
          rule.formatters = formatter;
          formatRule = rulesManager.getRuleById(rule.formatter);
          this.updatePreview(rule, previewComponent);
        });
        multiProp.addExtraButton((setting, idx) => {
          setting.addExtraButton((btn) => {
            var _a2, _b2, _c2, _d2, _e2, _f2;
            btn.setIcon("gear").setTooltip("Options").setDisabled(!((_c2 = rulesManager.getRuleById((_b2 = (_a2 = rule == null ? void 0 : rule.formatters) == null ? void 0 : _a2[idx]) != null ? _b2 : "toOriginal")) == null ? void 0 : _c2.hasOwnConfigTab()) || false).onClick(() => {
              var _a3, _b3;
              converterOptionDiv.style.display = "block";
              converterOptionDiv.empty();
              formatRule = rulesManager.getRuleById((_b3 = (_a3 = rule == null ? void 0 : rule.formatters) == null ? void 0 : _a3[idx]) != null ? _b3 : "toOriginal");
              formatRule == null ? void 0 : formatRule.configTab(converterOptionDiv, rule, this, previewComponent);
            });
            multiProp.styleDisabled(btn, !((_f2 = rulesManager.getRuleById((_e2 = (_d2 = rule == null ? void 0 : rule.formatters) == null ? void 0 : _d2[idx]) != null ? _e2 : "toOriginal")) == null ? void 0 : _f2.hasOwnConfigTab()) || false);
          });
        });
      }
      let converterOptionDiv = optionEL.createDiv({ cls: "property-converter-option" });
      converterOptionDiv.style.display = "none";
      converterOptionDiv.style.marginLeft = "20px";
      if (ruleFn.useRuleOption("resultAsLink")) {
        new import_obsidian11.Setting(optionEL).setName("Result as Link").setDesc("Format Result as Link").addDropdown((dropdown) => {
          rulesManager.getRulesByType("linkFormatter").forEach((rule2) => {
            dropdown.addOption(rule2.id, rule2.name);
          });
          dropdown.setValue(rule.linkFormatter || "toOriginalLink");
          dropdown.onChange(async (value) => {
            rule.linkFormatter = value;
            await this.plugin.saveSettings();
            this.updatePreview(rule, previewComponent);
          });
        });
      }
    }
    if (rule.type === "text" || rule.type === "multitext" || rule.type === "tags" || rule.type === "aliases") {
      if (ruleFn.useRuleOption("addContent")) {
        new import_obsidian11.Setting(optionEL).setName("Add content").setDesc("select how the content should be stored").addDropdown(
          (dropdown) => dropdown.addOption("overwrite", "replace content").addOption("start", "place on start").addOption("end", "place on end").setValue(rule.addContent).onChange(async (value) => {
            if (value !== "") {
              rule.addContent = value === "overwrite" ? "overwrite" : value === "start" ? "start" : "end";
              await this.plugin.saveSettings();
              this.updatePreview(rule, previewComponent);
            }
          })
        );
      }
    }
    if (ruleFn.useRuleOption("excludeFolders")) {
      const excludeEL = new import_obsidian11.Setting(optionEL).setName("Exclude Files and Folders from this rule").setDesc(`Currently ${((_a = rule.exclude) == null ? void 0 : _a.selectedFolders.length) || 0} folders and ${((_b = rule.exclude) == null ? void 0 : _b.selectedFiles.length) || 0} files will be ${((_c = rule.exclude) == null ? void 0 : _c.mode) || "exclude"}d.`).addButton((button) => {
        button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
          var _a2, _b2, _c2;
          openDirectorySelectionModal(
            this.app,
            ((_a2 = rule.exclude) == null ? void 0 : _a2.selectedFolders) || [],
            ((_b2 = rule.exclude) == null ? void 0 : _b2.selectedFiles) || [],
            {
              selectionMode: "exclude",
              displayMode: ((_c2 = rule.exclude) == null ? void 0 : _c2.display) || "folders",
              optionSelectionMode: false,
              optionShowFiles: true
            },
            (result) => {
              var _a3, _b3, _c3;
              if (!result)
                return;
              if (!rule.exclude) {
                rule.exclude = Object.assign({}, DEFAULT_FILTER_FILES_AND_FOLDERS, {
                  mode: "exclude"
                });
              }
              ;
              rule.exclude.selectedFolders = result.folders;
              rule.exclude.selectedFiles = result.files;
              rule.exclude.mode = "exclude";
              rule.exclude.display = result.display;
              this.plugin.saveSettings();
              logger.log(DEBUG, rule.exclude);
              this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
              excludeEL.setDesc(`Currently ${((_a3 = rule.exclude) == null ? void 0 : _a3.selectedFolders.length) || 0} folders and ${((_b3 = rule.exclude) == null ? void 0 : _b3.selectedFiles.length) || 0} files will be ${((_c3 = rule.exclude) == null ? void 0 : _c3.mode) || "exclude"}d.`);
            }
          );
        });
      });
    }
    if (ruleFn.useRuleOption("includeFolders")) {
      const includeEL = new import_obsidian11.Setting(optionEL).setName("Include Files and Folders for this rule ").setDesc(`Currently ${((_d = rule.include) == null ? void 0 : _d.selectedFolders.length) || 0} folders and ${((_e = rule.include) == null ? void 0 : _e.selectedFiles.length) || 0} files will be ${((_f = rule.include) == null ? void 0 : _f.mode) || "include"}d even if they are excluded globally.`).addButton((button) => {
        button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
          var _a2, _b2, _c2;
          openDirectorySelectionModal(
            this.app,
            ((_a2 = rule.include) == null ? void 0 : _a2.selectedFolders) || [],
            ((_b2 = rule.include) == null ? void 0 : _b2.selectedFiles) || [],
            {
              selectionMode: "include",
              displayMode: ((_c2 = rule.include) == null ? void 0 : _c2.display) || "folders",
              optionSelectionMode: false,
              optionShowFiles: true
            },
            (result) => {
              var _a3, _b3, _c3;
              if (!result)
                return;
              if (!rule.include) {
                rule.include = Object.assign({}, DEFAULT_FILTER_FILES_AND_FOLDERS, {
                  mode: "include"
                });
              }
              ;
              rule.include.selectedFolders = result.folders;
              rule.include.selectedFiles = result.files;
              rule.include.mode = "include";
              rule.include.display = result.display;
              this.plugin.saveSettings();
              logger.log(DEBUG, rule.include);
              this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
              includeEL.setDesc(`Currently ${((_a3 = rule.include) == null ? void 0 : _a3.selectedFolders.length) || 0} folders and ${((_b3 = rule.include) == null ? void 0 : _b3.selectedFiles.length) || 0} files will be ${((_c3 = rule.include) == null ? void 0 : _c3.mode) || "include"}d.`);
            }
          );
        });
      });
    }
    if (ruleFn.useRuleOption("script")) {
      new import_obsidian11.Setting(optionEL).setName("Script").setDesc("edit the script for own modifications").addButton((button) => {
        button.setButtonText("JS Editor").onClick(() => {
          var _a2, _b2, _c2;
          logger.log(
            DEBUG,
            `Opening code editor for rule ${rule.id} with content ${rule.content}, file: ${(_a2 = this.activeFile) == null ? void 0 : _a2.path}`,
            this.activeFile,
            this.activeFile ? this.app.metadataCache.getFileCache(this.activeFile) || {} : {}
          );
          openCodeEditorModal(
            this.app,
            this.plugin,
            rule.buildInCode,
            ((_b2 = rule.typeProperty) == null ? void 0 : _b2.type) || "text",
            this.activeFile,
            this.activeFile ? ((_c2 = this.app.metadataCache.getFileCache(this.activeFile)) == null ? void 0 : _c2.frontmatter) || {} : {},
            (result) => {
              if (!result)
                return;
              rule.buildInCode = result.code;
              rule.useCustomCode = true;
              button.setCta();
              this.plugin.saveSettings();
              this.updatePreview(rule, previewComponent);
            }
          );
        });
        if (rule.useCustomCode) {
          button.setCta();
        } else {
          button.removeCta();
        }
      });
    }
    let ruleOptionDiv = optionEL.createDiv({ cls: "property-rule-option" });
    ruleOptionDiv.style.marginLeft = "20px";
    rulesManager.buildConfigTab(rule.content, ruleOptionDiv, rule, this, previewComponent);
    this.updatePreview(rule, previewComponent);
  }
  /**
   * Retrieves the configuration option for a specific rule and property.
   *
   * @param ruleId - The unique identifier of the rule.
   * @param propertyId - The specific property for which the configuration is being retrieved.
   * @returns The configuration value for the specified property, or undefined if not found.
   */
  getOptionConfig(ruleId, propertyId) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      const optionConfig = rule.optionsConfig[ruleId];
      if (optionConfig[propertyId]) {
        return optionConfig[propertyId];
      }
    }
    return void 0;
  }
  /**
   * Sets the configuration option for a specific rule and property.
   *
   * @param ruleId - The unique identifier of the rule.
   * @param propertyId - The specific property for which the configuration is being set.
   * @param config - The configuration value to be set.
   */
  setOptionConfig(ruleId, propertyId, config) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      if (!rule.optionsConfig)
        rule.optionsConfig = {};
      if (!rule.optionsConfig[ruleId])
        rule.optionsConfig[ruleId] = {};
      rule.optionsConfig[ruleId][propertyId] = config;
      this.plugin.saveSettings();
    }
  }
  hasOptionConfig(ruleId) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      if (!rule.optionsConfig)
        rule.optionsConfig = {};
      if (!rule.optionsConfig[ruleId])
        rule.optionsConfig[ruleId] = {};
      return Object.keys(rule.optionsConfig[ruleId]).length > 0;
    }
    return false;
  }
  setOptionConfigDefaults(ruleId, defaults) {
    const rule = this.plugin.settings.rules.find((rule2) => rule2.id === ruleId);
    if (rule) {
      if (!rule.optionsConfig)
        rule.optionsConfig = {};
      rule.optionsConfig[ruleId] = Object.assign({}, defaults, rule.optionsConfig[ruleId] || {});
    }
    return rule.optionsConfig[ruleId];
  }
  renderSearchResults(searchContainerEl, searchTerm, payload) {
    this.clearSearchResults(searchContainerEl);
    const filteredProperties = Object.entries(this.knownProperties).filter(([name]) => name.toLowerCase().includes(searchTerm.toLowerCase()));
    if (filteredProperties.length === 0 && searchTerm) {
      return;
    }
    if (filteredProperties.length === 0 && !searchTerm) {
      return;
    }
    const resultsEl = searchContainerEl.createDiv({ cls: "property-search-results menu" });
    resultsEl.style.position = "absolute";
    resultsEl.style.top = "100%";
    resultsEl.style.left = "0";
    resultsEl.style.width = "calc(100% + 100px)";
    resultsEl.style.zIndex = "10";
    resultsEl.style.maxHeight = "200px";
    resultsEl.style.overflowY = "auto";
    let activeIndex = -1;
    const updateActiveItem = (newIndex) => {
      const items = resultsEl.querySelectorAll(".menu-item");
      items.forEach((item, index) => {
        if (index === newIndex) {
          item.addClass("property-search-is-active");
          item.scrollIntoView({ block: "nearest" });
        } else {
          item.removeClass("property-search-is-active");
        }
      });
      activeIndex = newIndex;
    };
    const selectActiveItem = async () => {
      if (activeIndex >= 0 && activeIndex < filteredProperties.length) {
        const [name, info] = filteredProperties[activeIndex];
        payload.property = name;
        payload.type = info.type;
        payload.value = void 0;
        await this.plugin.saveSettings();
        this.clearSearchResults(searchContainerEl);
        this.display();
      }
    };
    filteredProperties.forEach(([name, info], index) => {
      const itemEl = resultsEl.createDiv({ cls: "menu-item" });
      const itemIcon = itemEl.createSpan({ cls: "menu-item-icon" });
      updatePropertyIcon(itemIcon, info.type);
      itemEl.createSpan({ text: name });
      itemEl.addEventListener("mousedown", async (e) => {
        e.preventDefault();
        activeIndex = index;
        await selectActiveItem();
      });
    });
    searchContainerEl.addEventListener("keydown", async (e) => {
      const items = resultsEl.querySelectorAll(".menu-item");
      if (e.key === "ArrowDown") {
        e.preventDefault();
        updateActiveItem((activeIndex + 1) % items.length);
      } else if (e.key === "ArrowUp") {
        e.preventDefault();
        updateActiveItem((activeIndex - 1 + items.length) % items.length);
      } else if (e.key === "Enter") {
        e.preventDefault();
        await selectActiveItem();
      }
    });
  }
  clearSearchResults(searchContainerEl) {
    const resultsEl = searchContainerEl.querySelector(".property-search-results");
    if (resultsEl) {
      resultsEl.remove();
    }
  }
  renderValueInput(containerEl, propertyInfo, currentValue, payload) {
    let returnComponent;
    if (!propertyInfo) {
      containerEl.setText("");
      containerEl.addClass("text-muted");
      return;
    }
    const type = propertyInfo.type;
    switch (type) {
      case "number":
        returnComponent = new import_obsidian11.TextComponent(containerEl).setPlaceholder("Numeric Value").setValue(currentValue !== void 0 && currentValue !== null ? String(currentValue) : "").onChange(async (value) => {
          const numValue = value === "" ? void 0 : parseFloat(value);
          payload.value = isNaN(numValue) ? void 0 : numValue;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "number";
        break;
      case "checkbox":
        returnComponent = containerEl.createDiv({ cls: "FMA-tri-state-checkbox" });
        returnComponent.setAttribute("aria-label", "Checkbox change state");
        returnComponent.setAttribute("role", "checkbox");
        const updateCheckboxVisual = (state) => {
          let iconName;
          let ariaState;
          if (state === true) {
            iconName = "check-square";
            ariaState = "true";
          } else if (state === false) {
            iconName = "square";
            ariaState = "false";
          } else {
            iconName = "minus-square";
            ariaState = "mixed";
          }
          (0, import_obsidian11.setIcon)(returnComponent, iconName);
          returnComponent.setAttribute("aria-checked", ariaState);
          returnComponent.dataset.state = String(state);
        };
        updateCheckboxVisual(currentValue);
        returnComponent.addEventListener("click", async () => {
          let currentState = returnComponent.dataset.state;
          let nextState;
          if (currentState === "false") {
            nextState = true;
          } else if (currentState === "true") {
            nextState = void 0;
          } else {
            nextState = false;
          }
          payload.value = nextState;
          await this.plugin.saveSettings();
          updateCheckboxVisual(nextState);
        });
        break;
      case "date":
        returnComponent = new import_obsidian11.TextComponent(containerEl).setPlaceholder("YYYY-MM-DD").setValue(currentValue || "").onChange(async (value) => {
          payload.value = value || void 0;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "date";
        break;
      case "datetime":
        returnComponent = new import_obsidian11.TextComponent(containerEl).setPlaceholder("YYYY-MM-DDTHH:mm").setValue(currentValue || "").onChange(async (value) => {
          payload.value = value || void 0;
          await this.plugin.saveSettings();
        });
        returnComponent.inputEl.type = "datetime-local";
        break;
      case "aliases":
      case "tags":
      case "multitext":
        returnComponent = new import_obsidian11.TextComponent(containerEl).setPlaceholder("values (divided by comma)").setValue(Array.isArray(currentValue) ? currentValue.join(", ") : currentValue || "").onChange(async (value) => {
          const arrayValue = value.split(",").map((s) => s.trim()).filter((s) => s);
          payload.value = arrayValue.length > 0 ? arrayValue : void 0;
          await this.plugin.saveSettings();
        });
        break;
      case "text":
      default:
        returnComponent = new import_obsidian11.TextComponent(containerEl).setPlaceholder("value").setValue(currentValue || "").onChange(async (value) => {
          payload.value = value || void 0;
          await this.plugin.saveSettings();
        });
        break;
    }
    if (type !== "checkbox") {
      returnComponent.inputEl.addClass("FMA-property-value-input");
    } else {
      returnComponent.addClass("FMA-property-value-input");
    }
    return returnComponent;
  }
  async updatePreview(rule, previewComponent) {
    if (this.activeFile) {
      let ruleResult;
      await this.app.fileManager.processFrontMatter(this.activeFile, async (frontmatter) => {
        ruleResult = await executeRuleObject("preview", this.app, this, this.plugin.settings, this.activeFile, "", rule, frontmatter);
      }, { "mtime": this.activeFile.stat.mtime });
      switch (typeof ruleResult) {
        case "object":
          if (Array.isArray(ruleResult))
            previewComponent.inputEl.value = ruleResult.toString();
          break;
        default:
          if (previewComponent == null ? void 0 : previewComponent.inputEl)
            previewComponent.inputEl.value = ruleResult;
          break;
      }
    }
  }
  async display() {
    const containerEl = this.container;
    containerEl.empty();
    this.knownProperties = await this.tools.fetchKnownProperties(this.app);
    this.propertiesListEl = containerEl;
    const folderList = new TreeHierarchySortableSettings(
      containerEl,
      this.plugin.settings.folderConfig,
      (row, rowEl) => {
        this.renderPropertyRow(rowEl, row.payload);
      }
    ).setTitle("Rules").setDescription("add rules to selected frontmatter properties").onChange((data) => {
      this.plugin.settings.folderConfig = data;
      this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
      this.plugin.saveSettings();
    }).onRendered(() => {
      this.updateFilterIndicator(this.activeFile, this.propertiesListEl);
    }).onRowCreated(async (row) => {
      const defaultName = "";
      row.payload = Object.assign({}, DEFAULT_RULE_DEFINITION, {
        id: (0, import_crypto.randomUUID)().toString()
      });
      await this.plugin.saveSettings();
    }).onDeleteBt(async () => {
      const shouldProceed = await new AlertModal(
        this.app,
        "Erase all Rules?",
        "Do you really like to erase ALL rules?",
        "Yes",
        "No"
      ).openAndGetValue();
      if (shouldProceed.proceed) {
        this.plugin.folderConfig.rows = [];
        this.plugin.saveSettings();
      }
    }).addExtraButtonToHeader((el) => {
      el.addExtraButton(
        (btn) => btn.setIcon("circle-help").onClick(async () => {
          let markdown = "Could not load help from GitHub.";
          new MarkdownHelpModal(this.app, this.plugin, markdown, "README.md").open();
        })
      );
    });
    if (this.plugin.settings.folderConfig.rows.length === 0 && this.plugin.settings.rules.length > 0) {
      this.plugin.settings.rules.forEach((rule) => {
        const keywords = [];
        keywords.push(rule.content);
        folderList.addRow(ROOT_FOLDER, [], rule);
      });
    }
    let activeFile = this.app.workspace.getActiveFile();
    this.updateFilterIndicator(activeFile, this.propertiesListEl);
  }
  updateFilterIndicator(activeFile, propertiesListEl) {
    if (activeFile) {
      this.plugin.settings.folderConfig.rows.forEach((row, index) => {
        const rule = row.payload;
        const propertyRowElements = propertiesListEl.getElementsByClassName("property-setting-row");
        const propertyRowEl = Array.from(propertyRowElements).filter((el) => el.id === rule.id)[0];
        if (!propertyRowEl) {
          return;
        }
        const propertyLeftDiv = propertyRowEl.querySelector(".property-left-container");
        if (checkIfFileAllowed(activeFile, this.plugin.settings, rule)) {
          propertyLeftDiv == null ? void 0 : propertyLeftDiv.addClass("property-left-container-allowed");
        } else {
          propertyLeftDiv == null ? void 0 : propertyLeftDiv.removeClass("property-left-container-allowed");
        }
      });
    }
  }
};

// src/settings.ts
var FolderTagSettingTab = class extends import_obsidian12.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.scriptingTools = new ScriptingTools(app, plugin);
  }
  hide() {
    this.plugin.settings.liveRules = [];
    this.plugin.settings.rules.forEach((rule) => {
      let ruleFunction = rulesManager.getRuleById(rule.content);
      if (!ruleFunction)
        return;
      if (ruleFunction.isLiveRule) {
        this.plugin.settings.liveRules.push(rule);
      }
    });
    this.plugin.saveSettings();
    const activeFile = this.app.workspace.getActiveFile();
    if (activeFile && activeFile.extension === "md") {
      this.plugin.updateFrontmatterParameters("active-leaf-change", activeFile, this.plugin.settings.folderConfig);
    }
  }
  display() {
    this.knownProperties = getPropertiesFromMetadataManager(this.app);
    this.knownTypes = getTypesFromMetadataManager(this.app);
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian12.Setting(containerEl).setName(`Front matter automate V${versionString}`).setDesc(`This plugin automates the management of front matter in your Obsidian notes. It allows you to set rules for automatically adding, modifying, or removing front matter properties based on various events like file creation, renaming, or active leaf changes.`).addButton(
      (button) => button.setIcon("circle-help").setTooltip("Online Help").onClick(async () => {
        let markdown = "Could not load help from GitHub.";
        new MarkdownHelpModal(this.app, this.plugin, markdown, "readme.md").open();
      })
    );
    new import_obsidian12.Setting(containerEl).setName("Exclude Files and Folders globally").setDesc(`Currently ${this.plugin.settings.exclude.selectedFolders.length} folders and ${this.plugin.settings.exclude.selectedFiles.length} files will be ${this.plugin.settings.exclude.mode}d.`).addButton((button) => {
      button.setIcon("folder-x").setButtonText("Exclude").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.exclude.selectedFolders || [],
          this.plugin.settings.exclude.selectedFiles || [],
          {
            selectionMode: this.plugin.settings.exclude.mode || "exclude",
            displayMode: this.plugin.settings.exclude.display || "folders",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            this.plugin.settings.exclude.selectedFolders = result.folders;
            this.plugin.settings.exclude.selectedFiles = result.files;
            this.plugin.settings.exclude.mode = result.mode;
            this.plugin.settings.exclude.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian12.Setting(containerEl).setName("Include Files and Folders globally").setDesc(`Currently ${this.plugin.settings.include.selectedFolders.length} folders and ${this.plugin.settings.include.selectedFiles.length} files will be ${this.plugin.settings.include.mode}d even if they are excluded.`).addButton((button) => {
      button.setIcon("folder-check").setButtonText("Include").setCta().onClick(() => {
        openDirectorySelectionModal(
          this.app,
          this.plugin.settings.include.selectedFolders || [],
          this.plugin.settings.include.selectedFiles || [],
          {
            selectionMode: this.plugin.settings.include.mode || "include",
            displayMode: this.plugin.settings.include.display || "folders",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            this.plugin.settings.include.selectedFolders = result.folders;
            this.plugin.settings.include.selectedFiles = result.files;
            this.plugin.settings.include.mode = result.mode;
            this.plugin.settings.include.display = result.display;
            this.plugin.saveSettings();
            this.display();
          }
        );
      });
    });
    new import_obsidian12.Setting(containerEl).setName("Debug").setDesc("Select the debug level to show in the console").addDropdown((dropdown) => {
      dropdown.addOptions(
        Object.fromEntries(logger.getLevelNames().map((level) => [level, level]))
      );
      dropdown.setValue(logger.getLevelName(this.plugin.settings.debugLevel));
      dropdown.onChange((value) => {
        this.plugin.settings.debugLevel = logger.getLevelByName(value);
        logger.setLevel(this.plugin.settings.debugLevel);
        this.plugin.saveSettings();
      });
    });
    new import_obsidian12.Setting(containerEl).setName("Delay create event (until better solution is found)").setDesc("Set a delay before triggering the create event to allow for file creation to complete. (in milliseconds)").addText((text) => {
      text.setValue(this.plugin.settings.delayCreateEvent.toString());
      text.onChange(async (value) => {
        this.plugin.settings.delayCreateEvent = parseInt(value) || 0;
        await this.plugin.saveSettings();
      });
    });
    this.rulesContainer = containerEl.createDiv("properties-list");
    const rulesTable = new RulesTable(this.app, this.plugin, this.rulesContainer, this.plugin.settings.folderConfig);
    rulesTable.display();
    new import_obsidian12.Setting(containerEl).setName("Backup & Restore Configuration").setDesc("Export your current config as a JSON file or restore from a backup.").addButton((btn) => {
      btn.setButtonText("Backup").setIcon("download").onClick(() => {
        const dataStr = JSON.stringify(this.plugin.settings, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "frontmatter-automate-backup.json";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });
    }).addButton((btn) => {
      btn.setButtonText("Restore").setIcon("upload").onClick(() => {
        const input = document.createElement("input");
        input.type = "file";
        input.accept = ".json,application/json";
        input.onchange = async () => {
          if (!input.files || input.files.length === 0)
            return;
          const file = input.files[0];
          const text = await file.text();
          try {
            const data = JSON.parse(text);
            this.plugin.settings = data;
            await this.plugin.saveSettings();
            this.display();
            new import_obsidian12.Notice("Frontmatter Automate\nConfiguration restored from backup.");
          } catch (e) {
            new import_obsidian12.Notice("Frontmatter Automate\nFailed to restore: Invalid JSON file.", 2e3);
          }
        };
        input.click();
      });
    });
  }
};

// src/rules/addPrefix.ts
var import_obsidian13 = require("obsidian");
var RuleAddPrefix = class extends RulePrototype {
  constructor() {
    super();
    this.id = "addPrefix";
    this.name = "Add a Prefix";
    this.description = "Adds a prefix to the input value.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    var _a;
    const prefix = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "prefix");
    return `${prefix}${input}`;
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      prefix: ""
      // Default prefix
    });
    new import_obsidian13.Setting(optionEL).setName("Prefix").setDesc("Enter a prefix to be added at the beginning.").addText(
      (text) => text.setPlaceholder('e.g. "pre-"').setValue(that.getOptionConfig(rule.id, "prefix") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "prefix", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/addSuffix.ts
var import_obsidian14 = require("obsidian");
var RuleAddSuffix = class extends RulePrototype {
  constructor() {
    super();
    this.id = "addSuffix";
    this.name = "Add a Suffix";
    this.description = "Adds a suffix to the input value.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    var _a;
    const suffix = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "suffix");
    return `${input}${suffix}`;
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      suffix: ""
      // Default suffix
    });
    new import_obsidian14.Setting(optionEL).setName("Suffix").setDesc("Enter a suffix to be added at the end.").addText(
      (text) => text.setPlaceholder('e.g. "_done"').setValue(that.getOptionConfig(rule.id, "suffix") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "suffix", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/automationAutoLink.ts
var import_obsidian18 = require("obsidian");

// src/suggesters/FolderSuggester.ts
var import_obsidian16 = require("obsidian");

// src/suggesters/suggest.ts
var import_obsidian15 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/utils/userAgent.js
function getUAString() {
  var uaData = navigator.userAgentData;
  if (uaData != null && uaData.brands && Array.isArray(uaData.brands)) {
    return uaData.brands.map(function(item) {
      return item.brand + "/" + item.version;
    }).join(" ");
  }
  return navigator.userAgent;
}

// node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js
function isLayoutViewport() {
  return !/^((?!chrome|android).)*safari/i.test(getUAString());
}

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale, isFixedStrategy) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  if (isFixedStrategy === void 0) {
    isFixedStrategy = false;
  }
  var clientRect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (includeScale && isHTMLElement(element)) {
    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;
    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;
  }
  var _ref = isElement(element) ? getWindow(element) : window, visualViewport = _ref.visualViewport;
  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;
  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;
  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;
  var width = clientRect.width / scaleX;
  var height = clientRect.height / scaleY;
  return {
    width,
    height,
    top: y,
    right: x + width,
    bottom: y + height,
    left: x,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : (
    // $FlowFixMe[prop-missing]
    element.document
  )) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return (
    // this is a quicker (but less type safe) way to save quite some bytes from the bundle
    // $FlowFixMe[incompatible-return]
    // $FlowFixMe[prop-missing]
    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node
    element.parentNode || // DOM Element detected
    (isShadowRoot(element) ? element.host : null) || // ShadowRoot detected
    // $FlowFixMe[incompatible-call]: HTMLElement is a Node
    getDocumentElement(element)
  );
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837
  getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = /firefox/i.test(getUAString());
  var isIE = /Trident/i.test(getUAString());
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref, win) {
  var x = _ref.x, y = _ref.y;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : (
        // $FlowFixMe[prop-missing]
        offsetParent[heightProp]
      );
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : (
        // $FlowFixMe[prop-missing]
        offsetParent[widthProp]
      );
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }, getWindow(popper2)) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element, strategy) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    var layoutViewport = isLayoutViewport();
    if (layoutViewport || !layoutViewport && strategy === "fixed") {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : (
    // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here
    updatedList.concat(listScrollParents(getParentNode(target)))
  );
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element, strategy) {
  var rect = getBoundingClientRect(element, false, strategy === "fixed");
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent, strategy) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary, strategy) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent, strategy);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent, strategy));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$strategy = _options.strategy, strategy = _options$strategy === void 0 ? state.strategy : _options$strategy, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || // https://github.com/popperjs/popper-core/issues/1078
    isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        runModifierEffects();
        return instance.update();
      },
      // Sync update – it will always be executed, even if not necessary. This
      // is useful for low frequency updates where sync behavior simplifies the
      // logic.
      // For high frequency updates (e.g. `resize` and `scroll` events), always
      // prefer the async Popper#update method
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      // Async and optimistically optimized update – it will not be executed if
      // not necessary (debounced to run at most once-per-tick)
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref) {
        var name = _ref.name, _ref$options = _ref.options, options2 = _ref$options === void 0 ? {} : _ref$options, effect4 = _ref.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggesters/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on(
      "click",
      ".suggestion-item",
      this.onSuggestionClick.bind(this)
    );
    containerEl.on(
      "mousemove",
      ".suggestion-item",
      this.onSuggestionMouseover.bind(this)
    );
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(
      selectedIndex,
      this.suggestions.length
    );
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(app, inputEl) {
    this.app = app;
    this.inputEl = inputEl;
    this.scope = new import_obsidian15.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on(
      "mousedown",
      ".suggestion-container",
      (event) => {
        event.preventDefault();
      }
    );
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(this.app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    this.app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    this.app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/suggesters/FolderSuggester.ts
var FolderSuggest = class extends TextInputSuggest {
  constructor(app, inputEl) {
    super(app, inputEl);
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian16.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders.slice(0, 1e3);
  }
  renderSuggestion(file, el) {
    el.setText(file.path.replace(/^(?!\/)/, "/"));
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path.replace(/^(?!\/)/, "/");
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/suggesters/FileSuggester.ts
var import_obsidian17 = require("obsidian");
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder) {
    super(plugin.app, inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
  }
  get_error_msg() {
    return `Folder ${this.folder} doesn't exist`;
  }
  getSuggestions(input_str) {
    const all_files = errorWrapperSync(
      () => getFilesFromFolder(
        this.plugin.app,
        this.folder
      ),
      this.get_error_msg()
    );
    if (!all_files) {
      return [];
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian17.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files.slice(0, 1e3);
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/rules/automationAutoLink.ts
var RuleAutomationAutoLink = class extends RulePrototype {
  constructor() {
    super();
    this.id = "autoLink";
    this.name = "Auto Link (advanced)";
    this.description = "Checks if a link exists in a specified folder. If not, it creates a new file based on a specified template and adds a link to it.";
    this.ruleType = "automation";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "multitext"];
    this.configElements = this.defaultConfigElements({ removeContent: false, inputProperty: false, addPrefix: false, spaceReplacement: false, specialCharacterReplacement: false, convertToLowerCase: false, resultAsLink: false, script: false });
  }
  /**
   * Function to create a link to a file. If the file does not exist, it creates a new file based on a template.
   * @param app - The Obsidian app instance.
   * @param file - The current file.
   * @param tools - The scripting tools instance.
   * @returns The new content for the frontmatter property.
   */
  async fx(app, file, tools) {
    const currentContent = tools.getCurrentContent();
    let newContent = new Array();
    const rule = tools.getRule();
    if (!rule) {
      logger.log(ERROR, `autoLink: rule not found, returning current content ${currentContent}`);
      return currentContent;
    }
    const options = tools.getOptionConfig(rule.id);
    const filesToCheck = tools.getFilesInVault(options.destinationFolder);
    let links = currentContent || [];
    if (typeof links === "object" && !Array.isArray(links)) {
      links = [];
    } else if (typeof links === "string") {
      links = [links];
    }
    for (const part of links) {
      let link = tools.extractLinkParts(part);
      let linkFile = tools.getTFileFromPath(link.path, filesToCheck);
      if (!linkFile) {
        if (options.askConfirmation) {
          const result = await new AlertModal(app, "Create new file", `File ${link.path} does not exist. Do you want to create it?`, "Create", "Cancel", "Don't ask again.").openAndGetValue();
          if (!result.proceed)
            return;
          options.askConfirmation = !result.data.askConfirmation;
        }
        link.path = options.destinationFolder + "/" + link.title + ".md";
        linkFile = await tools.createFileFromPath(link.path, options.addTemplate ? options.templateFile : void 0);
        tools.updateFrontmatter(rule.property, [`[[${tools.removeLeadingSlash(link.path)}|${link.title}]]`], linkFile);
      } else {
      }
      if (linkFile) {
        link.path = linkFile.path;
        newContent.push(`[[${tools.removeLeadingSlash(link.path)}|${link.title}]]`);
      }
    }
    tools.updateFrontmatter(rule.property, newContent);
    return newContent;
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      addTemplate: true,
      askConfirmation: true,
      destinationFolder: "/",
      templateFile: ""
    });
    new import_obsidian18.Setting(optionEL).setName("Add template to new files").setDesc("Automatically add template to new files").addToggle((toggle) => toggle.setValue(that.getOptionConfig(rule.id, "addTemplate") || false).onChange(async (value) => {
      that.setOptionConfig(rule.id, "addTemplate", value);
    }));
    new import_obsidian18.Setting(optionEL).setName("Ask for confirmation").setDesc("Ask for confirmation before creating new files").addToggle((toggle) => toggle.setValue(that.getOptionConfig(rule.id, "askConfirmation") || false).onChange(async (value) => {
      that.setOptionConfig(rule.id, "askConfirmation", value);
    }));
    let destinationFolderEl;
    new import_obsidian18.Setting(optionEL).setName("Destination Folder").setDesc("Folder to place new files").addSearch((cb) => {
      destinationFolderEl = cb;
      new FolderSuggest(that.app, cb.inputEl);
      cb.setPlaceholder("enter folder or browse ...").setValue(that.getOptionConfig(rule.id, "destinationFolder") || "").onChange((newFolder) => {
        newFolder = newFolder.trim();
        newFolder = newFolder.replace(/\/$/, "");
        that.setOptionConfig(rule.id, "destinationFolder", newFolder);
      });
      cb.containerEl.addClass("frontmatter-automate-search");
    }).addExtraButton(
      (button) => button.setIcon("folder-tree").setTooltip("Select template folder").onClick(async () => {
        openDirectorySelectionModal(
          that.app,
          [that.getOptionConfig(rule.id, "destinationFolder")],
          [],
          {
            title: "Select folder to place new files",
            selectionMode: "include",
            displayMode: "folder",
            optionSelectionMode: false,
            optionShowFiles: false
          },
          (result) => {
            if (!result)
              return;
            if (result.folders.length === 0 || !result.folders[0] || typeof result.folders[0] !== "string")
              return;
            let selectedFolder = result.folders[0].trim().replace(/\/$/, "");
            if (selectedFolder === "")
              selectedFolder = "/";
            if (!selectedFolder)
              return;
            destinationFolderEl.setValue(selectedFolder);
            that.setOptionConfig(rule.id, "destinationFolder", selectedFolder);
          }
        );
      })
    );
    let destinationFileEl;
    new import_obsidian18.Setting(optionEL).setName("Template File").setDesc("Select a template file to add to new files").addSearch((cb) => {
      destinationFileEl = cb;
      new FileSuggest(cb.inputEl, that.plugin, "");
      cb.setPlaceholder("enter folder or browse ...").setValue(that.getOptionConfig(rule.id, "templateFile") || "").onChange((newFile) => {
        newFile = newFile.trim();
        newFile = newFile.replace(/\/$/, "");
        that.setOptionConfig(rule.id, "templateFile", newFile);
      });
      cb.containerEl.addClass("frontmatter-automate-search");
    }).addExtraButton(
      (button) => button.setIcon("folder-tree").setTooltip("Select template file").onClick(async () => {
        openDirectorySelectionModal(
          that.app,
          [],
          [that.getOptionConfig(rule.id, "templateFile")],
          {
            title: "Select template for new files",
            selectionMode: "include",
            displayMode: "file",
            optionSelectionMode: false,
            optionShowFiles: true
          },
          (result) => {
            if (!result)
              return;
            if (result.files.length === 0 || !result.files[0] || typeof result.files[0] !== "string")
              return;
            let selectedFile = result.files[0].trim().replace(/\/$/, "");
            if (!selectedFile)
              return;
            destinationFileEl.setValue(selectedFile);
            that.setOptionConfig(rule.id, "templateFile", selectedFile);
          }
        );
      })
    );
  }
};

// src/rules/buildInAutoCompleteModal.ts
var import_obsidian20 = require("obsidian");

// src/autocompleteModal.ts
var import_obsidian19 = require("obsidian");
var AutocompleteModal = class extends import_obsidian19.Modal {
  /**
   * Creates an instance of the DirectorySelectionModal.
   * @param app - The Obsidian App instance.
   * @param plugin - The plugin instance.
   * @param expectedType - Expected return type.
   * @param activeFile - The currently active file or folder.
   * @param frontmatter - Frontmatter data for the active file.
   * @param okCallback - Function to call when the user clicks "OK". Receives the selection result.
   */
  constructor(app, plugin, rule, options, activeFile, frontmatter, okCallback) {
    super(app);
    this.knownProperties = {};
    this.result = {};
    this.changeCallback = (propertyInfo, value) => {
      if (propertyInfo) {
        this.result[propertyInfo.name] = value;
      }
    };
    this.app = app;
    this.tools = new ScriptingTools(app, this.plugin, this.frontmatter);
    this.activeFile = activeFile;
    this.frontmatter = frontmatter;
    this.plugin = plugin;
    this.rule = rule;
    this.options = options;
    this.expectedType = rule.type;
    this.promise = new Promise((resolve) => {
      this.resolvePromise = resolve;
    });
    if (okCallback)
      this.okCallback = okCallback;
    this.resetToInitial();
  }
  /**
   * Resets the current selection state to the initial state provided at construction.
   */
  resetToInitial() {
  }
  /**
   * Resets the current selection state to empty.
   */
  resetToEmpty() {
  }
  /**
   * Called when the modal is opened. Builds the UI.
   */
  async onOpen() {
    var _a;
    this.knownProperties = await this.tools.fetchKnownProperties(this.app);
    const { contentEl } = this;
    if (contentEl.parentElement)
      contentEl.parentElement.style.width = "900px";
    contentEl.empty();
    contentEl.addClass("codeEditor-modal");
    contentEl.createEl("h2", { text: "Please complete the following properties" });
    contentEl.createEl("body", { text: `File: ${(_a = this.activeFile) == null ? void 0 : _a.path}` });
    this.contentRootElement = contentEl.createDiv({ cls: "codeEditor-container" });
    this.contentRootElement.style.overflowY = "auto";
    this.contentRootElement.style.padding = "10px";
    this.contentRootElement.style.marginTop = "10px";
    this.contentRootElement.style.marginBottom = "10px";
    const propertyContainerEl = contentEl.createDiv({ cls: "codeEditor-options" });
    propertyContainerEl.style.flexDirection = "column";
    for (const [key, value] of Object.entries(this.frontmatter)) {
      if (key.startsWith(this.rule.property + this.options.propertyDelimiter)) {
        const rowEl = propertyContainerEl.createDiv({ cls: "property-setting-row setting-item" });
        rowEl.style.width = "100%";
        const controlEl = rowEl.createDiv({ cls: "setting-item-control" });
        controlEl.style.display = "flex";
        controlEl.style.alignItems = "center";
        controlEl.style.justifyContent = "space-between";
        controlEl.style.width = "100%";
        controlEl.style.gap = "0px";
        const leftContainer = controlEl.createDiv({ cls: "property-left-container" });
        leftContainer.style.display = "flex";
        leftContainer.style.alignItems = "center";
        leftContainer.style.minWidth = "250px";
        const iconEl = leftContainer.createSpan({ cls: "property-icon setting-item-icon" });
        iconEl.style.marginRight = "8px";
        updatePropertyIcon(iconEl, this.knownProperties[key].type);
        const searchContainer = leftContainer.createDiv({ cls: "property-search-container" });
        const nameInput = new import_obsidian19.TextComponent(searchContainer).setValue(key).setPlaceholder("Property name").setDisabled(true);
        nameInput.inputEl.style.border = "none";
        const middleContainer = controlEl.createDiv({ cls: "property-middle-container" });
        const valueContainer = middleContainer.createDiv({ cls: "property-value-container" });
        valueContainer.style.width = "100%";
        let previewComponent = renderValueInput(valueContainer, this.knownProperties[key], this.frontmatter[key], this.changeCallback);
        previewComponent.inputEl.style.width = "100%";
        previewComponent.inputEl.style.backgroundColor = "transparent";
        const deleteButtonContainer = controlEl.createDiv({ cls: "property-right-container" });
        deleteButtonContainer.style.marginLeft = "auto";
      }
    }
    this.createActionButtons(contentEl);
  }
  /**
   * Creates the "OK" and "Reset" buttons.
   * @param containerEl - The HTML element to append the buttons to.
   */
  createActionButtons(containerEl) {
    const buttonsEl = containerEl.createDiv({ cls: "modal-buttons" });
    buttonsEl.style.marginTop = "15px";
    buttonsEl.style.display = "flex";
    buttonsEl.style.justifyContent = "flex-end";
    buttonsEl.style.gap = "10px";
    const resetButton = buttonsEl.createEl("button");
    (0, import_obsidian19.setIcon)(resetButton, "reset");
    resetButton.ariaLabel = "Reset selection";
    resetButton.onclick = () => {
      this.resetToInitial();
    };
    const emptyButton = buttonsEl.createEl("button");
    (0, import_obsidian19.setIcon)(emptyButton, "eraser");
    emptyButton.ariaLabel = "Clear selection";
    emptyButton.onclick = () => {
      this.resetToEmpty();
    };
    const cancelButton = buttonsEl.createEl("button", { text: "Cancel" });
    cancelButton.ariaLabel = "close and discard changes";
    cancelButton.onclick = () => {
      logger.log(DEBUG, "Cancel Clicked - Returning");
      this.resolvePromise(null);
      this.close();
    };
    const okButton = buttonsEl.createEl("button", { text: "OK", cls: "mod-cta" });
    cancelButton.ariaLabel = "close and save changes";
    okButton.onclick = () => {
      this.resolvePromise({ values: this.result });
      this.close();
    };
  }
  /**
   * Called when the modal is closed. Cleans up resources.
   */
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  openAndGetValues() {
    this.open();
    return this.promise;
  }
};
async function openAutocompleteModal(app, plugin, rule, options, activeFile, frontmatter) {
  if (!app) {
    logger.log(ERROR, "App is undefined");
    return null;
  }
  const modal = new AutocompleteModal(app, plugin, rule, options, activeFile, frontmatter);
  return await modal.openAndGetValues();
}

// src/rules/buildInAutoCompleteModal.ts
var RuleBuildInAutoCompleteModal = class extends RulePrototype {
  constructor() {
    super();
    this.id = "autoCompleteModal";
    this.ruleType = "autocomplete.modal";
    this.name = "Auto-Complete Modal";
    this.description = "Displays an auto-complete modal for the frontmatter parameter.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const input = tools.getCurrentContent(); // Get the current content of property\n  return input; // Return the input unaltered\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    logger.log(DEBUG, `autocomplete modal, work in progress...`);
    const currentContent = tools.getCurrentContent();
    const rule = tools.getRule();
    if (!rule)
      return currentContent;
    const options = tools.getOptionConfig(rule.id);
    if (!rule)
      return tools.getCurrentContent() || "autocomplete.modal";
    const frontmatter = tools.getFrontmatter();
    const hasAutocompleteProperties = Object.keys(frontmatter).some(
      (key) => key.startsWith(rule.property + options.propertyDelimiter) && (frontmatter[key] === void 0 || frontmatter[key] === null || frontmatter[key] === "")
    );
    if (!hasAutocompleteProperties)
      return tools.getCurrentContent() || "autocomplete.modal";
    openAutocompleteModal(
      tools.app,
      tools.plugin,
      rule,
      options,
      tools.getActiveFile(),
      tools.getFrontmatter()
    ).then((result) => {
      logger.log(DEBUG, "autocomplete modal result", result, tools.getFrontmatter());
      if (result == null ? void 0 : result.values) {
        if (!tools.app) {
          logger.log(ERROR, "App is not defined");
          return tools.getCurrentContent() || "autocomplete.modal Error. See console for details.";
        }
        tools.app.fileManager.processFrontMatter(file, (frontmatter2) => {
          for (const [key, value] of Object.entries(result.values)) {
            frontmatter2[key] = value;
          }
        }, { "mtime": file.stat.mtime });
      }
      return tools.getCurrentContent();
    }).catch((error) => {
      logger.log(ERROR, "Error opening autocomplete modal:", error);
      return tools.getCurrentContent() || "autocomplete.modal Error. See console for details.";
    });
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      propertyDelimiter: "."
    });
    new import_obsidian20.Setting(optionEL).setName("Delimiter").setDesc("Character to determine which property should appear in the modal").addText((text) => text.setValue(that.getOptionConfig(rule.id, "propertyDelimiter") || ".").onChange(async (value) => {
      that.setOptionConfig(rule.id, "propertyDelimiter", value);
    }));
  }
};

// src/rules/buildInConcatArrays.ts
var import_obsidian21 = require("obsidian");
var RuleBuildInConcatArrays = class extends RulePrototype {
  constructor() {
    super();
    this.id = "concatArrays";
    this.ruleType = "buildIn";
    this.name = "Concat Arrays";
    this.description = "Concatenates multiple Lists (Multitext, Tags, Aliases).";
    this.source = "function (app, file, tools) { // do not change this line!\n  const propertyIds = tools.getOptionConfig(tools.getRule()?.id,'inputProperties');\n  if (!Array.isArray(propertyIds) || propertyIds.length === 0) {\n    return 'No properties selected';\n  }\n  const delimiter = tools.getOptionConfig(tools.getRule()?.id,'delimiter');\n  const onlyWhenAllPropertiesExist = tools.getOptionConfig(tools.getRule()?.id, 'onlyWhenAllPropertiesExist') || false;\n  if (onlyWhenAllPropertiesExist) {\n    // Check if all properties exist\n    const allExist = propertyIds.every(id => { \n      if (id === undefined || id === null || id === '') {\n        return true; // Skip empty or undefined property IDs\n      }\n      const propertyValue = tools.getFrontmatterProperty(id);\n      const result = propertyValue !== undefined && propertyValue !== null && propertyValue !== '';\n      return result;\n    });\n    if (!allExist) {\n      return '';\n    }\n  }\n  const result = propertyIds.map(id => {\n    let value = tools.getFrontmatterProperty(id);\n    if (value === undefined || value === null || value === '') {\n      return ''; // Skip empty or undefined properties\n    }\n    return value.toString();\n  }).filter(res => res !== undefined).join(delimiter);\n  return result;\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    var _a, _b;
    const propertyIds = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "inputProperties");
    if (!Array.isArray(propertyIds) || propertyIds.length === 0) {
      return "No properties selected";
    }
    const onlyWhenAllPropertiesExist = tools.getOptionConfig((_b = tools.getRule()) == null ? void 0 : _b.id, "onlyWhenAllPropertiesExist") || false;
    if (onlyWhenAllPropertiesExist) {
      const allExist = propertyIds.every((id) => {
        if (id === void 0 || id === null || id === "") {
          return true;
        }
        const propertyValue = tools.getFrontmatterProperty(id);
        const result = propertyValue !== void 0 && propertyValue !== null && propertyValue !== "";
        return result;
      });
      if (!allExist) {
        return [];
      }
    }
    let resultArray = [];
    propertyIds.forEach((id) => {
      let value = tools.getFrontmatterProperty(id);
      if (value === void 0 || value === null || value === "") {
        return;
      }
      resultArray = resultArray.concat(Array.isArray(value) ? value : [value.toString()]);
    });
    return resultArray;
  }
  configTab(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      inputProperties: [],
      onlyWhenAllPropertiesExist: false
      // Default to false
    });
    const multiProp = new MultiPropertySetting(optionEL).setName("Input Properties").setDesc("Select properties as input. (text, tags, aliases or multitext)").setOptions(Object.keys(that.knownProperties).map((key) => {
      const prop = that.knownProperties[key];
      if (prop.type === "text" || prop.type === "tags" || prop.type === "aliases" || prop.type === "multitext") {
        return key;
      }
      return null;
    }).filter((item) => item !== null)).setValue(that.getOptionConfig(rule.id, "inputProperties") || []).onChange((arr) => {
      that.setOptionConfig(rule.id, "inputProperties", arr);
      that.updatePreview(rule, previewComponent);
    });
    new import_obsidian21.Setting(optionEL).setName("Only when all properties exist").setDesc("If enabled, the rule will only return a value if all selected properties exist and not empty.").addToggle(
      (toggle) => toggle.setValue(that.getOptionConfig(rule.id, "onlyWhenAllPropertiesExist")).onChange(async (value) => {
        that.setOptionConfig(rule.id, "onlyWhenAllPropertiesExist", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/buildInConcatProperties.ts
var import_obsidian22 = require("obsidian");
var RuleBuildInConcatProperties = class extends RulePrototype {
  constructor() {
    super();
    this.id = "concatProperties";
    this.ruleType = "buildIn";
    this.name = "Concat Properties";
    this.description = "Concatenates multiple properties from the frontmatter.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const propertyIds = tools.getOptionConfig(tools.getRule()?.id,'inputProperties');\n  if (!Array.isArray(propertyIds) || propertyIds.length === 0) {\n    return 'No properties selected';\n  }\n  const delimiter = tools.getOptionConfig(tools.getRule()?.id,'delimiter');\n  const onlyWhenAllPropertiesExist = tools.getOptionConfig(tools.getRule()?.id, 'onlyWhenAllPropertiesExist') || false;\n  if (onlyWhenAllPropertiesExist) {\n    // Check if all properties exist\n    const allExist = propertyIds.every(id => { \n      if (id === undefined || id === null || id === '') {\n        return true; // Skip empty or undefined property IDs\n      }\n      const propertyValue = tools.getFrontmatterProperty(id);\n      const result = propertyValue !== undefined && propertyValue !== null && propertyValue !== '';\n      return result;\n    });\n    if (!allExist) {\n      return '';\n    }\n  }\n  const result = propertyIds.map(id => {\n    let value = tools.getFrontmatterProperty(id);\n    if (value === undefined || value === null || value === '') {\n      return ''; // Skip empty or undefined properties\n    }\n    return value.toString();\n  }).filter(res => res !== undefined).join(delimiter);\n  return result;\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    var _a, _b, _c;
    const propertyIds = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "inputProperties");
    if (!Array.isArray(propertyIds) || propertyIds.length === 0) {
      return "No properties selected";
    }
    const delimiter = tools.getOptionConfig((_b = tools.getRule()) == null ? void 0 : _b.id, "delimiter");
    const onlyWhenAllPropertiesExist = tools.getOptionConfig((_c = tools.getRule()) == null ? void 0 : _c.id, "onlyWhenAllPropertiesExist") || false;
    if (onlyWhenAllPropertiesExist) {
      const allExist = propertyIds.every((id) => {
        if (id === void 0 || id === null || id === "") {
          return true;
        }
        const propertyValue = tools.getFrontmatterProperty(id);
        const result2 = propertyValue !== void 0 && propertyValue !== null && propertyValue !== "";
        return result2;
      });
      if (!allExist) {
        return "";
      }
    }
    const result = propertyIds.map((id) => {
      let value = tools.getFrontmatterProperty(id);
      if (value === void 0 || value === null || value === "") {
        return "";
      }
      return value.toString();
    }).filter((res) => res !== void 0).join(delimiter);
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      delimiter: " ",
      // Default delimiter for concatenation
      inputProperties: [],
      onlyWhenAllPropertiesExist: true
      // Default to false
    });
    const multiProp = new MultiPropertySetting(optionEL).setName("Input Properties").setDesc("Select properties as input. Use 'Space replacement' as delimiter.").setOptions(Object.keys(that.knownProperties).map((key) => key)).setValue(that.getOptionConfig(rule.id, "inputProperties") || []).onChange((arr) => {
      that.setOptionConfig(rule.id, "inputProperties", arr);
      that.updatePreview(rule, previewComponent);
    });
    new import_obsidian22.Setting(optionEL).setName("Delimiter").setDesc("Specify a delimiter to use when concatenating properties. Default is a space.").addText(
      (text) => text.setValue(that.getOptionConfig(rule.id, "delimiter") || "").setPlaceholder("Enter delimiter").onChange(async (value) => {
        that.setOptionConfig(rule.id, "delimiter", value);
        that.updatePreview(rule, previewComponent);
      })
    );
    new import_obsidian22.Setting(optionEL).setName("Only when all properties exist").setDesc("If enabled, the rule will only return a value if all selected properties exist and not empty.").addToggle(
      (toggle) => toggle.setValue(that.getOptionConfig(rule.id, "onlyWhenAllPropertiesExist")).onChange(async (value) => {
        that.setOptionConfig(rule.id, "onlyWhenAllPropertiesExist", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/buildInConstant.ts
var import_obsidian23 = require("obsidian");
var RuleBuildInConstant = class extends RulePrototype {
  constructor() {
    super();
    this.id = "constant";
    this.ruleType = "buildIn";
    this.name = "Constant value";
    this.description = "Returns a constant value instead of the frontmatter parameter.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const result = tools.getOptionConfig(tools.getRule()?.id,'constantValue');\n  return result; // Return the constant value\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    var _a;
    const result = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "constantValue");
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      constantValue: ""
    });
    new import_obsidian23.Setting(optionEL).setName("Constant value").setDesc("Enter a constant value to be used in the rule").addText(
      (text) => text.setValue(that.getOptionConfig(rule.id, "constantValue") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "constantValue", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/buildInDateTimeCreated.ts
var RuleBuildInDateTimeCreated = class extends RulePrototype {
  constructor() {
    super();
    this.id = "dateTimeCreated";
    this.ruleType = "buildIn";
    this.name = "Date (and Time) created";
    this.description = "This rule returns the date and time when the file was created, adjusted for local timezone.";
    this.source = "function(app: App | undefined, file: TFile, tools: ScriptingTools) { // do not change this line! \n const timeOffset = new Date(Date.now()).getTimezoneOffset()*60000; // get local time offset \n const result = new Date(file.stat.ctime-timeOffset); \n return result.toISOString().split('Z')[0]; // remove UTC symbol \n }";
    this.type = ["date", "datetime"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const timeOffset = new Date(Date.now()).getTimezoneOffset() * 6e4;
    const result = new Date(file.stat.ctime - timeOffset);
    return result.toISOString().split("Z")[0];
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInDateTimeModified.ts
var RuleBuildInDateTimeModified = class extends RulePrototype {
  constructor() {
    super();
    this.id = "dateTimeModified";
    this.ruleType = "buildIn";
    this.name = "Date (and Time) modified";
    this.description = "This rule returns the date and time when the file was last modified, adjusted for local timezone.";
    this.source = "function(app: App | undefined, file: TFile, tools: ScriptingTools) { // do not change this line! \n const timeOffset = new Date(Date.now()).getTimezoneOffset()*60000; // get local time offset \n const result = new Date(file.stat.mtime-timeOffset); \n return result.toISOString().split('Z')[0]; // remove UTC symbol \n }";
    this.type = ["date", "datetime"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const timeOffset = new Date(Date.now()).getTimezoneOffset() * 6e4;
    const result = new Date(file.stat.mtime - timeOffset);
    return result.toISOString().split("Z")[0];
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInDefault.ts
var RuleBuildInDefault = class extends RulePrototype {
  constructor() {
    super();
    this.id = "default";
    this.ruleType = "buildIn";
    this.name = "Pass parameter unaltered";
    this.description = "Pass the content of the frontmatter parameter unaltered.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const input = tools.getCurrentContent(); // Get the current content of property\n  return input; // Return the input unaltered\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const input = tools.getCurrentContent();
    return input;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFileSizeBytes.ts
var RuleBuildInFileSizeBytes = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fileSizeBytes";
    this.ruleType = "buildIn";
    this.name = "File Size in Bytes";
    this.description = "This rule returns the size of the file in bytes.";
    this.source = "function(app: App | undefined, file: TFile, tools: ScriptingTools) { // do not change this line! \n const result = file.stat.size; \n return result; // return you result. \n }";
    this.type = ["number"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const result = file.stat.size;
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFileSizeString.ts
var RuleBuildInFileSizeString = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fileSizeString";
    this.ruleType = "buildIn";
    this.name = "File Size as String";
    this.description = "Converts the file size to a human-readable string (e.g., KB, MB, GB) with 2 decimal places precision.";
    this.source = "function(app: App | undefined, file: TFile, tools: ScriptingTools) { // do not change this line! \n let size =file.stat.size; \n const precision = 2; // number of decimal places \n if (size > 1024) { \n   size = size / 1024; \n   if (size > 1024) { \n     size = size / 1024; \n     if (size > 1024) { \n       size = size / 1024; \n       return size.toFixed(precision) + ' GB'; \n     } \n     return size.toFixed(precision) + ' MB'; \n   } \n   return size.toFixed(precision) + ' KB'; \n }   \n return size + ' Bytes'; // return you result. \n }";
    this.type = ["text"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let size = file.stat.size;
    const precision = 2;
    if (size > 1024) {
      size = size / 1024;
      if (size > 1024) {
        size = size / 1024;
        if (size > 1024) {
          size = size / 1024;
          return size.toFixed(precision) + " GB";
        }
        return size.toFixed(precision) + " MB";
      }
      return size.toFixed(precision) + " KB";
    }
    return size + " Bytes";
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFolder.ts
var RuleBuildInFolder = class extends RulePrototype {
  constructor() {
    super();
    this.id = "folder";
    this.ruleType = "buildIn";
    this.name = "Parent folder";
    this.description = "Returns the parent folder of the file.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const input = tools.getCurrentContent(); // Get the current content of property\n  return input; // Return the input unaltered\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const path2 = file.path;
    const parts = path2.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[parts.length - 2];
    }
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFolderFolderNotes.ts
var RuleBuildInFolderFolderNotes = class extends RulePrototype {
  constructor() {
    super();
    this.id = "folderFolderNotes";
    this.ruleType = "buildIn";
    this.name = 'Parent Folder (complies with "folder notes")';
    this.description = "Returns the parent folder of the file compatible with Folder Notes.";
    this.source = "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;const parts = file.path.split('/');\n  let index = parts.length-2; // index of parent folder\n  if (parts[parts.length-2]===file.basename) {\n      index--; // folder note parent is the child\n  }\n  if (index >= 0) {\n    return parts[index]; // file in folder\n  } else {\n    return tools.app?.vault?.getName() || 'Vault'; // file in root = vault\n  }\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    var _a, _b;
    const path2 = file.path;
    const parts = file.path.split("/");
    let index = parts.length - 2;
    if (parts[parts.length - 2] === file.basename) {
      index--;
    }
    if (index >= 0) {
      return parts[index];
    } else {
      return ((_b = (_a = tools.app) == null ? void 0 : _a.vault) == null ? void 0 : _b.getName()) || "Vault";
    }
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFolders.ts
var RuleBuildInFolders = class extends RulePrototype {
  constructor() {
    super();
    this.id = "folders";
    this.ruleType = "buildIn";
    this.name = "All folders of the file as a list";
    this.description = "Returns all folders the file is stored in as a list.";
    this.source = "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const result = path.split('/');\n  result.pop(); // remove the file name\n  return result;\n}";
    this.type = ["tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const path2 = file.path;
    const result = path2.split("/");
    result.pop();
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFullPath.ts
var RuleBuildInFullPath = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fullPath";
    this.ruleType = "buildIn";
    this.name = "Full path, filename";
    this.description = "Returns the full path of the file, including the filename.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  parts.pop();\n  parts.push(file.basename);\n  return parts.join('/');\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    parts.push(file.basename);
    return parts.join("/");
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFullPathExt.ts
var RuleBuildInFullPathExt = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fullPathExt";
    this.ruleType = "buildIn";
    this.name = "Full path, filename and extension";
    this.description = "Returns the full path of the file, including its filename and extension.";
    this.source = "function (app, file, tools) { // do not change this line!\n  return `${file.path}`;\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    return `${file.path}`;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFullPathExtFolderNotes.ts
var RuleBuildInFullPathExtFolderNotes = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fullPathExtFolderNotes";
    this.ruleType = "buildIn";
    this.name = 'Full Path with Extension (comply with "folder notes")';
    this.description = "Path with Extensions compatible with folder notes.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  parts.pop();\n  if (parts[parts.length-1] === file.basename) parts.pop();\n  parts.push(file.basename);\n  return parts.join('/');\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    parts.push(file.name);
    return parts.join("/");
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInFullPathFolderNotes.ts
var RuleBuildInFullPathFolderNotes = class extends RulePrototype {
  constructor() {
    super();
    this.id = "fullPathFolderNotes";
    this.ruleType = "buildIn";
    this.name = 'Full Path (comply with "folder notes")';
    this.description = "Path compatible compatible with folder notes.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  parts.pop();\n  if (parts[parts.length-1] === file.basename) parts.pop();\n  parts.push(file.basename);\n  return parts.join('/');\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    parts.push(file.basename);
    return parts.join("/");
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInGetProperty.ts
var import_obsidian24 = require("obsidian");
var RuleBuildInGetProperty = class extends RulePrototype {
  constructor() {
    super();
    this.id = "getProperty";
    this.ruleType = "buildIn";
    this.name = "Get property";
    this.description = "Gets a property from selected property.";
    this.source = "function(app: App | undefined, file: TFile, tools: ScriptingTools) { // do not change this line! \n const propertyId = tools.getOptionConfig(tools.getRule()?.id,'inputProperty'); \n if (propertyId === undefined || propertyId === '') { \n return 'Property not set'; \n } \n const result = tools.getFrontmatterProperty(propertyId); \n if (result === undefined) { \n return 'Property not found'; \n } \n return result; \n }";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    var _a;
    const propertyId = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "inputProperty");
    if (propertyId === void 0 || propertyId === "") {
      return "Property not set";
    }
    const result = tools.getFrontmatterProperty(propertyId);
    if (result === void 0) {
      return "Property not found";
    }
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      inputProperty: ""
    });
    let inputPropertiesDropdown;
    new import_obsidian24.Setting(optionEL).setName("Input Property").setDesc("Select a property as input").addDropdown((dropdown) => {
      inputPropertiesDropdown = dropdown;
      dropdown.setValue(that.getOptionConfig(rule.id, "inputProperty") || "").onChange(async (value) => {
        if (value !== "") {
          that.setOptionConfig(rule.id, "inputProperty", value);
          that.updatePreview(rule, previewComponent);
        }
      });
    });
    Object.keys(that.knownProperties).forEach((key) => {
      const item = that.knownProperties[key];
      inputPropertiesDropdown.addOption(item.name, item.name);
    });
  }
};

// src/rules/buildInIsRoot.ts
var RuleBuildInIsRoot = class extends RulePrototype {
  constructor() {
    super();
    this.id = "isRoot";
    this.ruleType = "buildIn";
    this.name = "File in Root folder";
    this.description = "Check if the file is in the root folder.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  return parts.length === 1;\n};";
    this.type = ["checkbox"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    return parts.length === 1;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInLinkToFile.ts
var import_obsidian25 = require("obsidian");
var RuleBuildInLinkToFile = class extends RulePrototype {
  constructor() {
    super();
    this.id = "linkToFile";
    this.ruleType = "buildIn";
    this.name = "Create link to file";
    this.description = "Create a link to the file in the current vault. Can be configured to include the file extension.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const parts = file.path.split('/');\n  const rule = tools.getRule();\n  if (!rule) return tools.getCurrentContent();\n  const addExtension = tools.getOptionConfig(rule.id,'addExtension') \n  parts.pop();\n  if (parts[parts.length-1] === file.basename) parts.pop();\n  let fileName = addExtension? file.basename + '.' + file.extension : file.basename; \n  return `[[${parts.join('/')}/${fileName}|${file.basename}]]`;\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const parts = file.path.split("/");
    const rule = tools.getRule();
    if (!rule)
      return tools.getCurrentContent();
    const addExtension = tools.getOptionConfig(rule.id, "addExtension");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    let fileName = addExtension ? file.basename + "." + file.extension : file.basename;
    return `[[${parts.join("/")}/${fileName}|${file.basename}]]`;
  }
  configTab(optionEL, rule, that, previewComponent) {
    that.setOptionConfigDefaults(rule.id, {
      addExtension: true
    });
    new import_obsidian25.Setting(optionEL).setName("Include file extension").setDesc("Add file extension to pathname").addToggle(
      (toggle) => toggle.setValue(that.getOptionConfig(rule.id, "addExtension") || false).onChange(async (value) => {
        that.setOptionConfig(rule.id, "addExtension", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/buildInName.ts
var RuleBuildInName = class extends RulePrototype {
  constructor() {
    super();
    this.id = "name";
    this.ruleType = "buildIn";
    this.name = "File name without extension";
    this.description = "Returns the file name without all extensions. I.e. example.note.md => example";
    this.source = "function (app, file, tools) { // do not change this line!\n  // acquire file name\n  const result = tools.removeAllExtensions(file.name);\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const result = tools.removeAllExtensions(file.name);
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInNameExt.ts
var RuleBuildInNameExt = class extends RulePrototype {
  constructor() {
    super();
    this.id = "nameExt";
    this.ruleType = "buildIn";
    this.name = "File name with extension";
    this.description = "Returns the file name with extension.";
    this.source = "function (app, file, tools) { // do not change this line!\n  // acquire file name with extension\n  const result = file.name;\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const result = file.name;
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInPath.ts
var RuleBuildInPath = class extends RulePrototype {
  constructor() {
    super();
    this.id = "path";
    this.ruleType = "buildIn";
    this.name = "Full path";
    this.description = "Returns the folder path the file is stored in.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  parts.pop();\n  return parts.join('/');\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    return parts.join("/");
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInPathFolderNotes.ts
var RuleBuildInPathFolderNotes = class extends RulePrototype {
  constructor() {
    super();
    this.id = "pathFolderNotes";
    this.ruleType = "buildIn";
    this.name = "Path (folder notes)";
    this.description = "Path compatible with folder notes.";
    this.source = "function (app, file, tools) { // do not change this line!\n  let parts = file.path.split('/');\n  parts.pop();\n  if (parts[parts.length-1] === file.basename) parts.pop(); // remove parent folder if same name as the file\n  return parts.join('/');\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    let parts = file.path.split("/");
    parts.pop();
    if (parts[parts.length - 1] === file.basename)
      parts.pop();
    return parts.join("/");
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInRootFolder.ts
var RuleBuildInRootFolder = class extends RulePrototype {
  constructor() {
    super();
    this.id = "rootFolder";
    this.ruleType = "buildIn";
    this.name = "Root folder";
    this.description = "Returns the root folder where the file is stored.";
    this.source = "function (app, file, tools) { // do not change this line!\n  // acquire file path\n  const path = file.path;\n  const parts = path.split('/');\n  return parts.length > 1 ? parts[0] : ''; // return root folder or empty string if in root\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const path2 = file.path;
    const parts = path2.split("/");
    let result = "";
    if (parts.length > 1) {
      result = parts[0];
    }
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/buildInScript.ts
var RuleBuildInScript = class extends RulePrototype {
  constructor() {
    super();
    this.id = "script";
    this.ruleType = "buildIn";
    this.name = "JavaScript function (advanced)";
    this.description = "Implement a JavaScript function to process the input content. The function should return the processed content.";
    this.source = "function (app, file, tools) { // do not change this line!\n  const input = tools.getCurrentContent(); // Get the current content of property\n  return input; // Return the input unaltered\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools) {
    const input = tools.getCurrentContent();
    return input;
  }
  configTab(optionEL, rule, that, previewComponent) {
  }
};

// src/rules/replaceChars.ts
var import_obsidian26 = require("obsidian");
var RuleReplaceChars = class extends RulePrototype {
  constructor() {
    super();
    this.id = "replaceChars";
    this.name = "Replace Characters";
    this.description = "Replaces configurable characters in the input value with a specified text string. Supports text and regex replacements.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    var _a, _b;
    const replace = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "replace");
    if (!replace || replace === "") {
      return input;
    }
    const replaceBy = tools.getOptionConfig((_b = tools.getRule()) == null ? void 0 : _b.id, "replaceBy");
    try {
      const regex = new RegExp(replace, "g");
      return input.replace(regex, replaceBy);
    } catch (e) {
      logger.log(ERROR, `Error in RuleReplaceChars: Invalid regex pattern "${replace}"`, e);
      return input;
    }
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      replace: "",
      // search for this string
      replaceBy: ""
      // replace with this string
    });
    new import_obsidian26.Setting(optionEL).setName("search for").setDesc("Character to search for in the input value (Regex supported)").addText(
      (text) => text.setPlaceholder("search for").setValue(that.getOptionConfig(rule.id, "replace") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "replace", value);
        that.updatePreview(rule, previewComponent);
      })
    );
    new import_obsidian26.Setting(optionEL).setName("replace by").setDesc("Character to replace matches").addText(
      (text) => text.setPlaceholder("replace by").setValue(that.getOptionConfig(rule.id, "replaceBy") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "replaceBy", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/replaceSpaces.ts
var import_obsidian27 = require("obsidian");
var RuleReplaceSpaces = class extends RulePrototype {
  constructor() {
    super();
    this.id = "replaceSpaces";
    this.name = "Replace Spaces";
    this.description = "Replaces spaces in the input value with a specified character.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    var _a;
    const spaceReplacement = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "spaceReplacement");
    return input.replace(/\s+/g, spaceReplacement);
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      spaceReplacement: ""
      // Default suffix
    });
    new import_obsidian27.Setting(optionEL).setName("Space replacement").setDesc('Character to replace spaces (suggested: "_")').addText(
      (text) => text.setPlaceholder("will remove spaces").setValue(that.getOptionConfig(rule.id, "spaceReplacement") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "spaceReplacement", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/replaceSpecialChars.ts
var import_obsidian28 = require("obsidian");
var RuleReplaceSpecialChars = class extends RulePrototype {
  constructor() {
    super();
    this.id = "replaceSpecialChars";
    this.name = "Replace Special Characters";
    this.description = 'Character to replace special characters (suggested: "-") - preserves letters with diacritics';
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    var _a;
    const specialCharReplacement = tools.getOptionConfig((_a = tools.getRule()) == null ? void 0 : _a.id, "specialCharReplacement");
    return input.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, specialCharReplacement);
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      specialCharReplacement: ""
      // Default suffix
    });
    new import_obsidian28.Setting(optionEL).setName("Replace Special Characters").setDesc('Character to replace special characters (suggested: "-") - preserves letters with diacritics').addText(
      (text) => text.setPlaceholder("will remove special characters").setValue(that.getOptionConfig(rule.id, "specialCharReplacement") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "specialCharReplacement", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
};

// src/rules/toCamelCase.ts
var RuleToCamelCase = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toCamelCase";
    this.name = "To Camel Case";
    this.description = "Convert the value to Camel Case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    const toCamelCase = (str) => {
      let textParts = str.split(" ");
      let convertedTextParts = [];
      textParts.forEach((text, index) => {
        let newTextPart = text.toLowerCase();
        if (index > 0)
          newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
        convertedTextParts.push(newTextPart);
      });
      return convertedTextParts.join("");
    };
    if (typeof input === "string") {
      return toCamelCase(input);
    } else if (Array.isArray(input)) {
      return input.map((item) => toCamelCase(String(item)));
    } else if (input instanceof Date) {
      return toCamelCase(input.toISOString());
    } else if (typeof input === "object") {
      return toCamelCase(JSON.stringify(input));
    }
    return input;
  }
};

// src/rules/toLinkMarkdown.ts
var RuleToLinkMarkdown = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toMarkdownLink";
    this.name = "to markdown link";
    this.description = "Format as a markdown link.";
    this.ruleType = "linkFormatter";
    this.source = "function (input: any, tools: ScriptingTools) { // do not change this line!\n  input = tools.toMarkdownLink(input); // Convert to markdown link format\n  return input;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    input = tools.toMarkdownLink(input);
    return input;
  }
};

// src/rules/toLinkOriginal.ts
var RuleToLinkOriginal = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toOriginalLink";
    this.name = "no change";
    this.description = "Pass the input unaltered.";
    this.ruleType = "linkFormatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    return input;
  }
};

// src/rules/toLinkSimple.ts
var RuleToLinkSimple = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toSimpleLink";
    this.name = "to simple link";
    this.description = "Format as a simple link by adding [[]].";
    this.ruleType = "linkFormatter";
    this.source = "function (app, file, tools, input) { // do not change this line!\n  if (input === undefined || input === null || input === '') {\n    return ''; // Return empty string if input is undefined, null, or empty\n  }\n         input = `[[${input}]]`; // Convert to simple Link\n  return input;\n};";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    if (input === void 0 || input === null || input === "") {
      return "";
    }
    input = `[[${input}]]`;
    return input;
  }
};

// src/rules/toLinkWiki.ts
var RuleToLinkWiki = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toWikiLink";
    this.name = "to wiki link";
    this.description = "Format as a wiki link.";
    this.ruleType = "linkFormatter";
    this.source = "function (input: any, tools: ScriptingTools) { // do not change this line!\n  input = tools.toWikiLink(input); // Convert to wiki link format\n  return input;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    input = tools.toWikiLink(input);
    return input;
  }
};

// src/rules/toLowerCase.ts
var RuleToLowerCase = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toLowerCase";
    this.name = "To Lower Case";
    this.description = "Convert the value to lower case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    if (String.isString(input)) {
      return input.toLowerCase();
    } else if (Array.isArray(input)) {
      return input.map((item) => String(item).toLowerCase());
    } else if (input instanceof Date) {
      return input.toISOString().toLowerCase();
    } else if (typeof input === "object") {
      return JSON.stringify(input).toLowerCase();
    }
    return input;
  }
};

// src/rules/toOriginal.ts
var RuleToOriginal = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toOriginal";
    this.name = "no change";
    this.description = "Pass the input unaltered.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    return input;
  }
};

// src/rules/toPascalCase.ts
var RuleToPascalCase = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toPascalCase";
    this.name = "To Pascal Case";
    this.description = "Convert the value to Pascal Case (Upper Camel Case).";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    const toPascalCase = (str) => {
      return str.replace(
        /(?:^\w|[A-Z]|\b\w|\s+)/g,
        (match) => match.toUpperCase()
      ).replace(/\s+/g, "").replace(/[^a-zA-Z0-9]/g, "");
    };
    if (typeof input === "string") {
      return toPascalCase(input);
    } else if (Array.isArray(input)) {
      return input.map((item) => toPascalCase(String(item)));
    } else if (input instanceof Date) {
      return toPascalCase(input.toISOString());
    } else if (typeof input === "object") {
      return toPascalCase(JSON.stringify(input));
    }
    return input;
  }
};

// src/rules/toTitleCase.ts
var RuleToTitleCase = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toTitleCase";
    this.name = "To Title Case (Simple)";
    this.description = "Convert the value to Title Case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    const toTitleCase = (str) => {
      let textParts = str.split(" ");
      let convertedTextParts = [];
      textParts.forEach((text, index) => {
        let newTextPart = text.toLowerCase();
        newTextPart = newTextPart.charAt(0).toUpperCase() + newTextPart.slice(1);
        convertedTextParts.push(newTextPart);
      });
      return convertedTextParts.join(" ");
    };
    if (typeof input === "string") {
      return toTitleCase(input);
    } else if (Array.isArray(input)) {
      return input.map((item) => toTitleCase(String(item)));
    } else if (input instanceof Date) {
      return toTitleCase(input.toISOString());
    } else if (typeof input === "object") {
      return toTitleCase(JSON.stringify(input));
    }
    return input;
  }
};

// src/rules/toTitleCaseDE.ts
var import_obsidian29 = require("obsidian");
var RuleToTitleCaseDE = class extends RulePrototype {
  // Set to true for verbose logging
  constructor() {
    super();
    this.verboseLogging = false;
    this.small = "(der|die|das|den|dem|des|einer|eines|deren|ein|eine|einem|einer|eines|einer|und|oder|aber|denn|sondern|sowie|weder|noch|entweder|oder|dass|weil|obwohl|wenn|als|nachdem|bevor|w\xE4hrend|bis|damit|um|zu|sobald|solange|da|indem|so|dass|ohne|zu|durch|f\xFCr|gegen|ohne|um|bis|aus|au\xDFer|bei|gegen\xFCber|mit|nach|seit|von|zu|anstatt|aufgrund|au\xDFerhalb|innerhalb|trotz|w\xE4hrend|wegen|an|auf|hinter|in|neben|\xFCber|unter|vor|zwischen)";
    this.punctuation = "\\([!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~\\-]*\\)";
    this.id = "toTitleCaseDe";
    this.name = "To Title Case (German small words)";
    this.description = "Convert German value to Title Case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    const toTitleCase = (str) => {
      var _a;
      const ruleId = (_a = tools.getRule()) == null ? void 0 : _a.id;
      const doNotCapitalizeSmallWords = tools.getOptionConfig(ruleId, "doNotCapitalizeSmallWords");
      return this.titleCaps(str, doNotCapitalizeSmallWords ? tools.getOptionConfig(ruleId, "smallWords") : void 0);
    };
    let result = input;
    if (typeof input === "string") {
      result = toTitleCase(input);
    } else if (Array.isArray(input)) {
      result = input.map((item) => toTitleCase(String(item)));
    } else if (input instanceof Date) {
      result = toTitleCase(input.toISOString());
    } else if (typeof input === "object") {
      result = toTitleCase(JSON.stringify(input));
    }
    logger.log(DEBUG, `RuleToTitleCaseDE.fx - input:'${input}' result:'${result}'`);
    return result;
  }
  configTab(optionEL, rule, that, previewComponent) {
    optionEL.empty();
    that.setOptionConfigDefaults(rule.id, {
      smallWords: "der|die|das|den|dem|des|einer|eines|deren|ein|eine|einem|einer|eines|einer|und|oder|aber|denn|sondern|sowie|weder|noch|entweder|oder|dass|weil|obwohl|wenn|als|nachdem|bevor|w\xE4hrend|bis|damit|um|zu|sobald|solange|da|indem|so|dass|ohne|zu|durch|f\xFCr|gegen|ohne|um|bis|aus|au\xDFer|bei|gegen\xFCber|mit|nach|seit|von|zu|anstatt|aufgrund|au\xDFerhalb|innerhalb|trotz|w\xE4hrend|wegen|an|auf|hinter|in|neben|\xFCber|unter|vor|zwischen",
      doNotCapitalizeSmallWords: true
    });
    new import_obsidian29.Setting(optionEL).setName("Do not capitalize small words").setDesc("If enabled, small words will not be capitalized. If disabled, all words will be capitalized.").addToggle(
      (toggle) => toggle.setValue(that.getOptionConfig(rule.id, "doNotCapitalizeSmallWords") || false).onChange(async (value) => {
        that.setOptionConfig(rule.id, "doNotCapitalizeSmallWords", value);
        that.updatePreview(rule, previewComponent);
      })
    );
    new import_obsidian29.Setting(optionEL).setName("List of small words").setDesc('Enter a list of small words to be excluded from capitalization. Use "|" as separator.').addText(
      (text) => text.setValue(that.getOptionConfig(rule.id, "smallWords") || "").onChange(async (value) => {
        that.setOptionConfig(rule.id, "smallWords", value);
        that.updatePreview(rule, previewComponent);
      })
    );
  }
  titleCaps(title, smallWords) {
    const parts = [];
    const split = new RegExp(`[:.;?!] |(?: |^)["${this.punctuation}]`, "g");
    let index = 0;
    while (true) {
      const m = split.exec(title);
      const substring = title.substring(index, m ? m.index : title.length);
      logger.log(TRACE, "Processing substring:", substring);
      let isFirstWord = true;
      parts.push(
        substring.replace(/([\p{L}\p{M}]+(?:\.[\p{L}\p{M}]+)*)/gu, (all) => {
          logger.log(TRACE, "Matched word:", all);
          if (/[a-z][A-Z]|[A-Z][a-z]/.test(all)) {
            logger.log(TRACE, "Excluding mixed capitalization word:", all);
            isFirstWord = false;
            return all;
          }
          if (/^[A-ZÄÖÜß]+$/.test(all)) {
            logger.log(TRACE, "Excluding fully capitalized word:", all);
            isFirstWord = false;
            return all;
          }
          if (/[^\s]+\.[^\s]+/.test(all)) {
            logger.log(TRACE, "Excluding word with punctuation:", all);
            isFirstWord = false;
            return all;
          }
          const smallRegex = new RegExp(`^(${smallWords})$`, "iu");
          if (isFirstWord) {
            logger.log(TRACE, "Capitalizing first word of sentence:", all);
            isFirstWord = false;
            return this.upperDE(all);
          } else if (smallRegex.test(all)) {
            logger.log(TRACE, "Skipping capitalization for small word:", all);
            return this.lowerDE(all);
          }
          isFirstWord = false;
          return this.upperDE(all);
        })
      );
      index = split.lastIndex;
      if (m)
        parts.push(m[0]);
      else
        break;
    }
    return parts.join("");
  }
  lowerDE(word) {
    logger.log(TRACE, "Lowering:", word);
    return word.toLocaleLowerCase("de");
  }
  upperDE(word) {
    logger.log(TRACE, "Uppering:", word);
    return word.charAt(0).toLocaleUpperCase("de") + word.slice(1).toLocaleLowerCase("de");
  }
};

// src/rules/toTitleCaseEN.ts
var RuleToTitleCaseEN = class extends RulePrototype {
  constructor() {
    super();
    this.small = "(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|v[.]?|via|vs[.]?)";
    this.punctuation = "([!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~-]*)";
    this.id = "toTitleCaseEn";
    this.name = "To Title Case (English small words)";
    this.description = "Convert the value to Title Case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    const toTitleCase = (str) => {
      return this.titleCaps(str);
    };
    if (typeof input === "string") {
      return toTitleCase(input);
    } else if (Array.isArray(input)) {
      return input.map((item) => toTitleCase(String(item)));
    } else if (input instanceof Date) {
      return toTitleCase(input.toISOString());
    } else if (typeof input === "object") {
      return toTitleCase(JSON.stringify(input));
    }
    return input;
  }
  titleCaps(title) {
    var parts = [], split = /[:.;?!] |(?: |^)["Ò]/g, index = 0;
    while (true) {
      var m = split.exec(title);
      parts.push(title.substring(index, m ? m.index : title.length).replace(/\b([A-Za-z][a-z.'Õ]*)\b/g, (all) => {
        return /[A-Za-z]\.[A-Za-z]/.test(all) ? all : this.upper(all);
      }).replace(RegExp("\\b" + this.small + "\\b", "ig"), this.lower).replace(RegExp("^" + this.punctuation + this.small + "\\b", "ig"), (all, punct, word) => {
        return punct + this.upper(word);
      }).replace(RegExp("\\b" + this.small + this.punctuation + "$", "ig"), this.upper));
      index = split.lastIndex;
      if (m)
        parts.push(m[0]);
      else
        break;
    }
    return parts.join("").replace(/ V(s?)\. /ig, " v$1. ").replace(/(['Õ])S\b/ig, "$1s").replace(/\b(AT&T|Q&A)\b/ig, function(all) {
      return all.toUpperCase();
    });
  }
  lower(word) {
    return word.toLowerCase();
  }
  upper(word) {
    return word.substr(0, 1).toUpperCase() + word.substr(1);
  }
};

// src/rules/toUpperCase.ts
var RuleToUpperCase = class extends RulePrototype {
  constructor() {
    super();
    this.id = "toUpperCase";
    this.name = "To Upper Case";
    this.description = "Convert the value to upper case.";
    this.ruleType = "formatter";
    this.source = "function (app, file, tools) { // do not change this line!\n  let result = '';\n  return result;\n}";
    this.type = ["text", "tags", "aliases", "multitext"];
    this.configElements = this.defaultConfigElements({});
  }
  fx(app, file, tools, input) {
    if (String.isString(input)) {
      return input.toUpperCase();
    } else if (Array.isArray(input)) {
      return input.map((item) => String(item).toUpperCase());
    } else if (input instanceof Date) {
      return input.toISOString().toUpperCase();
    } else if (typeof input === "object") {
      return JSON.stringify(input).toUpperCase();
    }
    return input;
  }
};

// src/rules/index.ts
var ruleClasses = [RuleAddPrefix, RuleAddSuffix, RuleAutomationAutoLink, RuleBuildInAutoCompleteModal, RuleBuildInConcatArrays, RuleBuildInConcatProperties, RuleBuildInConstant, RuleBuildInDateTimeCreated, RuleBuildInDateTimeModified, RuleBuildInDefault, RuleBuildInFileSizeBytes, RuleBuildInFileSizeString, RuleBuildInFolder, RuleBuildInFolderFolderNotes, RuleBuildInFolders, RuleBuildInFullPath, RuleBuildInFullPathExt, RuleBuildInFullPathExtFolderNotes, RuleBuildInFullPathFolderNotes, RuleBuildInGetProperty, RuleBuildInIsRoot, RuleBuildInLinkToFile, RuleBuildInName, RuleBuildInNameExt, RuleBuildInPath, RuleBuildInPathFolderNotes, RuleBuildInRootFolder, RuleBuildInScript, RuleReplaceChars, RuleReplaceSpaces, RuleReplaceSpecialChars, RuleToCamelCase, RuleToLinkMarkdown, RuleToLinkOriginal, RuleToLinkSimple, RuleToLinkWiki, RuleToLowerCase, RuleToOriginal, RuleToPascalCase, RuleToTitleCase, RuleToTitleCaseDE, RuleToTitleCaseEN, RuleToUpperCase];
ruleClasses.forEach((RuleClass) => {
  const ruleInstance = new RuleClass();
  rulesManager.registerRule(ruleInstance);
});

// main.ts
var FolderTagPlugin = class extends import_obsidian30.Plugin {
  constructor() {
    super(...arguments);
    this.fileInProgress = null;
  }
  // Track the file currently being processed
  //private oldFolderPaths = new Map<string, string | null>();
  async onload() {
    await this.loadSettings();
    logger.log(INFO, `Front Matter Automate ${versionString} loaded with settings: `, this.settings);
    logger.setLevel(this.settings.debugLevel);
    this.tools = new ScriptingTools(this.app, this);
    rulesManager.init(this.app, this, this.tools);
    let noticeMessage = `Front Matter Automate ${versionString}
 loading ...`;
    const loadingNotice = new import_obsidian30.Notice(noticeMessage, 0);
    noticeMessage = noticeMessage + "\n register events ...";
    loadingNotice.setMessage(noticeMessage);
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        logger.log(DEBUG, `Event creating file: ${file.path} starting in ${this.settings.delayCreateEvent}ms`);
        if (file instanceof import_obsidian30.TFile && file.extension === "md") {
          this.fileInProgress = file;
          setTimeout(
            () => {
              logger.log(DEBUG, `Event creating file started: `, file.path);
              this.updateFrontmatterParameters("create", file, this.settings.folderConfig);
              this.fileInProgress = null;
            },
            this.settings.delayCreateEvent
          );
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (this.fileInProgress)
          return;
        if (file instanceof import_obsidian30.TFile && file.extension === "md") {
          this.updateFrontmatterParameters("rename", file, this.settings.folderConfig, oldPath);
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("changed", async (file, data, cache) => {
        if (this.fileInProgress)
          return;
        if (!checkIfFileAllowed(file, this.settings)) {
          logger.log(DEBUG, `file ${file.path} globally rejected!`);
          return;
        }
        if (!(file instanceof import_obsidian30.TFile) || file.extension !== "md") {
          logger.log(DEBUG, `Event metadata changed: ${file.path} not a markdown file!`);
          return;
        }
        if (file)
          this.updateFrontmatterParameters("metadata-changed", file, this.settings.folderConfig);
      })
    );
    noticeMessage = noticeMessage + "\n initial processing ...";
    loadingNotice.setMessage(noticeMessage);
    noticeMessage = noticeMessage + "\ndone!";
    loadingNotice.setMessage(noticeMessage);
    setTimeout(() => {
      loadingNotice.hide();
    }, 2e3);
    this.addSettingTab(new FolderTagSettingTab(this.app, this));
  }
  async loadSettings() {
    let data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_FRONTMATTER_AUTOMATE_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  formatTagName(name) {
    if (name === null)
      return null;
    if (name === void 0)
      return void 0;
    let formatted = name.replace(/\s+/g, this.settings.spaceReplacement);
    formatted = formatted.replace(/[^a-zA-Z0-9\-_\/äöüßÄÖÜáéíóúýÁÉÍÓÚÝàèìòùÀÈÌÒÙâêîôûÂÊÎÔÛãñõÃÑÕ]/g, this.settings.specialCharReplacement);
    if (this.settings.lowercaseTags) {
      formatted = formatted.toLowerCase();
    }
    return formatted;
  }
  formatValue(value, type) {
    switch (type) {
      case "text":
      case "tags":
      case "aliases":
      case "multitext":
        return this.tools.toYamlSafeString(value);
      case "date":
      case "datetime":
        if (typeof value === "number") {
          return new Date(value).toISOString();
        }
        return value.toString();
      case "checkbox":
        return value ? "true" : "false";
      case "number":
        return Number(value);
      default:
        return this.tools.toYamlSafeString(value);
    }
  }
  updateFrontmatterParameters(eventName, file, ruleSettings, oldPath) {
    var _a;
    if (!checkIfFileAllowed(file, this.settings)) {
      logger.log(DEBUG, `file ${file.path} globally rejected!`);
      return;
    }
    const currentPathTag = this.formatTagName(this.tools.getFolderFromPath(file.path));
    const oldPathTag = this.formatTagName(this.tools.getFolderFromPath(oldPath));
    const rules = (_a = ruleSettings == null ? void 0 : ruleSettings.rows.flatMap((row) => {
      if (row.folderId) {
        const folder = ruleSettings.folders.find((folder2) => folder2.id === row.folderId);
        if (!folder) {
          row.folderId = void 0;
          logger.log(ERROR, `Event ${eventName}: Folder with id ${row.folderId} not found for rule ${row.payload.content}!`);
          return [row.payload];
        }
        return !folder.disabled ? [row.payload] : [];
      }
      return [row.payload];
    })) != null ? _a : [];
    if (!rules || rules.length === 0) {
      logger.log(DEBUG, `Event ${eventName}: No rules found for file ${file.path}`);
      return;
    }
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      var _a2;
      logger.groupCollapsed(DEBUG, `Event ${eventName}: "${file.path}" ${rules.length}/${ruleSettings == null ? void 0 : ruleSettings.rows.length} active rules. Old file: "${oldPath}"`, frontmatter);
      let oldLocationResults = [];
      if (oldPath && oldPath !== file.path) {
        logger.groupCollapsed(DEBUG, `Event ${eventName}: Collecting results for old file path: "${oldPath}"`);
        for (let rule of rules) {
          if (!rule)
            continue;
          let result = executeRuleObject(eventName, this.app, this, this.settings, this.tools.getMockFileFromPath(oldPath), frontmatter[rule.property], rule, frontmatter);
          oldLocationResults.push({ ruleId: rule.id, result });
        }
        logger.log(DEBUG, `Old file path results:`, oldLocationResults);
        logger.groupEnd();
      }
      for (let rule of rules) {
        if (!rule)
          continue;
        let result = frontmatter[rule.property];
        logger.groupCollapsed(DEBUG, `Execute Rule: ${rule.property}(${rule.content})`, result, rule);
        if (!checkIfFileAllowed(file, this.settings, rule)) {
          logger.log(DEBUG, `file ${file.path} rejected by rule (${rule.property}|${rule.content}) settings`);
          logger.groupEnd();
          continue;
        }
        if (rule.onlyModify && !frontmatter.hasOwnProperty(rule.property)) {
          logger.log(DEBUG, `file "${file.path}" has not "${rule.property}"(Rule:${rule.content}) onlyModify set: skipped`);
          logger.groupEnd();
          continue;
        }
        switch ((_a2 = rulesManager.getRuleById(rule.content)) == null ? void 0 : _a2.ruleType) {
          case "buildIn":
          case "script":
            result = executeRuleObject(eventName, this.app, this, this.settings, file, frontmatter[rule.property], rule, frontmatter, oldLocationResults);
            break;
          default:
        }
        frontmatter[rule.property] = result;
        logger.groupEnd();
      }
      logger.log(DEBUG, "Frontmatter updated", frontmatter);
      logger.groupEnd();
    }, { "mtime": file.stat.mtime });
  }
  /*
      async removeFrontmatterParamsFromAllFiles(rule: FrontmatterAutomateRuleSettings){
          let count = {files:0, items: 0}
          this.app.vault.getMarkdownFiles().forEach(file => {
              count.files++;
              this.removeFrontmatterParameter(file, rule, count);
          });
          return count;
      }
  
      async removeFrontmatterParameter(file: TFile, rule: FrontmatterAutomateRuleSettings, count) {
          if (!checkIfFileAllowed(file, this.settings, rule)) return;
          const currentPathTag = this.formatTagName(this.tools.getFolderFromPath(file.path));
          let content = await this.app.vault.read(file);
          this.app.fileManager.processFrontMatter(file, (frontmatter) => {
              if (Array.isArray(frontmatter[rule.property])) count.items += frontmatter[rule.property].length;
              frontmatter[rule.property] = removeRule(this.app, this.settings, file, frontmatter[rule.property], rule, frontmatter);
              if (Array.isArray(frontmatter[rule.property])) count.items -= frontmatter[rule.property].length;
          },{'mtime':file.stat.mtime}); // do not change the modify time.
          return count;
      }
      */
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2Zyb250bWF0dGVyLXRvb2xzLnRzIiwgInNyYy9Mb2cudHMiLCAic3JjL0Vycm9yLnRzIiwgInNyYy90b29scy50cyIsICJzcmMvYWxlcnRCb3gudHMiLCAic3JjL3J1bGVzL3J1bGVzLnRzIiwgInNyYy90eXBlcy50cyIsICJzcmMvZGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwudHMiLCAic3JjL3NldHRpbmdzLXByb3BlcnRpZXMudHMiLCAic3JjL3J1bGVzLnRzIiwgInNyYy9lZGl0b3JNb2RhbC50cyIsICJzcmMvdWlFbGVtZW50cy50cyIsICJzcmMvdWlNdWx0aVByb3BlcnR5U2V0dGluZy50cyIsICJzcmMvdWlUcmVlSGllcmFyY2h5U29ydGFibGVTZXR0aW5ncy50cyIsICJzcmMvdWlNYXJrZG93bkhlbHBNb2RhbC50cyIsICJzcmMvcnVsZXMvYWRkUHJlZml4LnRzIiwgInNyYy9ydWxlcy9hZGRTdWZmaXgudHMiLCAic3JjL3J1bGVzL2F1dG9tYXRpb25BdXRvTGluay50cyIsICJzcmMvc3VnZ2VzdGVycy9Gb2xkZXJTdWdnZXN0ZXIudHMiLCAic3JjL3N1Z2dlc3RlcnMvc3VnZ2VzdC50cyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2VudW1zLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVOYW1lLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21hdGguanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy91c2VyQWdlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaXNMYXlvdXRWaWV3cG9ydC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9jb250YWlucy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzVGFibGVFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRQYXJlbnROb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3dpdGhpbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcnJvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldFZhcmlhdGlvbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsQmFyWC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRWaWV3cG9ydFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzU2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFNjcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZU9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZXRlY3RPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2ZsaXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvaGlkZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9vZmZzZXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEFsdEF4aXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGVib3VuY2UuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9tZXJnZUJ5TmFtZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2NyZWF0ZVBvcHBlci5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3BvcHBlci5qcyIsICJzcmMvc3VnZ2VzdGVycy9GaWxlU3VnZ2VzdGVyLnRzIiwgInNyYy9ydWxlcy9idWlsZEluQXV0b0NvbXBsZXRlTW9kYWwudHMiLCAic3JjL2F1dG9jb21wbGV0ZU1vZGFsLnRzIiwgInNyYy9ydWxlcy9idWlsZEluQ29uY2F0QXJyYXlzLnRzIiwgInNyYy9ydWxlcy9idWlsZEluQ29uY2F0UHJvcGVydGllcy50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkNvbnN0YW50LnRzIiwgInNyYy9ydWxlcy9idWlsZEluRGF0ZVRpbWVDcmVhdGVkLnRzIiwgInNyYy9ydWxlcy9idWlsZEluRGF0ZVRpbWVNb2RpZmllZC50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkRlZmF1bHQudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5GaWxlU2l6ZUJ5dGVzLnRzIiwgInNyYy9ydWxlcy9idWlsZEluRmlsZVNpemVTdHJpbmcudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5Gb2xkZXIudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5Gb2xkZXJGb2xkZXJOb3Rlcy50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkZvbGRlcnMudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5GdWxsUGF0aC50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkZ1bGxQYXRoRXh0LnRzIiwgInNyYy9ydWxlcy9idWlsZEluRnVsbFBhdGhFeHRGb2xkZXJOb3Rlcy50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkZ1bGxQYXRoRm9sZGVyTm90ZXMudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5HZXRQcm9wZXJ0eS50cyIsICJzcmMvcnVsZXMvYnVpbGRJbklzUm9vdC50cyIsICJzcmMvcnVsZXMvYnVpbGRJbkxpbmtUb0ZpbGUudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5OYW1lLnRzIiwgInNyYy9ydWxlcy9idWlsZEluTmFtZUV4dC50cyIsICJzcmMvcnVsZXMvYnVpbGRJblBhdGgudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5QYXRoRm9sZGVyTm90ZXMudHMiLCAic3JjL3J1bGVzL2J1aWxkSW5Sb290Rm9sZGVyLnRzIiwgInNyYy9ydWxlcy9idWlsZEluU2NyaXB0LnRzIiwgInNyYy9ydWxlcy9yZXBsYWNlQ2hhcnMudHMiLCAic3JjL3J1bGVzL3JlcGxhY2VTcGFjZXMudHMiLCAic3JjL3J1bGVzL3JlcGxhY2VTcGVjaWFsQ2hhcnMudHMiLCAic3JjL3J1bGVzL3RvQ2FtZWxDYXNlLnRzIiwgInNyYy9ydWxlcy90b0xpbmtNYXJrZG93bi50cyIsICJzcmMvcnVsZXMvdG9MaW5rT3JpZ2luYWwudHMiLCAic3JjL3J1bGVzL3RvTGlua1NpbXBsZS50cyIsICJzcmMvcnVsZXMvdG9MaW5rV2lraS50cyIsICJzcmMvcnVsZXMvdG9Mb3dlckNhc2UudHMiLCAic3JjL3J1bGVzL3RvT3JpZ2luYWwudHMiLCAic3JjL3J1bGVzL3RvUGFzY2FsQ2FzZS50cyIsICJzcmMvcnVsZXMvdG9UaXRsZUNhc2UudHMiLCAic3JjL3J1bGVzL3RvVGl0bGVDYXNlREUudHMiLCAic3JjL3J1bGVzL3RvVGl0bGVDYXNlRU4udHMiLCAic3JjL3J1bGVzL3RvVXBwZXJDYXNlLnRzIiwgInNyYy9ydWxlcy9pbmRleC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIFBsdWdpbiwgTWFya2Rvd25WaWV3LCBNYXJrZG93blBvc3RQcm9jZXNzb3IsIFBsdWdpbk1hbmlmZXN0LCBURmlsZSwgVEZvbGRlciwgVmF1bHQsIHBhcnNlRnJvbnRNYXR0ZXJUYWdzLCBOb3RpY2V9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdUYWIgfSBmcm9tICcuL3NyYy9zZXR0aW5ncyc7XG4vL2ltcG9ydCB7IEZvbGRlclRhZ1NldHRpbmdUYWIgfSBmcm9tICcuL3NyYy9zZXR0aW5ncy1wcm9wZXJ0aWVzJztcbmltcG9ydCB7IGNoZWNrSWZGaWxlQWxsb3dlZCwgZXhlY3V0ZVJ1bGVPYmplY3QgfSBmcm9tICcuL3NyYy9ydWxlcyc7XG5pbXBvcnQgeyBwYXJzZUpTQ29kZSwgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3NyYy90b29scyc7XG5pbXBvcnQgeyB2ZXJzaW9uU3RyaW5nLCBGcm9udG1hdHRlckF1dG9tYXRlU2V0dGluZ3MsIERFRkFVTFRfRlJPTlRNQVRURVJfQVVUT01BVEVfU0VUVElOR1MsIEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIFByb3BlcnR5VHlwZUluZm99IGZyb20gJy4vc3JjL3R5cGVzJ1xuaW1wb3J0IFwiLi9zcmMvcnVsZXMvaW5kZXhcIjtcbmltcG9ydCB7IHJ1bGVzTWFuYWdlciB9IGZyb20gJy4vc3JjL3J1bGVzL3J1bGVzJztcbmltcG9ydCB7IERFQlVHLCBFUlJPUiwgSU5GTywgbG9nZ2VyIH0gZnJvbSAnLi9zcmMvTG9nJztcbmltcG9ydCB7IGxvZyB9IGZyb20gJ2NvbnNvbGUnO1xuaW1wb3J0IHsgVHJlZUhpZXJhcmNoeURhdGEgfSBmcm9tICcuL3NyYy91aVRyZWVIaWVyYXJjaHlTb3J0YWJsZVNldHRpbmdzJztcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvbGRlclRhZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3MhOiBGcm9udG1hdHRlckF1dG9tYXRlU2V0dGluZ3M7XG4gICAgcHJpdmF0ZSB0b29scyE6IFNjcmlwdGluZ1Rvb2xzO1xuICAgIGZpbGVJblByb2dyZXNzOiBURmlsZSB8IG51bGwgPSBudWxsOyAvLyBUcmFjayB0aGUgZmlsZSBjdXJyZW50bHkgYmVpbmcgcHJvY2Vzc2VkXG4gICAgLy9wcml2YXRlIG9sZEZvbGRlclBhdGhzID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZyB8IG51bGw+KCk7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIGxvZ2dlci5sb2coSU5GTyxgRnJvbnQgTWF0dGVyIEF1dG9tYXRlICR7dmVyc2lvblN0cmluZ30gbG9hZGVkIHdpdGggc2V0dGluZ3M6IGAsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBsb2dnZXIuc2V0TGV2ZWwodGhpcy5zZXR0aW5ncy5kZWJ1Z0xldmVsKTtcbiAgICAgICAgdGhpcy50b29scyA9IG5ldyBTY3JpcHRpbmdUb29scyh0aGlzLmFwcCwgdGhpcyk7XG4gICAgICAgIHJ1bGVzTWFuYWdlci5pbml0KHRoaXMuYXBwLCB0aGlzLCB0aGlzLnRvb2xzKTtcbiAgICAgICAgbGV0IG5vdGljZU1lc3NhZ2UgPSBgRnJvbnQgTWF0dGVyIEF1dG9tYXRlICR7dmVyc2lvblN0cmluZ31cXG4gbG9hZGluZyAuLi5gO1xuICAgICAgICBjb25zdCBsb2FkaW5nTm90aWNlID0gbmV3IE5vdGljZShub3RpY2VNZXNzYWdlLDApXG5cbiAgICAgICAgbm90aWNlTWVzc2FnZSA9IG5vdGljZU1lc3NhZ2UgKyAnXFxuIHJlZ2lzdGVyIGV2ZW50cyAuLi4nO1xuICAgICAgICBsb2FkaW5nTm90aWNlLnNldE1lc3NhZ2Uobm90aWNlTWVzc2FnZSk7XG4gICAgICAgIC8vIEZpbGUgY3JlYXRpb24gaGFuZGxlclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgKGZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBFdmVudCBjcmVhdGluZyBmaWxlOiAke2ZpbGUucGF0aH0gc3RhcnRpbmcgaW4gJHt0aGlzLnNldHRpbmdzLmRlbGF5Q3JlYXRlRXZlbnR9bXNgKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUluUHJvZ3Jlc3MgPSBmaWxlOyAvLyBTZXQgdGhlIGZpbGUgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBFdmVudCBjcmVhdGluZyBmaWxlIHN0YXJ0ZWQ6IGAsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycygnY3JlYXRlJywgZmlsZSwgdGhpcy5zZXR0aW5ncy5mb2xkZXJDb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlSW5Qcm9ncmVzcyA9IG51bGw7IC8vIENsZWFyIHRoZSBmaWxlIGluIHByb2dyZXNzIGFmdGVyIHByb2Nlc3NpbmdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAsIHRoaXMuc2V0dGluZ3MuZGVsYXlDcmVhdGVFdmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBGaWxlIHJlbmFtZS9tb3ZlIGhhbmRsZXJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmlsZUluUHJvZ3Jlc3MpIHJldHVybjsgLy8gSWdub3JlIGlmIGZpbGUgaXMgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRnJvbnRtYXR0ZXJQYXJhbWV0ZXJzKCdyZW5hbWUnLCBmaWxlLCB0aGlzLnNldHRpbmdzLmZvbGRlckNvbmZpZywgb2xkUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBGaWxlIGNsb3NlIGhhbmRsZXJcbiAgICAgICAgLypcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsZWFmPy52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBFdmVudCBhY3RpdmUtbGVhZi1jaGFuZ2UgZmlsZTogYCwgYWN0aXZlRmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVGaWxlKSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyUGFyYW1ldGVycygnYWN0aXZlLWxlYWYtY2hhbmdlJywgYWN0aXZlRmlsZSwgdGhpcy5zZXR0aW5ncy5ydWxlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgKi9cbiAgICAgICAgLy8gTWV0YWRhdGEgY2hhbmdlZCBoYW5kbGVyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCBhc3luYyAoZmlsZSwgZGF0YSwgY2FjaGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWxlSW5Qcm9ncmVzcykgcmV0dXJuOyAvLyBJZ25vcmUgaWYgZmlsZSBpcyBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGlmICghY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGUsIHRoaXMuc2V0dGluZ3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coREVCVUcsYGZpbGUgJHtmaWxlLnBhdGh9IGdsb2JhbGx5IHJlamVjdGVkIWApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB8fCBmaWxlLmV4dGVuc2lvbiAhPT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBFdmVudCBtZXRhZGF0YSBjaGFuZ2VkOiAke2ZpbGUucGF0aH0gbm90IGEgbWFya2Rvd24gZmlsZSFgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZmlsZSkgdGhpcy51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoJ21ldGFkYXRhLWNoYW5nZWQnLCBmaWxlLCB0aGlzLnNldHRpbmdzLmZvbGRlckNvbmZpZyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgIG5vdGljZU1lc3NhZ2UgPSBub3RpY2VNZXNzYWdlICsgJ1xcbiBpbml0aWFsIHByb2Nlc3NpbmcgLi4uJztcbiAgICAgICAgbG9hZGluZ05vdGljZS5zZXRNZXNzYWdlKG5vdGljZU1lc3NhZ2UpO1xuICAgICAgICBub3RpY2VNZXNzYWdlID0gbm90aWNlTWVzc2FnZSArICdcXG5kb25lISc7XG4gICAgICAgIGxvYWRpbmdOb3RpY2Uuc2V0TWVzc2FnZShub3RpY2VNZXNzYWdlKTtcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgbG9hZGluZ05vdGljZS5oaWRlKCk7XG4gICAgICAgIH0sMjAwMClcblxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRm9sZGVyVGFnU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0ZST05UTUFUVEVSX0FVVE9NQVRFX1NFVFRJTkdTLCBkYXRhKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZm9ybWF0VGFnTmFtZShuYW1lOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZHtcbiAgICAgICAgaWYgKG5hbWUgPT09IG51bGwpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlyc3QgcmVwbGFjZSBzcGFjZXMgYWNjb3JkaW5nIHRvIHNldHRpbmdzXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSBuYW1lLnJlcGxhY2UoL1xccysvZywgdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRoZW4gcmVwbGFjZSBzcGVjaWFsIGNoYXJhY3RlcnMgKHByZXNlcnZpbmcgbGV0dGVycyB3aXRoIGRpYWNyaXRpY3MpXG4gICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHRoaXMuc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb252ZXJ0IHRvIGxvd2VyY2FzZSBpZiBjb25maWd1cmVkXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmxvd2VyY2FzZVRhZ3MpIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIGZvcm1hdFZhbHVlKHZhbHVlOmFueSwgdHlwZTpzdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd0ZXh0JzpcbiAgICAgICAgICAgIGNhc2UgJ3RhZ3MnOlxuICAgICAgICAgICAgY2FzZSAnYWxpYXNlcyc6XG4gICAgICAgICAgICBjYXNlICdtdWx0aXRleHQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvb2xzLnRvWWFtbFNhZmVTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgY2FzZSAnZGF0ZSc6XG4gICAgICAgICAgICBjYXNlICdkYXRldGltZSc6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPyAndHJ1ZScgOiAnZmFsc2UnO1xuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9vbHMudG9ZYW1sU2FmZVN0cmluZyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoZXZlbnROYW1lOiAnY3JlYXRlJyB8ICdyZW5hbWUnIHwgJ2FjdGl2ZS1sZWFmLWNoYW5nZScgfCAnbWV0YWRhdGEtY2hhbmdlZCcsIGZpbGU6IFRGaWxlLCBydWxlU2V0dGluZ3M6IFRyZWVIaWVyYXJjaHlEYXRhLCBvbGRQYXRoPzogc3RyaW5nKSB7XG4gICAgICAgIGlmICghY2hlY2tJZkZpbGVBbGxvd2VkKGZpbGUsIHRoaXMuc2V0dGluZ3MpKSB7XG4gICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBmaWxlICR7ZmlsZS5wYXRofSBnbG9iYWxseSByZWplY3RlZCFgKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoVGFnID0gdGhpcy5mb3JtYXRUYWdOYW1lKHRoaXMudG9vbHMuZ2V0Rm9sZGVyRnJvbVBhdGgoZmlsZS5wYXRoKSk7XG4gICAgICAgIGNvbnN0IG9sZFBhdGhUYWcgPSB0aGlzLmZvcm1hdFRhZ05hbWUodGhpcy50b29scy5nZXRGb2xkZXJGcm9tUGF0aChvbGRQYXRoKSlcbiAgICAgICAgY29uc3QgcnVsZXMgPSBydWxlU2V0dGluZ3M/LnJvd3MuZmxhdE1hcCgocm93KSA9PiB7XG4gICAgICAgICAgICBpZiAocm93LmZvbGRlcklkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyID0gcnVsZVNldHRpbmdzLmZvbGRlcnMuZmluZCgoZm9sZGVyKSA9PiBmb2xkZXIuaWQgPT09IHJvdy5mb2xkZXJJZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93LmZvbGRlcklkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKEVSUk9SLGBFdmVudCAke2V2ZW50TmFtZX06IEZvbGRlciB3aXRoIGlkICR7cm93LmZvbGRlcklkfSBub3QgZm91bmQgZm9yIHJ1bGUgJHtyb3cucGF5bG9hZC5jb250ZW50fSFgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtyb3cucGF5bG9hZCBhcyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICFmb2xkZXIuZGlzYWJsZWQgPyBbcm93LnBheWxvYWQgYXMgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5nc10gOiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbcm93LnBheWxvYWQgYXMgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5nc107XG4gICAgICAgIH0pID8/IFtdO1xuICAgICAgICBpZiAoIXJ1bGVzIHx8IHJ1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxgRXZlbnQgJHtldmVudE5hbWV9OiBObyBydWxlcyBmb3VuZCBmb3IgZmlsZSAke2ZpbGUucGF0aH1gKTtcbiAgICAgICAgICAgIHJldHVybjsgLy8gTm8gcnVsZXMgdG8gYXBwbHlcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcbiAgICAgICAgICAgIC8vIGFwcGx5IGFsbCBydWxlcyB0byBmcm9udG1hdHRlclxuICAgICAgICAgICAgbG9nZ2VyLmdyb3VwQ29sbGFwc2VkKERFQlVHLGBFdmVudCAke2V2ZW50TmFtZX06IFwiJHtmaWxlLnBhdGh9XCIgJHtydWxlcy5sZW5ndGh9LyR7cnVsZVNldHRpbmdzPy5yb3dzLmxlbmd0aH0gYWN0aXZlIHJ1bGVzLiBPbGQgZmlsZTogXCIke29sZFBhdGh9XCJgLGZyb250bWF0dGVyKTtcbiAgICAgICAgICAgIGxldCBvbGRMb2NhdGlvblJlc3VsdHM6IHtydWxlSWQ6IHN0cmluZywgcmVzdWx0OiBhbnl9W10gPSBbXTtcblxuICAgICAgICAgICAgaWYgKG9sZFBhdGggJiYgb2xkUGF0aCAhPT0gZmlsZS5wYXRoKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmdyb3VwQ29sbGFwc2VkKERFQlVHLGBFdmVudCAke2V2ZW50TmFtZX06IENvbGxlY3RpbmcgcmVzdWx0cyBmb3Igb2xkIGZpbGUgcGF0aDogXCIke29sZFBhdGh9XCJgKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBydWxlIG9mIHJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcnVsZSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSBleGVjdXRlUnVsZU9iamVjdChldmVudE5hbWUsIHRoaXMuYXBwLCB0aGlzLCB0aGlzLnNldHRpbmdzLCB0aGlzLnRvb2xzLmdldE1vY2tGaWxlRnJvbVBhdGgob2xkUGF0aCksIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLCBydWxlLCBmcm9udG1hdHRlcik7XG4gICAgICAgICAgICAgICAgICAgIG9sZExvY2F0aW9uUmVzdWx0cy5wdXNoKHsgcnVsZUlkOiBydWxlLmlkLCByZXN1bHQgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coREVCVUcsYE9sZCBmaWxlIHBhdGggcmVzdWx0czpgLCBvbGRMb2NhdGlvblJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5ncm91cEVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgcnVsZSBvZiBydWxlcykge1xuICAgICAgICAgICAgICAgIGlmICghcnVsZSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5ncm91cENvbGxhcHNlZChERUJVRyxgRXhlY3V0ZSBSdWxlOiAke3J1bGUucHJvcGVydHl9KCR7cnVsZS5jb250ZW50fSlgLHJlc3VsdCwgcnVsZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja0lmRmlsZUFsbG93ZWQoZmlsZSwgdGhpcy5zZXR0aW5ncywgcnVsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxgZmlsZSAke2ZpbGUucGF0aH0gcmVqZWN0ZWQgYnkgcnVsZSAoJHtydWxlLnByb3BlcnR5fXwke3J1bGUuY29udGVudH0pIHNldHRpbmdzYCk7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5ncm91cEVuZCgpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gb25seSBtb2RpZnkgaWYgZmlsZSBpcyBhbGxvd2VkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydWxlLm9ubHlNb2RpZnkgJiYgIWZyb250bWF0dGVyLmhhc093blByb3BlcnR5KHJ1bGUucHJvcGVydHkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coREVCVUcsYGZpbGUgXCIke2ZpbGUucGF0aH1cIiBoYXMgbm90IFwiJHtydWxlLnByb3BlcnR5fVwiKFJ1bGU6JHtydWxlLmNvbnRlbnR9KSBvbmx5TW9kaWZ5IHNldDogc2tpcHBlZGApO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZ3JvdXBFbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIG9ubHkgbW9kaWZ5IGlmIHByb3BlcnR5IGV4aXN0c1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHJ1bGVzTWFuYWdlci5nZXRSdWxlQnlJZChydWxlLmNvbnRlbnQpPy5ydWxlVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZEluJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2NyaXB0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGV4ZWN1dGVSdWxlT2JqZWN0KGV2ZW50TmFtZSwgdGhpcy5hcHAsIHRoaXMsIHRoaXMuc2V0dGluZ3MsIGZpbGUsIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLCBydWxlLCBmcm9udG1hdHRlciwgb2xkTG9jYXRpb25SZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZ3JvdXBFbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvZ2dlci5sb2coREVCVUcsJ0Zyb250bWF0dGVyIHVwZGF0ZWQnLGZyb250bWF0dGVyKTtcbiAgICAgICAgICAgIGxvZ2dlci5ncm91cEVuZCgpO1xuICAgICAgICB9LHsnbXRpbWUnOmZpbGUuc3RhdC5tdGltZX0pOyAvLyBkbyBub3QgY2hhbmdlIHRoZSBtb2RpZnkgdGltZS5cbiAgICB9XG4gICAgLypcbiAgICBhc3luYyByZW1vdmVGcm9udG1hdHRlclBhcmFtc0Zyb21BbGxGaWxlcyhydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzKXtcbiAgICAgICAgbGV0IGNvdW50ID0ge2ZpbGVzOjAsIGl0ZW1zOiAwfVxuICAgICAgICB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgICAgICAgIGNvdW50LmZpbGVzKys7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZyb250bWF0dGVyUGFyYW1ldGVyKGZpbGUsIHJ1bGUsIGNvdW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9XG5cbiAgICBhc3luYyByZW1vdmVGcm9udG1hdHRlclBhcmFtZXRlcihmaWxlOiBURmlsZSwgcnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgY291bnQpIHtcbiAgICAgICAgaWYgKCFjaGVja0lmRmlsZUFsbG93ZWQoZmlsZSwgdGhpcy5zZXR0aW5ncywgcnVsZSkpIHJldHVybjtcbiAgICAgICAgY29uc3QgY3VycmVudFBhdGhUYWcgPSB0aGlzLmZvcm1hdFRhZ05hbWUodGhpcy50b29scy5nZXRGb2xkZXJGcm9tUGF0aChmaWxlLnBhdGgpKTtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmcm9udG1hdHRlcltydWxlLnByb3BlcnR5XSkpIGNvdW50Lml0ZW1zICs9IGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldLmxlbmd0aDtcbiAgICAgICAgICAgIGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldID0gcmVtb3ZlUnVsZSh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncywgZmlsZSwgZnJvbnRtYXR0ZXJbcnVsZS5wcm9wZXJ0eV0sIHJ1bGUsIGZyb250bWF0dGVyKTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZyb250bWF0dGVyW3J1bGUucHJvcGVydHldKSkgY291bnQuaXRlbXMgLT0gZnJvbnRtYXR0ZXJbcnVsZS5wcm9wZXJ0eV0ubGVuZ3RoO1xuICAgICAgICB9LHsnbXRpbWUnOmZpbGUuc3RhdC5tdGltZX0pOyAvLyBkbyBub3QgY2hhbmdlIHRoZSBtb2RpZnkgdGltZS5cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbiAgICAqL1xufVxuIiwgImltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgZm1Ub29scyBmcm9tICcuL2Zyb250bWF0dGVyLXRvb2xzJztcclxuaW1wb3J0IHsgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scyc7XHJcbmltcG9ydCB7IHZlcnNpb25TdHJpbmcsIEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIERFRkFVTFRfUlVMRV9ERUZJTklUSU9OLCBQcm9wZXJ0eVR5cGVJbmZvLCBPYnNpZGlhblByb3BlcnR5VHlwZXN9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSAnLi9hbGVydEJveCc7XHJcbmltcG9ydCB7IG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCwgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7XHJcbmltcG9ydCB7IHJhbmRvbVVVSUQgfSBmcm9tICdjcnlwdG8nO1xyXG5pbXBvcnQgeyBSdWxlc1RhYmxlIH0gZnJvbSAnLi9zZXR0aW5ncy1wcm9wZXJ0aWVzJztcclxuaW1wb3J0IHsgU29ydGFibGVMaXN0Q29tcG9uZW50IH0gZnJvbSAnLi9Tb3J0YWJsZUxpc3RDb21wb25lbnQnO1xyXG5pbXBvcnQgeyBydWxlc01hbmFnZXIgfSBmcm9tICcuL3J1bGVzL3J1bGVzJztcclxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9Mb2cnO1xyXG5pbXBvcnQgeyBsb2cgfSBmcm9tICdjb25zb2xlJztcclxuaW1wb3J0IHsgTWFya2Rvd25IZWxwTW9kYWwgfSBmcm9tICcuL3VpTWFya2Rvd25IZWxwTW9kYWwnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZvbGRlclRhZ1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogYW55OyAvL0ZvbGRlclRhZ1BsdWdpbjtcclxuICAgIHJ1bGVzRGl2ITogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBydWxlc0NvbnRhaW5lciE6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgcnVsZXNDb250cm9sITogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBrbm93blByb3BlcnRpZXMhOiBQcm9wZXJ0eVR5cGVJbmZvW107XHJcbiAgICBrbm93blR5cGVzITogYW55O1xyXG4gICAgc2NyaXB0aW5nVG9vbHMhOiBTY3JpcHRpbmdUb29scztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBhbnkgLypGb2xkZXJUYWdQbHVnaW4qLykge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnNjcmlwdGluZ1Rvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKGFwcCwgcGx1Z2luKTtcclxuICAgIH1cclxuICAgIGhpZGUoKTogdm9pZCB7XHJcbiAgICAgICAgLy8gdXBkYXRlIHRoZSBydWxlcyB0byByZW1vdmUgdGhlIG9uZXMgdGhhdCBhcmUgbm90IGxpdmUgYW55bW9yZVxyXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpdmVSdWxlcz1bXTtcclxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ydWxlcy5mb3JFYWNoKChydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBydWxlRnVuY3Rpb24gPSBydWxlc01hbmFnZXIuZ2V0UnVsZUJ5SWQocnVsZS5jb250ZW50KTtcclxuICAgICAgICAgICAgaWYgKCFydWxlRnVuY3Rpb24pIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKHJ1bGVGdW5jdGlvbi5pc0xpdmVSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saXZlUnVsZXMucHVzaChydWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgLy8gdXBkYXRlIGFjdGl2ZSBmaWxlIGlmIGl0IGlzIG9wZW5cclxuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICBpZiAoYWN0aXZlRmlsZSAmJiBhY3RpdmVGaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVGcm9udG1hdHRlclBhcmFtZXRlcnMoJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIGFjdGl2ZUZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlckNvbmZpZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGZtVG9vbHMuZ2V0UHJvcGVydGllc0Zyb21NZXRhZGF0YU1hbmFnZXIodGhpcy5hcHApO1xyXG4gICAgICAgIHRoaXMua25vd25UeXBlcyA9IGZtVG9vbHMuZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKHRoaXMuYXBwKTtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoYEZyb250IG1hdHRlciBhdXRvbWF0ZSBWJHt2ZXJzaW9uU3RyaW5nfWApXHJcbiAgICAgICAgICAgIC5zZXREZXNjKGBUaGlzIHBsdWdpbiBhdXRvbWF0ZXMgdGhlIG1hbmFnZW1lbnQgb2YgZnJvbnQgbWF0dGVyIGluIHlvdXIgT2JzaWRpYW4gbm90ZXMuIEl0IGFsbG93cyB5b3UgdG8gc2V0IHJ1bGVzIGZvciBhdXRvbWF0aWNhbGx5IGFkZGluZywgbW9kaWZ5aW5nLCBvciByZW1vdmluZyBmcm9udCBtYXR0ZXIgcHJvcGVydGllcyBiYXNlZCBvbiB2YXJpb3VzIGV2ZW50cyBsaWtlIGZpbGUgY3JlYXRpb24sIHJlbmFtaW5nLCBvciBhY3RpdmUgbGVhZiBjaGFuZ2VzLmApXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oXCJjaXJjbGUtaGVscFwiKVxyXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJPbmxpbmUgSGVscFwiKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXJrZG93biA9IFwiQ291bGQgbm90IGxvYWQgaGVscCBmcm9tIEdpdEh1Yi5cIjtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgTWFya2Rvd25IZWxwTW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luLCBtYXJrZG93biwgXCJyZWFkbWUubWRcIikub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0V4Y2x1ZGUgRmlsZXMgYW5kIEZvbGRlcnMgZ2xvYmFsbHknKVxyXG4gICAgICAgIC5zZXREZXNjKGBDdXJyZW50bHkgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGh9IGZvbGRlcnMgYW5kICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aH0gZmlsZXMgd2lsbCBiZSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUubW9kZX1kLmApXHJcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXIteCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnRXhjbHVkZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGUgfHwgJ2V4Y2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU1vZGU6IHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuZGlzcGxheSB8fCAnZm9sZGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblNob3dGaWxlczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlLm1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7ICBcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgRmlsZXMgYW5kIEZvbGRlcnMgZ2xvYmFsbHknKVxyXG4gICAgICAgIC5zZXREZXNjKGBDdXJyZW50bHkgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGh9IGZvbGRlcnMgYW5kICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aH0gZmlsZXMgd2lsbCBiZSAke3RoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUubW9kZX1kIGV2ZW4gaWYgdGhleSBhcmUgZXhjbHVkZWQuYClcclxuICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ2ZvbGRlci1jaGVjaycpXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnSW5jbHVkZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGUgfHwgJ2luY2x1ZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU1vZGU6IHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuZGlzcGxheSB8fCAnZm9sZGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblNob3dGaWxlczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzID0gcmVzdWx0LmZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlLm1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7ICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVidWcnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnU2VsZWN0IHRoZSBkZWJ1ZyBsZXZlbCB0byBzaG93IGluIHRoZSBjb25zb2xlJylcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbnMoXHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmZyb21FbnRyaWVzKGxvZ2dlci5nZXRMZXZlbE5hbWVzKCkubWFwKGxldmVsID0+IFtsZXZlbCwgbGV2ZWxdKSlcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZShsb2dnZXIuZ2V0TGV2ZWxOYW1lKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTGV2ZWwpKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdMZXZlbCA9IGxvZ2dlci5nZXRMZXZlbEJ5TmFtZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLnNldExldmVsKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTGV2ZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICBcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlbGF5IGNyZWF0ZSBldmVudCAodW50aWwgYmV0dGVyIHNvbHV0aW9uIGlzIGZvdW5kKScpIC8vVE9ETzogcmVtb3ZlIHRoaXMgc2V0dGluZyB3aGVuIGEgYmV0dGVyIHNvbHV0aW9uIGlzIGZvdW5kXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdTZXQgYSBkZWxheSBiZWZvcmUgdHJpZ2dlcmluZyB0aGUgY3JlYXRlIGV2ZW50IHRvIGFsbG93IGZvciBmaWxlIGNyZWF0aW9uIHRvIGNvbXBsZXRlLiAoaW4gbWlsbGlzZWNvbmRzKScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWxheUNyZWF0ZUV2ZW50LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgdGV4dC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWxheUNyZWF0ZUV2ZW50ID0gcGFyc2VJbnQodmFsdWUpIHx8IDA7IC8vIEVuc3VyZSBpdCdzIGEgbnVtYmVyXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5ydWxlc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigncHJvcGVydGllcy1saXN0Jyk7XHJcbiAgICAgICAgY29uc3QgcnVsZXNUYWJsZSA9IG5ldyBSdWxlc1RhYmxlKHRoaXMuYXBwLCB0aGlzLnBsdWdpbix0aGlzLnJ1bGVzQ29udGFpbmVyLHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlckNvbmZpZyk7XHJcbiAgICAgICAgcnVsZXNUYWJsZS5kaXNwbGF5KCk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBCYWNrdXAgYW5kIFJlc3RvcmUgQnV0dG9ucyAtLS1cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJCYWNrdXAgJiBSZXN0b3JlIENvbmZpZ3VyYXRpb25cIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJFeHBvcnQgeW91ciBjdXJyZW50IGNvbmZpZyBhcyBhIEpTT04gZmlsZSBvciByZXN0b3JlIGZyb20gYSBiYWNrdXAuXCIpXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KFwiQmFja3VwXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJkb3dubG9hZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YVN0ciA9IEpTT04uc3RyaW5naWZ5KHRoaXMucGx1Z2luLnNldHRpbmdzLCBudWxsLCAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhU3RyXSwgeyB0eXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5ocmVmID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmRvd25sb2FkID0gXCJmcm9udG1hdHRlci1hdXRvbWF0ZS1iYWNrdXAuanNvblwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoXCJSZXN0b3JlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJ1cGxvYWRcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC50eXBlID0gXCJmaWxlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmFjY2VwdCA9IFwiLmpzb24sYXBwbGljYXRpb24vanNvblwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5wdXQuZmlsZXMgfHwgaW5wdXQuZmlsZXMubGVuZ3RoID09PSAwKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gaW5wdXQuZmlsZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZmlsZS50ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wdGlvbmFsbHkgdmFsaWRhdGUgZGF0YSBoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGcm9udG1hdHRlciBBdXRvbWF0ZVxcbkNvbmZpZ3VyYXRpb24gcmVzdG9yZWQgZnJvbSBiYWNrdXAuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGcm9udG1hdHRlciBBdXRvbWF0ZVxcbkZhaWxlZCB0byByZXN0b3JlOiBJbnZhbGlkIEpTT04gZmlsZS5cIiwyMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eVR5cGVJbmZvLCBQcm9wZXJ0eVR5cGUsIE9ic2lkaWFuUHJvcGVydHlUeXBlc30gZnJvbSAnLi90eXBlcyc7XHJcbmltcG9ydCB7IERFQlVHLCBFUlJPUiwgbG9nZ2VyIH0gZnJvbSAnLi9Mb2cnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUFJPUEVSVFlfVFlQRV9JTkZPOiBQcm9wZXJ0eVR5cGVJbmZvID0ge1xyXG4gICAgbmFtZSA6IFwiXCIsXHJcbiAgICB0eXBlIDogJ3RleHQnLFxyXG4gICAgaXNBcnJheTogZmFsc2UsXHJcbiAgICB2YWx1ZXM6IFtdLFxyXG4gICAgc291cmNlOiAncmVnaXN0ZXJlZCcsXHJcbn07XHJcblxyXG4vKipcclxuICogR2V0cyBhbGwgYXZhaWxhYmxlIHByb3BlcnRpZXMgd2l0aCB0aGVpciB0eXBlIGluZm9ybWF0aW9uXHJcbiAqIEBwYXJhbSBhcHAgVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZVxyXG4gKiBAcmV0dXJucyBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gYXJyYXkgb2YgUHJvcGVydHlUeXBlSW5mb1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb3BlcnRpZXNXaXRoVHlwZXMoYXBwOiBBcHApOiBQcm9taXNlPFByb3BlcnR5VHlwZUluZm9bXT4ge1xyXG4gICAgLy8gVHJ5IHRvIGdldCByZWdpc3RlcmVkIHByb3BlcnRpZXMgKGZhbGxiYWNrIHRvIGVtcHR5IGFycmF5IGlmIEFQSSBjaGFuZ2VkKVxyXG4gICAgY29uc3QgcmVnaXN0ZXJlZFByb3BzID0gYXdhaXQgZ2V0UmVnaXN0ZXJlZFByb3BlcnRpZXNTYWZlKGFwcCk7XHJcbiAgICBcclxuICAgIC8vIEdldCBhZGRpdGlvbmFsIHByb3BlcnRpZXMgZm91bmQgaW4gbm90ZXNcclxuICAgIGNvbnN0IGZpbGVQcm9wcyA9IGF3YWl0IGdldFByb3BlcnRpZXNGcm9tRmlsZXMoYXBwKTtcclxuICAgIFxyXG4gICAgLy8gQ29tYmluZSByZXN1bHRzIChmYXZvciByZWdpc3RlcmVkIHByb3BlcnRpZXMgd2hlbiBkdXBsaWNhdGVzIGV4aXN0KVxyXG4gICAgY29uc3QgY29tYmluZWQgPSBuZXcgTWFwPHN0cmluZywgUHJvcGVydHlUeXBlSW5mbz4oKTtcclxuICAgIFxyXG4gICAgLy8gQWRkIHByb3BlcnRpZXMgZm91bmQgaW4gZmlsZXMgZmlyc3RcclxuICAgIGZpbGVQcm9wcy5mb3JFYWNoKHByb3AgPT4ge1xyXG4gICAgICAgIGNvbWJpbmVkLnNldChwcm9wLm5hbWUsIHByb3ApO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIFRoZW4gb3ZlcnJpZGUgd2l0aCByZWdpc3RlcmVkIHByb3BlcnRpZXMgKHdoaWNoIGhhdmUgbW9yZSBjb21wbGV0ZSB0eXBlIGluZm8pXHJcbiAgICByZWdpc3RlcmVkUHJvcHMuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgICBjb21iaW5lZC5zZXQocHJvcC5uYW1lLCBwcm9wKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShjb21iaW5lZC52YWx1ZXMoKSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgUHJvcGVydGllcyBmcm9tIE1ldGFkYXRhTWFuYWdlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3BlcnRpZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKGFwcDogQXBwKTogUHJvcGVydHlUeXBlSW5mb1tdIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxcImdldCBwcm9wZXJ0aWVzOlwiLG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobWV0YWRhdGFNYW5hZ2VyLnByb3BlcnRpZXMpLm1hcCggKHZhbHVlOmFueSk6UHJvcGVydHlUeXBlSW5mbyA9PiAoe1xyXG4gICAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxyXG4gICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXHJcbiAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgfSkpLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBsb2dnZXIubG9nKEVSUk9SLFwiQ291bGRuJ3QgYWNjZXNzIHByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YSBNYW5hZ2VyXCIsIGUpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IFR5cGVzIGZyb20gTWV0YWRhdGFNYW5hZ2VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHlwZXNGcm9tTWV0YWRhdGFNYW5hZ2VyKGFwcDogQXBwKTogYW55IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWV0YWRhdGFNYW5hZ2VyID0gKGFwcCBhcyBhbnkpLm1ldGFkYXRhVHlwZU1hbmFnZXI7XHJcbiAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxcImdldCB0eXBlczpcIixtZXRhZGF0YU1hbmFnZXIpO1xyXG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKG1ldGFkYXRhTWFuYWdlci5yZWdpc3RlcmVkVHlwZVdpZGdldHMpLm1hcCggKHZhbHVlOmFueSwgaW5kZXgsIGFycmF5KTpQcm9wZXJ0eVR5cGUgID0+ICh7XHJcbiAgICAgICAgICAgIHR5cGU6IHZhbHVlLnR5cGUsXHJcbiAgICAgICAgICAgIGljb246IHZhbHVlLmljb24sXHJcbiAgICAgICAgICAgIGpzVHlwZTogJycsXHJcbiAgICAgICAgfSkpLnNvcnQoKGEsIGIpID0+IGEudHlwZS5sb2NhbGVDb21wYXJlKGIudHlwZSkpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBsb2dnZXIubG9nKEVSUk9SLFwiQ291bGRuJ3QgYWNjZXNzIHByb3BlcnRpZXMgZnJvbSBNZXRhZGF0YSBNYW5hZ2VyXCIsIGUpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogU2FmZSBtZXRob2QgdG8gZ2V0IHJlZ2lzdGVyZWQgcHJvcGVydGllcyB0aGF0IHdvbid0IHRocm93IGlmIEFQSSBjaGFuZ2VzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRSZWdpc3RlcmVkUHJvcGVydGllc1NhZmUoYXBwOiBBcHApOiBQcm9taXNlPFByb3BlcnR5VHlwZUluZm9bXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YU1hbmFnZXIgPSAoYXBwIGFzIGFueSkubWV0YWRhdGFUeXBlTWFuYWdlcjtcclxuICAgICAgICBsb2dnZXIubG9nKERFQlVHLG1ldGFkYXRhTWFuYWdlcik7XHJcbiAgICAgICAgaWYgKCFtZXRhZGF0YU1hbmFnZXIpIHJldHVybiBbXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBUcnkgZGlmZmVyZW50IHdheXMgdG8gZ2V0IHByb3BlcnRpZXMgYmFzZWQgb24gT2JzaWRpYW4gdmVyc2lvblxyXG4gICAgICAgIGlmICh0eXBlb2YgbWV0YWRhdGFNYW5hZ2VyLmdldEFsbEZyb250bWF0dGVyVHlwZXMgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgLy8gT2xkZXIgT2JzaWRpYW4gdmVyc2lvbnNcclxuICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJUeXBlcyA9IG1ldGFkYXRhTWFuYWdlci5nZXRBbGxGcm9udG1hdHRlclR5cGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmcm9udG1hdHRlclR5cGVzLm1hcCgobmFtZTogc3RyaW5nKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywgLy8gRGVmYXVsdCB0eXBlIGlmIHdlIGNhbid0IGdldCBtb3JlIGluZm9cclxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3JlZ2lzdGVyZWQnXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXRhZGF0YU1hbmFnZXIuZ2V0UHJvcGVydGllcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAvLyBOZXdlciBPYnNpZGlhbiB2ZXJzaW9ucyBtaWdodCB1c2UgdGhpc1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbWV0YWRhdGFNYW5hZ2VyLmdldFByb3BlcnRpZXMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpLm1hcCgoW25hbWUsIHR5cGVdOiBbc3RyaW5nLCBhbnldKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdyZWdpc3RlcmVkJ1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGxvZ2dlci5sb2coRVJST1IsXCJDb3VsZG4ndCBhY2Nlc3MgcmVnaXN0ZXJlZCBwcm9wZXJ0aWVzOlwiLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNjYW5zIGZpbGVzIGZvciBhZGRpdGlvbmFsIHByb3BlcnRpZXMgd2l0aCB0eXBlIGluZmVyZW5jZVxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvcGVydGllc0Zyb21GaWxlcyhhcHA6IEFwcCk6IFByb21pc2U8UHJvcGVydHlUeXBlSW5mb1tdPiB7XHJcbiAgICBjb25zdCBmaWxlcyA9IGFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICBjb25zdCBwcm9wZXJ0eU1hcCA9IG5ldyBNYXA8c3RyaW5nLCB7IHZhbHVlczogU2V0PGFueT4sIHR5cGVzOiBTZXQ8c3RyaW5nPiB9PigpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMuc2xpY2UoMCwgMTAwMCkpIHsgLy8gTGltaXQgdG8gMTAwMCBmaWxlcyBmb3IgcGVyZm9ybWFuY2VcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3Bvc2l0aW9uJykgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9wZXJ0eU1hcC5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eU1hcC5zZXQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IG5ldyBTZXQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzOiBuZXcgU2V0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BEYXRhID0gcHJvcGVydHlNYXAuZ2V0KGtleSkhO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BEYXRhLnZhbHVlcy5hZGQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BEYXRhLnR5cGVzLmFkZChpbmZlclR5cGVGcm9tVmFsdWUodmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIEFycmF5LmZyb20ocHJvcGVydHlNYXAuZW50cmllcygpKS5tYXAoKFtuYW1lLCBkYXRhXSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHR5cGUgPSBkZXRlcm1pbmVQcmltYXJ5VHlwZShkYXRhLnR5cGVzKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICB0eXBlLFxyXG4gICAgICAgICAgICBpc0FycmF5OiBkYXRhLnR5cGVzLmhhcygnYXJyYXknKSxcclxuICAgICAgICAgICAgdmFsdWVzOiBkYXRhLnZhbHVlcy5zaXplID4gMCA/IEFycmF5LmZyb20oZGF0YS52YWx1ZXMpLm1hcChTdHJpbmcpIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBzb3VyY2U6ICdpbmZlcnJlZCdcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZXRlcm1pbmVzIHRoZSBwcmltYXJ5IHR5cGUgZnJvbSBhIFNldCBvZiBvYnNlcnZlZCB0eXBlc1xyXG4gKiBAcGFyYW0gdHlwZXMgU2V0IG9mIG9ic2VydmVkIHR5cGVzIGZvciBhIHByb3BlcnR5XHJcbiAqIEByZXR1cm5zIFRoZSBtb3N0IHNwZWNpZmljIHR5cGUgd2UgY2FuIGRldGVybWluZVxyXG4gKi9cclxuZnVuY3Rpb24gZGV0ZXJtaW5lUHJpbWFyeVR5cGUodHlwZXM6IFNldDxzdHJpbmc+KTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzIHtcclxuICAgIC8vIEhhbmRsZSBlbXB0eSBjYXNlIChzaG91bGRuJ3QgaGFwcGVuIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIHVzIHRvIGNoZWNrKVxyXG4gICAgaWYgKHR5cGVzLnNpemUgPT09IDApIHJldHVybiAndGV4dCc7XHJcbiAgICBcclxuICAgIC8vIElmIG9ubHkgb25lIHR5cGUgb2JzZXJ2ZWQsIHVzZSB0aGF0XHJcbiAgICBpZiAodHlwZXMuc2l6ZSA9PT0gMSkge1xyXG4gICAgICAgIGNvbnN0IG9ubHlUeXBlID0gdHlwZXMudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xyXG4gICAgICAgIHJldHVybiAob25seVR5cGUgIT09IHVuZGVmaW5lZCA/IG9ubHlUeXBlIDogJ3RleHQnKSBhcyBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByaW9yaXR5IG9yZGVyIGZvciB0eXBlIHJlc29sdXRpb25cclxuICAgIGNvbnN0IHR5cGVQcmlvcml0eTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzW10gPSBbXHJcbiAgICAgICAgJ2RhdGUnLFxyXG4gICAgICAgICdkYXRldGltZScsXHJcbiAgICAgICAgJ2NoZWNrYm94JyxcclxuICAgICAgICAnbnVtYmVyJyxcclxuICAgICAgICAndGFncycsXHJcbiAgICAgICAgJ2FsaWFzZXMnLFxyXG4gICAgICAgICdtdWx0aXRleHQnLFxyXG4gICAgICAgICd0ZXh0JyAvLyBmYWxsYmFja1xyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIHRoZSBoaWdoZXN0IHByaW9yaXR5IHR5cGUgd2UgZmluZFxyXG4gICAgZm9yIChjb25zdCB0eXBlIG9mIHR5cGVQcmlvcml0eSkge1xyXG4gICAgICAgIGlmICh0eXBlcy5oYXModHlwZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGaW5hbCBmYWxsYmFja1xyXG4gICAgcmV0dXJuICd0ZXh0JztcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIHR5cGUgaW5mZXJlbmNlIHdpdGggYmV0dGVyIGRhdGUgZGV0ZWN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmZlclR5cGVGcm9tVmFsdWUodmFsdWU6IGFueSk6IHN0cmluZyB7XHJcbiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiAnbnVsbCc7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGFycmF5IGZpcnN0XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBhcnJheSBlbGVtZW50IHR5cGVzXHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRUeXBlcyA9IG5ldyBTZXQodmFsdWUubWFwKGluZmVyVHlwZUZyb21WYWx1ZSkpO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudFR5cGVzLnNpemUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgYXJyYXk8JHtlbGVtZW50VHlwZXMudmFsdWVzKCkubmV4dCgpLnZhbHVlfT5gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAnYXJyYXknO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBiYXNpYyB0eXBlc1xyXG4gICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcclxuICAgICAgICBjYXNlICdib29sZWFuJzogcmV0dXJuICdib29sZWFuJztcclxuICAgICAgICBjYXNlICdudW1iZXInOiByZXR1cm4gJ251bWJlcic7XHJcbiAgICAgICAgY2FzZSAnb2JqZWN0JzogcmV0dXJuICdvYmplY3QnOyAvLyBmb3IgZnV0dXJlIGV4cGFuc2lvblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBNdXN0IGJlIHN0cmluZyBhdCB0aGlzIHBvaW50IC0gY2hlY2sgZm9yIHNwZWNpYWwgc3RyaW5nIGZvcm1hdHNcclxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy8gSVNPIERhdGUgKFlZWVktTU0tREQpXHJcbiAgICAgICAgaWYgKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLy50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2RhdGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBJU08gRGF0ZVRpbWVcclxuICAgICAgICBpZiAoL15cXGR7NH0tXFxkezJ9LVxcZHsyfVtUIF1cXGR7Mn06XFxkezJ9OlxcZHsyfS8udGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdkYXRldGltZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE9ic2lkaWFuIHRhZ1xyXG4gICAgICAgIGlmICh2YWx1ZS5zdGFydHNXaXRoKCcjJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuICd0YWcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGVmYXVsdCB0byBzdHJpbmdcclxuICAgIHJldHVybiAnc3RyaW5nJztcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsdWUodmFsdWU6IHVua25vd24sIGluZGV4OiBudW1iZXIsIGFycmF5OiB1bmtub3duW10pOiB1bmtub3duIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignRnVuY3Rpb24gbm90IGltcGxlbWVudGVkLicpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2VsZWN0UHJvcGVydHkgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8UHJvcGVydHlUeXBlSW5mbz4ge1xyXG4gICAgcHJpdmF0ZSBvblN1Ym1pdDogKHJlc3VsdDogUHJvcGVydHlUeXBlSW5mbykgPT4gdm9pZDtcclxuICAgIHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvIHwgdW5kZWZpbmVkO1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOlByb3BlcnR5VHlwZUluZm9bXTtcclxuICAgIHR5cGVkVGV4dDogc3RyaW5nO1xyXG4gICAgbmV3VGV4dEZsYWc6IEJvb2xlYW47XHJcblxyXG4gICAgY29uc3RydWN0b3IgKGFwcDpBcHAsIGtub3duUHJvcGVydGllczpQcm9wZXJ0eVR5cGVJbmZvW10sIHByb3BlcnR5OiBQcm9wZXJ0eVR5cGVJbmZvIHwgdW5kZWZpbmVkLCBvblN1Ym1pdDogKHJlc3VsdDogUHJvcGVydHlUeXBlSW5mbykgPT4gdm9pZCkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xyXG4gICAgICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcclxuICAgICAgICB0aGlzLnR5cGVkVGV4dCA9ICcnO1xyXG4gICAgICAgIHRoaXMubmV3VGV4dEZsYWcgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMua25vd25Qcm9wZXJ0aWVzID0ga25vd25Qcm9wZXJ0aWVzO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJucyBhbGwgYXZhaWxhYmxlIHN1Z2dlc3Rpb25zLlxyXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFByb3BlcnR5VHlwZUluZm9bXSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5rbm93blByb3BlcnRpZXMuZmlsdGVyKChwcm9wZXJ0eSkgPT4gcHJvcGVydHkubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKTtcclxuICAgICAgICB0aGlzLm5ld1RleHRGbGFnID0gKHJlc3VsdC5sZW5ndGggPT09IDApO1xyXG4gICAgICAgIHRoaXMudHlwZWRUZXh0ID0gcXVlcnk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIG9uT3BlbigpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKHRoaXMucHJvcGVydHkubmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignbm8gcHJvcGVydHkgc2VsZWN0ZWQhJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0VGl0bGUoJ1NlbGVjdCBvciB0eXBlIGEgcHJvcGVydHkgbmFtZScpO1xyXG4gICAgfVxyXG4gICAgLy8gUmVuZGVycyBlYWNoIHN1Z2dlc3Rpb24gaXRlbS5cclxuICAgIHJlbmRlclN1Z2dlc3Rpb24ocHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8sIGVsOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICBlbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBwcm9wZXJ0eS5uYW1lIH0pO1xyXG4gICAgICBlbC5jcmVhdGVFbCgnc21hbGwnLCB7IHRleHQ6IHByb3BlcnR5LnR5cGUgfSk7XHJcbiAgICB9XHJcbiAgICBvbkNsb3NlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLm5ld1RleHRGbGFnICYmIHRoaXMucHJvcGVydHkpIHtcclxuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lID0gdGhpcy50eXBlZFRleHQ7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcGVydHkudHlwZSA9ICd0ZXh0JztcclxuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLnByb3BlcnR5KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGVyZm9ybSBhY3Rpb24gb24gdGhlIHNlbGVjdGVkIHN1Z2dlc3Rpb24uXHJcbiAgICBvbkNob29zZVN1Z2dlc3Rpb24ocHJvcGVydHk6IFByb3BlcnR5VHlwZUluZm8sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZ0IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLGBrZXlib2FyZCAke3RoaXMudHlwZWRUZXh0fSAke3RoaXMubmV3VGV4dEZsYWd9YCwgcHJvcGVydHkpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci5sb2coREVCVUcsJ29uQ2hvb3NlU3VnZ2VzdGlvbicsIGV2dClcclxuICAgICAgICB0aGlzLm9uU3VibWl0KHByb3BlcnR5KTtcclxuICAgIH1cclxuICB9XHJcbiIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEVycm9yTWFuYWdlciB9IGZyb20gXCIuL0Vycm9yXCI7XG5cbi8vIE51bWVyaWMgbG9nIGxldmVscyBmb3IgZWFzeSBjb21wYXJpc29uIGFuZCB1c2FnZVxuZXhwb3J0IGNvbnN0IExPRyA9IDA7XG5leHBvcnQgY29uc3QgQUxFUlQgPSAxO1xuZXhwb3J0IGNvbnN0IEVSUk9SID0gMjtcbmV4cG9ydCBjb25zdCBXQVJOSU5HID0gMztcbmV4cG9ydCBjb25zdCBJTkZPID0gNDtcbmV4cG9ydCBjb25zdCBERUJVRyA9IDU7XG5leHBvcnQgY29uc3QgVFJBQ0UgPSA2O1xuXG5leHBvcnQgdHlwZSBMb2dMZXZlbCA9IDAgfCAxIHwgMiB8IDMgfCA0IHwgNSB8IDY7XG5cbmV4cG9ydCBlbnVtIExvZ0RldmljZXMge1xuICAgIENPTlNPTEUgPSBcImNvbnNvbGVcIixcbiAgICBOT1RJRklDQVRJT04gPSBcIm5vdGlmaWNhdGlvblwiLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nVXBkYXRlKG1zZzogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3Qgbm90aWNlID0gbmV3IE5vdGljZShcIlwiLCAxNTAwMCk7XG4gICAgbm90aWNlLm1lc3NhZ2VFbC5pbm5lckhUTUwgPSBgPGI+RnJvbnRtYXR0ZXIgQXV0b21hdGUgdXBkYXRlPC9iPjo8YnIvPiR7bXNnfWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dFcnJvcihlOiBFcnJvciB8IEVycm9yTWFuYWdlcik6IHZvaWQge1xuICAgIGNvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UoXCJcIiwgODAwMCk7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBFcnJvck1hbmFnZXIgJiYgZS5jb25zb2xlX21zZykge1xuICAgICAgICBub3RpY2UubWVzc2FnZUVsLmlubmVySFRNTCA9IGA8Yj5Gcm9udG1hdHRlciBBdXRvbWF0ZSBFcnJvcjwvYj46PGJyLz4ke2UubWVzc2FnZX08YnIvPkNoZWNrIGNvbnNvbGUgZm9yIG1vcmUgaW5mb3JtYXRpb25gO1xuICAgICAgICBjb25zb2xlLmVycm9yKGBGcm9udG1hdHRlciBFcnJvcjpgLCBlLm1lc3NhZ2UsIFwiXFxuXCIsIGUuY29uc29sZV9tc2cpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdGljZS5tZXNzYWdlRWwuaW5uZXJIVE1MID0gYDxiPkZyb250bWF0dGVyIEF1dG9tYXRlIEVycm9yPC9iPjo8YnIvPiR7ZS5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcbiAgICBwcml2YXRlIGxvZ0xldmVsOiBMb2dMZXZlbCA9IElORk87XG5cbiAgICBzZXRMZXZlbChsZXZlbDogc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbGV2ZWwgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMubG9nTGV2ZWwgPSBsZXZlbCBhcyBMb2dMZXZlbDtcbiAgICAgICAgICAgIHRoaXMubG9nKExPRywgYExvZyBsZXZlbCBzZXQgdG8gJHt0aGlzLmdldExldmVsTmFtZSh0aGlzLmxvZ0xldmVsKX1gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGxldmVsTmFtZSA9IGxldmVsLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBsZXZlbEluZGV4ID0gdGhpcy5nZXRMZXZlbE5hbWVzKCkuaW5kZXhPZihsZXZlbE5hbWUpICsgMSBhcyBMb2dMZXZlbDtcbiAgICAgICAgICAgIGlmIChsZXZlbEluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldExldmVsKGxldmVsSW5kZXgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhXQVJOSU5HLGBJbnZhbGlkIGxvZyBsZXZlbCBuYW1lOiAke2xldmVsTmFtZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldExldmVsKCk6IExvZ0xldmVsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9nTGV2ZWw7XG4gICAgfVxuXG4gICAgZ2V0TGV2ZWxCeU5hbWUobGV2ZWxOYW1lOiBzdHJpbmcpOiBMb2dMZXZlbCB7XG4gICAgICAgIGNvbnN0IGxldmVsSW5kZXggPSB0aGlzLmdldExldmVsTmFtZXMoKS5pbmRleE9mKGxldmVsTmFtZS50b1VwcGVyQ2FzZSgpKSArIDE7XG4gICAgICAgIGlmIChsZXZlbEluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHJldHVybiBsZXZlbEluZGV4IGFzIExvZ0xldmVsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2coV0FSTklORyxgSW52YWxpZCBsb2cgbGV2ZWwgbmFtZTogJHtsZXZlbE5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gSU5GTzsgLy8gRGVmYXVsdCB0byBJTkZPIGlmIGludmFsaWRcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRMZXZlbEJ5SW5kZXgobGV2ZWxJbmRleDogbnVtYmVyKTogTG9nTGV2ZWwge1xuICAgICAgICBpZiAobGV2ZWxJbmRleCA+PSBBTEVSVCAmJiBsZXZlbEluZGV4IDw9IFRSQUNFKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV2ZWxJbmRleCBhcyBMb2dMZXZlbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nKFdBUk5JTkcsYEludmFsaWQgbG9nIGxldmVsIGluZGV4OiAke2xldmVsSW5kZXh9YCk7XG4gICAgICAgICAgICByZXR1cm4gSU5GTzsgLy8gRGVmYXVsdCB0byBJTkZPIGlmIGludmFsaWRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldExldmVsQnlWYWx1ZShsZXZlbFZhbHVlOiBudW1iZXIpOiBMb2dMZXZlbCB7XG4gICAgICAgIGlmIChsZXZlbFZhbHVlID49IEFMRVJUICYmIGxldmVsVmFsdWUgPD0gVFJBQ0UpIHtcbiAgICAgICAgICAgIHJldHVybiBsZXZlbFZhbHVlIGFzIExvZ0xldmVsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2coV0FSTklORyxgSW52YWxpZCBsb2cgbGV2ZWwgdmFsdWU6ICR7bGV2ZWxWYWx1ZX1gKTtcbiAgICAgICAgICAgIHJldHVybiBJTkZPOyAvLyBEZWZhdWx0IHRvIElORk8gaWYgaW52YWxpZFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG91bGRMb2cobGV2ZWw6IExvZ0xldmVsKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChsZXZlbCA9PT0gMCkgcmV0dXJuIHRydWU7IC8vIEFsd2F5cyBsb2cgbGV2ZWwgMFxuICAgICAgICByZXR1cm4gbGV2ZWwgPD0gdGhpcy5sb2dMZXZlbDtcbiAgICB9XG5cbiAgICBnZXRMZXZlbE5hbWUobGV2ZWw6IExvZ0xldmVsKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChsZXZlbCkge1xuICAgICAgICAgICAgY2FzZSBBTEVSVDogcmV0dXJuIFwiQUxFUlRcIjtcbiAgICAgICAgICAgIGNhc2UgRVJST1I6IHJldHVybiBcIkVSUk9SXCI7XG4gICAgICAgICAgICBjYXNlIFdBUk5JTkc6IHJldHVybiBcIldBUk5JTkdcIjtcbiAgICAgICAgICAgIGNhc2UgSU5GTzogcmV0dXJuIFwiSU5GT1wiO1xuICAgICAgICAgICAgY2FzZSBERUJVRzogcmV0dXJuIFwiREVCVUdcIjtcbiAgICAgICAgICAgIGNhc2UgVFJBQ0U6IHJldHVybiBcIlRSQUNFXCI7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gXCJMT0dcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldExldmVsTmFtZXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gKFtBTEVSVCwgRVJST1IsIFdBUk5JTkcsIElORk8sIERFQlVHLCBUUkFDRV0gYXMgTG9nTGV2ZWxbXSkubWFwKGxldmVsID0+IHRoaXMuZ2V0TGV2ZWxOYW1lKGxldmVsKSk7XG4gICAgfVxuICAgIFxuICAgIGxvZyhsZXZlbDogTG9nTGV2ZWwsIC4uLm1zZzogYW55W10pOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZExvZyhsZXZlbCkpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsZXZlbE5hbWUgPSB0aGlzLmdldExldmVsTmFtZShsZXZlbCk7XG4gICAgICAgIGxldCBjb2xvciA9IFwiXCI7XG4gICAgICAgIHN3aXRjaCAobGV2ZWwpIHtcbiAgICAgICAgICAgIGNhc2UgQUxFUlQ6ICAgY29sb3IgPSBcImJhY2tncm91bmQ6ICNkMzJmMmY7IGNvbG9yOiB3aGl0ZTsgZm9udC13ZWlnaHQ6IGJvbGRcIjsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEVSUk9SOiAgIGNvbG9yID0gXCJjb2xvcjogI2QzMmYyZjsgZm9udC13ZWlnaHQ6IGJvbGRcIjsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFdBUk5JTkc6IGNvbG9yID0gXCJjb2xvcjogI2ZiYzAyZDsgZm9udC13ZWlnaHQ6IGJvbGRcIjsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIElORk86ICAgIGNvbG9yID0gXCJjb2xvcjogIzE5NzZkMjsgZm9udC13ZWlnaHQ6IGJvbGRcIjsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIERFQlVHOiAgIGNvbG9yID0gXCJjb2xvcjogIzM4OGUzYztcIjsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFRSQUNFOiAgIGNvbG9yID0gXCJjb2xvcjogIzYxNjE2MTtcIjsgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OiAgICAgIGNvbG9yID0gXCJcIjsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHJlZml4ID0gYCVjWyR7bGV2ZWxOYW1lfV1gO1xuXG4gICAgICAgIC8vIEdldCB0aGUgY2FsbGVyIGxpbmUgKHN0YWNrIGxpbmUgMilcbiAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKCk7XG4gICAgICAgIGxldCBjYWxsZXIgPSBcIlwiO1xuICAgICAgICBpZiAoZXJyLnN0YWNrKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFja0xpbmVzID0gZXJyLnN0YWNrLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgaWYgKHN0YWNrTGluZXMubGVuZ3RoID49IDMpIHtcbiAgICAgICAgICAgICAgICBjYWxsZXIgPSBzdGFja0xpbmVzWzJdLnRyaW0oKTsgLy8gMDpFcnJvciwgMTp0aGlzIGZ1bmN0aW9uLCAyOmNhbGxlclxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gT25seSBzdHlsZSB0aGUgcHJlZml4LCBub3QgdGhlIGNhbGxlclxuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlIEFMRVJUOlxuICAgICAgICAgICAgY2FzZSBFUlJPUjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmdyb3VwQ29sbGFwc2VkKHByZWZpeCwgY29sb3IsIC4uLm1zZyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYWxsZXIgU3RhY2s6XCIsIGVycik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBXQVJOSU5HOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQocHJlZml4LCBjb2xvciwgLi4ubXNnKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhbGxlciBTdGFjazpcIiwgZXJyKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIElORk86XG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKHByZWZpeCwgY29sb3IsIC4uLm1zZyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIERFQlVHOlxuICAgICAgICAgICAgY2FzZSBUUkFDRTpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5ncm91cENvbGxhcHNlZChwcmVmaXgsIGNvbG9yLCAuLi5tc2cpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2FsbGVyIFN0YWNrOlwiLCBlcnIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAobGV2ZWwgPT09IEFMRVJUIHx8IGxldmVsID09PSBFUlJPUikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgPGI+RnJvbnRtYXR0ZXIgQXV0b21hdGUgJHtsZXZlbE5hbWV9PC9iPjo8YnIvPiR7bXNnLmpvaW4oXCIgXCIpfWAsIDgwMDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ3JvdXBDb2xsYXBzZWQobGV2ZWw6IExvZ0xldmVsLCAuLi5tc2c6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zaG91bGRMb2cobGV2ZWwpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGxldmVsTmFtZSA9IHRoaXMuZ2V0TGV2ZWxOYW1lKGxldmVsKTtcbiAgICAgICAgbGV0IGNvbG9yID0gXCJcIjtcbiAgICAgICAgc3dpdGNoIChsZXZlbCkge1xuICAgICAgICAgICAgY2FzZSBBTEVSVDogICBjb2xvciA9IFwiYmFja2dyb3VuZDogI2QzMmYyZjsgY29sb3I6IHdoaXRlOyBmb250LXdlaWdodDogYm9sZFwiOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgRVJST1I6ICAgY29sb3IgPSBcImNvbG9yOiAjZDMyZjJmOyBmb250LXdlaWdodDogYm9sZFwiOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgV0FSTklORzogY29sb3IgPSBcImNvbG9yOiAjZmJjMDJkOyBmb250LXdlaWdodDogYm9sZFwiOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgSU5GTzogICAgY29sb3IgPSBcImNvbG9yOiAjMTk3NmQyOyBmb250LXdlaWdodDogYm9sZFwiOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgREVCVUc6ICAgY29sb3IgPSBcImNvbG9yOiAjMzg4ZTNjO1wiOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVFJBQ0U6ICAgY29sb3IgPSBcImNvbG9yOiAjNjE2MTYxO1wiOyBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6ICAgICAgY29sb3IgPSBcIlwiOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcmVmaXggPSBgJWNbJHtsZXZlbE5hbWV9XWA7XG4gICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQocHJlZml4LCBjb2xvciwgLi4ubXNnKTtcbiAgICB9XG5cbiAgICBncm91cEVuZCgpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xuICAgIH1cblxuICAgIGxvZ1VwZGF0ZShtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBuZXcgTm90aWNlKGA8Yj5Gcm9udG1hdHRlciBBdXRvbWF0ZSB1cGRhdGU8L2I+Ojxici8+JHttc2d9YCwgMTUwMDApO1xuICAgIH1cblxuICAgIGxvZ0Vycm9yKGU6IEVycm9yIHwgRXJyb3JNYW5hZ2VyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UoXCJcIiwgODAwMCk7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3JNYW5hZ2VyICYmIGUuY29uc29sZV9tc2cpIHtcbiAgICAgICAgICAgIG5vdGljZS5tZXNzYWdlRWwuaW5uZXJIVE1MID0gYDxiPkZyb250bWF0dGVyIEF1dG9tYXRlIEVycm9yPC9iPjo8YnIvPiR7ZS5tZXNzYWdlfTxici8+Q2hlY2sgY29uc29sZSBmb3IgbW9yZSBpbmZvcm1hdGlvbmA7XG4gICAgICAgICAgICBsb2dnZXIubG9nKEVSUk9SLGBGcm9udG1hdHRlciBFcnJvcjpgLCBlLm1lc3NhZ2UsIFwiXFxuXCIsIGUuY29uc29sZV9tc2cpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm90aWNlLm1lc3NhZ2VFbC5pbm5lckhUTUwgPSBgPGI+RnJvbnRtYXR0ZXIgQXV0b21hdGUgRXJyb3I8L2I+Ojxici8+JHtlLm1lc3NhZ2V9YDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gRXhwb3J0IGEgc2luZ2xldG9uIGxvZ2dlciBpbnN0YW5jZSBhbmQgdGhlIGxvZyBsZXZlbCBjb25zdGFudHNcbmV4cG9ydCBjb25zdCBsb2dnZXIgPSBuZXcgTG9nZ2VyKCk7IiwgImltcG9ydCB7IGxvZ0Vycm9yIH0gZnJvbSBcIi4vTG9nXCI7XG5cbmV4cG9ydCBjbGFzcyBFcnJvck1hbmFnZXIgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnOiBzdHJpbmcsIHB1YmxpYyBjb25zb2xlX21zZz86IHN0cmluZykge1xuICAgICAgICBzdXBlcihtc2cpO1xuICAgICAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlcnJvcldyYXBwZXI8VD4oXG4gICAgZm46ICgpID0+IFByb21pc2U8VD4sXG4gICAgbXNnOiBzdHJpbmdcbik6IFByb21pc2U8VD4ge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBmbigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIEVycm9yTWFuYWdlcikpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IChlICYmIHR5cGVvZiBlID09PSBcIm9iamVjdFwiICYmIFwibWVzc2FnZVwiIGluIGUpID8gKGUgYXMgeyBtZXNzYWdlOiBzdHJpbmcgfSkubWVzc2FnZSA6IFN0cmluZyhlKTtcbiAgICAgICAgICAgIGxvZ0Vycm9yKG5ldyBFcnJvck1hbmFnZXIobXNnLCBlcnJvck1lc3NhZ2UpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ0Vycm9yKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsIGFzIFQ7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXJyb3JXcmFwcGVyU3luYzxUPihmbjogKCkgPT4gVCwgbXNnOiBzdHJpbmcpOiBUIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZm4oKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ0Vycm9yKG5ldyBFcnJvck1hbmFnZXIobXNnLCBlLm1lc3NhZ2UpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ0Vycm9yKG5ldyBFcnJvck1hbmFnZXIobXNnLCBTdHJpbmcoZSkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbCBhcyBUO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIG5vcm1hbGl6ZVBhdGgsIFRBYnN0cmFjdEZpbGUsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgRnJvbnRtYXR0ZXJBdXRvbWF0ZVNldHRpbmdzLCBQcm9wZXJ0eUluZm8sIFByb3BlcnR5VHlwZUluZm8gfSBmcm9tICcuL3R5cGVzJ1xyXG5pbXBvcnQgeyBFcnJvck1hbmFnZXIgfSBmcm9tIFwiLi9FcnJvclwiO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSAnLi9hbGVydEJveCc7XHJcbmltcG9ydCB7IGRlbGltaXRlciB9IGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBydWxlc01hbmFnZXIgfSBmcm9tICcuL3J1bGVzL3J1bGVzJztcclxuaW1wb3J0IHsgREVCVUcsIEVSUk9SLCBsb2dnZXIsIFRSQUNFLCBXQVJOSU5HIH0gZnJvbSAnLi9Mb2cnO1xyXG4vKipcclxuICogUGFyc2UgYSBKYXZhU2NyaXB0IGZ1bmN0aW9uLCBjbGVhbiBjb21tZW50cyBhbmQgZGVmaW5lIHRoZSBmdW5jdGlvbiBcclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IGpzQ29kZVxyXG4gKiBAcmV0dXJuIHsqfSAgeyhGdW5jdGlvbiB8IHN0cmluZyB8IHVuZGVmaW5lZCl9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKU0NvZGUoanNDb2RlOnN0cmluZyk6IEZ1bmN0aW9uIHwgc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIGZ1bmN0aW9uIHBhcnNlRnVuY3Rpb24gKGpzQ29kZTogc3RyaW5nKTogRnVuY3Rpb24gfCBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAganNDb2RlID0gY2xlYW5Db2RlU3RyaW5nKGpzQ29kZSk7XHJcbiAgICAgICAgdmFyIGZ1bmNSZWcgPSAvZnVuY3Rpb24gKlxcKChbXigpXSopXFwpWyBcXG5cXHRdKnsoLiopfS9nbWk7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gZnVuY1JlZy5leGVjKGpzQ29kZS5yZXBsYWNlKC9cXG4vZywgJyAnKSk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB2YXIgYXJncyA9IG1hdGNoWzFdLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgYXJncy5wdXNoKG1hdGNoWzJdKTtcclxuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsJ2Vycm9yIHBhcnNpbmcgSlMgZnVuY3Rpb24hJywgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gcGFyc2VGdW5jdGlvbihqc0NvZGUpO1xyXG59XHJcblxyXG4vKipcclxuICogQ2xlYW5zIGEgSmF2YVNjcmlwdC9UeXBlU2NyaXB0IGNvZGUgc3RyaW5nIGJ5IHJlbW92aW5nIGNvbW1lbnRzLlxyXG4gKiBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgYm90aCBzaW5nbGUtbGluZSBjb21tZW50cyAoYC8vIC4uLmApIGFuZFxyXG4gKiBtdWx0aS1saW5lIGNvbW1lbnRzIChgLyogLi4uICpcXC9gKS4gSXQgYWxzbyBjb3JyZWN0bHkgaGFuZGxlc1xyXG4gKiBjb21tZW50cyB3aXRoaW4gc3RyaW5ncyBhbmQgcmVndWxhciBleHByZXNzaW9ucy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IGNvZGVTdHJpbmcgVGhlIGNvZGUgc3RyaW5nIHRvIGNsZWFuLlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY2xlYW5lZCBjb2RlIHN0cmluZyB3aXRoIGNvbW1lbnRzIHJlbW92ZWQuXHJcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gSWYgdGhlIGlucHV0IGlzIG5vdCBhIHN0cmluZy5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkNvZGVTdHJpbmcoY29kZVN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIC8vIEVuc3VyZSB0aGUgaW5wdXQgaXMgYSBzdHJpbmdcclxuICAgIGlmICh0eXBlb2YgY29kZVN0cmluZyAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW5wdXQgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuICAgIH1cclxuICBcclxuICAgIC8vIEZsYWdzIHRvIHRyYWNrIHRoZSBjdXJyZW50IHBhcnNpbmcgY29udGV4dFxyXG4gICAgbGV0IGluTXVsdGlMaW5lQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgbGV0IGluU2luZ2xlTGluZUNvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGxldCBpblN0cmluZzogJ1wiJyB8IFwiJ1wiIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrcyBpZiBpbnNpZGUgc2luZ2xlIG9yIGRvdWJsZSBxdW90ZXNcclxuICAgIGxldCBpblJlZ0V4cDogYm9vbGVhbiA9IGZhbHNlOyAvLyBUcmFja3MgaWYgaW5zaWRlIGEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWxcclxuICBcclxuICAgIC8vIFRoZSByZXN1bHRpbmcgc3RyaW5nIHdpdGhvdXQgY29tbWVudHNcclxuICAgIGxldCBjbGVhbmVkQ29kZTogc3RyaW5nID0gJyc7XHJcbiAgICAvLyBDdXJyZW50IGluZGV4IGluIHRoZSBpbnB1dCBzdHJpbmdcclxuICAgIGxldCBpOiBudW1iZXIgPSAwO1xyXG4gIFxyXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBpbnB1dCBzdHJpbmcgY2hhcmFjdGVyIGJ5IGNoYXJhY3RlclxyXG4gICAgd2hpbGUgKGkgPCBjb2RlU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICBjb25zdCBjaGFyOiBzdHJpbmcgPSBjb2RlU3RyaW5nW2ldO1xyXG4gICAgICBjb25zdCBuZXh0Q2hhcjogc3RyaW5nIHwgdW5kZWZpbmVkID0gY29kZVN0cmluZ1tpICsgMV07IC8vIFVzZSB1bmRlZmluZWQgZm9yIHBvdGVudGlhbCBlbmQgb2Ygc3RyaW5nXHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgbXVsdGktbGluZSBjb21tZW50IC0tLVxyXG4gICAgICBpZiAoaW5NdWx0aUxpbmVDb21tZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBlbmQgb2YgdGhlIG11bHRpLWxpbmUgY29tbWVudCAnKi8nXHJcbiAgICAgICAgaWYgKGNoYXIgPT09ICcqJyAmJiBuZXh0Q2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICBpbk11bHRpTGluZUNvbW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAgIGkgKz0gMjsgLy8gU2tpcCB0aGUgJyovJ1xyXG4gICAgICAgICAgY29udGludWU7IC8vIE1vdmUgdG8gdGhlIG5leHQgaXRlcmF0aW9uXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGkrKzsgLy8gU2tpcCB0aGUgY2hhcmFjdGVyIGluc2lkZSB0aGUgY29tbWVudFxyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgc2luZ2xlLWxpbmUgY29tbWVudCAtLS1cclxuICAgICAgaWYgKGluU2luZ2xlTGluZUNvbW1lbnQpIHtcclxuICAgICAgICAvLyBDaGVjayBmb3IgdGhlIGVuZCBvZiB0aGUgbGluZSAobmV3bGluZSBvciBjYXJyaWFnZSByZXR1cm4pXHJcbiAgICAgICAgaWYgKGNoYXIgPT09ICdcXG4nIHx8IGNoYXIgPT09ICdcXHInKSB7XHJcbiAgICAgICAgICBpblNpbmdsZUxpbmVDb21tZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBLZWVwIHRoZSBuZXdsaW5lIGNoYXJhY3RlclxyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGkrKzsgLy8gU2tpcCB0aGUgY2hhcmFjdGVyIGluc2lkZSB0aGUgY29tbWVudFxyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgc3RyaW5nIGxpdGVyYWwgLS0tXHJcbiAgICAgIGlmIChpblN0cmluZykge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IGNoYXJhY3RlciBjbG9zZXMgdGhlIHN0cmluZ1xyXG4gICAgICAgIGlmIChjaGFyID09PSBpblN0cmluZykge1xyXG4gICAgICAgICAgaW5TdHJpbmcgPSBudWxsOyAvLyBFeGl0IHN0cmluZyBzdGF0ZVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAvLyBIYW5kbGUgZXNjYXBlZCBjaGFyYWN0ZXJzIHdpdGhpbiBzdHJpbmdzIChlLmcuLCBcIml0XFwnc1wiKVxyXG4gICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBiYWNrc2xhc2hcclxuICAgICAgICAgIGkrKzsgLy8gTW92ZSB0byB0aGUgbmV4dCBjaGFyYWN0ZXIgKHRoZSBlc2NhcGVkIG9uZSlcclxuICAgICAgICAgIGlmIChpIDwgY29kZVN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNvZGVTdHJpbmdbaV07IC8vIEFkZCB0aGUgZXNjYXBlZCBjaGFyYWN0ZXJcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGkrKztcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgdGhlIGNoYXJhY3RlciB0byB0aGUgcmVzdWx0IGlmIGl0J3MgcGFydCBvZiB0aGUgc3RyaW5nXHJcbiAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICBpKys7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgIC8vIC0tLSBTdGF0ZTogSW5zaWRlIGEgcmVndWxhciBleHByZXNzaW9uIGxpdGVyYWwgLS0tXHJcbiAgICAgICBpZiAoaW5SZWdFeHApIHtcclxuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjdXJyZW50IGNoYXJhY3RlciBjbG9zZXMgdGhlIHJlZ2V4IGxpdGVyYWxcclxuICAgICAgICAgIC8vIE5vdGU6IFRoaXMgZG9lc24ndCBoYW5kbGUgcmVnZXggZmxhZ3MgcGVyZmVjdGx5IGJ1dCBjb3ZlcnMgYmFzaWMgY2FzZXMuXHJcbiAgICAgICAgICBpZiAoY2hhciA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgaW5SZWdFeHAgPSBmYWxzZTsgLy8gRXhpdCByZWdleCBzdGF0ZVxyXG4gICAgICAgICAgfSBlbHNlIGlmIChjaGFyID09PSAnXFxcXCcpIHtcclxuICAgICAgICAgICAgICAvLyBIYW5kbGUgZXNjYXBlZCBjaGFyYWN0ZXJzIHdpdGhpbiByZWdleCAoZS5nLiwgL1xcLy8pXHJcbiAgICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjsgLy8gQWRkIHRoZSBiYWNrc2xhc2hcclxuICAgICAgICAgICAgICBpKys7IC8vIE1vdmUgdG8gdGhlIG5leHQgY2hhcmFjdGVyXHJcbiAgICAgICAgICAgICAgaWYgKGkgPCBjb2RlU3RyaW5nLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgIGNsZWFuZWRDb2RlICs9IGNvZGVTdHJpbmdbaV07IC8vIEFkZCB0aGUgZXNjYXBlZCBjaGFyYWN0ZXJcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gQWRkIHRoZSBjaGFyYWN0ZXIgdG8gdGhlIHJlc3VsdCBpZiBpdCdzIHBhcnQgb2YgdGhlIHJlZ2V4XHJcbiAgICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIC0tLSBEZWZhdWx0IFN0YXRlOiBDaGVjayBmb3IgY29tbWVudC9zdHJpbmcvcmVnZXggc3RhcnRzIC0tLVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgbXVsdGktbGluZSBjb21tZW50ICcvKidcclxuICAgICAgaWYgKGNoYXIgPT09ICcvJyAmJiBuZXh0Q2hhciA9PT0gJyonKSB7XHJcbiAgICAgICAgaW5NdWx0aUxpbmVDb21tZW50ID0gdHJ1ZTtcclxuICAgICAgICBpICs9IDI7IC8vIFNraXAgdGhlICcvKidcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIHN0YXJ0IG9mIGEgc2luZ2xlLWxpbmUgY29tbWVudCAnLy8nXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycgJiYgbmV4dENoYXIgPT09ICcvJykge1xyXG4gICAgICAgIGluU2luZ2xlTGluZUNvbW1lbnQgPSB0cnVlO1xyXG4gICAgICAgIGkgKz0gMjsgLy8gU2tpcCB0aGUgJy8vJ1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIC8vIENoZWNrIGZvciB0aGUgc3RhcnQgb2YgYSBzdHJpbmcgbGl0ZXJhbCAoJyBvciBcIilcclxuICAgICAgaWYgKGNoYXIgPT09ICdcIicgfHwgY2hhciA9PT0gXCInXCIpIHtcclxuICAgICAgICBpblN0cmluZyA9IGNoYXI7IC8vIEVudGVyIHN0cmluZyBzdGF0ZSwgcmVtZW1iZXJpbmcgdGhlIHF1b3RlIHR5cGVcclxuICAgICAgICBjbGVhbmVkQ29kZSArPSBjaGFyOyAvLyBBZGQgdGhlIG9wZW5pbmcgcXVvdGVcclxuICAgICAgICBpKys7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBzdGFydCBvZiBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsICcvJ1xyXG4gICAgICAvLyBCYXNpYyBjaGVjazogYXNzdW1lcyAnLycgaW5kaWNhdGVzIGEgcmVnZXggc3RhcnQgaWYgbm90IHByZWNlZGVkIGJ5IG9wZXJhdG9ycy9rZXl3b3Jkc1xyXG4gICAgICAvLyBBIG1vcmUgcm9idXN0IHNvbHV0aW9uIHdvdWxkIHJlcXVpcmUgbW9yZSBjb21wbGV4IHBhcnNpbmcuXHJcbiAgICAgIGlmIChjaGFyID09PSAnLycpIHtcclxuICAgICAgICAgIC8vIFZlcnkgYmFzaWMgY2hlY2sgdG8gZGlmZmVyZW50aWF0ZSBkaXZpc2lvbiBmcm9tIHJlZ2V4IHN0YXJ0LlxyXG4gICAgICAgICAgLy8gVGhpcyBtaWdodCBuZWVkIHJlZmluZW1lbnQgZm9yIGNvbXBsZXggY2FzZXMuXHJcbiAgICAgICAgICBjb25zdCBwcmV2TWVhbmluZ2Z1bENoYXIgPSBjbGVhbmVkQ29kZS50cmltKCkuc2xpY2UoLTEpO1xyXG4gICAgICAgICAgaWYgKHByZXZNZWFuaW5nZnVsQ2hhciA9PT0gJycgfHwgWycoJywgJywnLCAnPScsICc6JywgJ1snLCAnIScsICcmJywgJ3wnLCAnPycsICd7JywgJzsnLCAnXFxuJywgJ1xcciddLmluY2x1ZGVzKHByZXZNZWFuaW5nZnVsQ2hhcikpIHtcclxuICAgICAgICAgICAgICBpblJlZ0V4cCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgY2xlYW5lZENvZGUgKz0gY2hhcjtcclxuICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgLy8gSWYgbm9uZSBvZiB0aGUgYWJvdmUsIGl0J3MgcmVndWxhciBjb2RlOyBhZGQgaXQgdG8gdGhlIHJlc3VsdFxyXG4gICAgICBjbGVhbmVkQ29kZSArPSBjaGFyO1xyXG4gICAgICBpKys7XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvLyBSZXR1cm4gdGhlIGFjY3VtdWxhdGVkIGNsZWFuZWQgY29kZSBzdHJpbmdcclxuICAgIHJldHVybiBjbGVhbmVkQ29kZTtcclxuICB9XHJcbiAgZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVGb2xkZXIoYXBwOiBBcHAsIGZvbGRlcl9zdHI6IHN0cmluZyk6IFRGb2xkZXIge1xyXG4gICAgZm9sZGVyX3N0ciA9IG5vcm1hbGl6ZVBhdGgoZm9sZGVyX3N0cik7XHJcblxyXG4gICAgY29uc3QgZm9sZGVyID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJfc3RyKTtcclxuICAgIGlmICghZm9sZGVyKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgRm9sZGVyIFwiJHtmb2xkZXJfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcclxuICAgIH1cclxuICAgIGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgJHtmb2xkZXJfc3RyfSBpcyBhIGZpbGUsIG5vdCBhIGZvbGRlcmApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmb2xkZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlRmlsZShhcHA6IEFwcCwgZmlsZV9zdHI6IHN0cmluZyk6IFRGaWxlIHtcclxuICAgIGZpbGVfc3RyID0gbm9ybWFsaXplUGF0aChmaWxlX3N0cik7XHJcblxyXG4gICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZV9zdHIpO1xyXG4gICAgaWYgKCFmaWxlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgRmlsZSBcIiR7ZmlsZV9zdHJ9XCIgZG9lc24ndCBleGlzdGApO1xyXG4gICAgfVxyXG4gICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYCR7ZmlsZV9zdHJ9IGlzIGEgZm9sZGVyLCBub3QgYSBmaWxlYCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZpbGU7XHJcbn1cclxuICBleHBvcnQgZnVuY3Rpb24gZ2V0RmlsZXNGcm9tRm9sZGVyKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBmb2xkZXJfc3RyOiBzdHJpbmdcclxuICApOiBBcnJheTxURmlsZT4ge1xyXG4gICAgY29uc3QgZm9sZGVyID0gcmVzb2x2ZUZvbGRlcihhcHAsIGZvbGRlcl9zdHIpO1xyXG5cclxuICAgIGNvbnN0IGZpbGVzOiBBcnJheTxURmlsZT4gPSBbXTtcclxuICAgIFZhdWx0LnJlY3Vyc2VDaGlsZHJlbihmb2xkZXIsIChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XHJcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICBmaWxlcy5wdXNoKGZpbGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZpbGVzLnNvcnQoKGEsIGIpID0+IHsgIFxyXG4gICAgICAgIHJldHVybiBhLnBhdGgubG9jYWxlQ29tcGFyZShiLnBhdGgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGZpbGVzO1xyXG59XHJcbiAgZXhwb3J0IGNsYXNzIFNjcmlwdGluZ1Rvb2xzIHtcclxuICAgIGFwcDogQXBwIHwgdW5kZWZpbmVkO1xyXG4gICAgcGx1Z2luOiBhbnk7IC8vRm9sZGVyVGFnUGx1Z2luO1xyXG4gICAgc2V0dGluZ3M6IEZyb250bWF0dGVyQXV0b21hdGVTZXR0aW5ncyB8IHVuZGVmaW5lZDtcclxuICAgIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfCB1bmRlZmluZWQ7XHJcbiAgICBmcm9udG1hdHRlcjogYW55O1xyXG4gICAgY3VycmVudENvbnRlbnQ6IGFueTtcclxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlIHwgdW5kZWZpbmVkO1xyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eUluZm8+ID0ge307XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwPzpBcHAsIHBsdWdpbj86YW55LCBzZXR0aW5ncz86RnJvbnRtYXR0ZXJBdXRvbWF0ZVNldHRpbmdzLCBydWxlPzogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgZnJvbnRtYXR0ZXI/OiBhbnksIGFjdGl2ZUZpbGU/OiBURmlsZSkge1xyXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5nc1xyXG4gICAgICAgIHRoaXMucnVsZSA9IHJ1bGU7XHJcbiAgICAgICAgdGhpcy5mcm9udG1hdHRlciA9IGZyb250bWF0dGVyO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlRmlsZSA9IGFjdGl2ZUZpbGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyB0aGUgZnJvbnRtYXR0ZXIgb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGUgY3VycmVudCBpbnN0YW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgZnJvbnRtYXR0ZXIgZGF0YS5cclxuICAgICAqL1xyXG4gICAgZ2V0RnJvbnRtYXR0ZXIoKSB7IFxyXG4gICAgICByZXR1cm4gdGhpcy5mcm9udG1hdHRlcjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU2V0cyB0aGUgZnJvbnRtYXR0ZXIgcHJvcGVydHkgZm9yIHRoZSBjdXJyZW50IGluc3RhbmNlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBmcm9udG1hdHRlciAtIFRoZSBmcm9udG1hdHRlciBvYmplY3QgdG8gYXNzaWduLlxyXG4gICAgICovXHJcbiAgICBzZXRGcm9udG1hdHRlcihmcm9udG1hdHRlcjphbnkpIHtcclxuICAgICAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgYSBwcm9wZXJ0eSBpbiB0aGUgZnJvbnRtYXR0ZXIgb2JqZWN0LiBJZiB0aGUgZnJvbnRtYXR0ZXIgZG9lcyBub3QgZXhpc3QsIGl0IGluaXRpYWxpemVzIGl0IGFzIGFuIGVtcHR5IG9iamVjdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ga2V5IC0gVGhlIHByb3BlcnR5IG5hbWUgdG8gc2V0IGluIHRoZSBmcm9udG1hdHRlci5cclxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBhc3NpZ24gdG8gdGhlIHNwZWNpZmllZCBwcm9wZXJ0eS5cclxuICAgICAqL1xyXG4gICAgc2V0RnJvbnRtYXR0ZXJQcm9wZXJ0eShrZXk6c3RyaW5nLCB2YWx1ZTphbnkpIHtcclxuICAgICAgaWYgKCF0aGlzLmZyb250bWF0dGVyKSB0aGlzLmZyb250bWF0dGVyID0ge307XHJcbiAgICAgIHRoaXMuZnJvbnRtYXR0ZXJba2V5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWVkIHByb3BlcnR5IGZyb20gdGhlIGZyb250bWF0dGVyIG9iamVjdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ga2V5IC0gVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIHJldHJpZXZlIGZyb20gdGhlIGZyb250bWF0dGVyLlxyXG4gICAgICogQHJldHVybnMgVGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBpbiB0aGUgZnJvbnRtYXR0ZXIsIG9yIGB1bmRlZmluZWRgIGlmIHRoZSBrZXkgZG9lcyBub3QgZXhpc3QuXHJcbiAgICAgKi9cclxuICAgIGdldEZyb250bWF0dGVyUHJvcGVydHkoa2V5OnN0cmluZykge1xyXG4gICAgICByZXR1cm4gdGhpcy5mcm9udG1hdHRlcltrZXldXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZmlsZSAtIFRoZSBmaWxlIHRvIHNldCBhcyBhY3RpdmUuIE11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgYFRGaWxlYC5cclxuICAgICAqL1xyXG4gICAgc2V0QWN0aXZlRmlsZShmaWxlOlRGaWxlKSB7XHJcbiAgICAgIHRoaXMuYWN0aXZlRmlsZSA9IGZpbGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgYWN0aXZlIGZpbGUgb2JqZWN0LCBvciBgdW5kZWZpbmVkYCBpZiBubyBmaWxlIGlzIGFjdGl2ZS5cclxuICAgICAqL1xyXG4gICAgZ2V0QWN0aXZlRmlsZSgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlRmlsZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU2V0cyB0aGUgY3VycmVudCBydWxlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBmcm9udG1hdHRlciBhdXRvbWF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBydWxlIC0gVGhlIHJ1bGUgc2V0dGluZ3MgdG8gYXBwbHksIHJlcHJlc2VudGVkIGJ5IGEgYEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3NgIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgc2V0UnVsZShydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpIHtcclxuICAgICAgdGhpcy5ydWxlID0gcnVsZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0cmlldmVzIHRoZSBjdXJyZW50IHJ1bGUgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgVGhlIHJ1bGUgb2JqZWN0IG9yIHZhbHVlIHN0b3JlZCBpbiB0aGUgYHJ1bGVgIHByb3BlcnR5LlxyXG4gICAgICovXHJcbiAgICBnZXRSdWxlKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ydWxlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgYSBydWxlIGZ1bmN0aW9uIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBydWxlIHNldHRpbmdzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBydWxlIC0gT3B0aW9uYWwuIFRoZSBydWxlIHNldHRpbmdzIHRvIHVzZSBmb3IgcmV0cmlldmluZyB0aGUgcnVsZSBmdW5jdGlvbi5cclxuICAgICAqICAgICAgICAgICAgICAgSWYgbm90IHByb3ZpZGVkLCB0aGUgbWV0aG9kIHVzZXMgdGhlIGluc3RhbmNlJ3MgZGVmYXVsdCBydWxlLlxyXG4gICAgICogQHJldHVybnMgVGhlIHJ1bGUgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgcnVsZSBzZXR0aW5ncywgb3IgYHVuZGVmaW5lZGAgaWYgbm8gcnVsZSBpcyBmb3VuZC5cclxuICAgICAqL1xyXG4gICAgZ2V0UnVsZUZ1bmN0aW9uKHJ1bGU/OkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpIHtcclxuICAgICAgaWYgKCFydWxlKSBydWxlID0gdGhpcy5ydWxlO1xyXG4gICAgICBpZiAocnVsZSkge1xyXG4gICAgICAgIHJldHVybiBydWxlc01hbmFnZXIuZ2V0UnVsZUJ5SWQocnVsZS5jb250ZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBjdXJyZW50IGNvbnRlbnQgdG8gdGhlIHByb3ZpZGVkIHZhbHVlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjb250ZW50IC0gVGhlIGNvbnRlbnQgdG8gc2V0IGFzIHRoZSBjdXJyZW50IGNvbnRlbnQuIENhbiBiZSBvZiBhbnkgdHlwZS5cclxuICAgICAqL1xyXG4gICAgc2V0Q3VycmVudENvbnRlbnQoY29udGVudDphbnkpIHtcclxuICAgICAgdGhpcy5jdXJyZW50Q29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBjb250ZW50IHN0b3JlZCBpbiB0aGUgaW5zdGFuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgY29udGVudC5cclxuICAgICAqL1xyXG4gICAgZ2V0Q3VycmVudENvbnRlbnQoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDb250ZW50O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBzcGVjaWZpZWQgZnJvbnRtYXR0ZXIgcHJvcGVydHkgb2YgYSBnaXZlbiBmaWxlIHdpdGggbmV3IGNvbnRlbnQuXHJcbiAgICAgKlxyXG4gICAgICogSWYgbm8gZmlsZSBpcyBwcm92aWRlZCwgdGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZSBpcyB1c2VkLiBJZiBuZWl0aGVyIGlzIGF2YWlsYWJsZSwgdGhlIG1ldGhvZCByZXR1cm5zIGVhcmx5LlxyXG4gICAgICogVGhlIG1ldGhvZCBsb2dzIHRoZSB1cGRhdGUgb3BlcmF0aW9uIGFuZCBvbmx5IHN1cHBvcnRzIHVwZGF0aW5nIHByb3BlcnRpZXMgd2l0aCBwcmltaXRpdmUgdmFsdWVzIG9yIGFycmF5cy5cclxuICAgICAqIElmIGBuZXdDb250ZW50YCBpcyBhbiBvYmplY3QgKGJ1dCBub3QgYW4gYXJyYXkpLCBhIHdhcm5pbmcgaXMgaXNzdWVkIGFuZCB0aGUgdXBkYXRlIGlzIG5vdCBwZXJmb3JtZWQuXHJcbiAgICAgKiBUaGUgZmlsZSdzIG1vZGlmaWNhdGlvbiB0aW1lIChgbXRpbWVgKSBpcyBwcmVzZXJ2ZWQgYW5kIG5vdCBjaGFuZ2VkIGR1cmluZyB0aGUgdXBkYXRlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eSAtIFRoZSBmcm9udG1hdHRlciBwcm9wZXJ0eSB0byB1cGRhdGUuXHJcbiAgICAgKiBAcGFyYW0gbmV3Q29udGVudCAtIFRoZSBuZXcgdmFsdWUgdG8gYXNzaWduIHRvIHRoZSBwcm9wZXJ0eS4gT2JqZWN0cyAoZXhjZXB0IGFycmF5cykgYXJlIG5vdCBzdXBwb3J0ZWQuXHJcbiAgICAgKiBAcGFyYW0gZmlsZSAtIChPcHRpb25hbCkgVGhlIGZpbGUgd2hvc2UgZnJvbnRtYXR0ZXIgc2hvdWxkIGJlIHVwZGF0ZWQuIElmIG9taXR0ZWQsIHRoZSBhY3RpdmUgZmlsZSBpcyB1c2VkLlxyXG4gICAgICovXHJcbiAgICB1cGRhdGVGcm9udG1hdHRlcihwcm9wZXJ0eTpzdHJpbmcsIG5ld0NvbnRlbnQ6YW55LCBmaWxlPzpURmlsZSkge1xyXG4gICAgICBpZiAoIXRoaXMuYXBwKSByZXR1cm47XHJcbiAgICAgIGlmICghZmlsZSkgZmlsZSA9IHRoaXMuYWN0aXZlRmlsZTtcclxuICAgICAgaWYgKCFmaWxlKSByZXR1cm47XHJcbiAgICAgIHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICBsb2dnZXIubG9nKERFQlVHLGB1cGRhdGVGcm9udG1hdHRlciAnJHtmaWxlLnBhdGh9JyBmcm9udG1hdHRlciAnJHtwcm9wZXJ0eX0nIHRvICcke25ld0NvbnRlbnQudG9TdHJpbmcoKX0nYCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBuZXdDb250ZW50ID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShuZXdDb250ZW50KSkge1xyXG4gICAgICAgICAgbG9nZ2VyLmxvZyhXQVJOSU5HLGB1cGRhdGVGcm9udG1hdHRlciAnJHtmaWxlLnBhdGh9J3wnJHtwcm9wZXJ0eX0nIG9iamVjdCBub3Qgc3VwcG9ydGVkIWApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBmcm9udG1hdHRlcltwcm9wZXJ0eV0gPSBuZXdDb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfSx7J210aW1lJzpmaWxlLnN0YXQubXRpbWV9KTsgLy8gZG8gbm90IGNoYW5nZSB0aGUgbW9kaWZ5IHRpbWUuXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIERpc3BsYXlzIGEgY29uZmlybWF0aW9uIGRpYWxvZyB3aXRoIGN1c3RvbWl6YWJsZSBtZXNzYWdlLCB0aXRsZSwgYW5kIGJ1dHRvbiBsYWJlbHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgLSBUaGUgbWVzc2FnZSB0byBkaXNwbGF5IGluIHRoZSBjb25maXJtYXRpb24gZGlhbG9nLlxyXG4gICAgICogQHBhcmFtIHRpdGxlIC0gVGhlIHRpdGxlIG9mIHRoZSBkaWFsb2cgd2luZG93LiBEZWZhdWx0cyB0byAnQ29uZmlybScuXHJcbiAgICAgKiBAcGFyYW0gYnV0dG9uMSAtIFRoZSBsYWJlbCBmb3IgdGhlIGNvbmZpcm1hdGlvbiBidXR0b24uIERlZmF1bHRzIHRvICdZZXMnLlxyXG4gICAgICogQHBhcmFtIGJ1dHRvbjIgLSBUaGUgbGFiZWwgZm9yIHRoZSBjYW5jZWxsYXRpb24gYnV0dG9uLiBEZWZhdWx0cyB0byAnTm8nLlxyXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgdXNlciBjb25maXJtZWQgKHRydWUpIG9yIGNhbmNlbGxlZCAoZmFsc2UpLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBzaG93Q29uZmlybURpYWxvZyhtZXNzYWdlOnN0cmluZywgdGl0bGU6c3RyaW5nID0gJ0NvbmZpcm0nLCBidXR0b24xOnN0cmluZyA9ICdZZXMnLCBidXR0b24yOnN0cmluZyA9ICdObycpIHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gIGF3YWl0IG5ldyBBbGVydE1vZGFsKHRoaXMuYXBwISwgdGl0bGUsIG1lc3NhZ2UsIGJ1dHRvbjEsIGJ1dHRvbjIpLm9wZW5BbmRHZXRWYWx1ZSgpO1xyXG4gICAgICByZXR1cm4gcmVzdWx0LnByb2NlZWQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqICogR2V0IHRoZSBvcHRpb24gY29uZmlnIGZvciBhIHNwZWNpZmljIHJ1bGUuIE9wdGlvbmFsIHRoZSBzcGVjaWZpYyBwYXJhbWV0ZXIgYnkgcHJvdmlkaW5nIGFuIG9wdGlvbiBJRC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcnVsZUlkXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbklkXVxyXG4gICAgICogQHJldHVybiB7Kn0gXHJcbiAgICAgKi9cclxuICAgIGdldE9wdGlvbkNvbmZpZyhydWxlSWQ6c3RyaW5nfHVuZGVmaW5lZCwgb3B0aW9uSWQ/OnN0cmluZyl7XHJcbiAgICAgIGlmICghcnVsZUlkIHx8IHJ1bGVJZCA9PT0gdW5kZWZpbmVkIHx8ICF0aGlzLnNldHRpbmdzICkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgY29uc3QgcnVsZSA9IHRoaXMuc2V0dGluZ3MucnVsZXMuZmluZCgocnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncykgPT4gcnVsZS5pZCA9PT0gcnVsZUlkKTtcclxuICAgICAgaWYgKHJ1bGUgJiYgcnVsZS5oYXNPd25Qcm9wZXJ0eSgnb3B0aW9uc0NvbmZpZycpKSB7XHJcbiAgICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICAgIGNvbnN0IG9wdGlvbkNvbmZpZyA9IHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdXHJcbiAgICAgICAgICBpZiAob3B0aW9uQ29uZmlnKSB7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25JZCkge1xyXG4gICAgICAgICAgICAgIGxvZ2dlci5sb2coVFJBQ0UsYGdldE9wdGlvbkNvbmZpZzogJHtydWxlSWR9IG9wdGlvbiAnJHtvcHRpb25JZH0nYCwgcnVsZSwgb3B0aW9uQ29uZmlnW29wdGlvbklkXSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZ1tvcHRpb25JZF07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyBhbGwgbWFya2Rvd24gZmlsZXMgaW4gdGhlIHZhdWx0IHdob3NlIHBhdGhzIGluY2x1ZGUgdGhlIHNwZWNpZmllZCBtYXRjaGluZyBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIGBtYXRjaGluZ2AgcGFyYW1ldGVyIGlzIG5vcm1hbGl6ZWQgdG8gZW5zdXJlIGl0IGVuZHMgd2l0aCBhIHNpbmdsZSAnLycgY2hhcmFjdGVyLFxyXG4gICAgICogYW5kIGlzIHVzZWQgdG8gZmlsdGVyIGZpbGVzIHdob3NlIHBhdGhzIGNvbnRhaW4gdGhpcyBzdWJzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZvbGRlclBhdGggLSBUaGUgZm9sZGVyIHBhdGggb3Igc3Vic3RyaW5nIHRvIG1hdGNoIHdpdGhpbiBmaWxlIHBhdGhzLlxyXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgYFRGaWxlYCBvYmplY3RzIHdob3NlIHBhdGhzIGluY2x1ZGUgdGhlIG5vcm1hbGl6ZWQgYG1hdGNoaW5nYCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGdldEZpbGVzSW5WYXVsdChmb2xkZXJQYXRoOiBzdHJpbmcpOiBURmlsZVtdIHtcclxuICAgICAgICBmb2xkZXJQYXRoID0gZm9sZGVyUGF0aC5yZXBsYWNlKC9eXFwvfFxcLyQvZywgXCJcIikgKyAnLyc7IC8vIEVuc3VyZSBpdCBlbmRzIHdpdGggYSAnLydcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwIS52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7IC8vIFJldHJpZXZlIGFsbCBtYXJrZG93biBmaWxlc1xyXG4gICAgICAgIGNvbnN0IG1hdGNoaW5nRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5wYXRoLmluY2x1ZGVzKGZvbGRlclBhdGgpKTtcclxuICAgICAgICByZXR1cm4gbWF0Y2hpbmdGaWxlcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG1vY2sgYFRGaWxlYCBvYmplY3QgZnJvbSBhIGdpdmVuIGZpbGUgcGF0aCBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgcGFyc2VzIHRoZSBwcm92aWRlZCBwYXRoIHRvIGNvbnN0cnVjdCBhIGBURmlsZWAtbGlrZSBvYmplY3QsXHJcbiAgICAgKiBleHRyYWN0aW5nIHRoZSBmaWxlIG5hbWUsIGV4dGVuc2lvbiwgYW5kIGJhc2UgbmFtZS4gVGhlIHJldHVybmVkIG9iamVjdFxyXG4gICAgICogY29udGFpbnMgcGxhY2Vob2xkZXIgdmFsdWVzIGZvciBmaWxlIHN0YXRpc3RpY3MgYW5kIHBhcmVudCwgYXMgdGhlc2UgZGV0YWlsc1xyXG4gICAgICogYXJlIHVua25vd24uIElmIHRoZSBpbnB1dCBwYXRoIGlzIGVtcHR5IG9yIHVuZGVmaW5lZCwgdGhlIG1ldGhvZCByZXR1cm5zIGB1bmRlZmluZWRgLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZpbGUgcGF0aCBzdHJpbmcgdG8gZ2VuZXJhdGUgdGhlIG1vY2sgYFRGaWxlYCBmcm9tLlxyXG4gICAgICogQHJldHVybnMgQSBtb2NrIGBURmlsZWAgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgZmlsZSBhdCB0aGUgZ2l2ZW4gcGF0aCwgb3IgYHVuZGVmaW5lZGAgaWYgdGhlIHBhdGggaXMgaW52YWxpZC5cclxuICAgICAqL1xyXG4gICAgZ2V0TW9ja0ZpbGVGcm9tUGF0aChwYXRoOiBzdHJpbmd8dW5kZWZpbmVkKTogVEZpbGUgfHVuZGVmaW5lZCB7XHJcbiAgICAgIGlmICghcGF0aCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuXHJcbiAgICAgIGxldCBvbGRGaWxlOlRGaWxlO1xyXG4gICAgICBsZXQgb2xkRmlsZVBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICBvbGRGaWxlID0ge1xyXG4gICAgICAgIHBhdGg6IHBhdGgsXHJcbiAgICAgICAgZXh0ZW5zaW9uOiBvbGRGaWxlUGFydHNbb2xkRmlsZVBhcnRzLmxlbmd0aC0xXS5zcGxpdCgnLicpWzFdLFxyXG4gICAgICAgIG5hbWU6IG9sZEZpbGVQYXJ0c1tvbGRGaWxlUGFydHMubGVuZ3RoLTFdLFxyXG4gICAgICAgIHN0YXQ6IHttdGltZTogMCwgY3RpbWU6IDAsIHNpemU6IDB9LCAvLyBzdGF0cyBhcmUgdW5rbm93blxyXG4gICAgICAgIGJhc2VuYW1lOiB0aGlzLnJlbW92ZUFsbEV4dGVuc2lvbnMob2xkRmlsZVBhcnRzW29sZEZpbGVQYXJ0cy5sZW5ndGgtMV0pLFxyXG4gICAgICAgIHZhdWx0OiB0aGlzLmFwcCEudmF1bHQsXHJcbiAgICAgICAgcGFyZW50OiBudWxsIC8vIHBhcmVudCBpcyB1bmtub3duXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBvbGRGaWxlXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyBhIGBURmlsZWAgb2JqZWN0IGZyb20gYSBnaXZlbiBmaWxlIHBhdGguXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmlsZSBwYXRoIHRvIHNlYXJjaCBmb3IuIElmIGB1bmRlZmluZWRgLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBgdW5kZWZpbmVkYC5cclxuICAgICAqIEBwYXJhbSBmaWxlc0NoZWNrIC0gQW4gb3B0aW9uYWwgYXJyYXkgb2YgYFRGaWxlYCBvYmplY3RzIHRvIHNlYXJjaCB3aXRoaW4uIElmIG5vdCBwcm92aWRlZCwgYWxsIG1hcmtkb3duIGZpbGVzIGluIHRoZSB2YXVsdCBhcmUgdXNlZC5cclxuICAgICAqIEByZXR1cm5zIFRoZSBtYXRjaGluZyBgVEZpbGVgIGlmIGZvdW5kOyBvdGhlcndpc2UsIGB1bmRlZmluZWRgLlxyXG4gICAgICovXHJcbiAgICBnZXRURmlsZUZyb21QYXRoKHBhdGg6IHN0cmluZyB8IHVuZGVmaW5lZCwgZmlsZXNDaGVjazogVEZpbGVbXSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCkge1xyXG4gICAgICBpZiAoIXBhdGgpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIGNvbnN0IGZpbGVzID0gZmlsZXNDaGVjayA/IGZpbGVzQ2hlY2sgOiB0aGlzLmFwcCEudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpOyAvLyBSZXRyaWV2ZSBhbGwgbWFya2Rvd24gZmlsZXNcclxuICAgICAgY29uc3QgbWF0Y2hpbmdGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IFxyXG4gICAgICAgIGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBcclxuICAgICAgICBmaWxlLnBhdGgudG9Mb2NhbGVMb3dlckNhc2UoKSA9PT0gcGF0aC50b0xvY2FsZUxvd2VyQ2FzZSgpXHJcbiAgICAgICk7XHJcbiAgICAgIHJldHVybiBtYXRjaGluZ0ZpbGVzLmxlbmd0aCA+IDAgPyBtYXRjaGluZ0ZpbGVzWzBdIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGZpbGUgYXQgdGhlIHNwZWNpZmllZCBwYXRoIHVzaW5nIHRoZSBjb250ZW50IGZyb20gYSB0ZW1wbGF0ZSBmaWxlLlxyXG4gICAgICogSWYgdGhlIGZpbGUgYWxyZWFkeSBleGlzdHMsIHJldHVybnMgdGhlIGV4aXN0aW5nIGZpbGUgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ldyBvbmUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZpbGVOYW1lV2l0aFBhdGggLSBUaGUgZnVsbCBwYXRoIChpbmNsdWRpbmcgZmlsZSBuYW1lKSB3aGVyZSB0aGUgbmV3IGZpbGUgc2hvdWxkIGJlIGNyZWF0ZWQuXHJcbiAgICAgKiBAcGFyYW0gdGVtcGxhdGVGaWxlV2l0aFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSB0ZW1wbGF0ZSBmaWxlIHdob3NlIGNvbnRlbnQgd2lsbCBiZSB1c2VkLlxyXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIG5ld2x5IGNyZWF0ZWQgZmlsZSBvciB0aGUgZXhpc3RpbmcgZmlsZSBpZiBpdCBhbHJlYWR5IGV4aXN0cy5cclxuICAgICAqIEB0aHJvd3Mge0Vycm9yTWFuYWdlcn0gSWYgdGhlIGZvbGRlciBwYXRoIGlzIGludmFsaWQsIGRvZXMgbm90IGV4aXN0LCBvciBpcyBub3QgYSBmb2xkZXIuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGNyZWF0ZUZpbGVGcm9tUGF0aChmaWxlTmFtZVdpdGhQYXRoOnN0cmluZywgdGVtcGxhdGVGaWxlV2l0aFBhdGg6c3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlTmFtZVdpdGhQYXRoLnJlcGxhY2UoL15cXC98XFwvJC9nLCBcIlwiKTsgLy8gUmVtb3ZlIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXNcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZUZpbGUgPSB0ZW1wbGF0ZUZpbGVXaXRoUGF0aC5yZXBsYWNlKC9eXFwvfFxcLyQvZywgXCJcIik7IC8vIFJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzXHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHRoaXMuZ2V0Rm9sZGVyRnJvbVBhdGgoZmlsZU5hbWUpO1xyXG4gICAgICAgIGNvbnN0IGZpbGVOYW1lT25seSA9IGZpbGVOYW1lLnNwbGl0KCcvJykucG9wKCkgfHwgZmlsZU5hbWU7IC8vIEdldCB0aGUgbGFzdCBwYXJ0IG9mIHRoZSBwYXRoIGFzIHRoZSBmaWxlIG5hbWVcclxuICAgICAgICBpZiAoIWZvbGRlclBhdGgpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yTWFuYWdlcihgSW52YWxpZCBmb2xkZXIgcGF0aDogXCIke2ZvbGRlclBhdGh9XCJgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZm9sZGVyID0gdGhpcy5hcHAhLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKSBhcyBURm9sZGVyO1xyXG4gICAgICAgIGlmICghZm9sZGVyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYEZvbGRlciBcIiR7Zm9sZGVyUGF0aH1cIiBkb2Vzbid0IGV4aXN0YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvck1hbmFnZXIoYCR7Zm9sZGVyUGF0aH0gaXMgYSBmaWxlLCBub3QgYSBmb2xkZXJgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAhLnZhdWx0LnJlYWQodGhpcy5hcHAhLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0ZW1wbGF0ZUZpbGUpIGFzIFRGaWxlKTtcclxuICAgICAgICBjb25zdCBmaWxlRXhpc3RzID0gdGhpcy5hcHAhLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlTmFtZVdpdGhQYXRoKSBhcyBURmlsZTtcclxuICAgICAgICBpZiAoIWZpbGVFeGlzdHMpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmFwcCEudmF1bHQuY3JlYXRlKGZvbGRlci5wYXRoICsgJy8nICsgZmlsZU5hbWVPbmx5LCB0ZW1wbGF0ZUNvbnRlbnQpOyAvLyBjcmVhdGUgdGhlIGZpbGUgZnJvbSB0aGUgdGVtcGxhdGVcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZpbGVFeGlzdHM7IC8vIHJldHVybiB0aGUgZmlsZSBpZiBpdCBhbHJlYWR5IGV4aXN0c1xyXG4gICAgfTsgLy8gY3JlYXRlIHRoZSBmaWxlIGlmIGl0IGRvZXMgbm90IGV4aXN0XHJcbiAgICAvKipcclxuICAgICAqICogRmV0Y2hlcyBjdXN0b20gcHJvcGVydHkgaW5mb3JtYXRpb24gZnJvbSBhbGwgbWFya2Rvd24gZmlsZXMgaW4gdGhlIHZhdWx0LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4geyp9IFxyXG4gICAgICovXHJcbiAgICBmZXRjaEN1c3RvbVByb3BlcnR5SW5mb3MoYXBwOkFwcCk6IFJlY29yZDxzdHJpbmcsIFByb3BlcnR5SW5mbz4ge1xyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5SW5mb3M6IFJlY29yZDxzdHJpbmcsIFByb3BlcnR5SW5mbz4gPSB7fTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSBhcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpOyAvLyBSZXRyaWV2ZSBhbGwgbWFya2Rvd24gZmlsZXNcclxuICAgICAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgaWYgKG1ldGFkYXRhPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMobWV0YWRhdGEuZnJvbnRtYXR0ZXIpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnR5SW5mb3Nba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUluZm9zW2tleV0gPSB7IG5hbWU6IGtleSwgdHlwZTogJ3RleHQnIH07IC8vIERlZmF1bHQgdHlwZSBhcyAndGV4dCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcHJvcGVydHlJbmZvcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2hlcyBrbm93biBwcm9wZXJ0aWVzIGZyb20gdGhlIG1ldGFkYXRhIGNhY2hlLlxyXG4gICAgICogSWYgdGhlIG1ldGhvZCBnZXRBbGxQcm9wZXJ0eUluZm9zIGlzIG5vdCBhdmFpbGFibGUsIGl0IGZhbGxzIGJhY2sgdG8gZmV0Y2hDdXN0b21Qcm9wZXJ0eUluZm9zLlxyXG4gICAgICogQHBhcmFtIGFwcCBUaGUgT2JzaWRpYW4gYXBwIGluc3RhbmNlLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBmZXRjaEtub3duUHJvcGVydGllcyhhcHA6QXBwKSB7XHJcbiAgICAgIGxldCBwcm9wZXJ0eUluZm9zOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eUluZm8+ID0ge307XHJcbiAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgaWYgKHR5cGVvZiBhcHAubWV0YWRhdGFDYWNoZS5nZXRBbGxQcm9wZXJ0eUluZm9zID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICBwcm9wZXJ0eUluZm9zID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0QWxsUHJvcGVydHlJbmZvcygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHByb3BlcnR5SW5mb3MgPSB0aGlzLmZldGNoQ3VzdG9tUHJvcGVydHlJbmZvcyhhcHApO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIHNvcnQgdGhlIHByb3BlcnRpZXMgYnkgbmFtZVxyXG4gICAgICBwcm9wZXJ0eUluZm9zID0gT2JqZWN0LmZyb21FbnRyaWVzKFxyXG4gICAgICAgICAgT2JqZWN0LmVudHJpZXMocHJvcGVydHlJbmZvcykuc29ydCgoW2tleUFdLCBba2V5Ql0pID0+IGtleUEubG9jYWxlQ29tcGFyZShrZXlCKSlcclxuICAgICAgKTtcclxuICAgICAgLy8gcmVzdG9yZSB0byBrZWVwIHByb3BlcnRpZXMgdG8gY2FzZSBzZW5zaXRpdmVcclxuICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSB7fTtcclxuICAgICAgT2JqZWN0LmtleXMocHJvcGVydHlJbmZvcykuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIHRoaXMua25vd25Qcm9wZXJ0aWVzW3Byb3BlcnR5SW5mb3Nba2V5XS5uYW1lXSA9IHByb3BlcnR5SW5mb3Nba2V5XTtcclxuICAgICAgfSk7XHJcbiAgICAgIGxvZ2dlci5sb2coREVCVUcsdGhpcy5rbm93blByb3BlcnRpZXMpO1xyXG4gICAgICByZXR1cm4gdGhpcy5rbm93blByb3BlcnRpZXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyB0aGUga25vd24gcHJvcGVydGllcywgaW5pdGlhbGl6aW5nIHRoZW0gaWYgdGhleSBoYXZlIG5vdCBiZWVuIGxvYWRlZCB5ZXQuXHJcbiAgICAgKiBJZiB0aGUgcHJvcGVydGllcyBhcmUgbm90IGFscmVhZHkgY2FjaGVkLCB0aGlzIG1ldGhvZCBmZXRjaGVzIHRoZW0gdXNpbmcgYGZldGNoQ3VzdG9tUHJvcGVydHlJbmZvc2BcclxuICAgICAqIGFuZCBzdG9yZXMgdGhlbSBmb3IgZnV0dXJlIGFjY2Vzcy5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgY2FjaGVkIG9yIG5ld2x5IGZldGNoZWQga25vd24gcHJvcGVydGllcy5cclxuICAgICAqL1xyXG4gICAgZ2V0S25vd25Qcm9wZXJ0aWVzKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5rbm93blByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSB0aGlzLmZldGNoQ3VzdG9tUHJvcGVydHlJbmZvcyh0aGlzLmFwcCEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5rbm93blByb3BlcnRpZXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3RzIHRoZSBwYXRoIGFuZCB0aXRsZSBmcm9tIGEgZ2l2ZW4gbGluayBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIGlucHV0IGxpbmsgaXMgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZvcm1hdCBgW1twYXRofHRpdGxlXV1gIG9yIGBbW3BhdGhdXWAuXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHJlbW92ZXMgc3F1YXJlIGJyYWNrZXRzLCBzcGxpdHMgdGhlIGxpbmsgYnkgdGhlIGB8YCBjaGFyYWN0ZXIsXHJcbiAgICAgKiBhbmQgZGV0ZXJtaW5lcyB0aGUgcGF0aCBhbmQgdGl0bGUuIElmIHRoZSB0aXRsZSBpcyBub3QgcHJvdmlkZWQsIHRoZSBwYXRoIGlzXHJcbiAgICAgKiB1c2VkIGFzIHRoZSB0aXRsZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGluayAtIFRoZSBsaW5rIHN0cmluZyB0byBleHRyYWN0IHBhcnRzIGZyb20sIHR5cGljYWxseSBpbiB0aGUgZm9ybWF0IGBbW3BhdGh8dGl0bGVdXWAgb3IgYFtbcGF0aF1dYC5cclxuICAgICAqIEByZXR1cm5zIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBgcGF0aGAgYW5kIGB0aXRsZWAgZXh0cmFjdGVkIGZyb20gdGhlIGxpbmsuXHJcbiAgICAgKi9cclxuICAgIGV4dHJhY3RMaW5rUGFydHMobGluazogc3RyaW5nKTogeyBwYXRoOiBzdHJpbmc7IHRpdGxlOiBzdHJpbmcgfSB7XHJcbiAgICAgIC8vIFJlbW92ZSBhbGwgc3F1YXJlIGJyYWNrZXRzIGZyb20gdGhlIHN0cmluZ1xyXG4gICAgICBjb25zdCBjbGVhbmVkTGluayA9IGxpbmsucmVwbGFjZSgvW1xcW1xcXV0vZywgXCJcIik7XHJcbiAgXHJcbiAgICAgIC8vIFNwbGl0IHRoZSBzdHJpbmcgYnkgdGhlIFwifFwiIGNoYXJhY3RlclxyXG4gICAgICBjb25zdCBwYXJ0cyA9IGNsZWFuZWRMaW5rLnNwbGl0KFwifFwiKTtcclxuICBcclxuICAgICAgLy8gSWYgb25seSBvbmUgcGFydCBleGlzdHMsIHVzZSBpdCBhcyBib3RoIHBhdGggYW5kIHRpdGxlXHJcbiAgICAgIGNvbnN0IHBhdGggPSBwYXJ0c1swXS50cmltKCk7XHJcbiAgICAgIGNvbnN0IHRpdGxlID0gcGFydHMubGVuZ3RoID4gMSA/IHBhcnRzWzFdLnRyaW0oKSA6IHBhdGg7XHJcbiAgICAgIC8vbG9nZ2VyLmxvZyhERUJVRyxgZXh0cmFjdExpbmtQYXJ0cygke2xpbmt9KSAtPiBwYXRoOiAke3BhdGh9LCB0aXRsZTogJHt0aXRsZX1gKTtcclxuICAgICAgcmV0dXJuIHsgcGF0aCwgdGl0bGUgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdHMgdGhlIHBhdGgsIHRpdGxlLCBhbmQgZmlsZSBuYW1lIGZyb20gYSBnaXZlbiBmaWxlIGxpbmsgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIFNwbGl0cyB0aGUgaW5wdXQgc3RyaW5nIGJ5IHRoZSBcIi9cIiBjaGFyYWN0ZXIgdG8gc2VwYXJhdGUgdGhlIGZpbGUgbmFtZSBmcm9tIGl0cyBwYXRoLlxyXG4gICAgICogVGhlIHRpdGxlIGlzIGRlcml2ZWQgZnJvbSB0aGUgZmlsZSBuYW1lIGJ5IHJlbW92aW5nIGFsbCBleHRlbnNpb25zIGFuZCB0cmltbWluZyB3aGl0ZXNwYWNlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsaW5rIC0gVGhlIGZpbGUgbGluayBzdHJpbmcgdG8gZXh0cmFjdCBwYXJ0cyBmcm9tLlxyXG4gICAgICogQHJldHVybnMgQW4gb2JqZWN0IGNvbnRhaW5pbmc6XHJcbiAgICAgKiAgIC0gYHBhdGhgOiBUaGUgZGlyZWN0b3J5IHBhdGggcG9ydGlvbiBvZiB0aGUgbGluayAoZXhjbHVkaW5nIHRoZSBmaWxlIG5hbWUpLlxyXG4gICAgICogICAtIGB0aXRsZWA6IFRoZSBmaWxlIG5hbWUgd2l0aG91dCBleHRlbnNpb25zIGFuZCB0cmltbWVkLlxyXG4gICAgICogICAtIGBmaWxlTmFtZWA6IFRoZSBmdWxsIGZpbGUgbmFtZSAod2l0aCBleHRlbnNpb25zLCBpZiBhbnkpLlxyXG4gICAgICovXHJcbiAgICBleHRyYWN0UGF0aFBhcnRzKGxpbms6IHN0cmluZyk6IHsgcGF0aDogc3RyaW5nOyB0aXRsZTogc3RyaW5nOyBmaWxlTmFtZTogc3RyaW5nIH0ge1xyXG4gXHJcbiAgICAgIC8vIFNwbGl0IHRoZSBzdHJpbmcgYnkgdGhlIFwiL1wiIGNoYXJhY3RlclxyXG4gICAgICBjb25zdCBwYXJ0cyA9IGxpbmsuc3BsaXQoXCIvXCIpO1xyXG4gIFxyXG4gICAgICAvLyBJZiBvbmx5IG9uZSBwYXJ0IGV4aXN0cywgdXNlIGl0IGFzIGJvdGggcGF0aCBhbmQgdGl0bGVcclxuICAgICAgY29uc3QgZmlsZU5hbWUgPSBwYXJ0cy5wb3AoKSB8fCBcIlwiO1xyXG4gICAgICBjb25zdCB0aXRsZSA9IHRoaXMucmVtb3ZlQWxsRXh0ZW5zaW9ucyhmaWxlTmFtZSkudHJpbSgpO1xyXG4gICAgICBjb25zdCBwYXRoID0gcGFydHMuam9pbihcIi9cIikudHJpbSgpO1xyXG4gICAgICAvL2xvZ2dlci5sb2coREVCVUcsYGV4dHJhY3RMaW5rUGFydHMoJHtsaW5rfSkgLT4gcGF0aDogJHtwYXRofSwgdGl0bGU6ICR7dGl0bGV9YCk7XHJcbiAgICAgIHJldHVybiB7IHBhdGgsIHRpdGxlLCBmaWxlTmFtZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBvbmUgb3IgbW9yZSBsZWFkaW5nIHNsYXNoZXMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBnaXZlbiBwYXRoIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBpbnB1dCBzdHJpbmcgZnJvbSB3aGljaCB0byByZW1vdmUgbGVhZGluZyBzbGFzaGVzLlxyXG4gICAgICogQHJldHVybnMgVGhlIGlucHV0IHN0cmluZyB3aXRob3V0IGFueSBsZWFkaW5nIHNsYXNoZXMuXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUxlYWRpbmdTbGFzaChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICByZXR1cm4gcGF0aC5yZXBsYWNlKC9eXFwvKy8sIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBFbnN1cmVzIHRoYXQgdGhlIGdpdmVuIHBhdGggc3RyaW5nIHN0YXJ0cyB3aXRoIGEgbGVhZGluZyBzbGFzaCAoJy8nKS5cclxuICAgICAqIElmIHRoZSBwYXRoIGFscmVhZHkgYmVnaW5zIHdpdGggYSBzbGFzaCwgaXQgaXMgcmV0dXJuZWQgdW5jaGFuZ2VkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGlucHV0IHBhdGggc3RyaW5nIHRvIG1vZGlmeS5cclxuICAgICAqIEByZXR1cm5zIFRoZSBwYXRoIHN0cmluZyBndWFyYW50ZWVkIHRvIHN0YXJ0IHdpdGggYSBsZWFkaW5nIHNsYXNoLlxyXG4gICAgICovXHJcbiAgICBhZGRMZWFkaW5nU2xhc2gocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgc3RyaW5nIGNvbXBsaWVzIHdpdGggSVNPIFN0YW5kYXJkXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBzdHIgQW55IHN0cmluZ1xyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgT3B0aW9ucyB0byBsb29rIGZvclxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIGlzSVNPU3RyaW5nKFxyXG4gICAgICBzdHI6IHN0cmluZyxcclxuICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgIHdpdGhNaWxsaXNlY29uZHM/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhUaW1lem9uZT86IGJvb2xlYW47XHJcbiAgICAgICAgd2l0aFRpbWU/OiBib29sZWFuO1xyXG4gICAgICAgIHdpdGhEYXRlPzogYm9vbGVhbjsgXHJcbiAgICAgIH0gPSB7fVxyXG4gICAgKTogYm9vbGVhbiB7XHJcbiAgICAgIGNvbnN0IHtcclxuICAgICAgICB3aXRoTWlsbGlzZWNvbmRzID0gZmFsc2UsXHJcbiAgICAgICAgd2l0aFRpbWV6b25lID0gZmFsc2UsXHJcbiAgICAgICAgd2l0aFRpbWUgPSB0cnVlLFxyXG4gICAgICAgIHdpdGhEYXRlID0gdHJ1ZSwgXHJcbiAgICAgIH0gPSBvcHRpb25zO1xyXG4gICAgXHJcbiAgICAgIGxldCBkYXRlUmVnZXhTdHIgPSBcIl4oPzpcXFxcZHs0fS0oPzowWzEtOV18MVswLTJdKS0oPzowWzEtOV18WzEyXVxcXFxkfDNbMDFdKSlcIjtcclxuICAgICAgbGV0IHRpbWVSZWdleFN0ciA9IFwiKD86VCg/OlswMV1cXFxcZHwyWzAtM10pOlswLTVdXFxcXGQ6WzAtNV1cXFxcZFwiO1xyXG4gICAgXHJcbiAgICAgIGlmICh3aXRoTWlsbGlzZWNvbmRzKSB7XHJcbiAgICAgICAgdGltZVJlZ2V4U3RyICs9IFwiXFxcXC5cXFxcZHszfVwiO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgaWYgKHdpdGhUaW1lem9uZSkge1xyXG4gICAgICAgIHRpbWVSZWdleFN0ciArPSBcIig/Olp8WystXSg/OlswMV1cXFxcZHwyWzAtM10pOlswLTVdXFxcXGQpPyk/XCI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGltZVJlZ2V4U3RyICs9IFwiKT9cIjtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGxldCByZWdleFN0ciA9IFwiXCI7XHJcbiAgICAgIGlmICh3aXRoRGF0ZSAmJiB3aXRoVGltZSkge1xyXG4gICAgICAgIHJlZ2V4U3RyID0gYCR7ZGF0ZVJlZ2V4U3RyfSR7dGltZVJlZ2V4U3RyfSRgO1xyXG4gICAgICB9IGVsc2UgaWYgKHdpdGhEYXRlKSB7XHJcbiAgICAgICAgcmVnZXhTdHIgPSBgJHtkYXRlUmVnZXhTdHJ9JGA7XHJcbiAgICAgIH0gZWxzZSBpZiAod2l0aFRpbWUpIHtcclxuICAgICAgICByZWdleFN0ciA9IGBeJHt0aW1lUmVnZXhTdHIuc2xpY2UoNCl9JGA7IFxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTsgXHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocmVnZXhTdHIpO1xyXG4gICAgICByZXR1cm4gcmVnZXgudGVzdChzdHIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUcnkgdG8gY29udmVydCBBbnkgVHlwZXMgdG8gYSBzcGVjaWZpYyBUeXBlXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgXHJcbiAgICAgKiBAcGFyYW0gdHlwZVN0cmluZyAnc3RyaW5nJyB8ICdudW1iZXInIHwgJ2Jvb2xlYW4nIHwgJ3N0cmluZ1tdJ1xyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHRyeUNvbnZlcnQoaW5wdXQ6IGFueSwgdHlwZVN0cmluZzogJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJyB8ICdzdHJpbmdbXScpOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuIHwgc3RyaW5nW10gfCB1bmRlZmluZWQge1xyXG4gICAgICBzd2l0Y2ggKHR5cGVTdHJpbmcpIHtcclxuICAgICAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgICAgY29uc3QgbnVtID0gTnVtYmVyKGlucHV0KTtcclxuICAgICAgICAgIGlmICghaXNOYU4obnVtKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjYXNlICdib29sZWFuJzpcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbG93ZXJWYWx1ZSA9IGlucHV0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgaWYgKGxvd2VyVmFsdWUgPT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChsb3dlclZhbHVlID09PSAnZmFsc2UnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGlucHV0ID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKGlucHV0ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY2FzZSAnc3RyaW5nW10nOlxyXG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpICYmIGlucHV0LmV2ZXJ5KGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICAvKipcclxuICAgICAqIEZvcm1hdHMgYSBnaXZlbiB0ZXh0IHN0cmluZyB0byBiZSBzYWZlIGZvciB1c2UgaW4gWUFNTCBieSByZXBsYWNpbmcgc3BlY2lhbCBjaGFyYWN0ZXJzLlxyXG4gICAgICpcclxuICAgICAqIFJlcGxhY2VzIGFsbCBjaGFyYWN0ZXJzIHRoYXQgYXJlIG5vdCBhbHBoYW51bWVyaWMsIGRhc2gsIHVuZGVyc2NvcmUsIHNsYXNoLCBvciBjZXJ0YWluIGFjY2VudGVkIGNoYXJhY3RlcnNcclxuICAgICAqIHdpdGggYSBzcGVjaWZpZWQgcmVwbGFjZW1lbnQgc3RyaW5nLiBJZiBubyByZXBsYWNlbWVudCBzdHJpbmcgaXMgcHJvdmlkZWQsIGl0IHVzZXMgdGhlIHZhbHVlIGZyb20gc2V0dGluZ3MsXHJcbiAgICAgKiBvciBkZWZhdWx0cyB0byBgJy0nYC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdGV4dCAtIFRoZSBpbnB1dCBzdHJpbmcgdG8gZm9ybWF0LlxyXG4gICAgICogQHBhcmFtIHJlcGxhY2VCeSAtIE9wdGlvbmFsLiBUaGUgc3RyaW5nIHRvIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIHdpdGguIElmIG5vdCBwcm92aWRlZCwgdXNlcyB0aGUgdmFsdWUgZnJvbSBzZXR0aW5ncyBvciBgJy0nYC5cclxuICAgICAqIEByZXR1cm5zIFRoZSBmb3JtYXR0ZWQgc3RyaW5nIHNhZmUgZm9yIFlBTUwgdXNhZ2UuXHJcbiAgICAgKi9cclxuICAgIGZvcm1hdFRvWUFNTFNhdmVTdHJpbmcodGV4dDpzdHJpbmcsIHJlcGxhY2VCeTpzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOnN0cmluZyB7XHJcbiAgICAgIGxldCByZXBsYWNlU3RyaW5nID0gJy0nO1xyXG4gICAgICBpZiAoIXJlcGxhY2VCeSAmJiB0aGlzLnNldHRpbmdzKSB7XHJcbiAgICAgICAgcmVwbGFjZVN0cmluZyA9IHRoaXMuc2V0dGluZ3Muc3BlY2lhbENoYXJSZXBsYWNlbWVudCB8fCAnLSc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHJlcGxhY2VCeSkgcmVwbGFjZVN0cmluZyA9IHJlcGxhY2VCeTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHJlcGxhY2VTdHJpbmcpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBzdHJpbmcgdG8gYSBZQU1MLXNhZmUgZm9ybWF0IGJ5IGFkZGluZyBxdW90ZXMgd2hlbiBuZWNlc3NhcnkuXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgVGhlIHN0cmluZywgYm9vbGVhbiwgbnVtYmVyIG9yIGFycmF5IHRvIG1ha2UgWUFNTC1zYWZlXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgc2FmZWx5IHF1b3RlZCBzdHJpbmcgd2hlbiBuZWVkZWQsIG9yIHRoZSBvcmlnaW5hbCBzdHJpbmcgaWYgc2FmZVxyXG4gICAgICovXHJcbiAgICB0b1lhbWxTYWZlU3RyaW5nKGlucHV0OiBzdHJpbmd8bnVtYmVyfGJvb2xlYW58c3RyaW5nW10pOiBzdHJpbmd8bnVtYmVyfHN0cmluZ1tdIHtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgaW5wdXQuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgIGlucHV0W2luZGV4XSA9IHRoaXMudG9ZYW1sU2FmZVN0cmluZyhpdGVtKS50b1N0cmluZygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICB9XHJcbiAgICAgIHN3aXRjaCAodHlwZW9mIGlucHV0KSB7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzogcmV0dXJuIGlucHV0O1xyXG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOiByZXR1cm4gaW5wdXQgPyAndHJ1ZScgOiAnZmFsc2UnO1xyXG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICAvLyBUcmltIHdoaXRlc3BhY2UgZmlyc3RcclxuICAgICAgICAgIGNvbnN0IHRyaW1tZWQgPSBpbnB1dC50cmltKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIEVtcHR5IHN0cmluZ3MgbmVlZCBxdW90ZXNcclxuICAgICAgICAgIGlmICh0cmltbWVkID09PSAnJykgcmV0dXJuICdcIlwiJztcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIHNwZWNpYWwgY2hhcmFjdGVycy9wYXR0ZXJucyB0aGF0IHJlcXVpcmUgcXVvdGluZ1xyXG4gICAgICAgICAgY29uc3QgbmVlZHNRdW90ZXMgPSAvWzp7fVxcW1xcXSwmKiM/fDw+PSElQGBcIidcXFxcXXxeWy0/XFxuXXxbXFxzXFxuXXxeW3lZbk5dfF5bMC05XXxeWystXXxeKHRydWV8ZmFsc2V8eWVzfG5vfG9ufG9mZikkL2kudGVzdCh0cmltbWVkKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHN0cmluZyBpcyBhbHJlYWR5IHByb3Blcmx5IHF1b3RlZFxyXG4gICAgICAgICAgY29uc3QgaXNBbHJlYWR5UXVvdGVkID0gKHRyaW1tZWQuc3RhcnRzV2l0aCgnXCInKSAmJiB0cmltbWVkLmVuZHNXaXRoKCdcIicpKSB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodHJpbW1lZC5zdGFydHNXaXRoKFwiJ1wiKSAmJiB0cmltbWVkLmVuZHNXaXRoKFwiJ1wiKSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICghbmVlZHNRdW90ZXMgJiYgIWlzQWxyZWFkeVF1b3RlZCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiB0cmltbWVkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBJZiB3ZSBnZXQgaGVyZSwgd2UgbmVlZCBxdW90ZXNcclxuICAgICAgICAgIC8vIFVzZSBkb3VibGUgcXVvdGVzIGFuZCBlc2NhcGUgYW55IGV4aXN0aW5nIGRvdWJsZSBxdW90ZXNcclxuICAgICAgICAgIGlmICghaXNBbHJlYWR5UXVvdGVkKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGBcIiR7dHJpbW1lZC5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBJZiBhbHJlYWR5IHF1b3RlZCwgcmV0dXJuIGFzLWlzXHJcbiAgICAgICAgICByZXR1cm4gdHJpbW1lZDtcclxuICAgICAgICBkZWZhdWx0OiBcclxuICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYHRvWWFtbFNhZmVTdHJpbmcoJHtpbnB1dH0pIGlmIG9mIHR5cGUgJyR7dHlwZW9mIGlucHV0fSdgKTtcclxuICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyBhbiBpbnB1dCBzdHJpbmcgb3IgYXJyYXkgb2Ygc3RyaW5ncyBpbnRvIGEgTWFya2Rvd24gTGluayBmb3JtYXQuXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBpbnB1dCAtIFRoZSBpbnB1dCB0byBiZSBjb252ZXJ0ZWQuIENhbiBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzLlxyXG4gICAgICogQHBhcmFtIHJlcGxhY2VTcGFjZXMgLSBPcHRpb25hbCBwYXJhbWV0ZXIgdG8gc3BlY2lmeSBhIHJlcGxhY2VtZW50IGZvciBzcGFjZXMgaW4gdGhlIHBhdGggb3IgdGl0bGUuXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgIElmIHByb3ZpZGVkLCBzcGFjZXMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIHRoaXMgdmFsdWUuXHJcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyBpbiBNYXJrZG93biBMaW5rIGZvcm1hdCBpZiB0aGUgaW5wdXQgaXMgYSBzaW5nbGUgc3RyaW5nLCBvciBhIGNvbmNhdGVuYXRlZCBzdHJpbmdcclxuICAgICAqICAgICAgICAgIG9mIE1hcmtkb3duIExpbmtzIGlmIHRoZSBpbnB1dCBpcyBhbiBhcnJheSBvZiBzdHJpbmdzLlxyXG4gICAgICogXHJcbiAgICAgKiBUaGUgTWFya2Rvd24gTGluayBmb3JtYXQgaXMgYFt0aXRsZV0ocGF0aClgLCB3aGVyZTpcclxuICAgICAqIC0gYHBhdGhgIGlzIHRoZSBmb3JtYXR0ZWQgcGF0aCBvZiB0aGUgbGluay5cclxuICAgICAqIC0gYHRpdGxlYCBpcyB0aGUgZm9ybWF0dGVkIHRpdGxlIG9mIHRoZSBsaW5rLlxyXG4gICAgICogXHJcbiAgICAgKiBJZiB0aGUgaW5wdXQgaXMgYW4gYXJyYXksIGVhY2ggZWxlbWVudCBpcyBjb252ZXJ0ZWQgdG8gYSBXaWtpTGluayBhbmQgam9pbmVkIHdpdGggYSBjb21tYS5cclxuICAgICAqL1xyXG4gICAgdG9NYXJrZG93bkxpbmsoaW5wdXQ6IGFueSwgcmVwbGFjZVNwYWNlcz86IHN0cmluZyk6IHN0cmluZyB8IHN0cmluZ1tdIHtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0Lm1hcChpdGVtID0+IHRoaXMudG9XaWtpTGluayhpdGVtKSkuam9pbignLCAnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGNvbnN0IHsgcGF0aCwgdGl0bGUsIGZpbGVOYW1lIH0gPSB0aGlzLmV4dHJhY3RQYXRoUGFydHMoaW5wdXQpO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFBhdGggPSB0aGlzLnJlcGxhY2VTcGFjZXMoaW5wdXQsIHJlcGxhY2VTcGFjZXMpO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFRpdGxlID0gdGhpcy5yZXBsYWNlU3BhY2VzKHRpdGxlLCByZXBsYWNlU3BhY2VzKTtcclxuICAgICAgICByZXR1cm4gYFtbJHtmb3JtYXR0ZWRQYXRofXwke2Zvcm1hdHRlZFRpdGxlfV1dYDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIGFuIGlucHV0IHN0cmluZyBvciBhcnJheSBvZiBzdHJpbmdzIGludG8gYSBXaWtpTGluayBmb3JtYXQgc3RyaW5nIG9yIGFycmF5IG9mIHN0cmluZ3MuXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBpbnB1dCAtIFRoZSBpbnB1dCB0byBiZSBjb252ZXJ0ZWQuIENhbiBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzLlxyXG4gICAgICogQHBhcmFtIHJlcGxhY2VTcGFjZXMgLSBPcHRpb25hbCBwYXJhbWV0ZXIgdG8gc3BlY2lmeSBhIHJlcGxhY2VtZW50IGZvciBzcGFjZXMgaW4gdGhlIHBhdGggb3IgdGl0bGUuXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgIElmIHByb3ZpZGVkLCBzcGFjZXMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIHRoaXMgdmFsdWUuXHJcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyBpbiBXaWtpTGluayBmb3JtYXQgaWYgdGhlIGlucHV0IGlzIGEgc2luZ2xlIHN0cmluZywgb3IgYSBjb25jYXRlbmF0ZWQgc3RyaW5nXHJcbiAgICAgKiAgICAgICAgICBvZiBXaWtpTGlua3MgaWYgdGhlIGlucHV0IGlzIGFuIGFycmF5IG9mIHN0cmluZ3MuXHJcbiAgICAgKiBcclxuICAgICAqIFRoZSBXaWtpTGluayBmb3JtYXQgaXMgYFtbZmlsZU5hbWVdXWAsIHdoZXJlOlxyXG4gICAgICogLSBgZmlsZU5hbWVgIGlzIHRoZSBmb3JtYXR0ZWQgdW5pcXVlIGZpbGVOYW1lIG9mIHRoZSBsaW5rLlxyXG4gICAgICogXHJcbiAgICAgKiBJZiB0aGUgaW5wdXQgaXMgYW4gYXJyYXksIGVhY2ggZWxlbWVudCBpcyBjb252ZXJ0ZWQgdG8gYSBXaWtpTGluayBhbmQgam9pbmVkIHdpdGggYSBjb21tYS5cclxuICAgICAqL1xyXG4gICAgdG9XaWtpTGluayhpbnB1dDogYW55LCByZXBsYWNlU3BhY2VzID0gJyAnKTogc3RyaW5nIHwgc3RyaW5nW10ge1xyXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXQuZmxhdE1hcChpdGVtID0+IHRoaXMudG9XaWtpTGluayhpdGVtKSk7XHJcbiAgICAgICAgLy9yZXR1cm4gaW5wdXQubWFwKGl0ZW0gPT4gdGhpcy50b1dpa2lMaW5rKGl0ZW0pKS5qb2luKCcsICcpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgY29uc3QgeyBwYXRoLCB0aXRsZSB9ID0gdGhpcy5leHRyYWN0TGlua1BhcnRzKGlucHV0KTtcclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRUaXRsZSA9IHRoaXMucmVwbGFjZVNwYWNlcyh0aGlzLnJlbW92ZUFsbEV4dGVuc2lvbnModGl0bGUpLCByZXBsYWNlU3BhY2VzKTtcclxuICAgICAgICByZXR1cm4gYFtbJHtmb3JtYXR0ZWRUaXRsZX1dXWA7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXBsYWNlcyBhbGwgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGluIHRoZSBnaXZlbiB0ZXh0IHdpdGggYSBzcGVjaWZpZWQgcmVwbGFjZW1lbnQgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0ZXh0IC0gVGhlIGlucHV0IHN0cmluZyBpbiB3aGljaCBzcGFjZXMgd2lsbCBiZSByZXBsYWNlZC5cclxuICAgICAqIEBwYXJhbSByZXBsYWNlQnkgLSBPcHRpb25hbC4gVGhlIHN0cmluZyB0byByZXBsYWNlIHNwYWNlcyB3aXRoLiBJZiBub3QgcHJvdmlkZWQsIHVzZXMgdGhlIHZhbHVlIGZyb20gYHRoaXMuc2V0dGluZ3Muc3BhY2VSZXBsYWNlbWVudGAgb3IgZGVmYXVsdHMgdG8gJ18nLlxyXG4gICAgICogQHJldHVybnMgVGhlIG1vZGlmaWVkIHN0cmluZyB3aXRoIHNwYWNlcyByZXBsYWNlZCBieSB0aGUgc3BlY2lmaWVkIHJlcGxhY2VtZW50IHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgcmVwbGFjZVNwYWNlcyh0ZXh0OnN0cmluZywgcmVwbGFjZUJ5OnN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCk6c3RyaW5nIHtcclxuICAgICAgbGV0IHJlcGxhY2VTdHJpbmcgPSAnXyc7XHJcbiAgICAgIGlmICghcmVwbGFjZUJ5ICYmIHRoaXMuc2V0dGluZ3MpIHtcclxuICAgICAgICByZXBsYWNlU3RyaW5nID0gdGhpcy5zZXR0aW5ncy5zcGFjZVJlcGxhY2VtZW50IHx8ICdfJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocmVwbGFjZUJ5KSByZXBsYWNlU3RyaW5nID0gcmVwbGFjZUJ5O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoL1xccysvZywgcmVwbGFjZVN0cmluZyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdGhlIEFMTCBmaWxlIGV4dGVuc2lvbihzKSBmcm9tIGEgZ2l2ZW4gZmlsZSBuYW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBmaWxlTmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBmaWxlLCBpbmNsdWRpbmcgaXRzIGV4dGVuc2lvbi5cclxuICAgICAqIEByZXR1cm5zIFRoZSBmaWxlIG5hbWUgd2l0aG91dCBpdHMgZXh0ZW5zaW9uLlxyXG4gICAgICovXHJcbiAgICByZW1vdmVBbGxFeHRlbnNpb25zKGZpbGVOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBmaWxlTmFtZS5zcGxpdCgnLicpWzBdO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBsYXN0IGZpbGUgZXh0ZW5zaW9uKHMpIGZyb20gYSBnaXZlbiBmaWxlIG5hbWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZpbGVOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGZpbGUsIGluY2x1ZGluZyBpdHMgZXh0ZW5zaW9uLlxyXG4gICAgICogQHJldHVybnMgVGhlIGZpbGUgbmFtZSB3aXRob3V0IGl0cyBleHRlbnNpb24uXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUV4dGVuc2lvbnMoZmlsZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZmlsZU5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSB0aGUgbGFzdCBwYXJ0XHJcbiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHJldHVybiBmaWxlTmFtZTsgLy8gbm8gZXh0ZW5zaW9uXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKCcuJykgfHwgZmlsZU5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyBhIGdpdmVuIHN0cmluZyB0byBjYW1lbENhc2UgZm9ybWF0LlxyXG4gICAgICpcclxuICAgICAqIFNwbGl0cyB0aGUgaW5wdXQgdGV4dCBieSBzcGFjZXMsIGxvd2VyY2FzZXMgdGhlIGZpcnN0IHdvcmQsXHJcbiAgICAgKiBhbmQgY2FwaXRhbGl6ZXMgdGhlIGZpcnN0IGxldHRlciBvZiBlYWNoIHN1YnNlcXVlbnQgd29yZCxcclxuICAgICAqIHRoZW4gam9pbnMgdGhlbSB0b2dldGhlciB3aXRob3V0IHNwYWNlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdGV4dCAtIFRoZSBpbnB1dCBzdHJpbmcgdG8gYmUgY29udmVydGVkLlxyXG4gICAgICogQHJldHVybnMgVGhlIGNhbWVsQ2FzZSBmb3JtYXR0ZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRVcHBlckNhbWVsQ2FzZSh0ZXh0OnN0cmluZyk6c3RyaW5nIHtcclxuICAgICAgbGV0IHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoJyAnKTtcclxuICAgICAgbGV0IGNvbnZlcnRlZFRleHRQYXJ0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgICB0ZXh0UGFydHMuZm9yRWFjaCgodGV4dCxpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXdUZXh0UGFydCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgY29udmVydGVkVGV4dFBhcnRzLnB1c2gobmV3VGV4dFBhcnQpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIGdldCB0aGUgcGF0aCB0byBhIGZpbGUgZnJvbSBhIHN0cmluZyBjb250YWluaW5nIHRoZSBmdWxsIHBhcmgvbmFtZSBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBwYXRoIHN0cmluZ1xyXG4gICAgICogQHBhcmFtIHNlcGFyYXRvciBzdHJpbmcgZGVmYXVsdHMgdG8gJy8nXHJcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcclxuICAgICAqL1xyXG4gICAgZ2V0Rm9sZGVyRnJvbVBhdGggKHBhdGg6c3RyaW5nfG51bGx8dW5kZWZpbmVkLCBzZXBhcmF0b3IgPSAnLycpIHtcclxuICAgICAgICBpZiAocGF0aCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKHBhdGggPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBjdXJyZW50UGF0aFBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGN1cnJlbnRQYXRoUGFydHMucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWU7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQYXRoUGFydHMuam9pbihzZXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIHJlbW92ZXMgZHVwbGljYXRlIHN0cmluZ3MgaW4gYW4gYXJyYXkgYW5kIGRlbGV0ZXMgZW1wdHkgc3RyaW5nc1xyXG4gICAgICogQHBhcmFtIHN0cmluZ0FycmF5IFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUR1cGxpY2F0ZVN0cmluZ3Moc3RyaW5nQXJyYXk6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICBpZiAoIXN0cmluZ0FycmF5KSByZXR1cm4gW107XHJcbiAgICAgIGNvbnN0IHVuaXF1ZVN0cmluZ3NTZXQgPSBuZXcgU2V0PHN0cmluZz4oc3RyaW5nQXJyYXkpO1xyXG4gICAgICB1bmlxdWVTdHJpbmdzU2V0LmRlbGV0ZSgnJyk7IC8vIHJlbW92ZSBlbXB0eSBzdHJpbmdzXHJcbiAgICAgIHJldHVybiBbLi4udW5pcXVlU3RyaW5nc1NldF07XHJcbiAgICB9XHJcbiAgfVxyXG4vKipcclxuICogZ2V0IHRoZSBwYXRoIHRvIGEgZmlsZSBmcm9tIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIGZ1bGwgcGFyaC9uYW1lIHN0cmluZ1xyXG4gKiBAcGFyYW0gcGF0aCBzdHJpbmdcclxuICogQHBhcmFtIHNlcGFyYXRvciBzdHJpbmcgZGVmYXVsdHMgdG8gJy8nXHJcbiAqIEByZXR1cm5zIHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRlckZyb21QYXRoIChwYXRoOnN0cmluZ3xudWxsfHVuZGVmaW5lZCwgc2VwYXJhdG9yID0gJy8nKSB7XHJcbiAgICBpZiAocGF0aCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAocGF0aCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgY29uc3QgY3VycmVudFBhdGhQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgIGN1cnJlbnRQYXRoUGFydHMucG9wKCk7IC8vIHJlbW92ZSBGaWxlIG5hbWU7XHJcbiAgICByZXR1cm4gY3VycmVudFBhdGhQYXJ0cy5qb2luKHNlcGFyYXRvcik7XHJcbn1cclxuICAgICIsICJpbXBvcnQgeyBNb2RhbCwgQXBwLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIGRpc3BsYXkgYW4gQWxlcnQgTW9kYWxcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbGVydE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSByZXNvbHZlUHJvbWlzZSE6ICh2YWx1ZToge3Byb2NlZWQ6Ym9vbGVhbiwgZGF0YTphbnl9KSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBwcm9taXNlOiBQcm9taXNlPHtwcm9jZWVkOmJvb2xlYW4sIGRhdGE6YW55fT47XHJcbiAgICBwcml2YXRlIGJ0bjFUZXh0OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGJ0bjJUZXh0OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGNoZWNrYm94RWwhOiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBhc2tBZ2FpbkxhYmVsOiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgYnRuMTogc3RyaW5nLCBidG4yOnN0cmluZywgYXNrQWdhaW5MYWJlbD86IHN0cmluZyB8IHVuZGVmaW5lZCkge1xyXG4gICAgICBzdXBlcihhcHApO1xyXG4gICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgICAgdGhpcy5idG4xVGV4dCA9IGJ0bjE7XHJcbiAgICAgIHRoaXMuYnRuMlRleHQgPSBidG4yO1xyXG4gICAgICB0aGlzLmFza0FnYWluTGFiZWwgPSBhc2tBZ2FpbkxhYmVsO1xyXG4gICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgXHJcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IHRoaXMudGl0bGUgfSk7XHJcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogdGhpcy5kZXNjcmlwdGlvbiB9KTtcclxuICBcclxuICAgICAgY29uc3Qgc2V0dGluZ3MgPSBuZXcgU2V0dGluZyhjb250ZW50RWwpO1xyXG4gICAgICBpZiAodGhpcy5hc2tBZ2FpbkxhYmVsKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbUluZm9EaXYgPSBzZXR0aW5ncy5zZXR0aW5nRWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2V0dGluZy1pdGVtLWluZm8nKVswXTtcclxuICAgICAgICBpZiAoaXRlbUluZm9EaXYpIHtcclxuICAgICAgICAgIHRoaXMuY2hlY2tib3hFbCA9IGl0ZW1JbmZvRGl2LmNyZWF0ZUVsKCdpbnB1dCcsIHsgdHlwZTogJ2NoZWNrYm94JyB9KTtcclxuICAgICAgICAgIGNvbnN0IGxhYmVsID0gaXRlbUluZm9EaXYuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiB0aGlzLmFza0FnYWluTGFiZWwgfSk7XHJcbiAgICAgICAgICBsYWJlbC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzhweCc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHNldHRpbmdzLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCh0aGlzLmJ0bjFUZXh0KVxyXG4gICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHtwcm9jZWVkOnRydWUsIGRhdGE6e2Fza0NvbmZpcm1hdGlvbjogdGhpcy5jaGVja2JveEVsPy5jaGVja2VkfX0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICBzZXR0aW5ncy5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQodGhpcy5idG4yVGV4dClcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHtwcm9jZWVkOmZhbHNlLCBkYXRhOnthc2tDb25maXJtYXRpb246IHRoaXMuY2hlY2tib3hFbD8uY2hlY2tlZH19KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhc3luYyBvcGVuQW5kR2V0VmFsdWUoKTogUHJvbWlzZTx7cHJvY2VlZDpib29sZWFuLCBkYXRhOmFueX0+IHtcclxuICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLnByb21pc2U7XHJcbiAgICB9XHJcbiAgfSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIE9ic2lkaWFuUHJvcGVydHlUeXBlcyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBFUlJPUiwgbG9nZ2VyLCBXQVJOSU5HIH0gZnJvbSBcIi4uL0xvZ1wiO1xyXG5cclxuZXhwb3J0IHR5cGUgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVUeXBlcyA9ICdidWlsZEluJyB8ICdidWlsZEluLmlucHV0UHJvcGVydHknIHwgJ2F1dG9jb21wbGV0ZS5tb2RhbCcgfCAnYXV0b21hdGlvbicgfCAnc2NyaXB0JyB8ICdmb3JtYXR0ZXInIHwgJ2xpbmtGb3JtYXR0ZXInIDtcclxuLyoqXHJcbiAqIFRoZSBgUnVsZUNvbmZpZ0VsZW1lbnRzYCBpbnRlcmZhY2UgZGVmaW5lcyB0aGUgY29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBhIHJ1bGUuXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQGludGVyZmFjZSBSdWxlQ29uZmlnRWxlbWVudHNcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUnVsZUNvbmZpZ0VsZW1lbnRzIHtcclxuICAgIFtrZXk6IHN0cmluZ106IGJvb2xlYW47IC8vIEFsbG93IHN0cmluZyBrZXlzIHdpdGggYm9vbGVhbiB2YWx1ZXNcclxuICAgIHJlbW92ZUNvbnRlbnQ6IGJvb2xlYW47XHJcbiAgICBydWxlQWN0aXZlOiBib29sZWFuO1xyXG4gICAgbW9kaWZ5T25seTogYm9vbGVhbjtcclxuICAgIGlucHV0UHJvcGVydHk6IGJvb2xlYW47XHJcbiAgICBhZGRQcmVmaXg6IGJvb2xlYW47XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBib29sZWFuO1xyXG4gICAgc3BlY2lhbENoYXJhY3RlclJlcGxhY2VtZW50OiBib29sZWFuO1xyXG4gICAgY29udmVydFRvTG93ZXJDYXNlOiBib29sZWFuO1xyXG4gICAgcmVzdWx0QXNMaW5rOiBib29sZWFuO1xyXG4gICAgYWRkQ29udGVudDogYm9vbGVhbjtcclxuICAgIGV4Y2x1ZGVGb2xkZXJzOiBib29sZWFuO1xyXG4gICAgaW5jbHVkZUZvbGRlcnM6IGJvb2xlYW47XHJcbiAgICBzY3JpcHQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIHJ1bGVzQ29uZmlnRGl2OiBIVE1MRGl2RWxlbWVudCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcclxuICAgIHNjcmlwdGluZ1Rvb2xzOiBTY3JpcHRpbmdUb29scztcclxuICAgIGlkITogc3RyaW5nO1xyXG4gICAgbmFtZSE6IHN0cmluZztcclxuICAgIGRlc2NyaXB0aW9uITogc3RyaW5nO1xyXG4gICAgcnVsZVR5cGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlVHlwZXMgPSAnYnVpbGRJbic7XHJcbiAgICBpc0xpdmVSdWxlOiBib29sZWFuID0gZmFsc2U7IC8vIElmIHRydWUsIHRoZSBydWxlIGlzIGEgbGl2ZSBydWxlIGFuZCB3aWxsIGJlIGV4ZWN1dGVkIG9uIGZpbGUgY2hhbmdlXHJcbiAgICB0eXBlOiBzdHJpbmdbXSA9IFsndGV4dCddOyAvLyBUeXBlcyB0aGF0IGFyZSBzdXBwb3J0ZWQgYnkgdGhpcyBydWxlXHJcbiAgICBjb25maWdFbGVtZW50czogUnVsZUNvbmZpZ0VsZW1lbnRzIHwgb2JqZWN0ID0ge307IC8vIEVsZW1lbnRzIHRoYXQgYXJlIHVzZWQgdG8gY29uZmlndXJlIHRoZSBydWxlXHJcbiAgICBzb3VyY2U6IHN0cmluZyA9ICdmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSBcXCdcXCdcXG4gIHJldHVybiByZXN1bHQ7XFxufSc7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwPzogQXBwIHwgdW5kZWZpbmVkLCBwbHVnaW4/OiBhbnl8IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRoaXMuc2NyaXB0aW5nVG9vbHMgPSBuZXcgU2NyaXB0aW5nVG9vbHMoYXBwLCBwbHVnaW4pO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRTb3VyY2UoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBhbnksIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ/OmFueSkgeyAvLyBEZWZhdWx0IGZ1bmN0aW9uIHNpZ25hdHVyZVxyXG4gICAgICAgIGlmIChpbnB1dCA9PT0gdW5kZWZpbmVkIHx8IGlucHV0ID09PSBudWxsKSBpbnB1dCA9IHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7IC8vIEdldCB0aGUgY3VycmVudCBjb250ZW50IG9mIHByb3BlcnR5XHJcbiAgICAgICAgcmV0dXJuIGlucHV0OyAvLyBSZXR1cm4gdGhlIGlucHV0IHVuYWx0ZXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbmZpZ3VyZXMgdGhlIHNldHRpbmdzIHRhYiBmb3IgYSBzcGVjaWZpYyBydWxlIGluIHRoZSBwbHVnaW4uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG9wdGlvbkVMIC0gVGhlIEhUTUwgZWxlbWVudCB3aGVyZSB0aGUgY29uZmlndXJhdGlvbiBvcHRpb25zIHdpbGwgYmUgcmVuZGVyZWQuXHJcbiAgICAgKiBAcGFyYW0gcnVsZSAtIFRoZSBzZXR0aW5ncyBvYmplY3QgZm9yIHRoZSBmcm9udG1hdHRlciBhdXRvbWF0aW9uIHJ1bGUuXHJcbiAgICAgKiBAcGFyYW0gdGhhdCAtIFRoZSBjb250ZXh0IG9yIHJlZmVyZW5jZSB0byB0aGUgY2FsbGluZyBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0gcHJldmlld0NvbXBvbmVudCAtIFRoZSBjb21wb25lbnQgdXNlZCB0byByZW5kZXIgYSBwcmV2aWV3IG9mIHRoZSBydWxlJ3MgZWZmZWN0LlxyXG4gICAgICovXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgb3B0aW9uRUwuZW1wdHkoKTtcclxuICAgIH07XHJcblxyXG4gICAgZGVmYXVsdENvbmZpZ0VsZW1lbnRzKG1vZGlmaWVyczogUnVsZUNvbmZpZ0VsZW1lbnRzIHwgYW55KTogUnVsZUNvbmZpZ0VsZW1lbnRzIHtcclxuICAgICAgICBjb25zdCBjb25maWdFbGVtZW50czogUnVsZUNvbmZpZ0VsZW1lbnRzID0ge1xyXG4gICAgICAgICAgICByZW1vdmVDb250ZW50OiB0cnVlLFxyXG4gICAgICAgICAgICBydWxlQWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICBtb2RpZnlPbmx5OiB0cnVlLFxyXG4gICAgICAgICAgICBpbnB1dFByb3BlcnR5OiBmYWxzZSxcclxuICAgICAgICAgICAgYWRkUHJlZml4OiB0cnVlLFxyXG4gICAgICAgICAgICBzcGFjZVJlcGxhY2VtZW50OiB0cnVlLFxyXG4gICAgICAgICAgICBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbnZlcnRUb0xvd2VyQ2FzZTogdHJ1ZSxcclxuICAgICAgICAgICAgcmVzdWx0QXNMaW5rOiB0cnVlLFxyXG4gICAgICAgICAgICBhZGRDb250ZW50OiB0cnVlLFxyXG4gICAgICAgICAgICBleGNsdWRlRm9sZGVyczogdHJ1ZSxcclxuICAgICAgICAgICAgaW5jbHVkZUZvbGRlcnM6IHRydWUsXHJcbiAgICAgICAgICAgIHNjcmlwdDogdHJ1ZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb25maWdFbGVtZW50cywgbW9kaWZpZXJzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGlmIGEgc3BlY2lmaWMgcnVsZSBvcHRpb24gaXMgZW5hYmxlZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9uIC0gVGhlIG5hbWUgb2YgdGhlIHJ1bGUgb3B0aW9uIHRvIGNoZWNrLlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gUmV0dXJucyB0cnVlIGlmIHRoZSBvcHRpb24gaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICB1c2VSdWxlT3B0aW9uKG9wdGlvbjpzdHJpbmcpOmJvb2xlYW4ge1xyXG4gICAgICAgIGlmICgodGhpcy5jb25maWdFbGVtZW50cyBhcyBSdWxlQ29uZmlnRWxlbWVudHMpW29wdGlvbl0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAodGhpcy5jb25maWdFbGVtZW50cyBhcyBSdWxlQ29uZmlnRWxlbWVudHMpW29wdGlvbl0gfHwgZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiB0aGUgcnVsZSBoYXMgYW55IGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBSZXR1cm5zIHRydWUgaWYgdGhlIHJ1bGUgaGFzIG9wdGlvbnMsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgaGFzT3duQ29uZmlnVGFiKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgcmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5jb25maWdUYWIgIT09IFJ1bGVQcm90b3R5cGUucHJvdG90eXBlLmNvbmZpZ1RhYjtcclxuICAgIH0gICBcclxuICAgIC8qKlxyXG4gICAgICogRXhlY3V0ZXMgdGhlIGBmeGAgZnVuY3Rpb24gYmFzZWQgb24gdGhlIGBydWxlVHlwZWAuXHJcbiAgICAgKiBIYW5kbGVzIGRpZmZlcmVudCBmdW5jdGlvbiBzaWduYXR1cmVzIGR5bmFtaWNhbGx5LlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge0FwcH0gYXBwIC0gVGhlIE9ic2lkaWFuIGFwcCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSB7YW55fSBmaWxlIC0gVGhlIGZpbGUgdG8gcGFzcyB0byB0aGUgcnVsZSdzIGBmeGAgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0ge1NjcmlwdGluZ1Rvb2xzfSB0b29scyAtIFRoZSBzY3JpcHRpbmcgdG9vbHMgdG8gcGFzcyB0byB0aGUgcnVsZSdzIGBmeGAgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0ge2FueX0gW2lucHV0XSAtIE9wdGlvbmFsIGlucHV0IGZvciBydWxlcyB0aGF0IHJlcXVpcmUgaXQgKGUuZy4sIGBidWlsZEluLmlucHV0UHJvcGVydHlgKS5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IC0gVGhlIHJlc3VsdCBvZiB0aGUgYGZ4YCBmdW5jdGlvbi5cclxuICAgICovXHJcbiAgICBleGVjdXRlKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBhbnksIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ/OiBhbnkpOiBzdHJpbmcge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5ydWxlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdmb3JtYXR0ZXInOlxyXG4gICAgICAgICAgICBjYXNlICdsaW5rRm9ybWF0dGVyJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZ4KGFwcCwgZmlsZSwgdG9vbHMsIGlucHV0KTsgLy8gYGZvcm1hdHRlcmAgcnVsZXMgZXhwZWN0IChpbnB1dCwgdG9vbHMpXHJcblxyXG4gICAgICAgICAgICBjYXNlICdidWlsZEluLmlucHV0UHJvcGVydHknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZngoYXBwLCBmaWxlLCB0b29scywgaW5wdXQpOyAvLyBgYnVpbGRJbi5pbnB1dFByb3BlcnR5YCBydWxlcyBleHBlY3QgKGFwcCwgZmlsZSwgdG9vbHMsIGlucHV0KVxyXG5cclxuICAgICAgICAgICAgY2FzZSAnYXV0b2NvbXBsZXRlLm1vZGFsJzpcclxuICAgICAgICAgICAgY2FzZSAnYXV0b21hdGlvbic6XHJcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYXN5bmMgZnVuY3Rpb25zIGJ5IHJlc29sdmluZyB0aGUgUHJvbWlzZSBzeW5jaHJvbm91c2x5XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZ4KGFwcCwgZmlsZSwgdG9vbHMpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlczogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlcztcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgRXJyb3IgZXhlY3V0aW5nIGFzeW5jIGF1dG9tYXRpb24gcnVsZTogJHtlcnJ9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyBSZXR1cm4gdGhlIHJlc29sdmVkIHJlc3VsdCBhcyBhIHN0cmluZ1xyXG5cclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZ4KGFwcCwgZmlsZSwgdG9vbHMpOyAvLyBEZWZhdWx0IHJ1bGVzIGV4cGVjdCAoYXBwLCBmaWxlLCB0b29scylcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBgUnVsZXNgIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciBtYW5hZ2luZyBhbmQgb3JnYW5pemluZyBhIGNvbGxlY3Rpb24gb2YgcnVsZXMuXHJcbiAqIEl0IHByb3ZpZGVzIG1ldGhvZHMgdG8gcmVnaXN0ZXIgbmV3IHJ1bGVzIGFuZCByZXRyaWV2ZSBydWxlcyBiYXNlZCBvbiB0aGVpciB0eXBlLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIGNsYXNzIGlzIGRlc2lnbmVkIHRvIHdvcmsgd2l0aGluIHRoZSBjb250ZXh0IG9mIGFuIE9ic2lkaWFuIHBsdWdpbiBhbmQgcmVsaWVzIG9uXHJcbiAqIHRoZSBgQXBwYCBhbmQgYHBsdWdpbmAgaW5zdGFuY2VzIGZvciBpdHMgZnVuY3Rpb25hbGl0eS4gUnVsZXMgYXJlIHN0b3JlZCBhcyBhbiBhcnJheVxyXG4gKiBvZiBgUnVsZVByb3RvdHlwZWAgb2JqZWN0cy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlc01hbmFnZXIgPSBuZXcgUnVsZXMoYXBwLCBwbHVnaW4pO1xyXG4gKiBydWxlc01hbmFnZXIucmVnaXN0ZXJSdWxlKHtcclxuICogICBpZDogXCJleGFtcGxlLXJ1bGVcIixcclxuICogICBuYW1lOiBcIkV4YW1wbGUgUnVsZVwiLFxyXG4gKiAgIHJ1bGVUeXBlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVR5cGVzLlNvbWVUeXBlLFxyXG4gKiB9KTtcclxuICogY29uc3QgZmlsdGVyZWRSdWxlcyA9IHJ1bGVzTWFuYWdlci5nZXRSdWxlc0J5VHlwZShGcm9udG1hdHRlckF1dG9tYXRlUnVsZVR5cGVzLlNvbWVUeXBlKTtcclxuICogY29uc29sZS5sb2coZmlsdGVyZWRSdWxlcyk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZXMge1xyXG4gICAgYXBwOiBBcHAgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XHJcbiAgICBwbHVnaW46IGFueSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcclxuICAgIHJ1bGVzOiBSdWxlUHJvdG90eXBlW107XHJcbiAgICB0b29sczogU2NyaXB0aW5nVG9vbHMgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwPzogQXBwIHwgdW5kZWZpbmVkLCBwbHVnaW4/OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB0aGlzLnRvb2xzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMucnVsZXMgPSBbXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaW5pdCAoYXBwOiBBcHAsIHBsdWdpbjogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnRvb2xzID0gdG9vbHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlcnMgYSBuZXcgcnVsZSBieSBhZGRpbmcgaXQgdG8gdGhlIGxpc3Qgb2YgZXhpc3RpbmcgcnVsZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJ1bGUgLSBUaGUgcnVsZSBwcm90b3R5cGUgdG8gYmUgcmVnaXN0ZXJlZC4gVGhpcyBzaG91bGQgY29uZm9ybSB0byB0aGUgYFJ1bGVQcm90b3R5cGVgIGludGVyZmFjZS5cclxuICAgICAqL1xyXG4gICAgcmVnaXN0ZXJSdWxlKHJ1bGU6IFJ1bGVQcm90b3R5cGUpIHtcclxuICAgICAgICB0aGlzLnJ1bGVzLnB1c2gocnVsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgYSBsaXN0IG9mIHJ1bGVzIGZpbHRlcmVkIGJ5IHRoZSBzcGVjaWZpZWQgcnVsZSB0eXBlIGFuZCBwcm9wZXJ0eSB0eXBlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHJ1bGUgdG8gZmlsdGVyIGJ5LlxyXG4gICAgICogQHBhcmFtIHByb3BlcnR5VHlwZSAtIFRoZSBwcm9wZXJ0eSB0eXBlIHRvIGZpbHRlciBieSB3aXRoaW4gdGhlIHJ1bGUncyB0eXBlIGFycmF5LlxyXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygb2JqZWN0cyBjb250YWluaW5nIHRoZSBgaWRgIGFuZCBgbmFtZWAgb2YgZWFjaCBtYXRjaGluZyBydWxlLCBzb3J0ZWQgYWxwaGFiZXRpY2FsbHkgYnkgbmFtZS5cclxuICAgICAqL1xyXG4gICAgZ2V0UnVsZXNCeVR5cGUocnVsZVR5cGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlVHlwZXMsIHByb3BlcnR5VHlwZT86IE9ic2lkaWFuUHJvcGVydHlUeXBlcyk6IEFycmF5PHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmd9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucnVsZXNcclxuICAgICAgICAgICAgLmZpbHRlcihydWxlID0+IHJ1bGUucnVsZVR5cGUgPT09IHJ1bGVUeXBlICYmICghcHJvcGVydHlUeXBlIHx8IHJ1bGUudHlwZS5pbmNsdWRlcyhwcm9wZXJ0eVR5cGUpKSkgLy8gRmlsdGVyIHJ1bGVzIGJ5IHJ1bGVUeXBlIGFuZCBwcm9wZXJ0eVR5cGVcclxuICAgICAgICAgICAgLm1hcChydWxlID0+ICh7IGlkOiBydWxlLmlkLCBuYW1lOiBydWxlLm5hbWUgfSkpIC8vIE1hcCB0byB7aWQsIG5hbWV9XHJcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTsgLy8gU29ydCBhbHBoYWJldGljYWxseSBieSBuYW1lXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgYSBydWxlIG9iamVjdCBieSBpdHMgdW5pcXVlIGlkZW50aWZpZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBydWxlIHRvIHJldHJpZXZlLlxyXG4gICAgICogQHJldHVybnMgVGhlIHJ1bGUgb2JqZWN0IG1hdGNoaW5nIHRoZSBwcm92aWRlZCBJRCwgb3IgYHVuZGVmaW5lZGAgaWYgbm8gbWF0Y2hpbmcgcnVsZSBpcyBmb3VuZC5cclxuICAgICAqIEB0aHJvd3MgTG9ncyBhIHdhcm5pbmcgdG8gdGhlIGNvbnNvbGUgaWYgdGhlIHJ1bGUgd2l0aCB0aGUgc3BlY2lmaWVkIElEIGlzIG5vdCBmb3VuZC5cclxuICAgICAqL1xyXG4gICAgZ2V0UnVsZUJ5SWQoaWQ6IHN0cmluZyk6IFJ1bGVQcm90b3R5cGUgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGNvbnN0IHJ1bGVPYmplY3QgPSB0aGlzLnJ1bGVzLmZpbmQocnVsZSA9PiBydWxlLmlkID09PSBpZCk7XHJcbiAgICAgICAgaWYgKCFydWxlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5sb2coV0FSTklORyxgUnVsZSB3aXRoIGlkIFwiJHtpZH1cIiBub3QgZm91bmQuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBydWxlT2JqZWN0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgdGhlIHNvdXJjZSBjb2RlIG9mIGEgcnVsZSBieSBpdHMgdW5pcXVlIGlkZW50aWZpZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBydWxlIGZvciB3aGljaCB0byByZXRyaWV2ZSB0aGUgc291cmNlIGNvZGUuXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgc291cmNlIGNvZGUgb2YgdGhlIHJ1bGUsIG9yIGB1bmRlZmluZWRgIGlmIHRoZSBydWxlIGlzIG5vdCBmb3VuZC5cclxuICAgICAqL1xyXG4gICAgZ2V0U291cmNlKGlkOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGNvbnN0IHJ1bGVPYmplY3QgPSB0aGlzLmdldFJ1bGVCeUlkKGlkKTtcclxuICAgICAgICBpZiAoIXJ1bGVPYmplY3QpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZyhXQVJOSU5HLGBTb3VyY2UgZm9yIHJ1bGUgd2l0aCBpZCBcIiR7aWR9XCIgbm90IGZvdW5kLmApO1xyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcnVsZU9iamVjdC5nZXRTb3VyY2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4ZWN1dGVzIHRoZSBgZnhgIGZ1bmN0aW9uIG9mIGEgcnVsZSBtYXRjaGluZyB0aGUgZ2l2ZW4gYGlkYCBhbmQgcmV0dXJucyBpdHMgcmVzdWx0LlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bGUgdG8gZXhlY3V0ZS5cclxuICAgICAqIEBwYXJhbSB7QXBwfSBhcHAgLSBUaGUgT2JzaWRpYW4gYXBwIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIHthbnl9IGZpbGUgLSBUaGUgZmlsZSB0byBwYXNzIHRvIHRoZSBydWxlJ3MgYGZ4YCBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSB7U2NyaXB0aW5nVG9vbHN9IHRvb2xzIC0gVGhlIHNjcmlwdGluZyB0b29scyB0byBwYXNzIHRvIHRoZSBydWxlJ3MgYGZ4YCBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSB7YW55fSBbaW5wdXRdIC0gT3B0aW9uYWwgaW5wdXQgZm9yIHJ1bGVzIHRoYXQgcmVxdWlyZSBpdC5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmcgfCBudWxsfSAtIFRoZSByZXN1bHQgb2YgdGhlIGBmeGAgZnVuY3Rpb24sIG9yIGBudWxsYCBpZiB0aGUgcnVsZSBpcyBub3QgZm91bmQuXHJcbiAgICAqL1xyXG4gICAgZXhlY3V0ZVJ1bGVCeUlkKGlkOiBzdHJpbmcsIHJ1bGVTZXR0aW5nczogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IGFueSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dD86IGFueSk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0aGlzLnJ1bGVzLmZpbmQocnVsZSA9PiBydWxlLmlkID09PSBpZCk7XHJcbiAgICAgICAgaWYgKCFydWxlKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5sb2coV0FSTklORyxgUnVsZSB3aXRoIGlkIFwiJHtpZH1cIiBub3QgZm91bmQuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRlUnVsZShydWxlU2V0dGluZ3MsIHJ1bGUsIGFwcCwgZmlsZSwgdG9vbHMsIGlucHV0KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRXhlY3V0ZXMgdGhlIGBmeGAgZnVuY3Rpb24gb2YgYSBnaXZlbiBydWxlIGFuZCByZXR1cm5zIGl0cyByZXN1bHQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJ1bGUgLSBUaGUgcnVsZSB0byBleGVjdXRlLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBhcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gZmlsZSAtIFRoZSBmaWxlIHRvIHBhc3MgdG8gdGhlIHJ1bGUncyBgZnhgIGZ1bmN0aW9uLlxyXG4gICAgICogQHBhcmFtIHRvb2xzIC0gVGhlIHNjcmlwdGluZyB0b29scyB0byBwYXNzIHRvIHRoZSBydWxlJ3MgYGZ4YCBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSBpbnB1dCAtIE9wdGlvbmFsIGlucHV0IGZvciBydWxlcyB0aGF0IHJlcXVpcmUgaXQuXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nIHwgbnVsbH0gLSBUaGUgcmVzdWx0IG9mIHRoZSBgZnhgIGZ1bmN0aW9uLCBvciBgbnVsbGAgaWYgdGhlIHJ1bGUgaXMgbm90IGZvdW5kLlxyXG4gICAgICovXHJcbiAgICBleGVjdXRlUnVsZShydWxlU2V0dGluZ3M6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHJ1bGU6IFJ1bGVQcm90b3R5cGUsIGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBhbnksIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ/OiBhbnkpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgICAgICBzd2l0Y2ggKHJ1bGUucnVsZVR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSAnZm9ybWF0dGVyJzpcclxuICAgICAgICAgICAgY2FzZSAnbGlua0Zvcm1hdHRlcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ2J1aWxkSW4uaW5wdXRQcm9wZXJ0eSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5leGVjdXRlKGFwcCwgZmlsZSwgdG9vbHMsIGlucHV0KTtcclxuICAgICAgICAgICAgY2FzZSAnYXV0b21hdGlvbic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcnVsZS5leGVjdXRlKGFwcCwgZmlsZSwgdG9vbHMpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgaWYgKHJ1bGVTZXR0aW5ncy51c2VDdXN0b21Db2RlICYmIHJ1bGVTZXR0aW5ncy5idWlsZEluQ29kZSAmJiBydWxlU2V0dGluZ3MuYnVpbGRJbkNvZGUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJ1bGUgaGFzIGN1c3RvbSBjb2RlLCBleGVjdXRlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZSA9IHBhcnNlSlNDb2RlKHJ1bGVTZXR0aW5ncy5idWlsZEluQ29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb2RlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlKGFwcCwgZmlsZSwgdG9vbHMpOyAvLyBQYXNzIGlucHV0IGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYEludmFsaWQgY3VzdG9tIGNvZGUgZm9yIHJ1bGUgXCIke3J1bGVTZXR0aW5ncy5jb250ZW50fVwiOiAke3J1bGVTZXR0aW5ncy5idWlsZEluQ29kZX1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBJbnZhbGlkIGN1c3RvbSBjb2RlIGZvciBydWxlIFwiJHtydWxlU2V0dGluZ3MuaWR9XCJgO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGUuZXhlY3V0ZShhcHAsIGZpbGUsIHRvb2xzLCBpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFwcGx5Rm9ybWF0T3B0aW9ucyh2YWx1ZTphbnksIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgYWN0aXZlRmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scyApOmFueSB7XHJcblxyXG4gICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdudW1iZXInIHx8IHJ1bGUudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBydWxlLnR5cGUgPT09ICdkYXRlJyB8fCBydWxlLnR5cGUgPT09ICdkYXRldGltZScpIHJldHVybiB2YWx1ZTsgLy8gbGVhdmUgZGF0ZSBhbmQgZGF0ZVRpbWUgdW50b3VjaGVkXHJcblxyXG4gICAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XHJcbiAgICAgICAgICBjYXNlICdib29sZWFuJzpcclxuICAgICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICAgICAgICAgIC8vaWYgKHJ1bGUuc3BhY2VSZXBsYWNlbWVudCAmJiBydWxlLnNwYWNlUmVwbGFjZW1lbnQgIT09ICcnKSB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1xccysvZywgcnVsZS5zcGFjZVJlcGxhY2VtZW50KTtcclxuICAgICAgICAgICAgLy9pZiAocnVsZS5zcGVjaWFsQ2hhclJlcGxhY2VtZW50ICYmIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCAhPT0nJykgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XHJcbiAgICAgICAgICAgIGlmIChydWxlLmZvcm1hdHRlcnMgJiYgcnVsZS5mb3JtYXR0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICBydWxlLmZvcm1hdHRlcnMuZm9yRWFjaChmb3JtYXR0ZXJJZCA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZXhlY3V0ZVJ1bGVCeUlkKGZvcm1hdHRlcklkLCBydWxlLCB0aGlzLmFwcCwgYWN0aXZlRmlsZSwgdG9vbHMsIHZhbHVlKTsgLy8gZXhlY3V0ZSB0aGUgZm9ybWF0dGVyIHJ1bGVcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocnVsZS5saW5rRm9ybWF0dGVyICYmIHJ1bGUubGlua0Zvcm1hdHRlciAhPT0gJycpIHtcclxuICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZXhlY3V0ZVJ1bGVCeUlkKHJ1bGUubGlua0Zvcm1hdHRlciwgcnVsZSwgdGhpcy5hcHAsIGFjdGl2ZUZpbGUsIHRvb2xzLCB2YWx1ZSk7IC8vIGV4ZWN1dGUgdGhlIGxpbmsgZm9ybWF0dGVyIHJ1bGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2lmIChydWxlLnByZWZpeCAmJiBydWxlLnByZWZpeCAhPT0gJycpIHZhbHVlID0gcnVsZS5wcmVmaXggKyB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlXHJcbiAgICAgICAgICBjYXNlICdvYmplY3QnOlxyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWUubWFwKHZhbHVlID0+IHRoaXMuYXBwbHlGb3JtYXRPcHRpb25zKHZhbHVlLCBydWxlLCBhY3RpdmVGaWxlLCB0b29scykpOyAvLyBwYXNzIGFjdGl2ZUZpbGUgYW5kIHRvb2xzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBtZXJnZVJlc3VsdChyZXN1bHQ6IGFueSwgb2xkUmVzdWx0OiBhbnksIHJldHVyblJlc3VsdDogYW55LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzKTogYW55IHtcclxuICAgICAgICBpZiAoIXRoaXMudG9vbHMpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdUb29scyBhcmUgbm90IGF2YWlsYWJsZSBmb3IgbWVyZ2luZyByZXN1bHRzLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyBpZiB0b29scyBhcmUgbm90IGF2YWlsYWJsZSwgcmV0dXJuIHRoZSByZXN1bHQgYXMgaXNcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoIChydWxlLmFkZENvbnRlbnQpIHtcclxuICAgICAgICAgICAgY2FzZSAnb3ZlcndyaXRlJzpcclxuICAgICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHJlc3VsdDsgLy8gdXBkYXRlIG9yIGFkZCB0aGUgbmV3IHZhbHVlXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcclxuICAgICAgICAgICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJykgcmVzdWx0ID0gW3Jlc3VsdF07IC8vIGNvbnZlcnQgc3RyaW5nIHRvIGFycmF5IFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXR1cm5SZXN1bHQpKSByZXR1cm5SZXN1bHQgPSBbcmV0dXJuUmVzdWx0XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2xkUmVzdWx0KSkgb2xkUmVzdWx0ID0gW29sZFJlc3VsdF07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gcmV0dXJuUmVzdWx0LmZpbHRlcigodmFsdWU6YW55KSA9PiAhb2xkUmVzdWx0LmluY2x1ZGVzKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSB0aGlzLnRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MoZmlsdGVyZWQuY29uY2F0KHJlc3VsdCkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJldHVyblJlc3VsdCkgcmV0dXJuUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0LnJlcGxhY2VBbGwocmV0dXJuUmVzdWx0LG9sZFJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0ICsgcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3N0YXJ0JzpcclxuICAgICAgICAgICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJykgcmVzdWx0ID0gW3Jlc3VsdF07IC8vIGNvbnZlcnQgc3RyaW5nIHRvIGFycmF5IFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXR1cm5SZXN1bHQpKSByZXR1cm5SZXN1bHQgPSBbcmV0dXJuUmVzdWx0XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2xkUmVzdWx0KSkgb2xkUmVzdWx0ID0gW29sZFJlc3VsdF07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gcmV0dXJuUmVzdWx0LmZpbHRlcigodmFsdWU6YW55KSA9PiAhb2xkUmVzdWx0LmluY2x1ZGVzKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSB0aGlzLnRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MocmVzdWx0LmNvbmNhdChmaWx0ZXJlZCkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJldHVyblJlc3VsdCkgcmV0dXJuUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0LnJlcGxhY2VBbGwocmV0dXJuUmVzdWx0LG9sZFJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmVzdWx0ICsgcmV0dXJuUmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXR1cm5SZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgIC8qKlxyXG4gICAgICogQnVpbGRzIHRoZSBjb25maWd1cmF0aW9uIHRhYiBmb3IgYSBzcGVjaWZpYyBydWxlIGJ5IGl0cyBJRC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHJ1bGUgZm9yIHdoaWNoIHRoZSBjb25maWd1cmF0aW9uIHRhYiBpcyBiZWluZyBidWlsdC5cclxuICAgICAqIEBwYXJhbSBvcHRpb25FTCAtIFRoZSBIVE1MIGVsZW1lbnQgd2hlcmUgdGhlIGNvbmZpZ3VyYXRpb24gdGFiIHdpbGwgYmUgcmVuZGVyZWQuXHJcbiAgICAgKiBAcGFyYW0gcnVsZSAtIFRoZSBkZWZpbml0aW9uIG9mIHRoZSBydWxlLCBjb250YWluaW5nIGl0cyBwcm9wZXJ0aWVzIGFuZCBzZXR0aW5ncy5cclxuICAgICAqIEBwYXJhbSB0aGF0IC0gQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgY29udGV4dCBvciBvYmplY3QsIHR5cGljYWxseSB1c2VkIGZvciBtYWludGFpbmluZyBzY29wZS5cclxuICAgICAqIEBwYXJhbSBwcmV2aWV3Q29tcG9uZW50IC0gQSBjb21wb25lbnQgdXNlZCB0byByZW5kZXIgYSBwcmV2aWV3IG9mIHRoZSBydWxlJ3MgZWZmZWN0IG9yIGNvbmZpZ3VyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIElmIGEgcnVsZSB3aXRoIHRoZSBzcGVjaWZpZWQgSUQgaXMgZm91bmQsIGl0cyBgY29uZmlnVGFiYCBtZXRob2QgaXMgaW52b2tlZCB0byBidWlsZCB0aGUgY29uZmlndXJhdGlvbiB0YWIuXHJcbiAgICAgKiBJZiBubyBydWxlIGlzIGZvdW5kLCBhIHdhcm5pbmcgaXMgbG9nZ2VkIHRvIHRoZSBjb25zb2xlLlxyXG4gICAgICovXHJcbiAgICBidWlsZENvbmZpZ1RhYihpZDogc3RyaW5nLCBvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6IGFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcnVsZUluc3RhbmNlID0gdGhpcy5ydWxlcy5maW5kKHJ1bGUgPT4gcnVsZS5pZCA9PT0gaWQpO1xyXG4gICAgICAgIGlmIChydWxlSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcnVsZUluc3RhbmNlLmNvbmZpZ1RhYihvcHRpb25FTCwgcnVsZSwgdGhhdCwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGBSdWxlIHdpdGggaWQgXCIke2lkfVwiIG5vdCBmb3VuZCBmb3IgY29uZmlnIHRhYi5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBydWxlc01hbmFnZXIgPSBuZXcgUnVsZXMoKTsiLCAiaW1wb3J0IHsgRGlyZWN0b3J5RGlzcGxheU1vZGUsIERpcmVjdG9yeVNlbGVjdGlvbk1vZGUgfSBmcm9tICcuL2RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJztcclxuaW1wb3J0IHsgVHJlZUhpZXJhcmNoeURhdGEgfSBmcm9tICcuL3VpVHJlZUhpZXJhcmNoeVNvcnRhYmxlU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBXQVJOSU5HIH0gZnJvbSAnLi9Mb2cnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHZlcnNpb25TdHJpbmcgPSBcIjAuMC4yNlwiO1xyXG5cclxuZXhwb3J0IHR5cGUgT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzID0gXCJhbGlhc2VzXCJ8XCJjaGVja2JveFwifFwiZGF0ZVwifFwiZGF0ZXRpbWVcInxcIm11bHRpdGV4dFwifFwibnVtYmVyXCJ8XCJ0YWdzXCJ8XCJ0ZXh0XCI7XHJcbmV4cG9ydCB0eXBlIEZyb250bWF0dGVyQXV0b21hdGVFdmVudHMgPSAnY3JlYXRlJyB8ICdyZW5hbWUnIHwgJ2FjdGl2ZS1sZWFmLWNoYW5nZScgfCAnbWV0YWRhdGEtY2hhbmdlZCcgfCAnZGVsZXRlJyB8ICdtb2RpZnknIHwgJ3ByZXZpZXcnIHwgJ2FsbCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZpbHRlckZpbGVzQW5kRm9sZGVycyB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW10sXHJcbiAgICBtb2RlOiBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RlLFxyXG4gICAgZGlzcGxheTogRGlyZWN0b3J5RGlzcGxheU1vZGVcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTOiBGaWx0ZXJGaWxlc0FuZEZvbGRlcnMgPSB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICBtb2RlOiAnZXhjbHVkZScsXHJcbiAgICBkaXNwbGF5OiAnZm9sZGVycycsXHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBGcm9udG1hdHRlckF1dG9tYXRlU2V0dGluZ3Mge1xyXG4gICAgdGFnUHJlZml4OiBzdHJpbmc7XHJcbiAgICBleGNsdWRlUm9vdEZvbGRlcjogYm9vbGVhbjtcclxuICAgIHRhZ3NQcm9wZXJ0eU5hbWU6IHN0cmluZztcclxuICAgIHNwYWNlUmVwbGFjZW1lbnQ6IHN0cmluZztcclxuICAgIHNwZWNpYWxDaGFyUmVwbGFjZW1lbnQ6IHN0cmluZztcclxuICAgIGxvd2VyY2FzZVRhZ3M6IGJvb2xlYW47XHJcbiAgICBrbm93blByb3BlcnRpZXM6IFByb3BlcnR5VHlwZUluZm9bXTtcclxuICAgIHJ1bGVzOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzW107XHJcbiAgICB1c2VUZXh0QXJlYTogYm9vbGVhbjtcclxuICAgIGV4Y2x1ZGU6IEZpbHRlckZpbGVzQW5kRm9sZGVycztcclxuICAgIGluY2x1ZGU6IEZpbHRlckZpbGVzQW5kRm9sZGVycztcclxuICAgIGNvbmZpZ3VyZWRQcm9wZXJ0aWVzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgdmFsdWU6IGFueSB9PjtcclxuICAgIGRlYnVnTGV2ZWw6IG51bWJlcjtcclxuICAgIGRlbGF5Q3JlYXRlRXZlbnQ6IG51bWJlcjsgLy8gb3B0aW9uYWwgZGVsYXkgZm9yIGNyZWF0ZSBldmVudHNcclxuICAgIGZvbGRlckNvbmZpZzogVHJlZUhpZXJhcmNoeURhdGE7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX0ZST05UTUFUVEVSX0FVVE9NQVRFX1NFVFRJTkdTOiBGcm9udG1hdHRlckF1dG9tYXRlU2V0dGluZ3MgPSB7XHJcbiAgICB0YWdQcmVmaXg6ICcnLFxyXG4gICAgZXhjbHVkZVJvb3RGb2xkZXI6IGZhbHNlLFxyXG4gICAgdGFnc1Byb3BlcnR5TmFtZTogJ3RhZ3MnLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogJycsXHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiAnJyxcclxuICAgIGxvd2VyY2FzZVRhZ3M6IGZhbHNlLFxyXG4gICAga25vd25Qcm9wZXJ0aWVzOiBbXSxcclxuICAgIHJ1bGVzOiBbXSxcclxuICAgIHVzZVRleHRBcmVhOiBmYWxzZSxcclxuICAgIGV4Y2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgICAgIG1vZGU6ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVycycsXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXJzJyxcclxuICAgIH0sXHJcbiAgICBjb25maWd1cmVkUHJvcGVydGllczogW10sXHJcbiAgICBkZWJ1Z0xldmVsOiBXQVJOSU5HLFxyXG4gICAgZGVsYXlDcmVhdGVFdmVudDogMCwgLy8gZGVmYXVsdCB0byBubyBkZWxheVxyXG4gICAgZm9sZGVyQ29uZmlnOiB7Zm9sZGVyczogW10sIHJvd3M6IFtdfSxcclxufTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgYWN0aXZlOiBib29sZWFuO1xyXG4gICAgYWRkQ29udGVudDogJ292ZXJ3cml0ZScgfCAnc3RhcnQnIHwgJ2VuZCc7XHJcbiAgICBhc0xpbms6IGJvb2xlYW47IC8vZGVwcmVjYXRlZFxyXG4gICAgcHJvcGVydHk6IHN0cmluZztcclxuICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuO1xyXG4gICAgY3VzdG9tUHJvcGVydHk6IHN0cmluZztcclxuICAgIHR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcztcclxuICAgIHR5cGVQcm9wZXJ0eTogUHJvcGVydHlUeXBlSW5mbyB8IHVuZGVmaW5lZDtcclxuICAgIGNvbnRlbnQ6IHN0cmluZztcclxuICAgIGJ1aWxkSW5Db2RlOiBzdHJpbmc7XHJcbiAgICBqc0NvZGU6IHN0cmluZztcclxuICAgIHNob3dDb250ZW50OiBib29sZWFuO1xyXG4gICAgZXhjbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgaW5jbHVkZTogRmlsdGVyRmlsZXNBbmRGb2xkZXJzO1xyXG4gICAgcHJlZml4OiBzdHJpbmc7XHJcbiAgICBzcGFjZVJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiBzdHJpbmc7XHJcbiAgICBsb3dlcmNhc2VUYWdzOiBib29sZWFuOyAvL2RlcHJlY2F0ZWRcclxuICAgIGZvcm1hdHRlcjogc3RyaW5nOyAvL2RlcHJlY2F0ZWRcclxuICAgIGZvcm1hdHRlcnM6IHN0cmluZ1tdOyAvL2FkZGVkXHJcbiAgICBsaW5rRm9ybWF0dGVyOiBzdHJpbmc7IC8vYWRkZWRcclxuICAgIGlucHV0UHJvcGVydHk6IHN0cmluZztcclxuICAgIG9ubHlNb2RpZnk6IGJvb2xlYW47XHJcbiAgICB1c2VDdXN0b21Db2RlOiBib29sZWFuO1xyXG4gICAgb3B0aW9uQ29uZmlnPzp7fTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUlVMRV9ERUZJTklUSU9OIDogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyA9IHtcclxuICAgIGlkOiAnJyxcclxuICAgIGFjdGl2ZSA6IHRydWUsXHJcbiAgICBhc0xpbms6IGZhbHNlLCAvL2RlcHJlY2F0ZWRcclxuICAgIGFkZENvbnRlbnQ6ICdvdmVyd3JpdGUnLFxyXG4gICAgcHJvcGVydHkgOiAnJyxcclxuICAgIHZhbHVlOiAnJyxcclxuICAgIGN1c3RvbVByb3BlcnR5IDogJycsXHJcbiAgICB0eXBlOiAndGV4dCcsXHJcbiAgICB0eXBlUHJvcGVydHk6IHtuYW1lOicnLHR5cGU6J3RleHQnLCBzb3VyY2U6J3JlZ2lzdGVyZWQnfSxcclxuICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgYnVpbGRJbkNvZGU6ICcnLFxyXG4gICAganNDb2RlOiAnJyxcclxuICAgIHNob3dDb250ZW50OiBmYWxzZSxcclxuICAgIGV4Y2x1ZGU6IHtcclxuICAgICAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgICAgIHNlbGVjdGVkRmlsZXM6IFtdLFxyXG4gICAgICAgIG1vZGU6ICdleGNsdWRlJyxcclxuICAgICAgICBkaXNwbGF5OiAnZm9sZGVycycsXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICAgIHNlbGVjdGVkRm9sZGVyczogW10sXHJcbiAgICAgICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICAgICAgbW9kZTogJ2luY2x1ZGUnLFxyXG4gICAgICAgIGRpc3BsYXk6ICdmb2xkZXJzJyxcclxuICAgIH0sXHJcbiAgICBwcmVmaXg6ICcnLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogJycsXHJcbiAgICBzcGVjaWFsQ2hhclJlcGxhY2VtZW50OiAnJyxcclxuICAgIGxvd2VyY2FzZVRhZ3M6IGZhbHNlLCAvL2RlcHJlY2F0ZWRcclxuICAgIGZvcm1hdHRlcjogJ3RvT3JpZ2luYWwnLCAvL2RlcHJlY2F0ZWRcclxuICAgIGZvcm1hdHRlcnM6IFsndG9PcmlnaW5hbCddLFxyXG4gICAgbGlua0Zvcm1hdHRlcjogJ3RvT3JpZ2luYWxMaW5rJyxcclxuICAgIGlucHV0UHJvcGVydHk6ICcnLFxyXG4gICAgb25seU1vZGlmeTogdHJ1ZSxcclxuICAgIHVzZUN1c3RvbUNvZGU6IGZhbHNlLFxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBQcm9wZXJ0eUluZm8gPSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB0eXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBjb3VudD86IG51bWJlcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFByb3BlcnR5VHlwZUluZm8gPSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgdHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzO1xyXG4gICAgY291bnQ/OiBudW1iZXI7XHJcbiAgICBpc0FycmF5PzogYm9vbGVhbjtcclxuICAgIHZhbHVlcz86IHN0cmluZ1tdO1xyXG4gICAgc291cmNlOiAncmVnaXN0ZXJlZCcgfCAnaW5mZXJyZWQnO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgUHJvcGVydHlUeXBlID0ge1xyXG4gICAgdHlwZTogc3RyaW5nO1xyXG4gICAgaWNvbjogc3RyaW5nO1xyXG4gICAganNUeXBlOiBzdHJpbmc7XHJcbn07IiwgImltcG9ydCBleHAgZnJvbSAnY29uc3RhbnRzJztcclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0LCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nOyAvLyBBZGRlZCBzZXRJY29uXHJcblxyXG4vLyBEZWZpbmUgdGhlIHN0cnVjdHVyZSBmb3IgdHJlZSBub2Rlc1xyXG5pbnRlcmZhY2UgVHJlZU5vZGUge1xyXG4gICAgcGF0aDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdHlwZTogc3RyaW5nOyAvLyAnZm9sZGVyJyB8ICdmaWxlJztcclxuICAgIGNoaWxkcmVuPzogVHJlZU5vZGVbXTtcclxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGxpc3QgaXRlbSBlbGVtZW50IChsaSlcclxuICAgIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgbGFiZWw6IEhUTUxMYWJlbEVsZW1lbnQ7XHJcbiAgICBjb250YWluZXI6IEhUTUxFbGVtZW50OyAvLyBSZWZlcmVuY2UgdG8gdGhlIGNvbnRhaW5lciBkaXYgaG9sZGluZyBjaGVja2JveCBhbmQgbGFiZWxcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kZSA9ICdpbmNsdWRlJyB8ICdleGNsdWRlJzsgLy8gRGVmaW5lIHNlbGVjdGlvbiBtb2Rlc1xyXG5leHBvcnQgdHlwZSBEaXJlY3RvcnlEaXNwbGF5TW9kZSA9ICdmb2xkZXJzJyB8ICdmaWxlcycgfCAnZm9sZGVyJyB8ICdmaWxlJzsgLy8gRGVmaW5lIGRpc3BsYXkgbW9kZXNcclxuZXhwb3J0IGludGVyZmFjZSBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zIHtcclxuICAgIHRpdGxlPzogc3RyaW5nOyAvLyBUaXRsZSBvZiB0aGUgbW9kYWxcclxuICAgIHNlbGVjdGlvbk1vZGU6IERpcmVjdG9yeVNlbGVjdGlvbk1vZGU7IC8vICdpbmNsdWRlJyBvciAnZXhjbHVkZSdcclxuICAgIGRpc3BsYXlNb2RlOiBEaXJlY3RvcnlEaXNwbGF5TW9kZTsgLy8gJ2ZvbGRlcnMnIG9yICdmaWxlcydcclxuICAgIG9wdGlvblNlbGVjdGlvbk1vZGU6IGJvb2xlYW47IC8vIFNob3cgaW5jbHVkZS9leGNsdWRlIG9wdGlvblxyXG4gICAgb3B0aW9uU2hvd0ZpbGVzOiBib29sZWFuOyAvLyBTaG93IGZpbGVzIG9wdGlvblxyXG59XHJcbi8vIERlZmluZSB0aGUgcmVzdWx0IHN0cnVjdHVyZSByZXR1cm5lZCBieSB0aGUgbW9kYWxcclxuZXhwb3J0IGludGVyZmFjZSBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQge1xyXG4gICAgZm9sZGVyczogc3RyaW5nW107XHJcbiAgICBmaWxlczogc3RyaW5nW107XHJcbiAgICBtb2RlOiBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RlO1xyXG4gICAgZGlzcGxheTogRGlyZWN0b3J5RGlzcGxheU1vZGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnNpZGlhbiBNb2RhbCBmb3Igc2VsZWN0aW5nIGRpcmVjdG9yaWVzIGFuZCBmaWxlcyBmcm9tIHRoZSB2YXVsdCBzdHJ1Y3R1cmUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZvbGRlcnNTbmFwc2hvdDogUmVhZG9ubHlTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbEZpbGVzU25hcHNob3Q6IFJlYWRvbmx5U2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxNb2RlU25hcHNob3Q6IERpcmVjdG9yeVNlbGVjdGlvbk1vZGU7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGluaXRpYWxEaXNwbGF5U25hcHNob3Q6IERpcmVjdG9yeURpc3BsYXlNb2RlO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zOyAvLyBPcHRpb25zIGZvciB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZDtcclxuXHJcbiAgICAvLyBDdXJyZW50IHN0YXRlIGJlaW5nIG1vZGlmaWVkIHdpdGhpbiB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgY3VycmVudEZvbGRlcnMhOiBTZXQ8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgY3VycmVudEZpbGVzITogU2V0PHN0cmluZz47XHJcbiAgICBwcml2YXRlIGN1cnJlbnRNb2RlITogRGlyZWN0b3J5U2VsZWN0aW9uTW9kZTtcclxuICAgIHByaXZhdGUgY3VycmVudERpc3BsYXkhOiBEaXJlY3RvcnlEaXNwbGF5TW9kZTtcclxuICAgIHByaXZhdGUgaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlITogYm9vbGVhbjtcclxuICAgIHByaXZhdGUgc2hvd0ZpbGVzOiBib29sZWFuID0gZmFsc2U7IC8vIFN0YXRlIGZvciBzaG93aW5nIGZpbGVzIGluIHRoZSB0cmVlXHJcblxyXG4gICAgLy8gVUkgRWxlbWVudHNcclxuICAgIHByaXZhdGUgdHJlZVJvb3RFbGVtZW50ITogSFRNTEVsZW1lbnQ7IC8vIENvbnRhaW5lciBmb3IgdGhlIHRyZWUgdmlld1xyXG4gICAgcHJpdmF0ZSB0cmVlTm9kZXM6IE1hcDxzdHJpbmcsIFRyZWVOb2RlPiA9IG5ldyBNYXAoKTsgLy8gTWFwIHBhdGggdG8gbm9kZSBpbmZvIGZvciBxdWljayBhY2Nlc3NcclxuICAgIHByaXZhdGUgbW9kZURyb3Bkb3duOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7IC8vIFJlZmVyZW5jZSB0byB1cGRhdGUgZHJvcGRvd24gb24gcmVzZXRcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbEZvbGRlcnMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZm9sZGVyIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxGaWxlcyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmaWxlIHBhdGhzLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gICAgICogQHBhcmFtIG9rQ2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiT0tcIi4gUmVjZWl2ZXMgdGhlIHNlbGVjdGlvbiByZXN1bHQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGFwcDogQXBwLFxyXG4gICAgICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBpbml0aWFsRmlsZXM6IHN0cmluZ1tdLFxyXG4gICAgICAgIGluaXRpYWxPcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zLFxyXG4gICAgICAgIG9rQ2FsbGJhY2s6IChyZXN1bHQ6IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCB8IG51bGwpID0+IHZvaWRcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgLy8gU3RvcmUgaW5pdGlhbCBzdGF0ZSBmb3IgcmVzZXRcclxuICAgICAgICB0aGlzLmluaXRpYWxGb2xkZXJzU25hcHNob3QgPSBuZXcgU2V0KGluaXRpYWxGb2xkZXJzKTtcclxuICAgICAgICB0aGlzLmluaXRpYWxGaWxlc1NuYXBzaG90ID0gbmV3IFNldChpbml0aWFsRmlsZXMpO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbE1vZGVTbmFwc2hvdCA9IGluaXRpYWxPcHRpb25zLnNlbGVjdGlvbk1vZGU7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRGlzcGxheVNuYXBzaG90ID0gaW5pdGlhbE9wdGlvbnMuZGlzcGxheU1vZGU7XHJcbiAgICAgICAgdGhpcy5zaG93RmlsZXMgPSBpbml0aWFsT3B0aW9ucy5kaXNwbGF5TW9kZT09PSdmaWxlcycgfHwgaW5pdGlhbE9wdGlvbnMuZGlzcGxheU1vZGU9PT0nZmlsZSd8fCBpbml0aWFsRmlsZXMubGVuZ3RoPjA7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gaW5pdGlhbE9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrID0gb2tDYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBjdXJyZW50IHN0YXRlIGZyb20gaW5pdGlhbCBzdGF0ZSBmb3IgZWRpdGluZ1xyXG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gVXNlIGEgbWV0aG9kIGZvciBpbml0aWFsaXphdGlvbiBhbmQgcmVzZXRcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gdGhlIGluaXRpYWwgc3RhdGUgcHJvdmlkZWQgYXQgY29uc3RydWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZvbGRlcnNTbmFwc2hvdCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZXMgPSBuZXcgU2V0KHRoaXMuaW5pdGlhbEZpbGVzU25hcHNob3QpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlcnMgPSBuZXcgU2V0KFtdKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcyA9IG5ldyBTZXQoW10pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB0aGlzLmluaXRpYWxNb2RlU25hcHNob3Q7XHJcbiAgICAgICAgLy8gTm90ZTogc2hvd0ZpbGVzIGlzIG5vdCByZXNldCBieSB0aGlzIGFjdGlvbiwgdXNlciBjYW4gdG9nZ2xlIGl0IGluZGVwZW5kZW50bHlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgY29udGVudFxyXG4gICAgICAgIGNvbnRlbnRFbC5hZGRDbGFzcygnZGlyZWN0b3J5LXNlbGVjdGlvbi1tb2RhbCcpOyBcclxuXHJcbiAgICAgICAgLy8gLS0tIE1vZGFsIFRpdGxlIC0tLVxyXG4gICAgICAgIGlmICh0aGlzLmluY2x1ZGVFeGNsdWRlU2VsZWN0YWJsZSkge1xyXG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiB0aGlzLm9wdGlvbnMudGl0bGUgfHwgJ0luY2x1ZGUgb3IgRXhjbHVkZSBGb2xkZXJzIGFuZCBGaWxlcycgfSk7IFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6IHRoaXMub3B0aW9ucy50aXRsZSB8fCBgJHt0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScgPyAnRXhjbHVkZScgOiAnSW5jbHVkZSd9IEZvbGRlcnMgYW5kIEZpbGVzYCB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU2V0dGluZ3MgQ29udHJvbHMgLS0tXHJcbiAgICAgICAgY29uc3QgY29udHJvbHNFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1jb250cm9scycgfSk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVNb2RlU2V0dGluZyhjb250cm9sc0VsKTsgLy8gQ3JlYXRlIG1vZGUgZHJvcGRvd25cclxuICAgICAgICB0aGlzLmNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udHJvbHNFbCk7IC8vIENyZWF0ZSBmaWxlIHRvZ2dsZVxyXG5cclxuICAgICAgICAvLyAtLS0gVHJlZSBDb250YWluZXIgLS0tXHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS12aWV3LWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gJzYwMHB4JztcclxuICAgICAgICB0aGlzLnRyZWVSb290RWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy50cmVlUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JztcclxuXHJcbiAgICAgICAgLy8gLS0tIEJ1aWxkIGFuZCBSZW5kZXIgVHJlZSAtLS1cclxuICAgICAgICBpZiAoIXRoaXMudHJlZU5vZGVzLnNpemUpIHsgLy8gRW5zdXJlIHRoZSB0cmVlIGlzIG9ubHkgcmVuZGVyZWQgb25jZVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBJbml0aWFsIHJlbmRlcmluZyBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWN0aW9uIEJ1dHRvbnMgLS0tXHJcbiAgICAgICAgdGhpcy5jcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRlbnRFbCk7IC8vIENyZWF0ZSBPSyBhbmQgUmVzZXQgYnV0dG9uc1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyB0aGUgZHJvcGRvd24gc2V0dGluZyBmb3IgY2hvb3NpbmcgdGhlIHNlbGVjdGlvbiBtb2RlLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIHNldHRpbmcgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlTW9kZVNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5jbHVkZUV4Y2x1ZGVTZWxlY3RhYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZURyb3Bkb3duID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpIC8vIFN0b3JlIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1NlbGVjdGlvbiBNb2RlJykgLy8gU2V0dGluZyBOYW1lIGluIEdlcm1hblxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBpZiB0aGUgc2VsZWN0ZWQgZmlsZXMgYW5kIGZvbGRlcnMgc2hvdWxkIGJlIGV4Y2x1ZGVkIG9yIGluY2x1ZGVkLicpIFxyXG4gICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdleGNsdWRlJywgJ2V4Y2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdpbmNsdWRlJywgJ2luY2x1ZGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSkgLy8gU2V0IGluaXRpYWwgdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE1vZGUgPSB2YWx1ZSBhcyAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyZWVBcHBlYXJhbmNlKCk7IC8vIFVwZGF0ZSB0cmVlIHZpc3VhbHMgYmFzZWQgb24gbmV3IG1vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBtb2RlIGRyb3Bkb3duIFVJIGVsZW1lbnQgdG8gcmVmbGVjdCB0aGUgY3VycmVudE1vZGUgc3RhdGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlTW9kZURyb3Bkb3duKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGRyb3Bkb3duQ29tcG9uZW50ID0gdGhpcy5tb2RlRHJvcGRvd24/LmNvbXBvbmVudHNbMF0gYXMgYW55OyAvLyBBY2Nlc3MgZHJvcGRvd24gY29tcG9uZW50XHJcbiAgICAgICAgaWYgKGRyb3Bkb3duQ29tcG9uZW50ICYmIHR5cGVvZiBkcm9wZG93bkNvbXBvbmVudC5zZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgZHJvcGRvd25Db21wb25lbnQuc2V0VmFsdWUodGhpcy5jdXJyZW50TW9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIHRvZ2dsZSBzZXR0aW5nIGZvciBzaG93aW5nL2hpZGluZyBmaWxlcyBpbiB0aGUgdHJlZS5cclxuICAgICAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBzZXR0aW5nIHRvLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZVNob3dGaWxlc1NldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5vcHRpb25TaG93RmlsZXMpIHtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnU2hvdyBGaWxlcycpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnU2hvdyBGaWxlcyB3aXRoaW4gdGhlIGRpcmVjdG9yeSB0cmVlLicpXHJcbiAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNob3dGaWxlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0ZpbGVzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIFwiT0tcIiBhbmQgXCJSZXNldFwiIGJ1dHRvbnMuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYnV0dG9ucyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWJ1dHRvbnMnIH0pO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTVweCc7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIFVzZSBmbGV4IGZvciBhbGlnbm1lbnRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1lbmQnOyAvLyBBbGlnbiBidXR0b25zIHRvIHRoZSByaWdodFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5nYXAgPSAnMTBweCc7IC8vIFNwYWNlIGJldHdlZW4gYnV0dG9uc1xyXG5cclxuICAgICAgICAvLyBSZXNldCBCdXR0b24gKFVuZG8gXHUyMUFBXHVGRTBGKVxyXG4gICAgICAgIGNvbnN0IHJlc2V0QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKHJlc2V0QnV0dG9uLCAncmVzZXQnKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgcmVzZXRCdXR0b24uYXJpYUxhYmVsID0gJ1Jlc2V0IHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICByZXNldEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFJlc2V0IGludGVybmFsIHN0YXRlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTW9kZURyb3Bkb3duKCk7IC8vIFVwZGF0ZSBkcm9wZG93biBVSVxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQW5kUmVuZGVyVHJlZSgpOyAvLyBSZS1yZW5kZXIgdHJlZSB3aXRoIHJlc2V0IHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgQnV0dG9uIChDbGVhciBcdUQ4M0RcdURFQUUpXHJcbiAgICAgICAgY29uc3QgZW1wdHlCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24oZW1wdHlCdXR0b24sICdlcmFzZXInKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgZW1wdHlCdXR0b24uYXJpYUxhYmVsID0gJ0NsZWFyIHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBlbXB0eUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOyAvLyBDbGVhciBzdGF0ZVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVEcm9wZG93bigpOyAvLyBVcGRhdGUgZHJvcGRvd24gVUlcclxuICAgICAgICAgICAgdGhpcy5idWlsZEFuZFJlbmRlclRyZWUoKTsgLy8gUmUtcmVuZGVyIHRyZWUgd2l0aCByZXNldCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGNhbmNlbCBCdXR0b25cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NhbmNlbCcgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgZGlzY2FyZCBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBsb2dnZXIubG9nKERFQlVHLFwiQ2FuY2VsIENsaWNrZWQgLSBSZXR1cm5pbmdcIik7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgICAgICB0aGlzLm9rQ2FsbGJhY2soIG51bGwgKTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE9LIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycsIGNsczogJ21vZC1jdGEnIH0pO1xyXG4gICAgICAgIG9rQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgc2F2ZSBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIG9rQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCdWlsZHMgdGhlIGxvZ2ljYWwgdHJlZSBzdHJ1Y3R1cmUgZGF0YSBmcm9tIHRoZSB2YXVsdCdzIGZpbGVzIGFuZCBmb2xkZXJzLlxyXG4gICAgICogQHJldHVybnMgVGhlIHJvb3Qgbm9kZSBvZiB0aGUgdHJlZSBzdHJ1Y3R1cmUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYnVpbGRUcmVlRGF0YSgpOiBUcmVlTm9kZSB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgdmlydHVhbCByb290IG5vZGUgcmVwcmVzZW50aW5nIHRoZSB2YXVsdFxyXG4gICAgICAgIGNvbnN0IHZhdWx0Um9vdE5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICBwYXRoOiAnLycsIC8vIFJvb3QgZm9sZGVyIHBhdGhcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5hcHAudmF1bHQuZ2V0TmFtZSgpIHx8ICdWYXVsdCcsIC8vIFVzZSB2YXVsdCBuYW1lIG9yIGRlZmF1bHRcclxuICAgICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXHJcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgLy8gUGxhY2Vob2xkZXIgZWxlbWVudHMsIHdpbGwgYmUgYXNzaWduZWQgZHVyaW5nIHJlbmRlcmluZ1xyXG4gICAgICAgICAgICBlbGVtZW50OiBudWxsISxcclxuICAgICAgICAgICAgY2hlY2tib3g6IG51bGwhLFxyXG4gICAgICAgICAgICBsYWJlbDogbnVsbCEsXHJcbiAgICAgICAgICAgIGNvbnRhaW5lcjogbnVsbCEsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9sZGVyTm9kZXMgPSBuZXcgTWFwPHN0cmluZywgVHJlZU5vZGU+KCk7XHJcbiAgICAgICAgZm9sZGVyTm9kZXMuc2V0KCcvJywgdmF1bHRSb290Tm9kZSk7IC8vIEFkZCByb290IHRvIHRoZSBtYXBcclxuXHJcbiAgICAgICAgLy8gVXNlIGdldEZpbGVzKCkgdG8gcmV0cmlldmUgYWxsIFRGaWxlIG9iamVjdHMgKE1hcmtkb3duLCBpbWFnZXMsIHBkZiwgZXRjLilcclxuICAgICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBTdGVwIDE6IENyZWF0ZSBhbGwgZm9sZGVyIG5vZGVzIGJhc2VkIG9uIGZpbGUgcGFyZW50IHBhdGhzIC0tLVxyXG4gICAgICAgIGFsbEZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudEZvbGRlciA9IGZpbGUucGFyZW50O1xyXG4gICAgICAgICAgICBpZiAoIXBhcmVudEZvbGRlcikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gJyc7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IHBhcmVudEZvbGRlci5wYXRoLnNwbGl0KCcvJykuZmlsdGVyKHAgPT4gcC5sZW5ndGggPiAwKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYXJlbnROb2RlID0gdmF1bHRSb290Tm9kZTsgLy8gU3RhcnQgZnJvbSB2YXVsdCByb290XHJcbiAgICAgICAgICAgIHBhdGhQYXJ0cy5mb3JFYWNoKHBhcnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBjdXJyZW50UGF0aCA9PT0gJy8nID8gcGFydCA6IGAke2N1cnJlbnRQYXRofS8ke3BhcnR9YDtcclxuICAgICAgICAgICAgICAgIGlmICghZm9sZGVyTm9kZXMuaGFzKGN1cnJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZvbGRlck5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBjdXJyZW50UGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbCEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94OiBudWxsISxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG51bGwhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6IG51bGwhLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVyTm9kZXMuc2V0KGN1cnJlbnRQYXRoLCBuZXdGb2xkZXJOb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuIS5wdXNoKG5ld0ZvbGRlck5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUgPSBuZXdGb2xkZXJOb2RlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gZm9sZGVyTm9kZXMuZ2V0KGN1cnJlbnRQYXRoKSE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAyOiBBZGQgZmlsZSBub2RlcyBpZiAnc2hvd0ZpbGVzJyBpcyBlbmFibGVkIC0tLVxyXG4gICAgICAgIGlmICh0aGlzLnNob3dGaWxlcykge1xyXG4gICAgICAgICAgICBhbGxGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50UGF0aCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Rm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0aCA9IFwiL1wiICsgKHBhcmVudEZvbGRlci5wYXRoPT09ICcvJyA/ICcnIDogcGFyZW50Rm9sZGVyLnBhdGgpOyAvLyBFbnN1cmUgdGhlIHBhdGggc3RhcnRzIHdpdGggYSBzbGFzaFxyXG4gICAgICAgICAgICAgICAgfSAvLyBFbnN1cmUgdGhlIHBhdGggc3RhcnRzIHdpdGggYSBzbGFzaFxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSBmb2xkZXJOb2Rlcy5nZXQocGFyZW50UGF0aCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZU5vZGU6IFRyZWVOb2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGwhLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrYm94OiBudWxsISxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogbnVsbCEsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBudWxsISxcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuIS5wdXNoKGZpbGVOb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gU3RlcCAzOiBTb3J0IGNoaWxkcmVuIGFscGhhYmV0aWNhbGx5IChmb2xkZXJzIGZpcnN0LCB0aGVuIGZpbGVzKSAtLS1cclxuICAgICAgICBjb25zdCBzb3J0Tm9kZXMgPSAoYTogVHJlZU5vZGUsIGI6IFRyZWVOb2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmb2xkZXInICYmIGIudHlwZSA9PT0gJ2ZpbGUnKSByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIGlmIChhLnR5cGUgPT09ICdmaWxlJyAmJiBiLnR5cGUgPT09ICdmb2xkZXInKSByZXR1cm4gMTtcclxuICAgICAgICAgICAgcmV0dXJuIGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZm9sZGVyTm9kZXMuZm9yRWFjaChub2RlID0+IG5vZGUuY2hpbGRyZW4/LnNvcnQoc29ydE5vZGVzKSk7XHJcblxyXG4gICAgICAgIHJldHVybiB2YXVsdFJvb3ROb2RlOyAvLyBSZXR1cm4gdGhlIHBvcHVsYXRlZCByb290IG5vZGVcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSBlbnRpcmUgdHJlZSBzdHJ1Y3R1cmUgaW4gdGhlIERPTSBiYXNlZCBvbiB0aGUgdHJlZSBkYXRhLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlbmRlclRyZWUoKSB7XHJcbiAgICAgICAgIHRoaXMudHJlZVJvb3RFbGVtZW50LmVtcHR5KCk7IC8vIENsZWFyIGV4aXN0aW5nIERPTSBlbGVtZW50c1xyXG4gICAgICAgICB0aGlzLnRyZWVOb2Rlcy5jbGVhcigpOyAvLyBDbGVhciB0aGUgbm9kZSBtYXBcclxuXHJcbiAgICAgICAgIGNvbnN0IHRyZWVEYXRhID0gdGhpcy5idWlsZFRyZWVEYXRhKCk7IC8vIEdldCB0aGUgc3RydWN0dXJlZCBkYXRhXHJcblxyXG4gICAgICAgICAvLyBDcmVhdGUgdGhlIHRvcC1sZXZlbCBsaXN0IGZvciB0aGUgdmF1bHQgY29udGVudHNcclxuICAgICAgICAgY29uc3Qgcm9vdFVsID0gdGhpcy50cmVlUm9vdEVsZW1lbnQuY3JlYXRlRWwoJ3VsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5hZGRDbGFzcygndHJlZS1yb290LXVsJyk7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5saXN0U3R5bGUgPSAnbm9uZSc7XHJcbiAgICAgICAgIHJvb3RVbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVtb3ZlIGRlZmF1bHQgbGlzdCBpbmRlbnRhdGlvblxyXG5cclxuICAgICAgICAgLy8gUmVuZGVyIHRoZSByb290IGZvbGRlciBpdHNlbGZcclxuICAgICAgICAgLy90aGlzLnJlbmRlclRyZWVOb2RlKHRyZWVEYXRhLCByb290VWwsIDAsIHRoaXMuY3VycmVudE1vZGUgPT09ICdpbmNsdWRlJyA/IHRoaXMuY3VycmVudEZvbGRlcnMgOiB0aGlzLmN1cnJlbnRGaWxlcyk7XHJcbiAgICAgICAgIHRoaXMucmVuZGVyVHJlZU5vZGUodHJlZURhdGEsIHJvb3RVbCwgMCwgdGhpcy5jdXJyZW50Rm9sZGVycywgdGhpcy5jdXJyZW50RmlsZXMpOyAvL1RPRE86IGV4cGFuZCB0aGlzIHRvIGluY2x1ZGUgZmlsZXMgYXMgd2VsbFxyXG5cclxuICAgICAgICAgLy8gUmVuZGVyIGNoaWxkcmVuIG9mIHRoZSByb290IGZvbGRlclxyXG4gICAgICAgICB0cmVlRGF0YS5jaGlsZHJlbj8uZm9yRWFjaChjaGlsZE5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgLy90aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkTm9kZSwgcm9vdFVsLCAxLCB0aGlzLmN1cnJlbnRNb2RlID09PSAnaW5jbHVkZScgPyB0aGlzLmN1cnJlbnRGb2xkZXJzIDogdGhpcy5jdXJyZW50RmlsZXMpOyAvLyBTdGFydCByZW5kZXJpbmcgYXQgbGV2ZWwgMVxyXG4gICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlY3Vyc2l2ZWx5IHJlbmRlcnMgYSBzaW5nbGUgdHJlZSBub2RlIGFuZCBpdHMgY2hpbGRyZW4gaW4gdGhlIERPTS5cclxuICAgICAqIEBwYXJhbSBub2RlIC0gVGhlIFRyZWVOb2RlIGRhdGEgdG8gcmVuZGVyLlxyXG4gICAgICogQHBhcmFtIHBhcmVudEVsZW1lbnQgLSBUaGUgSFRNTCBgdWxgIGVsZW1lbnQgdG8gYXBwZW5kIHRoaXMgbm9kZSdzIGBsaWAgdG8uXHJcbiAgICAgKiBAcGFyYW0gbGV2ZWwgLSBUaGUgY3VycmVudCBpbmRlbnRhdGlvbiBsZXZlbC5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW5kZXJUcmVlTm9kZShub2RlOiBUcmVlTm9kZSwgcGFyZW50RWxlbWVudDogSFRNTEVsZW1lbnQsIGxldmVsOiBudW1iZXIsIHNlbGVjdGVkUGF0aHM6IFNldDxzdHJpbmc+LCBzZWxlY3RlZGZpbGVzOiBTZXQ8c3RyaW5nPikge1xyXG4gICAgICAgIGNvbnN0IGxpID0gcGFyZW50RWxlbWVudC5jcmVhdGVFbCgnbGknKTtcclxuICAgICAgICBsaS5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7bGV2ZWwgKiAyMH1weGA7IC8vIEFwcGx5IGluZGVudGF0aW9uIGJhc2VkIG9uIGxldmVsXHJcbiAgICAgICAgbGkuYWRkQ2xhc3MoYHRyZWUtbm9kZS0ke25vZGUudHlwZX1gKTsgLy8gQWRkIGNsYXNzIGZvciB0eXBlIChmb2xkZXIvZmlsZSlcclxuXHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGkuY3JlYXRlRGl2KHsgY2xzOiAndHJlZS1ub2RlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcclxuICAgICAgICBjb250YWluZXIuc3R5bGUucGFkZGluZyA9ICcycHggMCc7IC8vIEFkZCBzb21lIHZlcnRpY2FsIHBhZGRpbmdcclxuXHJcbiAgICAgICAgLy8gLS0tIFRvZ2dsZSBCdXR0b24gZm9yIEZvbGRlcnMgLS0tXHJcbiAgICAgICAgbGV0IHRvZ2dsZUJ1dHRvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgICAgICBsZXQgaXNDb2xsYXBzZWQgPSB0cnVlOyAvLyBEZWZhdWx0IHN0YXRlIGlzIGNvbGxhcHNlZFxyXG5cclxuICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24gPSBjb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ3RyZWUtdG9nZ2xlLWJ1dHRvbicgfSk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdcdTI1QjYnOyAvLyBSaWdodC1wb2ludGluZyB0cmlhbmdsZVxyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uc3R5bGUubWFyZ2luUmlnaHQgPSAnNXB4JztcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgZm9sZGVyIG9yIGFueSBvZiBpdHMgY2hpbGRyZW4gYXJlIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZEV4cGFuZCA9IHRoaXMuc2hvdWxkRXhwYW5kRm9sZGVyKG5vZGUsIHNlbGVjdGVkUGF0aHMsIHNlbGVjdGVkZmlsZXMpO1xyXG4gICAgICAgICAgICBpZiAoc2hvdWxkRXhwYW5kKSB7XHJcbiAgICAgICAgICAgICAgICBpc0NvbGxhcHNlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlzQ29sbGFwc2VkID0gIWlzQ29sbGFwc2VkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRvZ2dsZUJ1dHRvbikgdG9nZ2xlQnV0dG9uLnRleHRDb250ZW50ID0gaXNDb2xsYXBzZWQgPyAnXHUyNUI2JyA6ICdcdTI1QkMnOyAvLyBVcGRhdGUgdHJpYW5nbGUgZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5VbCkgY2hpbGRyZW5VbC5zdHlsZS5kaXNwbGF5ID0gaXNDb2xsYXBzZWQgPyAnbm9uZScgOiAnYmxvY2snOyAvLyBTaG93L2hpZGUgY2hpbGRyZW5cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLSBDaGVja2JveCAtLS1cclxuICAgICAgICBjb25zdCBjaGVja2JveCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCB7IHR5cGU6ICdjaGVja2JveCcgfSk7XHJcbiAgICAgICAgY2hlY2tib3guaWQgPSBgdHJlZS1jYi0ke25vZGUucGF0aC5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywgJy0nKX1gOyAvLyBDcmVhdGUgYSBzYWZlIElEXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC5wYXRoID0gbm9kZS5wYXRoOyAvLyBTdG9yZSBwYXRoIGluIGRhdGEgYXR0cmlidXRlXHJcbiAgICAgICAgY2hlY2tib3guZGF0YXNldC50eXBlID0gbm9kZS50eXBlOyAvLyBTdG9yZSB0eXBlXHJcblxyXG4gICAgICAgIC8vIC0tLSBMYWJlbCAtLS1cclxuICAgICAgICBjb25zdCBsYWJlbCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnKTtcclxuICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IGAke25vZGUudHlwZSA9PT0gJ2ZvbGRlcicgPyAnXHVEODNEXHVEQ0MxJyA6ICdcdUQ4M0RcdURDQzQnfSAke25vZGUubmFtZX1gO1xyXG4gICAgICAgIC8vIGxhYmVsLnRleHRDb250ZW50ID0gbm9kZS5uYW1lO1xyXG4gICAgICAgIGxhYmVsLmh0bWxGb3IgPSBjaGVja2JveC5pZDsgLy8gTGluayBsYWJlbCB0byBjaGVja2JveFxyXG4gICAgICAgIGxhYmVsLnN0eWxlLm1hcmdpbkxlZnQgPSAnNXB4JztcclxuICAgICAgICBsYWJlbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcbiAgICAgICAgbGFiZWwudGl0bGUgPSBub2RlLnBhdGg7IC8vIFNob3cgZnVsbCBwYXRoIG9uIGhvdmVyXHJcblxyXG4gICAgICAgIC8vIC0tLSBTdG9yZSByZWZlcmVuY2VzIGluIHRoZSBub2RlIG9iamVjdCBhbmQgbWFwIC0tLVxyXG4gICAgICAgIG5vZGUuZWxlbWVudCA9IGxpO1xyXG4gICAgICAgIG5vZGUuY2hlY2tib3ggPSBjaGVja2JveDtcclxuICAgICAgICBub2RlLmxhYmVsID0gbGFiZWw7XHJcbiAgICAgICAgbm9kZS5jb250YWluZXIgPSBjb250YWluZXI7IC8vIFN0b3JlIGNvbnRhaW5lciByZWZlcmVuY2VcclxuICAgICAgICB0aGlzLnRyZWVOb2Rlcy5zZXQobm9kZS5wYXRoLCBub2RlKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIFNldCBpbml0aWFsIGNoZWNrZWQgc3RhdGUgYmFzZWQgb24gY3VycmVudCBzZWxlY3Rpb24gLS0tXHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicpIHtcclxuICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gdGhpcy5jdXJyZW50RmlsZXMuaGFzKG5vZGUucGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciBjaGVja2JveCBjaGFuZ2VzIC0tLVxyXG4gICAgICAgIGNoZWNrYm94Lm9uY2hhbmdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdGFyZ2V0LmRhdGFzZXQucGF0aCE7XHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0YXJnZXQuZGF0YXNldC50eXBlIGFzICdmb2xkZXInIHwgJ2ZpbGUnO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzZXRzXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdmb2xkZXInKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc3BsYXlNb2RlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIHNlbGVjdGlvbiBpZiBvbmx5IG9uZSBmb2xkZXIgY2FuIGJlIHNlbGVjdGVkXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGb2xkZXJzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNwbGF5TW9kZSA9PT0gJ2ZpbGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEZpbGVzLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIHNlbGVjdGlvbiBpZiBvbmx5IG9uZSBmaWxlIGNhbiBiZSBzZWxlY3RlZFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGaWxlcy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2ZvbGRlcicpIHRoaXMuY3VycmVudEZvbGRlcnMuZGVsZXRlKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmN1cnJlbnRGaWxlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB2aXN1YWwgc3RhdGUgb2YgdGhlIGVudGlyZSB0cmVlIGFmdGVyIGEgY2hhbmdlXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVHJlZUFwcGVhcmFuY2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyAtLS0gUmVuZGVyIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5IGlmIGl0J3MgYSBmb2xkZXIgLS0tXHJcbiAgICAgICAgbGV0IGNoaWxkcmVuVWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gJ2ZvbGRlcicgJiYgbm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY2hpbGRyZW5VbCA9IGxpLmNyZWF0ZUVsKCd1bCcpO1xyXG4gICAgICAgICAgICBjaGlsZHJlblVsLnN0eWxlLmxpc3RTdHlsZSA9ICdub25lJztcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5wYWRkaW5nTGVmdCA9ICcwJzsgLy8gUmVzZXQgcGFkZGluZyBmb3IgbmVzdGVkIGxpc3RcclxuICAgICAgICAgICAgY2hpbGRyZW5VbC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzAnOyAvLyBQcmV2ZW50IGRvdWJsZSBpbmRlbnRhdGlvbiBmcm9tIGRlZmF1bHQgVUwgc3R5bGVzXHJcbiAgICAgICAgICAgIGNoaWxkcmVuVWwuc3R5bGUuZGlzcGxheSA9IGlzQ29sbGFwc2VkID8gJ25vbmUnIDogJ2Jsb2NrJzsgLy8gU2hvdy9oaWRlIGNoaWxkcmVuIGJhc2VkIG9uIGluaXRpYWwgc3RhdGVcclxuXHJcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB0aGlzLnJlbmRlclRyZWVOb2RlKGNoaWxkLCBjaGlsZHJlblVsISwgbGV2ZWwgKyAxLCBzZWxlY3RlZFBhdGhzLCBzZWxlY3RlZGZpbGVzKSk7IC8vIEluY3JlYXNlIGxldmVsIGZvciBjaGlsZHJlblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIZWxwZXIgbWV0aG9kIHRvIGRldGVybWluZSBpZiBhIGZvbGRlciBzaG91bGQgYmUgZXhwYW5kZWRcclxuICAgIHByaXZhdGUgc2hvdWxkRXhwYW5kRm9sZGVyKG5vZGU6IFRyZWVOb2RlLCBzZWxlY3RlZFBhdGhzOiBTZXQ8c3RyaW5nPiwgc2VsZWN0ZWRGaWxlczogU2V0PHN0cmluZz4pOiBib29sZWFuIHtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRQYXRocy5oYXMobm9kZS5wYXRoKSB8fCBzZWxlY3RlZEZpbGVzLmhhcyhub2RlLnBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBUaGUgZm9sZGVyIGl0c2VsZiBpcyBzZWxlY3RlZFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRFeHBhbmRGb2xkZXIoY2hpbGQsIHNlbGVjdGVkUGF0aHMsIHNlbGVjdGVkRmlsZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIEEgY2hpbGQgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBOZWl0aGVyIHRoZSBmb2xkZXIgbm9yIGl0cyBjaGlsZHJlbiBhcmUgc2VsZWN0ZWRcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB2aXN1YWwgYXBwZWFyYW5jZSAoZW5hYmxlZC9kaXNhYmxlZC9zdHlsaW5nKSBvZiBhbGwgbm9kZXNcclxuICAgICAqIGluIHRoZSB0cmVlIGJhc2VkIG9uIHRoZSBjdXJyZW50IG1vZGUgYW5kIHNlbGVjdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlVHJlZUFwcGVhcmFuY2UoKSB7XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaXNEaXNhYmxlZCA9IGZhbHNlOyAvLyBTaG91bGQgdGhlIG5vZGUgYXBwZWFyIGRpc2FibGVkIChncmV5ZWQgb3V0KT9cclxuICAgICAgICAgICAgbGV0IGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IGZhbHNlOyAvLyBJcyB0aGUgbm9kZSBwYXJ0IG9mIHRoZSAnYWN0aXZlJyBzZXQgaW4gaW5jbHVkZSBtb2RlP1xyXG4gICAgICAgICAgICBsZXQgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkID0gZmFsc2U7IC8vIElzIHRoZSBub2RlIHBhcnQgb2YgdGhlICdpbmFjdGl2ZScgc2V0IGluIGV4Y2x1ZGUgbW9kZT9cclxuXHJcbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiBhbiBhbmNlc3RvciBGT0xERVIgb2YgdGhpcyBub2RlIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGxldCBhbmNlc3RvckZvbGRlclNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9IG5vZGUucGF0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnRQYXRoICE9PSAnLycpIHtcclxuICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudFBhdGguc3Vic3RyaW5nKDAsIGN1cnJlbnRQYXRoLmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JGb2xkZXJTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudFBhdGgpIGJyZWFrOyAvLyBTYWZldHkgYnJlYWsgYXQgcm9vdFxyXG4gICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gcGFyZW50UGF0aDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIG5vZGUgaXRzZWxmIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVTZWxlY3RlZCA9IG5vZGUudHlwZSA9PT0gJ2ZvbGRlcidcclxuICAgICAgICAgICAgICAgID8gdGhpcy5jdXJyZW50Rm9sZGVycy5oYXMobm9kZS5wYXRoKVxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLmN1cnJlbnRGaWxlcy5oYXMobm9kZS5wYXRoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIC0tLSBBcHBseSBMb2dpYyBCYXNlZCBvbiBNb2RlIC0tLVxyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ2V4Y2x1ZGUnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBFWENMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGV4Y2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBleGNsdWRlZC5cclxuICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlFeGNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9IGlzRWZmZWN0aXZlbHlFeGNsdWRlZDtcclxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gSU5DTFVERSBNb2RlXHJcbiAgICAgICAgICAgICAgICAvLyBJTkNMVURFIE1vZGU6IEEgbm9kZSBpcyBjb25zaWRlcmVkIGluY2x1ZGVkIGlmIGl0IE9SIGFuIGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZC5cclxuICAgICAgICAgICAgICAgIC8vIFZpc3VhbGx5IGRpc2FibGUgKGdyZXkgb3V0KSBub2RlcyB0aGF0IGFyZSBOT1QgaW5jbHVkZWQuXHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSAnZm9sZGVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzRWZmZWN0aXZlbHlJbmNsdWRlZCA9IG5vZGVTZWxlY3RlZCB8fCBhbmNlc3RvckZvbGRlclNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmlsZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbGUgaW5jbHVkZWQgaWYgc2VsZWN0ZWQgT1IgcGFyZW50IHBhdGggaXMgaW5jbHVkZWRcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gbm9kZS5wYXRoLnN1YnN0cmluZygwLCBub2RlLnBhdGgubGFzdEluZGV4T2YoJy8nKSkgfHwgJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQgPSB0aGlzLmlzUGF0aEVmZmVjdGl2ZWx5SW5jbHVkZWQocGFyZW50UGF0aCk7IC8vIENoZWNrIHBhcmVudCBmb2xkZXIgc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgaXNFZmZlY3RpdmVseUluY2x1ZGVkID0gbm9kZVNlbGVjdGVkIHx8IHBhcmVudEVmZmVjdGl2ZWx5SW5jbHVkZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpc0Rpc2FibGVkID0gIWlzRWZmZWN0aXZlbHlJbmNsdWRlZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEFwcGx5IFZpc3VhbCBTdHlsZXMgLS0tXHJcbiAgICAgICAgICAgIC8vIENoZWNrYm94IGl0c2VsZiBzaG91bGQgYWx3YXlzIGJlIGNsaWNrYWJsZSB0byBjaGFuZ2Ugc2VsZWN0aW9uIHN0YXRlXHJcbiAgICAgICAgICAgIG5vZGUuY2hlY2tib3guZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgbm9kZS5jaGVja2JveC5jaGVja2VkID0gbm9kZVNlbGVjdGVkO1xyXG5cclxuICAgICAgICAgICAgLy8gQXBwbHkgc3R5bGluZyB0byB0aGUgY29udGFpbmVyIChsYWJlbCwgaWNvbikgYmFzZWQgb24gZGlzYWJsZWQgc3RhdGVcclxuICAgICAgICAgICAgaWYgKGlzRGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnaXMtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5yZW1vdmVDbGFzcygnaXMtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gLS0tIEZJWCBmb3IgSW52YWxpZENoYXJhY3RlckVycm9yIC0tLVxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgY2xhc3NlcyBpbmRpdmlkdWFsbHlcclxuICAgICAgICAgICAgbm9kZS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWluY2x1ZGVkJywgJ2lzLWV4Y2x1ZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgc3BlY2lmaWMgY2xhc3NlcyBmb3Igc3R5bGluZyBpbmNsdWRlZC9leGNsdWRlZCBzdGF0ZXNcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgPT09ICdpbmNsdWRlJyAmJiBpc0VmZmVjdGl2ZWx5SW5jbHVkZWQpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnaXMtaW5jbHVkZWQnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRNb2RlID09PSAnZXhjbHVkZScgJiYgaXNFZmZlY3RpdmVseUV4Y2x1ZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgLy8gQXBwbHkgZXhjbHVkZWQgY2xhc3MgZXZlbiBpZiBpdCdzIGp1c3QgdmlzdWFsbHkgZGlzYWJsZWRcclxuICAgICAgICAgICAgICAgICAvLyBUaGlzIGFsbG93cyBzcGVjaWZpYyBzdHlsaW5nIGZvciBleGNsdWRlZCBpdGVtcyBiZXlvbmQganVzdCBncmV5ZWQgb3V0XHJcbiAgICAgICAgICAgICAgICBub2RlLmVsZW1lbnQuYWRkQ2xhc3MoJ2lzLWV4Y2x1ZGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgaWYgYSBnaXZlbiBwYXRoIGlzIGVmZmVjdGl2ZWx5IGluY2x1ZGVkXHJcbiAgICAgKiBpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24gdW5kZXIgJ2luY2x1ZGUnIG1vZGUuXHJcbiAgICAgKiBBIHBhdGggaXMgaW5jbHVkZWQgaWYgaXQgKGZpbGUgb3IgZm9sZGVyKSBpcyBzZWxlY3RlZCwgb3IgaWYgYW55IG9mIGl0cyBhbmNlc3RvciBGT0xERVJTIGFyZSBzZWxlY3RlZC5cclxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZvbGRlciBvciBmaWxlIHBhdGggdG8gY2hlY2suXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBwYXRoIHNob3VsZCBiZSBjb25zaWRlcmVkIGluY2x1ZGVkLCBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNQYXRoRWZmZWN0aXZlbHlJbmNsdWRlZChwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBUaGlzIGNoZWNrIGlzIHByaW1hcmlseSBmb3IgJ2luY2x1ZGUnIG1vZGUgbG9naWMuXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgIT09ICdpbmNsdWRlJykge1xyXG4gICAgICAgICAgICAgLy8gSW4gJ2V4Y2x1ZGUnIG1vZGUsIGNvbmNlcHR1YWxseSBldmVyeXRoaW5nIGlzIGluY2x1ZGVkIHVubGVzcyBleGNsdWRlZC5cclxuICAgICAgICAgICAgIC8vIEZvciBpbnRlcm5hbCBjaGVja3MsIHdlIG1pZ2h0IG5lZWQgdGhlIGludmVyc2Ugb2YgZXhjbHVzaW9uLlxyXG4gICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzUGF0aEVmZmVjdGl2ZWx5RXhjbHVkZWQocGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGF0aCBpdHNlbGYgaXMgc2VsZWN0ZWQgKGFwcGxpZXMgdG8gYm90aCBmaWxlcyBhbmQgZm9sZGVycylcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsZXMuaGFzKHBhdGgpIHx8IHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYW55IGFuY2VzdG9yIEZPTERFUiBpcyBzZWxlY3RlZFxyXG4gICAgICAgIGxldCBjdXJyZW50ID0gcGF0aDtcclxuICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBjdXJyZW50LnN1YnN0cmluZygwLCBjdXJyZW50Lmxhc3RJbmRleE9mKCcvJykpIHx8ICcvJztcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZvbGRlcnMuaGFzKHBhcmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gQW4gYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IGN1cnJlbnQpIGJyZWFrOyAvLyBSZWFjaGVkIHJvb3Qgb3IgZXJyb3JcclxuICAgICAgICAgICAgY3VycmVudCA9IHBhcmVudFBhdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE5laXRoZXIgdGhlIHBhdGggbm9yIGFueSBhbmNlc3RvciBmb2xkZXIgaXMgc2VsZWN0ZWRcclxuICAgIH1cclxuXHJcbiAgICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGEgZ2l2ZW4gcGF0aCBpcyBlZmZlY3RpdmVseSBleGNsdWRlZFxyXG4gICAgICogaW4gdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHVuZGVyICdleGNsdWRlJyBtb2RlLlxyXG4gICAgICogQSBwYXRoIGlzIGV4Y2x1ZGVkIGlmIGl0IChmaWxlIG9yIGZvbGRlcikgaXMgc2VsZWN0ZWQsIG9yIGlmIGFueSBvZiBpdHMgYW5jZXN0b3IgRk9MREVSUyBhcmUgc2VsZWN0ZWQuXHJcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmb2xkZXIgb3IgZmlsZSBwYXRoIHRvIGNoZWNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcGF0aCBzaG91bGQgYmUgY29uc2lkZXJlZCBleGNsdWRlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlzUGF0aEVmZmVjdGl2ZWx5RXhjbHVkZWQocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgIC8vIFRoaXMgY2hlY2sgaXMgcHJpbWFyaWx5IGZvciAnZXhjbHVkZScgbW9kZSBsb2dpYy5cclxuICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1vZGUgIT09ICdleGNsdWRlJykge1xyXG4gICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGF0aCBpdHNlbGYgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGVzLmhhcyhwYXRoKSB8fCB0aGlzLmN1cnJlbnRGb2xkZXJzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIC8vIENoZWNrIGlmIGFueSBhbmNlc3RvciBGT0xERVIgaXMgc2VsZWN0ZWRcclxuICAgICAgICAgbGV0IGN1cnJlbnQgPSBwYXRoO1xyXG4gICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gJy8nKSB7XHJcbiAgICAgICAgICAgICBjb25zdCBwYXJlbnRQYXRoID0gY3VycmVudC5zdWJzdHJpbmcoMCwgY3VycmVudC5sYXN0SW5kZXhPZignLycpKSB8fCAnLyc7XHJcbiAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Rm9sZGVycy5oYXMocGFyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gQW4gYW5jZXN0b3IgZm9sZGVyIGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gY3VycmVudCkgYnJlYWs7IC8vIFJlYWNoZWQgcm9vdCBvciBlcnJvclxyXG4gICAgICAgICAgICAgY3VycmVudCA9IHBhcmVudFBhdGg7XHJcbiAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gTmVpdGhlciB0aGUgcGF0aCBub3IgYW55IGFuY2VzdG9yIGZvbGRlciBpcyBzZWxlY3RlZCBmb3IgZXhjbHVzaW9uXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29tYmluZXMgYnVpbGRpbmcgdGhlIHRyZWUgZGF0YSwgcmVuZGVyaW5nIHRoZSBET00sIGFuZCBhcHBseWluZyBpbml0aWFsIGFwcGVhcmFuY2UuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYnVpbGRBbmRSZW5kZXJUcmVlKCkge1xyXG4gICAgICAgIC8vIGxvZ2dlci5sb2coREVCVUcsJ0J1aWxkaW5nIGFuZCByZW5kZXJpbmcgdHJlZS4uLicpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyVHJlZSgpOyAvLyBCdWlsZCBkYXRhIGFuZCByZW5kZXIgRE9NIGVsZW1lbnRzXHJcbiAgICAgICAgdGhpcy51cGRhdGVUcmVlQXBwZWFyYW5jZSgpOyAvLyBBcHBseSBzdHlsZXMgYmFzZWQgb24gY3VycmVudCBtb2RlL3NlbGVjdGlvblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBjbG9zZWQuIENsZWFucyB1cCByZXNvdXJjZXMuXHJcbiAgICAgKi9cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgLy8gR2F0aGVyIHRoZSBmaW5hbCBzdGF0ZSBPTkxZIHdoZW4gT0sgaXMgY2xpY2tlZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0ID0ge1xyXG4gICAgICAgICAgICBmb2xkZXJzOiBBcnJheS5mcm9tKHRoaXMuY3VycmVudEZvbGRlcnMpLFxyXG4gICAgICAgICAgICBmaWxlczogQXJyYXkuZnJvbSh0aGlzLmN1cnJlbnRGaWxlcyksXHJcbiAgICAgICAgICAgIG1vZGU6IHRoaXMuY3VycmVudE1vZGUsXHJcbiAgICAgICAgICAgIGRpc3BsYXk6IHRoaXMuY3VycmVudERpc3BsYXksXHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBsb2dnZXIubG9nKERFQlVHLFwiT0sgQ2xpY2tlZCAtIFJldHVybmluZyBSZXN1bHQ6XCIsIHJlc3VsdCk7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgIHRoaXMub2tDYWxsYmFjayhyZXN1bHQpOyAvLyBQYXNzIHRoZSBmaW5hbCBzZWxlY3Rpb24gYmFja1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpOyAvLyBDbGVhciB0aGUgbW9kYWwncyBjb250ZW50XHJcbiAgICAgICAgdGhpcy50cmVlTm9kZXMuY2xlYXIoKTsgLy8gQ2xlYXIgdGhlIG5vZGUgbWFwIHRvIGZyZWUgbWVtb3J5XHJcbiAgICAgICAgdGhpcy5tb2RlRHJvcGRvd24gPSBudWxsOyAvLyBDbGVhciByZWZlcmVuY2VcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBlYXNpbHkgb3BlbiB0aGUgRGlyZWN0b3J5IFNlbGVjdGlvbiBNb2RhbC5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBpbml0aWFsRm9sZGVycyAtIEFycmF5IG9mIGluaXRpYWxseSBzZWxlY3RlZCBmb2xkZXIgcGF0aHMuXHJcbiAqIEBwYXJhbSBpbml0aWFsRmlsZXMgLSBBcnJheSBvZiBpbml0aWFsbHkgc2VsZWN0ZWQgZmlsZSBwYXRocy5cclxuICogQHBhcmFtIGluaXRpYWxNb2RlIC0gVGhlIGluaXRpYWwgc2VsZWN0aW9uIG1vZGUgKCdpbmNsdWRlJyBvciAnZXhjbHVkZScpLlxyXG4gKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICBhcHA6IEFwcCxcclxuICAgIGluaXRpYWxGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgIGluaXRpYWxGaWxlczogc3RyaW5nW10sXHJcbiAgICBvcHRpb25zOiBEaXJlY3RvcnlTZWxlY3Rpb25PcHRpb25zLFxyXG4gICAgb2tDYWxsYmFjazogKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4pOiB2b2lkIHtcclxuICAgIC8vIENyZWF0ZSBhbmQgb3BlbiB0aGUgbW9kYWwgaW5zdGFuY2VcclxuICAgIG5ldyBEaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICBhcHAsXHJcbiAgICAgICAgaW5pdGlhbEZvbGRlcnMsXHJcbiAgICAgICAgaW5pdGlhbEZpbGVzLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgb2tDYWxsYmFja1xyXG4gICAgKS5vcGVuKCk7XHJcbn1cclxuXHJcbi8qXHJcbi8vIC0tLSBFeGFtcGxlIFVzYWdlIGluIHlvdXIgUGx1Z2luJ3MgU2V0dGluZ3MgVGFiIC0tLVxyXG4vLyAoUGxhY2UgdGhpcyBpbiB5b3VyIHNldHRpbmdzIHRhYiBmaWxlLCBlLmcuLCBzZXR0aW5ncy50cylcclxuXHJcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLCBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfSBmcm9tICcuL0RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXHJcbmltcG9ydCBZb3VyUGx1Z2luIGZyb20gJy4vbWFpbic7IC8vIEFkanVzdCBwYXRoIHRvIHlvdXIgbWFpbiBwbHVnaW4gZmlsZVxyXG5cclxuLy8gLS0tIEV4YW1wbGUgUGx1Z2luIFNldHRpbmdzIEludGVyZmFjZSAoaW4geW91ciBtYWluLnRzIG9yIHNldHRpbmdzIGZpbGUpIC0tLVxyXG5leHBvcnQgaW50ZXJmYWNlIFlvdXJQbHVnaW5TZXR0aW5ncyB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IHN0cmluZ1tdO1xyXG4gICAgc2VsZWN0ZWRGaWxlczogc3RyaW5nW107XHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScgfCAnZXhjbHVkZSc7XHJcbiAgICAvLyAuLi4gb3RoZXIgc2V0dGluZ3MgZm9yIHlvdXIgcGx1Z2luXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBZb3VyUGx1Z2luU2V0dGluZ3MgPSB7XHJcbiAgICBzZWxlY3RlZEZvbGRlcnM6IFtdLFxyXG4gICAgc2VsZWN0ZWRGaWxlczogW10sXHJcbiAgICBzZWxlY3Rpb25Nb2RlOiAnZXhjbHVkZScsIC8vIERlZmF1bHQgbW9kZSBpcyBvZnRlbiAnZXhjbHVkZSdcclxuICAgIC8vIC4uLiBvdGhlciBkZWZhdWx0IHNldHRpbmdzXHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgWW91clBsdWdpblNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IFlvdXJQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogWW91clBsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnRWluc3RlbGx1bmdlbiBmXHUwMEZDciBNZWluIFBsdWdpbicgfSk7IC8vIFNldHRpbmdzIFRpdGxlIGluIEdlcm1hblxyXG5cclxuICAgICAgICAvLyAtLS0gQnV0dG9uIHRvIE9wZW4gdGhlIE1vZGFsIC0tLVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVmVyemVpY2huaXNzZS9EYXRlaWVuIGtvbmZpZ3VyaWVyZW4nKSAvLyBTZXR0aW5nIE5hbWUgaW4gR2VybWFuXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdLbGlja2UgYXVmIGRlbiBCdXR0b24sIHVtIGRpZSBBdXN3YWhsIHp1IGJlYXJiZWl0ZW4uJykgLy8gU2V0dGluZyBEZXNjcmlwdGlvbiBpbiBHZXJtYW5cclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0F1c3dhaGwgXHUwMEY2ZmZuZW4nKSAvLyBCdXR0b24gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgY3VycmVudCBzZXR0aW5ncyB0byBwcmUtcG9wdWxhdGUgdGhlIG1vZGFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGb2xkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgfHwgJ2V4Y2x1ZGUnOyAvLyBVc2UgZGVmYXVsdCBpZiBub3Qgc2V0XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBtb2RhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGb2xkZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE1vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBva0NhbGxiYWNrIGZ1bmN0aW9uOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRywnQXVzd2FobCBiZXN0XHUwMEU0dGlndDonLCByZXN1bHQpOyAvLyBMb2cgcmVzdWx0IGluIEdlcm1hbiBjb25zb2xlXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0tLSBJTVBPUlRBTlQ6IFNhdmUgdGhlIHJlc3VsdHMgYmFjayB0byB5b3VyIHBsdWdpbiBzZXR0aW5ncyAtLS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbk1vZGUgPSByZXN1bHQubW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgLy8gUGVyc2lzdCB0aGUgY2hhbmdlc1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcHRpb25hbGx5LCByZS1yZW5kZXIgdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHNlbGVjdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXIgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgLy8gLS0tIERpc3BsYXkgQ3VycmVudCBTZWxlY3Rpb24gKFJlYWQtb25seSkgLS0tXHJcbiAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkluZm9FbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzLXNlbGVjdGlvbi1pbmZvJyB9KTtcclxuICAgICAgICAgc2VsZWN0aW9uSW5mb0VsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0FrdHVlbGxlIEF1c3dhaGw6JyB9KTsgLy8gU2VjdGlvbiBUaXRsZSBpbiBHZXJtYW5cclxuICAgICAgICAgY29uc3QgbW9kZVRleHQgPSBgTW9kdXM6ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0aW9uTW9kZSB8fCAnTmljaHQgZmVzdGdlbGVndCd9YDsgLy8gVGV4dCBpbiBHZXJtYW5cclxuICAgICAgICAgLy8gVHJ1bmNhdGUgbG9uZyBsaXN0cyBmb3IgZGlzcGxheSBpZiBuZWNlc3NhcnlcclxuICAgICAgICAgY29uc3QgZm9sZGVyVGV4dCA9IGBBdXNnZXdcdTAwRTRobHRlIE9yZG5lcjogJHsodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXJzPy5sZW5ndGggfHwgMCl9IFN0XHUwMEZDY2tgOyAvLyBUZXh0IGluIEdlcm1hblxyXG4gICAgICAgICBjb25zdCBmaWxlVGV4dCA9IGBBdXNnZXdcdTAwRTRobHRlIERhdGVpZW46ICR7KHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRmlsZXM/Lmxlbmd0aCB8fCAwKX0gU3RcdTAwRkNja2A7IC8vIFRleHQgaW4gR2VybWFuXHJcblxyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IG1vZGVUZXh0IH0pO1xyXG4gICAgICAgICBzZWxlY3Rpb25JbmZvRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGZvbGRlclRleHQgfSk7XHJcbiAgICAgICAgIHNlbGVjdGlvbkluZm9FbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogZmlsZVRleHQgfSk7XHJcbiAgICAgICAgIC8vIFlvdSBjb3VsZCBhZGQgYSBzbWFsbCBidXR0b24vbGluayBoZXJlIHRvIHZpZXcgdGhlIGZ1bGwgbGlzdCBpZiBpdCdzIGxvbmdcclxuICAgIH1cclxufVxyXG4qL1xyXG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIERyb3Bkb3duQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCwgc2V0SWNvbiwgYXBpVmVyc2lvbiwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCwgRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7XHJcbmltcG9ydCB7IHZlcnNpb25TdHJpbmcsIEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIERFRkFVTFRfUlVMRV9ERUZJTklUSU9OLCBQcm9wZXJ0eVR5cGVJbmZvLCBPYnNpZGlhblByb3BlcnR5VHlwZXMsIERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTLCBQcm9wZXJ0eUluZm99IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBjaGVja0lmRmlsZUFsbG93ZWQsIGV4ZWN1dGVSdWxlT2JqZWN0IH0gZnJvbSAnLi9ydWxlcyc7XHJcbmltcG9ydCB7IEFsZXJ0TW9kYWwgfSBmcm9tICcuL2FsZXJ0Qm94JztcclxuaW1wb3J0IHsgcmFuZG9tVVVJRCB9IGZyb20gJ2NyeXB0byc7XHJcbmltcG9ydCB7IGNvZGVFZGl0b3JNb2RhbCwgY29kZUVkaXRvck1vZGFsUmVzdWx0LCBvcGVuQ29kZUVkaXRvck1vZGFsIH0gZnJvbSAnLi9lZGl0b3JNb2RhbCc7XHJcbmltcG9ydCB7IGNvcHlGaWxlU3luYyB9IGZyb20gJ2ZzJztcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgdXBkYXRlUHJvcGVydHlJY29uIH0gZnJvbSAnLi91aUVsZW1lbnRzJztcclxuaW1wb3J0IHsgcnVsZXNNYW5hZ2VyIH0gZnJvbSAnLi9ydWxlcy9ydWxlcyc7XHJcbmltcG9ydCB7IERFQlVHLCBsb2dnZXIsIFdBUk5JTkcgfSBmcm9tICcuL0xvZyc7XHJcbmltcG9ydCB7IE11bHRpUHJvcGVydHlTZXR0aW5nIH0gZnJvbSAnLi91aU11bHRpUHJvcGVydHlTZXR0aW5nJztcclxuaW1wb3J0IHsgVHJlZUhpZXJhcmNoeURhdGEsIFRyZWVIaWVyYXJjaHlTb3J0YWJsZVNldHRpbmdzLCBST09UX0ZPTERFUiwgVHJlZUhpZXJhcmNoeVJvdyB9IGZyb20gJy4vdWlUcmVlSGllcmFyY2h5U29ydGFibGVTZXR0aW5ncyc7XHJcbmltcG9ydCB7IE1hcmtkb3duSGVscE1vZGFsIH0gZnJvbSAnLi91aU1hcmtkb3duSGVscE1vZGFsJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSdWxlc1RhYmxlIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IGFueTtcclxuICAgIGtub3duUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgUHJvcGVydHlJbmZvPiA9IHt9OyBcclxuICAgIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBwcm9wZXJ0aWVzTGlzdEVsITogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBzZXR0aW5nczogVHJlZUhpZXJhcmNoeURhdGE7XHJcbiAgICB0b29sczogU2NyaXB0aW5nVG9vbHM7XHJcbiAgICBhY3RpdmVGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IGFueSwgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgc2V0dGluZ3M6IFRyZWVIaWVyYXJjaHlEYXRhKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgICAgICB0aGlzLnRvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBIZWxwZXIgdG8gcmVuZGVyIG9uZSBydWxlXHJcblxyXG4gICAgcmVuZGVyUHJvcGVydHlSb3coY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJvd0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktc2V0dGluZy1yb3cgc2V0dGluZy1pdGVtJyB9KTtcclxuICAgICAgICByb3dFbC5zdHlsZS53aWR0aCA9ICcxMDAlJzsgLy8gbWFrZSBzdXJlIHRoZSByb3cgdGFrZXMgZnVsbCB3aWR0aFxyXG4gICAgICAgIHJvd0VsLmlkID0gcnVsZS5pZDtcclxuICAgICAgICBjb25zdCBjb250cm9sRWwgPSByb3dFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5nLWl0ZW0tY29udHJvbCcgfSk7IFxyXG4gICAgICAgIGNvbnRyb2xFbC5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICBjb250cm9sRWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICBjb250cm9sRWwuc3R5bGUuZ2FwID0gJzBweCc7XHJcbiAgICAgICAgY29uc3QgbGVmdENvbnRhaW5lciA9IGNvbnRyb2xFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1sZWZ0LWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgY29uc3QgaWNvbkVsID0gbGVmdENvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAncHJvcGVydHktaWNvbiBzZXR0aW5nLWl0ZW0taWNvbicgfSk7IFxyXG4gICAgICAgIHNldEljb24oaWNvbkVsLCAnaGFzaCcpOyAvLyBTdGFuZGFyZC1JY29uXHJcblxyXG5cclxuICAgICAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSBsZWZ0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXNlYXJjaC1jb250YWluZXInIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChzZWFyY2hDb250YWluZXIpXHJcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignU2VsZWN0IHByb3BlcnR5Li4uJylcclxuICAgICAgICAgICAgLnNldFZhbHVlKHJ1bGUucHJvcGVydHkgfHwgJycpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXIsIHZhbHVlLCBydWxlKTtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuc3R5bGUuYm9yZGVyID0gJ25vbmUnOyAvLyBtYWtlIGl0IGludmlzaWJsZVxyXG4gICAgICAgIG5hbWVJbnB1dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyLCBuYW1lSW5wdXQuZ2V0VmFsdWUoKSwgcnVsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXIsIG5hbWVJbnB1dC5nZXRWYWx1ZSgpLCBydWxlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVsYXRlZFRhcmdldCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgYXMgTm9kZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHNFbCA9IHNlYXJjaENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvcGVydHktc2VhcmNoLXJlc3VsdHMnKTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0c0VsIHx8ICFyZXN1bHRzRWwuY29udGFpbnMocmVsYXRlZFRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyU2VhcmNoUmVzdWx0cyhzZWFyY2hDb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBjdXJyZW50UHJvcGVydHlJbmZvID0gdGhpcy5rbm93blByb3BlcnRpZXNbcnVsZS5wcm9wZXJ0eV07XHJcbiAgICAgICAgaWYgKGN1cnJlbnRQcm9wZXJ0eUluZm8pIHtcclxuICAgICAgICAgICAgdXBkYXRlUHJvcGVydHlJY29uKGljb25FbCwgY3VycmVudFByb3BlcnR5SW5mby50eXBlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJ1bGUucHJvcGVydHkpIHtcclxuICAgICAgICAgICAgc2V0SWNvbihpY29uRWwsICdhbGVydC1jaXJjbGUnKTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBtaWRkbGVDb250YWluZXIgPSBjb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktbWlkZGxlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBtaWRkbGVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnRk1BLXByb3BlcnR5LXZhbHVlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlRmlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIodGhpcy5hY3RpdmVGaWxlLCBhc3luYyAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHJ1bGUudmFsdWUgPSBhd2FpdCBleGVjdXRlUnVsZU9iamVjdCgncHJldmlldycsdGhpcy5hcHAsIHRoaXMsIHRoaXMucGx1Z2luLnNldHRpbmdzLCB0aGlzLmFjdGl2ZUZpbGUsICcnLCBydWxlLCBmcm9udG1hdHRlcik7IC8vVE9ETzogaW1wbGVtZW50IHVzaW5nIG9ubHkgdXBkYXRlUGVydmlld1xyXG4gICAgICAgICAgICB9LHsnbXRpbWUnOnRoaXMuYWN0aXZlRmlsZS5zdGF0Lm10aW1lfSk7IC8vIGRvIG5vdCBjaGFuZ2UgdGhlIG1vZGlmeSB0aW1lLlxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwcmV2aWV3Q29tcG9uZW50ID0gdGhpcy5yZW5kZXJWYWx1ZUlucHV0KHZhbHVlQ29udGFpbmVyLCBjdXJyZW50UHJvcGVydHlJbmZvLCBydWxlLnZhbHVlLCBydWxlKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5RGV2RHJvcGRvd24gPSAgbmV3IERyb3Bkb3duQ29tcG9uZW50KG1pZGRsZUNvbnRhaW5lcik7XHJcbiAgICAgICAgcHJvcGVydHlEZXZEcm9wZG93bi5zZWxlY3RFbC5zdHlsZS5taW5XaWR0aCA9ICczNSUnXHJcbiAgICAgICAgcHJvcGVydHlEZXZEcm9wZG93bi5zZWxlY3RFbC5zdHlsZS5tYXhXaWR0aCA9ICc1MCUnO1xyXG4gICAgICAgIHByb3BlcnR5RGV2RHJvcGRvd24uYWRkT3B0aW9uKFwiXCIsIFwiU2VsZWN0IGEgY29udGVudFwiKTtcclxuXHJcbiAgICAgICAgLy8gYWRkIHJ1bGUgZnVuY3Rpb25zIHRvIGRyb3Bkb3duXHJcbiAgICAgICAgcnVsZXNNYW5hZ2VyLmdldFJ1bGVzQnlUeXBlKCdidWlsZEluJywgcnVsZS50eXBlKS5mb3JFYWNoKHJ1bGUgPT4ge1xyXG4gICAgICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLmFkZE9wdGlvbihydWxlLmlkLCBydWxlLm5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBwcm9wZXJ0eURldkRyb3Bkb3duLmFkZE9wdGlvbihcInNjcmlwdFwiLCBcIkphdmFTY3JpcHQgZnVuY3Rpb24gKGFkdmFuY2VkKVwiKTtcclxuICAgICAgICBwcm9wZXJ0eURldkRyb3Bkb3duLnNldFZhbHVlKHJ1bGUuY29udGVudCk7XHJcbiAgICAgICAgcHJvcGVydHlEZXZEcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcnVsZUZ1bmN0aW9uID0gcnVsZXNNYW5hZ2VyLmdldFJ1bGVCeUlkKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAocnVsZUZ1bmN0aW9uPy5ydWxlVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NjcmlwdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRJbi5pbnB1dFByb3BlcnR5JzpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZEluJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9ydWxlLmJ1aWxkSW5Db2RlID0gcnVsZXNNYW5hZ2VyLmdldFNvdXJjZSh2YWx1ZSkgfHwgcnVsZXNNYW5hZ2VyLmdldFNvdXJjZSgnZGVmYXVsdCcpIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2xkT3JpZ2luYWxDb2RlID0gcnVsZXNNYW5hZ2VyLmdldFNvdXJjZSh2YWx1ZSkgfHwgcnVsZXNNYW5hZ2VyLmdldFNvdXJjZSgnZGVmYXVsdCcpIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHJ1bGUuYnVpbGRJbkNvZGUgIT09ICcnKSAmJiAocnVsZS5idWlsZEluQ29kZSAhPT0gb2xkT3JpZ2luYWxDb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkUHJvY2VlZCA9IGF3YWl0IG5ldyBBbGVydE1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ092ZXJ3cml0ZSBleGlzdGluZyBjb2RlPycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJIHNlZXMgbGlrZSB5b3UgaGF2ZSBjdXN0b20gY29kZSBmb3IgdGhpcyBydWxlISBTaG91bGQgdGhpcyBiZSBvdmVyd3JpdHRlbiBieSBkZWZhdWx0IGNvZGUgZm9yIHRoaXMgcGFyYW1ldGVyPycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdZZXMnLCAnTm8nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5vcGVuQW5kR2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZFByb2NlZWQucHJvY2VlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUgPSBydWxlc01hbmFnZXIuZ2V0U291cmNlKHZhbHVlKSB8fCBydWxlc01hbmFnZXIuZ2V0U291cmNlKCdkZWZhdWx0JykgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS51c2VDdXN0b21Db2RlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGU7IC8vIGtlZXAgdGhlIGV4aXN0aW5nIGNvZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZSA9IHJ1bGVzTWFuYWdlci5nZXRTb3VyY2UodmFsdWUpIHx8IHJ1bGVzTWFuYWdlci5nZXRTb3VyY2UoJ2RlZmF1bHQnKSB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudXNlQ3VzdG9tQ29kZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1dG9tYXRpb24nOlxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1dG9jb21wbGV0ZS5tb2RhbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJ1bGUuaXNMaXZlUnVsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydWxlLmNvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIC8vcnVsZU9wdGlvbnNEaXYuc3R5bGUuZGlzcGxheSA9IGAkeyhydWxlLmNvbnRlbnQgPT09ICdzY3JpcHQnKSA/ICdmbGV4JyA6ICdub25lJ31gO1xyXG4gICAgICAgICAgICAgICAgLy9zaG93SnNGdW5jdGlvbkJ1dHRvbihydWxlLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb3BlcnR5T3B0aW9ucyhvcHRpb25FTCwgcnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBsZWZ0Q29udGFpbmVyRWwgPSBjb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAnRk1BLXByb3BlcnR5LXJpZ2h0LWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChsZWZ0Q29udGFpbmVyRWwpXHJcbiAgICAgICAgLnNldEljb24oJ2dlYXInKVxyXG4gICAgICAgIC5zZXRUb29sdGlwKCdvcGVuIHNldHRpbmdzJylcclxuICAgICAgICAuc2V0Q2xhc3MoJ3Byb3BlcnR5LWljb24tYnV0dG9uJylcclxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzZXR0aW5nc0NvbnRhaW5lcnMgPSBjb250YWluZXJFbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9wZXJ0eS1vcHRpb25zLWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb250YWluZXIgb2Ygc2V0dGluZ3NDb250YWluZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gcnVsZS5pZCkgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdkaXNwbGF5OiBub25lOycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvcGVydHlPcHRpb25zKG9wdGlvbkVMLCBydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgb3B0aW9uRUwuc3R5bGUuZGlzcGxheSA9IG9wdGlvbkVMLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycgPyAnbm9uZScgOiAnYmxvY2snO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgLy8gLS0tIHJpZ2h0IHBhcnQ6IGVyYXNlIHJ1bGUgLS0tXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uQ29udGFpbmVyID0gY29udHJvbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LWRlbGV0ZS1idXR0b24tY29udGFpbmVyJyB9KTtcclxuICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGRlbGV0ZUJ1dHRvbkNvbnRhaW5lcilcclxuICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoLTInKVxyXG4gICAgICAgICAgICAuc2V0VG9vbHRpcCgncmVtb3ZlIHRoaXMgcnVsZScpXHJcbiAgICAgICAgICAgIC5zZXRDbGFzcygnbW9kLXN1YnRsZScpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXIgdGhlIHNldHRpbmdzIHRhYlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBkZWxldGVCdXR0b25Db250YWluZXIuc3R5bGUubWFyZ2luTGVmdCA9ICdhdXRvJzsgXHJcbiAgICAgICAgKi9cclxuICAgICAgICBjb250cm9sRWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICBjb250cm9sRWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgIGNvbnRyb2xFbC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdzcGFjZS1iZXR3ZWVuJztcclxuICAgICAgICBjb250cm9sRWwuc3R5bGUud2lkdGggPSAnMTAwJSc7XHJcblxyXG4gICAgICAgIGxlZnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICBsZWZ0Q29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcclxuICAgICAgICBsZWZ0Q29udGFpbmVyLnN0eWxlLm1pbldpZHRoID0gJzEwMHB4JzsgXHJcbiAgICAgICAgaWNvbkVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7XHJcblxyXG4gICAgICAgIHNlYXJjaENvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7IFxyXG4gICAgICAgIC8vc2VhcmNoQ29udGFpbmVyLnN0eWxlLmZsZXhHcm93ID0gJzEnO1xyXG5cclxuICAgICAgICAvL3ZhbHVlQ29udGFpbmVyLnN0eWxlLmZsZXhHcm93ID0gJzQnOyBcclxuXHJcblxyXG4gICAgICAgIGxldCBvcHRpb25FTDogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGNvbnRhaW5lckVsLnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgb3B0aW9uRUwgPSBjb250YWluZXJFbC5wYXJlbnRFbGVtZW50LmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LW9wdGlvbnMtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgb3B0aW9uRUwuaWQgPSBydWxlLmlkO1xyXG4gICAgICAgICAgICBvcHRpb25FTC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGZhbGxiYWNrOiBjcmVhdGUgaW4gY29udGFpbmVyRWwgaWYgcGFyZW50RWxlbWVudCBpcyBudWxsXHJcbiAgICAgICAgICAgIG9wdGlvbkVMID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktb3B0aW9ucy1jb250YWluZXInIH0pO1xyXG4gICAgICAgICAgICBvcHRpb25FTC5pZCA9IHJ1bGUuaWQ7XHJcbiAgICAgICAgICAgIG9wdGlvbkVMLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclByb3BlcnR5T3B0aW9ucyhvcHRpb25FTDogSFRNTERpdkVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHByZXZpZXdDb21wb25lbnQ6IEhUTUxEaXZFbGVtZW50IHwgVGV4dENvbXBvbmVudCB8IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlmICghKHByZXZpZXdDb21wb25lbnQgaW5zdGFuY2VvZiBUZXh0Q29tcG9uZW50KSkgcmV0dXJuO1xyXG4gICAgICAgIG9wdGlvbkVMLmVtcHR5KCk7IC8vIGNsZWFyIHByZXZpb3VzIG9wdGlvbnNcclxuICAgICAgICAvL2NvbnN0IHJ1bGVGbiA9IGdldFJ1bGVGdW5jdGlvbkJ5SWQocnVsZS5jb250ZW50KTtcclxuICAgICAgICBjb25zdCBydWxlRm4gPSBydWxlc01hbmFnZXIuZ2V0UnVsZUJ5SWQocnVsZS5jb250ZW50KTtcclxuICAgICAgICBpZiAoIXJ1bGVGbikgcmV0dXJuO1xyXG4gICAgICAgIGlmIChydWxlRm4udXNlUnVsZU9wdGlvbigncmVtb3ZlQ29udGVudCcpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZUNvbnRlbnRCdXR0b24gPSBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdSZW1vdmUgY29udGVudCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhgQmVmb3JlIG1ha2luZyBjaGFuZ2VzIHlvdSBtaWdodCBjb25zaWRlciB0byByZW1vdmUgY29udGVudCBnZW5lcmF0ZWQgYnkgdGhpcyBydWxlYClcclxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVtb3ZlIENvbnRlbnQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY291bnQgPSB0aGlzLnBsdWdpbi5yZW1vdmVGcm9udG1hdHRlclBhcmFtc0Zyb21BbGxGaWxlcyhydWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXREaXNhYmxlZCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNvbnRlbnRCdXR0b24uc2V0RGVzYyhgUmVtb3ZlZCB0aGlzIHJ1bGUgZnJvbSAke2NvdW50LmZpbGVzfSBmaWxlcy5gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocnVsZUZuLnVzZVJ1bGVPcHRpb24oJ3J1bGVBY3RpdmUnKSkge1xyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdSdWxlIGFjdGl2ZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnSWYgZW5hYmxlZCwgdGhlIHJ1bGUgd2lsbCBiZSBleGVjdXRlZCcpXHJcbiAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5hY3RpdmUpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLmFjdGl2ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJ1bGVGbi51c2VSdWxlT3B0aW9uKCdtb2RpZnlPbmx5JykpIHtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdNb2RpZnkgb25seScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdPbmx5IG1vZGlmeSBleGlzdGluZyBwcm9wZXJ0aWVzJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5vbmx5TW9kaWZ5KVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGUub25seU1vZGlmeSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ3RleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgbGV0IGZvcm1hdFJ1bGUgPSBydWxlc01hbmFnZXIuZ2V0UnVsZUJ5SWQocnVsZS5mb3JtYXR0ZXIpO1xyXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZXJSdWxlcyA9IHJ1bGVzTWFuYWdlci5nZXRSdWxlc0J5VHlwZSgnZm9ybWF0dGVyJykgfHwgW107XHJcbiAgICAgICAgICAgIGxldCBmb3JtYXRPcHRpb25zQnV0dG9uOiBhbnk7XHJcbiAgICAgICAgICAgIGlmIChydWxlRm4udXNlUnVsZU9wdGlvbignY29udmVydFRvTG93ZXJDYXNlJykpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG11bHRpUHJvcCA9IG5ldyBNdWx0aVByb3BlcnR5U2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0TmFtZShcIkZvcm1hdCBvdXRwdXRcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGVzYyhcIkZvcm1hdCBvdXRwdXQgdXNpbmcgc2VsZWN0ZWQgb3B0aW9ucy5cIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0T3B0aW9ucyhmb3JtYXR0ZXJSdWxlcylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5mb3JtYXR0ZXJzIHx8IFsndG9PcmlnaW5hbCddKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgoZm9ybWF0dGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZm9ybWF0dGVycyA9IGZvcm1hdHRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0UnVsZSA9IHJ1bGVzTWFuYWdlci5nZXRSdWxlQnlJZChydWxlLmZvcm1hdHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG11bHRpUHJvcC5hZGRFeHRyYUJ1dHRvbigoc2V0dGluZywgaWR4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oYnRuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXRJY29uKCdnZWFyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdPcHRpb25zJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXREaXNhYmxlZCghcnVsZXNNYW5hZ2VyLmdldFJ1bGVCeUlkKHJ1bGU/LmZvcm1hdHRlcnM/LltpZHhdID8/IFwidG9PcmlnaW5hbFwiKT8uaGFzT3duQ29uZmlnVGFiKCkgfHwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udmVydGVyT3B0aW9uRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnZlcnRlck9wdGlvbkRpdi5lbXB0eSgpOyAvLyBjbGVhciBwcmV2aW91cyBvcHRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0UnVsZSA9IHJ1bGVzTWFuYWdlci5nZXRSdWxlQnlJZChydWxlPy5mb3JtYXR0ZXJzPy5baWR4XSA/PyBcInRvT3JpZ2luYWxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0UnVsZT8uY29uZmlnVGFiKGNvbnZlcnRlck9wdGlvbkRpdiwgcnVsZSwgdGhpcywgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11bHRpUHJvcC5zdHlsZURpc2FibGVkKGJ0biwgIXJ1bGVzTWFuYWdlci5nZXRSdWxlQnlJZChydWxlPy5mb3JtYXR0ZXJzPy5baWR4XSA/PyBcInRvT3JpZ2luYWxcIik/Lmhhc093bkNvbmZpZ1RhYigpIHx8IGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGNvbnZlcnRlck9wdGlvbkRpdiA9IG9wdGlvbkVMLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LWNvbnZlcnRlci1vcHRpb24nIH0pO1xyXG4gICAgICAgICAgICBjb252ZXJ0ZXJPcHRpb25EaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgY29udmVydGVyT3B0aW9uRGl2LnN0eWxlLm1hcmdpbkxlZnQgPSAnMjBweCc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAocnVsZUZuLnVzZVJ1bGVPcHRpb24oJ3Jlc3VsdEFzTGluaycpKSB7XHJcbiAgICAgICAgICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUmVzdWx0IGFzIExpbmsnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXREZXNjKCdGb3JtYXQgUmVzdWx0IGFzIExpbmsnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzTWFuYWdlci5nZXRSdWxlc0J5VHlwZSgnbGlua0Zvcm1hdHRlcicpLmZvckVhY2gocnVsZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24ocnVsZS5pZCwgcnVsZS5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHJ1bGUubGlua0Zvcm1hdHRlciB8fCAndG9PcmlnaW5hbExpbmsnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUubGlua0Zvcm1hdHRlciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ3RleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgaWYgKHJ1bGVGbi51c2VSdWxlT3B0aW9uKCdhZGRDb250ZW50JykpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXROYW1lKCdBZGQgY29udGVudCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERlc2MoJ3NlbGVjdCBob3cgdGhlIGNvbnRlbnQgc2hvdWxkIGJlIHN0b3JlZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oXCJvdmVyd3JpdGVcIiwgXCJyZXBsYWNlIGNvbnRlbnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcInN0YXJ0XCIsIFwicGxhY2Ugb24gc3RhcnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcImVuZFwiLCBcInBsYWNlIG9uIGVuZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUocnVsZS5hZGRDb250ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5hZGRDb250ZW50ID0gdmFsdWUgPT09ICdvdmVyd3JpdGUnID8gJ292ZXJ3cml0ZScgOiB2YWx1ZSA9PT0gJ3N0YXJ0JyA/ICdzdGFydCcgOiAnZW5kJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocnVsZUZuLnVzZVJ1bGVPcHRpb24oJ2V4Y2x1ZGVGb2xkZXJzJykpIHtcclxuICAgICAgICAgICAgY29uc3QgZXhjbHVkZUVMID0gbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZSBGaWxlcyBhbmQgRm9sZGVycyBmcm9tIHRoaXMgcnVsZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoIHx8IDB9IGZvbGRlcnMgYW5kICR7cnVsZS5leGNsdWRlPy5zZWxlY3RlZEZpbGVzLmxlbmd0aCB8fCAwfSBmaWxlcyB3aWxsIGJlICR7cnVsZS5leGNsdWRlPy5tb2RlIHx8ICdleGNsdWRlJ31kLmApXHJcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdmb2xkZXIteCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdFeGNsdWRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZT8uc2VsZWN0ZWRGb2xkZXJzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZT8uc2VsZWN0ZWRGaWxlcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiAnZXhjbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiBydWxlLmV4Y2x1ZGU/LmRpc3BsYXkgfHwgJ2ZvbGRlcnMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2hvd0ZpbGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJ1bGUuZXhjbHVkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5leGNsdWRlPU9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfRklMVEVSX0ZJTEVTX0FORF9GT0xERVJTLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZSA6ICdleGNsdWRlJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZS5zZWxlY3RlZEZvbGRlcnMgPSByZXN1bHQuZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5leGNsdWRlLnNlbGVjdGVkRmlsZXMgPSByZXN1bHQuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuZXhjbHVkZS5tb2RlID0gJ2V4Y2x1ZGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmV4Y2x1ZGUuZGlzcGxheSA9IHJlc3VsdC5kaXNwbGF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxydWxlLmV4Y2x1ZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlckluZGljYXRvcih0aGlzLmFjdGl2ZUZpbGUsIHRoaXMucHJvcGVydGllc0xpc3RFbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVFTC5zZXREZXNjKGBDdXJyZW50bHkgJHtydWxlLmV4Y2x1ZGU/LnNlbGVjdGVkRm9sZGVycy5sZW5ndGggfHwgMH0gZm9sZGVycyBhbmQgJHtydWxlLmV4Y2x1ZGU/LnNlbGVjdGVkRmlsZXMubGVuZ3RoIHx8IDB9IGZpbGVzIHdpbGwgYmUgJHtydWxlLmV4Y2x1ZGU/Lm1vZGUgfHwgJ2V4Y2x1ZGUnfWQuYClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pOyAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocnVsZUZuLnVzZVJ1bGVPcHRpb24oJ2luY2x1ZGVGb2xkZXJzJykpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5jbHVkZUVMID0gbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnSW5jbHVkZSBGaWxlcyBhbmQgRm9sZGVycyBmb3IgdGhpcyBydWxlICcpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhgQ3VycmVudGx5ICR7cnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoIHx8IDB9IGZvbGRlcnMgYW5kICR7cnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZpbGVzLmxlbmd0aCB8fCAwfSBmaWxlcyB3aWxsIGJlICR7cnVsZS5pbmNsdWRlPy5tb2RlIHx8ICdpbmNsdWRlJ31kIGV2ZW4gaWYgdGhleSBhcmUgZXhjbHVkZWQgZ2xvYmFsbHkuYClcclxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLWNoZWNrJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnSW5jbHVkZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIE1ha2VzIHRoZSBidXR0b24gbW9yZSBwcm9taW5lbnRcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZvbGRlcnMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLmluY2x1ZGU/LnNlbGVjdGVkRmlsZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbk1vZGU6ICdpbmNsdWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TW9kZTogcnVsZS5pbmNsdWRlPy5kaXNwbGF5IHx8ICdmb2xkZXJzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TZWxlY3Rpb25Nb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TaG93RmlsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogRGlyZWN0b3J5U2VsZWN0aW9uUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFydWxlLmluY2x1ZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5pbmNsdWRlID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9GSUxURVJfRklMRVNfQU5EX0ZPTERFUlMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGUgOiAnaW5jbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycyA9IHJlc3VsdC5mb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZS5zZWxlY3RlZEZpbGVzID0gcmVzdWx0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZS5tb2RlID0gJ2luY2x1ZGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuaW5jbHVkZS5kaXNwbGF5ID0gcmVzdWx0LmRpc3BsYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxydWxlLmluY2x1ZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRmlsdGVySW5kaWNhdG9yKHRoaXMuYWN0aXZlRmlsZSwgdGhpcy5wcm9wZXJ0aWVzTGlzdEVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlRUwuc2V0RGVzYyhgQ3VycmVudGx5ICR7cnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZvbGRlcnMubGVuZ3RoIHx8IDB9IGZvbGRlcnMgYW5kICR7cnVsZS5pbmNsdWRlPy5zZWxlY3RlZEZpbGVzLmxlbmd0aCB8fCAwfSBmaWxlcyB3aWxsIGJlICR7cnVsZS5pbmNsdWRlPy5tb2RlIHx8ICdpbmNsdWRlJ31kLmApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICB9ICAgICAgXHJcbiAgICAgICAgaWYgKHJ1bGVGbi51c2VSdWxlT3B0aW9uKCdzY3JpcHQnKSkge1xyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdTY3JpcHQnKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ2VkaXQgdGhlIHNjcmlwdCBmb3Igb3duIG1vZGlmaWNhdGlvbnMnKVxyXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4geyBidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnSlMgRWRpdG9yJylcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUJVRyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBPcGVuaW5nIGNvZGUgZWRpdG9yIGZvciBydWxlICR7cnVsZS5pZH0gd2l0aCBjb250ZW50ICR7cnVsZS5jb250ZW50fSwgZmlsZTogJHt0aGlzLmFjdGl2ZUZpbGU/LnBhdGh9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlRmlsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlRmlsZSA/IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKHRoaXMuYWN0aXZlRmlsZSkgfHwge30gOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuQ29kZUVkaXRvck1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUuYnVpbGRJbkNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLnR5cGVQcm9wZXJ0eT8udHlwZSB8fCAndGV4dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgPyB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmFjdGl2ZUZpbGUpPy5mcm9udG1hdHRlciB8fCB7fSA6IHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5idWlsZEluQ29kZSA9IHJlc3VsdC5jb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudXNlQ3VzdG9tQ29kZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEN0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS51c2VDdXN0b21Db2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDdGEoKTsgLy8gTWFrZXMgdGhlIGJ1dHRvbiBtb3JlIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDdGEoKTsgLy8gTWFrZXMgdGhlIGJ1dHRvbiBsZXNzIHByb21pbmVudFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gYWRkIGN1c3RvbSBjb25maWdcclxuICAgICAgICBsZXQgcnVsZU9wdGlvbkRpdiA9IG9wdGlvbkVMLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXJ1bGUtb3B0aW9uJyB9KTtcclxuICAgICAgICBydWxlT3B0aW9uRGl2LnN0eWxlLm1hcmdpbkxlZnQgPSAnMjBweCc7XHJcbiAgICAgICAgcnVsZXNNYW5hZ2VyLmJ1aWxkQ29uZmlnVGFiKHJ1bGUuY29udGVudCwgcnVsZU9wdGlvbkRpdiwgcnVsZSwgdGhpcywgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0cmlldmVzIHRoZSBjb25maWd1cmF0aW9uIG9wdGlvbiBmb3IgYSBzcGVjaWZpYyBydWxlIGFuZCBwcm9wZXJ0eS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcnVsZUlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBydWxlLlxyXG4gICAgICogQHBhcmFtIHByb3BlcnR5SWQgLSBUaGUgc3BlY2lmaWMgcHJvcGVydHkgZm9yIHdoaWNoIHRoZSBjb25maWd1cmF0aW9uIGlzIGJlaW5nIHJldHJpZXZlZC5cclxuICAgICAqIEByZXR1cm5zIFRoZSBjb25maWd1cmF0aW9uIHZhbHVlIGZvciB0aGUgc3BlY2lmaWVkIHByb3BlcnR5LCBvciB1bmRlZmluZWQgaWYgbm90IGZvdW5kLlxyXG4gICAgICovXHJcbiAgICBnZXRPcHRpb25Db25maWcocnVsZUlkOnN0cmluZyxwcm9wZXJ0eUlkOnN0cmluZyl7XHJcbiAgICAgICAgY29uc3QgcnVsZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZpbmQoKHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpID0+IHJ1bGUuaWQgPT09IHJ1bGVJZCk7XHJcbiAgICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICAgICAgY29uc3Qgb3B0aW9uQ29uZmlnID0gcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbkNvbmZpZ1twcm9wZXJ0eUlkXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbkNvbmZpZ1twcm9wZXJ0eUlkXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0cyB0aGUgY29uZmlndXJhdGlvbiBvcHRpb24gZm9yIGEgc3BlY2lmaWMgcnVsZSBhbmQgcHJvcGVydHkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJ1bGVJZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgcnVsZS5cclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eUlkIC0gVGhlIHNwZWNpZmljIHByb3BlcnR5IGZvciB3aGljaCB0aGUgY29uZmlndXJhdGlvbiBpcyBiZWluZyBzZXQuXHJcbiAgICAgKiBAcGFyYW0gY29uZmlnIC0gVGhlIGNvbmZpZ3VyYXRpb24gdmFsdWUgdG8gYmUgc2V0LlxyXG4gICAgICovXHJcbiAgICBzZXRPcHRpb25Db25maWcocnVsZUlkOnN0cmluZyxwcm9wZXJ0eUlkOnN0cmluZyxjb25maWc6YW55KXtcclxuICAgICAgICBjb25zdCBydWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucnVsZXMuZmluZCgocnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncykgPT4gcnVsZS5pZCA9PT0gcnVsZUlkKTtcclxuICAgICAgICBpZiAocnVsZSkge1xyXG4gICAgICAgICAgICBpZiAoIXJ1bGUub3B0aW9uc0NvbmZpZykgcnVsZS5vcHRpb25zQ29uZmlnID0ge31cclxuICAgICAgICAgICAgaWYgKCFydWxlLm9wdGlvbnNDb25maWdbcnVsZUlkXSkgcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF0gPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdW3Byb3BlcnR5SWRdID0gY29uZmlnO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFzT3B0aW9uQ29uZmlnKHJ1bGVJZDpzdHJpbmcpOmJvb2xlYW57XHJcbiAgICAgICAgY29uc3QgcnVsZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZpbmQoKHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpID0+IHJ1bGUuaWQgPT09IHJ1bGVJZCk7XHJcbiAgICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICAgICAgaWYgKCFydWxlLm9wdGlvbnNDb25maWcpIHJ1bGUub3B0aW9uc0NvbmZpZyA9IHt9XHJcbiAgICAgICAgICAgIGlmICghcnVsZS5vcHRpb25zQ29uZmlnW3J1bGVJZF0pIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdID0ge307XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhydWxlLm9wdGlvbnNDb25maWdbcnVsZUlkXSkubGVuZ3RoID4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGVJZDpzdHJpbmcsIGRlZmF1bHRzOmFueSl7XHJcbiAgICAgICAgY29uc3QgcnVsZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZpbmQoKHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpID0+IHJ1bGUuaWQgPT09IHJ1bGVJZCk7XHJcbiAgICAgICAgaWYgKHJ1bGUpIHtcclxuICAgICAgICAgICAgaWYgKCFydWxlLm9wdGlvbnNDb25maWcpIHJ1bGUub3B0aW9uc0NvbmZpZyA9IHt9XHJcbiAgICAgICAgICAgIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMsIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdIHx8IHt9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJ1bGUub3B0aW9uc0NvbmZpZ1tydWxlSWRdO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBzZWFyY2hUZXJtOiBzdHJpbmcsIHBheWxvYWQ6IGFueSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY2xlYXJTZWFyY2hSZXN1bHRzKHNlYXJjaENvbnRhaW5lckVsKTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRQcm9wZXJ0aWVzID0gT2JqZWN0LmVudHJpZXModGhpcy5rbm93blByb3BlcnRpZXMpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoKFtuYW1lXSkgPT4gbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSkpO1xyXG5cclxuICAgICAgICBpZiAoZmlsdGVyZWRQcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMCAmJiBzZWFyY2hUZXJtKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZpbHRlcmVkUHJvcGVydGllcy5sZW5ndGggPT09IDAgJiYgIXNlYXJjaFRlcm0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcmVzdWx0c0VsID0gc2VhcmNoQ29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktc2VhcmNoLXJlc3VsdHMgbWVudScgfSk7XHJcbiAgICAgICAgcmVzdWx0c0VsLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgICAgICByZXN1bHRzRWwuc3R5bGUudG9wID0gJzEwMCUnO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS5sZWZ0ID0gJzAnO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS53aWR0aCA9ICdjYWxjKDEwMCUgKyAxMDBweCknO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS56SW5kZXggPSAnMTAnO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS5tYXhIZWlnaHQgPSAnMjAwcHgnO1xyXG4gICAgICAgIHJlc3VsdHNFbC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcblxyXG4gICAgICAgIGxldCBhY3RpdmVJbmRleCA9IC0xO1xyXG5cclxuICAgICAgICBjb25zdCB1cGRhdGVBY3RpdmVJdGVtID0gKG5ld0luZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSByZXN1bHRzRWwucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpO1xyXG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSBuZXdJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uYWRkQ2xhc3MoJ3Byb3BlcnR5LXNlYXJjaC1pcy1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNjcm9sbEludG9WaWV3KHsgYmxvY2s6ICduZWFyZXN0JyB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZW1vdmVDbGFzcygncHJvcGVydHktc2VhcmNoLWlzLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYWN0aXZlSW5kZXggPSBuZXdJbmRleDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBzZWxlY3RBY3RpdmVJdGVtID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlSW5kZXggPj0gMCAmJiBhY3RpdmVJbmRleCA8IGZpbHRlcmVkUHJvcGVydGllcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IFtuYW1lLCBpbmZvXSA9IGZpbHRlcmVkUHJvcGVydGllc1thY3RpdmVJbmRleF07XHJcbiAgICAgICAgICAgICAgICBwYXlsb2FkLnByb3BlcnR5ID0gbmFtZTtcclxuICAgICAgICAgICAgICAgIHBheWxvYWQudHlwZSA9IGluZm8udHlwZTtcclxuICAgICAgICAgICAgICAgIHBheWxvYWQudmFsdWUgPSB1bmRlZmluZWQ7IC8vIFJlc2V0IHZhbHVlXHJcbiAgICAgICAgICAgICAgICAvL3RoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW3Jvd0luZGV4XS5wcm9wZXJ0eSA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW3Jvd0luZGV4XS50eXBlID0gaW5mby50eXBlO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnBsdWdpbi5zZXR0aW5nc1t0aGlzLnNldHRpbmdzUGFyYW1ldGVyXVtyb3dJbmRleF0udmFsdWUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWFyY2hSZXN1bHRzKHNlYXJjaENvbnRhaW5lckVsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZS1yZW5kZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZpbHRlcmVkUHJvcGVydGllcy5mb3JFYWNoKChbbmFtZSwgaW5mb10sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1FbCA9IHJlc3VsdHNFbC5jcmVhdGVEaXYoeyBjbHM6ICdtZW51LWl0ZW0nIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtSWNvbiA9IGl0ZW1FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbWVudS1pdGVtLWljb24nIH0pO1xyXG4gICAgICAgICAgICB1cGRhdGVQcm9wZXJ0eUljb24oaXRlbUljb24sIGluZm8udHlwZSk7XHJcbiAgICAgICAgICAgIGl0ZW1FbC5jcmVhdGVTcGFuKHsgdGV4dDogbmFtZSB9KTtcclxuXHJcbiAgICAgICAgICAgIGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGVjdEFjdGl2ZUl0ZW0oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlYXJjaENvbnRhaW5lckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IHJlc3VsdHNFbC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudS1pdGVtJyk7XHJcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZUFjdGl2ZUl0ZW0oKGFjdGl2ZUluZGV4ICsgMSkgJSBpdGVtcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZUFjdGl2ZUl0ZW0oKGFjdGl2ZUluZGV4IC0gMSArIGl0ZW1zLmxlbmd0aCkgJSBpdGVtcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxlY3RBY3RpdmVJdGVtKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhclNlYXJjaFJlc3VsdHMoc2VhcmNoQ29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0c0VsID0gc2VhcmNoQ29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LXNlYXJjaC1yZXN1bHRzJyk7XHJcbiAgICAgICAgaWYgKHJlc3VsdHNFbCkge1xyXG4gICAgICAgICAgICByZXN1bHRzRWwucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclZhbHVlSW5wdXQoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwcm9wZXJ0eUluZm86IFByb3BlcnR5SW5mbyB8IHVuZGVmaW5lZCwgY3VycmVudFZhbHVlOiBhbnksIHBheWxvYWQ6IGFueSkge1xyXG4gICAgICAgIGxldCByZXR1cm5Db21wb25lbnQ6IGFueTtcclxuXHJcbiAgICAgICAgaWYgKCFwcm9wZXJ0eUluZm8pIHtcclxuICAgICAgICAgICAgIGNvbnRhaW5lckVsLnNldFRleHQoJycpO1xyXG4gICAgICAgICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3RleHQtbXV0ZWQnKTtcclxuICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHR5cGUgPSBwcm9wZXJ0eUluZm8udHlwZTtcclxuXHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ051bWVyaWMgVmFsdWUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50VmFsdWUgIT09IG51bGwgPyBTdHJpbmcoY3VycmVudFZhbHVlKSA6ICcnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtVmFsdWUgPSB2YWx1ZSA9PT0gJycgPyB1bmRlZmluZWQgOiBwYXJzZUZsb2F0KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC52YWx1ZSA9IGlzTmFOKG51bVZhbHVlIGFzIG51bWJlcikgPyB1bmRlZmluZWQgOiBudW1WYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLnBsdWdpbi5zZXR0aW5nc1t0aGlzLnNldHRpbmdzUGFyYW1ldGVyXVtpbmRleF0udmFsdWUgPSBpc05hTihudW1WYWx1ZSBhcyBudW1iZXIpID8gdW5kZWZpbmVkIDogbnVtVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LmlucHV0RWwudHlwZSA9ICdudW1iZXInO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ0ZNQS10cmktc3RhdGUtY2hlY2tib3gnIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDaGVja2JveCBjaGFuZ2Ugc3RhdGUnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnY2hlY2tib3gnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVDaGVja2JveFZpc3VhbCA9IChzdGF0ZTogYm9vbGVhbiB8IHVuZGVmaW5lZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpY29uTmFtZTogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhcmlhU3RhdGU6ICd0cnVlJyB8ICdmYWxzZScgfCAnbWl4ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdjaGVjay1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhU3RhdGUgPSAndHJ1ZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbk5hbWUgPSAnc3F1YXJlJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYVN0YXRlID0gJ2ZhbHNlJztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyB1bmRlZmluZWQgb3IgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdtaW51cy1zcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhU3RhdGUgPSAnbWl4ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKHJldHVybkNvbXBvbmVudCwgaWNvbk5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsIGFyaWFTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGUgPSBTdHJpbmcoc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVDaGVja2JveFZpc3VhbChjdXJyZW50VmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY3VycmVudFN0YXRlID0gcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRTdGF0ZTogYm9vbGVhbiB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFN0YXRlID09PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gdW5kZWZpbmVkOyBcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gZmFsc2U7IFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnZhbHVlID0gbmV4dFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gbmV4dFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVDaGVja2JveFZpc3VhbChuZXh0U3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1lZWVktTU0tREQnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnZhbHVlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW2luZGV4XS52YWx1ZSA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC50eXBlID0gJ2RhdGUnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2RhdGV0aW1lJzpcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignWVlZWS1NTS1ERFRISDptbScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKGN1cnJlbnRWYWx1ZSB8fCAnJylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQudmFsdWUgPSB2YWx1ZSB8fCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnZGF0ZXRpbWUtbG9jYWwnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2FsaWFzZXMnOlxyXG4gICAgICAgICAgICBjYXNlICd0YWdzJzpcclxuICAgICAgICAgICAgY2FzZSAnbXVsdGl0ZXh0JzpcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndmFsdWVzIChkaXZpZGVkIGJ5IGNvbW1hKScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKEFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSA/IGN1cnJlbnRWYWx1ZS5qb2luKCcsICcpIDogKGN1cnJlbnRWYWx1ZSB8fCAnJykpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnJheVZhbHVlID0gdmFsdWUuc3BsaXQoJywnKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQudmFsdWUgPSBhcnJheVZhbHVlLmxlbmd0aCA+IDAgPyBhcnJheVZhbHVlIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMucGx1Z2luLnNldHRpbmdzW3RoaXMuc2V0dGluZ3NQYXJhbWV0ZXJdW2luZGV4XS52YWx1ZSA9IGFycmF5VmFsdWUubGVuZ3RoID4gMCA/IGFycmF5VmFsdWUgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd2YWx1ZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKGN1cnJlbnRWYWx1ZSB8fCAnJylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQudmFsdWUgPSB2YWx1ZSB8fCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5wbHVnaW4uc2V0dGluZ3NbdGhpcy5zZXR0aW5nc1BhcmFtZXRlcl1baW5kZXhdLnZhbHVlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlICE9PSAnY2hlY2tib3gnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuaW5wdXRFbC5hZGRDbGFzcygnRk1BLXByb3BlcnR5LXZhbHVlLWlucHV0Jyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuYWRkQ2xhc3MoJ0ZNQS1wcm9wZXJ0eS12YWx1ZS1pbnB1dCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5Db21wb25lbnQ7XHJcbiAgIFxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHVwZGF0ZVByZXZpZXcocnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlRmlsZSkge1xyXG4gICAgICAgICAgICBsZXQgcnVsZVJlc3VsdDphbnk7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcih0aGlzLmFjdGl2ZUZpbGUsIGFzeW5jIChmcm9udG1hdHRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gcnVsZVJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVSdWxlKCdwcmV2aWV3Jyx0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MsIHRoaXMuYWN0aXZlRmlsZSwgJycsIHJ1bGUsIGZyb250bWF0dGVyKTtcclxuICAgICAgICAgICAgICAgIHJ1bGVSZXN1bHQgPSBhd2FpdCBleGVjdXRlUnVsZU9iamVjdCgncHJldmlldycsdGhpcy5hcHAsIHRoaXMsIHRoaXMucGx1Z2luLnNldHRpbmdzLCB0aGlzLmFjdGl2ZUZpbGUsICcnLCBydWxlLCBmcm9udG1hdHRlcik7XHJcbiAgICAgICAgICAgIH0seydtdGltZSc6dGhpcy5hY3RpdmVGaWxlLnN0YXQubXRpbWV9KTsgIFxyXG5cclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlb2YgcnVsZVJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShydWxlUmVzdWx0KSkgcHJldmlld0NvbXBvbmVudC5pbnB1dEVsLnZhbHVlID0gcnVsZVJlc3VsdC50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlld0NvbXBvbmVudD8uaW5wdXRFbCkgcHJldmlld0NvbXBvbmVudC5pbnB1dEVsLnZhbHVlID0gcnVsZVJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gY29tcG9uZW50RWwuc2V0VG9vbHRpcChjb21wb25lbnRFbC52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBhc3luYyBkaXNwbGF5KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXI7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgdGhpcy5rbm93blByb3BlcnRpZXMgPSBhd2FpdCB0aGlzLnRvb2xzLmZldGNoS25vd25Qcm9wZXJ0aWVzKHRoaXMuYXBwKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnByb3BlcnRpZXNMaXN0RWwgPSBjb250YWluZXJFbDsgLy8uY3JlYXRlRGl2KCdwcm9wZXJ0aWVzLWxpc3QnKTtcclxuXHJcbiAgICAgICAgLy90aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJDb25maWcucm93cyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGZvbGRlckxpc3QgPSBuZXcgVHJlZUhpZXJhcmNoeVNvcnRhYmxlU2V0dGluZ3MoXHJcbiAgICAgICAgICAgIGNvbnRhaW5lckVsLFxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJDb25maWcsXHJcbiAgICAgICAgICAgIChyb3csIHJvd0VsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgcm93IGNvbnRlbnQgaGVyZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9wZXJ0eVJvdyhyb3dFbCwgcm93LnBheWxvYWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLnNldFRpdGxlKCdSdWxlcycpXHJcbiAgICAgICAgICAgIC5zZXREZXNjcmlwdGlvbignYWRkIHJ1bGVzIHRvIHNlbGVjdGVkIGZyb250bWF0dGVyIHByb3BlcnRpZXMnKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlckNvbmZpZyA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlckluZGljYXRvcih0aGlzLmFjdGl2ZUZpbGUsIHRoaXMucHJvcGVydGllc0xpc3RFbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm9uUmVuZGVyZWQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGaWx0ZXJJbmRpY2F0b3IodGhpcy5hY3RpdmVGaWxlLCB0aGlzLnByb3BlcnRpZXNMaXN0RWwpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub25Sb3dDcmVhdGVkKGFzeW5jIChyb3cpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHROYW1lID0gJyc7IC8vT2JqZWN0LmtleXModGhpcy5rbm93blByb3BlcnRpZXMpWzBdIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgcm93LnBheWxvYWQgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1JVTEVfREVGSU5JVElPTiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiByYW5kb21VVUlEKCkudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5vbkRlbGV0ZUJ0KGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZFByb2NlZWQgPSBhd2FpdCBuZXcgQWxlcnRNb2RhbChcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAnRXJhc2UgYWxsIFJ1bGVzPycsXHJcbiAgICAgICAgICAgICAgICAgICAgJ0RvIHlvdSByZWFsbHkgbGlrZSB0byBlcmFzZSBBTEwgcnVsZXM/JyxcclxuICAgICAgICAgICAgICAgICAgICAnWWVzJywgJ05vJ1xyXG4gICAgICAgICAgICAgICAgKS5vcGVuQW5kR2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZFByb2NlZWQucHJvY2VlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmZvbGRlckNvbmZpZy5yb3dzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvblRvSGVhZGVyKChlbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWwuYWRkRXh0cmFCdXR0b24oYnRuID0+IGJ0blxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwiY2lyY2xlLWhlbHBcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXJrZG93biA9IFwiQ291bGQgbm90IGxvYWQgaGVscCBmcm9tIEdpdEh1Yi5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9tYXJrZG93biA9IGF3YWl0IGZldGNoTWFya2Rvd25Gcm9tR2l0SHViKFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NocmlzdGlhbi1NZS9vYnNpZGlhbi1mcm9udC1tYXR0ZXItYXV0b21hdGUvbWFpbi9kb2MvUkVBRE1FLm1kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9tYXJrZG93biA9IGF3YWl0IHJlYWRQbHVnaW5Eb2NGaWxlKFwiUkVBRE1FLm1kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFya2Rvd25IZWxwTW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luLCBtYXJrZG93biwgXCJSRUFETUUubWRcIikub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9sZGVyQ29uZmlnLnJvd3MubGVuZ3RoID09PSAwICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIHJ1bGVzIGJ1dCBubyBmb2xkZXIgY29uZmlnLCBjcmVhdGUgZGVmYXVsdCByb3dzXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZvckVhY2goKHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGtleXdvcmRzIDogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgICAgIGtleXdvcmRzLnB1c2gocnVsZS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgIGZvbGRlckxpc3QuYWRkUm93KFJPT1RfRk9MREVSLCBbXSwgcnVsZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKlxyXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJ1bGVzLmZvckVhY2goKHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9wZXJ0eVJvdyh0aGlzLnByb3BlcnRpZXNMaXN0RWwsIHJ1bGUsIGluZGV4KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAqL1xyXG4gICAgICAgIGxldCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlckluZGljYXRvcihhY3RpdmVGaWxlLCB0aGlzLnByb3BlcnRpZXNMaXN0RWwpO1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgY29uc3QgYWRkQnRuQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZy1pdGVtLWNvbnRyb2wnIH0pO1xyXG4gICAgICAgIGFkZEJ0bkNvbnRhaW5lci5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdyaWdodCc7XHJcbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChhZGRCdG5Db250YWluZXIpXHJcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdBZGQgUHJvcGVydHknKVxyXG4gICAgICAgICAgICAuc2V0SWNvbigncGx1cy1jaXJjbGUnKVxyXG4gICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdE5hbWUgPSAnJzsgLy9PYmplY3Qua2V5cyh0aGlzLmtub3duUHJvcGVydGllcylbMF0gfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnBsdWdpbi5zZXR0aW5nc1t0aGlzLnNldHRpbmdzUGFyYW1ldGVyXS5wdXNoKHsgbmFtZTogZGVmYXVsdE5hbWUsIHZhbHVlOiB1bmRlZmluZWQgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5nc1t0aGlzLnNldHRpbmdzUGFyYW1ldGVyXS5wdXNoKE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfUlVMRV9ERUZJTklUSU9OLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHJhbmRvbVVVSUQoKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJ1dHRvbkVsLmNsYXNzTmFtZT0ncHJvcGVydHktcGx1cy1idXR0b24nO1xyXG4gICAgICAgICovXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVGaWx0ZXJJbmRpY2F0b3IoYWN0aXZlRmlsZTpURmlsZSB8IG51bGwsIHByb3BlcnRpZXNMaXN0RWw6IEhUTUxEaXZFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGFjdGl2ZUZpbGUpIHsgLy9UT0RPOiBmaXggZm9yIG5ldyBzb3J0YWJsZSBUYWJsZVxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJDb25maWcucm93cy5mb3JFYWNoKChyb3c6IFRyZWVIaWVyYXJjaHlSb3csIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJ1bGUgPSByb3cucGF5bG9hZCBhcyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHlSb3dFbGVtZW50cyA9IHByb3BlcnRpZXNMaXN0RWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncHJvcGVydHktc2V0dGluZy1yb3cnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5Um93RWwgPSBBcnJheS5mcm9tKHByb3BlcnR5Um93RWxlbWVudHMpLmZpbHRlcihlbCA9PiBlbC5pZCA9PT0gcnVsZS5pZClbMF0gYXMgSFRNTERpdkVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnR5Um93RWwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIFNraXAgaWYgbm8gcm93IGZvdW5kIGZvciB0aGlzIHJ1bGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5TGVmdERpdiA9IHByb3BlcnR5Um93RWwucXVlcnlTZWxlY3RvcignLnByb3BlcnR5LWxlZnQtY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tJZkZpbGVBbGxvd2VkKGFjdGl2ZUZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLCBydWxlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5TGVmdERpdj8uYWRkQ2xhc3MoJ3Byb3BlcnR5LWxlZnQtY29udGFpbmVyLWFsbG93ZWQnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlMZWZ0RGl2Py5yZW1vdmVDbGFzcygncHJvcGVydHktbGVmdC1jb250YWluZXItYWxsb3dlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgcmVuZGVyUmVzdWx0cywgU2VhcmNoQ29tcG9uZW50LCBTZXR0aW5nLCBURmlsZSwgVEZvbGRlciB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgZ2V0Rm9sZGVyRnJvbVBhdGgsIHBhcnNlSlNDb2RlLCBTY3JpcHRpbmdUb29scyB9IGZyb20gJy4vdG9vbHMnO1xyXG5pbXBvcnQgeyBPYnNpZGlhblByb3BlcnR5VHlwZXMsIEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIEZyb250bWF0dGVyQXV0b21hdGVTZXR0aW5ncywgRnJvbnRtYXR0ZXJBdXRvbWF0ZUV2ZW50cyB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBBdXRvY29tcGxldGVNb2RhbCwgYXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQsIG9wZW5BdXRvY29tcGxldGVNb2RhbCB9IGZyb20gJy4vYXV0b2NvbXBsZXRlTW9kYWwnO1xyXG5pbXBvcnQgeyBjb2RlRWRpdG9yTW9kYWxSZXN1bHQgfSBmcm9tICcuL2VkaXRvck1vZGFsJztcclxuaW1wb3J0IHsgRm9sZGVyU3VnZ2VzdCB9IGZyb20gXCIuL3N1Z2dlc3RlcnMvRm9sZGVyU3VnZ2VzdGVyXCI7XHJcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdGVycy9GaWxlU3VnZ2VzdGVyXCI7XHJcbmltcG9ydCB7IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCwgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsIH0gZnJvbSAnLi9kaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbCc7XHJcbmltcG9ydCB7IEFsZXJ0TW9kYWwgfSBmcm9tICcuL2FsZXJ0Qm94JztcclxuaW1wb3J0IHsgcnVsZXNNYW5hZ2VyIH0gZnJvbSAnLi9ydWxlcy9ydWxlcyc7XHJcbmltcG9ydCB7IERFQlVHLCBFUlJPUiwgbG9nZ2VyLCBUUkFDRSB9IGZyb20gJy4vTG9nJztcclxuXHJcbmV4cG9ydCB0eXBlIEZyb250bWF0dGVyQXV0b21hdGVSdWxlVHlwZXMgPSAnYnVpbGRJbicgfCAnYnVpbGRJbi5pbnB1dFByb3BlcnR5JyB8ICdhdXRvY29tcGxldGUubW9kYWwnIHwgJ2F1dG9tYXRpb24nIHwgJ3NjcmlwdCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VsZW1lbnRzIHtcclxuICAgIFtrZXk6IHN0cmluZ106IGJvb2xlYW4gfCB1bmRlZmluZWQ7XHJcbiAgICByZW1vdmVDb250ZW50OiBib29sZWFuO1xyXG4gICAgcnVsZUFjdGl2ZTogYm9vbGVhbjtcclxuICAgIG1vZGlmeU9ubHk6IGJvb2xlYW47XHJcbiAgICBpbnB1dFByb3BlcnR5OiBib29sZWFuO1xyXG4gICAgYWRkUHJlZml4OiBib29sZWFuO1xyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogYm9vbGVhbjtcclxuICAgIHNwZWNpYWxDaGFyYWN0ZXJSZXBsYWNlbWVudDogYm9vbGVhbjtcclxuICAgIGNvbnZlcnRUb0xvd2VyQ2FzZTogYm9vbGVhbjtcclxuICAgIHJlc3VsdEFzTGluazogYm9vbGVhbjtcclxuICAgIGFkZENvbnRlbnQ6IGJvb2xlYW47XHJcbiAgICBleGNsdWRlRm9sZGVyczogYm9vbGVhbjtcclxuICAgIGluY2x1ZGVGb2xkZXJzOiBib29sZWFuO1xyXG4gICAgc2NyaXB0OiBib29sZWFuO1xyXG59XHJcbmV4cG9ydCBpbnRlcmZhY2UgUnVsZUZ1bmN0aW9uIHtcclxuICAgIGlkOnN0cmluZztcclxuICAgIHJ1bGVUeXBlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVR5cGVzO1xyXG4gICAgZGVzY3JpcHRpb246c3RyaW5nO1xyXG4gICAgdG9vbHRpcD86IHN0cmluZztcclxuICAgIGlucHV0UHJvcGVydHk/OiBib29sZWFuO1xyXG4gICAgaXNMaXZlUnVsZT86IGJvb2xlYW47XHJcbiAgICBzb3VyY2U6c3RyaW5nO1xyXG4gICAgdHlwZTpPYnNpZGlhblByb3BlcnR5VHlwZXNbXTtcclxuICAgIGZ4OkZ1bmN0aW9uO1xyXG4gICAgY29uZmlnRWxlbWVudHM6IENvbmZpZ0VsZW1lbnRzO1xyXG4gICAgY29uZmlnVGFiPzogKG9wdGlvbkVsOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDphbnkpID0+IHZvaWQ7IC8vIGZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgY29uZmlnIHRhYiBmb3IgdGhlIHJ1bGVcclxufVxyXG4vKlxyXG5leHBvcnQgY29uc3QgcnVsZUZ1bmN0aW9uczpSdWxlRnVuY3Rpb25bXT1bXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSdWxlRnVuY3Rpb25CeUlkIChpZCA6IHN0cmluZyk6UnVsZUZ1bmN0aW9uIHwgdW5kZWZpbmVkIHtcclxuICAgIGNvbnN0IHJ1bGVGdW5jdGlvbiA9IHJ1bGVGdW5jdGlvbnMuZmluZChydWxlID0+IHJ1bGUuaWQgPT09IGlkKTtcclxuICAgIGlmICghcnVsZUZ1bmN0aW9uKSB7XHJcbiAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgUnVsZSBmdW5jdGlvbiAke2lkfSBub3QgZm91bmQhYCk7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIHJldHVybiBydWxlRnVuY3Rpb247XHJcbn1cclxuKi9cclxuZnVuY3Rpb24gYXBwbHlGb3JtYXRPcHRpb25zKHRoaXM6IGFueSwgdmFsdWU6YW55LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MpOmFueSB7XHJcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ2RhdGUnIHx8IHJ1bGUudHlwZSA9PT0gJ2RhdGV0aW1lJykgcmV0dXJuIHZhbHVlOyAvLyBsZWF2ZSBkYXRlIGFuZCBkYXRlVGltZSB1bnRvdWNoZWRcclxuICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xyXG4gICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICBjYXNlICdzdHJpbmcnOlxyXG4gICAgICBpZiAocnVsZS5zcGFjZVJlcGxhY2VtZW50ICYmIHJ1bGUuc3BhY2VSZXBsYWNlbWVudCAhPT0gJycpIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxzKy9nLCBydWxlLnNwYWNlUmVwbGFjZW1lbnQpO1xyXG4gICAgICBpZiAocnVsZS5zcGVjaWFsQ2hhclJlcGxhY2VtZW50ICYmIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCAhPT0nJykgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC9cdTAwRTRcdTAwRjZcdTAwRkNcdTAwREZcdTAwQzRcdTAwRDZcdTAwRENcdTAwRTFcdTAwRTlcdTAwRURcdTAwRjNcdTAwRkFcdTAwRkRcdTAwQzFcdTAwQzlcdTAwQ0RcdTAwRDNcdTAwREFcdTAwRERcdTAwRTBcdTAwRThcdTAwRUNcdTAwRjJcdTAwRjlcdTAwQzBcdTAwQzhcdTAwQ0NcdTAwRDJcdTAwRDlcdTAwRTJcdTAwRUFcdTAwRUVcdTAwRjRcdTAwRkJcdTAwQzJcdTAwQ0FcdTAwQ0VcdTAwRDRcdTAwREJcdTAwRTNcdTAwRjFcdTAwRjVcdTAwQzNcdTAwRDFcdTAwRDVdL2csIHJ1bGUuc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XHJcbiAgICAgIGlmIChydWxlLmZvcm1hdHRlciAmJiBydWxlLmZvcm1hdHRlciAhPT0gJycpIHtcclxuICAgICAgICB2YWx1ZSA9IHJ1bGVzTWFuYWdlci5leGVjdXRlUnVsZUJ5SWQocnVsZS5mb3JtYXR0ZXIsIHRoaXMuYXBwLCB0aGlzLmFjdGl2ZUZpbGUsIHRoaXMudG9vbHMsIHZhbHVlKTsgLy8gZXhlY3V0ZSB0aGUgZm9ybWF0dGVyIHJ1bGVcclxuICAgICAgfVxyXG4gICAgICBpZiAocnVsZS5saW5rRm9ybWF0dGVyICYmIHJ1bGUubGlua0Zvcm1hdHRlciAhPT0gJycpIHtcclxuICAgICAgICB2YWx1ZSA9IHJ1bGVzTWFuYWdlci5leGVjdXRlUnVsZUJ5SWQocnVsZS5saW5rRm9ybWF0dGVyLCB0aGlzLmFwcCwgdGhpcy5hY3RpdmVGaWxlLCB0aGlzLnRvb2xzLCB2YWx1ZSk7IC8vIGV4ZWN1dGUgdGhlIGxpbmsgZm9ybWF0dGVyIHJ1bGVcclxuICAgICAgfVxyXG4gICAgICBpZiAocnVsZS5wcmVmaXggJiYgcnVsZS5wcmVmaXggIT09ICcnKSB2YWx1ZSA9IHJ1bGUucHJlZml4ICsgdmFsdWU7XHJcbiAgICAgIHJldHVybiB2YWx1ZVxyXG4gICAgY2FzZSAnb2JqZWN0JzpcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcCh2YWx1ZSA9PiBhcHBseUZvcm1hdE9wdGlvbnModmFsdWUsIHJ1bGUpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG4gIHJldHVyblxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSdWxlUmVzdWx0KHJ1bGVGeDogRnVuY3Rpb24sIGFwcDogQXBwLCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCBydWxlRnVuY3Rpb246IFJ1bGVGdW5jdGlvbiwgY3VycmVudEZpbGU6IFRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scywgZnJvbnRNYXR0ZXI6YW55KTpQcm9taXNlPGFueT4ge1xyXG4gIGxldCByZXN1bHQ6YW55ID0gdW5kZWZpbmVkO1xyXG4gIC8vbG9nZ2VyLmxvZyhERUJVRywnZ2V0UnVsZVJlc3VsdCcsIHJ1bGVGeCwgcnVsZUZ1bmN0aW9uLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyKTtcclxuICBzd2l0Y2ggKHJ1bGVGdW5jdGlvbi5ydWxlVHlwZSkge1xyXG4gICAgY2FzZSAnc2NyaXB0JzpcclxuICAgIGNhc2UgJ2J1aWxkSW4nOlxyXG4gICAgICByZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMocnVsZUZ4KGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKSwgcnVsZSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnYnVpbGRJbi5pbnB1dFByb3BlcnR5JzpcclxuICAgICAgcmVzdWx0ID0gYXBwbHlGb3JtYXRPcHRpb25zKHJ1bGVGeChhcHAsIGN1cnJlbnRGaWxlLCB0b29scywgZnJvbnRNYXR0ZXJbcnVsZS5pbnB1dFByb3BlcnR5XSksIHJ1bGUpO1xyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnYXV0b2NvbXBsZXRlLm1vZGFsJzpcclxuICAgICAgcnVsZUZ4KGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKTtcclxuICAgICAgLy9sb2dnZXIubG9nKERFQlVHLCdhdXRvY29tcGxldGUgbW9kYWwnLCBydWxlRngsIHJ1bGVGdW5jdGlvbiwgY3VycmVudEZpbGUsIHRvb2xzKTtcclxuICAgICAgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdhdXRvbWF0aW9uJzpcclxuICAgICAgLy9sb2dnZXIubG9nKERFQlVHLCdhdXRvbWF0aW9uJywgcnVsZUZ1bmN0aW9uLCBjdXJyZW50RmlsZSwgdG9vbHMpO1xyXG4gICAgICByZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMocnVsZUZ4KGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKSwgcnVsZSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXhlY3V0ZVJ1bGVPYmplY3QgKFxyXG4gIGV2ZW50OiBGcm9udG1hdHRlckF1dG9tYXRlRXZlbnRzLFxyXG4gIGFwcDogQXBwLFxyXG4gIHBsdWdpbjogYW55LFxyXG4gIHNldHRpbmdzOiBGcm9udG1hdHRlckF1dG9tYXRlU2V0dGluZ3MsIFxyXG4gIGN1cnJlbnRGaWxlOiBURmlsZSB8IHVuZGVmaW5lZCB8IG51bGwsIFxyXG4gIGN1cnJlbnRDb250ZW50OiBhbnksIFxyXG4gIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgXHJcbiAgZnJvbnRNYXR0ZXI6IGFueSwgXHJcbiAgb2xkTG9jYXRpb25SZXN1bHRzPzp7cnVsZUlkOiBzdHJpbmcsIHJlc3VsdDogYW55fVtdKTphbnkge1xyXG5cclxuICBpZiAoIXJ1bGUpIHJldHVybiBjdXJyZW50Q29udGVudDtcclxuICBpZiAoIXJ1bGUuYWN0aXZlKSByZXR1cm4gY3VycmVudENvbnRlbnQ7XHJcbiAgaWYgKCFjdXJyZW50RmlsZSkgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gIGlmICghY2hlY2tJZkZpbGVBbGxvd2VkKGN1cnJlbnRGaWxlLCBzZXR0aW5ncywgcnVsZSkpIHJldHVybiBjdXJyZW50Q29udGVudDtcclxuICBjb25zdCB0b29scyA9IG5ldyBTY3JpcHRpbmdUb29scyhhcHAsIHBsdWdpbiwgc2V0dGluZ3MsIHJ1bGUsIGZyb250TWF0dGVyKTtcclxuICBsZXQgcmVzdWx0ID0gY3VycmVudENvbnRlbnQ7XHJcbiAgbGV0IG9sZFJlc3VsdDphbnkgPSB1bmRlZmluZWQ7XHJcbiAgdG9vbHMuc2V0Q3VycmVudENvbnRlbnQoZnJvbnRNYXR0ZXJbcnVsZS5wcm9wZXJ0eV0pXHJcbiAgdG9vbHMuc2V0UnVsZShydWxlKTtcclxuICB0b29scy5zZXRGcm9udG1hdHRlcihmcm9udE1hdHRlcik7XHJcbiAgdG9vbHMuc2V0QWN0aXZlRmlsZShjdXJyZW50RmlsZSk7XHJcbiAgY29uc3QgcnVsZU9iamVjdCA9IHJ1bGVzTWFuYWdlci5nZXRSdWxlQnlJZChydWxlLmNvbnRlbnQpO1xyXG4gIGlmICghcnVsZU9iamVjdCkgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG5cclxuICByZXN1bHQgPSBydWxlc01hbmFnZXIuZXhlY3V0ZVJ1bGUocnVsZSwgcnVsZU9iamVjdCwgYXBwLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyKTsgLy8gZXhlY3V0ZSB0aGUgZm9ybWF0dGVyIHJ1bGVcclxuICByZXN1bHQgPSBydWxlc01hbmFnZXIuYXBwbHlGb3JtYXRPcHRpb25zKHJlc3VsdCwgcnVsZSwgY3VycmVudEZpbGUsIHRvb2xzKTsgLy8gYXBwbHkgZm9ybWF0IG9wdGlvbnNcclxuICBpZiAob2xkTG9jYXRpb25SZXN1bHRzICYmIG9sZExvY2F0aW9uUmVzdWx0cy5sZW5ndGggPiAwICYmIHJ1bGUuYWRkQ29udGVudCAhPT0gJ292ZXJ3cml0ZScpIHtcclxuICAgIG9sZFJlc3VsdCA9IG9sZExvY2F0aW9uUmVzdWx0cy5maW5kKHJlcyA9PiByZXMucnVsZUlkID09PSBydWxlLmlkKT8ucmVzdWx0O1xyXG4gICAgaWYgKCFvbGRSZXN1bHQpIHtcclxuICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgZXhlY3V0ZVJ1bGVPYmplY3Q6IE9sZCByZXN1bHQgZm9yIHJ1bGUgJHtydWxlLnByb3BlcnR5fXwke3J1bGUuY29udGVudH0gbm90IGZvdW5kIWAsIG9sZExvY2F0aW9uUmVzdWx0cyk7XHJcbiAgICAgIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB0aGUgY3VycmVudCByZXN1bHQgaWYgbm8gb2xkIHJlc3VsdCBpcyBmb3VuZFxyXG4gICAgfVxyXG4gICAgb2xkUmVzdWx0ID0gcnVsZXNNYW5hZ2VyLmFwcGx5Rm9ybWF0T3B0aW9ucyhvbGRSZXN1bHQsIHJ1bGUsIGN1cnJlbnRGaWxlLCB0b29scyk7IC8vIGFwcGx5IGZvcm1hdCBvcHRpb25zIG9uIHRoZSBvbGQgZmlsZSBsb2NhdGlvblxyXG4gICAgbG9nZ2VyLmxvZyhERUJVRyxgZXhlY3V0ZVJ1bGVPYmplY3Q6IE1lcmdpbmcgcmVzdWx0IGZvciBydWxlICR7cnVsZS5wcm9wZXJ0eX18JHtydWxlLmNvbnRlbnR9IHdpdGggb2xkIHJlc3VsdGAsIG9sZFJlc3VsdCwgcmVzdWx0KTtcclxuICAgIHJlc3VsdCA9IHJ1bGVzTWFuYWdlci5tZXJnZVJlc3VsdChyZXN1bHQsIG9sZFJlc3VsdCwgY3VycmVudENvbnRlbnQsIHJ1bGUpOyAvLyBtZXJnZSB0aGUgcmVzdWx0IHdpdGggdGhlIGN1cnJlbnQgY29udGVudC4gUmVtb3ZlIG9sZCByZXN1bHQgaWYgbmVjZXNzYXJ5XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlc3VsdCA9IHJ1bGVzTWFuYWdlci5tZXJnZVJlc3VsdChyZXN1bHQsIHJlc3VsdCwgY3VycmVudENvbnRlbnQsIHJ1bGUpOyAvLyBtZXJnZSB0aGUgcmVzdWx0IHdpdGggdGhlIGN1cnJlbnQgY29udGVudC4gUmVtb3ZlIG9sZCByZXN1bHQgaWYgbmVjZXNzYXJ5XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuLypcclxuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGVSdWxlT2xkIChldmVudDogRnJvbnRtYXR0ZXJBdXRvbWF0ZUV2ZW50cywgYXBwLCBzZXR0aW5ncywgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCwgcmV0dXJuUmVzdWx0OiBhbnksIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgZnJvbnRNYXR0ZXIsIG9sZFBhdGg/OnN0cmluZykge1xyXG4gIC8vbG9nZ2VyLmxvZyhERUJVRyxgRXZlbnQ6ICR7ZXZlbnR9IGZvciBydWxlICR7cnVsZS5wcm9wZXJ0eX18JHtydWxlLmNvbnRlbnR9YCwgcnVsZSk7XHJcbiAgaWYgKCFydWxlLmFjdGl2ZSB8fCAhY3VycmVudEZpbGUpIHJldHVybiByZXR1cm5SZXN1bHQ7XHJcbiAgY29uc3QgdG9vbHMgPSBuZXcgU2NyaXB0aW5nVG9vbHMoYXBwLCB0aGlzLCBzZXR0aW5ncywgcnVsZSwgZnJvbnRNYXR0ZXIsIGN1cnJlbnRGaWxlKTtcclxuICBsZXQgZnhSZXN1bHQgPSByZXR1cm5SZXN1bHQ7XHJcbiAgbGV0IG9sZFJlc3VsdDphbnk7XHJcbiAgbGV0IG9sZEZpbGU6VEZpbGUgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XHJcbiAgaWYgKG9sZFBhdGgpIHtcclxuICAgIGxldCBvbGRGaWxlUGFydHMgPSBvbGRQYXRoLnNwbGl0KCcvJyk7XHJcbiAgICBvbGRGaWxlID0ge1xyXG4gICAgICBwYXRoOiBvbGRQYXRoLFxyXG4gICAgICBleHRlbnNpb246IG9sZEZpbGVQYXJ0c1tvbGRGaWxlUGFydHMubGVuZ3RoLTFdLnNwbGl0KCcuJylbMV0sXHJcbiAgICAgIG5hbWU6IG9sZEZpbGVQYXJ0c1tvbGRGaWxlUGFydHMubGVuZ3RoLTFdLnNwbGl0KCcuJylbMF0sXHJcbiAgICAgIHN0YXQ6IGN1cnJlbnRGaWxlLnN0YXQsXHJcbiAgICAgIGJhc2VuYW1lOiBjdXJyZW50RmlsZS5iYXNlbmFtZSxcclxuICAgICAgdmF1bHQ6IGN1cnJlbnRGaWxlLnZhdWx0LFxyXG4gICAgICBwYXJlbnQ6IGN1cnJlbnRGaWxlLnBhcmVudFxyXG4gICAgfVxyXG4gIH1cclxuICB0cnkge1xyXG4gICAgY29uc3QgZnVuY3Rpb25JbmRleCA9IHJ1bGVGdW5jdGlvbnMuZmluZEluZGV4KGZ4ID0+IGZ4LmlkID09PSBydWxlLmNvbnRlbnQpO1xyXG4gICAgaWYgKGZ1bmN0aW9uSW5kZXg9PT0tMSl7XHJcbiAgICAgIGxvZ2dlci5sb2coRVJST1IsYFJ1bGUgZnVuY3Rpb24gJHtydWxlLmNvbnRlbnR9IG5vdCBmb3VuZCFgKTtcclxuICAgICAgcmV0dXJuIHJldHVyblJlc3VsdDsgLy8gcmV0dXJuIHRoZSBvcmlnaW5hbCB2YWx1ZSBpZiB0aGUgZnVuY3Rpb24gaXMgbm90IGZvdW5kXHJcbiAgICB9XHJcbiAgICBjb25zdCBydWxlRnVuY3Rpb25Db25maWcgPSBydWxlRnVuY3Rpb25zW2Z1bmN0aW9uSW5kZXhdO1xyXG4gICAgdG9vbHMuc2V0Q3VycmVudENvbnRlbnQoZnJvbnRNYXR0ZXJbcnVsZS5wcm9wZXJ0eV0pXHJcbiAgICB0b29scy5zZXRSdWxlKHJ1bGUpO1xyXG4gICAgdG9vbHMuc2V0RnJvbnRtYXR0ZXIoZnJvbnRNYXR0ZXIpO1xyXG4gICAgc3dpdGNoIChydWxlRnVuY3Rpb25Db25maWcucnVsZVR5cGUpIHtcclxuICAgICAgY2FzZSAnc2NyaXB0JzogXHJcbiAgICAgICAgY29uc3QgY3VzdG9tUnVsZUZ1bmN0aW9uID0gcGFyc2VKU0NvZGUocnVsZS5qc0NvZGUpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgY3VzdG9tUnVsZUZ1bmN0aW9uICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICBsb2dnZXIubG9nKEVSUk9SLGBDb3VsZCBub3QgcGFyc2UgY3VzdG9tIGZ1bmN0aW9uIGZvciAke3J1bGUuY29udGVudH0hYCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ4UmVzdWx0ID0gYXBwbHlGb3JtYXRPcHRpb25zKGN1c3RvbVJ1bGVGdW5jdGlvbihhcHAsIGN1cnJlbnRGaWxlLCB0b29scyksIHJ1bGUpO1xyXG4gICAgICAgIGlmIChvbGRGaWxlKSB7XHJcbiAgICAgICAgICBvbGRSZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMoY3VzdG9tUnVsZUZ1bmN0aW9uKGFwcCwgb2xkRmlsZSwgdG9vbHMpLCBydWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2J1aWxkSW4uaW5wdXRQcm9wZXJ0eSc6XHJcbiAgICAgIGNhc2UgJ2J1aWxkSW4nOiAgXHJcbiAgICAgICAgY29uc3QgcnVsZUZ1bmN0aW9uID0gcnVsZS51c2VDdXN0b21Db2RlID8gcGFyc2VKU0NvZGUocnVsZS5idWlsZEluQ29kZSkgOiBydWxlRnVuY3Rpb25Db25maWcuZng7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBydWxlRnVuY3Rpb24gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYENvdWxkIG5vdCBwYXJzZSBjdXN0b20gZnVuY3Rpb24gZm9yICR7cnVsZS5jb250ZW50fSFgKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmeFJlc3VsdCA9IGdldFJ1bGVSZXN1bHQocnVsZUZ1bmN0aW9uLCBhcHAsIHJ1bGUsIHJ1bGVGdW5jdGlvbkNvbmZpZywgY3VycmVudEZpbGUsIHRvb2xzLCBmcm9udE1hdHRlcik7XHJcbiAgICAgICAgaWYgKG9sZEZpbGUpIHtcclxuICAgICAgICAgICAgb2xkUmVzdWx0ID0gZ2V0UnVsZVJlc3VsdChydWxlRnVuY3Rpb24sIGFwcCwgcnVsZSwgcnVsZUZ1bmN0aW9uQ29uZmlnLCBvbGRGaWxlLCB0b29scywgZnJvbnRNYXR0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsb2dnZXIubG9nKERFQlVHLGAgIGV4ZWN1dGVSdWxlOiAke3J1bGUuY29udGVudH0gJHtydWxlLnByb3BlcnR5fSBbJHtydWxlLnR5cGV9XT0gJyR7ZnhSZXN1bHR9J2ApXHJcblxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdhdXRvY29tcGxldGUubW9kYWwnOlxyXG4gICAgICAgIGZ4UmVzdWx0ID0gZ2V0UnVsZVJlc3VsdChydWxlRnVuY3Rpb25Db25maWcuZngsIGFwcCwgcnVsZSwgcnVsZUZ1bmN0aW9uQ29uZmlnLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyKTtcclxuICAgICAgICBicmVhazsgLy8gaGFuZGxlZCBpbiB0aGUgYXV0b2NvbXBsZXRlIG1vZGFsXHJcbiAgICAgIGNhc2UgJ2F1dG9tYXRpb24nOlxyXG4gICAgICAgIC8vIGZ4UmVzdWx0ID0gZ2V0UnVsZVJlc3VsdChydWxlRnVuY3Rpb25Db25maWcuZngsIGFwcCwgcnVsZSwgcnVsZUZ1bmN0aW9uQ29uZmlnLCBjdXJyZW50RmlsZSwgdG9vbHMsIGZyb250TWF0dGVyKTtcclxuICAgICAgICBmeFJlc3VsdCA9IHJ1bGVzTWFuYWdlci5leGVjdXRlUnVsZUJ5SWQocnVsZS5jb250ZW50LCBhcHAsIGN1cnJlbnRGaWxlLCB0b29scywgZnJvbnRNYXR0ZXIpOyAvLyBleGVjdXRlIHRoZSBmb3JtYXR0ZXIgcnVsZVxyXG5cclxuICAgICAgICBicmVhazsgLy8gaGFuZGxlZCBpbiB0aGUgYXV0b21hdGlvbiBtb2RhbFxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGxvZ2dlci5sb2coRVJST1IsYEVycm9yIGV4ZWN1dGluZyBydWxlICR7cnVsZS5wcm9wZXJ0eX18JHtydWxlLmNvbnRlbnR9IGZvciBmaWxlICR7Y3VycmVudEZpbGUucGF0aH06ICR7ZXJyb3J9YCk7XHJcbiAgICByZXR1cm4gcmV0dXJuUmVzdWx0OyAvLyByZXR1cm4gdGhlIG9yaWdpbmFsIHZhbHVlIGlmIHRoZXJlIGlzIGFuIGVycm9yXHJcbiAgfVxyXG5cclxuICBpZiAocnVsZS50eXBlID09PSAnbnVtYmVyJyB8fCBydWxlLnR5cGUgPT09ICdjaGVja2JveCcgfHwgcnVsZS50eXBlID09PSAnZGF0ZScgfHwgcnVsZS50eXBlID09PSAnZGF0ZXRpbWUnKSB7XHJcbiAgICAgIHJldHVybiBmeFJlc3VsdDtcclxuICB9XHJcbiAgc3dpdGNoIChydWxlLmFkZENvbnRlbnQpIHtcclxuICAgICAgY2FzZSAnb3ZlcndyaXRlJzpcclxuICAgICAgICAgIHJldHVyblJlc3VsdCA9IGZ4UmVzdWx0OyAvLyB1cGRhdGUgb3IgYWRkIHRoZSBuZXcgdmFsdWVcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdlbmQnOlxyXG4gICAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgICBpZiAoIWZ4UmVzdWx0KSBmeFJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZnhSZXN1bHQgPT09ICdzdHJpbmcnKSBmeFJlc3VsdCA9IFtmeFJlc3VsdF07IC8vIGNvbnZlcnQgc3RyaW5nIHRvIGFycmF5IFxyXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXR1cm5SZXN1bHQpKSByZXR1cm5SZXN1bHQgPSBbcmV0dXJuUmVzdWx0XTtcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2xkUmVzdWx0KSkgb2xkUmVzdWx0ID0gW29sZFJlc3VsdF07XHJcbiAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gcmV0dXJuUmVzdWx0LmZpbHRlcigodmFsdWUpID0+ICFvbGRSZXN1bHQuaW5jbHVkZXModmFsdWUpKVxyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MoZmlsdGVyZWQuY29uY2F0KGZ4UmVzdWx0KSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICghcmV0dXJuUmVzdWx0KSByZXR1cm5SZXN1bHQgPSAnJztcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSByZXR1cm5SZXN1bHQucmVwbGFjZUFsbChyZXR1cm5SZXN1bHQsb2xkUmVzdWx0KTtcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSByZXR1cm5SZXN1bHQgKyBmeFJlc3VsdDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzdGFydCc6XHJcbiAgICAgICAgICBpZiAocnVsZS50eXBlID09PSAnbXVsdGl0ZXh0JyB8fCBydWxlLnR5cGUgPT09ICd0YWdzJyB8fCBydWxlLnR5cGUgPT09ICdhbGlhc2VzJykge1xyXG4gICAgICAgICAgICAgIGlmICghZnhSZXN1bHQpIGZ4UmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmeFJlc3VsdCA9PT0gJ3N0cmluZycpIGZ4UmVzdWx0ID0gW2Z4UmVzdWx0XTsgLy8gY29udmVydCBzdHJpbmcgdG8gYXJyYXkgXHJcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJldHVyblJlc3VsdCkpIHJldHVyblJlc3VsdCA9IFtyZXR1cm5SZXN1bHRdO1xyXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShvbGRSZXN1bHQpKSBvbGRSZXN1bHQgPSBbb2xkUmVzdWx0XTtcclxuICAgICAgICAgICAgICBsZXQgZmlsdGVyZWQgPSByZXR1cm5SZXN1bHQuZmlsdGVyKCh2YWx1ZSkgPT4gIW9sZFJlc3VsdC5pbmNsdWRlcyh2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gdG9vbHMucmVtb3ZlRHVwbGljYXRlU3RyaW5ncyhmeFJlc3VsdC5jb25jYXQoZmlsdGVyZWQpKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFyZXR1cm5SZXN1bHQpIHJldHVyblJlc3VsdCA9ICcnO1xyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHJldHVyblJlc3VsdC5yZXBsYWNlQWxsKHJldHVyblJlc3VsdCxvbGRSZXN1bHQpO1xyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IGZ4UmVzdWx0ICsgcmV0dXJuUmVzdWx0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgfVxyXG4gIHJldHVybiByZXR1cm5SZXN1bHQ7XHJcblxyXG59XHJcbiovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVSdWxlT2JqZWN0IChhcHA6IEFwcCwgc2V0dGluZ3M6IGFueSwgY3VycmVudEZpbGU6IFRGaWxlLCByZXR1cm5SZXN1bHQ6IGFueSwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCBmcm9udE1hdHRlcjogYW55KSB7XHJcbn1cclxuLypcclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVJ1bGUgKGFwcCwgc2V0dGluZ3MsIGN1cnJlbnRGaWxlOiBURmlsZSwgcmV0dXJuUmVzdWx0OiBhbnksIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgZnJvbnRNYXR0ZXIpIHtcclxuICBjb25zdCB0b29scyA9IG5ldyBTY3JpcHRpbmdUb29scyhhcHAsIHNldHRpbmdzLCBmcm9udE1hdHRlcik7XHJcbiAgbGV0IGZ4UmVzdWx0OmFueTtcclxuICBpZiAocnVsZS5jb250ZW50ID09PSAnc2NyaXB0Jykge1xyXG4gICAgICBjb25zdCBydWxlRnVuY3Rpb24gPSBwYXJzZUpTQ29kZShydWxlLmpzQ29kZSk7XHJcbiAgICAgIGlmICh0eXBlb2YgcnVsZUZ1bmN0aW9uICE9PSAnZnVuY3Rpb24nKSByZXR1cm47XHJcbiAgICAgIGZ4UmVzdWx0ID0gcnVsZUZ1bmN0aW9uKGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBmdW5jdGlvbkluZGV4ID0gcnVsZUZ1bmN0aW9ucy5maW5kSW5kZXgoZnggPT4gZnguaWQgPT09IHJ1bGUuY29udGVudCk7XHJcbiAgICAgIGlmIChmdW5jdGlvbkluZGV4IT09LTEpe1xyXG4gICAgICAgICAgY29uc3QgcnVsZUZ1bmN0aW9uID0gcnVsZS51c2VDdXN0b21Db2RlID8gcGFyc2VKU0NvZGUocnVsZS5idWlsZEluQ29kZSkgOiBydWxlRnVuY3Rpb25zW2Z1bmN0aW9uSW5kZXhdLmZ4O1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiBydWxlRnVuY3Rpb24gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgQ291bGQgbm90IHBhcnNlIGN1c3RvbSBmdW5jdGlvbiBmb3IgJHtydWxlLmNvbnRlbnR9IWApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAocnVsZUZ1bmN0aW9uc1tmdW5jdGlvbkluZGV4XS5pbnB1dFByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIGZ4UmVzdWx0ID0gYXBwbHlGb3JtYXRPcHRpb25zKHJ1bGVGdW5jdGlvbihhcHAsIGN1cnJlbnRGaWxlLCB0b29scywgZnJvbnRNYXR0ZXJbcnVsZS5pbnB1dFByb3BlcnR5XSksIHJ1bGUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZnhSZXN1bHQgPSBhcHBseUZvcm1hdE9wdGlvbnMocnVsZUZ1bmN0aW9uKGFwcCwgY3VycmVudEZpbGUsIHRvb2xzKSwgcnVsZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH1cclxuICB9XHJcbiAgc3dpdGNoIChydWxlLmFkZENvbnRlbnQpIHtcclxuICAgICAgY2FzZSAnb3ZlcndyaXRlJzpcclxuICAgICAgICAgIHJldHVyblJlc3VsdCA9IGZ4UmVzdWx0OyAvLyB1cGRhdGUgb3IgYWRkIHRoZSBuZXcgdmFsdWVcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdlbmQnOlxyXG4gICAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gJ211bHRpdGV4dCcgfHwgcnVsZS50eXBlID09PSAndGFncycgfHwgcnVsZS50eXBlID09PSAnYWxpYXNlcycpIHtcclxuICAgICAgICAgICAgICBpZiAoIWZ4UmVzdWx0KSBmeFJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZnhSZXN1bHQgPT09ICdzdHJpbmcnKSBmeFJlc3VsdCA9IFtmeFJlc3VsdF07IC8vIGNvbnZlcnQgc3RyaW5nIHRvIGFycmF5IFxyXG4gICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXR1cm5SZXN1bHQpKSByZXR1cm5SZXN1bHQgPSBbcmV0dXJuUmVzdWx0XTtcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZnhSZXN1bHQpKSBmeFJlc3VsdCA9IFtmeFJlc3VsdF07XHJcbiAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gcmV0dXJuUmVzdWx0LmZpbHRlcigodmFsdWUpID0+ICFmeFJlc3VsdC5pbmNsdWRlcyh2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gdG9vbHMucmVtb3ZlRHVwbGljYXRlU3RyaW5ncyhmaWx0ZXJlZCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICghcmV0dXJuUmVzdWx0KSByZXR1cm5SZXN1bHQgPSAnJztcclxuICAgICAgICAgICAgICByZXR1cm5SZXN1bHQgPSByZXR1cm5SZXN1bHQucmVwbGFjZUFsbChyZXR1cm5SZXN1bHQsZnhSZXN1bHQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3N0YXJ0JzpcclxuICAgICAgICAgIGlmIChydWxlLnR5cGUgPT09ICdtdWx0aXRleHQnIHx8IHJ1bGUudHlwZSA9PT0gJ3RhZ3MnIHx8IHJ1bGUudHlwZSA9PT0gJ2FsaWFzZXMnKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFmeFJlc3VsdCkgZnhSZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgICBpZiAodHlwZW9mIGZ4UmVzdWx0ID09PSAnc3RyaW5nJykgZnhSZXN1bHQgPSBbZnhSZXN1bHRdOyAvLyBjb252ZXJ0IHN0cmluZyB0byBhcnJheSBcclxuICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmV0dXJuUmVzdWx0KSkgcmV0dXJuUmVzdWx0ID0gW3JldHVyblJlc3VsdF07XHJcbiAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGZ4UmVzdWx0KSkgZnhSZXN1bHQgPSBbZnhSZXN1bHRdO1xyXG4gICAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IHJldHVyblJlc3VsdC5maWx0ZXIoKHZhbHVlKSA9PiAhZnhSZXN1bHQuaW5jbHVkZXModmFsdWUpKVxyXG4gICAgICAgICAgICAgIHJldHVyblJlc3VsdCA9IHRvb2xzLnJlbW92ZUR1cGxpY2F0ZVN0cmluZ3MoZmlsdGVyZWQpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoIXJldHVyblJlc3VsdCkgcmV0dXJuUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0ID0gcmV0dXJuUmVzdWx0LnJlcGxhY2VBbGwocmV0dXJuUmVzdWx0LGZ4UmVzdWx0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gIH1cclxuICByZXR1cm4gcmV0dXJuUmVzdWx0O1xyXG5cclxufVxyXG4qL1xyXG4vKipcclxuICogRmlsdGVycyBhIGdpdmVuIGZpbGUgYW5kIHJldHVybnMgdHJ1ZSBpZiBpdCBpcyBpbmNsdWRlZCBpbiBhIGZvbGRlciBvciBmaWxlIGxpc3RcclxuICogQHBhcmFtIGZpbGUgXHJcbiAqIEBwYXJhbSBmaWx0ZXJNb2RlICdleGNsdWRlJ3wnaW5jbHVkZSdcclxuICogQHBhcmFtIHR5cGUgJ2ZvbGRlcnMnfCdmaWxlcydcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyRmlsZShmaWxlOiBURmlsZSwgZmlsZUxpc3Q6IGFueSwgZmlsdGVyTW9kZTogc3RyaW5nLCB0eXBlOnN0cmluZyk6Ym9vbGVhbiB7XHJcbiAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICBjb25zdCBmaWx0ZXJBcnJheSA9ICh0eXBlPT09J2ZvbGRlcnMnKSA/IGZpbGVMaXN0W2ZpbHRlck1vZGVdLnNlbGVjdGVkRm9sZGVycyA6IGZpbGVMaXN0W2ZpbHRlck1vZGVdLnNlbGVjdGVkRmlsZXM7XHJcbiAgICBpZiAoZmlsdGVyQXJyYXkubGVuZ3RoID09PSAwKSByZXR1cm4gKGZpbHRlck1vZGUgPT09ICdpbmNsdWRlJyk/IGZhbHNlIDogdHJ1ZTtcclxuICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgY29uc3QgZmlsZUZvbGRlciA9IGdldEZvbGRlckZyb21QYXRoKGZpbGUucGF0aCk7IC8vIHRoaXMudG9vbHMuYWRkTGVhZGluZ1NsYXNoKGdldEZvbGRlckZyb21QYXRoKGZpbGUucGF0aCkpO1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lICsgJy4nICsgZmlsZS5leHRlbnNpb247XHJcbiAgICBcclxuICAgIGlmICh0eXBlID09PSAnZmlsZXMnKSB7XHJcbiAgICAgICAgcmVzdWx0ID0gZmlsdGVyQXJyYXkuaW5jbHVkZXMoZmlsZVBhdGgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGUgPT09ICdmb2xkZXJzJykge1xyXG4gICAgICAgIGZvciAobGV0IHBhdGggb2YgZmlsdGVyQXJyYXkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gZmlsZUZvbGRlcj8uc3RhcnRzV2l0aChwYXRoLnNsaWNlKDEpKSB8fCBmYWxzZTsgLy8gcmVtb3ZlIHJvb3QgJy8nXHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHRydWUpIHJldHVybiAoZmlsdGVyTW9kZSA9PT0gJ2V4Y2x1ZGUnKT8gIXJlc3VsdCA6IHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiAoZmlsdGVyTW9kZSA9PT0gJ2V4Y2x1ZGUnKT8gIXJlc3VsdCA6IHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSWZGaWxlQWxsb3dlZChmaWxlOiBURmlsZSwgc2V0dGluZ3M/OkZyb250bWF0dGVyQXV0b21hdGVTZXR0aW5ncywgcnVsZT86RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyk6Ym9vbGVhbiB7XHJcbiAgICAgIGxldCByZXN1bHQgPSB0cnVlO1xyXG4gICAgICBpZiAoIWZpbGUpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKHNldHRpbmdzKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vbG9nZ2VyLmxvZyhERUJVRyxgY2hlY2sgZmlsZSAke2ZpbGUucGF0aH0gYWdhaW5zdCBzZXR0aW5nc2AsIHNldHRpbmdzLmluY2x1ZGUsIHNldHRpbmdzLmV4Y2x1ZGUpO1xyXG4gICAgICAgICAgaWYgKHNldHRpbmdzLmV4Y2x1ZGUuc2VsZWN0ZWRGaWxlcy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZmlsZXMgaW4gdGhlIGV4Y2x1ZGUgZmlsZXMgbGlzdC5cclxuICAgICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJGaWxlKGZpbGUsIHNldHRpbmdzLCAnZXhjbHVkZScsICdmaWxlcycpOyAgICBcclxuICAgICAgICAgIH0gICAgICAgIFxyXG4gICAgICAgICAgaWYgKHJlc3VsdCAmJiBzZXR0aW5ncy5leGNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGg+MCkgeyAvLyB0aGVyZSBhcmUgZm9sZGVycyBpbiB0aGUgZXhjbHVkZSBmb2xkZXJzIGxpc3QuXHJcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZmlsdGVyRmlsZShmaWxlLCBzZXR0aW5ncywgJ2V4Y2x1ZGUnLCAnZm9sZGVycycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKCFyZXN1bHQgJiYgc2V0dGluZ3MuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgaW5jbHVkZSBmaWxlcyBsaXN0XHJcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZmlsdGVyRmlsZShmaWxlLCBzZXR0aW5ncywgJ2luY2x1ZGUnLCAnZmlsZXMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghcmVzdWx0ICYmIHNldHRpbmdzLmluY2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmb2xkZXJzIGluIHRoZSBpbmNsdWRlIGZvbGRlcnMgbGlzdFxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgc2V0dGluZ3MsICdpbmNsdWRlJywgJ2ZvbGRlcnMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7IC8vIGlmIHRoZSBmaWxlIGlzIGV4Y2x1ZGVkLCByZXR1cm4gZmFsc2VcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgRXJyb3IgZmlsdGVyaW5nIGZpbGUgJHtmaWxlLnBhdGh9IGdsb2JhbGx5OiAke2Vycm9yfWApO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBkZWZhdWx0IHRvIGZhbHNlIGlmIHRoZXJlIGlzIGFuIGVycm9yXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKHJ1bGUpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy9sb2dnZXIubG9nKERFQlVHLGBjaGVjayBmaWxlICR7ZmlsZS5wYXRofSBhZ2FpbnN0IHJ1bGVgLCBydWxlLmluY2x1ZGUsIHJ1bGUuZXhjbHVkZSk7XHJcbiAgICAgICAgICBpZiAocmVzdWx0ICYmIHJ1bGUuZXhjbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgZXhjbHVkZSBmaWxlcyBsaXN0LlxyXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZpbHRlckZpbGUoZmlsZSwgcnVsZSwgJ2V4Y2x1ZGUnLCAnZmlsZXMnKTtcclxuICAgICAgICAgIH0gICAgICAgIFxyXG4gICAgICAgICAgaWYgKHJlc3VsdCAmJiBydWxlLmV4Y2x1ZGUuc2VsZWN0ZWRGb2xkZXJzLmxlbmd0aD4wKSB7IC8vIHRoZXJlIGFyZSBmb2xkZXJzIGluIHRoZSBpbmNsdWRlIGZvbGRlcnMgbGlzdC5cclxuICAgICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJGaWxlKGZpbGUsIHJ1bGUsICdleGNsdWRlJywgJ2ZvbGRlcnMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghcmVzdWx0ICYmIHJ1bGUuaW5jbHVkZS5zZWxlY3RlZEZpbGVzLmxlbmd0aD4wKSB7IC8vIGZpbGUgaXMgZXhjbHVkZWQgYnV0IHRoZXJlIGFyZSBmaWxlcyBpbiB0aGUgaW5jbHVkZSBmaWxlcyBsaXN0XHJcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZmlsdGVyRmlsZShmaWxlLCBydWxlLCAnaW5jbHVkZScsICdmaWxlcycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKCFyZXN1bHQgJiYgcnVsZS5pbmNsdWRlLnNlbGVjdGVkRm9sZGVycy5sZW5ndGg+MCkgeyAvLyBmaWxlIGlzIGV4Y2x1ZGVkIGJ1dCB0aGVyZSBhcmUgZm9sZGVycyBpbiB0aGUgaW5jbHVkZSBmb2xkZXJzIGxpc3RcclxuICAgICAgICAgICAgICByZXN1bHQgPSBmaWx0ZXJGaWxlKGZpbGUsIHJ1bGUsICdpbmNsdWRlJywgJ2ZvbGRlcnMnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgRXJyb3IgZmlsdGVyaW5nIGZpbGUgJHtmaWxlLnBhdGh9IGJ5IHJ1bGUgJHtydWxlLnByb3BlcnR5fXwke3J1bGUuY29udGVudH06ICR7ZXJyb3J9YCk7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGRlZmF1bHQgdG8gZmFsc2UgaWYgdGhlcmUgaXMgYW4gZXJyb3JcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVmYXVsdENvbmZpZ0VsZW1lbnRzKG1vZGlmaWVyczpDb25maWdFbGVtZW50cyB8IGFueSk6Q29uZmlnRWxlbWVudHMge1xyXG4gIGNvbnN0IGNvbmZpZ0VsZW1lbnRzOiBDb25maWdFbGVtZW50cyA9IHtcclxuICAgIHJlbW92ZUNvbnRlbnQ6IHRydWUsXHJcbiAgICBydWxlQWN0aXZlOiB0cnVlLFxyXG4gICAgbW9kaWZ5T25seTogdHJ1ZSxcclxuICAgIGlucHV0UHJvcGVydHk6IGZhbHNlLFxyXG4gICAgYWRkUHJlZml4OiB0cnVlLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogdHJ1ZSxcclxuICAgIHNwZWNpYWxDaGFyYWN0ZXJSZXBsYWNlbWVudDogdHJ1ZSxcclxuICAgIGNvbnZlcnRUb0xvd2VyQ2FzZTogdHJ1ZSxcclxuICAgIHJlc3VsdEFzTGluazogdHJ1ZSxcclxuICAgIGFkZENvbnRlbnQ6IHRydWUsXHJcbiAgICBleGNsdWRlRm9sZGVyczogdHJ1ZSxcclxuICAgIGluY2x1ZGVGb2xkZXJzOiB0cnVlLCBcclxuICAgIHNjcmlwdDogdHJ1ZSxcclxuICB9XHJcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZ0VsZW1lbnRzLCBtb2RpZmllcnMpO1xyXG59XHJcblxyXG4vKipcclxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIGEgc3BlY2lmaWMgb3B0aW9uIGlzIGVuYWJsZWQgZm9yIGEgZ2l2ZW4gcnVsZSBmdW5jdGlvbi5cclxuICpcclxuICogQHBhcmFtIHJ1bGVGbiAtIFRoZSBydWxlIGZ1bmN0aW9uIG9iamVjdCwgd2hpY2ggbWF5IGJlIHVuZGVmaW5lZC4gSWYgZGVmaW5lZCwgaXQgc2hvdWxkIGNvbnRhaW4gYSBgY29uZmlnRWxlbWVudHNgIHByb3BlcnR5LlxyXG4gKiBAcGFyYW0gb3B0aW9uIC0gVGhlIG5hbWUgb2YgdGhlIG9wdGlvbiB0byBjaGVjayB3aXRoaW4gdGhlIGBjb25maWdFbGVtZW50c2Agb2YgdGhlIHJ1bGUgZnVuY3Rpb24uXHJcbiAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIHVuZGVmaW5lZCBpbiB0aGUgYGNvbmZpZ0VsZW1lbnRzYCBvciBpZiB0aGUgb3B0aW9uIGlzIGV4cGxpY2l0bHkgc2V0IHRvIGB0cnVlYC5cclxuICogICAgICAgICAgUmV0dXJucyBgZmFsc2VgIGlmIHRoZSBvcHRpb24gaXMgZXhwbGljaXRseSBzZXQgdG8gYGZhbHNlYC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VSdWxlT3B0aW9uKHJ1bGVGbiA6IFJ1bGVGdW5jdGlvbiB8IHVuZGVmaW5lZCwgb3B0aW9uIDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgaWYgKHJ1bGVGbj8uY29uZmlnRWxlbWVudHNbb3B0aW9uXSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdHJ1ZTtcclxuICByZXR1cm4gcnVsZUZuLmNvbmZpZ0VsZW1lbnRzW29wdGlvbl07XHJcbn1cclxuLyoqXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZGVmYXVsdCcsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdQYXNzIHBhcmFtZXRlcicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDogZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9ICcnO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcbiovXHJcbi8qXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgaWQ6J2NvbnN0YW50JyxcclxuICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gIGRlc2NyaXB0aW9uOiAnQ29uc3RhbnQgdmFsdWUnLFxyXG4gIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICB0eXBlOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywnbXVsdGl0ZXh0J10sXHJcbiAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7XHJcbiAgICBhZGRQcmVmaXg6IGZhbHNlLFxyXG4gICAgc3BhY2VSZXBsYWNlbWVudDogZmFsc2UsXHJcbiAgICBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IGZhbHNlLFxyXG4gICAgY29udmVydFRvTG93ZXJDYXNlOiBmYWxzZSxcclxuICAgIHJlc3VsdEFzTGluazogZmFsc2UsfSksXHJcbiAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCdjb25zdGFudFZhbHVlJyk7XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfSxcclxuICBjb25maWdUYWI6IGZ1bmN0aW9uIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6Rm9sZGVyVGFnUnVsZURlZmluaXRpb24sIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuXHJcbiAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgY29uc3RhbnRWYWx1ZTogJycsXHJcbiAgICB9KVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgLnNldE5hbWUoJ0NvbnN0YW50IHZhbHVlJylcclxuICAgIC5zZXREZXNjKCdFbnRlciBhIGNvbnN0YW50IHZhbHVlIHRvIGJlIHVzZWQgaW4gdGhlIHJ1bGUnKVxyXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdjb25zdGFudFZhbHVlJykgfHwgJycpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnY29uc3RhbnRWYWx1ZScsIHZhbHVlKTtcclxuICAgICAgICAgIHRoYXQudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICB9KSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgaWQ6J2Z1bGxQYXRoJyxcclxuICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gIGRlc2NyaXB0aW9uOiAnRnVsbCBwYXRoLCBmaWxlbmFtZScsXHJcbiAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICAgIHJlc3VsdCA9IHJlc3VsdCArIHBhcnRzLmpvaW4oJy8nKTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCdtdWx0aXRleHQnXSxcclxuICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgIHBhcnRzLnBvcCgpO1xyXG4gICAgICBwYXJ0cy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xyXG4gICAgICByZXR1cm4gcGFydHMuam9pbignLycpO1xyXG4gIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2Z1bGxQYXRoRXh0JyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgcGF0aCwgZmlsZW5hbWUgYW5kIEV4dGVuc2lvbicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5wYXRoO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICB0eXBlOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OiBmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICAgICAgcmV0dXJuIGAke2ZpbGUucGF0aH1gO1xyXG4gICAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J3BhdGgnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnRnVsbCBQYXRoJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2xpbmtUb0ZpbGUnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnTGluayB0byBmaWxlJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCdtdWx0aXRleHQnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe3Jlc3VsdEFzTGluazogZmFsc2V9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHA6IEFwcCwgZmlsZTpURmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpe1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcclxuICAgICAgICBpZiAoIXJ1bGUpIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpO1xyXG4gICAgICAgIGNvbnN0IGFkZEV4dGVuc2lvbiA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdhZGRFeHRlbnNpb24nKSBcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTFdID09PSBmaWxlLmJhc2VuYW1lKSBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBsZXQgZmlsZU5hbWUgPSBhZGRFeHRlbnNpb24/IGZpbGUuYmFzZW5hbWUgKyAnLicgKyBmaWxlLmV4dGVuc2lvbiA6IGZpbGUuYmFzZW5hbWU7IFxyXG4gICAgICAgIHJldHVybiBgW1ske3BhcnRzLmpvaW4oJy8nKX0vJHtmaWxlTmFtZX18JHtmaWxlLmJhc2VuYW1lfV1dYDtcclxuICAgIH0sXHJcbiAgICBjb25maWdUYWI6IGZ1bmN0aW9uIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG5cclxuICAgICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgYWRkRXh0ZW5zaW9uOiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgXHJcbiAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIGZpbGUgZXh0ZW5zaW9uJylcclxuICAgICAgICAuc2V0RGVzYygnQWRkIGZpbGUgZXh0ZW5zaW9uIHRvIHBhdGhuYW1lJylcclxuICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdhZGRFeHRlbnNpb24nKSB8fCBmYWxzZSlcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnYWRkRXh0ZW5zaW9uJywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9ICBcclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J3BhdGhGb2xkZXJOb3RlcycsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdQYXRoIChmb2xkZXIgbm90ZXMpJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCdtdWx0aXRleHQnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBwYXJlbnQgZm9sZGVyIGlmIHNhbWUgbmFtZSBhcyB0aGUgZmlsZVxyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICBpZDonZnVsbFBhdGhGb2xkZXJOb3RlcycsXHJcbiAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICBkZXNjcmlwdGlvbjogJ0Z1bGwgUGF0aCAoY29tcGx5IHdpdGggXCJmb2xkZXIgbm90ZXNcIiknLFxyXG4gIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxcbiAgICByZXN1bHQgPSByZXN1bHQgKyBwYXJ0cy5qb2luKCcvJyk7XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICB0eXBlOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJ10sXHJcbiAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxyXG4gICAgICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTFdID09PSBmaWxlLmJhc2VuYW1lKSBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIHBhcmVudCBmb2xkZXIgaWYgc2FtZSBuYW1lIGFzIHRoZSBmaWxlXHJcbiAgICAgIHBhcnRzLnB1c2goZmlsZS5iYXNlbmFtZSk7IC8vIGFkZCB0aGUgZmlsZSBuYW1lIGJhY2tcclxuICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmdWxsUGF0aEV4dEZvbGRlck5vdGVzJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgUGF0aCB3aXRoIEV4dGVuc2lvbiAoY29tcGx5IHdpdGggXCJmb2xkZXIgbm90ZXNcIiknLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XFxuICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICAgIHJlc3VsdCA9IHJlc3VsdCArIHBhcnRzLmpvaW4oJy8nKTtcXG4gIH1cXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxyXG4gICAgICAgIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gPT09IGZpbGUuYmFzZW5hbWUpIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgcGFyZW50IGZvbGRlciBpZiBzYW1lIG5hbWUgYXMgdGhlIGZpbGVcclxuICAgICAgICBwYXJ0cy5wdXNoKGZpbGUubmFtZSk7IC8vIGFkZCB0aGUgZmlsZSBuYW1lIGJhY2tcclxuICAgICAgICByZXR1cm4gcGFydHMuam9pbignLycpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonaXNSb290JyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgaW4gUm9vdCBmb2xkZXInLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xcbn1cIixcclxuICAgIHR5cGU6IFsnY2hlY2tib3gnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scyl7XHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmxlbmd0aCA9PT0gMTtcclxuICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2ZvbGRlcicsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdQYXJlbnQgRm9sZGVyJyxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xcbiAgICByZXN1bHQgPSBwYXJ0c1twYXJ0cy5sZW5ndGgtMl07XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICd0YWdzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHBhcnRzW3BhcnRzLmxlbmd0aC0yXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZm9sZGVyRm9sZGVyTm90ZXMnLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnUGFyZW50IEZvbGRlciAoY29tcGxpZXMgd2l0aCBcImZvbGRlciBub3Rlc1wiKScsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IGluZGV4ID0gcGFydHMubGVuZ3RoLTI7IC8vIGluZGV4IG9mIHBhcmVudCBmb2xkZXJcXG4gIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMl09PT1maWxlLmJhc2VuYW1lKSB7XFxuICAgICAgaW5kZXgtLTsgLy8gZm9sZGVyIG5vdGUgcGFyZW50IGlzIHRoZSBjaGlsZFxcbiAgfVxcbiAgaWYgKGluZGV4ID49IDApIHtcXG4gICAgcmV0dXJuIHBhcnRzW2luZGV4XTsgLy8gZmlsZSBpbiBmb2xkZXJcXG4gIH0gZWxzZSB7XFxuICAgIHJldHVybiB0b29scy5hcHA/LnZhdWx0Py5nZXROYW1lKCkgfHwgJ1ZhdWx0JzsgLy8gZmlsZSBpbiByb290ID0gdmF1bHRcXG4gIH1cXG59XCIsXHJcbiAgICB0eXBlOiBbJ3RleHQnLCAndGFncyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgbGV0IGluZGV4ID0gcGFydHMubGVuZ3RoLTI7IC8vIGluZGV4IG9mIHBhcmVudCBmb2xkZXJcclxuICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0yXT09PWZpbGUuYmFzZW5hbWUpIHtcclxuICAgICAgICAgIGluZGV4LS07IC8vIGZvbGRlciBub3RlIHBhcmVudCBpcyB0aGUgY2hpbGRcclxuICAgICAgfVxyXG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgIHJldHVybiBwYXJ0c1tpbmRleF07IC8vIGZpbGUgaW4gZm9sZGVyXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRvb2xzLmFwcD8udmF1bHQ/LmdldE5hbWUoKSB8fCAnVmF1bHQnOyAvLyBmaWxlIGluIHJvb3QgPSB2YXVsdFxyXG4gICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmb2xkZXJzJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0FsbCBmb2xkZXJzIG9mIHRoZSBmaWxlIGFzIGEgbGlzdCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoOyAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcmVzdWx0ID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgcmVzdWx0LnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsnbXVsdGl0ZXh0JywndGFncycsJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDoncm9vdEZvbGRlcicsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdSb290IGZvbGRlcicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcXG4gICAgcmVzdWx0ID0gcGFydHNbMF07XFxuICB9XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCcsICdtdWx0aXRleHQnLCAndGFncycsICdhbGlhc2VzJ10sXHJcbiAgICBjb25maWdFbGVtZW50czogZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KSxcclxuICAgIGZ4OmZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHBhcnRzWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOiduYW1lJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0ZpbGUgbmFtZSB3aXRob3V0IGV4dGVuc2lvbicsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XFxuICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBleHRlbnNpb25cXG4gIHJlc3VsdC5qb2luKCcuJyk7IC8vIHJlY29uc3RydWN0IHRoZSBmaWxlIG5hbWVcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ211bHRpdGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICByZXN1bHQucG9wKCk7IC8vIHJlbW92ZSBleHRlbnNpb25cclxuICAgICAgICByZXN1bHQuam9pbignLicpOyAvLyByZWNvbnN0cnVjdCB0aGUgZmlsZSBuYW1lXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonbmFtZUV4dCcsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIG5hbWUgd2l0aCBleHRlbnNpb24nLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUubmFtZTtcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiLFxyXG4gICAgdHlwZTogWyd0ZXh0JywgJ211bHRpdGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHM6U2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWU7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZ2V0UHJvcGVydHknLFxyXG4gICAgcnVsZVR5cGU6ICdidWlsZEluLmlucHV0UHJvcGVydHknLFxyXG4gICAgZGVzY3JpcHRpb246ICdHZXQgYSBwcm9wZXJ0eScsXHJcbiAgICBpc0xpdmVSdWxlOiB0cnVlLFxyXG4gICAgaW5wdXRQcm9wZXJ0eTogdHJ1ZSxcclxuICAgIHNvdXJjZTogXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHJlc3VsdCA9IGlucHV0O1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCIsXHJcbiAgICB0eXBlOiBbJ3RleHQnLCAnbXVsdGl0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcyddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7aW5wdXRQcm9wZXJ0eTp0cnVlfSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scywgaW5wdXQ/KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGlucHV0O1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH1cclxufSk7XHJcblxyXG5ydWxlRnVuY3Rpb25zLnB1c2goe1xyXG4gICAgaWQ6J2RhdGVUaW1lQ3JlYXRlZCcsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdEYXRlIChhbmQgVGltZSkgY3JlYXRlZCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCB0aW1lT2Zmc2V0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMDsgLy8gZ2V0IGxvY2FsIHRpbWUgb2Zmc2V0XFxuICBjb25zdCByZXN1bHQgPSBuZXcgRGF0ZShmaWxlLnN0YXQuY3RpbWUtdGltZU9mZnNldCk7XFxuICByZXR1cm4gcmVzdWx0LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1onKVswXTsgLy8gcmVtb3ZlIFVUQyBzeW1ib2xcXG59XCIsXHJcbiAgICB0eXBlOiBbJ2RhdGUnLCAnZGF0ZXRpbWUnXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyBcclxuICAgICAgICBjb25zdCB0aW1lT2Zmc2V0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMDsgLy8gZ2V0IGxvY2FsIHRpbWUgb2Zmc2V0XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IERhdGUoZmlsZS5zdGF0LmN0aW1lLXRpbWVPZmZzZXQpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbFxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidkYXRlVGltZU1vZGlmaWVkJyxcclxuICAgIHJ1bGVUeXBlOiAnYnVpbGRJbicsXHJcbiAgICBkZXNjcmlwdGlvbjogJ0RhdGUgKGFuZCBUaW1lKSBtb2RpZmllZCcsXHJcbiAgICBzb3VyY2U6IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCB0aW1lT2Zmc2V0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMDtcXG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZS10aW1lT2Zmc2V0KTsgLy8gQXBwbHkgb2Zmc2V0IHRvIEdNVCBUaW1lc3RhbXBcXG4gIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbFxcbn1cIixcclxuICAgIHR5cGU6IFsnZGF0ZScsICdkYXRldGltZSddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IFxyXG4gICAgICAgIGNvbnN0IHRpbWVPZmZzZXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lem9uZU9mZnNldCgpKjYwMDAwO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZS10aW1lT2Zmc2V0KTsgLy8gQXBwbHkgb2Zmc2V0IHRvIEdNVCBUaW1lc3RhbXBcclxuICAgICAgICByZXR1cm4gcmVzdWx0LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1onKVswXTsgLy8gcmVtb3ZlIFVUQyBzeW1ib2xcclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgICBpZDonZmlsZVNpemVCeXRlcycsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIHNpemUgaW4gYnl0ZXMnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHNpemVcXG4gIGNvbnN0IHJlc3VsdCA9IGZpbGUuc3RhdC5zaXplO1xcbiAgcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuXFxufVwiLFxyXG4gICAgdHlwZTogWydudW1iZXInXSxcclxuICAgIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pLFxyXG4gICAgZng6ZnVuY3Rpb24gKGFwcDogQXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICAvLyBhY3F1aXJlIGZpbGUgc2l6ZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGUuc3RhdC5zaXplO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgICB9XHJcbn0pO1xyXG5cclxucnVsZUZ1bmN0aW9ucy5wdXNoKHtcclxuICAgIGlkOidmaWxlU2l6ZVN0cmluZycsXHJcbiAgICBydWxlVHlwZTogJ2J1aWxkSW4nLFxyXG4gICAgZGVzY3JpcHRpb246ICdGaWxlIHNpemUgZm9ybWF0dGVkIGFzIHRleHQnLFxyXG4gICAgc291cmNlOiBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHNpemVcXG4gIGxldCBzaXplID1maWxlLnN0YXQuc2l6ZTtcXG4gIGNvbnN0IHByZWNpc2lvbiA9IDI7IC8vIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xcbiAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgIHNpemUgPSBzaXplIC8gMTAyNDtcXG4gICAgaWYgKHNpemUgPiAxMDI0KSB7XFxuICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICAgIGlmIChzaXplID4gMTAyNCkge1xcbiAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xcbiAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgR0InO1xcbiAgICAgIH0gXFxuICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHNpemUpLnRvRml4ZWQocHJlY2lzaW9uKSArICcgTUInO1xcbiAgICB9XFxuICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdChzaXplKS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEtCJztcXG4gIH0gICBcXG4gIHJldHVybiBzaXplICsgJyBCeXRlcyc7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgIHR5cGU6IFsndGV4dCddLFxyXG4gICAgY29uZmlnRWxlbWVudHM6IGRlZmF1bHRDb25maWdFbGVtZW50cyh7fSksXHJcbiAgICBmeDpmdW5jdGlvbiAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIC8vIGFjcXVpcmUgZmlsZSBzaXplXHJcbiAgICAgICAgbGV0IHNpemUgPWZpbGUuc3RhdC5zaXplO1xyXG4gICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IDI7IC8vIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlc1xyXG4gICAgICAgIGlmIChzaXplID4gMTAyNCkge1xyXG4gICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDtcclxuICAgICAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgR0InO1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIE1CJztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgS0InO1xyXG4gICAgICAgIH0gICBcclxuICAgICAgICByZXR1cm4gc2l6ZSArICcgQnl0ZXMnOyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgICAgfVxyXG59KTtcclxuXHJcbnJ1bGVGdW5jdGlvbnMucHVzaCh7XHJcbiAgaWQ6ICdhdXRvY29tcGxldGUubW9kYWwnLFxyXG4gIHJ1bGVUeXBlOiAnYXV0b2NvbXBsZXRlLm1vZGFsJyxcclxuICBkZXNjcmlwdGlvbjogJ0F1dG9jb21wbGV0ZSBNb2RhbCAoYWR2YW5jZWQpJyxcclxuICBpc0xpdmVSdWxlOiB0cnVlLFxyXG4gIHNvdXJjZTogJycsXHJcbiAgdHlwZTogWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsJ211bHRpdGV4dCddLFxyXG4gIGNvbmZpZ0VsZW1lbnRzOiBkZWZhdWx0Q29uZmlnRWxlbWVudHMoe3JlbW92ZUNvbnRlbnQ6IGZhbHNlLCAgaW5wdXRQcm9wZXJ0eTogZmFsc2UsIGFkZFByZWZpeDogZmFsc2UsIHNwYWNlUmVwbGFjZW1lbnQ6IGZhbHNlLCBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IGZhbHNlLCBjb252ZXJ0VG9Mb3dlckNhc2U6IGZhbHNlLCByZXN1bHRBc0xpbms6IGZhbHNlLCBhZGRDb250ZW50OiBmYWxzZSwgc2NyaXB0OiBmYWxzZX0pLFxyXG4gIGZ4OiBhc3luYyBmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgIGxvZ2dlci5sb2coREVCVUcsYGF1dG9jb21wbGV0ZSBtb2RhbCwgd29yayBpbiBwcm9ncmVzcy4uLmApO1xyXG4gICAgY29uc3QgY3VycmVudENvbnRlbnQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpO1xyXG4gICAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcclxuICAgIGlmICghcnVsZSkgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyhydWxlLmlkKTtcclxuICAgIGlmICghcnVsZSkgcmV0dXJuIHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCkgfHwgJ2F1dG9jb21wbGV0ZS5tb2RhbCc7IC8vIHJldHVybiBjdXJyZW50IGNvbnRlbnQgaWYgbm90IGltcGxlbWVudGVkIHlldFxyXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0b29scy5nZXRGcm9udG1hdHRlcigpO1xyXG4gICAgY29uc3QgaGFzQXV0b2NvbXBsZXRlUHJvcGVydGllcyA9IE9iamVjdC5rZXlzKGZyb250bWF0dGVyKS5zb21lKGtleSA9PiBcclxuICAgICAga2V5LnN0YXJ0c1dpdGgocnVsZS5wcm9wZXJ0eSArIG9wdGlvbnMucHJvcGVydHlEZWxpbWl0ZXIpICYmXHJcbiAgICAgIChmcm9udG1hdHRlcltrZXldID09PSB1bmRlZmluZWQgfHxcclxuICAgICAgZnJvbnRtYXR0ZXJba2V5XSA9PT0gbnVsbCB8fFxyXG4gICAgICBmcm9udG1hdHRlcltrZXldID09PSAnJylcclxuICAgICk7XHJcbiAgICBpZiAoIWhhc0F1dG9jb21wbGV0ZVByb3BlcnRpZXMpIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpIHx8ICdhdXRvY29tcGxldGUubW9kYWwnOyAvLyByZXR1cm4gY3VycmVudCBjb250ZW50IGlmIG5vdCBpbXBsZW1lbnRlZCB5ZXRcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZW5BdXRvY29tcGxldGVNb2RhbChcclxuICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICBydWxlLFxyXG4gICAgICAgIG9wdGlvbnMsXHJcbiAgICAgICAgdG9vbHMuZ2V0QWN0aXZlRmlsZSgpLFxyXG4gICAgICAgIHRvb2xzLmdldEZyb250bWF0dGVyKClcclxuICAgICAgKTtcclxuICAgIGxvZ2dlci5sb2coREVCVUcsJ2F1dG9jb21wbGV0ZSBtb2RhbCByZXN1bHQnLCByZXN1bHQsIHRvb2xzLmdldEZyb250bWF0dGVyKCkpO1xyXG4gICAgaWYgKHJlc3VsdD8udmFsdWVzKSB7XHJcbiAgICAgIHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhyZXN1bHQudmFsdWVzKSkge1xyXG4gICAgICAgICAgZnJvbnRtYXR0ZXJba2V5XSA9IHZhbHVlOyAvLyBzZXQgdGhlIGZyb250bWF0dGVyIHZhbHVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LHsnbXRpbWUnOmZpbGUuc3RhdC5tdGltZX0pOyAvLyBkbyBub3QgY2hhbmdlIHRoZSBtb2RpZnkgdGltZS5cclxuICAgIH1cclxuICAgIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpIHx8ICdhdXRvY29tcGxldGUubW9kYWwnOyAvLyByZXR1cm4gY3VycmVudCBjb250ZW50IGlmIG5vdCBpbXBsZW1lbnRlZCB5ZXRcclxuICB9LFxyXG4gIGNvbmZpZ1RhYjogZnVuY3Rpb24gKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcblxyXG4gICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgIHByb3BlcnR5RGVsaW1pdGVyOiAnLicsXHJcbiAgICB9KVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgLnNldE5hbWUoJ0RlbGltaXRlcicpXHJcbiAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIGRldGVybWluZSB3aGljaCBwcm9wZXJ0eSBzaG91bGQgYXBwZWFyIGluIHRoZSBtb2RhbCcpXHJcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3Byb3BlcnR5RGVsaW1pdGVyJykgfHwgJy4nKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3Byb3BlcnR5RGVsaW1pdGVyJywgdmFsdWUpO1xyXG4gICAgICAgIH0pKTtcclxuICB9XHJcbn0pXHJcbiovXHJcbiIsICJcclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0LCBzZXRJY29uLEJ1dHRvbkNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgQ29uc3RydWN0b3IgfSBmcm9tICdvYnNpZGlhbic7IC8vIEFkZGVkIHNldEljb25cclxuLy9pbXBvcnQgJ2NvZGVtaXJyb3IvbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQnO1xyXG5pbXBvcnQgeyBPYnNpZGlhblByb3BlcnR5VHlwZXMgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgcGFyc2VKU0NvZGUsIFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSAnLi90b29scyc7XHJcbmltcG9ydCB7IHVwZGF0ZVByb3BlcnR5SWNvbiB9IGZyb20gJy4vdWlFbGVtZW50cyc7XHJcbmltcG9ydCB7IERFQlVHLCBFUlJPUiwgbG9nZ2VyLCBUUkFDRSB9IGZyb20gJy4vTG9nJztcclxuLy9pbXBvcnQgeyBjaGRpciB9IGZyb20gJ25vZGU6cHJvY2Vzcyc7XHJcbi8vaW1wb3J0IHsgRWRpdG9yVmlldyB9IGZyb20gJ0Bjb2RlbWlycm9yL3ZpZXcnO1xyXG4vL2ltcG9ydCB7IEVkaXRvclN0YXRlIH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xyXG5cclxuXHJcbi8vIERlZmluZSB0aGUgcmVzdWx0IHN0cnVjdHVyZSByZXR1cm5lZCBieSB0aGUgbW9kYWxcclxuZXhwb3J0IGludGVyZmFjZSBjb2RlRWRpdG9yTW9kYWxSZXN1bHQge1xyXG4gICAgY29kZTogc3RyaW5nO1xyXG4gICAgdHlwZTogT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzO1xyXG4gICAgY2hlY2tlZDogYm9vbGVhbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIE1vZGFsIGZvciBzZWxlY3RpbmcgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGZyb20gdGhlIHZhdWx0IHN0cnVjdHVyZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBjb2RlRWRpdG9yTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAvLyBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgbW9kYWwgKHN0b3JlZCBmb3IgcmVzZXQgZnVuY3Rpb25hbGl0eSlcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaW5pdGlhbENvZGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgb2tDYWxsYmFjazogKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgc2NyaXB0aW5nVG9vbHM6IFNjcmlwdGluZ1Rvb2xzO1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IGFueTtcclxuXHJcbiAgICAvLyBDdXJyZW50IHN0YXRlIGJlaW5nIG1vZGlmaWVkIHdpdGhpbiB0aGUgbW9kYWxcclxuICAgIHByaXZhdGUgY3VycmVudENvZGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgZXhwZWN0ZWRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBwcml2YXRlIGNoZWNrZWRTdWNjZXNzZnVsbHkgOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSB1c2VUZXh0QXJlYSA6IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIGFjdGl2ZUZpbGU6IFRGaWxlIHwgVEZvbGRlciB8IG51bGxcclxuICAgIHByaXZhdGUgZnJvbnRtYXR0ZXI6IGFueTsgLy8gRnJvbnRtYXR0ZXIgZGF0YSBmb3IgdGhlIGFjdGl2ZSBmaWxlXHJcblxyXG4gICAgLy8gVUkgRWxlbWVudHNcclxuICAgIHByaXZhdGUgZWRpdG9yUm9vdEVsZW1lbnQhOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgZnVuY3Rpb25UZXN0QnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xyXG4gICAgcHJpdmF0ZSBmdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQ6IFRleHRDb21wb25lbnQgfCB1bmRlZmluZWQ7XHJcbiAgICBwcml2YXRlIGNtRWRpdG9yITogQ29kZU1pcnJvci5FZGl0b3IgfCBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgRGlyZWN0b3J5U2VsZWN0aW9uTW9kYWwuXHJcbiAgICAgKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBwbHVnaW4gLSBUaGUgcGx1Z2luIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIGluaXRpYWxDb2RlIC0gU3RyaW5nIHdpdGggdGhlIGluaXRpYWwgY29kZS5cclxuICAgICAqIEBwYXJhbSBleHBlY3RlZFR5cGUgLSBFeHBlY3RlZCByZXR1cm4gdHlwZS5cclxuICAgICAqIEBwYXJhbSBhY3RpdmVGaWxlIC0gVGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZSBvciBmb2xkZXIuXHJcbiAgICAgKiBAcGFyYW0gZnJvbnRtYXR0ZXIgLSBGcm9udG1hdHRlciBkYXRhIGZvciB0aGUgYWN0aXZlIGZpbGUuXHJcbiAgICAgKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsXHJcbiAgICAgICAgcGx1Z2luOiBhbnksXHJcbiAgICAgICAgaW5pdGlhbENvZGU6IHN0cmluZyxcclxuICAgICAgICBleHBlY3RlZFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcyxcclxuICAgICAgICBhY3RpdmVGaWxlOiBURmlsZSB8IFRGb2xkZXIgfCBudWxsLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBhbnksICAgXHJcbiAgICAgICAgb2tDYWxsYmFjazogKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIHN0YXRlIGZvciByZXNldFxyXG4gICAgICAgIHRoaXMuaW5pdGlhbENvZGUgPSBpbml0aWFsQ29kZTtcclxuICAgICAgICB0aGlzLmV4cGVjdGVkVHlwZSA9IGV4cGVjdGVkVHlwZTtcclxuICAgICAgICB0aGlzLnVzZVRleHRBcmVhID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVGaWxlID0gYWN0aXZlRmlsZTtcclxuICAgICAgICB0aGlzLmZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXI7IC8vIFN0b3JlIGZyb250bWF0dGVyIGRhdGFcclxuICAgICAgICB0aGlzLmN1cnJlbnRUeXBlID0gZXhwZWN0ZWRUeXBlOyAvLyBJbml0aWFsaXplIGN1cnJlbnQgdHlwZSB0byBleHBlY3RlZCB0eXBlXHJcbiAgICAgICAgdGhpcy5jdXJyZW50Q29kZSA9IGluaXRpYWxDb2RlOyAvLyBJbml0aWFsaXplIGN1cnJlbnQgY29kZSB0byBpbml0aWFsIGNvZGVcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnNjcmlwdGluZ1Rvb2xzID0gbmV3IFNjcmlwdGluZ1Rvb2xzKFxyXG4gICAgICAgICAgICBhcHAsXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncyxcclxuICAgICAgICAgICAgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICB0aGlzLmZyb250bWF0dGVyLFxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IHRoaXMuYWN0aXZlRmlsZSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5va0NhbGxiYWNrID0gb2tDYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBjdXJyZW50IHN0YXRlIGZyb20gaW5pdGlhbCBzdGF0ZSBmb3IgZWRpdGluZ1xyXG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb25Ub0luaXRpYWwoKTsgLy8gVXNlIGEgbWV0aG9kIGZvciBpbml0aWFsaXphdGlvbiBhbmQgcmVzZXRcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gdGhlIGluaXRpYWwgc3RhdGUgcHJvdmlkZWQgYXQgY29uc3RydWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudENvZGUgPSB0aGlzLmluaXRpYWxDb2RlO1xyXG4gICAgICAgIHRoaXMuY21FZGl0b3I/LnNldFZhbHVlKHRoaXMuY3VycmVudENvZGUpOyAvLyBTZXQgdGhlIGluaXRpYWwgY29kZSBpbiB0aGUgZWRpdG9yXHJcbiAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSB0aGlzLmZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudC5zZXRWYWx1ZSgnJyk7IC8vIENsZWFyIHRoZSByZXN1bHQgdGV4dCBjb21wb25lbnRcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgY3VycmVudCBzZWxlY3Rpb24gc3RhdGUgdG8gZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3Rpb25Ub0VtcHR5KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudENvZGUgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICAgICAgdGhpcy5jbUVkaXRvcj8uc2V0VmFsdWUodGhpcy5jdXJyZW50Q29kZSk7IC8vIFNldCB0aGUgaW5pdGlhbCBjb2RlIGluIHRoZSBlZGl0b3JcclxuICAgICAgICBpZiAodGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKCcnKTsgLy8gQ2xlYXIgdGhlIHJlc3VsdCB0ZXh0IGNvbXBvbmVudCBcclxuICAgIH1cclxuXHJcbiAgICBsb2FkQ29kZU1pcnJvck1vZGUobW9kZTogc3RyaW5nKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIFZlcndlbmRlIHJlcXVpcmUgKGtcdTAwRjZubnRlIGluIHp1a1x1MDBGQ25mdGlnZW4gVmVyc2lvbmVuIHdlbmlnZXIgenV2ZXJsXHUwMEU0c3NpZyBzZWluKVxyXG4gICAgICAgICAgcmVxdWlyZShgb2JzaWRpYW4vbGliL2NvZGVtaXJyb3IvbW9kZS8ke21vZGV9LyR7bW9kZX0uanNgKTtcclxuICAgICAgICAgIGxvZ2dlci5sb2coREVCVUcsYENvZGVNaXJyb3IgbW9kZSAnJHttb2RlfScgbG9hZGVkIHN1Y2Nlc3NmdWxseSAodXNpbmcgcmVxdWlyZSkuYCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYEZhaWxlZCB0byBsb2FkIENvZGVNaXJyb3IgbW9kZSAnJHttb2RlfScgKHVzaW5nIHJlcXVpcmUpOmAsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBpZiAoY29udGVudEVsLnBhcmVudEVsZW1lbnQpIGNvbnRlbnRFbC5wYXJlbnRFbGVtZW50LnN0eWxlLndpZHRoID0gJzkwMHB4JztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgXHJcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdjb2RlRWRpdG9yLW1vZGFsJyk7IFxyXG5cclxuICAgICAgICAvLyAtLS0gTW9kYWwgVGl0bGUgLS0tXHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0phdmFTY3JpcHQgRWRpdG9yJyB9KTsgICAgXHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdib2R5JywgeyB0ZXh0OiBgTWFrZSBzdXJlIHlvdXIgY29kZSByZXN1bHRzOiAke3RoaXMuZXhwZWN0ZWRUeXBlfWAgfSk7IFxyXG5cclxuICAgICAgICAvLyAtLS0gVHJlZSBDb250YWluZXIgLS0tXHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdjb2RlRWRpdG9yLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgLy8gQmFzaWMgc3R5bGluZyBmb3IgdGhlIHNjcm9sbGFibGUgdHJlZSBhcmVhXHJcbiAgICAgICAgLy8gdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS53aWR0aCA9ICc2MDBweCc7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnNjAwcHgnO1xyXG4gICAgICAgIHRoaXMuZWRpdG9yUm9vdEVsZW1lbnQuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xyXG4gICAgICAgIC8vdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XHJcbiAgICAgICAgdGhpcy5lZGl0b3JSb290RWxlbWVudC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMuZWRpdG9yUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMuZWRpdG9yUm9vdEVsZW1lbnQuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnO1xyXG5cclxuICAgICAgICB0aGlzLmNtRWRpdG9yID0gbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgcnVsZU9wdGlvbnNEaXYgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImNvZGVFZGl0b3Itb3B0aW9uc1wiIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy51c2VUZXh0QXJlYSkge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlT3B0aW9uc1NldHRpbmdzID0gbmV3IFNldHRpbmcodGhpcy5lZGl0b3JSb290RWxlbWVudClcclxuICAgICAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0QXJlYSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ2VuZGVyIHZhbGlkIEpTIENvZGUnKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYS5pbnB1dEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgaGVpZ2h0OjE5MHB4OyB3aWR0aDo4MCU7YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dEFyZWEub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZ1bmN0aW9uVGVzdEJ1dHRvbikgdGhpcy5mdW5jdGlvblRlc3RCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoJ21vZC13YXJuaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudENvZGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICBsZXQgdmlldyA9IG5ldyBFZGl0b3JWaWV3KHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiBFZGl0b3JTdGF0ZS5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICBkb2M6IHRoaXMuY3VycmVudENvZGUsICAvLyBvciBzb21lIHN0cmluZyBjb250ZW50c1xyXG4gICAgICAgICAgICAgICAgICBleHRlbnNpb25zOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgRWRpdG9yVmlldy5saW5lV3JhcHBpbmcsIC8vIEFkZCB5b3VyIGV4dGVudGlvbnMgaGVyZVxyXG4gICAgICAgICAgICAgICAgICAgIGphdmFzY3JpcHQoKSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBzY2VuZUd1dHRlciwgLy8gb3IgbGVhdmUgZW1wdHkgZm9yIGJhc2ljIGVkaXRvclxyXG4gICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IHRoaXMuZWRpdG9yUm9vdEVsZW1lbnRcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBDb2RlTWlycm9yIDVcclxuICAgICAgICAgICAgLy8gQ29kZU1pcnJvci1CaWJsaW90aGVrIGFicnVmZW5cclxuICAgICAgICAgICAgY29uc3QgQ29kZU1pcnJvciA9ICh3aW5kb3cgYXMgYW55KS5Db2RlTWlycm9yO1xyXG4gICAgICAgICAgICAvLyBTaWNoZXJzdGVsbGVuLCBkYXNzIENvZGVNaXJyb3IgZ2VsYWRlbiBpc3RcclxuICAgICAgICAgICAgaWYgKENvZGVNaXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIEphdmFTY3JpcHQtTW9kdXMgbGFkZW4gKGZhbGxzIG5vY2ggbmljaHQgZ2VsYWRlbilcclxuICAgICAgICAgICAgICAgIGlmICghQ29kZU1pcnJvci5tb2Rlcy5qYXZhc2NyaXB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkQ29kZU1pcnJvck1vZGUoJ2phdmFzY3JpcHQnKTtcclxuICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKFRSQUNFLCdqYXZhU2NyaXB0IHN1cHBvcnQgbG9hZGVkJylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgbGV0IGpzQ29kZSA9IHRoaXMuY3VycmVudENvZGU7XHJcbiAgICAgICAgICAgIHRoaXMuY21FZGl0b3IgPSBDb2RlTWlycm9yKHRoaXMuZWRpdG9yUm9vdEVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBqc0NvZGUgfHwgXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7IC8vIHJldHVybiB5b3UgcmVzdWx0Llxcbn1cIixcclxuICAgICAgICAgICAgICAgIG1vZGU6IFwiamF2YXNjcmlwdFwiLFxyXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICB0aGVtZTogXCJvYnNpZGlhblwiLFxyXG4gICAgICAgICAgICAgICAgaW5kZW50VW5pdDogNCwgIFxyXG4gICAgICAgICAgICAgICAgbGluZVdyYXBwaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlYWRPbmx5OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG91dGVySGVpZ2h0OiAnNjAwcHgnLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNtRWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNtRWRpdG9yLm9uKCdjaGFuZ2UnLCAoY21FZGl0b3I6IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25UZXN0QnV0dG9uKSB0aGlzLmZ1bmN0aW9uVGVzdEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbUVkaXRvci5vbignYmx1cicsIChjbUVkaXRvcjogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRDb2RlPSBjbUVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byBzYXZlIHRoZSBjb2RlXHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKHJ1bGVPcHRpb25zRGl2KVxyXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblRlc3RCdXR0b24gPSBidXR0b247XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiUnVuIENvZGVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIlJ1biB0aGUgY29kZSBhbmQgY2hlY2sgZm9yIGVycm9yc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY21FZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc0NvZGUgPSB0aGlzLmNtRWRpdG9yLmdldFZhbHVlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJGdW5jdGlvbiA9ICBwYXJzZUpTQ29kZShqc0NvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB1c2VyRnVuY3Rpb24gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVycm9ySGludCA9IFwiU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJGdW5jdGlvbi5jb250YWlucygnVW5leHBlY3RlZCB0b2tlbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ySGludCA9IFwiRGlkIHlvdSBtaXNzZWQgYSBzZW1pY29sb24gKDspP1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQpIHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50LnNldFZhbHVlKGBTeW50YXggZXJyb3I6ICR7dXNlckZ1bmN0aW9ufSEgJHtlcnJvckhpbnR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlckZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB1c2VyRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYWN0aXZlRmlsZSwgdGhpcy5zY3JpcHRpbmdUb29scylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZ1bmN0aW9uUmVzdWx0VGV4dENvbXBvbmVudCkgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYCcke3Jlc3VsdC50b1N0cmluZygpfScgKCR7dHlwZW9mIHJlc3VsdH0pYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVR5cGVJY29ucyhyZXN1bHQsIHR5cGVzQ29udGFpbmVyLCB0aGlzLmV4cGVjdGVkVHlwZSwgdGhpcy5jdXJyZW50VHlwZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnJlbW92ZUNsYXNzKCdtb2Qtd2FybmluZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkU3VjY2Vzc2Z1bGx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gKGUgaW5zdGFuY2VvZiBFcnJvcikgPyBlLm1lc3NhZ2UgOiBTdHJpbmcoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuc2V0VmFsdWUoYFN5bnRheCBlcnJvcjogJHtlcnJvck1lc3NhZ2V9ISBTZWUgY29uc29sZSBmb3IgZGV0YWlscyFgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsXCJTeW50YXggZXJyb3IuIFwiLCBlLCBqc0NvZGUsIHVzZXJGdW5jdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRTdWNjZXNzZnVsbHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcygnbW9kLXdhcm5pbmcnKTsgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKEVSUk9SLFwic3ludGF4IGVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRTdWNjZXNzZnVsbHkgPSBmYWxzZTsgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQgPSB0ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2Z1bmN0aW9uIHJlc3VsdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvblJlc3VsdFRleHRDb21wb25lbnQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICc1ODBweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVzQ29udGFpbmVyID0gcnVsZU9wdGlvbnNEaXYuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktaWNvbnMtY29udGFpbmVyJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIEFjdGlvbiBCdXR0b25zIC0tLVxyXG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250ZW50RWwpOyAvLyBDcmVhdGUgT0sgYW5kIFJlc2V0IGJ1dHRvbnNcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVUeXBlSWNvbnModmFsdWU6YW55LCBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBleHBlY3RlZFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgY3VycmVudFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgc2V0dGluZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IG5ld1R5cGUgPSB0eXBlb2YgdmFsdWU7XHJcbiAgICAgICAgY29uc3QgdHlwZUljb25zOiB7W2tleTpzdHJpbmddOiBPYnNpZGlhblByb3BlcnR5VHlwZXNbXX0gPSB7XHJcbiAgICAgICAgICAgICdzdHJpbmcnOiBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCcsJ2RhdGUnLCAnZGF0ZXRpbWUnXSxcclxuICAgICAgICAgICAgJ251bWJlcic6IFsnbnVtYmVyJ10sXHJcbiAgICAgICAgICAgICdib29sZWFuJzogWydjaGVja2JveCddLFxyXG4gICAgICAgICAgICAnb2JqZWN0JzogWyd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J11cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChuZXdUeXBlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2NyaXB0aW5nVG9vbHMuaXNJU09TdHJpbmcodmFsdWUsIHt3aXRoRGF0ZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlSWNvbnNbbmV3VHlwZV0uc3BsaWNlKHR5cGVJY29uc1tuZXdUeXBlXS5pbmRleE9mKCdkYXRlJyksIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zY3JpcHRpbmdUb29scy5pc0lTT1N0cmluZyh2YWx1ZSwge3dpdGhEYXRlOiB0cnVlLCB3aXRoVGltZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlSWNvbnNbbmV3VHlwZV0uc3BsaWNlKHR5cGVJY29uc1tuZXdUeXBlXS5pbmRleE9mKCdkYXRldGltZScpLCAxKTsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGFpbmVyLmVtcHR5KCk7IC8vIENsZWFyIHRoZSBjb250YWluZXIgYmVmb3JlIGFkZGluZyBuZXcgaWNvbnNcclxuICAgICAgICBmb3IgKGxldCBvYnNpZGlhblR5cGUgb2YgdHlwZUljb25zW25ld1R5cGVdKSB7XHJcbiAgICAgICAgICAgIGlmIChvYnNpZGlhblR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGljb25FbCA9IGNvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAncHJvcGVydHktaWNvbiBzZXR0aW5nLWl0ZW0taWNvbicgfSk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQcm9wZXJ0eUljb24oaWNvbkVsLCBvYnNpZGlhblR5cGUpOyAvLyBVcGRhdGUgdGhlIGljb24gYmFzZWQgb24gdGhlIHR5cGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIFwiT0tcIiBhbmQgXCJSZXNldFwiIGJ1dHRvbnMuXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgSFRNTCBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYnV0dG9ucyB0by5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ21vZGFsLWJ1dHRvbnMnIH0pO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTVweCc7XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIFVzZSBmbGV4IGZvciBhbGlnbm1lbnRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1lbmQnOyAvLyBBbGlnbiBidXR0b25zIHRvIHRoZSByaWdodFxyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5nYXAgPSAnMTBweCc7IC8vIFNwYWNlIGJldHdlZW4gYnV0dG9uc1xyXG5cclxuICAgICAgICAvLyBSZXNldCBCdXR0b24gKFVuZG8gXHUyMUFBXHVGRTBGKVxyXG4gICAgICAgIGNvbnN0IHJlc2V0QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKHJlc2V0QnV0dG9uLCAncmVzZXQnKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgcmVzZXRCdXR0b24uYXJpYUxhYmVsID0gJ1Jlc2V0IHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICByZXNldEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9Jbml0aWFsKCk7IC8vIFJlc2V0IGludGVybmFsIHN0YXRlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgQnV0dG9uIChDbGVhciBcdUQ4M0RcdURFQUUpXHJcbiAgICAgICAgY29uc3QgZW1wdHlCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIC8vIFVzZSBPYnNpZGlhbidzIHNldEljb24gZm9yIGNvbnNpc3RlbmN5LCBvciB1c2UgdGV4dFxyXG4gICAgICAgIHNldEljb24oZW1wdHlCdXR0b24sICdlcmFzZXInKTsgLy8gVXNlIGEgc3VpdGFibGUgaWNvbiBsaWtlICdyZXNldCcgb3IgJ3VuZG8nXHJcbiAgICAgICAgZW1wdHlCdXR0b24uYXJpYUxhYmVsID0gJ0NsZWFyIHNlbGVjdGlvbic7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBlbXB0eUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uVG9FbXB0eSgpOyAvLyBDbGVhciBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGNhbmNlbCBCdXR0b25cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NhbmNlbCcgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFyaWFMYWJlbCA9ICdjbG9zZSBhbmQgZGlzY2FyZCBjaGFuZ2VzJzsgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsb2dnZXIubG9nKFRSQUNFLFwiQ2FuY2VsIENsaWNrZWQgLSBSZXR1cm5pbmdcIik7IC8vIERlYnVnIGxvZ1xyXG4gICAgICAgICAgICB0aGlzLm9rQ2FsbGJhY2soIG51bGwgKTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE9LIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycsIGNsczogJ21vZC1jdGEnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIHNhdmUgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBva0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIG1vZGFsIGlzIGNsb3NlZC4gQ2xlYW5zIHVwIHJlc291cmNlcy5cclxuICAgICAqL1xyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICAvLyBHYXRoZXIgdGhlIGZpbmFsIHN0YXRlIE9OTFkgd2hlbiBPSyBpcyBjbGlja2VkXHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBjb2RlRWRpdG9yTW9kYWxSZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuY3VycmVudENvZGUsXHJcbiAgICAgICAgICAgIGNoZWNrZWQ6IHRoaXMuY2hlY2tlZFN1Y2Nlc3NmdWxseSxcclxuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbG9nZ2VyLmxvZyhUUkFDRSxcIk9LIENsaWNrZWQgLSBSZXR1cm5pbmcgUmVzdWx0OlwiLCByZXN1bHQpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICB0aGlzLm9rQ2FsbGJhY2socmVzdWx0KTsgLy8gUGFzcyB0aGUgZmluYWwgc2VsZWN0aW9uIGJhY2tcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgdGhlIG1vZGFsJ3MgY29udGVudFxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGVhc2lseSBvcGVuIHRoZSBEaXJlY3RvcnkgU2VsZWN0aW9uIE1vZGFsLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIEFwcCBpbnN0YW5jZS5cclxuICogQHBhcmFtIGluaXRpYWxDb2RlIC0gU3RyaW5nIHdpdGggdGhlIGluaXRpYWwgY29kZS5cclxuICogQHBhcmFtIGV4cGVjdGVkVHlwZSAtIEV4cGVjdGVkIHJldHVybiB0eXBlLlxyXG4gKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuQ29kZUVkaXRvck1vZGFsKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBwbHVnaW46IGFueSxcclxuICAgIGluaXRpYWxDb2RlOiBzdHJpbmcsXHJcbiAgICBleHBlY3RlZFR5cGU6IE9ic2lkaWFuUHJvcGVydHlUeXBlcyxcclxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlIHwgVEZvbGRlciB8IG51bGwsXHJcbiAgICBmcm9udG1hdHRlcjogYW55LFxyXG4gICAgb2tDYWxsYmFjazogKHJlc3VsdDogY29kZUVkaXRvck1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4pOiB2b2lkIHtcclxuICAgIC8vIENyZWF0ZSBhbmQgb3BlbiB0aGUgbW9kYWwgaW5zdGFuY2VcclxuICAgIG5ldyBjb2RlRWRpdG9yTW9kYWwoXHJcbiAgICAgICAgYXBwLFxyXG4gICAgICAgIHBsdWdpbixcclxuICAgICAgICBpbml0aWFsQ29kZSxcclxuICAgICAgICBleHBlY3RlZFR5cGUsXHJcbiAgICAgICAgYWN0aXZlRmlsZSxcclxuICAgICAgICBmcm9udG1hdHRlcixcclxuICAgICAgICBva0NhbGxiYWNrXHJcbiAgICApLm9wZW4oKTtcclxufSIsICJpbXBvcnQgeyBzZXRJY29uLCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IE9ic2lkaWFuUHJvcGVydHlUeXBlcywgUHJvcGVydHlJbmZvIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJWYWx1ZUlucHV0KGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcHJvcGVydHlJbmZvOiBQcm9wZXJ0eUluZm8gfCB1bmRlZmluZWQsIGN1cnJlbnRWYWx1ZTogYW55LCBjaGFuZ2VDYWxsYmFjazogKHByb3BlcnR5SW5mbzogUHJvcGVydHlJbmZvIHwgdW5kZWZpbmVkLCB2YWx1ZTogYW55KSA9PiB2b2lkKSB7XHJcbiAgICBsZXQgcmV0dXJuQ29tcG9uZW50OmFueTtcclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7IFxyXG5cclxuICAgIGlmICghcHJvcGVydHlJbmZvKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lckVsLnNldFRleHQoJycpO1xyXG4gICAgICAgICAgICBjb250YWluZXJFbC5hZGRDbGFzcygndGV4dC1tdXRlZCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHlwZSA9IHByb3BlcnR5SW5mby50eXBlO1xyXG5cclxuICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdOdW1lcmljIFZhbHVlJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50VmFsdWUgIT09IG51bGwgPyBTdHJpbmcoY3VycmVudFZhbHVlKSA6ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bVZhbHVlID0gdmFsdWUgPT09ICcnID8gdW5kZWZpbmVkIDogcGFyc2VGbG9hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ2FsbGJhY2socHJvcGVydHlJbmZvLCBpc05hTihudW1WYWx1ZSBhcyBudW1iZXIpID8gdW5kZWZpbmVkIDogbnVtVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnbnVtYmVyJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnY2hlY2tib3gnOlxyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0cmktc3RhdGUtY2hlY2tib3ggY2xpY2thYmxlLWljb24nIH0pO1xyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0NoZWNrYm94IGNoYW5nZSBzdGF0ZScpO1xyXG4gICAgICAgICAgICByZXR1cm5Db21wb25lbnQuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2NoZWNrYm94Jyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVDaGVja2JveFZpc3VhbCA9IChzdGF0ZTogYm9vbGVhbiB8IHVuZGVmaW5lZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGljb25OYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXJpYVN0YXRlOiAndHJ1ZScgfCAnZmFsc2UnIHwgJ21peGVkJztcclxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGljb25OYW1lID0gJ2NoZWNrLXNxdWFyZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJpYVN0YXRlID0gJ3RydWUnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpY29uTmFtZSA9ICdzcXVhcmUnO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyaWFTdGF0ZSA9ICdmYWxzZSc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyB1bmRlZmluZWQgb3IgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25OYW1lID0gJ21pbnVzLXNxdWFyZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJpYVN0YXRlID0gJ21peGVkJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNldEljb24ocmV0dXJuQ29tcG9uZW50LCBpY29uTmFtZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5Db21wb25lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCBhcmlhU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LmRhdGFzZXQuc3RhdGUgPSBTdHJpbmcoc3RhdGUpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdXBkYXRlQ2hlY2tib3hWaXN1YWwoY3VycmVudFZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50U3RhdGUgPSByZXR1cm5Db21wb25lbnQuZGF0YXNldC5zdGF0ZTtcclxuICAgICAgICAgICAgICAgIGxldCBuZXh0U3RhdGU6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gJ3RydWUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gdW5kZWZpbmVkOyBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGF0ZSA9IGZhbHNlOyBcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VDYWxsYmFjayhwcm9wZXJ0eUluZm8sICBuZXh0U3RhdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVwZGF0ZUNoZWNrYm94VmlzdWFsKG5leHRTdGF0ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnZGF0ZSc6XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZWVlZLU1NLUREJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50VmFsdWUgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ2FsbGJhY2socHJvcGVydHlJbmZvLCB2YWx1ZSB8fCB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnZGF0ZSc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2RhdGV0aW1lJzpcclxuICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1lZWVktTU0tRERUSEg6bW0nKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKGN1cnJlbnRWYWx1ZSB8fCAnJylcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDYWxsYmFjayhwcm9wZXJ0eUluZm8sIHZhbHVlIHx8IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuQ29tcG9uZW50LmlucHV0RWwudHlwZSA9ICdkYXRldGltZS1sb2NhbCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2FsaWFzZXMnOlxyXG4gICAgICAgIGNhc2UgJ3RhZ3MnOlxyXG4gICAgICAgIGNhc2UgJ211bHRpdGV4dCc6XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd2YWx1ZXMgKGRpdmlkZWQgYnkgY29tbWEpJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShBcnJheS5pc0FycmF5KGN1cnJlbnRWYWx1ZSkgPyBjdXJyZW50VmFsdWUuam9pbignLCAnKSA6IChjdXJyZW50VmFsdWUgfHwgJycpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5VmFsdWUgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKS5maWx0ZXIocyA9PiBzKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDYWxsYmFjayhwcm9wZXJ0eUluZm8sIGFycmF5VmFsdWUubGVuZ3RoID4gMCA/IGFycmF5VmFsdWUgOiB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybkNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd2YWx1ZScpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudFZhbHVlIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNhbGxiYWNrKHByb3BlcnR5SW5mbywgdmFsdWUgfHwgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICBpZiAodHlwZSAhPT0gJ2NoZWNrYm94Jykge1xyXG4gICAgICAgIHJldHVybkNvbXBvbmVudC5pbnB1dEVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd0cmFuc3BhcmVudCc7IC8vIG1ha2UgaXQgaW52aXNpYmxlXHJcbiAgICAgICAgcmV0dXJuQ29tcG9uZW50LmlucHV0RWwuc3R5bGUud2lkdGggPSAnMTAwJSc7XHJcbiAgICAgICAgcmV0dXJuQ29tcG9uZW50LmlucHV0RWwuc3R5bGUuYm9yZGVyID0gJ25vbmUnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldHVybkNvbXBvbmVudDtcclxufSBcclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVByb3BlcnR5SWNvbihpY29uRWw6IEhUTUxFbGVtZW50LCB0eXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXMgfCB1bmRlZmluZWQpIHtcclxuICAgIGxldCBpY29uTmFtZSA9ICdoYXNoJztcclxuICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ3RleHQnOiBpY29uTmFtZSA9ICdhbGlnbi1sZWZ0JzsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbnVtYmVyJzogaWNvbk5hbWUgPSAnYmluYXJ5JzsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbXVsdGl0ZXh0JzogaWNvbk5hbWUgPSAnbGlzdCc7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2RhdGUnOiBpY29uTmFtZSA9ICdjYWxlbmRhcic7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2RhdGV0aW1lJzogaWNvbk5hbWUgPSAnY2xvY2snOyBicmVhaztcclxuICAgICAgICBjYXNlICdjaGVja2JveCc6IGljb25OYW1lID0gJ2NoZWNrLXNxdWFyZSc7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3RhZ3MnOiBpY29uTmFtZSA9ICd0YWdzJzsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnYWxpYXNlcyc6IGljb25OYW1lID0gJ2ZvcndhcmQnOyBicmVhaztcclxuIFxyXG4gICAgICAgIGRlZmF1bHQ6IGljb25OYW1lID0gJ2hlbHAtY2lyY2xlJztcclxuICAgIH1cclxuICAgIHNldEljb24oaWNvbkVsLCBpY29uTmFtZSk7XHJcbn0iLCAiaW1wb3J0IHsgU2V0dGluZywgRXh0cmFCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHR5cGUgeyBQcm9wZXJ0eVR5cGVJbmZvIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNdWx0aVByb3BlcnR5U2V0dGluZyB7XHJcbiAgICBwdWJsaWMgc2V0dGluZ0VsOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgbmFtZTogc3RyaW5nID0gXCJcIjtcclxuICAgIHByaXZhdGUgZGVzYzogc3RyaW5nID0gXCJcIjtcclxuICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZ1tdID0gW107XHJcbiAgICBwcml2YXRlIG9uQ2hhbmdlQ2I6ICh2YWw6IHN0cmluZ1tdKSA9PiB2b2lkID0gKCkgPT4ge307XHJcbiAgICBwcml2YXRlIG9wdGlvbnM6IHN0cmluZ1tdIHwgQXJyYXk8e2lkOiBzdHJpbmcsIG5hbWU6IHN0cmluZ30+ID0gW107XHJcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGV4dHJhQnV0dG9uQ2FsbGJhY2tzOiAoKHNldHRpbmc6IFNldHRpbmcsIGlkeDogbnVtYmVyKSA9PiB2b2lkKVtdID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ0VsID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldE5hbWUobmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBzZXREZXNjKGRlc2M6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuZGVzYyA9IGRlc2M7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VmFsdWUodmFsdWU6IHN0cmluZ1tdKSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlLmxlbmd0aCA/IFsuLi52YWx1ZV0gOiBbXCJcIl07XHJcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBzZXRPcHRpb25zKG9wdGlvbnM6IHN0cmluZ1tdIHwgQXJyYXk8e2lkOiBzdHJpbmcsIG5hbWU6IHN0cmluZ30+KSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hhbmdlKGNiOiAodmFsOiBzdHJpbmdbXSkgPT4gdm9pZCkge1xyXG4gICAgICAgIHRoaXMub25DaGFuZ2VDYiA9IGNiO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWxsb3dzIGFkZGluZyBleHRyYSBidXR0b25zIHRvIGVhY2ggcm93LlxyXG4gICAgICogVGhlIGNhbGxiYWNrIHJlY2VpdmVzIHRoZSBTZXR0aW5nIGFuZCB0aGUgcm93IGluZGV4LlxyXG4gICAgICovXHJcbiAgICBhZGRFeHRyYUJ1dHRvbihjYjogKHNldHRpbmc6IFNldHRpbmcsIGlkeDogbnVtYmVyKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgdGhpcy5leHRyYUJ1dHRvbkNhbGxiYWNrcy5wdXNoKGNiKTtcclxuICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHN0eWxlRGlzYWJsZWQoZWw6IEV4dHJhQnV0dG9uQ29tcG9uZW50LCBkaXNhYmxlZDogYm9vbGVhbikge1xyXG4gICAgICAgIGlmIChkaXNhYmxlZCkge1xyXG4gICAgICAgICAgICBlbC5leHRyYVNldHRpbmdzRWwuYWRkQ2xhc3MoJ21vZC1kaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICBlbC5leHRyYVNldHRpbmdzRWwuc2V0QXR0cignYXJpYS1kaXNhYmxlZCcsICd0cnVlJyk7XHJcbiAgICAgICAgICAgIGVsLmV4dHJhU2V0dGluZ3NFbC50YWJJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICBlbC5leHRyYVNldHRpbmdzRWwucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZWwuZXh0cmFTZXR0aW5nc0VsLnJlbW92ZUNsYXNzKCdtb2QtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgZWwuZXh0cmFTZXR0aW5nc0VsLnNldEF0dHIoJ2FyaWEtZGlzYWJsZWQnLCAnZmFsc2UnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5nRWwuZW1wdHkoKTtcclxuICAgICAgICBjb25zdCBhcnIgPSB0aGlzLnZhbHVlO1xyXG5cclxuICAgICAgICBhcnIuZm9yRWFjaCgoc2VsZWN0ZWQsIGlkeCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcodGhpcy5zZXR0aW5nRWwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZShpZHggPT09IDAgPyB0aGlzLm5hbWUgOiBcIlwiKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoaWR4ID09PSAwID8gdGhpcy5kZXNjIDogXCJcIilcclxuICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bihkZCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGQuYWRkT3B0aW9uKGl0ZW0sIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGQuYWRkT3B0aW9uKGl0ZW0uaWQsIGl0ZW0ubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBkZC5zZXRWYWx1ZShzZWxlY3RlZCB8fCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBkZC5vbkNoYW5nZSgodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyW2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNiKFsuLi5hcnJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoaWR4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc2V0dGluZy5zZXR0aW5nRWwuc3R5bGUuYm9yZGVyVG9wID0gJ25vbmUnOyAvLyBSZW1vdmUgYm9yZGVyIGZvciBhbGwgYnV0IHRoZSBmaXJzdCBpdGVtXHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5wYWRkaW5nID0gJzAgMCAwLjc1ZW0nOyAvLyBSZW1vdmUgbWFyZ2luIGZvciBhbGwgYnV0IHRoZSBmaXJzdCBpdGVtXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5ib3JkZXJUb3AgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7IC8vIEFkZCBib3JkZXIgZm9yIHRoZSBmaXJzdCBpdGVtXHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5wYWRkaW5nID0gJzAuNzVlbSAwJzsgLy8gUmVtb3ZlIG1hcmdpbiBmb3IgYWxsIGJ1dCB0aGUgZmlyc3QgaXRlbVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmdDb250cm9sPSBzZXR0aW5nLmNvbnRyb2xFbDtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmdDb250cm9sKSB7XHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nQ29udHJvbC5zdHlsZS5nYXAgPSAnMC4xZW0nOyAvLyBBZGQgZ2FwIGJldHdlZW4gYnV0dG9uc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIE1vdmUgdXBcclxuICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEljb24oJ2Fycm93LXVwJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnTW92ZSB1cCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKGlkeCA9PT0gMClcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFthcnJbaWR4IC0gMV0sIGFycltpZHhdXSA9IFthcnJbaWR4XSwgYXJyW2lkeCAtIDFdXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNiKFsuLi5hcnJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGVEaXNhYmxlZChidG4sIGlkeCA9PT0gMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gTW92ZSBkb3duXHJcbiAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oYnRuID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0bi5zZXRJY29uKCdhcnJvdy1kb3duJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnTW92ZSBkb3duJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQoaWR4ID09PSBhcnIubGVuZ3RoIC0gMSlcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFthcnJbaWR4XSwgYXJyW2lkeCArIDFdXSA9IFthcnJbaWR4ICsgMV0sIGFycltpZHhdXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNiKFsuLi5hcnJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGVEaXNhYmxlZChidG4sIGlkeCA9PT0gYXJyLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIE1pbnVzIChhbHdheXMgZW5hYmxlZCB1bmxlc3Mgb25seSBvbmUgbGVmdClcclxuICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEljb24oJ21pbnVzLWNpcmNsZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1JlbW92ZSBwcm9wZXJ0eScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKGFyci5sZW5ndGggPT09IDEpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnIuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhcnIubGVuZ3RoID8gYXJyIDogW1wiXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IoWy4uLnRoaXMudmFsdWVdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGVEaXNhYmxlZChidG4sIGFyci5sZW5ndGggPT09IDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIENhbGwgZXh0cmEgYnV0dG9uIGNhbGxiYWNrcyBmb3IgdGhpcyByb3dcclxuICAgICAgICAgICAgdGhpcy5leHRyYUJ1dHRvbkNhbGxiYWNrcy5mb3JFYWNoKGNiID0+IGNiKHNldHRpbmcsIGlkeCkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBQbHVzIGJ1dHRvbiB1bmRlciB0aGUgbGFzdCByb3dcclxuICAgICAgICBjb25zdCBwbHVzQnV0dG9uID0gbmV3IFNldHRpbmcodGhpcy5zZXR0aW5nRWwpXHJcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEljb24oJ3BsdXMtY2lyY2xlJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnQWRkIHByb3BlcnR5JylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQoYXJyW2Fyci5sZW5ndGggLSAxXSA9PT0gXCJcIiB8fCAhYXJyW2Fyci5sZW5ndGggLSAxXSlcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnJbYXJyLmxlbmd0aCAtIDFdICE9PSBcIlwiICYmIGFyclthcnIubGVuZ3RoIC0gMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2VDYihbLi4uYXJyXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlRGlzYWJsZWQoYnRuLCBhcnJbYXJyLmxlbmd0aCAtIDFdID09PSBcIlwiIHx8ICFhcnJbYXJyLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHBsdXNCdXR0b24uc2V0dGluZ0VsLnN0eWxlLmJvcmRlclRvcCA9ICdub25lJzsgLy8gUmVtb3ZlIGJvcmRlciBmb3IgYWxsIGJ1dCB0aGUgZmlyc3QgaXRlbVxyXG4gICAgICAgIHBsdXNCdXR0b24uc2V0dGluZ0VsLnN0eWxlLnBhZGRpbmcgPSAnMCAwIDAuNzVlbSc7IC8vIFJlbW92ZSBtYXJnaW4gZm9yIGFsbCBidXQgdGhlIGZpcnN0IGl0ZW1cclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBTZXR0aW5nLCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgU2VhcmNoQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBsb2dnZXIsIFRSQUNFIH0gZnJvbSBcIi4vTG9nXCI7XG5cbmV4cG9ydCB0eXBlIFRyZWVIaWVyYXJjaHlGb2xkZXIgPSB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcGFyZW50SWQ/OiBzdHJpbmc7XG4gICAgZGlzYWJsZWQ6IGJvb2xlYW47IC8vIEFkZGVkIHRvIHN1cHBvcnQgZGlzYWJsaW5nIGZvbGRlcnNcbiAgICBjb2xsYXBzZWQ6IGJvb2xlYW47IC8vIEFkZCB0aGlzIGxpbmVcbn07XG5leHBvcnQgdHlwZSBUcmVlSGllcmFyY2h5Um93ID0ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgZm9sZGVySWQ/OiBzdHJpbmc7XG4gICAga2V5d29yZHM6IHN0cmluZ1tdO1xuICAgIGRpc2FibGVkOiBib29sZWFuOyAvLyBBZGRlZCB0byBzdXBwb3J0IGRpc2FibGluZyByb3dzXG4gICAgcGF5bG9hZD86IGFueTsgLy8gT3B0aW9uYWwgcGF5bG9hZCBmb3IgY3VzdG9tIGRhdGFcbn07XG50eXBlIEZNQUZvbGRlckxpc3REcmFnVGFyZ2V0ID0gXCJmb2xkZXJcIiB8IFwicm93XCIgfCBcInJvb3RcIjtcblxuZXhwb3J0IHR5cGUgVHJlZUhpZXJhcmNoeURhdGEgPSB7XG4gICAgZm9sZGVyczogVHJlZUhpZXJhcmNoeUZvbGRlcltdO1xuICAgIHJvd3M6IFRyZWVIaWVyYXJjaHlSb3dbXTtcbn07XG5cbmV4cG9ydCBjb25zdCBST09UX0ZPTERFUiA9IHVuZGVmaW5lZDsgLy8gU3BlY2lhbCBpZGVudGlmaWVyIGZvciByb290IGZvbGRlclxuXG50eXBlIFJvd1JlbmRlckNhbGxiYWNrID0gKHJvdzogVHJlZUhpZXJhcmNoeVJvdywgcm93RWw6IEhUTUxFbGVtZW50KSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgVHJlZUhpZXJhcmNoeVNvcnRhYmxlU2V0dGluZ3Mge1xuICAgIHB1YmxpYyBzZXR0aW5nRWw6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGRhdGE6IFRyZWVIaWVyYXJjaHlEYXRhO1xuICAgIHByaXZhdGUgdGl0bGU6IHN0cmluZyA9IFwiXCI7XG4gICAgcHJpdmF0ZSBkZXNjcmlwdGlvbjogc3RyaW5nID0gXCJcIjtcbiAgICBwcml2YXRlIGZpbHRlcjogc3RyaW5nID0gXCJcIjtcbiAgICBwcml2YXRlIHJvd1JlbmRlckNiOiBSb3dSZW5kZXJDYWxsYmFjaztcbiAgICBwcml2YXRlIG9uQ2hhbmdlQ2I6IChkYXRhOiBUcmVlSGllcmFyY2h5RGF0YSkgPT4gdm9pZCA9ICgpID0+IHt9O1xuICAgIHByaXZhdGUgb25Sb3dDcmVhdGVkQ2I6IChyb3c6IFRyZWVIaWVyYXJjaHlSb3cpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgICBwcml2YXRlIG9uUm93RGVsZXRlZENiOiAocm93OiBUcmVlSGllcmFyY2h5Um93KSA9PiB2b2lkID0gKCkgPT4ge307XG4gICAgcHJpdmF0ZSBvbkRlbGV0ZUJ0Q2I6ICgpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgICBwcml2YXRlIG9uUmVuZGVyZWRDYjogKCkgPT4gdm9pZCA9ICgpID0+IHt9O1xuICAgIHByaXZhdGUgZXh0cmFCdXR0b25DYnM6ICgoYnRuOiBTZXR0aW5nKSA9PiB2b2lkKVtdID0gW107XG4gICAgXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgZGF0YTogVHJlZUhpZXJhcmNoeURhdGEsIHJvd1JlbmRlckNiOiBSb3dSZW5kZXJDYWxsYmFjaykge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5zZXR0aW5nRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIkZNQS1mb2xkZXItbGlzdC1zZXR0aW5nXCIgfSk7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGEgfHwgeyBmb2xkZXJzOiBbXSwgcm93czogW10gfTtcbiAgICAgICAgdGhpcy5yb3dSZW5kZXJDYiA9IHJvd1JlbmRlckNiO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgICBzZXRUaXRsZSh0aXRsZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYWRkRXh0cmFCdXR0b25Ub0hlYWRlcihjYjogKGJ0bjogU2V0dGluZykgPT4gdm9pZCkge1xuICAgICAgICB0aGlzLmV4dHJhQnV0dG9uQ2JzLnB1c2goY2IpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgb25EZWxldGVCdChjYjogKCkgPT4gdm9pZCkge1xuICAgICAgICB0aGlzLm9uRGVsZXRlQnRDYiA9IGNiO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYWRkUm93KGZvbGRlcklkOiBzdHJpbmcgfCB1bmRlZmluZWQsIGtleXdvcmRzOiBzdHJpbmdbXSA9IFtdLCBwYXlsb2FkPzogYW55KSB7XG4gICAgICAgIGNvbnN0IG5ld1JvdzogVHJlZUhpZXJhcmNoeVJvdyA9IHtcbiAgICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgICAgZm9sZGVySWQsXG4gICAgICAgICAgICBrZXl3b3JkcyxcbiAgICAgICAgICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgICAgIHBheWxvYWQsXG4gICAgICAgIH07XG4gICAgICAgIGlmICghZm9sZGVySWQpIHtcbiAgICAgICAgICAgIC8vIElmIG5vIGZvbGRlcklkLCBhZGQgdG8gcm9vdCAodW5kZWZpbmVkIGZvbGRlcilcbiAgICAgICAgICAgIHRoaXMuZGF0YS5yb3dzLnB1c2gobmV3Um93KTtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2VDYih0aGlzLmRhdGEpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8vIEZpbmQgdGhlIGxhc3Qgcm93IHdpdGggdGhlIHNhbWUgZm9sZGVySWRcbiAgICAgICAgY29uc3QgbGFzdElkeCA9IHRoaXMuZGF0YS5yb3dzLm1hcChyID0+IHIuZm9sZGVySWQpLmxhc3RJbmRleE9mKGZvbGRlcklkKTtcbiAgICAgICAgaWYgKGxhc3RJZHggPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBObyByb3dzIGluIHRoaXMgZm9sZGVyLCBpbnNlcnQgYXQgdGhlIHN0YXJ0XG4gICAgICAgICAgICB0aGlzLmRhdGEucm93cy51bnNoaWZ0KG5ld1Jvdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJbnNlcnQgYWZ0ZXIgdGhlIGxhc3Qgcm93IGluIHRoaXMgZm9sZGVyXG4gICAgICAgICAgICB0aGlzLmRhdGEucm93cy5zcGxpY2UobGFzdElkeCArIDEsIDAsIG5ld1Jvdyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vblJvd0NyZWF0ZWRDYihuZXdSb3cpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodGhpcy5kYXRhKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGFkZEZvbGRlcihuYW1lOiBzdHJpbmcsIHBhcmVudElkPzogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IG5ld0ZvbGRlcjogVHJlZUhpZXJhcmNoeUZvbGRlciA9IHtcbiAgICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIHBhcmVudElkLFxuICAgICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLCAvLyBEZWZhdWx0IHRvIGVuYWJsZWRcbiAgICAgICAgICAgIGNvbGxhcHNlZDogZmFsc2UsIC8vIERlZmF1bHQgdG8gZXhwYW5kZWRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5kYXRhLmZvbGRlcnMucHVzaChuZXdGb2xkZXIpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodGhpcy5kYXRhKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgc2V0RGF0YShkYXRhOiBUcmVlSGllcmFyY2h5RGF0YSkge1xuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBvbkNoYW5nZShjYjogKGRhdGE6IFRyZWVIaWVyYXJjaHlEYXRhKSA9PiB2b2lkKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYiA9IGNiO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcHVibGljIG9uUm93Q3JlYXRlZChjYjogKHJvdzogVHJlZUhpZXJhcmNoeVJvdykgPT4gdm9pZCkge1xuICAgICAgICB0aGlzLm9uUm93Q3JlYXRlZENiID0gY2I7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBwdWJsaWMgb25Sb3dEZWxldGVkKGNiOiAocm93OiBUcmVlSGllcmFyY2h5Um93KSA9PiB2b2lkKSB7XG4gICAgICAgIHRoaXMub25Sb3dEZWxldGVkQ2IgPSBjYjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIG9uUmVuZGVyZWQoY2I6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgdGhpcy5vblJlbmRlcmVkQ2IgPSBjYjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHByaXZhdGUgbW92ZVJvdyhyb3dJZDogc3RyaW5nLCB0YXJnZXRSb3dJZD86IHN0cmluZykge1xuICAgICAgICBjb25zdCBmcm9tSWR4ID0gdGhpcy5kYXRhLnJvd3MuZmluZEluZGV4KHIgPT4gci5pZCA9PT0gcm93SWQpO1xuICAgICAgICBpZiAoZnJvbUlkeCA9PT0gLTEpIHJldHVybjtcbiAgICAgICAgaWYgKHJvd0lkID09PSB0YXJnZXRSb3dJZCkgcmV0dXJuOyAvLyBEb24ndCBtb3ZlIG9udG8gaXRzZWxmXG5cbiAgICAgICAgY29uc3QgbW92ZWQgPSB0aGlzLmRhdGEucm93c1tmcm9tSWR4XTtcbiAgICAgICAgLy8gUmVtb3ZlIGZyb20gb2xkIHBvc2l0aW9uXG4gICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuZGF0YS5yb3dzW2Zyb21JZHhdO1xuICAgICAgICB0aGlzLm9uUm93RGVsZXRlZENiKHJvdyk7XG4gICAgICAgIGxvZ2dlci5sb2coVFJBQ0UsYHJlbW92aW5nIGlkJHtyb3dJZH0gZnJvbSAke2Zyb21JZHh9YCwgdGhpcy5kYXRhLnJvd3MpO1xuICAgICAgICB0aGlzLmRhdGEucm93cy5zcGxpY2UoZnJvbUlkeCwgMSk7XG5cbiAgICAgICAgbGV0IGluc2VydElkeDogbnVtYmVyO1xuICAgICAgICBpZiAodGFyZ2V0Um93SWQpIHtcbiAgICAgICAgICAgIGluc2VydElkeCA9IHRoaXMuZGF0YS5yb3dzLmZpbmRJbmRleChyID0+IHIuaWQgPT09IHRhcmdldFJvd0lkKTtcbiAgICAgICAgICAgIGlmIChpbnNlcnRJZHggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gdGFyZ2V0Um93SWQgbm90IGZvdW5kLCBpbnNlcnQgYXQgZW5kXG4gICAgICAgICAgICAgICAgaW5zZXJ0SWR4ID0gdGhpcy5kYXRhLnJvd3MubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU2V0IGZvbGRlcklkIHRvIG1hdGNoIHRoZSB0YXJnZXQgcm93XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRSb3cgPSB0aGlzLmRhdGEucm93c1tpbnNlcnRJZHhdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPbmx5IGluc2VydCBhZnRlciBpZiBtb3ZpbmcgZG93biBidXQgb25seSBpbnNpZGUgYSBmb2xkZXJcbiAgICAgICAgICAgIGlmIChmcm9tSWR4IDw9IGluc2VydElkeCAmJiBtb3ZlZC5mb2xkZXJJZCA9PT0gdGFyZ2V0Um93Py5mb2xkZXJJZCkgaW5zZXJ0SWR4Kys7XG4gICAgICAgICAgICBtb3ZlZC5mb2xkZXJJZCA9IHRhcmdldFJvdz8uZm9sZGVySWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBObyB0YXJnZXRSb3dJZDogaW5zZXJ0IGF0IGVuZFxuICAgICAgICAgICAgaW5zZXJ0SWR4ID0gdGhpcy5kYXRhLnJvd3MubGVuZ3RoO1xuICAgICAgICAgICAgLy8gT3B0aW9uYWxseSwgc2V0IGZvbGRlcklkIHRvIHVuZGVmaW5lZCBvciBrZWVwIGFzIGlzXG4gICAgICAgICAgICAvLyBtb3ZlZC5mb2xkZXJJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIubG9nKFRSQUNFLGBJbnNlcnRpbmcgbW92ZWQgcm93IGlkJHtyb3dJZH0gYXQgJHtpbnNlcnRJZHh9YCwgdGhpcy5kYXRhLnJvd3MpO1xuICAgICAgICB0aGlzLmRhdGEucm93cy5zcGxpY2UoaW5zZXJ0SWR4LCAwLCBtb3ZlZCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYih0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgICBwcml2YXRlIG1vdmVSb3dUb0ZvbGRlcihyb3dJZDogc3RyaW5nLCBmb2xkZXJJZDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGZyb21JZHggPSB0aGlzLmRhdGEucm93cy5maW5kSW5kZXgociA9PiByLmlkID09PSByb3dJZCk7XG4gICAgICAgIGlmIChmcm9tSWR4ID09PSAtMSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IG1vdmVkID0gdGhpcy5kYXRhLnJvd3NbZnJvbUlkeF07XG4gICAgICAgIC8vIFJlbW92ZSBmcm9tIG9sZCBwb3NpdGlvblxuICAgICAgICB0aGlzLmRhdGEucm93cy5zcGxpY2UoZnJvbUlkeCwgMSk7XG5cbiAgICAgICAgLy8gU2V0IG5ldyBmb2xkZXJJZFxuICAgICAgICBtb3ZlZC5mb2xkZXJJZCA9IGZvbGRlcklkO1xuXG4gICAgICAgIC8vIEluc2VydCBhdCB0aGUgZW5kIG9mIHRoZSBuZXcgZm9sZGVyIG9yIHJvb3RcbiAgICAgICAgdGhpcy5kYXRhLnJvd3MucHVzaChtb3ZlZCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYih0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgICBwcml2YXRlIG1vdmVGb2xkZXJUb0ZvbGRlcihmb2xkZXJJZDogc3RyaW5nLCB0YXJnZXRGb2xkZXJJZDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChmb2xkZXJJZCA9PT0gdGFyZ2V0Rm9sZGVySWQpIHJldHVybjsgLy8gRG9uJ3QgbW92ZSBvbnRvIGl0c2VsZlxuICAgICAgICBjb25zdCBmcm9tSWR4ID0gdGhpcy5kYXRhLmZvbGRlcnMuZmluZEluZGV4KGYgPT4gZi5pZCA9PT0gZm9sZGVySWQpO1xuICAgICAgICBpZiAoZnJvbUlkeCA9PT0gLTEpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1vdmVkID0gdGhpcy5kYXRhLmZvbGRlcnNbZnJvbUlkeF07XG4gICAgICAgIC8vIFJlbW92ZSBmcm9tIG9sZCBwb3NpdGlvblxuICAgICAgICB0aGlzLmRhdGEuZm9sZGVycy5zcGxpY2UoZnJvbUlkeCwgMSk7XG5cbiAgICAgICAgLy8gU2V0IG5ldyBwYXJlbnRJZFxuICAgICAgICBtb3ZlZC5wYXJlbnRJZCA9IHRhcmdldEZvbGRlcklkO1xuXG4gICAgICAgIC8vIEluc2VydCBhdCB0aGUgZW5kIG9mIHRoZSBuZXcgZm9sZGVyIG9yIHJvb3RcbiAgICAgICAgdGhpcy5kYXRhLmZvbGRlcnMucHVzaChtb3ZlZCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYih0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgICBwcml2YXRlIHByb3BhZ2F0ZUZvbGRlckRpc2FibGVkKGZvbGRlcklkOiBzdHJpbmcsIGRpc2FibGVkOiBib29sZWFuKSB7XG4gICAgICAgIC8vIERpc2FibGUgYWxsIGNoaWxkIGZvbGRlcnNcbiAgICAgICAgZm9yIChjb25zdCBmb2xkZXIgb2YgdGhpcy5kYXRhLmZvbGRlcnMpIHtcbiAgICAgICAgICAgIGlmIChmb2xkZXIucGFyZW50SWQgPT09IGZvbGRlcklkKSB7XG4gICAgICAgICAgICAgICAgZm9sZGVyLmRpc2FibGVkID0gZGlzYWJsZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGVGb2xkZXJEaXNhYmxlZChmb2xkZXIuaWQsIGRpc2FibGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBEaXNhYmxlIGFsbCByb3dzIGluIHRoaXMgZm9sZGVyXG4gICAgICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMuZGF0YS5yb3dzKSB7XG4gICAgICAgICAgICBpZiAocm93LmZvbGRlcklkID09PSBmb2xkZXJJZCkge1xuICAgICAgICAgICAgICAgIHJvdy5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgcmVuZGVyKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdFbC5lbXB0eSgpO1xuXG4gICAgICAgIC8vIC0tLSBSb290IEhlYWRlciBhcyBhIFNldHRpbmcgUm93IC0tLVxuICAgICAgICBjb25zdCBoZWFkZXJTZXR0aW5nID0gbmV3IFNldHRpbmcodGhpcy5zZXR0aW5nRWwpXG4gICAgICAgICAgICAuc2V0Q2xhc3MoXCJGTUEtZm9sZGVyLWxpc3Qtcm9vdC1oZWFkZXJcIik7XG5cbiAgICAgICAgLy8gRHJhZyBoYW5kbGUgcGxhY2Vob2xkZXIgKGZvciBhbGlnbm1lbnQpXG4gICAgICAgIGhlYWRlclNldHRpbmcuc2V0dGluZ0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiRk1BLWZvbGRlci1saXN0LWRyYWctaGFuZGxlXCIsIHRleHQ6IFwiIFwiIH0pO1xuICAgICAgICBoZWFkZXJTZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5ib3JkZXJUb3AgPSBcIjFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcilcIjsgLy8gQWRkIGJvdHRvbSBib3JkZXIgZm9yIHNlcGFyYXRpb25cbiAgICAgICAgaGVhZGVyU2V0dGluZy5zZXR0aW5nRWwuc3R5bGUucGFkZGluZyA9IFwiMC43NWVtIDBcIjsgLy8gQWRkIHNvbWUgcGFkZGluZyBmb3IgYmV0dGVyIHNwYWNpbmdcblxuICAgICAgICAvLyBUaXRsZSAoY291bGQgYmUgXCJSb290XCIgb3IgeW91ciBjdXN0b20gbGFiZWwpXG4gICAgICAgIGhlYWRlclNldHRpbmcuc2V0TmFtZSh0aGlzLnRpdGxlIHx8IFwiXCIpO1xuICAgICAgICBoZWFkZXJTZXR0aW5nLnNldERlc2ModGhpcy5kZXNjcmlwdGlvbiB8fCBcIlwiKTtcblxuICAgICAgICAvLyBGaWx0ZXIgaW5wdXQgKGlubGluZSwgbGVmdCBvZiBidXR0b25zKVxuICAgICAgICBjb25zdCBmaWx0ZXJJbnB1dCA9IG5ldyBTZWFyY2hDb21wb25lbnQoaGVhZGVyU2V0dGluZy5jb250cm9sRWwpO1xuICAgICAgICBmaWx0ZXJJbnB1dC5zZXRQbGFjZWhvbGRlcihcIkZpbHRlciBmb2xkZXJzL3Jvd3MuLi5cIik7XG4gICAgICAgIGZpbHRlcklucHV0LnNldFZhbHVlKHRoaXMuZmlsdGVyKTtcbiAgICAgICAgZmlsdGVySW5wdXQuaW5wdXRFbC5zdHlsZS53aWR0aCA9IFwiMjAwcHhcIjtcbiAgICAgICAgZmlsdGVySW5wdXQub25DaGFuZ2UoKHZhbCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXIgPSB2YWw7XG4gICAgICAgICAgICAvLyBPbmx5IHJlLXJlbmRlciB0aGUgcm93cy9mb2xkZXJzLCBub3QgdGhlIHdob2xlIFVJXG4gICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKTtcbiAgICAgICAgfSk7IFxuXG4gICAgICAgIC8vIEFkZCByb3cgYnV0dG9uIChyaWdodClcbiAgICAgICAgaGVhZGVyU2V0dGluZy5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xuICAgICAgICAgICAgYnRuLnNldEljb24oXCJwbHVzLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIHJvdyB0byByb290XCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFJvdyh1bmRlZmluZWQsIFtdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIGZvbGRlciBidXR0b24gKHJpZ2h0KVxuICAgICAgICBoZWFkZXJTZXR0aW5nLmFkZEV4dHJhQnV0dG9uKGJ0biA9PiB7XG4gICAgICAgICAgICBidG4uc2V0SWNvbihcImZvbGRlclwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIGZvbGRlciB0byByb290XCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEZvbGRlcih0aGlzLmdldE5leHRGb2xkZXJOYW1lKCksIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaGVhZGVyU2V0dGluZy5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xuICAgICAgICAgICAgYnRuLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRHJvcCBoZXJlIHRvIGRlbGV0ZSByb3cgb3IgZm9sZGVyXCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRGVsZXRlQnRDYigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodGhpcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGJpbkVsID0gYnRuLmV4dHJhU2V0dGluZ3NFbDtcblxuICAgICAgICAgICAgYmluRWwuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGJpbkVsLmNsYXNzTGlzdC5hZGQoXCJGTUEtYmluLWRyb3AtdGFyZ2V0XCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBiaW5FbC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2xlYXZlXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgYmluRWwuY2xhc3NMaXN0LnJlbW92ZShcIkZNQS1iaW4tZHJvcC10YXJnZXRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJpbkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGJpbkVsLmNsYXNzTGlzdC5yZW1vdmUoXCJGTUEtYmluLWRyb3AtdGFyZ2V0XCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBlLmRhdGFUcmFuc2Zlcj8uZ2V0RGF0YShcInRleHQvcGxhaW5cIik7XG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm47XG4gICAgICAgICAgICAgICAgY29uc3QgeyB0eXBlLCBpZCB9ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJyb3dcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEucm93cyA9IHRoaXMuZGF0YS5yb3dzLmZpbHRlcihyID0+IHIuaWQgIT09IGlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZm9sZGVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVGb2xkZXJBbmRDb250ZW50cyhpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2VDYih0aGlzLmRhdGEpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIGV4dHJhIGJ1dHRvbnMgdG8gdGhlIGhlYWRlclxuICAgICAgICB0aGlzLmV4dHJhQnV0dG9uQ2JzLmZvckVhY2goY2IgPT4ge1xuICAgICAgICAgICAgY2IoaGVhZGVyU2V0dGluZyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuXG5cbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckxpc3QoKSB7XG4gICAgICAgIC8vIFJlbW92ZSBvbGQgbGlzdCAoYnV0IGtlZXAgaGVhZGVyL2ZpbHRlcilcbiAgICAgICAgY29uc3Qgb2xkTGlzdCA9IHRoaXMuc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoXCIuRk1BLWZvbGRlci1saXN0LWNvbnRlbnRcIik7XG4gICAgICAgIGlmIChvbGRMaXN0KSBvbGRMaXN0LnJlbW92ZSgpO1xuXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuc2V0dGluZ0VsLmNyZWF0ZURpdih7IGNsczogXCJGTUEtZm9sZGVyLWxpc3QtY29udGVudFwiIH0pO1xuICAgICAgICB0aGlzLnJlbmRlckZvbGRlcih1bmRlZmluZWQsIGxpc3RFbCwgMCk7XG4gICAgICAgIHRoaXMucmVuZGVyUm93cyh1bmRlZmluZWQsIGxpc3RFbCwgMCk7XG5cbiAgICAgICAgLy8gUmVuZGVyIGEgZHJvcCB6b25lIGF0IHRoZSBlbmQgb2YgdGhlIGZvbGRlciBsaXN0XG4gICAgICAgIGNvbnN0IGRyb3Bab25lID0gbmV3IFNldHRpbmcobGlzdEVsKSAvLyA8LS0gQ0hBTkdFRCBmcm9tIHRoaXMuc2V0dGluZ0VsIHRvIGxpc3RFbFxuICAgICAgICAgICAgLnNldENsYXNzKFwiRk1BLWZvbGRlci1saXN0LWRyb3Atem9uZVwiKTtcbiAgICAgICAgZHJvcFpvbmUuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4gdGhpcy5vbkRyYWdPdmVyKGUsIFwicm9vdFwiLCBcImZvbGRlci1kcm9wem9uZVwiKSk7XG4gICAgICAgIGRyb3Bab25lLnNldHRpbmdFbC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBtdWx0aXBsZSBldmVudHNcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBlLmRhdGFUcmFuc2Zlcj8uZ2V0RGF0YShcInRleHQvcGxhaW5cIik7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgaWQgfSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJyb3dcIikge1xuICAgICAgICAgICAgICAgIC8vIE1vdmUgcm93IHRvIHRoaXMgZm9sZGVyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlUm93VG9Gb2xkZXIoaWQsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZm9sZGVyXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBNb3ZlIGZvbGRlciB0byB0aGlzIGZvbGRlclxuICAgICAgICAgICAgICAgIHRoaXMubW92ZUZvbGRlclRvRm9sZGVyKGlkLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZHJvcFpvbmUuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBkcm9wWm9uZS5zZXR0aW5nRWwuY2xhc3NMaXN0LmFkZChcIkZNQS1kcm9wem9uZS10YXJnZXRcIik7XG4gICAgICAgIH0pO1xuICAgICAgICBkcm9wWm9uZS5zZXR0aW5nRWwuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGRyb3Bab25lLnNldHRpbmdFbC5jbGFzc0xpc3QucmVtb3ZlKFwiRk1BLWRyb3B6b25lLXRhcmdldFwiKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub25SZW5kZXJlZENiKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJGb2xkZXIocGFyZW50SWQ6IHN0cmluZyB8IHVuZGVmaW5lZCwgcGFyZW50RWw6IEhUTUxFbGVtZW50LCBkZXB0aDogbnVtYmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5kYXRhIHx8ICF0aGlzLmRhdGEuZm9sZGVycykgcmV0dXJuO1xuICAgICAgICBjb25zdCBmb2xkZXJzID0gdGhpcy5kYXRhLmZvbGRlcnMuZmlsdGVyKGYgPT4gZi5wYXJlbnRJZCA9PT0gcGFyZW50SWQpO1xuICAgICAgICBmb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmcgPSBuZXcgU2V0dGluZyhwYXJlbnRFbClcbiAgICAgICAgICAgICAgICAuc2V0Q2xhc3MoXCJGTUEtZm9sZGVyLWxpc3QtZm9sZGVyLXNldHRpbmdcIik7XG5cbiAgICAgICAgICAgIC8vIC0tLSBMRUZUIFNJREU6IERyYWcgaGFuZGxlICsgZWRpdGFibGUgbmFtZSAtLS1cbiAgICAgICAgICAgIHNldHRpbmcubmFtZUVsLmVtcHR5KCk7XG5cbiAgICAgICAgICAgIC8vIEluZGVudCBmb2xkZXJzIGJ5IDIwcHggcGVyIGRlcHRoIChmcmFtZSBhbmQgY29udGVudClcbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLnN0eWxlLm1hcmdpbkxlZnQgPSBgJHtkZXB0aCAqIDIwfXB4YDtcblxuICAgICAgICAgICAgLy8gRHJhZyBoYW5kbGUgKGxlZnQpXG4gICAgICAgICAgICBjb25zdCBkcmFnSGFuZGxlID0gc2V0dGluZy5uYW1lRWwuY3JlYXRlU3Bhbih7IGNsczogXCJGTUEtZm9sZGVyLWxpc3QtZHJhZy1oYW5kbGVcIiB9KTtcbiAgICAgICAgICAgIGRyYWdIYW5kbGUuc2V0VGV4dChcIlx1MjYzMFwiKTtcbiAgICAgICAgICAgIGRyYWdIYW5kbGUuZHJhZ2dhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIGRyYWdIYW5kbGUuc3R5bGUubWFyZ2luUmlnaHQgPSBcIjAuNWVtXCI7XG4gICAgICAgICAgICBkcmFnSGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGUpID0+IHRoaXMub25EcmFnU3RhcnQoZSwgXCJmb2xkZXJcIiwgZm9sZGVyLmlkKSk7XG4gICAgICAgICAgICBkcmFnSGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4gdGhpcy5vbkRyYWdPdmVyKGUsIFwiZm9sZGVyXCIsIGZvbGRlci5pZCkpO1xuICAgICAgICAgICAgZHJhZ0hhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZSkgPT4gdGhpcy5vbkRyb3AoZSwgXCJmb2xkZXJcIiwgZm9sZGVyLmlkKSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBjaGVja2JveCBmb3IgZGlzYWJsaW5nIGZvbGRlclxuICAgICAgICAgICAgc2V0dGluZy5hZGRUb2dnbGUodG9nZ2xlID0+IHtcbiAgICAgICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKCFmb2xkZXIuZGlzYWJsZWQpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2xkZXIuZGlzYWJsZWQgPSAhdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGVGb2xkZXJEaXNhYmxlZChmb2xkZXIuaWQsIGZvbGRlci5kaXNhYmxlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodGhpcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLnNldFRvb2x0aXAoXCJEaXNhYmxlIGFsbCBydWxlcyBpbiB0aGlzIGZvbGRlciBhbmQgc3ViZm9sZGVyc1wiKTtcblxuICAgICAgICAgICAgLy8gRWRpdGFibGUgZm9sZGVyIG5hbWVcbiAgICAgICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHNldHRpbmcubmFtZUVsKTtcbiAgICAgICAgICAgIG5hbWVJbnB1dC5zZXRWYWx1ZShmb2xkZXIubmFtZSk7XG4gICAgICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5zdHlsZS5tYXhXaWR0aCA9IFwiMTAwJVwiO1xuICAgICAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuc3R5bGUuYm9yZGVyID0gXCIwXCJcbiAgICAgICAgICAgIG5hbWVJbnB1dC5pbnB1dEVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gXCIwLjVlbVwiO1xuICAgICAgICAgICAgbmFtZUlucHV0Lm9uQ2hhbmdlKCh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICBmb2xkZXIubmFtZSA9IHZhbDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodGhpcy5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyAtLS0gUklHSFQgU0lERTogQWN0aW9uIGJ1dHRvbnMgLS0tXG4gICAgICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKGJ0biA9PiB7XG4gICAgICAgICAgICAgICAgYnRuLnNldEljb24oXCJwbHVzLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkFkZCByb3cgdG8gZm9sZGVyXCIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUm93KGZvbGRlci5pZCwgW10pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKGJ0biA9PiB7XG4gICAgICAgICAgICAgICAgYnRuLnNldEljb24oXCJmb2xkZXJcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJBZGQgc3ViZm9sZGVyXCIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRm9sZGVyKHRoaXMuZ2V0TmV4dEZvbGRlck5hbWUoKSwgZm9sZGVyLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbihidG4gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VkID0gZm9sZGVyLmNvbGxhcHNlZCA/PyBmYWxzZTtcbiAgICAgICAgICAgICAgICBidG4uc2V0SWNvbihpc0NvbGxhcHNlZCA/IFwiY2hldnJvbi1yaWdodFwiIDogXCJjaGV2cm9uLWRvd25cIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoaXNDb2xsYXBzZWQgPyBcIkV4cGFuZFwiIDogXCJDb2xsYXBzZVwiKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2xkZXIuY29sbGFwc2VkID0gIWlzQ29sbGFwc2VkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNiKHRoaXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gSW4gcmVuZGVyRm9sZGVyLCBiZWZvcmUgYWRkaW5nIGV2ZW50IGxpc3RlbmVyczpcbiAgICAgICAgICAgIChzZXR0aW5nLnNldHRpbmdFbCBhcyBhbnkpLl9kcmFnRW50ZXJDb3VudCA9IDA7XG5cbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAoc2V0dGluZy5zZXR0aW5nRWwgYXMgYW55KS5fZHJhZ0VudGVyQ291bnQrKztcbiAgICAgICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QuYWRkKFwiRk1BLWRyb3AtdGFyZ2V0XCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2xlYXZlXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgKHNldHRpbmcuc2V0dGluZ0VsIGFzIGFueSkuX2RyYWdFbnRlckNvdW50LS07XG4gICAgICAgICAgICAgICAgaWYgKChzZXR0aW5nLnNldHRpbmdFbCBhcyBhbnkpLl9kcmFnRW50ZXJDb3VudCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC5yZW1vdmUoXCJGTUEtZHJvcC10YXJnZXRcIik7XG4gICAgICAgICAgICAgICAgICAgIChzZXR0aW5nLnNldHRpbmdFbCBhcyBhbnkpLl9kcmFnRW50ZXJDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERyYWcgZXZlbnRzIGZvciBmb2xkZXIgcm93XG4gICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgKGUpID0+IHRoaXMub25EcmFnT3ZlcihlLCBcImZvbGRlclwiLCBmb2xkZXIuaWQpKTtcbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChlKSA9PiB0aGlzLm9uRHJvcChlLCBcImZvbGRlclwiLCBmb2xkZXIuaWQpKTtcbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgKGUpID0+IHRoaXMub25EcmFnTGVhdmUoZSkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZm9sZGVyLmRpc2FibGVkKSBzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QuYWRkKFwiRk1BLW1vZC1Gb2xkZXJMaXN0LWRpc2FibGVkXCIpO1xuXG4gICAgICAgICAgICAvLyBSZW5kZXIgcm93cyBhbmQgc3ViZm9sZGVyc1xuICAgICAgICAgICAgaWYgKCFmb2xkZXIuY29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJGb2xkZXIoZm9sZGVyLmlkLCBwYXJlbnRFbCwgZGVwdGggKyAxKTsgLy8gc3ViZm9sZGVyc1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUm93cyhmb2xkZXIuaWQsIHBhcmVudEVsLCBkZXB0aCArIDEpOyAvLyByb3dzIGluIHRoaXMgZm9sZGVyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyUm93cyhmb2xkZXJJZDogc3RyaW5nIHwgdW5kZWZpbmVkLCBwYXJlbnRFbDogSFRNTEVsZW1lbnQsIGRlcHRoOiBudW1iZXIpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEgfHwgIXRoaXMuZGF0YS5yb3dzKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHJvd3MgPSB0aGlzLmRhdGEucm93cy5maWx0ZXIociA9PiByLmZvbGRlcklkID09PSBmb2xkZXJJZCAmJiB0aGlzLnJvd01hdGNoZXNGaWx0ZXIocikpO1xuICAgICAgICByb3dzLmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmcgPSBuZXcgU2V0dGluZyhwYXJlbnRFbClcbiAgICAgICAgICAgICAgICAuc2V0Q2xhc3MoXCJGTUEtZm9sZGVyLWxpc3Qtcm93LXNldHRpbmdcIik7XG5cbiAgICAgICAgICAgIC8vIC0tLSBMRUZUIFNJREU6IERyYWcgaGFuZGxlICsga2V5d29yZHMgLS0tXG4gICAgICAgICAgICBzZXR0aW5nLm5hbWVFbC5lbXB0eSgpO1xuXG4gICAgICAgICAgICAvLyBJbmRlbnQgcm93cyBieSAyMHB4IHBlciBkZXB0aCAoZnJhbWUgYW5kIGNvbnRlbnQpXG4gICAgICAgICAgICBzZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5tYXJnaW5MZWZ0ID0gYCR7ZGVwdGggKiAyMH1weGA7XG4gICAgICAgICAgICBpZiAoc2V0dGluZy5uYW1lRWwucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHNldHRpbmcubmFtZUVsLnBhcmVudEVsZW1lbnQuc3R5bGUubWFyZ2luSW5saW5lRW5kID0gXCIwcHhcIjtcbiAgICAgICAgICAgICAgICBzZXR0aW5nLm5hbWVFbC5wYXJlbnRFbGVtZW50LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG4gICAgICAgICAgICAgICAgc2V0dGluZy5uYW1lRWwucGFyZW50RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG4gICAgICAgICAgICAgICAgc2V0dGluZy5uYW1lRWwucGFyZW50RWxlbWVudC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gXCJjb2x1bW5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldHRpbmcubmFtZUVsLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbiAgICAgICAgICAgIHNldHRpbmcubmFtZUVsLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cbiAgICAgICAgICAgIC8vIERyYWcgaGFuZGxlIChsZWZ0KVxuICAgICAgICAgICAgY29uc3QgZHJhZ0hhbmRsZSA9IHNldHRpbmcubmFtZUVsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiRk1BLWZvbGRlci1saXN0LWRyYWctaGFuZGxlXCIgfSk7XG4gICAgICAgICAgICBkcmFnSGFuZGxlLnNldFRleHQoXCJcdTIyNjFcIik7XG4gICAgICAgICAgICBkcmFnSGFuZGxlLmRyYWdnYWJsZSA9IHRydWU7XG4gICAgICAgICAgICBkcmFnSGFuZGxlLnN0eWxlLm1hcmdpblJpZ2h0ID0gXCIwLjVlbVwiO1xuICAgICAgICAgICAgZHJhZ0hhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIChlKSA9PiB0aGlzLm9uRHJhZ1N0YXJ0KGUsIFwicm93XCIsIHJvdy5pZCkpO1xuICAgICAgICAgICAgZHJhZ0hhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgKGUpID0+IHRoaXMub25EcmFnT3ZlcihlLCBcInJvd1wiLCByb3cuaWQpKTtcbiAgICAgICAgICAgIGRyYWdIYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgKGUpID0+IHRoaXMub25Ecm9wKGUsIFwicm93XCIsIHJvdy5pZCkpO1xuXG4gICAgICAgICAgICBpZiAocm93LmRpc2FibGVkKSBzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcIkZNQS1tb2QtRm9sZGVyTGlzdC1kaXNhYmxlZFwiKTtcbiAgICAgICAgICAgIC8vIFJvdyBjb250ZW50IChjdXN0b21pemFibGUsIGUuZy4ga2V5d29yZHMpXG4gICAgICAgICAgICB0aGlzLnJvd1JlbmRlckNiKHJvdywgc2V0dGluZy5uYW1lRWwpOyAgXG5cbiAgICAgICAgICAgIC8vIERyYWcgZXZlbnRzIGZvciByb3dcbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4gdGhpcy5vbkRyYWdPdmVyKGUsIFwicm93XCIsIHJvdy5pZCkpO1xuICAgICAgICAgICAgc2V0dGluZy5zZXR0aW5nRWwuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgKGUpID0+IHRoaXMub25Ecm9wKGUsIFwicm93XCIsIHJvdy5pZCkpO1xuICAgICAgICAgICAgc2V0dGluZy5zZXR0aW5nRWwuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCAoZSkgPT4gdGhpcy5vbkRyYWdMZWF2ZShlKSk7IC8vIDwtLSBBREQgVEhJUyBMSU5FXG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gLS0tIERyYWcgJiBEcm9wIEhhbmRsZXJzIChzaW1wbGlmaWVkLCBleHBhbmQgYXMgbmVlZGVkKSAtLS1cbiAgICBwcml2YXRlIG9uRHJhZ1N0YXJ0KGU6IERyYWdFdmVudCwgdHlwZTogRk1BRm9sZGVyTGlzdERyYWdUYXJnZXQsIGlkOiBzdHJpbmcpIHtcbiAgICAgICAgZS5kYXRhVHJhbnNmZXI/LnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIEpTT04uc3RyaW5naWZ5KHsgdHlwZSwgaWQgfSkpO1xuICAgIH1cbiAgICBwcml2YXRlIG9uRHJhZ092ZXIoZTogRHJhZ0V2ZW50LCB0eXBlOiBGTUFGb2xkZXJMaXN0RHJhZ1RhcmdldCwgaWQ6IHN0cmluZykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGUuY3VycmVudFRhcmdldCBhcyBIVE1MRWxlbWVudDtcblxuICAgICAgICAvLyBQcmV2ZW50IGRyYWdnaW5nIGZvbGRlcnMgb250byByb3dzXG4gICAgICAgIGNvbnN0IGRhdGEgPSBlLmRhdGFUcmFuc2Zlcj8uZ2V0RGF0YShcInRleHQvcGxhaW5cIik7XG4gICAgICAgIGlmICh0eXBlID09PSBcInJvd1wiICYmIGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgdHlwZTogZHJhZ1R5cGUgfSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICBpZiAoZHJhZ1R5cGUgPT09IFwiZm9sZGVyXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBEb24ndCBhbGxvdyBmb2xkZXIgZHJvcCBvbiByb3dcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb2xkZXIgaGlnaGxpZ2h0XG4gICAgICAgIGlmICh0eXBlID09PSBcImZvbGRlclwiKSB7XG4gICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZChcIkZNQS1kcm9wLXRhcmdldFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJvdzogc2hvdyBhYm92ZS9iZWxvdyBpbmRpY2F0b3JcbiAgICAgICAgaWYgKHR5cGUgPT09IFwicm93XCIpIHtcbiAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKFwiRk1BLWRyb3AtdGFyZ2V0XCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkRyYWdMZWF2ZShlOiBEcmFnRXZlbnQpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcIkZNQS1kcm9wLXRhcmdldFwiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRHJvcChlOiBEcmFnRXZlbnQsIHR5cGU6IEZNQUZvbGRlckxpc3REcmFnVGFyZ2V0LCB0YXJnZXRJZDogc3RyaW5nKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBtdWx0aXBsZSBldmVudHNcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcIkZNQS1kcm9wLXRhcmdldFwiKTtcblxuICAgICAgICBjb25zdCBkYXRhID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpO1xuICAgICAgICBpZiAoIWRhdGEpIHJldHVybjtcbiAgICAgICAgY29uc3QgeyB0eXBlOiBkcmFnVHlwZSwgaWQ6IGRyYWdJZCB9ID0gSlNPTi5wYXJzZShkYXRhKTtcblxuICAgICAgICBpZiAoZHJhZ1R5cGUgPT09IFwicm93XCIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcImZvbGRlclwiKSB7XG4gICAgICAgICAgICAgICAgLy8gTW92ZSByb3cgdG8gdGhpcyBmb2xkZXJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVSb3dUb0ZvbGRlcihkcmFnSWQsIHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJyb3dcIikge1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVJvdyhkcmFnSWQsIHRhcmdldElkKTsgLy8gTW92ZSByb3cgdG8gbmV3IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJvcHBpbmcgb24gdGhlIGRyb3Agem9uZSBhdCB0aGUgZW5kXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJyb290XCIgJiYgdGFyZ2V0SWQgPT09IFwicm93LWRyb3B6b25lXCIpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZHJhZ1R5cGUgPT09IFwiZm9sZGVyXCIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcImZvbGRlclwiKSB7XG4gICAgICAgICAgICAgICAgLy8gTW92ZSBmb2xkZXIgdG8gdGhpcyBmb2xkZXJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVGb2xkZXJUb0ZvbGRlcihkcmFnSWQsIHRhcmdldElkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEcm9wcGluZyBvbiB0aGUgZHJvcCB6b25lIGF0IHRoZSBlbmRcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcInJvb3RcIiAmJiB0YXJnZXRJZCA9PT0gXCJmb2xkZXItZHJvcHpvbmVcIikge1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZUZvbGRlclRvRm9sZGVyKGRyYWdJZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHJvd01hdGNoZXNGaWx0ZXIocm93OiBUcmVlSGllcmFyY2h5Um93KTogYm9vbGVhbiB7XG4gICAgICAgIGlmICghdGhpcy5maWx0ZXIpIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gcm93LmtleXdvcmRzLnNvbWUoayA9PiBrLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGhpcy5maWx0ZXIudG9Mb3dlckNhc2UoKSkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0TmV4dEZvbGRlck5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGkgPSAxO1xuICAgICAgICBsZXQgbmFtZSA6IHN0cmluZztcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgbmFtZSA9IGBGb2xkZXIgJHtpKyt9YDtcbiAgICAgICAgfSB3aGlsZSAodGhpcy5kYXRhLmZvbGRlcnMuc29tZShmID0+IGYubmFtZSA9PT0gbmFtZSkpO1xuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRlbGV0ZUZvbGRlckFuZENvbnRlbnRzKGZvbGRlcklkOiBzdHJpbmcpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBzdWJmb2xkZXJzIGFuZCByb3dzIHJlY3Vyc2l2ZWx5XG4gICAgICAgIGNvbnN0IHN1YmZvbGRlcnMgPSB0aGlzLmRhdGEuZm9sZGVycy5maWx0ZXIoZiA9PiBmLnBhcmVudElkID09PSBmb2xkZXJJZCk7XG4gICAgICAgIHN1YmZvbGRlcnMuZm9yRWFjaChmID0+IHRoaXMuZGVsZXRlRm9sZGVyQW5kQ29udGVudHMoZi5pZCkpO1xuXG4gICAgICAgIC8vIENhbGwgb25Sb3dEZWxldGVkQ2IgZm9yIGVhY2ggcm93IGluIHRoaXMgZm9sZGVyXG4gICAgICAgIGNvbnN0IHJvd3NUb0RlbGV0ZSA9IHRoaXMuZGF0YS5yb3dzLmZpbHRlcihyID0+IHIuZm9sZGVySWQgPT09IGZvbGRlcklkKTtcbiAgICAgICAgcm93c1RvRGVsZXRlLmZvckVhY2gocm93ID0+IHRoaXMub25Sb3dEZWxldGVkQ2Iocm93KSk7XG5cbiAgICAgICAgdGhpcy5kYXRhLmZvbGRlcnMgPSB0aGlzLmRhdGEuZm9sZGVycy5maWx0ZXIoZiA9PiBmLmlkICE9PSBmb2xkZXJJZCk7XG4gICAgICAgIHRoaXMuZGF0YS5yb3dzID0gdGhpcy5kYXRhLnJvd3MuZmlsdGVyKHIgPT4gci5mb2xkZXJJZCAhPT0gZm9sZGVySWQpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgcmVhZCB9IGZyb20gXCJmc1wiO1xyXG5pbXBvcnQgeyBNb2RhbCwgTWFya2Rvd25SZW5kZXJlciwgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCAqIGFzIHBhdGggZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IHsgRVJST1IsIGxvZ2dlciB9IGZyb20gXCIuL0xvZ1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1hcmtkb3duSGVscE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgbWFya2Rvd246IHN0cmluZyA9IFwiXCI7XHJcbiAgICBzb3VyY2VQYXRoOiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgYXBwOiBBcHA7XHJcbiAgICBwbHVnaW46IGFueTtcclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IGFueSwgbWFya2Rvd246IHN0cmluZywgc291cmNlUGF0aDogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLm1hcmtkb3duID0gbWFya2Rvd247XHJcbiAgICAgICAgdGhpcy5zb3VyY2VQYXRoID0gc291cmNlUGF0aDtcclxuICAgIH1cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCwgbW9kYWxFbCB9ID0gdGhpcztcclxuICAgICAgICBtb2RhbEVsLmFkZENsYXNzKFwiRk1BLW1hcmtkb3duLWhlbHAtbW9kYWwtLXdpZGVcIik7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy5tYXJrZG93biA9IGF3YWl0IHRoaXMucmVhZFBsdWdpbkRvY0ZpbGUodGhpcy5zb3VyY2VQYXRoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBsb2dnZXIubG9nKEVSUk9SLFwiRXJyb3IgbG9hZGluZyBtYXJrZG93bjpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgICB0aGlzLm1hcmtkb3duID0gXCJDb3VsZCBub3QgbG9hZCBkb2N1bWVudGF0aW9uIGZpbGU6IFwiICsgdGhpcy5zb3VyY2VQYXRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIodGhpcy5hcHAsIHRoaXMubWFya2Rvd24sIGNvbnRlbnRFbCwgdGhpcy5zb3VyY2VQYXRoLCB0aGlzKTtcclxuXHJcbiAgICAgICAgY29udGVudEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2dC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PT0gXCJBXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhyZWYgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChocmVmICYmIGhyZWYuZW5kc1dpdGgoXCIubWRcIikgJiYgIWhyZWYubWF0Y2goL15odHRwcz86XFwvXFwvLykgJiYgIWhyZWYuc3RhcnRzV2l0aChcIi9cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RGlyID0gdGhpcy5zb3VyY2VQYXRoID8gcGF0aC5kaXJuYW1lKHRoaXMuc291cmNlUGF0aCkgOiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNvbHZlZFBhdGggPSBwYXRoLm5vcm1hbGl6ZShwYXRoLmpvaW4oY3VycmVudERpciwgaHJlZikpLnJlcGxhY2UoL1xcXFwvZywgXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdNYXJrZG93biA9IGF3YWl0IHRoaXMucmVhZFBsdWdpbkRvY0ZpbGUocmVzb2x2ZWRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrZG93biA9IG5ld01hcmtkb3duO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVBhdGggPSByZXNvbHZlZFBhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHRoaXMuYXBwLCB0aGlzLm1hcmtkb3duLCBjb250ZW50RWwsIHRoaXMuc291cmNlUGF0aCwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJDb3VsZCBub3QgbG9hZDogXCIgKyBocmVmIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGZldGNoTWFya2Rvd25Gcm9tR2l0SHViKHVybDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGxvYWQgZmlsZSBmcm9tIEdpdEh1YlwiKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJlYWRQbHVnaW5Eb2NGaWxlKGZpbGVuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgICAgIC8vIGNvbnN0IHZhdWx0Um9vdCA9ICh0aGlzLmFwcC52YXVsdC5hZGFwdGVyIGFzIGFueSkuYmFzZVBhdGggYXMgc3RyaW5nO1xyXG4gICAgICAgIGNvbnN0IHBsdWdpbklkID0gdGhpcy5wbHVnaW4ubWFuaWZlc3QuaWQ7XHJcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLnBvc2l4LmpvaW4oJy5vYnNpZGlhbicsICdwbHVnaW5zJywgcGx1Z2luSWQsICdkb2MnLCBmaWxlbmFtZSk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChmaWxlUGF0aCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byByZWFkIGZpbGUgJyR7ZmlsZVBhdGh9JzogJHttZXNzYWdlfWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBTZXR0aW5nLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5cclxuLyoqXHJcbiAqIEEgcnVsZSBjbGFzcyB0aGF0IGFkZHMgYSBjb25maWd1cmFibGUgcHJlZml4IHRvIGFuIGlucHV0IHZhbHVlLlxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogVGhpcyBydWxlIGlzIGludGVuZGVkIGZvciB1c2UgaW4gZm9ybWF0dGluZyBvcGVyYXRpb25zLCBzdWNoIGFzIGFkZGluZyBhIHByZWZpeCB0byB0ZXh0LCB0YWdzLCBhbGlhc2VzLCBvciBtdWx0aS10ZXh0IGZpZWxkcy5cclxuICogVGhlIHByZWZpeCB2YWx1ZSBpcyBjb25maWd1cmFibGUgdmlhIHRoZSBwbHVnaW4ncyBzZXR0aW5ncyBVSS5cclxuICogXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIFVzYWdlIGluIGEgZm9ybWF0dGluZyBwaXBlbGluZTpcclxuICogY29uc3QgcmVzdWx0ID0gcnVsZUFkZFByZWZpeC5meChhcHAsIGZpbGUsIHRvb2xzLCBcImV4YW1wbGVcIik7XHJcbiAqIC8vIElmIHByZWZpeCBpcyBzZXQgdG8gXCJwcmUtXCIsIHJlc3VsdCB3aWxsIGJlIFwicHJlLWV4YW1wbGVcIlxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoJ2FkZFByZWZpeCcpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIHNob3J0IGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHJ1bGUgZG9lcy5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgcnVsZSAoJ2Zvcm1hdHRlcicpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIGZvciB0aGUgcnVsZSBhcyBhIHN0cmluZy5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBmaWVsZHMgdGhpcyBydWxlIGNhbiBiZSBhcHBsaWVkIHRvLlxyXG4gKiBAcHJvcGVydHkge2FueX0gY29uZmlnRWxlbWVudHMgLSBUaGUgY29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIEFkZHMgdGhlIGNvbmZpZ3VyZWQgcHJlZml4IHRvIHRoZSBwcm92aWRlZCBpbnB1dCB2YWx1ZS5cclxuICogXHJcbiAqIEBtZXRob2QgY29uZmlnVGFiXHJcbiAqIFJlbmRlcnMgdGhlIGNvbmZpZ3VyYXRpb24gVUkgZm9yIHNldHRpbmcgdGhlIHByZWZpeCB2YWx1ZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQWRkUHJlZml4IGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnYWRkUHJlZml4JztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnQWRkIGEgUHJlZml4JztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0FkZHMgYSBwcmVmaXggdG8gdGhlIGlucHV0IHZhbHVlLic7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdmb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0PzphbnkpIHsgLy8gRGVmYXVsdCBmdW5jdGlvbiBzaWduYXR1cmVcclxuICAgICAgICBjb25zdCBwcmVmaXggPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwgJ3ByZWZpeCcpO1xyXG4gICAgICAgIHJldHVybiBgJHtwcmVmaXh9JHtpbnB1dH1gOyAvLyBSZXR1cm4gdGhlIGlucHV0IHdpdGggYSBwcmVmaXggYWRkZWRcclxuICAgIH07XHJcblxyXG4gICAgY29uZmlnVGFiKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDogYW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICBvcHRpb25FTC5lbXB0eSgpO1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHNldHRpbmcgZm9yIHRoZSBzbWFsbCB3b3Jkc1xyXG4gICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnRGVmYXVsdHMocnVsZS5pZCwge1xyXG4gICAgICAgICAgICBwcmVmaXggOiAnJywgLy8gRGVmYXVsdCBwcmVmaXhcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1ByZWZpeCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbnRlciBhIHByZWZpeCB0byBiZSBhZGRlZCBhdCB0aGUgYmVnaW5uaW5nLicpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdlLmcuIFwicHJlLVwiJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwncHJlZml4JykgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwncHJlZml4JywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9O1xyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEFwcCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuLyoqXHJcbiAqIEEgcnVsZSBjbGFzcyB0aGF0IGFwcGVuZHMgYSBjb25maWd1cmFibGUgc3VmZml4IHRvIHRoZSBpbnB1dCB2YWx1ZS5cclxuICogXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgcnVsZSBpcyBpbnRlbmRlZCBmb3IgdXNlIHdpdGhpbiB0aGUgRm9sZGVyIHRvIFRhZ3MgcGx1Z2luLCBhbGxvd2luZyB1c2VycyB0byBmb3JtYXQgdGV4dCwgdGFncywgYWxpYXNlcywgb3IgbXVsdGl0ZXh0IGZpZWxkcyBieSBhZGRpbmcgYSBzcGVjaWZpZWQgc3VmZml4LlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogLy8gVXNhZ2UgaW4gYSBydWxlIGNoYWluXHJcbiAqIGNvbnN0IHJlc3VsdCA9IHJ1bGVBZGRTdWZmaXguZngoYXBwLCBmaWxlLCB0b29scywgXCJub3RlXCIpO1xyXG4gKiAvLyBJZiBzdWZmaXggaXMgXCJfZG9uZVwiLCByZXN1bHQgd2lsbCBiZSBcIm5vdGVfZG9uZVwiXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlIChcImFkZFN1ZmZpeFwiKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIHB1cnBvc2UuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHJ1bGUgKFwiZm9ybWF0dGVyXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIGZvciB0aGUgcnVsZSBhcyBhIHN0cmluZy5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBmaWVsZHMgdGhpcyBydWxlIGNhbiBiZSBhcHBsaWVkIHRvLlxyXG4gKiBAcHJvcGVydHkge2FueX0gY29uZmlnRWxlbWVudHMgLSBUaGUgY29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIEFwcGVuZHMgdGhlIGNvbmZpZ3VyZWQgc3VmZml4IHRvIHRoZSBwcm92aWRlZCBpbnB1dCB2YWx1ZS5cclxuICogXHJcbiAqIEBtZXRob2QgY29uZmlnVGFiXHJcbiAqIFJlbmRlcnMgdGhlIGNvbmZpZ3VyYXRpb24gVUkgZm9yIHNldHRpbmcgdGhlIHN1ZmZpeCBpbiB0aGUgcGx1Z2luJ3Mgc2V0dGluZ3MgdGFiLlxyXG4gKiBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQWRkU3VmZml4IGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnYWRkU3VmZml4JztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnQWRkIGEgU3VmZml4JztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0FkZHMgYSBzdWZmaXggdG8gdGhlIGlucHV0IHZhbHVlLic7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdmb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0PzphbnkpIHsgLy8gRGVmYXVsdCBmdW5jdGlvbiBzaWduYXR1cmVcclxuICAgICAgICBjb25zdCBzdWZmaXggPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwgJ3N1ZmZpeCcpO1xyXG4gICAgICAgIHJldHVybiBgJHtpbnB1dH0ke3N1ZmZpeH1gOyAvLyBSZXR1cm4gdGhlIGlucHV0IHdpdGggYSBzdWZmaXggYWRkZWRcclxuICAgIH07XHJcblxyXG4gICAgY29uZmlnVGFiKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDogYW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICBvcHRpb25FTC5lbXB0eSgpO1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHNldHRpbmcgZm9yIHRoZSBzbWFsbCB3b3Jkc1xyXG4gICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnRGVmYXVsdHMocnVsZS5pZCwge1xyXG4gICAgICAgICAgICBzdWZmaXggOiAnJywgLy8gRGVmYXVsdCBzdWZmaXhcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1N1ZmZpeCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbnRlciBhIHN1ZmZpeCB0byBiZSBhZGRlZCBhdCB0aGUgZW5kLicpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdlLmcuIFwiX2RvbmVcIicpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3N1ZmZpeCcpIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3N1ZmZpeCcsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgU2VhcmNoQ29tcG9uZW50LCBTZXR0aW5nLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBGb2xkZXJTdWdnZXN0IH0gZnJvbSBcIi4uL3N1Z2dlc3RlcnMvRm9sZGVyU3VnZ2VzdGVyXCI7XHJcbmltcG9ydCB7IERpcmVjdG9yeVNlbGVjdGlvblJlc3VsdCwgb3BlbkRpcmVjdG9yeVNlbGVjdGlvbk1vZGFsIH0gZnJvbSBcIi4uL2RpcmVjdG9yeVNlbGVjdGlvbk1vZGFsXCI7XHJcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcIi4uL3N1Z2dlc3RlcnMvRmlsZVN1Z2dlc3RlclwiO1xyXG5pbXBvcnQgeyBBbGVydE1vZGFsIH0gZnJvbSBcIi4uL2FsZXJ0Qm94XCI7XHJcbmltcG9ydCB7IEVSUk9SLCBsb2dnZXIgfSBmcm9tIFwiLi4vTG9nXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUnVsZUF1dG9tYXRpb25BdXRvTGluayBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2F1dG9MaW5rJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnQXV0byBMaW5rIChhZHZhbmNlZCknO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ2hlY2tzIGlmIGEgbGluayBleGlzdHMgaW4gYSBzcGVjaWZpZWQgZm9sZGVyLiBJZiBub3QsIGl0IGNyZWF0ZXMgYSBuZXcgZmlsZSBiYXNlZCBvbiBhIHNwZWNpZmllZCB0ZW1wbGF0ZSBhbmQgYWRkcyBhIGxpbmsgdG8gaXQuJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2F1dG9tYXRpb24nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe3JlbW92ZUNvbnRlbnQ6IGZhbHNlLCAgaW5wdXRQcm9wZXJ0eTogZmFsc2UsIGFkZFByZWZpeDogZmFsc2UsIHNwYWNlUmVwbGFjZW1lbnQ6IGZhbHNlLCBzcGVjaWFsQ2hhcmFjdGVyUmVwbGFjZW1lbnQ6IGZhbHNlLCBjb252ZXJ0VG9Mb3dlckNhc2U6IGZhbHNlLCByZXN1bHRBc0xpbms6IGZhbHNlLCBzY3JpcHQ6IGZhbHNlfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBGdW5jdGlvbiB0byBjcmVhdGUgYSBsaW5rIHRvIGEgZmlsZS4gSWYgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3QsIGl0IGNyZWF0ZXMgYSBuZXcgZmlsZSBiYXNlZCBvbiBhIHRlbXBsYXRlLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBhcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gZmlsZSAtIFRoZSBjdXJyZW50IGZpbGUuXHJcbiAgICAgKiBAcGFyYW0gdG9vbHMgLSBUaGUgc2NyaXB0aW5nIHRvb2xzIGluc3RhbmNlLlxyXG4gICAgICogQHJldHVybnMgVGhlIG5ldyBjb250ZW50IGZvciB0aGUgZnJvbnRtYXR0ZXIgcHJvcGVydHkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGZ4IChhcHA6QXBwLCBmaWxlOlRGaWxlLCB0b29sczpTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBjb25zdCBjdXJyZW50Q29udGVudCA9IHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7XHJcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0b29scy5nZXRSdWxlKCk7XHJcbiAgICAgICAgaWYgKCFydWxlKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsYGF1dG9MaW5rOiBydWxlIG5vdCBmb3VuZCwgcmV0dXJuaW5nIGN1cnJlbnQgY29udGVudCAke2N1cnJlbnRDb250ZW50fWApO1xyXG4gICAgICAgICAgICByZXR1cm4gY3VycmVudENvbnRlbnQ7XHJcbiAgICAgICAgfSBcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQpO1xyXG4gICAgICAgIGNvbnN0IGZpbGVzVG9DaGVjayA9IHRvb2xzLmdldEZpbGVzSW5WYXVsdChvcHRpb25zLmRlc3RpbmF0aW9uRm9sZGVyKTtcclxuICAgICAgICBsZXQgbGlua3MgPSBjdXJyZW50Q29udGVudCB8fCBbXTtcclxuICAgICAgICBpZiAodHlwZW9mIGxpbmtzID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShsaW5rcykpIHtcclxuICAgICAgICAgICAgbGlua3MgPSBbXTsgLy8gY29udmVydCBvYmplY3QgdG8gYXJyYXlcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaW5rcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgbGlua3MgPSBbbGlua3NdOyAvLyBjb252ZXJ0IHRvIGFycmF5IGlmIG5vdCBhbHJlYWR5IGFuIGFycmF5XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGxvZ2dlci5sb2coREVCVUcsYGF1dG9MaW5rOiBsaW5rcyB0byBjaGVja2AsIGxpbmtzLCBmaWxlc1RvQ2hlY2spO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBsaW5rcykgIHtcclxuICAgICAgICAgICAgbGV0IGxpbmsgPSB0b29scy5leHRyYWN0TGlua1BhcnRzKHBhcnQpO1xyXG4gICAgICAgICAgICBsZXQgbGlua0ZpbGUgPSB0b29scy5nZXRURmlsZUZyb21QYXRoKGxpbmsucGF0aCwgZmlsZXNUb0NoZWNrKTtcclxuICAgICAgICAgICAgaWYgKCFsaW5rRmlsZSkgeyAvLyBjcmVhdGUgbmV3IEZpbGVcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXNrQ29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgQWxlcnRNb2RhbChhcHAsICdDcmVhdGUgbmV3IGZpbGUnLCBgRmlsZSAke2xpbmsucGF0aH0gZG9lcyBub3QgZXhpc3QuIERvIHlvdSB3YW50IHRvIGNyZWF0ZSBpdD9gLCAnQ3JlYXRlJywgJ0NhbmNlbCcsIFwiRG9uJ3QgYXNrIGFnYWluLlwiKS5vcGVuQW5kR2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnByb2NlZWQpIHJldHVybjsgLy8gZG8gbm90IGNyZWF0ZSB0aGUgZmlsZSBpZiB0aGUgdXNlciBkb2VzIG5vdCBjb25maXJtXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLmFza0NvbmZpcm1hdGlvbiA9ICFyZXN1bHQuZGF0YS5hc2tDb25maXJtYXRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGluay5wYXRoID0gb3B0aW9ucy5kZXN0aW5hdGlvbkZvbGRlciArICcvJyArIGxpbmsudGl0bGUgKyAnLm1kJzsgLy8gYWRkIHRoZSBkZXN0aW5hdGlvbiBmb2xkZXIgdG8gdGhlIGxpbmsgcGF0aFxyXG4gICAgICAgICAgICAvL2xvZ2dlci5sb2coREVCVUcsYGF1dG9MaW5rOiBjcmVhdGluZyBuZXcgZmlsZSAke2xpbmsucGF0aH1gKTtcclxuICAgICAgICAgICAgbGlua0ZpbGUgPSBhd2FpdCB0b29scy5jcmVhdGVGaWxlRnJvbVBhdGgobGluay5wYXRoLCBvcHRpb25zLmFkZFRlbXBsYXRlID8gb3B0aW9ucy50ZW1wbGF0ZUZpbGUgOiB1bmRlZmluZWQpOyAvLyBjcmVhdGUgdGhlIGZpbGUgaWYgaXQgZG9lcyBub3QgZXhpc3RcclxuICAgICAgICAgICAgLy9sb2dnZXIubG9nKERFQlVHLGBhdXRvTGluazogbmV3IGZpbGUgY3JlYXRlZCAke2xpbmtGaWxlLnBhdGh9YCk7XHJcbiAgICAgICAgICAgIHRvb2xzLnVwZGF0ZUZyb250bWF0dGVyKHJ1bGUucHJvcGVydHksIFtgW1ske3Rvb2xzLnJlbW92ZUxlYWRpbmdTbGFzaChsaW5rLnBhdGgpfXwke2xpbmsudGl0bGV9XV1gXSwgbGlua0ZpbGUpOyAvLyBhZGQgbG9jYXRpb24gb2YgbmV3IHBhdGggdG8gaXRzZWxmXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vbG9nZ2VyLmxvZyhERUJVRyxgYXV0b0xpbms6IGNyZWF0aW5nIExpbmsgdG8gZXhpc3RpbmcgRmlsZSAke2xpbmtGaWxlLnBhdGh9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxpbmtGaWxlKSB7XHJcbiAgICAgICAgICAgIGxpbmsucGF0aCA9IGxpbmtGaWxlLnBhdGg7XHJcbiAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgW1ske3Rvb2xzLnJlbW92ZUxlYWRpbmdTbGFzaChsaW5rLnBhdGgpfXwke2xpbmsudGl0bGV9XV1gKTsgLy8gYWRkIHRoZSBmaWxlIHBhdGggdG8gdGhlIG5ldyBjb250ZW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9sb2dnZXIubG9nKERFQlVHLGBhdXRvTGluazogbmV3IGNvbnRlbnRgLCBuZXdDb250ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9sb2dnZXIubG9nKERFQlVHLGBhdXRvTGluazogd3JpdGUgY29udGVudGAsIG5ld0NvbnRlbnQpO1xyXG4gICAgICAgIHRvb2xzLnVwZGF0ZUZyb250bWF0dGVyKHJ1bGUucHJvcGVydHksIG5ld0NvbnRlbnQpOyAvLyB1cGRhdGUgdGhlIGZyb250bWF0dGVyIHdpdGggdGhlIG5ldyBjb250ZW50XHJcbiAgICAgICAgcmV0dXJuIG5ld0NvbnRlbnQ7ICAgIFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgb3B0aW9uRUwuZW1wdHkoKTtcclxuICAgICAgICAvLyBDcmVhdGUgYSBzZXR0aW5nIGZvciB0aGUgYXV0byBsaW5rXHJcbiAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgICAgIGFkZFRlbXBsYXRlOiB0cnVlLFxyXG4gICAgICAgICAgICBhc2tDb25maXJtYXRpb246IHRydWUsXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uRm9sZGVyOiAnLycsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlRmlsZTogJycsXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdBZGQgdGVtcGxhdGUgdG8gbmV3IGZpbGVzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgYWRkIHRlbXBsYXRlIHRvIG5ldyBmaWxlcycpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdhZGRUZW1wbGF0ZScpIHx8IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2FkZFRlbXBsYXRlJywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0FzayBmb3IgY29uZmlybWF0aW9uJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0FzayBmb3IgY29uZmlybWF0aW9uIGJlZm9yZSBjcmVhdGluZyBuZXcgZmlsZXMnKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwnYXNrQ29uZmlybWF0aW9uJykgfHwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnYXNrQ29uZmlybWF0aW9uJywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBsZXQgZGVzdGluYXRpb25Gb2xkZXJFbDpTZWFyY2hDb21wb25lbnQ7ICBcclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0Rlc3RpbmF0aW9uIEZvbGRlcicpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdGb2xkZXIgdG8gcGxhY2UgbmV3IGZpbGVzJylcclxuICAgICAgICAgICAgLmFkZFNlYXJjaCgoY2IpID0+IHtcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRm9sZGVyRWwgPSBjYjtcclxuICAgICAgICAgICAgICAgIG5ldyBGb2xkZXJTdWdnZXN0KHRoYXQuYXBwLCBjYi5pbnB1dEVsKTtcclxuICAgICAgICAgICAgICAgIGNiLnNldFBsYWNlaG9sZGVyKFwiZW50ZXIgZm9sZGVyIG9yIGJyb3dzZSAuLi5cIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2Rlc3RpbmF0aW9uRm9sZGVyJykgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKChuZXdGb2xkZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Rm9sZGVyID0gbmV3Rm9sZGVyLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGb2xkZXIgPSBuZXdGb2xkZXIucmVwbGFjZSgvXFwvJC8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdkZXN0aW5hdGlvbkZvbGRlcicsIG5ld0ZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgICAgICBjYi5jb250YWluZXJFbC5hZGRDbGFzcyhcImZyb250bWF0dGVyLWF1dG9tYXRlLXNlYXJjaFwiKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidXR0b24pID0+XHJcbiAgICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ2ZvbGRlci10cmVlJylcclxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdTZWxlY3QgdGVtcGxhdGUgZm9sZGVyJylcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LmFwcCxcclxuICAgICAgICAgICAgICAgICAgICBbdGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2Rlc3RpbmF0aW9uRm9sZGVyJyldLFxyXG4gICAgICAgICAgICAgICAgICAgIFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnU2VsZWN0IGZvbGRlciB0byBwbGFjZSBuZXcgZmlsZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiAnZm9sZGVyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uU2VsZWN0aW9uTW9kZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblNob3dGaWxlczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZm9sZGVycy5sZW5ndGggPT09IDAgfHwgIXJlc3VsdC5mb2xkZXJzWzBdIHx8IHR5cGVvZiByZXN1bHQuZm9sZGVyc1swXSAhPT0gJ3N0cmluZycpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkRm9sZGVyID0gcmVzdWx0LmZvbGRlcnNbMF0udHJpbSgpLnJlcGxhY2UoL1xcLyQvLCBcIlwiKTsgLy8gcmVtb3ZlIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXMgKC9eXFwvfFxcLyQvZywgXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkRm9sZGVyID09PSAnJykgc2VsZWN0ZWRGb2xkZXIgPSAnLyc7IC8vIGlmIGVtcHR5LCBzZXQgdG8gcm9vdCBmb2xkZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxlY3RlZEZvbGRlcikgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZvbGRlckVsLnNldFZhbHVlKHNlbGVjdGVkRm9sZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnZGVzdGluYXRpb25Gb2xkZXInLCBzZWxlY3RlZEZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGRlc3RpbmF0aW9uRmlsZUVsOlNlYXJjaENvbXBvbmVudDsgIFxyXG4gICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGVtcGxhdGUgRmlsZScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdTZWxlY3QgYSB0ZW1wbGF0ZSBmaWxlIHRvIGFkZCB0byBuZXcgZmlsZXMnKVxyXG4gICAgICAgICAgICAuYWRkU2VhcmNoKChjYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb25GaWxlRWwgPSBjYjtcclxuICAgICAgICAgICAgICAgIG5ldyBGaWxlU3VnZ2VzdChjYi5pbnB1dEVsLCB0aGF0LnBsdWdpbiwgJycpO1xyXG4gICAgICAgICAgICAgICAgY2Iuc2V0UGxhY2Vob2xkZXIoXCJlbnRlciBmb2xkZXIgb3IgYnJvd3NlIC4uLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwndGVtcGxhdGVGaWxlJykgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKChuZXdGaWxlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpbGUgPSBuZXdGaWxlLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWxlID0gbmV3RmlsZS5yZXBsYWNlKC9cXC8kLywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3RlbXBsYXRlRmlsZScsIG5ld0ZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgICAgY2IuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJmcm9udG1hdHRlci1hdXRvbWF0ZS1zZWFyY2hcIik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0SWNvbignZm9sZGVyLXRyZWUnKVxyXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1NlbGVjdCB0ZW1wbGF0ZSBmaWxlJylcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIG9wZW5EaXJlY3RvcnlTZWxlY3Rpb25Nb2RhbChcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LmFwcCxcclxuICAgICAgICAgICAgICAgICAgICBbXSxcclxuICAgICAgICAgICAgICAgICAgICBbdGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCwndGVtcGxhdGVGaWxlJyldLFxyXG4gICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnU2VsZWN0IHRlbXBsYXRlIGZvciBuZXcgZmlsZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25Nb2RlOiAnaW5jbHVkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlNb2RlOiAnZmlsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvblNlbGVjdGlvbk1vZGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25TaG93RmlsZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAocmVzdWx0OiBEaXJlY3RvcnlTZWxlY3Rpb25SZXN1bHQgfCBudWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZmlsZXMubGVuZ3RoID09PSAwIHx8ICFyZXN1bHQuZmlsZXNbMF0gfHwgdHlwZW9mIHJlc3VsdC5maWxlc1swXSAhPT0gJ3N0cmluZycpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkRmlsZSA9IHJlc3VsdC5maWxlc1swXS50cmltKCkucmVwbGFjZSgvXFwvJC8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkRmlsZSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZpbGVFbC5zZXRWYWx1ZShzZWxlY3RlZEZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCd0ZW1wbGF0ZUZpbGUnLCBzZWxlY3RlZEZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcbiIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuLy8gYW5kIFRlbXBsYXRlciBwbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9TaWxlbnRWb2lkMTMvVGVtcGxhdGVyIHdoZXJlIEkgZ290IHRoZSBjb2RlIGZvciB0aGUgc3VnZ2VzdGVyc1xuXG5pbXBvcnQgeyBBcHAsIFRBYnN0cmFjdEZpbGUsIFRGb2xkZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5cbmV4cG9ydCBjbGFzcyBGb2xkZXJTdWdnZXN0IGV4dGVuZHMgVGV4dElucHV0U3VnZ2VzdDxURm9sZGVyPiB7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XG4gICAgICAgIHN1cGVyKGFwcCwgaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRGb2xkZXJbXSB7XG4gICAgICAgIGNvbnN0IGFic3RyYWN0RmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpO1xuICAgICAgICBjb25zdCBmb2xkZXJzOiBURm9sZGVyW10gPSBbXTtcbiAgICAgICAgY29uc3QgbG93ZXJDYXNlSW5wdXRTdHIgPSBpbnB1dFN0ci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGFic3RyYWN0RmlsZXMuZm9yRWFjaCgoZm9sZGVyOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlciAmJlxuICAgICAgICAgICAgICAgIGZvbGRlci5wYXRoLnRvTG93ZXJDYXNlKCkuY29udGFpbnMobG93ZXJDYXNlSW5wdXRTdHIpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBmb2xkZXJzLnB1c2goZm9sZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvbGRlcnMuc2xpY2UoMCwgMTAwMCk7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihmaWxlOiBURm9sZGVyLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChmaWxlLnBhdGgucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIikpO1xuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oZmlsZTogVEZvbGRlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGgucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIik7XG4gICAgICAgIHRoaXMuaW5wdXRFbC50cmlnZ2VyKFwiaW5wdXRcIik7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcbi8vIGFuZCBUZW1wbGF0ZXIgcGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vU2lsZW50Vm9pZDEzL1RlbXBsYXRlciB3aGVyZSBJIGdvdCB0aGUgY29kZSBmb3IgdGhlIHN1Z2dlc3RlcnNcblxuaW1wb3J0IHsgQXBwLCBJU3VnZ2VzdE93bmVyLCBTY29wZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlUG9wcGVyLCBJbnN0YW5jZSBhcyBQb3BwZXJJbnN0YW5jZSB9IGZyb20gXCJAcG9wcGVyanMvY29yZVwiO1xuXG5jb25zdCB3cmFwQXJvdW5kID0gKHZhbHVlOiBudW1iZXIsIHNpemU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuICgodmFsdWUgJSBzaXplKSArIHNpemUpICUgc2l6ZTtcbn07XG5cbmNsYXNzIFN1Z2dlc3Q8VD4ge1xuICAgIHByaXZhdGUgb3duZXI6IElTdWdnZXN0T3duZXI8VD47XG4gICAgcHJpdmF0ZSB2YWx1ZXMhOiBUW107XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9ucyE6IEhUTUxEaXZFbGVtZW50W107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEl0ZW0hOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgb3duZXI6IElTdWdnZXN0T3duZXI8VD4sXG4gICAgICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgc2NvcGU6IFNjb3BlXG4gICAgKSB7XG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbCA9IGNvbnRhaW5lckVsO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLm9uKFxuICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbkNsaWNrLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbk1vdXNlb3Zlci5iaW5kKHRoaXMpXG4gICAgICAgICk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dVcFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkSXRlbSAtIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtICsgMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblN1Z2dlc3Rpb25DbGljayhldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihlbCBhcyBIVE1MRGl2RWxlbWVudCk7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKGl0ZW0sIGZhbHNlKTtcbiAgICAgICAgdGhpcy51c2VTZWxlY3RlZEl0ZW0oZXZlbnQpO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbk1vdXNlb3ZlcihfZXZlbnQ6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsIGFzIEhUTUxEaXZFbGVtZW50KTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIHNldFN1Z2dlc3Rpb25zKHZhbHVlczogVFtdKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsczogSFRNTERpdkVsZW1lbnRbXSA9IFtdO1xuXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWl0ZW1cIik7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnJlbmRlclN1Z2dlc3Rpb24odmFsdWUsIHN1Z2dlc3Rpb25FbCk7XG4gICAgICAgICAgICBzdWdnZXN0aW9uRWxzLnB1c2goc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9uRWxzO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSgwLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgdXNlU2VsZWN0ZWRJdGVtKGV2ZW50OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnZhbHVlc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0U3VnZ2VzdGlvbihjdXJyZW50VmFsdWUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFNlbGVjdGVkSXRlbShzZWxlY3RlZEluZGV4OiBudW1iZXIsIHNjcm9sbEludG9WaWV3OiBib29sZWFuKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbmRleCA9IHdyYXBBcm91bmQoXG4gICAgICAgICAgICBzZWxlY3RlZEluZGV4LFxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEl0ZW1dO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3Rpb25zW25vcm1hbGl6ZWRJbmRleF07XG5cbiAgICAgICAgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbj8ucmVtb3ZlQ2xhc3MoXCJpcy1zZWxlY3RlZFwiKTtcbiAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uPy5hZGRDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbm9ybWFsaXplZEluZGV4O1xuXG4gICAgICAgIGlmIChzY3JvbGxJbnRvVmlldykge1xuICAgICAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uLnNjcm9sbEludG9WaWV3KGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRJbnB1dFN1Z2dlc3Q8VD4gaW1wbGVtZW50cyBJU3VnZ2VzdE93bmVyPFQ+IHtcbiAgICBwcm90ZWN0ZWQgYXBwOiBBcHA7XG4gICAgcHJvdGVjdGVkIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50O1xuXG4gICAgcHJpdmF0ZSBwb3BwZXIhOiBQb3BwZXJJbnN0YW5jZTtcbiAgICBwcml2YXRlIHNjb3BlOiBTY29wZTtcbiAgICBwcml2YXRlIHN1Z2dlc3RFbDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzdWdnZXN0OiBTdWdnZXN0PFQ+O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmlucHV0RWwgPSBpbnB1dEVsO1xuICAgICAgICB0aGlzLnNjb3BlID0gbmV3IFNjb3BlKCk7XG5cbiAgICAgICAgdGhpcy5zdWdnZXN0RWwgPSBjcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWNvbnRhaW5lclwiKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdEVsLmNyZWF0ZURpdihcInN1Z2dlc3Rpb25cIik7XG4gICAgICAgIHRoaXMuc3VnZ2VzdCA9IG5ldyBTdWdnZXN0KHRoaXMsIHN1Z2dlc3Rpb24sIHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRXNjYXBlXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCB0aGlzLm9uSW5wdXRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIHRoaXMub25JbnB1dENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnN1Z2dlc3RFbC5vbihcbiAgICAgICAgICAgIFwibW91c2Vkb3duXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWNvbnRhaW5lclwiLFxuICAgICAgICAgICAgKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBvbklucHV0Q2hhbmdlZCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW5wdXRTdHIgPSB0aGlzLmlucHV0RWwudmFsdWU7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZXRTdWdnZXN0aW9ucyhpbnB1dFN0cik7XG5cbiAgICAgICAgaWYgKCFzdWdnZXN0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdC5zZXRTdWdnZXN0aW9ucyhzdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMub3Blbih0aGlzLmFwcC5kb20uYXBwQ29udGFpbmVyRWwsIHRoaXMuaW5wdXRFbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvcGVuKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlucHV0RWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuYXBwLmtleW1hcC5wdXNoU2NvcGUodGhpcy5zY29wZSk7XG5cbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc3VnZ2VzdEVsKTtcbiAgICAgICAgdGhpcy5wb3BwZXIgPSBjcmVhdGVQb3BwZXIoaW5wdXRFbCwgdGhpcy5zdWdnZXN0RWwsIHtcbiAgICAgICAgICAgIHBsYWNlbWVudDogXCJib3R0b20tc3RhcnRcIixcbiAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJzYW1lV2lkdGhcIixcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm46ICh7IHN0YXRlLCBpbnN0YW5jZSB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RlOiBwb3NpdGlvbmluZyBuZWVkcyB0byBiZSBjYWxjdWxhdGVkIHR3aWNlIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpcnN0IHBhc3MgLSBwb3NpdGlvbmluZyBpdCBhY2NvcmRpbmcgdG8gdGhlIHdpZHRoIG9mIHRoZSBwb3BwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlY29uZCBwYXNzIC0gcG9zaXRpb24gaXQgd2l0aCB0aGUgd2lkdGggYm91bmQgdG8gdGhlIHJlZmVyZW5jZSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGVhcmx5IGV4aXQgdG8gYXZvaWQgYW4gaW5maW5pdGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0V2lkdGggPSBgJHtzdGF0ZS5yZWN0cy5yZWZlcmVuY2Uud2lkdGh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnN0eWxlcy5wb3BwZXIud2lkdGggPT09IHRhcmdldFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuc3R5bGVzLnBvcHBlci53aWR0aCA9IHRhcmdldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHBoYXNlOiBcImJlZm9yZVdyaXRlXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzOiBbXCJjb21wdXRlU3R5bGVzXCJdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIHRoaXMuc3VnZ2VzdC5zZXRTdWdnZXN0aW9ucyhbXSk7XG4gICAgICAgIGlmICh0aGlzLnBvcHBlcikgdGhpcy5wb3BwZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnN1Z2dlc3RFbC5kZXRhY2goKTtcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBnZXRTdWdnZXN0aW9ucyhpbnB1dFN0cjogc3RyaW5nKTogVFtdO1xuICAgIGFic3RyYWN0IHJlbmRlclN1Z2dlc3Rpb24oaXRlbTogVCwgZWw6IEhUTUxFbGVtZW50KTogdm9pZDtcbiAgICBhYnN0cmFjdCBzZWxlY3RTdWdnZXN0aW9uKGl0ZW06IFQpOiB2b2lkO1xufVxuIiwgImV4cG9ydCB2YXIgdG9wID0gJ3RvcCc7XG5leHBvcnQgdmFyIGJvdHRvbSA9ICdib3R0b20nO1xuZXhwb3J0IHZhciByaWdodCA9ICdyaWdodCc7XG5leHBvcnQgdmFyIGxlZnQgPSAnbGVmdCc7XG5leHBvcnQgdmFyIGF1dG8gPSAnYXV0byc7XG5leHBvcnQgdmFyIGJhc2VQbGFjZW1lbnRzID0gW3RvcCwgYm90dG9tLCByaWdodCwgbGVmdF07XG5leHBvcnQgdmFyIHN0YXJ0ID0gJ3N0YXJ0JztcbmV4cG9ydCB2YXIgZW5kID0gJ2VuZCc7XG5leHBvcnQgdmFyIGNsaXBwaW5nUGFyZW50cyA9ICdjbGlwcGluZ1BhcmVudHMnO1xuZXhwb3J0IHZhciB2aWV3cG9ydCA9ICd2aWV3cG9ydCc7XG5leHBvcnQgdmFyIHBvcHBlciA9ICdwb3BwZXInO1xuZXhwb3J0IHZhciByZWZlcmVuY2UgPSAncmVmZXJlbmNlJztcbmV4cG9ydCB2YXIgdmFyaWF0aW9uUGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9iYXNlUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gIHJldHVybiBhY2MuY29uY2F0KFtwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pO1xuZXhwb3J0IHZhciBwbGFjZW1lbnRzID0gLyojX19QVVJFX18qL1tdLmNvbmNhdChiYXNlUGxhY2VtZW50cywgW2F1dG9dKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gIHJldHVybiBhY2MuY29uY2F0KFtwbGFjZW1lbnQsIHBsYWNlbWVudCArIFwiLVwiICsgc3RhcnQsIHBsYWNlbWVudCArIFwiLVwiICsgZW5kXSk7XG59LCBbXSk7IC8vIG1vZGlmaWVycyB0aGF0IG5lZWQgdG8gcmVhZCB0aGUgRE9NXG5cbmV4cG9ydCB2YXIgYmVmb3JlUmVhZCA9ICdiZWZvcmVSZWFkJztcbmV4cG9ydCB2YXIgcmVhZCA9ICdyZWFkJztcbmV4cG9ydCB2YXIgYWZ0ZXJSZWFkID0gJ2FmdGVyUmVhZCc7IC8vIHB1cmUtbG9naWMgbW9kaWZpZXJzXG5cbmV4cG9ydCB2YXIgYmVmb3JlTWFpbiA9ICdiZWZvcmVNYWluJztcbmV4cG9ydCB2YXIgbWFpbiA9ICdtYWluJztcbmV4cG9ydCB2YXIgYWZ0ZXJNYWluID0gJ2FmdGVyTWFpbic7IC8vIG1vZGlmaWVyIHdpdGggdGhlIHB1cnBvc2UgdG8gd3JpdGUgdG8gdGhlIERPTSAob3Igd3JpdGUgaW50byBhIGZyYW1ld29yayBzdGF0ZSlcblxuZXhwb3J0IHZhciBiZWZvcmVXcml0ZSA9ICdiZWZvcmVXcml0ZSc7XG5leHBvcnQgdmFyIHdyaXRlID0gJ3dyaXRlJztcbmV4cG9ydCB2YXIgYWZ0ZXJXcml0ZSA9ICdhZnRlcldyaXRlJztcbmV4cG9ydCB2YXIgbW9kaWZpZXJQaGFzZXMgPSBbYmVmb3JlUmVhZCwgcmVhZCwgYWZ0ZXJSZWFkLCBiZWZvcmVNYWluLCBtYWluLCBhZnRlck1haW4sIGJlZm9yZVdyaXRlLCB3cml0ZSwgYWZ0ZXJXcml0ZV07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE5vZGVOYW1lKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQgPyAoZWxlbWVudC5ub2RlTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKSA6IG51bGw7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvdyhub2RlKSB7XG4gIGlmIChub2RlID09IG51bGwpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG5cbiAgaWYgKG5vZGUudG9TdHJpbmcoKSAhPT0gJ1tvYmplY3QgV2luZG93XScpIHtcbiAgICB2YXIgb3duZXJEb2N1bWVudCA9IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICByZXR1cm4gb3duZXJEb2N1bWVudCA/IG93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgfHwgd2luZG93IDogd2luZG93O1xuICB9XG5cbiAgcmV0dXJuIG5vZGU7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudChub2RlKSB7XG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLkVsZW1lbnQ7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNIVE1MRWxlbWVudChub2RlKSB7XG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLkhUTUxFbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBpc1NoYWRvd1Jvb3Qobm9kZSkge1xuICAvLyBJRSAxMSBoYXMgbm8gU2hhZG93Um9vdFxuICBpZiAodHlwZW9mIFNoYWRvd1Jvb3QgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIE93bkVsZW1lbnQgPSBnZXRXaW5kb3cobm9kZSkuU2hhZG93Um9vdDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBTaGFkb3dSb290O1xufVxuXG5leHBvcnQgeyBpc0VsZW1lbnQsIGlzSFRNTEVsZW1lbnQsIGlzU2hhZG93Um9vdCB9OyIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4uL2RvbS11dGlscy9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiOyAvLyBUaGlzIG1vZGlmaWVyIHRha2VzIHRoZSBzdHlsZXMgcHJlcGFyZWQgYnkgdGhlIGBjb21wdXRlU3R5bGVzYCBtb2RpZmllclxuLy8gYW5kIGFwcGxpZXMgdGhlbSB0byB0aGUgSFRNTEVsZW1lbnRzIHN1Y2ggYXMgcG9wcGVyIGFuZCBhcnJvd1xuXG5mdW5jdGlvbiBhcHBseVN0eWxlcyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGU7XG4gIE9iamVjdC5rZXlzKHN0YXRlLmVsZW1lbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIHN0eWxlID0gc3RhdGUuc3R5bGVzW25hbWVdIHx8IHt9O1xuICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW25hbWVdOyAvLyBhcnJvdyBpcyBvcHRpb25hbCArIHZpcnR1YWwgZWxlbWVudHNcblxuICAgIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAhZ2V0Tm9kZU5hbWUoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIEZsb3cgZG9lc24ndCBzdXBwb3J0IHRvIGV4dGVuZCB0aGlzIHByb3BlcnR5LCBidXQgaXQncyB0aGUgbW9zdFxuICAgIC8vIGVmZmVjdGl2ZSB3YXkgdG8gYXBwbHkgc3R5bGVzIHRvIGFuIEhUTUxFbGVtZW50XG4gICAgLy8gJEZsb3dGaXhNZVtjYW5ub3Qtd3JpdGVdXG5cblxuICAgIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGUpO1xuICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG5cbiAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSA9PT0gdHJ1ZSA/ICcnIDogdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYyKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYyLnN0YXRlO1xuICB2YXIgaW5pdGlhbFN0eWxlcyA9IHtcbiAgICBwb3BwZXI6IHtcbiAgICAgIHBvc2l0aW9uOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgbGVmdDogJzAnLFxuICAgICAgdG9wOiAnMCcsXG4gICAgICBtYXJnaW46ICcwJ1xuICAgIH0sXG4gICAgYXJyb3c6IHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnXG4gICAgfSxcbiAgICByZWZlcmVuY2U6IHt9XG4gIH07XG4gIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMucG9wcGVyLnN0eWxlLCBpbml0aWFsU3R5bGVzLnBvcHBlcik7XG4gIHN0YXRlLnN0eWxlcyA9IGluaXRpYWxTdHlsZXM7XG5cbiAgaWYgKHN0YXRlLmVsZW1lbnRzLmFycm93KSB7XG4gICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5lbGVtZW50cy5hcnJvdy5zdHlsZSwgaW5pdGlhbFN0eWxlcy5hcnJvdyk7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIE9iamVjdC5rZXlzKHN0YXRlLmVsZW1lbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW25hbWVdO1xuICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBzdGF0ZS5hdHRyaWJ1dGVzW25hbWVdIHx8IHt9O1xuICAgICAgdmFyIHN0eWxlUHJvcGVydGllcyA9IE9iamVjdC5rZXlzKHN0YXRlLnN0eWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSA/IHN0YXRlLnN0eWxlc1tuYW1lXSA6IGluaXRpYWxTdHlsZXNbbmFtZV0pOyAvLyBTZXQgYWxsIHZhbHVlcyB0byBhbiBlbXB0eSBzdHJpbmcgdG8gdW5zZXQgdGhlbVxuXG4gICAgICB2YXIgc3R5bGUgPSBzdHlsZVByb3BlcnRpZXMucmVkdWNlKGZ1bmN0aW9uIChzdHlsZSwgcHJvcGVydHkpIHtcbiAgICAgICAgc3R5bGVbcHJvcGVydHldID0gJyc7XG4gICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgIH0sIHt9KTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICAgIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAhZ2V0Tm9kZU5hbWUoZWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdhcHBseVN0eWxlcycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnd3JpdGUnLFxuICBmbjogYXBwbHlTdHlsZXMsXG4gIGVmZmVjdDogZWZmZWN0LFxuICByZXF1aXJlczogWydjb21wdXRlU3R5bGVzJ11cbn07IiwgImltcG9ydCB7IGF1dG8gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQuc3BsaXQoJy0nKVswXTtcbn0iLCAiZXhwb3J0IHZhciBtYXggPSBNYXRoLm1heDtcbmV4cG9ydCB2YXIgbWluID0gTWF0aC5taW47XG5leHBvcnQgdmFyIHJvdW5kID0gTWF0aC5yb3VuZDsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0VUFTdHJpbmcoKSB7XG4gIHZhciB1YURhdGEgPSBuYXZpZ2F0b3IudXNlckFnZW50RGF0YTtcblxuICBpZiAodWFEYXRhICE9IG51bGwgJiYgdWFEYXRhLmJyYW5kcyAmJiBBcnJheS5pc0FycmF5KHVhRGF0YS5icmFuZHMpKSB7XG4gICAgcmV0dXJuIHVhRGF0YS5icmFuZHMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICByZXR1cm4gaXRlbS5icmFuZCArIFwiL1wiICsgaXRlbS52ZXJzaW9uO1xuICAgIH0pLmpvaW4oJyAnKTtcbiAgfVxuXG4gIHJldHVybiBuYXZpZ2F0b3IudXNlckFnZW50O1xufSIsICJpbXBvcnQgZ2V0VUFTdHJpbmcgZnJvbSBcIi4uL3V0aWxzL3VzZXJBZ2VudC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNMYXlvdXRWaWV3cG9ydCgpIHtcbiAgcmV0dXJuICEvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KGdldFVBU3RyaW5nKCkpO1xufSIsICJpbXBvcnQgeyBpc0VsZW1lbnQsIGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGlzTGF5b3V0Vmlld3BvcnQgZnJvbSBcIi4vaXNMYXlvdXRWaWV3cG9ydC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQsIGluY2x1ZGVTY2FsZSwgaXNGaXhlZFN0cmF0ZWd5KSB7XG4gIGlmIChpbmNsdWRlU2NhbGUgPT09IHZvaWQgMCkge1xuICAgIGluY2x1ZGVTY2FsZSA9IGZhbHNlO1xuICB9XG5cbiAgaWYgKGlzRml4ZWRTdHJhdGVneSA9PT0gdm9pZCAwKSB7XG4gICAgaXNGaXhlZFN0cmF0ZWd5ID0gZmFsc2U7XG4gIH1cblxuICB2YXIgY2xpZW50UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHZhciBzY2FsZVggPSAxO1xuICB2YXIgc2NhbGVZID0gMTtcblxuICBpZiAoaW5jbHVkZVNjYWxlICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICBzY2FsZVggPSBlbGVtZW50Lm9mZnNldFdpZHRoID4gMCA/IHJvdW5kKGNsaWVudFJlY3Qud2lkdGgpIC8gZWxlbWVudC5vZmZzZXRXaWR0aCB8fCAxIDogMTtcbiAgICBzY2FsZVkgPSBlbGVtZW50Lm9mZnNldEhlaWdodCA+IDAgPyByb3VuZChjbGllbnRSZWN0LmhlaWdodCkgLyBlbGVtZW50Lm9mZnNldEhlaWdodCB8fCAxIDogMTtcbiAgfVxuXG4gIHZhciBfcmVmID0gaXNFbGVtZW50KGVsZW1lbnQpID8gZ2V0V2luZG93KGVsZW1lbnQpIDogd2luZG93LFxuICAgICAgdmlzdWFsVmlld3BvcnQgPSBfcmVmLnZpc3VhbFZpZXdwb3J0O1xuXG4gIHZhciBhZGRWaXN1YWxPZmZzZXRzID0gIWlzTGF5b3V0Vmlld3BvcnQoKSAmJiBpc0ZpeGVkU3RyYXRlZ3k7XG4gIHZhciB4ID0gKGNsaWVudFJlY3QubGVmdCArIChhZGRWaXN1YWxPZmZzZXRzICYmIHZpc3VhbFZpZXdwb3J0ID8gdmlzdWFsVmlld3BvcnQub2Zmc2V0TGVmdCA6IDApKSAvIHNjYWxlWDtcbiAgdmFyIHkgPSAoY2xpZW50UmVjdC50b3AgKyAoYWRkVmlzdWFsT2Zmc2V0cyAmJiB2aXN1YWxWaWV3cG9ydCA/IHZpc3VhbFZpZXdwb3J0Lm9mZnNldFRvcCA6IDApKSAvIHNjYWxlWTtcbiAgdmFyIHdpZHRoID0gY2xpZW50UmVjdC53aWR0aCAvIHNjYWxlWDtcbiAgdmFyIGhlaWdodCA9IGNsaWVudFJlY3QuaGVpZ2h0IC8gc2NhbGVZO1xuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB0b3A6IHksXG4gICAgcmlnaHQ6IHggKyB3aWR0aCxcbiAgICBib3R0b206IHkgKyBoZWlnaHQsXG4gICAgbGVmdDogeCxcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjsgLy8gUmV0dXJucyB0aGUgbGF5b3V0IHJlY3Qgb2YgYW4gZWxlbWVudCByZWxhdGl2ZSB0byBpdHMgb2Zmc2V0UGFyZW50LiBMYXlvdXRcbi8vIG1lYW5zIGl0IGRvZXNuJ3QgdGFrZSBpbnRvIGFjY291bnQgdHJhbnNmb3Jtcy5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TGF5b3V0UmVjdChlbGVtZW50KSB7XG4gIHZhciBjbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpOyAvLyBVc2UgdGhlIGNsaWVudFJlY3Qgc2l6ZXMgaWYgaXQncyBub3QgYmVlbiB0cmFuc2Zvcm1lZC5cbiAgLy8gRml4ZXMgaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMjIzXG5cbiAgdmFyIHdpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgdmFyIGhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXG4gIGlmIChNYXRoLmFicyhjbGllbnRSZWN0LndpZHRoIC0gd2lkdGgpIDw9IDEpIHtcbiAgICB3aWR0aCA9IGNsaWVudFJlY3Qud2lkdGg7XG4gIH1cblxuICBpZiAoTWF0aC5hYnMoY2xpZW50UmVjdC5oZWlnaHQgLSBoZWlnaHQpIDw9IDEpIHtcbiAgICBoZWlnaHQgPSBjbGllbnRSZWN0LmhlaWdodDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogZWxlbWVudC5vZmZzZXRMZWZ0LFxuICAgIHk6IGVsZW1lbnQub2Zmc2V0VG9wLFxuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb250YWlucyhwYXJlbnQsIGNoaWxkKSB7XG4gIHZhciByb290Tm9kZSA9IGNoaWxkLmdldFJvb3ROb2RlICYmIGNoaWxkLmdldFJvb3ROb2RlKCk7IC8vIEZpcnN0LCBhdHRlbXB0IHdpdGggZmFzdGVyIG5hdGl2ZSBtZXRob2RcblxuICBpZiAocGFyZW50LmNvbnRhaW5zKGNoaWxkKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IC8vIHRoZW4gZmFsbGJhY2sgdG8gY3VzdG9tIGltcGxlbWVudGF0aW9uIHdpdGggU2hhZG93IERPTSBzdXBwb3J0XG4gIGVsc2UgaWYgKHJvb3ROb2RlICYmIGlzU2hhZG93Um9vdChyb290Tm9kZSkpIHtcbiAgICAgIHZhciBuZXh0ID0gY2hpbGQ7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKG5leHQgJiYgcGFyZW50LmlzU2FtZU5vZGUobmV4dCkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ106IG5lZWQgYSBiZXR0ZXIgd2F5IHRvIGhhbmRsZSB0aGlzLi4uXG5cblxuICAgICAgICBuZXh0ID0gbmV4dC5wYXJlbnROb2RlIHx8IG5leHQuaG9zdDtcbiAgICAgIH0gd2hpbGUgKG5leHQpO1xuICAgIH0gLy8gR2l2ZSB1cCwgdGhlIHJlc3VsdCBpcyBmYWxzZVxuXG5cbiAgcmV0dXJuIGZhbHNlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB7XG4gIHJldHVybiBnZXRXaW5kb3coZWxlbWVudCkuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbn0iLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1RhYmxlRWxlbWVudChlbGVtZW50KSB7XG4gIHJldHVybiBbJ3RhYmxlJywgJ3RkJywgJ3RoJ10uaW5kZXhPZihnZXROb2RlTmFtZShlbGVtZW50KSkgPj0gMDtcbn0iLCAiaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpIHtcbiAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICByZXR1cm4gKChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50Lm93bmVyRG9jdW1lbnQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgZWxlbWVudC5kb2N1bWVudCkgfHwgd2luZG93LmRvY3VtZW50KS5kb2N1bWVudEVsZW1lbnQ7XG59IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCB7IGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFBhcmVudE5vZGUoZWxlbWVudCkge1xuICBpZiAoZ2V0Tm9kZU5hbWUoZWxlbWVudCkgPT09ICdodG1sJykge1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgcmV0dXJuICgvLyB0aGlzIGlzIGEgcXVpY2tlciAoYnV0IGxlc3MgdHlwZSBzYWZlKSB3YXkgdG8gc2F2ZSBxdWl0ZSBzb21lIGJ5dGVzIGZyb20gdGhlIGJ1bmRsZVxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl1cbiAgICAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICBlbGVtZW50LmFzc2lnbmVkU2xvdCB8fCAvLyBzdGVwIGludG8gdGhlIHNoYWRvdyBET00gb2YgdGhlIHBhcmVudCBvZiBhIHNsb3R0ZWQgbm9kZVxuICAgIGVsZW1lbnQucGFyZW50Tm9kZSB8fCAoIC8vIERPTSBFbGVtZW50IGRldGVjdGVkXG4gICAgaXNTaGFkb3dSb290KGVsZW1lbnQpID8gZWxlbWVudC5ob3N0IDogbnVsbCkgfHwgLy8gU2hhZG93Um9vdCBkZXRlY3RlZFxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBIVE1MRWxlbWVudCBpcyBhIE5vZGVcbiAgICBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkgLy8gZmFsbGJhY2tcblxuICApO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgaXNUYWJsZUVsZW1lbnQgZnJvbSBcIi4vaXNUYWJsZUVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBnZXRVQVN0cmluZyBmcm9tIFwiLi4vdXRpbHMvdXNlckFnZW50LmpzXCI7XG5cbmZ1bmN0aW9uIGdldFRydWVPZmZzZXRQYXJlbnQoZWxlbWVudCkge1xuICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy84MzdcbiAgZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGVsZW1lbnQub2Zmc2V0UGFyZW50O1xufSAvLyBgLm9mZnNldFBhcmVudGAgcmVwb3J0cyBgbnVsbGAgZm9yIGZpeGVkIGVsZW1lbnRzLCB3aGlsZSBhYnNvbHV0ZSBlbGVtZW50c1xuLy8gcmV0dXJuIHRoZSBjb250YWluaW5nIGJsb2NrXG5cblxuZnVuY3Rpb24gZ2V0Q29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHtcbiAgdmFyIGlzRmlyZWZveCA9IC9maXJlZm94L2kudGVzdChnZXRVQVN0cmluZygpKTtcbiAgdmFyIGlzSUUgPSAvVHJpZGVudC9pLnRlc3QoZ2V0VUFTdHJpbmcoKSk7XG5cbiAgaWYgKGlzSUUgJiYgaXNIVE1MRWxlbWVudChlbGVtZW50KSkge1xuICAgIC8vIEluIElFIDksIDEwIGFuZCAxMSBmaXhlZCBlbGVtZW50cyBjb250YWluaW5nIGJsb2NrIGlzIGFsd2F5cyBlc3RhYmxpc2hlZCBieSB0aGUgdmlld3BvcnRcbiAgICB2YXIgZWxlbWVudENzcyA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG5cbiAgICBpZiAoZWxlbWVudENzcy5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgdmFyIGN1cnJlbnROb2RlID0gZ2V0UGFyZW50Tm9kZShlbGVtZW50KTtcblxuICBpZiAoaXNTaGFkb3dSb290KGN1cnJlbnROb2RlKSkge1xuICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUuaG9zdDtcbiAgfVxuXG4gIHdoaWxlIChpc0hUTUxFbGVtZW50KGN1cnJlbnROb2RlKSAmJiBbJ2h0bWwnLCAnYm9keSddLmluZGV4T2YoZ2V0Tm9kZU5hbWUoY3VycmVudE5vZGUpKSA8IDApIHtcbiAgICB2YXIgY3NzID0gZ2V0Q29tcHV0ZWRTdHlsZShjdXJyZW50Tm9kZSk7IC8vIFRoaXMgaXMgbm9uLWV4aGF1c3RpdmUgYnV0IGNvdmVycyB0aGUgbW9zdCBjb21tb24gQ1NTIHByb3BlcnRpZXMgdGhhdFxuICAgIC8vIGNyZWF0ZSBhIGNvbnRhaW5pbmcgYmxvY2suXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL0NvbnRhaW5pbmdfYmxvY2sjaWRlbnRpZnlpbmdfdGhlX2NvbnRhaW5pbmdfYmxvY2tcblxuICAgIGlmIChjc3MudHJhbnNmb3JtICE9PSAnbm9uZScgfHwgY3NzLnBlcnNwZWN0aXZlICE9PSAnbm9uZScgfHwgY3NzLmNvbnRhaW4gPT09ICdwYWludCcgfHwgWyd0cmFuc2Zvcm0nLCAncGVyc3BlY3RpdmUnXS5pbmRleE9mKGNzcy53aWxsQ2hhbmdlKSAhPT0gLTEgfHwgaXNGaXJlZm94ICYmIGNzcy53aWxsQ2hhbmdlID09PSAnZmlsdGVyJyB8fCBpc0ZpcmVmb3ggJiYgY3NzLmZpbHRlciAmJiBjc3MuZmlsdGVyICE9PSAnbm9uZScpIHtcbiAgICAgIHJldHVybiBjdXJyZW50Tm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufSAvLyBHZXRzIHRoZSBjbG9zZXN0IGFuY2VzdG9yIHBvc2l0aW9uZWQgZWxlbWVudC4gSGFuZGxlcyBzb21lIGVkZ2UgY2FzZXMsXG4vLyBzdWNoIGFzIHRhYmxlIGFuY2VzdG9ycyBhbmQgY3Jvc3MgYnJvd3NlciBidWdzLlxuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9mZnNldFBhcmVudChlbGVtZW50KSB7XG4gIHZhciB3aW5kb3cgPSBnZXRXaW5kb3coZWxlbWVudCk7XG4gIHZhciBvZmZzZXRQYXJlbnQgPSBnZXRUcnVlT2Zmc2V0UGFyZW50KGVsZW1lbnQpO1xuXG4gIHdoaWxlIChvZmZzZXRQYXJlbnQgJiYgaXNUYWJsZUVsZW1lbnQob2Zmc2V0UGFyZW50KSAmJiBnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgb2Zmc2V0UGFyZW50ID0gZ2V0VHJ1ZU9mZnNldFBhcmVudChvZmZzZXRQYXJlbnQpO1xuICB9XG5cbiAgaWYgKG9mZnNldFBhcmVudCAmJiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSA9PT0gJ2h0bWwnIHx8IGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdib2R5JyAmJiBnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gPT09ICdzdGF0aWMnKSkge1xuICAgIHJldHVybiB3aW5kb3c7XG4gIH1cblxuICByZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGdldENvbnRhaW5pbmdCbG9jayhlbGVtZW50KSB8fCB3aW5kb3c7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIFsndG9wJywgJ2JvdHRvbSddLmluZGV4T2YocGxhY2VtZW50KSA+PSAwID8gJ3gnIDogJ3knO1xufSIsICJpbXBvcnQgeyBtYXggYXMgbWF0aE1heCwgbWluIGFzIG1hdGhNaW4gfSBmcm9tIFwiLi9tYXRoLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gd2l0aGluKG1pbiwgdmFsdWUsIG1heCkge1xuICByZXR1cm4gbWF0aE1heChtaW4sIG1hdGhNaW4odmFsdWUsIG1heCkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhpbk1heENsYW1wKG1pbiwgdmFsdWUsIG1heCkge1xuICB2YXIgdiA9IHdpdGhpbihtaW4sIHZhbHVlLCBtYXgpO1xuICByZXR1cm4gdiA+IG1heCA/IG1heCA6IHY7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEZyZXNoU2lkZU9iamVjdCgpIHtcbiAgcmV0dXJuIHtcbiAgICB0b3A6IDAsXG4gICAgcmlnaHQ6IDAsXG4gICAgYm90dG9tOiAwLFxuICAgIGxlZnQ6IDBcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi9nZXRGcmVzaFNpZGVPYmplY3QuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1lcmdlUGFkZGluZ09iamVjdChwYWRkaW5nT2JqZWN0KSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBnZXRGcmVzaFNpZGVPYmplY3QoKSwgcGFkZGluZ09iamVjdCk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGV4cGFuZFRvSGFzaE1hcCh2YWx1ZSwga2V5cykge1xuICByZXR1cm4ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gKGhhc2hNYXAsIGtleSkge1xuICAgIGhhc2hNYXBba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiBoYXNoTWFwO1xuICB9LCB7fSk7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi4vZG9tLXV0aWxzL2NvbnRhaW5zLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IHdpdGhpbiB9IGZyb20gXCIuLi91dGlscy93aXRoaW4uanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4uL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qc1wiO1xuaW1wb3J0IGV4cGFuZFRvSGFzaE1hcCBmcm9tIFwiLi4vdXRpbHMvZXhwYW5kVG9IYXNoTWFwLmpzXCI7XG5pbXBvcnQgeyBsZWZ0LCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHRvcCwgYm90dG9tIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHRvUGFkZGluZ09iamVjdCA9IGZ1bmN0aW9uIHRvUGFkZGluZ09iamVjdChwYWRkaW5nLCBzdGF0ZSkge1xuICBwYWRkaW5nID0gdHlwZW9mIHBhZGRpbmcgPT09ICdmdW5jdGlvbicgPyBwYWRkaW5nKE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlY3RzLCB7XG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSkpIDogcGFkZGluZztcbiAgcmV0dXJuIG1lcmdlUGFkZGluZ09iamVjdCh0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBwYWRkaW5nIDogZXhwYW5kVG9IYXNoTWFwKHBhZGRpbmcsIGJhc2VQbGFjZW1lbnRzKSk7XG59O1xuXG5mdW5jdGlvbiBhcnJvdyhfcmVmKSB7XG4gIHZhciBfc3RhdGUkbW9kaWZpZXJzRGF0YSQ7XG5cbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWUsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zO1xuICB2YXIgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3c7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzO1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGF4aXMgPSBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCk7XG4gIHZhciBpc1ZlcnRpY2FsID0gW2xlZnQsIHJpZ2h0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpID49IDA7XG4gIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gIGlmICghYXJyb3dFbGVtZW50IHx8ICFwb3BwZXJPZmZzZXRzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHBhZGRpbmdPYmplY3QgPSB0b1BhZGRpbmdPYmplY3Qob3B0aW9ucy5wYWRkaW5nLCBzdGF0ZSk7XG4gIHZhciBhcnJvd1JlY3QgPSBnZXRMYXlvdXRSZWN0KGFycm93RWxlbWVudCk7XG4gIHZhciBtaW5Qcm9wID0gYXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgdmFyIG1heFByb3AgPSBheGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgdmFyIGVuZERpZmYgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbbGVuXSArIHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtheGlzXSAtIHBvcHBlck9mZnNldHNbYXhpc10gLSBzdGF0ZS5yZWN0cy5wb3BwZXJbbGVuXTtcbiAgdmFyIHN0YXJ0RGlmZiA9IHBvcHBlck9mZnNldHNbYXhpc10gLSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbYXhpc107XG4gIHZhciBhcnJvd09mZnNldFBhcmVudCA9IGdldE9mZnNldFBhcmVudChhcnJvd0VsZW1lbnQpO1xuICB2YXIgY2xpZW50U2l6ZSA9IGFycm93T2Zmc2V0UGFyZW50ID8gYXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50SGVpZ2h0IHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRXaWR0aCB8fCAwIDogMDtcbiAgdmFyIGNlbnRlclRvUmVmZXJlbmNlID0gZW5kRGlmZiAvIDIgLSBzdGFydERpZmYgLyAyOyAvLyBNYWtlIHN1cmUgdGhlIGFycm93IGRvZXNuJ3Qgb3ZlcmZsb3cgdGhlIHBvcHBlciBpZiB0aGUgY2VudGVyIHBvaW50IGlzXG4gIC8vIG91dHNpZGUgb2YgdGhlIHBvcHBlciBib3VuZHNcblxuICB2YXIgbWluID0gcGFkZGluZ09iamVjdFttaW5Qcm9wXTtcbiAgdmFyIG1heCA9IGNsaWVudFNpemUgLSBhcnJvd1JlY3RbbGVuXSAtIHBhZGRpbmdPYmplY3RbbWF4UHJvcF07XG4gIHZhciBjZW50ZXIgPSBjbGllbnRTaXplIC8gMiAtIGFycm93UmVjdFtsZW5dIC8gMiArIGNlbnRlclRvUmVmZXJlbmNlO1xuICB2YXIgb2Zmc2V0ID0gd2l0aGluKG1pbiwgY2VudGVyLCBtYXgpOyAvLyBQcmV2ZW50cyBicmVha2luZyBzeW50YXggaGlnaGxpZ2h0aW5nLi4uXG5cbiAgdmFyIGF4aXNQcm9wID0gYXhpcztcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IChfc3RhdGUkbW9kaWZpZXJzRGF0YSQgPSB7fSwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkW2F4aXNQcm9wXSA9IG9mZnNldCwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkLmNlbnRlck9mZnNldCA9IG9mZnNldCAtIGNlbnRlciwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkKTtcbn1cblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYyKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYyLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYyLm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRlbGVtZW50ID0gb3B0aW9ucy5lbGVtZW50LFxuICAgICAgYXJyb3dFbGVtZW50ID0gX29wdGlvbnMkZWxlbWVudCA9PT0gdm9pZCAwID8gJ1tkYXRhLXBvcHBlci1hcnJvd10nIDogX29wdGlvbnMkZWxlbWVudDtcblxuICBpZiAoYXJyb3dFbGVtZW50ID09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gQ1NTIHNlbGVjdG9yXG5cblxuICBpZiAodHlwZW9mIGFycm93RWxlbWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5wb3BwZXIucXVlcnlTZWxlY3RvcihhcnJvd0VsZW1lbnQpO1xuXG4gICAgaWYgKCFhcnJvd0VsZW1lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBpZiAoIWNvbnRhaW5zKHN0YXRlLmVsZW1lbnRzLnBvcHBlciwgYXJyb3dFbGVtZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHN0YXRlLmVsZW1lbnRzLmFycm93ID0gYXJyb3dFbGVtZW50O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXJyb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogYXJyb3csXG4gIGVmZmVjdDogZWZmZWN0LFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsncHJldmVudE92ZXJmbG93J11cbn07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFZhcmlhdGlvbihwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5zcGxpdCgnLScpWzFdO1xufSIsICJpbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBib3R0b20sIGVuZCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHVuc2V0U2lkZXMgPSB7XG4gIHRvcDogJ2F1dG8nLFxuICByaWdodDogJ2F1dG8nLFxuICBib3R0b206ICdhdXRvJyxcbiAgbGVmdDogJ2F1dG8nXG59OyAvLyBSb3VuZCB0aGUgb2Zmc2V0cyB0byB0aGUgbmVhcmVzdCBzdWl0YWJsZSBzdWJwaXhlbCBiYXNlZCBvbiB0aGUgRFBSLlxuLy8gWm9vbWluZyBjYW4gY2hhbmdlIHRoZSBEUFIsIGJ1dCBpdCBzZWVtcyB0byByZXBvcnQgYSB2YWx1ZSB0aGF0IHdpbGxcbi8vIGNsZWFubHkgZGl2aWRlIHRoZSB2YWx1ZXMgaW50byB0aGUgYXBwcm9wcmlhdGUgc3VicGl4ZWxzLlxuXG5mdW5jdGlvbiByb3VuZE9mZnNldHNCeURQUihfcmVmLCB3aW4pIHtcbiAgdmFyIHggPSBfcmVmLngsXG4gICAgICB5ID0gX3JlZi55O1xuICB2YXIgZHByID0gd2luLmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgcmV0dXJuIHtcbiAgICB4OiByb3VuZCh4ICogZHByKSAvIGRwciB8fCAwLFxuICAgIHk6IHJvdW5kKHkgKiBkcHIpIC8gZHByIHx8IDBcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcFRvU3R5bGVzKF9yZWYyKSB7XG4gIHZhciBfT2JqZWN0JGFzc2lnbjI7XG5cbiAgdmFyIHBvcHBlciA9IF9yZWYyLnBvcHBlcixcbiAgICAgIHBvcHBlclJlY3QgPSBfcmVmMi5wb3BwZXJSZWN0LFxuICAgICAgcGxhY2VtZW50ID0gX3JlZjIucGxhY2VtZW50LFxuICAgICAgdmFyaWF0aW9uID0gX3JlZjIudmFyaWF0aW9uLFxuICAgICAgb2Zmc2V0cyA9IF9yZWYyLm9mZnNldHMsXG4gICAgICBwb3NpdGlvbiA9IF9yZWYyLnBvc2l0aW9uLFxuICAgICAgZ3B1QWNjZWxlcmF0aW9uID0gX3JlZjIuZ3B1QWNjZWxlcmF0aW9uLFxuICAgICAgYWRhcHRpdmUgPSBfcmVmMi5hZGFwdGl2ZSxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9yZWYyLnJvdW5kT2Zmc2V0cyxcbiAgICAgIGlzRml4ZWQgPSBfcmVmMi5pc0ZpeGVkO1xuICB2YXIgX29mZnNldHMkeCA9IG9mZnNldHMueCxcbiAgICAgIHggPSBfb2Zmc2V0cyR4ID09PSB2b2lkIDAgPyAwIDogX29mZnNldHMkeCxcbiAgICAgIF9vZmZzZXRzJHkgPSBvZmZzZXRzLnksXG4gICAgICB5ID0gX29mZnNldHMkeSA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHk7XG5cbiAgdmFyIF9yZWYzID0gdHlwZW9mIHJvdW5kT2Zmc2V0cyA9PT0gJ2Z1bmN0aW9uJyA/IHJvdW5kT2Zmc2V0cyh7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0pIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmMy54O1xuICB5ID0gX3JlZjMueTtcbiAgdmFyIGhhc1ggPSBvZmZzZXRzLmhhc093blByb3BlcnR5KCd4Jyk7XG4gIHZhciBoYXNZID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneScpO1xuICB2YXIgc2lkZVggPSBsZWZ0O1xuICB2YXIgc2lkZVkgPSB0b3A7XG4gIHZhciB3aW4gPSB3aW5kb3c7XG5cbiAgaWYgKGFkYXB0aXZlKSB7XG4gICAgdmFyIG9mZnNldFBhcmVudCA9IGdldE9mZnNldFBhcmVudChwb3BwZXIpO1xuICAgIHZhciBoZWlnaHRQcm9wID0gJ2NsaWVudEhlaWdodCc7XG4gICAgdmFyIHdpZHRoUHJvcCA9ICdjbGllbnRXaWR0aCc7XG5cbiAgICBpZiAob2Zmc2V0UGFyZW50ID09PSBnZXRXaW5kb3cocG9wcGVyKSkge1xuICAgICAgb2Zmc2V0UGFyZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KHBvcHBlcik7XG5cbiAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gIT09ICdzdGF0aWMnICYmIHBvc2l0aW9uID09PSAnYWJzb2x1dGUnKSB7XG4gICAgICAgIGhlaWdodFByb3AgPSAnc2Nyb2xsSGVpZ2h0JztcbiAgICAgICAgd2lkdGhQcm9wID0gJ3Njcm9sbFdpZHRoJztcbiAgICAgIH1cbiAgICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhc3RdOiBmb3JjZSB0eXBlIHJlZmluZW1lbnQsIHdlIGNvbXBhcmUgb2Zmc2V0UGFyZW50IHdpdGggd2luZG93IGFib3ZlLCBidXQgRmxvdyBkb2Vzbid0IGRldGVjdCBpdFxuXG5cbiAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQ7XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSB0b3AgfHwgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCBwbGFjZW1lbnQgPT09IHJpZ2h0KSAmJiB2YXJpYXRpb24gPT09IGVuZCkge1xuICAgICAgc2lkZVkgPSBib3R0b207XG4gICAgICB2YXIgb2Zmc2V0WSA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LmhlaWdodCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W2hlaWdodFByb3BdO1xuICAgICAgeSAtPSBvZmZzZXRZIC0gcG9wcGVyUmVjdC5oZWlnaHQ7XG4gICAgICB5ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSBsZWZ0IHx8IChwbGFjZW1lbnQgPT09IHRvcCB8fCBwbGFjZW1lbnQgPT09IGJvdHRvbSkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVYID0gcmlnaHQ7XG4gICAgICB2YXIgb2Zmc2V0WCA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LndpZHRoIDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgICBvZmZzZXRQYXJlbnRbd2lkdGhQcm9wXTtcbiAgICAgIHggLT0gb2Zmc2V0WCAtIHBvcHBlclJlY3Qud2lkdGg7XG4gICAgICB4ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG4gIH1cblxuICB2YXIgY29tbW9uU3R5bGVzID0gT2JqZWN0LmFzc2lnbih7XG4gICAgcG9zaXRpb246IHBvc2l0aW9uXG4gIH0sIGFkYXB0aXZlICYmIHVuc2V0U2lkZXMpO1xuXG4gIHZhciBfcmVmNCA9IHJvdW5kT2Zmc2V0cyA9PT0gdHJ1ZSA/IHJvdW5kT2Zmc2V0c0J5RFBSKHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfSwgZ2V0V2luZG93KHBvcHBlcikpIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmNC54O1xuICB5ID0gX3JlZjQueTtcblxuICBpZiAoZ3B1QWNjZWxlcmF0aW9uKSB7XG4gICAgdmFyIF9PYmplY3QkYXNzaWduO1xuXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywgKF9PYmplY3QkYXNzaWduID0ge30sIF9PYmplY3QkYXNzaWduW3NpZGVZXSA9IGhhc1kgPyAnMCcgOiAnJywgX09iamVjdCRhc3NpZ25bc2lkZVhdID0gaGFzWCA/ICcwJyA6ICcnLCBfT2JqZWN0JGFzc2lnbi50cmFuc2Zvcm0gPSAod2luLmRldmljZVBpeGVsUmF0aW8gfHwgMSkgPD0gMSA/IFwidHJhbnNsYXRlKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgpXCIgOiBcInRyYW5zbGF0ZTNkKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgsIDApXCIsIF9PYmplY3QkYXNzaWduKSk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCAoX09iamVjdCRhc3NpZ24yID0ge30sIF9PYmplY3QkYXNzaWduMltzaWRlWV0gPSBoYXNZID8geSArIFwicHhcIiA6ICcnLCBfT2JqZWN0JGFzc2lnbjJbc2lkZVhdID0gaGFzWCA/IHggKyBcInB4XCIgOiAnJywgX09iamVjdCRhc3NpZ24yLnRyYW5zZm9ybSA9ICcnLCBfT2JqZWN0JGFzc2lnbjIpKTtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZVN0eWxlcyhfcmVmNSkge1xuICB2YXIgc3RhdGUgPSBfcmVmNS5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmNS5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZ3B1QWNjZWxlcmF0ID0gb3B0aW9ucy5ncHVBY2NlbGVyYXRpb24sXG4gICAgICBncHVBY2NlbGVyYXRpb24gPSBfb3B0aW9ucyRncHVBY2NlbGVyYXQgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRncHVBY2NlbGVyYXQsXG4gICAgICBfb3B0aW9ucyRhZGFwdGl2ZSA9IG9wdGlvbnMuYWRhcHRpdmUsXG4gICAgICBhZGFwdGl2ZSA9IF9vcHRpb25zJGFkYXB0aXZlID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkYWRhcHRpdmUsXG4gICAgICBfb3B0aW9ucyRyb3VuZE9mZnNldHMgPSBvcHRpb25zLnJvdW5kT2Zmc2V0cyxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9vcHRpb25zJHJvdW5kT2Zmc2V0cyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHJvdW5kT2Zmc2V0cztcbiAgdmFyIGNvbW1vblN0eWxlcyA9IHtcbiAgICBwbGFjZW1lbnQ6IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KSxcbiAgICB2YXJpYXRpb246IGdldFZhcmlhdGlvbihzdGF0ZS5wbGFjZW1lbnQpLFxuICAgIHBvcHBlcjogc3RhdGUuZWxlbWVudHMucG9wcGVyLFxuICAgIHBvcHBlclJlY3Q6IHN0YXRlLnJlY3RzLnBvcHBlcixcbiAgICBncHVBY2NlbGVyYXRpb246IGdwdUFjY2VsZXJhdGlvbixcbiAgICBpc0ZpeGVkOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnXG4gIH07XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnN0eWxlcy5wb3BwZXIsIG1hcFRvU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywge1xuICAgICAgb2Zmc2V0czogc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLFxuICAgICAgcG9zaXRpb246IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3ksXG4gICAgICBhZGFwdGl2ZTogYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHM6IHJvdW5kT2Zmc2V0c1xuICAgIH0pKSk7XG4gIH1cblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5hcnJvdyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLmFycm93ID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc3R5bGVzLmFycm93LCBtYXBUb1N0eWxlcyhPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIHtcbiAgICAgIG9mZnNldHM6IHN0YXRlLm1vZGlmaWVyc0RhdGEuYXJyb3csXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIGFkYXB0aXZlOiBmYWxzZSxcbiAgICAgIHJvdW5kT2Zmc2V0czogcm91bmRPZmZzZXRzXG4gICAgfSkpKTtcbiAgfVxuXG4gIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIsIHtcbiAgICAnZGF0YS1wb3BwZXItcGxhY2VtZW50Jzogc3RhdGUucGxhY2VtZW50XG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnY29tcHV0ZVN0eWxlcycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnYmVmb3JlV3JpdGUnLFxuICBmbjogY29tcHV0ZVN0eWxlcyxcbiAgZGF0YToge31cbn07IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRXaW5kb3cuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgcGFzc2l2ZSA9IHtcbiAgcGFzc2l2ZTogdHJ1ZVxufTtcblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIGluc3RhbmNlID0gX3JlZi5pbnN0YW5jZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRzY3JvbGwgPSBvcHRpb25zLnNjcm9sbCxcbiAgICAgIHNjcm9sbCA9IF9vcHRpb25zJHNjcm9sbCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHNjcm9sbCxcbiAgICAgIF9vcHRpb25zJHJlc2l6ZSA9IG9wdGlvbnMucmVzaXplLFxuICAgICAgcmVzaXplID0gX29wdGlvbnMkcmVzaXplID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkcmVzaXplO1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KHN0YXRlLmVsZW1lbnRzLnBvcHBlcik7XG4gIHZhciBzY3JvbGxQYXJlbnRzID0gW10uY29uY2F0KHN0YXRlLnNjcm9sbFBhcmVudHMucmVmZXJlbmNlLCBzdGF0ZS5zY3JvbGxQYXJlbnRzLnBvcHBlcik7XG5cbiAgaWYgKHNjcm9sbCkge1xuICAgIHNjcm9sbFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2Nyb2xsUGFyZW50KSB7XG4gICAgICBzY3JvbGxQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChyZXNpemUpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHNjcm9sbCkge1xuICAgICAgc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgICAgc2Nyb2xsUGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocmVzaXplKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9XG4gIH07XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdldmVudExpc3RlbmVycycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnd3JpdGUnLFxuICBmbjogZnVuY3Rpb24gZm4oKSB7fSxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIGRhdGE6IHt9XG59OyIsICJ2YXIgaGFzaCA9IHtcbiAgbGVmdDogJ3JpZ2h0JyxcbiAgcmlnaHQ6ICdsZWZ0JyxcbiAgYm90dG9tOiAndG9wJyxcbiAgdG9wOiAnYm90dG9tJ1xufTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9wcG9zaXRlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL2xlZnR8cmlnaHR8Ym90dG9tfHRvcC9nLCBmdW5jdGlvbiAobWF0Y2hlZCkge1xuICAgIHJldHVybiBoYXNoW21hdGNoZWRdO1xuICB9KTtcbn0iLCAidmFyIGhhc2ggPSB7XG4gIHN0YXJ0OiAnZW5kJyxcbiAgZW5kOiAnc3RhcnQnXG59O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQucmVwbGFjZSgvc3RhcnR8ZW5kL2csIGZ1bmN0aW9uIChtYXRjaGVkKSB7XG4gICAgcmV0dXJuIGhhc2hbbWF0Y2hlZF07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsKG5vZGUpIHtcbiAgdmFyIHdpbiA9IGdldFdpbmRvdyhub2RlKTtcbiAgdmFyIHNjcm9sbExlZnQgPSB3aW4ucGFnZVhPZmZzZXQ7XG4gIHZhciBzY3JvbGxUb3AgPSB3aW4ucGFnZVlPZmZzZXQ7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogc2Nyb2xsTGVmdCxcbiAgICBzY3JvbGxUb3A6IHNjcm9sbFRvcFxuICB9O1xufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpIHtcbiAgLy8gSWYgPGh0bWw+IGhhcyBhIENTUyB3aWR0aCBncmVhdGVyIHRoYW4gdGhlIHZpZXdwb3J0LCB0aGVuIHRoaXMgd2lsbCBiZVxuICAvLyBpbmNvcnJlY3QgZm9yIFJUTC5cbiAgLy8gUG9wcGVyIDEgaXMgYnJva2VuIGluIHRoaXMgY2FzZSBhbmQgbmV2ZXIgaGFkIGEgYnVnIHJlcG9ydCBzbyBsZXQncyBhc3N1bWVcbiAgLy8gaXQncyBub3QgYW4gaXNzdWUuIEkgZG9uJ3QgdGhpbmsgYW55b25lIGV2ZXIgc3BlY2lmaWVzIHdpZHRoIG9uIDxodG1sPlxuICAvLyBhbnl3YXkuXG4gIC8vIEJyb3dzZXJzIHdoZXJlIHRoZSBsZWZ0IHNjcm9sbGJhciBkb2Vzbid0IGNhdXNlIGFuIGlzc3VlIHJlcG9ydCBgMGAgZm9yXG4gIC8vIHRoaXMgKGUuZy4gRWRnZSAyMDE5LCBJRTExLCBTYWZhcmkpXG4gIHJldHVybiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpKS5sZWZ0ICsgZ2V0V2luZG93U2Nyb2xsKGVsZW1lbnQpLnNjcm9sbExlZnQ7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuaW1wb3J0IGlzTGF5b3V0Vmlld3BvcnQgZnJvbSBcIi4vaXNMYXlvdXRWaWV3cG9ydC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KSB7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coZWxlbWVudCk7XG4gIHZhciBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpO1xuICB2YXIgdmlzdWFsVmlld3BvcnQgPSB3aW4udmlzdWFsVmlld3BvcnQ7XG4gIHZhciB3aWR0aCA9IGh0bWwuY2xpZW50V2lkdGg7XG4gIHZhciBoZWlnaHQgPSBodG1sLmNsaWVudEhlaWdodDtcbiAgdmFyIHggPSAwO1xuICB2YXIgeSA9IDA7XG5cbiAgaWYgKHZpc3VhbFZpZXdwb3J0KSB7XG4gICAgd2lkdGggPSB2aXN1YWxWaWV3cG9ydC53aWR0aDtcbiAgICBoZWlnaHQgPSB2aXN1YWxWaWV3cG9ydC5oZWlnaHQ7XG4gICAgdmFyIGxheW91dFZpZXdwb3J0ID0gaXNMYXlvdXRWaWV3cG9ydCgpO1xuXG4gICAgaWYgKGxheW91dFZpZXdwb3J0IHx8ICFsYXlvdXRWaWV3cG9ydCAmJiBzdHJhdGVneSA9PT0gJ2ZpeGVkJykge1xuICAgICAgeCA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQ7XG4gICAgICB5ID0gdmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHg6IHggKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpLFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgeyBtYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBHZXRzIHRoZSBlbnRpcmUgc2l6ZSBvZiB0aGUgc2Nyb2xsYWJsZSBkb2N1bWVudCBhcmVhLCBldmVuIGV4dGVuZGluZyBvdXRzaWRlXG4vLyBvZiB0aGUgYDxodG1sPmAgYW5kIGA8Ym9keT5gIHJlY3QgYm91bmRzIGlmIGhvcml6b250YWxseSBzY3JvbGxhYmxlXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgdmFyIGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG4gIHZhciB3aW5TY3JvbGwgPSBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCk7XG4gIHZhciBib2R5ID0gKF9lbGVtZW50JG93bmVyRG9jdW1lbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lbGVtZW50JG93bmVyRG9jdW1lbi5ib2R5O1xuICB2YXIgd2lkdGggPSBtYXgoaHRtbC5zY3JvbGxXaWR0aCwgaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuc2Nyb2xsV2lkdGggOiAwLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApO1xuICB2YXIgaGVpZ2h0ID0gbWF4KGh0bWwuc2Nyb2xsSGVpZ2h0LCBodG1sLmNsaWVudEhlaWdodCwgYm9keSA/IGJvZHkuc2Nyb2xsSGVpZ2h0IDogMCwgYm9keSA/IGJvZHkuY2xpZW50SGVpZ2h0IDogMCk7XG4gIHZhciB4ID0gLXdpblNjcm9sbC5zY3JvbGxMZWZ0ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KTtcbiAgdmFyIHkgPSAtd2luU2Nyb2xsLnNjcm9sbFRvcDtcblxuICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShib2R5IHx8IGh0bWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICB4ICs9IG1heChodG1sLmNsaWVudFdpZHRoLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApIC0gd2lkdGg7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTY3JvbGxQYXJlbnQoZWxlbWVudCkge1xuICAvLyBGaXJlZm94IHdhbnRzIHVzIHRvIGNoZWNrIGAteGAgYW5kIGAteWAgdmFyaWF0aW9ucyBhcyB3ZWxsXG4gIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCksXG4gICAgICBvdmVyZmxvdyA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93LFxuICAgICAgb3ZlcmZsb3dYID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dYLFxuICAgICAgb3ZlcmZsb3dZID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dZO1xuXG4gIHJldHVybiAvYXV0b3xzY3JvbGx8b3ZlcmxheXxoaWRkZW4vLnRlc3Qob3ZlcmZsb3cgKyBvdmVyZmxvd1kgKyBvdmVyZmxvd1gpO1xufSIsICJpbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNjcm9sbFBhcmVudChub2RlKSB7XG4gIGlmIChbJ2h0bWwnLCAnYm9keScsICcjZG9jdW1lbnQnXS5pbmRleE9mKGdldE5vZGVOYW1lKG5vZGUpKSA+PSAwKSB7XG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQuYm9keTtcbiAgfVxuXG4gIGlmIChpc0hUTUxFbGVtZW50KG5vZGUpICYmIGlzU2Nyb2xsUGFyZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICByZXR1cm4gZ2V0U2Nyb2xsUGFyZW50KGdldFBhcmVudE5vZGUobm9kZSkpO1xufSIsICJpbXBvcnQgZ2V0U2Nyb2xsUGFyZW50IGZyb20gXCIuL2dldFNjcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuLypcbmdpdmVuIGEgRE9NIGVsZW1lbnQsIHJldHVybiB0aGUgbGlzdCBvZiBhbGwgc2Nyb2xsIHBhcmVudHMsIHVwIHRoZSBsaXN0IG9mIGFuY2Vzb3JzXG51bnRpbCB3ZSBnZXQgdG8gdGhlIHRvcCB3aW5kb3cgb2JqZWN0LiBUaGlzIGxpc3QgaXMgd2hhdCB3ZSBhdHRhY2ggc2Nyb2xsIGxpc3RlbmVyc1xudG8sIGJlY2F1c2UgaWYgYW55IG9mIHRoZXNlIHBhcmVudCBlbGVtZW50cyBzY3JvbGwsIHdlJ2xsIG5lZWQgdG8gcmUtY2FsY3VsYXRlIHRoZVxucmVmZXJlbmNlIGVsZW1lbnQncyBwb3NpdGlvbi5cbiovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpc3RTY3JvbGxQYXJlbnRzKGVsZW1lbnQsIGxpc3QpIHtcbiAgdmFyIF9lbGVtZW50JG93bmVyRG9jdW1lbjtcblxuICBpZiAobGlzdCA9PT0gdm9pZCAwKSB7XG4gICAgbGlzdCA9IFtdO1xuICB9XG5cbiAgdmFyIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudChlbGVtZW50KTtcbiAgdmFyIGlzQm9keSA9IHNjcm9sbFBhcmVudCA9PT0gKChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keSk7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coc2Nyb2xsUGFyZW50KTtcbiAgdmFyIHRhcmdldCA9IGlzQm9keSA/IFt3aW5dLmNvbmNhdCh3aW4udmlzdWFsVmlld3BvcnQgfHwgW10sIGlzU2Nyb2xsUGFyZW50KHNjcm9sbFBhcmVudCkgPyBzY3JvbGxQYXJlbnQgOiBbXSkgOiBzY3JvbGxQYXJlbnQ7XG4gIHZhciB1cGRhdGVkTGlzdCA9IGxpc3QuY29uY2F0KHRhcmdldCk7XG4gIHJldHVybiBpc0JvZHkgPyB1cGRhdGVkTGlzdCA6IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBpc0JvZHkgdGVsbHMgdXMgdGFyZ2V0IHdpbGwgYmUgYW4gSFRNTEVsZW1lbnQgaGVyZVxuICB1cGRhdGVkTGlzdC5jb25jYXQobGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZSh0YXJnZXQpKSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlY3RUb0NsaWVudFJlY3QocmVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVjdCwge1xuICAgIGxlZnQ6IHJlY3QueCxcbiAgICB0b3A6IHJlY3QueSxcbiAgICByaWdodDogcmVjdC54ICsgcmVjdC53aWR0aCxcbiAgICBib3R0b206IHJlY3QueSArIHJlY3QuaGVpZ2h0XG4gIH0pO1xufSIsICJpbXBvcnQgeyB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZpZXdwb3J0UmVjdCBmcm9tIFwiLi9nZXRWaWV3cG9ydFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudFJlY3QgZnJvbSBcIi4vZ2V0RG9jdW1lbnRSZWN0LmpzXCI7XG5pbXBvcnQgbGlzdFNjcm9sbFBhcmVudHMgZnJvbSBcIi4vbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi4vdXRpbHMvcmVjdFRvQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IHsgbWF4LCBtaW4gfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBnZXRJbm5lckJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBzdHJhdGVneSkge1xuICB2YXIgcmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBmYWxzZSwgc3RyYXRlZ3kgPT09ICdmaXhlZCcpO1xuICByZWN0LnRvcCA9IHJlY3QudG9wICsgZWxlbWVudC5jbGllbnRUb3A7XG4gIHJlY3QubGVmdCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdDtcbiAgcmVjdC5ib3R0b20gPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnJpZ2h0ID0gcmVjdC5sZWZ0ICsgZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgcmVjdC53aWR0aCA9IGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3QuaGVpZ2h0ID0gZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIHJlY3QueCA9IHJlY3QubGVmdDtcbiAgcmVjdC55ID0gcmVjdC50b3A7XG4gIHJldHVybiByZWN0O1xufVxuXG5mdW5jdGlvbiBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCwgc3RyYXRlZ3kpIHtcbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50ID09PSB2aWV3cG9ydCA/IHJlY3RUb0NsaWVudFJlY3QoZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KSkgOiBpc0VsZW1lbnQoY2xpcHBpbmdQYXJlbnQpID8gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoY2xpcHBpbmdQYXJlbnQsIHN0cmF0ZWd5KSA6IHJlY3RUb0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkpO1xufSAvLyBBIFwiY2xpcHBpbmcgcGFyZW50XCIgaXMgYW4gb3ZlcmZsb3dhYmxlIGNvbnRhaW5lciB3aXRoIHRoZSBjaGFyYWN0ZXJpc3RpYyBvZlxuLy8gY2xpcHBpbmcgKG9yIGhpZGluZykgb3ZlcmZsb3dpbmcgZWxlbWVudHMgd2l0aCBhIHBvc2l0aW9uIGRpZmZlcmVudCBmcm9tXG4vLyBgaW5pdGlhbGBcblxuXG5mdW5jdGlvbiBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkge1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gbGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZShlbGVtZW50KSk7XG4gIHZhciBjYW5Fc2NhcGVDbGlwcGluZyA9IFsnYWJzb2x1dGUnLCAnZml4ZWQnXS5pbmRleE9mKGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24pID49IDA7XG4gIHZhciBjbGlwcGVyRWxlbWVudCA9IGNhbkVzY2FwZUNsaXBwaW5nICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgPyBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkgOiBlbGVtZW50O1xuXG4gIGlmICghaXNFbGVtZW50KGNsaXBwZXJFbGVtZW50KSkge1xuICAgIHJldHVybiBbXTtcbiAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svZmxvdy9pc3N1ZXMvMTQxNFxuXG5cbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaXBwaW5nUGFyZW50KSB7XG4gICAgcmV0dXJuIGlzRWxlbWVudChjbGlwcGluZ1BhcmVudCkgJiYgY29udGFpbnMoY2xpcHBpbmdQYXJlbnQsIGNsaXBwZXJFbGVtZW50KSAmJiBnZXROb2RlTmFtZShjbGlwcGluZ1BhcmVudCkgIT09ICdib2R5JztcbiAgfSk7XG59IC8vIEdldHMgdGhlIG1heGltdW0gYXJlYSB0aGF0IHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gZHVlIHRvIGFueSBudW1iZXIgb2Zcbi8vIGNsaXBwaW5nIHBhcmVudHNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDbGlwcGluZ1JlY3QoZWxlbWVudCwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSwgc3RyYXRlZ3kpIHtcbiAgdmFyIG1haW5DbGlwcGluZ1BhcmVudHMgPSBib3VuZGFyeSA9PT0gJ2NsaXBwaW5nUGFyZW50cycgPyBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkgOiBbXS5jb25jYXQoYm91bmRhcnkpO1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gW10uY29uY2F0KG1haW5DbGlwcGluZ1BhcmVudHMsIFtyb290Qm91bmRhcnldKTtcbiAgdmFyIGZpcnN0Q2xpcHBpbmdQYXJlbnQgPSBjbGlwcGluZ1BhcmVudHNbMF07XG4gIHZhciBjbGlwcGluZ1JlY3QgPSBjbGlwcGluZ1BhcmVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2NSZWN0LCBjbGlwcGluZ1BhcmVudCkge1xuICAgIHZhciByZWN0ID0gZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgY2xpcHBpbmdQYXJlbnQsIHN0cmF0ZWd5KTtcbiAgICBhY2NSZWN0LnRvcCA9IG1heChyZWN0LnRvcCwgYWNjUmVjdC50b3ApO1xuICAgIGFjY1JlY3QucmlnaHQgPSBtaW4ocmVjdC5yaWdodCwgYWNjUmVjdC5yaWdodCk7XG4gICAgYWNjUmVjdC5ib3R0b20gPSBtaW4ocmVjdC5ib3R0b20sIGFjY1JlY3QuYm90dG9tKTtcbiAgICBhY2NSZWN0LmxlZnQgPSBtYXgocmVjdC5sZWZ0LCBhY2NSZWN0LmxlZnQpO1xuICAgIHJldHVybiBhY2NSZWN0O1xuICB9LCBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBmaXJzdENsaXBwaW5nUGFyZW50LCBzdHJhdGVneSkpO1xuICBjbGlwcGluZ1JlY3Qud2lkdGggPSBjbGlwcGluZ1JlY3QucmlnaHQgLSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LmhlaWdodCA9IGNsaXBwaW5nUmVjdC5ib3R0b20gLSBjbGlwcGluZ1JlY3QudG9wO1xuICBjbGlwcGluZ1JlY3QueCA9IGNsaXBwaW5nUmVjdC5sZWZ0O1xuICBjbGlwcGluZ1JlY3QueSA9IGNsaXBwaW5nUmVjdC50b3A7XG4gIHJldHVybiBjbGlwcGluZ1JlY3Q7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0LCBzdGFydCwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciByZWZlcmVuY2UgPSBfcmVmLnJlZmVyZW5jZSxcbiAgICAgIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQsXG4gICAgICBwbGFjZW1lbnQgPSBfcmVmLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBwbGFjZW1lbnQgPyBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgdmFyaWF0aW9uID0gcGxhY2VtZW50ID8gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgY29tbW9uWCA9IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoIC8gMiAtIGVsZW1lbnQud2lkdGggLyAyO1xuICB2YXIgY29tbW9uWSA9IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodCAvIDIgLSBlbGVtZW50LmhlaWdodCAvIDI7XG4gIHZhciBvZmZzZXRzO1xuXG4gIHN3aXRjaCAoYmFzZVBsYWNlbWVudCkge1xuICAgIGNhc2UgdG9wOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgLSBlbGVtZW50LmhlaWdodFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBib3R0b206XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiBjb21tb25YLFxuICAgICAgICB5OiByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgcmlnaHQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBsZWZ0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggLSBlbGVtZW50LndpZHRoLFxuICAgICAgICB5OiBjb21tb25ZXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLngsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55XG4gICAgICB9O1xuICB9XG5cbiAgdmFyIG1haW5BeGlzID0gYmFzZVBsYWNlbWVudCA/IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KSA6IG51bGw7XG5cbiAgaWYgKG1haW5BeGlzICE9IG51bGwpIHtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHN3aXRjaCAodmFyaWF0aW9uKSB7XG4gICAgICBjYXNlIHN0YXJ0OlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdIC0gKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBlbmQ6XG4gICAgICAgIG9mZnNldHNbbWFpbkF4aXNdID0gb2Zmc2V0c1ttYWluQXhpc10gKyAocmVmZXJlbmNlW2xlbl0gLyAyIC0gZWxlbWVudFtsZW5dIC8gMik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0Q2xpcHBpbmdSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4vY29tcHV0ZU9mZnNldHMuanNcIjtcbmltcG9ydCByZWN0VG9DbGllbnRSZWN0IGZyb20gXCIuL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IGNsaXBwaW5nUGFyZW50cywgcmVmZXJlbmNlLCBwb3BwZXIsIGJvdHRvbSwgdG9wLCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHZpZXdwb3J0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4vbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuL2V4cGFuZFRvSGFzaE1hcC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRldGVjdE92ZXJmbG93KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgX29wdGlvbnMkcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMkcGxhY2VtZW50ID09PSB2b2lkIDAgPyBzdGF0ZS5wbGFjZW1lbnQgOiBfb3B0aW9ucyRwbGFjZW1lbnQsXG4gICAgICBfb3B0aW9ucyRzdHJhdGVneSA9IF9vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgc3RyYXRlZ3kgPSBfb3B0aW9ucyRzdHJhdGVneSA9PT0gdm9pZCAwID8gc3RhdGUuc3RyYXRlZ3kgOiBfb3B0aW9ucyRzdHJhdGVneSxcbiAgICAgIF9vcHRpb25zJGJvdW5kYXJ5ID0gX29wdGlvbnMuYm91bmRhcnksXG4gICAgICBib3VuZGFyeSA9IF9vcHRpb25zJGJvdW5kYXJ5ID09PSB2b2lkIDAgPyBjbGlwcGluZ1BhcmVudHMgOiBfb3B0aW9ucyRib3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9PT0gdm9pZCAwID8gdmlld3BvcnQgOiBfb3B0aW9ucyRyb290Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRlbGVtZW50Q29udGUgPSBfb3B0aW9ucy5lbGVtZW50Q29udGV4dCxcbiAgICAgIGVsZW1lbnRDb250ZXh0ID0gX29wdGlvbnMkZWxlbWVudENvbnRlID09PSB2b2lkIDAgPyBwb3BwZXIgOiBfb3B0aW9ucyRlbGVtZW50Q29udGUsXG4gICAgICBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9IF9vcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRhbHRCb3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgcGFkZGluZyA9IF9vcHRpb25zJHBhZGRpbmcgPT09IHZvaWQgMCA/IDAgOiBfb3B0aW9ucyRwYWRkaW5nO1xuICB2YXIgcGFkZGluZ09iamVjdCA9IG1lcmdlUGFkZGluZ09iamVjdCh0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBwYWRkaW5nIDogZXhwYW5kVG9IYXNoTWFwKHBhZGRpbmcsIGJhc2VQbGFjZW1lbnRzKSk7XG4gIHZhciBhbHRDb250ZXh0ID0gZWxlbWVudENvbnRleHQgPT09IHBvcHBlciA/IHJlZmVyZW5jZSA6IHBvcHBlcjtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBlbGVtZW50ID0gc3RhdGUuZWxlbWVudHNbYWx0Qm91bmRhcnkgPyBhbHRDb250ZXh0IDogZWxlbWVudENvbnRleHRdO1xuICB2YXIgY2xpcHBpbmdDbGllbnRSZWN0ID0gZ2V0Q2xpcHBpbmdSZWN0KGlzRWxlbWVudChlbGVtZW50KSA/IGVsZW1lbnQgOiBlbGVtZW50LmNvbnRleHRFbGVtZW50IHx8IGdldERvY3VtZW50RWxlbWVudChzdGF0ZS5lbGVtZW50cy5wb3BwZXIpLCBib3VuZGFyeSwgcm9vdEJvdW5kYXJ5LCBzdHJhdGVneSk7XG4gIHZhciByZWZlcmVuY2VDbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KHN0YXRlLmVsZW1lbnRzLnJlZmVyZW5jZSk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gY29tcHV0ZU9mZnNldHMoe1xuICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlQ2xpZW50UmVjdCxcbiAgICBlbGVtZW50OiBwb3BwZXJSZWN0LFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pO1xuICB2YXIgcG9wcGVyQ2xpZW50UmVjdCA9IHJlY3RUb0NsaWVudFJlY3QoT2JqZWN0LmFzc2lnbih7fSwgcG9wcGVyUmVjdCwgcG9wcGVyT2Zmc2V0cykpO1xuICB2YXIgZWxlbWVudENsaWVudFJlY3QgPSBlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyID8gcG9wcGVyQ2xpZW50UmVjdCA6IHJlZmVyZW5jZUNsaWVudFJlY3Q7IC8vIHBvc2l0aXZlID0gb3ZlcmZsb3dpbmcgdGhlIGNsaXBwaW5nIHJlY3RcbiAgLy8gMCBvciBuZWdhdGl2ZSA9IHdpdGhpbiB0aGUgY2xpcHBpbmcgcmVjdFxuXG4gIHZhciBvdmVyZmxvd09mZnNldHMgPSB7XG4gICAgdG9wOiBjbGlwcGluZ0NsaWVudFJlY3QudG9wIC0gZWxlbWVudENsaWVudFJlY3QudG9wICsgcGFkZGluZ09iamVjdC50b3AsXG4gICAgYm90dG9tOiBlbGVtZW50Q2xpZW50UmVjdC5ib3R0b20gLSBjbGlwcGluZ0NsaWVudFJlY3QuYm90dG9tICsgcGFkZGluZ09iamVjdC5ib3R0b20sXG4gICAgbGVmdDogY2xpcHBpbmdDbGllbnRSZWN0LmxlZnQgLSBlbGVtZW50Q2xpZW50UmVjdC5sZWZ0ICsgcGFkZGluZ09iamVjdC5sZWZ0LFxuICAgIHJpZ2h0OiBlbGVtZW50Q2xpZW50UmVjdC5yaWdodCAtIGNsaXBwaW5nQ2xpZW50UmVjdC5yaWdodCArIHBhZGRpbmdPYmplY3QucmlnaHRcbiAgfTtcbiAgdmFyIG9mZnNldERhdGEgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldDsgLy8gT2Zmc2V0cyBjYW4gYmUgYXBwbGllZCBvbmx5IHRvIHRoZSBwb3BwZXIgZWxlbWVudFxuXG4gIGlmIChlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyICYmIG9mZnNldERhdGEpIHtcbiAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0RGF0YVtwbGFjZW1lbnRdO1xuICAgIE9iamVjdC5rZXlzKG92ZXJmbG93T2Zmc2V0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgbXVsdGlwbHkgPSBbcmlnaHQsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAxIDogLTE7XG4gICAgICB2YXIgYXhpcyA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAneScgOiAneCc7XG4gICAgICBvdmVyZmxvd09mZnNldHNba2V5XSArPSBvZmZzZXRbYXhpc10gKiBtdWx0aXBseTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvdmVyZmxvd09mZnNldHM7XG59IiwgImltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyB2YXJpYXRpb25QbGFjZW1lbnRzLCBiYXNlUGxhY2VtZW50cywgcGxhY2VtZW50cyBhcyBhbGxQbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbXB1dGVBdXRvUGxhY2VtZW50KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9IF9vcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50cyA9IF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9PT0gdm9pZCAwID8gYWxsUGxhY2VtZW50cyA6IF9vcHRpb25zJGFsbG93ZWRBdXRvUDtcbiAgdmFyIHZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpO1xuICB2YXIgcGxhY2VtZW50cyA9IHZhcmlhdGlvbiA/IGZsaXBWYXJpYXRpb25zID8gdmFyaWF0aW9uUGxhY2VtZW50cyA6IHZhcmlhdGlvblBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHZhcmlhdGlvbjtcbiAgfSkgOiBiYXNlUGxhY2VtZW50cztcbiAgdmFyIGFsbG93ZWRQbGFjZW1lbnRzID0gcGxhY2VtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgIHJldHVybiBhbGxvd2VkQXV0b1BsYWNlbWVudHMuaW5kZXhPZihwbGFjZW1lbnQpID49IDA7XG4gIH0pO1xuXG4gIGlmIChhbGxvd2VkUGxhY2VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHM7XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtdHlwZV06IEZsb3cgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtcyB3aXRoIHR3byBhcnJheSB1bmlvbnMuLi5cblxuXG4gIHZhciBvdmVyZmxvd3MgPSBhbGxvd2VkUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgYWNjW3BsYWNlbWVudF0gPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KVtnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCldO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG92ZXJmbG93cykuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBvdmVyZmxvd3NbYV0gLSBvdmVyZmxvd3NbYl07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0T3Bwb3NpdGVQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE9wcG9zaXRlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVBdXRvUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9jb21wdXRlQXV0b1BsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgYm90dG9tLCB0b3AsIHN0YXJ0LCByaWdodCwgbGVmdCwgYXV0byB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZnVuY3Rpb24gZ2V0RXhwYW5kZWRGYWxsYmFja1BsYWNlbWVudHMocGxhY2VtZW50KSB7XG4gIGlmIChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB2YXIgb3Bwb3NpdGVQbGFjZW1lbnQgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuICByZXR1cm4gW2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCksIG9wcG9zaXRlUGxhY2VtZW50LCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChvcHBvc2l0ZVBsYWNlbWVudCldO1xufVxuXG5mdW5jdGlvbiBmbGlwKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdLl9za2lwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIF9vcHRpb25zJG1haW5BeGlzID0gb3B0aW9ucy5tYWluQXhpcyxcbiAgICAgIGNoZWNrTWFpbkF4aXMgPSBfb3B0aW9ucyRtYWluQXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJG1haW5BeGlzLFxuICAgICAgX29wdGlvbnMkYWx0QXhpcyA9IG9wdGlvbnMuYWx0QXhpcyxcbiAgICAgIGNoZWNrQWx0QXhpcyA9IF9vcHRpb25zJGFsdEF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzID0gb3B0aW9ucy5mYWxsYmFja1BsYWNlbWVudHMsXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPSBvcHRpb25zLmZsaXBWYXJpYXRpb25zLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRmbGlwVmFyaWF0aW8sXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBvcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cztcbiAgdmFyIHByZWZlcnJlZFBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50O1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9IGJhc2VQbGFjZW1lbnQgPT09IHByZWZlcnJlZFBsYWNlbWVudDtcbiAgdmFyIGZhbGxiYWNrUGxhY2VtZW50cyA9IHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyB8fCAoaXNCYXNlUGxhY2VtZW50IHx8ICFmbGlwVmFyaWF0aW9ucyA/IFtnZXRPcHBvc2l0ZVBsYWNlbWVudChwcmVmZXJyZWRQbGFjZW1lbnQpXSA6IGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHByZWZlcnJlZFBsYWNlbWVudCkpO1xuICB2YXIgcGxhY2VtZW50cyA9IFtwcmVmZXJyZWRQbGFjZW1lbnRdLmNvbmNhdChmYWxsYmFja1BsYWNlbWVudHMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8gPyBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICBmbGlwVmFyaWF0aW9uczogZmxpcFZhcmlhdGlvbnMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHM6IGFsbG93ZWRBdXRvUGxhY2VtZW50c1xuICAgIH0pIDogcGxhY2VtZW50KTtcbiAgfSwgW10pO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBjaGVja3NNYXAgPSBuZXcgTWFwKCk7XG4gIHZhciBtYWtlRmFsbGJhY2tDaGVja3MgPSB0cnVlO1xuICB2YXIgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50c1swXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcGxhY2VtZW50ID0gcGxhY2VtZW50c1tpXTtcblxuICAgIHZhciBfYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcblxuICAgIHZhciBpc1N0YXJ0VmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHN0YXJ0O1xuICAgIHZhciBpc1ZlcnRpY2FsID0gW3RvcCwgYm90dG9tXS5pbmRleE9mKF9iYXNlUGxhY2VtZW50KSA+PSAwO1xuICAgIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIHZhciBvdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnk6IGFsdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZ1xuICAgIH0pO1xuICAgIHZhciBtYWluVmFyaWF0aW9uU2lkZSA9IGlzVmVydGljYWwgPyBpc1N0YXJ0VmFyaWF0aW9uID8gcmlnaHQgOiBsZWZ0IDogaXNTdGFydFZhcmlhdGlvbiA/IGJvdHRvbSA6IHRvcDtcblxuICAgIGlmIChyZWZlcmVuY2VSZWN0W2xlbl0gPiBwb3BwZXJSZWN0W2xlbl0pIHtcbiAgICAgIG1haW5WYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIH1cblxuICAgIHZhciBhbHRWYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIHZhciBjaGVja3MgPSBbXTtcblxuICAgIGlmIChjaGVja01haW5BeGlzKSB7XG4gICAgICBjaGVja3MucHVzaChvdmVyZmxvd1tfYmFzZVBsYWNlbWVudF0gPD0gMCk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrQWx0QXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbbWFpblZhcmlhdGlvblNpZGVdIDw9IDAsIG92ZXJmbG93W2FsdFZhcmlhdGlvblNpZGVdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja3MuZXZlcnkoZnVuY3Rpb24gKGNoZWNrKSB7XG4gICAgICByZXR1cm4gY2hlY2s7XG4gICAgfSkpIHtcbiAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudDtcbiAgICAgIG1ha2VGYWxsYmFja0NoZWNrcyA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY2hlY2tzTWFwLnNldChwbGFjZW1lbnQsIGNoZWNrcyk7XG4gIH1cblxuICBpZiAobWFrZUZhbGxiYWNrQ2hlY2tzKSB7XG4gICAgLy8gYDJgIG1heSBiZSBkZXNpcmVkIGluIHNvbWUgY2FzZXMgXHUyMDEzIHJlc2VhcmNoIGxhdGVyXG4gICAgdmFyIG51bWJlck9mQ2hlY2tzID0gZmxpcFZhcmlhdGlvbnMgPyAzIDogMTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pKSB7XG4gICAgICB2YXIgZml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHMuZmluZChmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgICAgIHZhciBjaGVja3MgPSBjaGVja3NNYXAuZ2V0KHBsYWNlbWVudCk7XG5cbiAgICAgICAgaWYgKGNoZWNrcykge1xuICAgICAgICAgIHJldHVybiBjaGVja3Muc2xpY2UoMCwgX2kpLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGZpdHRpbmdQbGFjZW1lbnQpIHtcbiAgICAgICAgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gZml0dGluZ1BsYWNlbWVudDtcbiAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2kgPSBudW1iZXJPZkNoZWNrczsgX2kgPiAwOyBfaS0tKSB7XG4gICAgICB2YXIgX3JldCA9IF9sb29wKF9pKTtcblxuICAgICAgaWYgKF9yZXQgPT09IFwiYnJlYWtcIikgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0YXRlLnBsYWNlbWVudCAhPT0gZmlyc3RGaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCA9IHRydWU7XG4gICAgc3RhdGUucGxhY2VtZW50ID0gZmlyc3RGaXR0aW5nUGxhY2VtZW50O1xuICAgIHN0YXRlLnJlc2V0ID0gdHJ1ZTtcbiAgfVxufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZmxpcCcsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBmbGlwLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddLFxuICBkYXRhOiB7XG4gICAgX3NraXA6IGZhbHNlXG4gIH1cbn07IiwgImltcG9ydCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuXG5mdW5jdGlvbiBnZXRTaWRlT2Zmc2V0cyhvdmVyZmxvdywgcmVjdCwgcHJldmVudGVkT2Zmc2V0cykge1xuICBpZiAocHJldmVudGVkT2Zmc2V0cyA9PT0gdm9pZCAwKSB7XG4gICAgcHJldmVudGVkT2Zmc2V0cyA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdG9wOiBvdmVyZmxvdy50b3AgLSByZWN0LmhlaWdodCAtIHByZXZlbnRlZE9mZnNldHMueSxcbiAgICByaWdodDogb3ZlcmZsb3cucmlnaHQgLSByZWN0LndpZHRoICsgcHJldmVudGVkT2Zmc2V0cy54LFxuICAgIGJvdHRvbTogb3ZlcmZsb3cuYm90dG9tIC0gcmVjdC5oZWlnaHQgKyBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgbGVmdDogb3ZlcmZsb3cubGVmdCAtIHJlY3Qud2lkdGggLSBwcmV2ZW50ZWRPZmZzZXRzLnhcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKG92ZXJmbG93KSB7XG4gIHJldHVybiBbdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0XS5zb21lKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgcmV0dXJuIG92ZXJmbG93W3NpZGVdID49IDA7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoaWRlKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHByZXZlbnRlZE9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnByZXZlbnRPdmVyZmxvdztcbiAgdmFyIHJlZmVyZW5jZU92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBlbGVtZW50Q29udGV4dDogJ3JlZmVyZW5jZSdcbiAgfSk7XG4gIHZhciBwb3BwZXJBbHRPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgYWx0Qm91bmRhcnk6IHRydWVcbiAgfSk7XG4gIHZhciByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMgPSBnZXRTaWRlT2Zmc2V0cyhyZWZlcmVuY2VPdmVyZmxvdywgcmVmZXJlbmNlUmVjdCk7XG4gIHZhciBwb3BwZXJFc2NhcGVPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocG9wcGVyQWx0T3ZlcmZsb3csIHBvcHBlclJlY3QsIHByZXZlbnRlZE9mZnNldHMpO1xuICB2YXIgaXNSZWZlcmVuY2VIaWRkZW4gPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzKTtcbiAgdmFyIGhhc1BvcHBlckVzY2FwZWQgPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocG9wcGVyRXNjYXBlT2Zmc2V0cyk7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSB7XG4gICAgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzOiByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMsXG4gICAgcG9wcGVyRXNjYXBlT2Zmc2V0czogcG9wcGVyRXNjYXBlT2Zmc2V0cyxcbiAgICBpc1JlZmVyZW5jZUhpZGRlbjogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgaGFzUG9wcGVyRXNjYXBlZDogaGFzUG9wcGVyRXNjYXBlZFxuICB9O1xuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXJlZmVyZW5jZS1oaWRkZW4nOiBpc1JlZmVyZW5jZUhpZGRlbixcbiAgICAnZGF0YS1wb3BwZXItZXNjYXBlZCc6IGhhc1BvcHBlckVzY2FwZWRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdoaWRlJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXSxcbiAgZm46IGhpZGVcbn07IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBwbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgcmVjdHMsIG9mZnNldCkge1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgdmFyIGludmVydERpc3RhbmNlID0gW2xlZnQsIHRvcF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwID8gLTEgOiAxO1xuXG4gIHZhciBfcmVmID0gdHlwZW9mIG9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IG9mZnNldChPYmplY3QuYXNzaWduKHt9LCByZWN0cywge1xuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pKSA6IG9mZnNldCxcbiAgICAgIHNraWRkaW5nID0gX3JlZlswXSxcbiAgICAgIGRpc3RhbmNlID0gX3JlZlsxXTtcblxuICBza2lkZGluZyA9IHNraWRkaW5nIHx8IDA7XG4gIGRpc3RhbmNlID0gKGRpc3RhbmNlIHx8IDApICogaW52ZXJ0RGlzdGFuY2U7XG4gIHJldHVybiBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IHtcbiAgICB4OiBkaXN0YW5jZSxcbiAgICB5OiBza2lkZGluZ1xuICB9IDoge1xuICAgIHg6IHNraWRkaW5nLFxuICAgIHk6IGRpc3RhbmNlXG4gIH07XG59XG5cbmZ1bmN0aW9uIG9mZnNldChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYyLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRvZmZzZXQgPSBvcHRpb25zLm9mZnNldCxcbiAgICAgIG9mZnNldCA9IF9vcHRpb25zJG9mZnNldCA9PT0gdm9pZCAwID8gWzAsIDBdIDogX29wdGlvbnMkb2Zmc2V0O1xuICB2YXIgZGF0YSA9IHBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGlzdGFuY2VBbmRTa2lkZGluZ1RvWFkocGxhY2VtZW50LCBzdGF0ZS5yZWN0cywgb2Zmc2V0KTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHZhciBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQgPSBkYXRhW3N0YXRlLnBsYWNlbWVudF0sXG4gICAgICB4ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50LngsXG4gICAgICB5ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50Lnk7XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnggKz0geDtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMueSArPSB5O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdvZmZzZXQnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIGZuOiBvZmZzZXRcbn07IiwgImltcG9ydCBjb21wdXRlT2Zmc2V0cyBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZU9mZnNldHMuanNcIjtcblxuZnVuY3Rpb24gcG9wcGVyT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICAvLyBPZmZzZXRzIGFyZSB0aGUgYWN0dWFsIHBvc2l0aW9uIHRoZSBwb3BwZXIgbmVlZHMgdG8gaGF2ZSB0byBiZVxuICAvLyBwcm9wZXJseSBwb3NpdGlvbmVkIG5lYXIgaXRzIHJlZmVyZW5jZSBlbGVtZW50XG4gIC8vIFRoaXMgaXMgdGhlIG1vc3QgYmFzaWMgcGxhY2VtZW50LCBhbmQgd2lsbCBiZSBhZGp1c3RlZCBieVxuICAvLyB0aGUgbW9kaWZpZXJzIGluIHRoZSBuZXh0IHN0ZXBcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHN0YXRlLnJlY3RzLnJlZmVyZW5jZSxcbiAgICBlbGVtZW50OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgc3RyYXRlZ3k6ICdhYnNvbHV0ZScsXG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwb3BwZXJPZmZzZXRzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdyZWFkJyxcbiAgZm46IHBvcHBlck9mZnNldHMsXG4gIGRhdGE6IHt9XG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRBbHRBeGlzKGF4aXMpIHtcbiAgcmV0dXJuIGF4aXMgPT09ICd4JyA/ICd5JyA6ICd4Jztcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBzdGFydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEFsdEF4aXMgZnJvbSBcIi4uL3V0aWxzL2dldEFsdEF4aXMuanNcIjtcbmltcG9ydCB7IHdpdGhpbiwgd2l0aGluTWF4Q2xhbXAgfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi4vdXRpbHMvZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5pbXBvcnQgeyBtaW4gYXMgbWF0aE1pbiwgbWF4IGFzIG1hdGhNYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBwcmV2ZW50T3ZlcmZsb3coX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJGFsdEF4aXMsXG4gICAgICBib3VuZGFyeSA9IG9wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBvcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBvcHRpb25zLnBhZGRpbmcsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXIgPSBvcHRpb25zLnRldGhlcixcbiAgICAgIHRldGhlciA9IF9vcHRpb25zJHRldGhlciA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRldGhlcixcbiAgICAgIF9vcHRpb25zJHRldGhlck9mZnNldCA9IG9wdGlvbnMudGV0aGVyT2Zmc2V0LFxuICAgICAgdGV0aGVyT2Zmc2V0ID0gX29wdGlvbnMkdGV0aGVyT2Zmc2V0ID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkdGV0aGVyT2Zmc2V0O1xuICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeVxuICB9KTtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9ICF2YXJpYXRpb247XG4gIHZhciBtYWluQXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGFsdEF4aXMgPSBnZXRBbHRBeGlzKG1haW5BeGlzKTtcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHRldGhlck9mZnNldFZhbHVlID0gdHlwZW9mIHRldGhlck9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IHRldGhlck9mZnNldChPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHRldGhlck9mZnNldDtcbiAgdmFyIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXRWYWx1ZSA9PT0gJ251bWJlcicgPyB7XG4gICAgbWFpbkF4aXM6IHRldGhlck9mZnNldFZhbHVlLFxuICAgIGFsdEF4aXM6IHRldGhlck9mZnNldFZhbHVlXG4gIH0gOiBPYmplY3QuYXNzaWduKHtcbiAgICBtYWluQXhpczogMCxcbiAgICBhbHRBeGlzOiAwXG4gIH0sIHRldGhlck9mZnNldFZhbHVlKTtcbiAgdmFyIG9mZnNldE1vZGlmaWVyU3RhdGUgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldCA/IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0W3N0YXRlLnBsYWNlbWVudF0gOiBudWxsO1xuICB2YXIgZGF0YSA9IHtcbiAgICB4OiAwLFxuICAgIHk6IDBcbiAgfTtcblxuICBpZiAoIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQ7XG5cbiAgICB2YXIgbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgICB2YXIgYWx0U2lkZSA9IG1haW5BeGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcbiAgICB2YXIgb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1ttYWluQXhpc107XG4gICAgdmFyIG1pbiA9IG9mZnNldCArIG92ZXJmbG93W21haW5TaWRlXTtcbiAgICB2YXIgbWF4ID0gb2Zmc2V0IC0gb3ZlcmZsb3dbYWx0U2lkZV07XG4gICAgdmFyIGFkZGl0aXZlID0gdGV0aGVyID8gLXBvcHBlclJlY3RbbGVuXSAvIDIgOiAwO1xuICAgIHZhciBtaW5MZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gcmVmZXJlbmNlUmVjdFtsZW5dIDogcG9wcGVyUmVjdFtsZW5dO1xuICAgIHZhciBtYXhMZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gLXBvcHBlclJlY3RbbGVuXSA6IC1yZWZlcmVuY2VSZWN0W2xlbl07IC8vIFdlIG5lZWQgdG8gaW5jbHVkZSB0aGUgYXJyb3cgaW4gdGhlIGNhbGN1bGF0aW9uIHNvIHRoZSBhcnJvdyBkb2Vzbid0IGdvXG4gICAgLy8gb3V0c2lkZSB0aGUgcmVmZXJlbmNlIGJvdW5kc1xuXG4gICAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICAgIHZhciBhcnJvd1JlY3QgPSB0ZXRoZXIgJiYgYXJyb3dFbGVtZW50ID8gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpIDoge1xuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIHZhciBhcnJvd1BhZGRpbmdPYmplY3QgPSBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10gPyBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10ucGFkZGluZyA6IGdldEZyZXNoU2lkZU9iamVjdCgpO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNaW4gPSBhcnJvd1BhZGRpbmdPYmplY3RbbWFpblNpZGVdO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNYXggPSBhcnJvd1BhZGRpbmdPYmplY3RbYWx0U2lkZV07IC8vIElmIHRoZSByZWZlcmVuY2UgbGVuZ3RoIGlzIHNtYWxsZXIgdGhhbiB0aGUgYXJyb3cgbGVuZ3RoLCB3ZSBkb24ndCB3YW50XG4gICAgLy8gdG8gaW5jbHVkZSBpdHMgZnVsbCBzaXplIGluIHRoZSBjYWxjdWxhdGlvbi4gSWYgdGhlIHJlZmVyZW5jZSBpcyBzbWFsbFxuICAgIC8vIGFuZCBuZWFyIHRoZSBlZGdlIG9mIGEgYm91bmRhcnksIHRoZSBwb3BwZXIgY2FuIG92ZXJmbG93IGV2ZW4gaWYgdGhlXG4gICAgLy8gcmVmZXJlbmNlIGlzIG5vdCBvdmVyZmxvd2luZyBhcyB3ZWxsIChlLmcuIHZpcnR1YWwgZWxlbWVudHMgd2l0aCBub1xuICAgIC8vIHdpZHRoIG9yIGhlaWdodClcblxuICAgIHZhciBhcnJvd0xlbiA9IHdpdGhpbigwLCByZWZlcmVuY2VSZWN0W2xlbl0sIGFycm93UmVjdFtsZW5dKTtcbiAgICB2YXIgbWluT2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gcmVmZXJlbmNlUmVjdFtsZW5dIC8gMiAtIGFkZGl0aXZlIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXMgOiBtaW5MZW4gLSBhcnJvd0xlbiAtIGFycm93UGFkZGluZ01pbiAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcztcbiAgICB2YXIgbWF4T2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gLXJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgKyBhZGRpdGl2ZSArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWF4TGVuICsgYXJyb3dMZW4gKyBhcnJvd1BhZGRpbmdNYXggKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3cgJiYgZ2V0T2Zmc2V0UGFyZW50KHN0YXRlLmVsZW1lbnRzLmFycm93KTtcbiAgICB2YXIgY2xpZW50T2Zmc2V0ID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBtYWluQXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50VG9wIHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRMZWZ0IHx8IDAgOiAwO1xuICAgIHZhciBvZmZzZXRNb2RpZmllclZhbHVlID0gKF9vZmZzZXRNb2RpZmllclN0YXRlJCA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbbWFpbkF4aXNdKSAhPSBudWxsID8gX29mZnNldE1vZGlmaWVyU3RhdGUkIDogMDtcbiAgICB2YXIgdGV0aGVyTWluID0gb2Zmc2V0ICsgbWluT2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZSAtIGNsaWVudE9mZnNldDtcbiAgICB2YXIgdGV0aGVyTWF4ID0gb2Zmc2V0ICsgbWF4T2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZTtcbiAgICB2YXIgcHJldmVudGVkT2Zmc2V0ID0gd2l0aGluKHRldGhlciA/IG1hdGhNaW4obWluLCB0ZXRoZXJNaW4pIDogbWluLCBvZmZzZXQsIHRldGhlciA/IG1hdGhNYXgobWF4LCB0ZXRoZXJNYXgpIDogbWF4KTtcbiAgICBwb3BwZXJPZmZzZXRzW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldDtcbiAgICBkYXRhW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldCAtIG9mZnNldDtcbiAgfVxuXG4gIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkMjtcblxuICAgIHZhciBfbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gdG9wIDogbGVmdDtcblxuICAgIHZhciBfYWx0U2lkZSA9IG1haW5BeGlzID09PSAneCcgPyBib3R0b20gOiByaWdodDtcblxuICAgIHZhciBfb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1thbHRBeGlzXTtcblxuICAgIHZhciBfbGVuID0gYWx0QXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgdmFyIF9taW4gPSBfb2Zmc2V0ICsgb3ZlcmZsb3dbX21haW5TaWRlXTtcblxuICAgIHZhciBfbWF4ID0gX29mZnNldCAtIG92ZXJmbG93W19hbHRTaWRlXTtcblxuICAgIHZhciBpc09yaWdpblNpZGUgPSBbdG9wLCBsZWZ0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpICE9PSAtMTtcblxuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyID0gb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogb2Zmc2V0TW9kaWZpZXJTdGF0ZVthbHRBeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJDIgOiAwO1xuXG4gICAgdmFyIF90ZXRoZXJNaW4gPSBpc09yaWdpblNpZGUgPyBfbWluIDogX29mZnNldCAtIHJlZmVyZW5jZVJlY3RbX2xlbl0gLSBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcztcblxuICAgIHZhciBfdGV0aGVyTWF4ID0gaXNPcmlnaW5TaWRlID8gX29mZnNldCArIHJlZmVyZW5jZVJlY3RbX2xlbl0gKyBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcyA6IF9tYXg7XG5cbiAgICB2YXIgX3ByZXZlbnRlZE9mZnNldCA9IHRldGhlciAmJiBpc09yaWdpblNpZGUgPyB3aXRoaW5NYXhDbGFtcChfdGV0aGVyTWluLCBfb2Zmc2V0LCBfdGV0aGVyTWF4KSA6IHdpdGhpbih0ZXRoZXIgPyBfdGV0aGVyTWluIDogX21pbiwgX29mZnNldCwgdGV0aGVyID8gX3RldGhlck1heCA6IF9tYXgpO1xuXG4gICAgcG9wcGVyT2Zmc2V0c1thbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVthbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQgLSBfb2Zmc2V0O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwcmV2ZW50T3ZlcmZsb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogcHJldmVudE92ZXJmbG93LFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRIVE1MRWxlbWVudFNjcm9sbChlbGVtZW50KSB7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogZWxlbWVudC5zY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEhUTUxFbGVtZW50U2Nyb2xsIGZyb20gXCIuL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlU2Nyb2xsKG5vZGUpIHtcbiAgaWYgKG5vZGUgPT09IGdldFdpbmRvdyhub2RlKSB8fCAhaXNIVE1MRWxlbWVudChub2RlKSkge1xuICAgIHJldHVybiBnZXRXaW5kb3dTY3JvbGwobm9kZSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldEhUTUxFbGVtZW50U2Nyb2xsKG5vZGUpO1xuICB9XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZVNjcm9sbCBmcm9tIFwiLi9nZXROb2RlU2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudFNjYWxlZChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IHJvdW5kKHJlY3Qud2lkdGgpIC8gZWxlbWVudC5vZmZzZXRXaWR0aCB8fCAxO1xuICB2YXIgc2NhbGVZID0gcm91bmQocmVjdC5oZWlnaHQpIC8gZWxlbWVudC5vZmZzZXRIZWlnaHQgfHwgMTtcbiAgcmV0dXJuIHNjYWxlWCAhPT0gMSB8fCBzY2FsZVkgIT09IDE7XG59IC8vIFJldHVybnMgdGhlIGNvbXBvc2l0ZSByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC5cbi8vIENvbXBvc2l0ZSBtZWFucyBpdCB0YWtlcyBpbnRvIGFjY291bnQgdHJhbnNmb3JtcyBhcyB3ZWxsIGFzIGxheW91dC5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wb3NpdGVSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnQsIGlzRml4ZWQpIHtcbiAgaWYgKGlzRml4ZWQgPT09IHZvaWQgMCkge1xuICAgIGlzRml4ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBpc09mZnNldFBhcmVudEFuRWxlbWVudCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudElzU2NhbGVkID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGlzRWxlbWVudFNjYWxlZChvZmZzZXRQYXJlbnQpO1xuICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnRJc1NjYWxlZCwgaXNGaXhlZCk7XG4gIHZhciBzY3JvbGwgPSB7XG4gICAgc2Nyb2xsTGVmdDogMCxcbiAgICBzY3JvbGxUb3A6IDBcbiAgfTtcbiAgdmFyIG9mZnNldHMgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50IHx8ICFpc09mZnNldFBhcmVudEFuRWxlbWVudCAmJiAhaXNGaXhlZCkge1xuICAgIGlmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpICE9PSAnYm9keScgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMDc4XG4gICAgaXNTY3JvbGxQYXJlbnQoZG9jdW1lbnRFbGVtZW50KSkge1xuICAgICAgc2Nyb2xsID0gZ2V0Tm9kZVNjcm9sbChvZmZzZXRQYXJlbnQpO1xuICAgIH1cblxuICAgIGlmIChpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCkpIHtcbiAgICAgIG9mZnNldHMgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3Qob2Zmc2V0UGFyZW50LCB0cnVlKTtcbiAgICAgIG9mZnNldHMueCArPSBvZmZzZXRQYXJlbnQuY2xpZW50TGVmdDtcbiAgICAgIG9mZnNldHMueSArPSBvZmZzZXRQYXJlbnQuY2xpZW50VG9wO1xuICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgICBvZmZzZXRzLnggPSBnZXRXaW5kb3dTY3JvbGxCYXJYKGRvY3VtZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiByZWN0LmxlZnQgKyBzY3JvbGwuc2Nyb2xsTGVmdCAtIG9mZnNldHMueCxcbiAgICB5OiByZWN0LnRvcCArIHNjcm9sbC5zY3JvbGxUb3AgLSBvZmZzZXRzLnksXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBzb3VyY2U6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ5ODc1MjU1XG5cbmZ1bmN0aW9uIG9yZGVyKG1vZGlmaWVycykge1xuICB2YXIgbWFwID0gbmV3IE1hcCgpO1xuICB2YXIgdmlzaXRlZCA9IG5ldyBTZXQoKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBtYXAuc2V0KG1vZGlmaWVyLm5hbWUsIG1vZGlmaWVyKTtcbiAgfSk7IC8vIE9uIHZpc2l0aW5nIG9iamVjdCwgY2hlY2sgZm9yIGl0cyBkZXBlbmRlbmNpZXMgYW5kIHZpc2l0IHRoZW0gcmVjdXJzaXZlbHlcblxuICBmdW5jdGlvbiBzb3J0KG1vZGlmaWVyKSB7XG4gICAgdmlzaXRlZC5hZGQobW9kaWZpZXIubmFtZSk7XG4gICAgdmFyIHJlcXVpcmVzID0gW10uY29uY2F0KG1vZGlmaWVyLnJlcXVpcmVzIHx8IFtdLCBtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzIHx8IFtdKTtcbiAgICByZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChkZXApIHtcbiAgICAgIGlmICghdmlzaXRlZC5oYXMoZGVwKSkge1xuICAgICAgICB2YXIgZGVwTW9kaWZpZXIgPSBtYXAuZ2V0KGRlcCk7XG5cbiAgICAgICAgaWYgKGRlcE1vZGlmaWVyKSB7XG4gICAgICAgICAgc29ydChkZXBNb2RpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXN1bHQucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBpZiAoIXZpc2l0ZWQuaGFzKG1vZGlmaWVyLm5hbWUpKSB7XG4gICAgICAvLyBjaGVjayBmb3IgdmlzaXRlZCBvYmplY3RcbiAgICAgIHNvcnQobW9kaWZpZXIpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9yZGVyTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICAvLyBvcmRlciBiYXNlZCBvbiBkZXBlbmRlbmNpZXNcbiAgdmFyIG9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcihtb2RpZmllcnMpOyAvLyBvcmRlciBiYXNlZCBvbiBwaGFzZVxuXG4gIHJldHVybiBtb2RpZmllclBoYXNlcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGhhc2UpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgIHJldHVybiBtb2RpZmllci5waGFzZSA9PT0gcGhhc2U7XG4gICAgfSkpO1xuICB9LCBbXSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRlYm91bmNlKGZuKSB7XG4gIHZhciBwZW5kaW5nO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICghcGVuZGluZykge1xuICAgICAgcGVuZGluZyA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgcmVzb2x2ZShmbigpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGVuZGluZztcbiAgfTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VCeU5hbWUobW9kaWZpZXJzKSB7XG4gIHZhciBtZXJnZWQgPSBtb2RpZmllcnMucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIGN1cnJlbnQpIHtcbiAgICB2YXIgZXhpc3RpbmcgPSBtZXJnZWRbY3VycmVudC5uYW1lXTtcbiAgICBtZXJnZWRbY3VycmVudC5uYW1lXSA9IGV4aXN0aW5nID8gT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcsIGN1cnJlbnQsIHtcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLm9wdGlvbnMsIGN1cnJlbnQub3B0aW9ucyksXG4gICAgICBkYXRhOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5kYXRhLCBjdXJyZW50LmRhdGEpXG4gICAgfSkgOiBjdXJyZW50O1xuICAgIHJldHVybiBtZXJnZWQ7XG4gIH0sIHt9KTsgLy8gSUUxMSBkb2VzIG5vdCBzdXBwb3J0IE9iamVjdC52YWx1ZXNcblxuICByZXR1cm4gT2JqZWN0LmtleXMobWVyZ2VkKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBtZXJnZWRba2V5XTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRDb21wb3NpdGVSZWN0IGZyb20gXCIuL2RvbS11dGlscy9nZXRDb21wb3NpdGVSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgb3JkZXJNb2RpZmllcnMgZnJvbSBcIi4vdXRpbHMvb3JkZXJNb2RpZmllcnMuanNcIjtcbmltcG9ydCBkZWJvdW5jZSBmcm9tIFwiLi91dGlscy9kZWJvdW5jZS5qc1wiO1xuaW1wb3J0IG1lcmdlQnlOYW1lIGZyb20gXCIuL3V0aWxzL21lcmdlQnlOYW1lLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCB7IGlzRWxlbWVudCB9IGZyb20gXCIuL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7XG52YXIgREVGQVVMVF9PUFRJT05TID0ge1xuICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICBtb2RpZmllcnM6IFtdLFxuICBzdHJhdGVneTogJ2Fic29sdXRlJ1xufTtcblxuZnVuY3Rpb24gYXJlVmFsaWRFbGVtZW50cygpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIHJldHVybiAhYXJncy5zb21lKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgcmV0dXJuICEoZWxlbWVudCAmJiB0eXBlb2YgZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgPT09ICdmdW5jdGlvbicpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvcHBlckdlbmVyYXRvcihnZW5lcmF0b3JPcHRpb25zKSB7XG4gIGlmIChnZW5lcmF0b3JPcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBnZW5lcmF0b3JPcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX2dlbmVyYXRvck9wdGlvbnMgPSBnZW5lcmF0b3JPcHRpb25zLFxuICAgICAgX2dlbmVyYXRvck9wdGlvbnMkZGVmID0gX2dlbmVyYXRvck9wdGlvbnMuZGVmYXVsdE1vZGlmaWVycyxcbiAgICAgIGRlZmF1bHRNb2RpZmllcnMgPSBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYgPT09IHZvaWQgMCA/IFtdIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmLFxuICAgICAgX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRPcHRpb25zLFxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYyID09PSB2b2lkIDAgPyBERUZBVUxUX09QVElPTlMgOiBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYyO1xuICByZXR1cm4gZnVuY3Rpb24gY3JlYXRlUG9wcGVyKHJlZmVyZW5jZSwgcG9wcGVyLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgIH1cblxuICAgIHZhciBzdGF0ZSA9IHtcbiAgICAgIHBsYWNlbWVudDogJ2JvdHRvbScsXG4gICAgICBvcmRlcmVkTW9kaWZpZXJzOiBbXSxcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfT1BUSU9OUywgZGVmYXVsdE9wdGlvbnMpLFxuICAgICAgbW9kaWZpZXJzRGF0YToge30sXG4gICAgICBlbGVtZW50czoge1xuICAgICAgICByZWZlcmVuY2U6IHJlZmVyZW5jZSxcbiAgICAgICAgcG9wcGVyOiBwb3BwZXJcbiAgICAgIH0sXG4gICAgICBhdHRyaWJ1dGVzOiB7fSxcbiAgICAgIHN0eWxlczoge31cbiAgICB9O1xuICAgIHZhciBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgdmFyIGlzRGVzdHJveWVkID0gZmFsc2U7XG4gICAgdmFyIGluc3RhbmNlID0ge1xuICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgc2V0T3B0aW9uczogZnVuY3Rpb24gc2V0T3B0aW9ucyhzZXRPcHRpb25zQWN0aW9uKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIHNldE9wdGlvbnNBY3Rpb24gPT09ICdmdW5jdGlvbicgPyBzZXRPcHRpb25zQWN0aW9uKHN0YXRlLm9wdGlvbnMpIDogc2V0T3B0aW9uc0FjdGlvbjtcbiAgICAgICAgY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICBzdGF0ZS5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIHN0YXRlLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICBzdGF0ZS5zY3JvbGxQYXJlbnRzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogaXNFbGVtZW50KHJlZmVyZW5jZSkgPyBsaXN0U2Nyb2xsUGFyZW50cyhyZWZlcmVuY2UpIDogcmVmZXJlbmNlLmNvbnRleHRFbGVtZW50ID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlLmNvbnRleHRFbGVtZW50KSA6IFtdLFxuICAgICAgICAgIHBvcHBlcjogbGlzdFNjcm9sbFBhcmVudHMocG9wcGVyKVxuICAgICAgICB9OyAvLyBPcmRlcnMgdGhlIG1vZGlmaWVycyBiYXNlZCBvbiB0aGVpciBkZXBlbmRlbmNpZXMgYW5kIGBwaGFzZWBcbiAgICAgICAgLy8gcHJvcGVydGllc1xuXG4gICAgICAgIHZhciBvcmRlcmVkTW9kaWZpZXJzID0gb3JkZXJNb2RpZmllcnMobWVyZ2VCeU5hbWUoW10uY29uY2F0KGRlZmF1bHRNb2RpZmllcnMsIHN0YXRlLm9wdGlvbnMubW9kaWZpZXJzKSkpOyAvLyBTdHJpcCBvdXQgZGlzYWJsZWQgbW9kaWZpZXJzXG5cbiAgICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyZWRNb2RpZmllcnMuZmlsdGVyKGZ1bmN0aW9uIChtKSB7XG4gICAgICAgICAgcmV0dXJuIG0uZW5hYmxlZDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJ1bk1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICB9LFxuICAgICAgLy8gU3luYyB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgYWx3YXlzIGJlIGV4ZWN1dGVkLCBldmVuIGlmIG5vdCBuZWNlc3NhcnkuIFRoaXNcbiAgICAgIC8vIGlzIHVzZWZ1bCBmb3IgbG93IGZyZXF1ZW5jeSB1cGRhdGVzIHdoZXJlIHN5bmMgYmVoYXZpb3Igc2ltcGxpZmllcyB0aGVcbiAgICAgIC8vIGxvZ2ljLlxuICAgICAgLy8gRm9yIGhpZ2ggZnJlcXVlbmN5IHVwZGF0ZXMgKGUuZy4gYHJlc2l6ZWAgYW5kIGBzY3JvbGxgIGV2ZW50cyksIGFsd2F5c1xuICAgICAgLy8gcHJlZmVyIHRoZSBhc3luYyBQb3BwZXIjdXBkYXRlIG1ldGhvZFxuICAgICAgZm9yY2VVcGRhdGU6IGZ1bmN0aW9uIGZvcmNlVXBkYXRlKCkge1xuICAgICAgICBpZiAoaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3N0YXRlJGVsZW1lbnRzID0gc3RhdGUuZWxlbWVudHMsXG4gICAgICAgICAgICByZWZlcmVuY2UgPSBfc3RhdGUkZWxlbWVudHMucmVmZXJlbmNlLFxuICAgICAgICAgICAgcG9wcGVyID0gX3N0YXRlJGVsZW1lbnRzLnBvcHBlcjsgLy8gRG9uJ3QgcHJvY2VlZCBpZiBgcmVmZXJlbmNlYCBvciBgcG9wcGVyYCBhcmUgbm90IHZhbGlkIGVsZW1lbnRzXG4gICAgICAgIC8vIGFueW1vcmVcblxuICAgICAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFN0b3JlIHRoZSByZWZlcmVuY2UgYW5kIHBvcHBlciByZWN0cyB0byBiZSByZWFkIGJ5IG1vZGlmaWVyc1xuXG5cbiAgICAgICAgc3RhdGUucmVjdHMgPSB7XG4gICAgICAgICAgcmVmZXJlbmNlOiBnZXRDb21wb3NpdGVSZWN0KHJlZmVyZW5jZSwgZ2V0T2Zmc2V0UGFyZW50KHBvcHBlciksIHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3kgPT09ICdmaXhlZCcpLFxuICAgICAgICAgIHBvcHBlcjogZ2V0TGF5b3V0UmVjdChwb3BwZXIpXG4gICAgICAgIH07IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIHJlc2V0IHRoZSBjdXJyZW50IHVwZGF0ZSBjeWNsZS4gVGhlXG4gICAgICAgIC8vIG1vc3QgY29tbW9uIHVzZSBjYXNlIGZvciB0aGlzIGlzIHRoZSBgZmxpcGAgbW9kaWZpZXIgY2hhbmdpbmcgdGhlXG4gICAgICAgIC8vIHBsYWNlbWVudCwgd2hpY2ggdGhlbiBuZWVkcyB0byByZS1ydW4gYWxsIHRoZSBtb2RpZmllcnMsIGJlY2F1c2UgdGhlXG4gICAgICAgIC8vIGxvZ2ljIHdhcyBwcmV2aW91c2x5IHJhbiBmb3IgdGhlIHByZXZpb3VzIHBsYWNlbWVudCBhbmQgaXMgdGhlcmVmb3JlXG4gICAgICAgIC8vIHN0YWxlL2luY29ycmVjdFxuXG4gICAgICAgIHN0YXRlLnJlc2V0ID0gZmFsc2U7XG4gICAgICAgIHN0YXRlLnBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50OyAvLyBPbiBlYWNoIHVwZGF0ZSBjeWNsZSwgdGhlIGBtb2RpZmllcnNEYXRhYCBwcm9wZXJ0eSBmb3IgZWFjaCBtb2RpZmllclxuICAgICAgICAvLyBpcyBmaWxsZWQgd2l0aCB0aGUgaW5pdGlhbCBkYXRhIHNwZWNpZmllZCBieSB0aGUgbW9kaWZpZXIuIFRoaXMgbWVhbnNcbiAgICAgICAgLy8gaXQgZG9lc24ndCBwZXJzaXN0IGFuZCBpcyBmcmVzaCBvbiBlYWNoIHVwZGF0ZS5cbiAgICAgICAgLy8gVG8gZW5zdXJlIHBlcnNpc3RlbnQgZGF0YSwgdXNlIGAke25hbWV9I3BlcnNpc3RlbnRgXG5cbiAgICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgICAgICAgIHJldHVybiBzdGF0ZS5tb2RpZmllcnNEYXRhW21vZGlmaWVyLm5hbWVdID0gT2JqZWN0LmFzc2lnbih7fSwgbW9kaWZpZXIuZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgIGlmIChzdGF0ZS5yZXNldCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgc3RhdGUucmVzZXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGluZGV4ID0gLTE7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX3N0YXRlJG9yZGVyZWRNb2RpZmllID0gc3RhdGUub3JkZXJlZE1vZGlmaWVyc1tpbmRleF0sXG4gICAgICAgICAgICAgIGZuID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLmZuLFxuICAgICAgICAgICAgICBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLm9wdGlvbnMsXG4gICAgICAgICAgICAgIF9vcHRpb25zID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllMiA9PT0gdm9pZCAwID8ge30gOiBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyLFxuICAgICAgICAgICAgICBuYW1lID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLm5hbWU7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBzdGF0ZSA9IGZuKHtcbiAgICAgICAgICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgICBvcHRpb25zOiBfb3B0aW9ucyxcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgaW5zdGFuY2U6IGluc3RhbmNlXG4gICAgICAgICAgICB9KSB8fCBzdGF0ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBBc3luYyBhbmQgb3B0aW1pc3RpY2FsbHkgb3B0aW1pemVkIHVwZGF0ZSBcdTIwMTMgaXQgd2lsbCBub3QgYmUgZXhlY3V0ZWQgaWZcbiAgICAgIC8vIG5vdCBuZWNlc3NhcnkgKGRlYm91bmNlZCB0byBydW4gYXQgbW9zdCBvbmNlLXBlci10aWNrKVxuICAgICAgdXBkYXRlOiBkZWJvdW5jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgIGluc3RhbmNlLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgICAgcmVzb2x2ZShzdGF0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSksXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBjbGVhbnVwTW9kaWZpZXJFZmZlY3RzKCk7XG4gICAgICAgIGlzRGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKCFhcmVWYWxpZEVsZW1lbnRzKHJlZmVyZW5jZSwgcG9wcGVyKSkge1xuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cblxuICAgIGluc3RhbmNlLnNldE9wdGlvbnMob3B0aW9ucykudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmICghaXNEZXN0cm95ZWQgJiYgb3B0aW9ucy5vbkZpcnN0VXBkYXRlKSB7XG4gICAgICAgIG9wdGlvbnMub25GaXJzdFVwZGF0ZShzdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgYmVmb3JlIHRoZSBmaXJzdFxuICAgIC8vIHVwZGF0ZSBjeWNsZSBydW5zLiBUaGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHVwZGF0ZVxuICAgIC8vIGN5Y2xlLiBUaGlzIGlzIHVzZWZ1bCB3aGVuIGEgbW9kaWZpZXIgYWRkcyBzb21lIHBlcnNpc3RlbnQgZGF0YSB0aGF0XG4gICAgLy8gb3RoZXIgbW9kaWZpZXJzIG5lZWQgdG8gdXNlLCBidXQgdGhlIG1vZGlmaWVyIGlzIHJ1biBhZnRlciB0aGUgZGVwZW5kZW50XG4gICAgLy8gb25lLlxuXG4gICAgZnVuY3Rpb24gcnVuTW9kaWZpZXJFZmZlY3RzKCkge1xuICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICAgIHZhciBuYW1lID0gX3JlZi5uYW1lLFxuICAgICAgICAgICAgX3JlZiRvcHRpb25zID0gX3JlZi5vcHRpb25zLFxuICAgICAgICAgICAgb3B0aW9ucyA9IF9yZWYkb3B0aW9ucyA9PT0gdm9pZCAwID8ge30gOiBfcmVmJG9wdGlvbnMsXG4gICAgICAgICAgICBlZmZlY3QgPSBfcmVmLmVmZmVjdDtcblxuICAgICAgICBpZiAodHlwZW9mIGVmZmVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHZhciBjbGVhbnVwRm4gPSBlZmZlY3Qoe1xuICAgICAgICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZSxcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBub29wRm4gPSBmdW5jdGlvbiBub29wRm4oKSB7fTtcblxuICAgICAgICAgIGVmZmVjdENsZWFudXBGbnMucHVzaChjbGVhbnVwRm4gfHwgbm9vcEZuKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpIHtcbiAgICAgIGVmZmVjdENsZWFudXBGbnMuZm9yRWFjaChmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZuKCk7XG4gICAgICB9KTtcbiAgICAgIGVmZmVjdENsZWFudXBGbnMgPSBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG59XG5leHBvcnQgdmFyIGNyZWF0ZVBvcHBlciA9IC8qI19fUFVSRV9fKi9wb3BwZXJHZW5lcmF0b3IoKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgeyBkZXRlY3RPdmVyZmxvdyB9OyIsICJpbXBvcnQgeyBwb3BwZXJHZW5lcmF0b3IsIGRldGVjdE92ZXJmbG93IH0gZnJvbSBcIi4vY3JlYXRlUG9wcGVyLmpzXCI7XG5pbXBvcnQgZXZlbnRMaXN0ZW5lcnMgZnJvbSBcIi4vbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzXCI7XG5pbXBvcnQgcG9wcGVyT2Zmc2V0cyBmcm9tIFwiLi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2NvbXB1dGVTdHlsZXMuanNcIjtcbmltcG9ydCBhcHBseVN0eWxlcyBmcm9tIFwiLi9tb2RpZmllcnMvYXBwbHlTdHlsZXMuanNcIjtcbmltcG9ydCBvZmZzZXQgZnJvbSBcIi4vbW9kaWZpZXJzL29mZnNldC5qc1wiO1xuaW1wb3J0IGZsaXAgZnJvbSBcIi4vbW9kaWZpZXJzL2ZsaXAuanNcIjtcbmltcG9ydCBwcmV2ZW50T3ZlcmZsb3cgZnJvbSBcIi4vbW9kaWZpZXJzL3ByZXZlbnRPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGFycm93IGZyb20gXCIuL21vZGlmaWVycy9hcnJvdy5qc1wiO1xuaW1wb3J0IGhpZGUgZnJvbSBcIi4vbW9kaWZpZXJzL2hpZGUuanNcIjtcbnZhciBkZWZhdWx0TW9kaWZpZXJzID0gW2V2ZW50TGlzdGVuZXJzLCBwb3BwZXJPZmZzZXRzLCBjb21wdXRlU3R5bGVzLCBhcHBseVN0eWxlcywgb2Zmc2V0LCBmbGlwLCBwcmV2ZW50T3ZlcmZsb3csIGFycm93LCBoaWRlXTtcbnZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKHtcbiAgZGVmYXVsdE1vZGlmaWVyczogZGVmYXVsdE1vZGlmaWVyc1xufSk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgY3JlYXRlUG9wcGVyLCBwb3BwZXJHZW5lcmF0b3IsIGRlZmF1bHRNb2RpZmllcnMsIGRldGVjdE92ZXJmbG93IH07IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgY3JlYXRlUG9wcGVyIGFzIGNyZWF0ZVBvcHBlckxpdGUgfSBmcm9tIFwiLi9wb3BwZXItbGl0ZS5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCAqIGZyb20gXCIuL21vZGlmaWVycy9pbmRleC5qc1wiOyIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuLy8gYW5kIFRlbXBsYXRlciBwbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9TaWxlbnRWb2lkMTMvVGVtcGxhdGVyIHdoZXJlIEkgZ290IHRoZSBjb2RlIGZvciB0aGUgc3VnZ2VzdGVyc1xuXG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgVGV4dElucHV0U3VnZ2VzdCB9IGZyb20gXCIuL3N1Z2dlc3RcIjtcbmltcG9ydCB7IGdldEZpbGVzRnJvbUZvbGRlciB9IGZyb20gXCIuLi90b29sc1wiO1xuaW1wb3J0IEZvbGRlclRhZ1BsdWdpbiBmcm9tIFwiLi4vLi4vbWFpblwiO1xuaW1wb3J0IHsgZXJyb3JXcmFwcGVyU3luYyB9IGZyb20gXCIuLi9FcnJvclwiO1xuXG5leHBvcnQgZW51bSBGaWxlU3VnZ2VzdE1vZGUge1xuICAgIFRlbXBsYXRlRmlsZXMsXG4gICAgU2NyaXB0RmlsZXMsXG59XG5cbmV4cG9ydCBjbGFzcyBGaWxlU3VnZ2VzdCBleHRlbmRzIFRleHRJbnB1dFN1Z2dlc3Q8VEZpbGU+IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IEZvbGRlclRhZ1BsdWdpbixcbiAgICAgICAgcHJpdmF0ZSBmb2xkZXI6IHN0cmluZ1xuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwLCBpbnB1dEVsKTtcbiAgICB9XG5cbiAgICBnZXRfZXJyb3JfbXNnKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgRm9sZGVyICR7dGhpcy5mb2xkZXJ9IGRvZXNuJ3QgZXhpc3RgO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKGlucHV0X3N0cjogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgICAgIGNvbnN0IGFsbF9maWxlcyA9IGVycm9yV3JhcHBlclN5bmMoXG4gICAgICAgICAgICAoKSA9PiBnZXRGaWxlc0Zyb21Gb2xkZXIoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2xkZXJcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgdGhpcy5nZXRfZXJyb3JfbXNnKClcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFhbGxfZmlsZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZpbGVzOiBURmlsZVtdID0gW107XG4gICAgICAgIGNvbnN0IGxvd2VyX2lucHV0X3N0ciA9IGlucHV0X3N0ci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGFsbF9maWxlcy5mb3JFYWNoKChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmXG4gICAgICAgICAgICAgICAgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIiAmJlxuICAgICAgICAgICAgICAgIGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKGxvd2VyX2lucHV0X3N0cikpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVzLnNsaWNlKDAsIDEwMDApO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aCk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGg7XG4gICAgICAgIHRoaXMuaW5wdXRFbC50cmlnZ2VyKFwiaW5wdXRcIik7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IG9wZW5BdXRvY29tcGxldGVNb2RhbCB9IGZyb20gXCIuLi9hdXRvY29tcGxldGVNb2RhbFwiO1xyXG5pbXBvcnQgeyBERUJVRywgRVJST1IsIGxvZ2dlciB9IGZyb20gXCIuLi9Mb2dcIjtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5BdXRvQ29tcGxldGVNb2RhbCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2F1dG9Db21wbGV0ZU1vZGFsJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2F1dG9jb21wbGV0ZS5tb2RhbCc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ0F1dG8tQ29tcGxldGUgTW9kYWwnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnRGlzcGxheXMgYW4gYXV0by1jb21wbGV0ZSBtb2RhbCBmb3IgdGhlIGZyb250bWF0dGVyIHBhcmFtZXRlci4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IGlucHV0ID0gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKTsgLy8gR2V0IHRoZSBjdXJyZW50IGNvbnRlbnQgb2YgcHJvcGVydHlcXG4gIHJldHVybiBpbnB1dDsgLy8gUmV0dXJuIHRoZSBpbnB1dCB1bmFsdGVyZWRcXG59O1wiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGxvZ2dlci5sb2coREVCVUcsYGF1dG9jb21wbGV0ZSBtb2RhbCwgd29yayBpbiBwcm9ncmVzcy4uLmApO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKTtcclxuICAgICAgICBjb25zdCBydWxlID0gdG9vbHMuZ2V0UnVsZSgpO1xyXG4gICAgICAgIGlmICghcnVsZSkgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0b29scy5nZXRPcHRpb25Db25maWcocnVsZS5pZCk7XHJcbiAgICAgICAgaWYgKCFydWxlKSByZXR1cm4gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKSB8fCAnYXV0b2NvbXBsZXRlLm1vZGFsJzsgLy8gcmV0dXJuIGN1cnJlbnQgY29udGVudCBpZiBub3QgaW1wbGVtZW50ZWQgeWV0XHJcbiAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0b29scy5nZXRGcm9udG1hdHRlcigpO1xyXG4gICAgICAgIGNvbnN0IGhhc0F1dG9jb21wbGV0ZVByb3BlcnRpZXMgPSBPYmplY3Qua2V5cyhmcm9udG1hdHRlcikuc29tZShrZXkgPT4gXHJcbiAgICAgICAgICAgIGtleS5zdGFydHNXaXRoKHJ1bGUucHJvcGVydHkgKyBvcHRpb25zLnByb3BlcnR5RGVsaW1pdGVyKSAmJlxyXG4gICAgICAgICAgICAoZnJvbnRtYXR0ZXJba2V5XSA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgIGZyb250bWF0dGVyW2tleV0gPT09IG51bGwgfHxcclxuICAgICAgICAgICAgZnJvbnRtYXR0ZXJba2V5XSA9PT0gJycpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoIWhhc0F1dG9jb21wbGV0ZVByb3BlcnRpZXMpIHJldHVybiB0b29scy5nZXRDdXJyZW50Q29udGVudCgpIHx8ICdhdXRvY29tcGxldGUubW9kYWwnOyAvLyByZXR1cm4gY3VycmVudCBjb250ZW50IGlmIG5vdCBpbXBsZW1lbnRlZCB5ZXRcclxuICAgICAgICBvcGVuQXV0b2NvbXBsZXRlTW9kYWwoXHJcbiAgICAgICAgICAgIHRvb2xzLmFwcCxcclxuICAgICAgICAgICAgdG9vbHMucGx1Z2luLFxyXG4gICAgICAgICAgICBydWxlLFxyXG4gICAgICAgICAgICBvcHRpb25zLFxyXG4gICAgICAgICAgICB0b29scy5nZXRBY3RpdmVGaWxlKCksXHJcbiAgICAgICAgICAgIHRvb2xzLmdldEZyb250bWF0dGVyKClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIubG9nKERFQlVHLCdhdXRvY29tcGxldGUgbW9kYWwgcmVzdWx0JywgcmVzdWx0LCB0b29scy5nZXRGcm9udG1hdHRlcigpKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQ/LnZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdG9vbHMuYXBwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coRVJST1IsJ0FwcCBpcyBub3QgZGVmaW5lZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKSB8fCAnYXV0b2NvbXBsZXRlLm1vZGFsIEVycm9yLiBTZWUgY29uc29sZSBmb3IgZGV0YWlscy4nOyAvLyByZXR1cm4gY3VycmVudCBjb250ZW50IGlmIG5vdCBpbXBsZW1lbnRlZCB5ZXQgIFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0b29scy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIChmcm9udG1hdHRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhyZXN1bHQudmFsdWVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJba2V5XSA9IHZhbHVlOyAvLyBzZXQgdGhlIGZyb250bWF0dGVyIHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7J210aW1lJzogZmlsZS5zdGF0Lm10aW1lfSk7IC8vIGRvIG5vdCBjaGFuZ2UgdGhlIG1vZGlmeSB0aW1lLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7IC8vIHJldHVybiBjdXJyZW50IGNvbnRlbnQuIEZyb250bWF0dGVyIGlzIGFscmVhZHkgdXBkYXRlZC5cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUiwnRXJyb3Igb3BlbmluZyBhdXRvY29tcGxldGUgbW9kYWw6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCkgfHwgJ2F1dG9jb21wbGV0ZS5tb2RhbCBFcnJvci4gU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMuJzsgLy8gcmV0dXJuIGN1cnJlbnQgY29udGVudCBpZiBub3QgaW1wbGVtZW50ZWQgeWV0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgb3B0aW9uRUwuZW1wdHkoKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgICAgICAgcHJvcGVydHlEZWxpbWl0ZXI6ICcuJyxcclxuICAgICAgICB9KVxyXG4gICAgXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgLnNldE5hbWUoJ0RlbGltaXRlcicpXHJcbiAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byBkZXRlcm1pbmUgd2hpY2ggcHJvcGVydHkgc2hvdWxkIGFwcGVhciBpbiB0aGUgbW9kYWwnKVxyXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3Byb3BlcnR5RGVsaW1pdGVyJykgfHwgJy4nKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdwcm9wZXJ0eURlbGltaXRlcicsIHZhbHVlKTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgfTtcclxufSIsICJcclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0LCBzZXRJY29uLEJ1dHRvbkNvbXBvbmVudCwgVGV4dENvbXBvbmVudCwgQ29uc3RydWN0b3IgfSBmcm9tICdvYnNpZGlhbic7IC8vIEFkZGVkIHNldEljb25cclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgT2JzaWRpYW5Qcm9wZXJ0eVR5cGVzLCBQcm9wZXJ0eUluZm8gfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tICcuL3Rvb2xzJztcclxuaW1wb3J0IHsgcmVuZGVyVmFsdWVJbnB1dCwgdXBkYXRlUHJvcGVydHlJY29uIH0gZnJvbSAnLi91aUVsZW1lbnRzJzsgLy8gSW1wb3J0IHRoZSBmdW5jdGlvbiB0byByZW5kZXIgdmFsdWUgaW5wdXRcclxuaW1wb3J0IHsgREVCVUcsIEVSUk9SLCBsb2dnZXIgfSBmcm9tICcuL0xvZyc7XHJcblxyXG5cclxuLy8gRGVmaW5lIHRoZSByZXN1bHQgc3RydWN0dXJlIHJldHVybmVkIGJ5IHRoZSBtb2RhbFxyXG5leHBvcnQgaW50ZXJmYWNlIGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHtcclxuICAgIHZhbHVlczoge307XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnNpZGlhbiBNb2RhbCBmb3Igc2VsZWN0aW5nIGRpcmVjdG9yaWVzIGFuZCBmaWxlcyBmcm9tIHRoZSB2YXVsdCBzdHJ1Y3R1cmUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXV0b2NvbXBsZXRlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblxyXG4gICAgXHJcbiAgICBwcml2YXRlIHJlc29sdmVQcm9taXNlITogKHJlc3VsdDogYXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQgfCBudWxsKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBwcm9taXNlOiBQcm9taXNlPGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHwgbnVsbD47XHJcblxyXG4gICAgLy8gSW5pdGlhbCBzdGF0ZSBwYXNzZWQgdG8gdGhlIG1vZGFsIChzdG9yZWQgZm9yIHJlc2V0IGZ1bmN0aW9uYWxpdHkpXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IG9rQ2FsbGJhY2shOiAocmVzdWx0OiBhdXRvY29tcGxldGVNb2RhbFJlc3VsdCB8IG51bGwpID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogYW55O1xyXG4gICAgcHJpdmF0ZSBvcHRpb25zOiBhbnk7XHJcbiAgICBwcml2YXRlIHRvb2xzOiBTY3JpcHRpbmdUb29scztcclxuICAgIHByaXZhdGUgZXhwZWN0ZWRUeXBlOiBPYnNpZGlhblByb3BlcnR5VHlwZXM7XHJcbiAgICBwcml2YXRlIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3M7XHJcbiAgICBwcml2YXRlIGtub3duUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgUHJvcGVydHlJbmZvPiA9IHt9O1xyXG5cclxuICAgIC8vIEN1cnJlbnQgc3RhdGUgYmVpbmcgbW9kaWZpZWQgd2l0aGluIHRoZSBtb2RhbFxyXG4gICAgcHJpdmF0ZSBhY3RpdmVGaWxlOiBURmlsZSB8IFRGb2xkZXIgfCB1bmRlZmluZWRcclxuICAgIHByaXZhdGUgZnJvbnRtYXR0ZXI6IGFueTsgLy8gRnJvbnRtYXR0ZXIgZGF0YSBmb3IgdGhlIGFjdGl2ZSBmaWxlXHJcblxyXG4gICAgLy8gVUkgRWxlbWVudHNcclxuICAgIHByaXZhdGUgY29udGVudFJvb3RFbGVtZW50ITogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGZ1bmN0aW9uVGVzdEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcclxuICAgIHByaXZhdGUgZnVuY3Rpb25SZXN1bHRUZXh0Q29tcG9uZW50ITogVGV4dENvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuICAgIHByaXZhdGUgcmVzdWx0OiBhbnkgPSB7fTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIERpcmVjdG9yeVNlbGVjdGlvbk1vZGFsLlxyXG4gICAgICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0gcGx1Z2luIC0gVGhlIHBsdWdpbiBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBleHBlY3RlZFR5cGUgLSBFeHBlY3RlZCByZXR1cm4gdHlwZS5cclxuICAgICAqIEBwYXJhbSBhY3RpdmVGaWxlIC0gVGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZSBvciBmb2xkZXIuXHJcbiAgICAgKiBAcGFyYW0gZnJvbnRtYXR0ZXIgLSBGcm9udG1hdHRlciBkYXRhIGZvciB0aGUgYWN0aXZlIGZpbGUuXHJcbiAgICAgKiBAcGFyYW0gb2tDYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgdXNlciBjbGlja3MgXCJPS1wiLiBSZWNlaXZlcyB0aGUgc2VsZWN0aW9uIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsXHJcbiAgICAgICAgcGx1Z2luOiBhbnksXHJcbiAgICAgICAgcnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyxcclxuICAgICAgICBvcHRpb25zOiBhbnksXHJcbiAgICAgICAgYWN0aXZlRmlsZTogVEZpbGUgfCBURm9sZGVyIHwgdW5kZWZpbmVkLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBhbnksICAgXHJcbiAgICAgICAgb2tDYWxsYmFjaz86IChyZXN1bHQ6IGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHwgbnVsbCkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICAvLyBTdG9yZSBpbml0aWFsIHN0YXRlIGZvciByZXNldFxyXG4gICAgICAgIHRoaXMudG9vbHM9IG5ldyBTY3JpcHRpbmdUb29scyhhcHAsIHRoaXMucGx1Z2luLCB0aGlzLmZyb250bWF0dGVyKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZUZpbGUgPSBhY3RpdmVGaWxlO1xyXG4gICAgICAgIHRoaXMuZnJvbnRtYXR0ZXIgPSBmcm9udG1hdHRlcjsgLy8gU3RvcmUgZnJvbnRtYXR0ZXIgZGF0YVxyXG5cclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLnJ1bGUgPSBydWxlO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7IC8vIFN0b3JlIG9wdGlvbnMgZm9yIHRoZSBtb2RhbFxyXG4gICAgICAgIHRoaXMuZXhwZWN0ZWRUeXBlID0gcnVsZS50eXBlOyAvLyBFeHBlY3RlZCB0eXBlIGZvciB0aGUgbW9kYWxcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcHJvbWlzZVxyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChva0NhbGxiYWNrKSB0aGlzLm9rQ2FsbGJhY2sgPSBva0NhbGxiYWNrO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGN1cnJlbnQgc3RhdGUgZnJvbSBpbml0aWFsIHN0YXRlIGZvciBlZGl0aW5nXHJcbiAgICAgICAgdGhpcy5yZXNldFRvSW5pdGlhbCgpOyAvLyBVc2UgYSBtZXRob2QgZm9yIGluaXRpYWxpemF0aW9uIGFuZCByZXNldFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBjdXJyZW50IHNlbGVjdGlvbiBzdGF0ZSB0byB0aGUgaW5pdGlhbCBzdGF0ZSBwcm92aWRlZCBhdCBjb25zdHJ1Y3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVzZXRUb0luaXRpYWwoKTogdm9pZCB7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHN0YXRlIHRvIGVtcHR5LlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHJlc2V0VG9FbXB0eSgpOiB2b2lkIHtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQuIEJ1aWxkcyB0aGUgVUkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICB0aGlzLmtub3duUHJvcGVydGllcyA9IGF3YWl0IHRoaXMudG9vbHMuZmV0Y2hLbm93blByb3BlcnRpZXModGhpcy5hcHApOyAvLyBJbml0aWFsaXplIGtub3duIHByb3BlcnRpZXNcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBpZiAoY29udGVudEVsLnBhcmVudEVsZW1lbnQpIGNvbnRlbnRFbC5wYXJlbnRFbGVtZW50LnN0eWxlLndpZHRoID0gJzkwMHB4JztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTsgLy8gQ2xlYXIgcHJldmlvdXMgXHJcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdjb2RlRWRpdG9yLW1vZGFsJyk7IFxyXG5cclxuICAgICAgICAvLyAtLS0gTW9kYWwgVGl0bGUgLS0tXHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1BsZWFzZSBjb21wbGV0ZSB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXMnIH0pOyAgICBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2JvZHknLCB7IHRleHQ6IGBGaWxlOiAke3RoaXMuYWN0aXZlRmlsZT8ucGF0aH1gIH0pOyBcclxuXHJcbiAgICAgICAgLy8gLS0tIFRyZWUgQ29udGFpbmVyIC0tLVxyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50ID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2NvZGVFZGl0b3ItY29udGFpbmVyJyB9KTtcclxuICAgICAgICAvLyBCYXNpYyBzdHlsaW5nIGZvciB0aGUgc2Nyb2xsYWJsZSB0cmVlIGFyZWFcclxuICAgICAgICAvLyB0aGlzLmVkaXRvclJvb3RFbGVtZW50LnN0eWxlLndpZHRoID0gJzYwMHB4JztcclxuICAgICAgICAvLyB0aGlzLmNvbnRlbnRSb290RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnNjAwcHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJztcclxuICAgICAgICAvL3RoaXMuZWRpdG9yUm9vdEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgdGhpcy5jb250ZW50Um9vdEVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudFJvb3RFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JztcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5Q29udGFpbmVyRWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImNvZGVFZGl0b3Itb3B0aW9uc1wiIH0pO1xyXG4gICAgICAgIHByb3BlcnR5Q29udGFpbmVyRWwuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nOyAvLyBTdGFjayBpdGVtcyB2ZXJ0aWNhbGx5XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuZnJvbnRtYXR0ZXIpKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aCh0aGlzLnJ1bGUucHJvcGVydHkgKyB0aGlzLm9wdGlvbnMucHJvcGVydHlEZWxpbWl0ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dFbCA9IHByb3BlcnR5Q29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktc2V0dGluZy1yb3cgc2V0dGluZy1pdGVtJyB9KTtcclxuICAgICAgICAgICAgICAgIHJvd0VsLnN0eWxlLndpZHRoID0gJzEwMCUnOyAvLyBGdWxsIHdpZHRoXHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udHJvbEVsID0gcm93RWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZy1pdGVtLWNvbnRyb2wnIH0pO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sRWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbEVsLnN0eWxlLmdhcCA9ICcwcHgnOyAvLyBQcmV2ZW50IGdhcCBmcm9tIGJlaW5nIGFkZGVkIHRvIHRoZSBsZWZ0IHNpZGVcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0Q29udGFpbmVyID0gY29udHJvbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LWxlZnQtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGxlZnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICAgICAgICAgIGxlZnRDb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgbGVmdENvbnRhaW5lci5zdHlsZS5taW5XaWR0aCA9ICcyNTBweCc7IFxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGljb25FbCA9IGxlZnRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ3Byb3BlcnR5LWljb24gc2V0dGluZy1pdGVtLWljb24nIH0pO1xyXG4gICAgICAgICAgICAgICAgaWNvbkVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzhweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgdXBkYXRlUHJvcGVydHlJY29uKGljb25FbCwgdGhpcy5rbm93blByb3BlcnRpZXNba2V5XS50eXBlKTsgLy8gVXBkYXRlIGljb24gYmFzZWQgb24gdHlwZVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VhcmNoQ29udGFpbmVyID0gbGVmdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1zZWFyY2gtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHNlYXJjaENvbnRhaW5lcilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoa2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignUHJvcGVydHkgbmFtZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKHRydWUpOyAvLyBEaXNhYmxlIHRoZSBpbnB1dCBmaWVsZFxyXG4gICAgICAgICAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuc3R5bGUuYm9yZGVyID0gJ25vbmUnOyAvLyBtYWtlIGJvcmRlciBpbnZpc2libGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1pZGRsZUNvbnRhaW5lciA9IGNvbnRyb2xFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9wZXJ0eS1taWRkbGUtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gbWlkZGxlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3Byb3BlcnR5LXZhbHVlLWNvbnRhaW5lcicgfSk7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9ICcxMDAlJzsgLy8gRnVsbCB3aWR0aCBmb3IgdmFsdWUgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICBsZXQgcHJldmlld0NvbXBvbmVudCA9IHJlbmRlclZhbHVlSW5wdXQodmFsdWVDb250YWluZXIsIHRoaXMua25vd25Qcm9wZXJ0aWVzW2tleV0sIHRoaXMuZnJvbnRtYXR0ZXJba2V5XSwgdGhpcy5jaGFuZ2VDYWxsYmFjayk7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldmlld0NvbXBvbmVudC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzEwMCUnOyAvLyBNYWtlIHRoZSBpbnB1dCBmaWVsZCB0YWtlIGZ1bGwgd2lkdGhcclxuICAgICAgICAgICAgICAgIHByZXZpZXdDb21wb25lbnQuaW5wdXRFbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnOyAvLyBtYWtlIGl0IGludmlzaWJsZVxyXG4gICAgICAgICAgICAgICAgLy8gLS0tIHJpZ2h0IHBhcnQgLS0tXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVCdXR0b25Db250YWluZXIgPSBjb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvcGVydHktcmlnaHQtY29udGFpbmVyJyB9KTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZUJ1dHRvbkNvbnRhaW5lci5zdHlsZS5tYXJnaW5MZWZ0ID0gJ2F1dG8nOyAvLyBQdXNoIHRvIHRoZSByaWdodFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAtLS0gQWN0aW9uIEJ1dHRvbnMgLS0tXHJcbiAgICAgICAgdGhpcy5jcmVhdGVBY3Rpb25CdXR0b25zKGNvbnRlbnRFbCk7IC8vIENyZWF0ZSBPSyBhbmQgUmVzZXQgYnV0dG9uc1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZUNhbGxiYWNrID0gKHByb3BlcnR5SW5mbzogUHJvcGVydHlJbmZvIHwgdW5kZWZpbmVkLCB2YWx1ZTphbnkpID0+IHtcclxuICAgICAgICAvLyBTYXZlIHRoZSByZXN1bHQgdG8gdGhlIGN1cnJlbnQgc3RhdGVcclxuICAgICAgICBpZiAocHJvcGVydHlJbmZvKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzdWx0W3Byb3BlcnR5SW5mby5uYW1lXSA9IHZhbHVlOyAvLyBVcGRhdGUgdGhlIHJlc3VsdCB3aXRoIHRoZSBuZXcgdmFsdWVcclxuICAgICAgICB9XHJcbiAgICB9ICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIHRoZSBcIk9LXCIgYW5kIFwiUmVzZXRcIiBidXR0b25zLlxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIEhUTUwgZWxlbWVudCB0byBhcHBlbmQgdGhlIGJ1dHRvbnMgdG8uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlQWN0aW9uQnV0dG9ucyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBidXR0b25zRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdtb2RhbC1idXR0b25zJyB9KTtcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUubWFyZ2luVG9wID0gJzE1cHgnO1xyXG4gICAgICAgIGJ1dHRvbnNFbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOyAvLyBVc2UgZmxleCBmb3IgYWxpZ25tZW50XHJcbiAgICAgICAgYnV0dG9uc0VsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2ZsZXgtZW5kJzsgLy8gQWxpZ24gYnV0dG9ucyB0byB0aGUgcmlnaHRcclxuICAgICAgICBidXR0b25zRWwuc3R5bGUuZ2FwID0gJzEwcHgnOyAvLyBTcGFjZSBiZXR3ZWVuIGJ1dHRvbnNcclxuXHJcbiAgICAgICAgLy8gUmVzZXQgQnV0dG9uIChVbmRvIFx1MjFBQVx1RkUwRilcclxuICAgICAgICBjb25zdCByZXNldEJ1dHRvbiA9IGJ1dHRvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XHJcbiAgICAgICAgLy8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmb3IgY29uc2lzdGVuY3ksIG9yIHVzZSB0ZXh0XHJcbiAgICAgICAgc2V0SWNvbihyZXNldEJ1dHRvbiwgJ3Jlc2V0Jyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLmFyaWFMYWJlbCA9ICdSZXNldCBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgcmVzZXRCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFRvSW5pdGlhbCgpOyAvLyBSZXNldCBpbnRlcm5hbCBzdGF0ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENsZWFyIEJ1dHRvbiAoQ2xlYXIgXHVEODNEXHVERUFFKVxyXG4gICAgICAgIGNvbnN0IGVtcHR5QnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nKTtcclxuICAgICAgICAvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZvciBjb25zaXN0ZW5jeSwgb3IgdXNlIHRleHRcclxuICAgICAgICBzZXRJY29uKGVtcHR5QnV0dG9uLCAnZXJhc2VyJyk7IC8vIFVzZSBhIHN1aXRhYmxlIGljb24gbGlrZSAncmVzZXQnIG9yICd1bmRvJ1xyXG4gICAgICAgIGVtcHR5QnV0dG9uLmFyaWFMYWJlbCA9ICdDbGVhciBzZWxlY3Rpb24nOyAvLyBBY2Nlc3NpYmlsaXR5XHJcbiAgICAgICAgZW1wdHlCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFRvRW1wdHkoKTsgLy8gQ2xlYXIgc3RhdGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBjYW5jZWwgQnV0dG9uXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDYW5jZWwnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIGRpc2NhcmQgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBjYW5jZWxCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZyhERUJVRyxcIkNhbmNlbCBDbGlja2VkIC0gUmV0dXJuaW5nXCIpOyAvLyBEZWJ1ZyBsb2dcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZShudWxsKTsgLy8gUmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoIG51bGxcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE9LIEJ1dHRvblxyXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycsIGNsczogJ21vZC1jdGEnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hcmlhTGFiZWwgPSAnY2xvc2UgYW5kIHNhdmUgY2hhbmdlcyc7IC8vIEFjY2Vzc2liaWxpdHlcclxuICAgICAgICBva0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHsgdmFsdWVzOiB0aGlzLnJlc3VsdCB9KTsgLy8gUmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoIHRoZSByZXN1bHRcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBtb2RhbCBpcyBjbG9zZWQuIENsZWFucyB1cCByZXNvdXJjZXMuXHJcbiAgICAgKi9cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7IC8vIENsZWFyIHRoZSBtb2RhbCdzIGNvbnRlbnRcclxuICAgIH1cclxuXHJcbiAgICBvcGVuQW5kR2V0VmFsdWVzKCk6IFByb21pc2U8YXV0b2NvbXBsZXRlTW9kYWxSZXN1bHQgfCBudWxsPiB7XHJcbiAgICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTsgLy8gUmV0dXJuIHRoZSBwcm9taXNlXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogT3BlbnMgYW4gYXV0b2NvbXBsZXRlIG1vZGFsIGZvciBzZWxlY3Rpbmcgb3IgZW50ZXJpbmcgdmFsdWVzIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBwYXJhbWV0ZXJzLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gVGhlIE9ic2lkaWFuIGFwcGxpY2F0aW9uIGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gcGx1Z2luIC0gVGhlIHBsdWdpbiBpbnN0YW5jZSB0aGF0IGlzIGludm9raW5nIHRoZSBtb2RhbC5cclxuICogQHBhcmFtIHJ1bGUgLSBUaGUgZm9sZGVyLXRvLXRhZyBydWxlIGRlZmluaXRpb24gdG8gYmUgdXNlZCBpbiB0aGUgbW9kYWwuXHJcbiAqIEBwYXJhbSBhY3RpdmVGaWxlIC0gVGhlIGN1cnJlbnRseSBhY3RpdmUgZmlsZSBvciBmb2xkZXIsIGlmIGFueS5cclxuICogQHBhcmFtIGZyb250bWF0dGVyIC0gVGhlIGZyb250bWF0dGVyIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBhY3RpdmUgZmlsZS5cclxuICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3VsdCBvZiB0aGUgYXV0b2NvbXBsZXRlIG1vZGFsLCBvciBgbnVsbGAgaWYgbm8gc2VsZWN0aW9uIHdhcyBtYWRlLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5BdXRvY29tcGxldGVNb2RhbChcclxuICAgIGFwcDogQXBwIHwgdW5kZWZpbmVkLFxyXG4gICAgcGx1Z2luOiBhbnksXHJcbiAgICBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLFxyXG4gICAgb3B0aW9uczogYW55LFxyXG4gICAgYWN0aXZlRmlsZTogVEZpbGUgfCBURm9sZGVyIHwgdW5kZWZpbmVkLFxyXG4gICAgZnJvbnRtYXR0ZXI6IGFueVxyXG4pOiBQcm9taXNlPGF1dG9jb21wbGV0ZU1vZGFsUmVzdWx0IHwgbnVsbD4ge1xyXG4gICAgLy8gQ3JlYXRlIGFuZCBvcGVuIHRoZSBtb2RhbCBpbnN0YW5jZVxyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICBsb2dnZXIubG9nKEVSUk9SLFwiQXBwIGlzIHVuZGVmaW5lZFwiKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IG1vZGFsID0gbmV3IEF1dG9jb21wbGV0ZU1vZGFsKGFwcCwgcGx1Z2luLCBydWxlLCBvcHRpb25zLCBhY3RpdmVGaWxlLCBmcm9udG1hdHRlcik7XHJcbiAgICByZXR1cm4gYXdhaXQgbW9kYWwub3BlbkFuZEdldFZhbHVlcygpOyAvLyBXYWl0IGZvciB0aGUgcHJvbWlzZSB0byByZXNvbHZlXHJcbn1cclxuIiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIFByb3BlcnR5VHlwZUluZm8gfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZGVsaW1pdGVyIH0gZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IHsgTXVsdGlQcm9wZXJ0eVNldHRpbmcgfSBmcm9tIFwiLi4vdWlNdWx0aVByb3BlcnR5U2V0dGluZ1wiO1xyXG5cclxuLyoqXHJcbiAqIFJ1bGVCdWlsZEluQ29uY2F0QXJyYXlzIGlzIGEgYnVpbHQtaW4gcnVsZSBmb3IgY29uY2F0ZW5hdGluZyBtdWx0aXBsZSBmcm9udG1hdHRlciBhcnJheSBwcm9wZXJ0aWVzXHJcbiAqIChzdWNoIGFzIHRleHQsIHRhZ3MsIGFsaWFzZXMsIG9yIG11bHRpdGV4dCkgZnJvbSBhIGZpbGUgaW4gT2JzaWRpYW4uIEl0IGFsbG93cyB1c2VycyB0byBzZWxlY3RcclxuICogd2hpY2ggcHJvcGVydGllcyB0byBjb25jYXRlbmF0ZSBhbmQgb3B0aW9uYWxseSByZXF1aXJlcyB0aGF0IGFsbCBzZWxlY3RlZCBwcm9wZXJ0aWVzIGV4aXN0IGFuZCBhcmUgbm9uLWVtcHR5LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIGNhbiBiZSBjb25maWd1cmVkIHZpYSBhIHNldHRpbmdzIHRhYiwgYWxsb3dpbmcgdXNlcnMgdG8gc2VsZWN0IGlucHV0IHByb3BlcnRpZXMgYW5kIHRvZ2dsZVxyXG4gKiAgIHdoZXRoZXIgYWxsIHByb3BlcnRpZXMgbXVzdCBleGlzdCBmb3IgdGhlIHJ1bGUgdG8gcmV0dXJuIGEgdmFsdWUuXHJcbiAqIC0gVGhlIGNvbmNhdGVuYXRpb24gY2FuIGJlIGN1c3RvbWl6ZWQgd2l0aCBhIGRlbGltaXRlci5cclxuICogLSBUaGUgcnVsZSBpcyBkZXNpZ25lZCB0byB3b3JrIHdpdGggcHJvcGVydGllcyBvZiB0eXBlICd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsIG9yICdtdWx0aXRleHQnLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiAvLyBVc2FnZSBpbiBhIHJ1bGUgY29uZmlndXJhdGlvbjpcclxuICoge1xyXG4gKiAgIGlkOiAnY29uY2F0QXJyYXlzJyxcclxuICogICBpbnB1dFByb3BlcnRpZXM6IFsndGFncycsICdhbGlhc2VzJ10sXHJcbiAqICAgb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3Q6IHRydWVcclxuICogfVxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJbkNvbmNhdEFycmF5cyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuaWQgPSAnY29uY2F0QXJyYXlzJztcclxuICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICB0aGlzLm5hbWUgPSAnQ29uY2F0IEFycmF5cyc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbmNhdGVuYXRlcyBtdWx0aXBsZSBMaXN0cyAoTXVsdGl0ZXh0LCBUYWdzLCBBbGlhc2VzKS4nO1xyXG4gICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgY29uc3QgcHJvcGVydHlJZHMgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwnaW5wdXRQcm9wZXJ0aWVzJyk7XFxuICBpZiAoIUFycmF5LmlzQXJyYXkocHJvcGVydHlJZHMpIHx8IHByb3BlcnR5SWRzLmxlbmd0aCA9PT0gMCkge1xcbiAgICByZXR1cm4gJ05vIHByb3BlcnRpZXMgc2VsZWN0ZWQnO1xcbiAgfVxcbiAgY29uc3QgZGVsaW1pdGVyID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsJ2RlbGltaXRlcicpO1xcbiAgY29uc3Qgb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwgJ29ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0JykgfHwgZmFsc2U7XFxuICBpZiAob25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QpIHtcXG4gICAgLy8gQ2hlY2sgaWYgYWxsIHByb3BlcnRpZXMgZXhpc3RcXG4gICAgY29uc3QgYWxsRXhpc3QgPSBwcm9wZXJ0eUlkcy5ldmVyeShpZCA9PiB7IFxcbiAgICAgIGlmIChpZCA9PT0gdW5kZWZpbmVkIHx8IGlkID09PSBudWxsIHx8IGlkID09PSAnJykge1xcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIFNraXAgZW1wdHkgb3IgdW5kZWZpbmVkIHByb3BlcnR5IElEc1xcbiAgICAgIH1cXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gdG9vbHMuZ2V0RnJvbnRtYXR0ZXJQcm9wZXJ0eShpZCk7XFxuICAgICAgY29uc3QgcmVzdWx0ID0gcHJvcGVydHlWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BlcnR5VmFsdWUgIT09IG51bGwgJiYgcHJvcGVydHlWYWx1ZSAhPT0gJyc7XFxuICAgICAgcmV0dXJuIHJlc3VsdDtcXG4gICAgfSk7XFxuICAgIGlmICghYWxsRXhpc3QpIHtcXG4gICAgICByZXR1cm4gJyc7XFxuICAgIH1cXG4gIH1cXG4gIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5SWRzLm1hcChpZCA9PiB7XFxuICAgIGxldCB2YWx1ZSA9IHRvb2xzLmdldEZyb250bWF0dGVyUHJvcGVydHkoaWQpO1xcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpIHtcXG4gICAgICByZXR1cm4gJyc7IC8vIFNraXAgZW1wdHkgb3IgdW5kZWZpbmVkIHByb3BlcnRpZXNcXG4gICAgfVxcbiAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcXG4gIH0pLmZpbHRlcihyZXMgPT4gcmVzICE9PSB1bmRlZmluZWQpLmpvaW4oZGVsaW1pdGVyKTtcXG4gIHJldHVybiByZXN1bHQ7XFxufTtcIjtcclxuICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gIH1cclxuICBcclxuICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICBjb25zdCBwcm9wZXJ0eUlkcyA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCdpbnB1dFByb3BlcnRpZXMnKTtcclxuICAgIGlmICghQXJyYXkuaXNBcnJheShwcm9wZXJ0eUlkcykgfHwgcHJvcGVydHlJZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiAnTm8gcHJvcGVydGllcyBzZWxlY3RlZCc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBvbmx5V2hlbkFsbFByb3BlcnRpZXNFeGlzdCA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCAnb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QnKSB8fCBmYWxzZTtcclxuICAgIGlmIChvbmx5V2hlbkFsbFByb3BlcnRpZXNFeGlzdCkge1xyXG4gICAgICAvLyBDaGVjayBpZiBhbGwgcHJvcGVydGllcyBleGlzdFxyXG4gICAgICBjb25zdCBhbGxFeGlzdCA9IHByb3BlcnR5SWRzLmV2ZXJ5KGlkID0+IHsgXHJcbiAgICAgICAgaWYgKGlkID09PSB1bmRlZmluZWQgfHwgaWQgPT09IG51bGwgfHwgaWQgPT09ICcnKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gU2tpcCBlbXB0eSBvciB1bmRlZmluZWQgcHJvcGVydHkgSURzXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSB0b29scy5nZXRGcm9udG1hdHRlclByb3BlcnR5KGlkKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBwcm9wZXJ0eVZhbHVlICE9PSB1bmRlZmluZWQgJiYgcHJvcGVydHlWYWx1ZSAhPT0gbnVsbCAmJiBwcm9wZXJ0eVZhbHVlICE9PSAnJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9KTtcclxuICAgICAgaWYgKCFhbGxFeGlzdCkge1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZXN1bHRBcnJheTogc3RyaW5nW10gPSBbXTtcclxuICAgIHByb3BlcnR5SWRzLmZvckVhY2goaWQgPT4ge1xyXG4gICAgICBsZXQgdmFsdWUgPSB0b29scy5nZXRGcm9udG1hdHRlclByb3BlcnR5KGlkKTtcclxuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuOyAvLyBTa2lwIGVtcHR5IG9yIHVuZGVmaW5lZCBwcm9wZXJ0aWVzXHJcbiAgICAgIH1cclxuICAgICAgcmVzdWx0QXJyYXkgPSByZXN1bHRBcnJheS5jb25jYXQoQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZS50b1N0cmluZygpXSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHRBcnJheTtcclxuICB9XHJcblxyXG4gIGNvbmZpZ1RhYihvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6IGFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgICBpbnB1dFByb3BlcnRpZXM6IFtdLFxyXG4gICAgICAgIG9ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0OiBmYWxzZSwgLy8gRGVmYXVsdCB0byBmYWxzZVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IG11bHRpUHJvcCA9IG5ldyBNdWx0aVByb3BlcnR5U2V0dGluZyhvcHRpb25FTClcclxuICAgICAgLnNldE5hbWUoXCJJbnB1dCBQcm9wZXJ0aWVzXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiU2VsZWN0IHByb3BlcnRpZXMgYXMgaW5wdXQuICh0ZXh0LCB0YWdzLCBhbGlhc2VzIG9yIG11bHRpdGV4dClcIilcclxuICAgICAgLnNldE9wdGlvbnMoT2JqZWN0LmtleXModGhhdC5rbm93blByb3BlcnRpZXMpLm1hcCgoa2V5KSA9PiB7XHJcbiAgICAgICAgY29uc3QgcHJvcCA9IHRoYXQua25vd25Qcm9wZXJ0aWVzW2tleV07XHJcbiAgICAgICAgaWYgKHByb3AudHlwZSA9PT0gJ3RleHQnIHx8IHByb3AudHlwZSA9PT0gJ3RhZ3MnIHx8IHByb3AudHlwZSA9PT0gJ2FsaWFzZXMnIHx8IHByb3AudHlwZSA9PT0gJ211bHRpdGV4dCcpIHtcclxuICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsOyAvLyBGaWx0ZXIgb3V0IHVuc3VwcG9ydGVkIHR5cGVzXHJcbiAgICAgIH0pLmZpbHRlcigoaXRlbSk6IGl0ZW0gaXMgc3RyaW5nID0+IGl0ZW0gIT09IG51bGwpKVxyXG4gICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCwgJ2lucHV0UHJvcGVydGllcycpIHx8IFtdKVxyXG4gICAgICAub25DaGFuZ2UoKGFycikgPT4ge1xyXG4gICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwgJ2lucHV0UHJvcGVydGllcycsIGFycik7XHJcbiAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAuc2V0TmFtZSgnT25seSB3aGVuIGFsbCBwcm9wZXJ0aWVzIGV4aXN0JylcclxuICAgICAgICAuc2V0RGVzYygnSWYgZW5hYmxlZCwgdGhlIHJ1bGUgd2lsbCBvbmx5IHJldHVybiBhIHZhbHVlIGlmIGFsbCBzZWxlY3RlZCBwcm9wZXJ0aWVzIGV4aXN0IGFuZCBub3QgZW1wdHkuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsICdvbmx5V2hlbkFsbFByb3BlcnRpZXNFeGlzdCcpKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCAnb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICB9O1xyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIFByb3BlcnR5VHlwZUluZm8gfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZGVsaW1pdGVyIH0gZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IHsgTXVsdGlQcm9wZXJ0eVNldHRpbmcgfSBmcm9tIFwiLi4vdWlNdWx0aVByb3BlcnR5U2V0dGluZ1wiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBidWlsdC1pbiBydWxlIGZvciByZXRyaWV2aW5nIGEgcHJvcGVydHkgdmFsdWUgZnJvbSB0aGUgZnJvbnRtYXR0ZXIgb2YgYSBmaWxlLlxyXG4gKiBcclxuICogVGhpcyBydWxlIGFsbG93cyB1c2VycyB0byBzZWxlY3QgYSBwcm9wZXJ0eSAoc3VjaCBhcyB0ZXh0LCB0YWdzLCBhbGlhc2VzLCBvciBtdWx0aXRleHQpIGFuZCByZXRyaWV2ZSBpdHMgdmFsdWVcclxuICogZnJvbSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGZpbGUncyBmcm9udG1hdHRlci4gVGhlIHJ1bGUgcHJvdmlkZXMgY29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBzZWxlY3RpbmcgdGhlIHByb3BlcnR5LFxyXG4gKiBhbmQgZXhwb3NlcyBhIGZ1bmN0aW9uIChgZnhgKSB0aGF0IHBlcmZvcm1zIHRoZSByZXRyaWV2YWwuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIGlzIGlkZW50aWZpZWQgYnkgdGhlIElEICdnZXRQcm9wZXJ0eScgYW5kIGlzIGNhdGVnb3JpemVkIGFzIGEgYnVpbHQtaW4gcnVsZS5cclxuICogLSBUaGUgY29uZmlndXJhdGlvbiB0YWIgYWxsb3dzIHVzZXJzIHRvIHNlbGVjdCB3aGljaCBwcm9wZXJ0eSB0byByZXRyaWV2ZS5cclxuICogLSBUaGUgYGZ4YCBtZXRob2QgaXMgdGhlIG1haW4gbG9naWMgZm9yIGV4dHJhY3RpbmcgdGhlIHByb3BlcnR5IHZhbHVlLlxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogLy8gVXNhZ2Ugd2l0aGluIHRoZSBwbHVnaW4ncyBydWxlIHN5c3RlbTpcclxuICogY29uc3QgcnVsZSA9IG5ldyBSdWxlQnVpbGRJbkdldFByb3BlcnR5KCk7XHJcbiAqIGNvbnN0IHZhbHVlID0gcnVsZS5meChhcHAsIGZpbGUsIHRvb2xzKTtcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUgKCdnZXRQcm9wZXJ0eScpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoJ2J1aWxkSW4nKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgcHVycG9zZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBwcm9wZXJ0aWVzIHRoaXMgcnVsZSBjYW4gaGFuZGxlLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIFRoZSBmdW5jdGlvbiB0aGF0IHJldHJpZXZlcyB0aGUgcHJvcGVydHkgdmFsdWUuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGNvbmZpZ1RhYiAtIFRoZSBmdW5jdGlvbiB0aGF0IHJlbmRlcnMgdGhlIGNvbmZpZ3VyYXRpb24gVUkgZm9yIHRoZSBydWxlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluQ29uY2F0UHJvcGVydGllcyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuaWQgPSAnY29uY2F0UHJvcGVydGllcyc7XHJcbiAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgdGhpcy5uYW1lID0gJ0NvbmNhdCBQcm9wZXJ0aWVzJztcclxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ29uY2F0ZW5hdGVzIG11bHRpcGxlIHByb3BlcnRpZXMgZnJvbSB0aGUgZnJvbnRtYXR0ZXIuJztcclxuICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHByb3BlcnR5SWRzID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsJ2lucHV0UHJvcGVydGllcycpO1xcbiAgaWYgKCFBcnJheS5pc0FycmF5KHByb3BlcnR5SWRzKSB8fCBwcm9wZXJ0eUlkcy5sZW5ndGggPT09IDApIHtcXG4gICAgcmV0dXJuICdObyBwcm9wZXJ0aWVzIHNlbGVjdGVkJztcXG4gIH1cXG4gIGNvbnN0IGRlbGltaXRlciA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCdkZWxpbWl0ZXInKTtcXG4gIGNvbnN0IG9ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0ID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsICdvbmx5V2hlbkFsbFByb3BlcnRpZXNFeGlzdCcpIHx8IGZhbHNlO1xcbiAgaWYgKG9ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0KSB7XFxuICAgIC8vIENoZWNrIGlmIGFsbCBwcm9wZXJ0aWVzIGV4aXN0XFxuICAgIGNvbnN0IGFsbEV4aXN0ID0gcHJvcGVydHlJZHMuZXZlcnkoaWQgPT4geyBcXG4gICAgICBpZiAoaWQgPT09IHVuZGVmaW5lZCB8fCBpZCA9PT0gbnVsbCB8fCBpZCA9PT0gJycpIHtcXG4gICAgICAgIHJldHVybiB0cnVlOyAvLyBTa2lwIGVtcHR5IG9yIHVuZGVmaW5lZCBwcm9wZXJ0eSBJRHNcXG4gICAgICB9XFxuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IHRvb2xzLmdldEZyb250bWF0dGVyUHJvcGVydHkoaWQpO1xcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBwcm9wZXJ0eVZhbHVlICE9PSBudWxsICYmIHByb3BlcnR5VmFsdWUgIT09ICcnO1xcbiAgICAgIHJldHVybiByZXN1bHQ7XFxuICAgIH0pO1xcbiAgICBpZiAoIWFsbEV4aXN0KSB7XFxuICAgICAgcmV0dXJuICcnO1xcbiAgICB9XFxuICB9XFxuICBjb25zdCByZXN1bHQgPSBwcm9wZXJ0eUlkcy5tYXAoaWQgPT4ge1xcbiAgICBsZXQgdmFsdWUgPSB0b29scy5nZXRGcm9udG1hdHRlclByb3BlcnR5KGlkKTtcXG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XFxuICAgICAgcmV0dXJuICcnOyAvLyBTa2lwIGVtcHR5IG9yIHVuZGVmaW5lZCBwcm9wZXJ0aWVzXFxuICAgIH1cXG4gICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XFxuICB9KS5maWx0ZXIocmVzID0+IHJlcyAhPT0gdW5kZWZpbmVkKS5qb2luKGRlbGltaXRlcik7XFxuICByZXR1cm4gcmVzdWx0O1xcbn07XCI7XHJcbiAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICB9XHJcbiAgXHJcbiAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgY29uc3QgcHJvcGVydHlJZHMgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwnaW5wdXRQcm9wZXJ0aWVzJyk7XHJcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJvcGVydHlJZHMpIHx8IHByb3BlcnR5SWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gJ05vIHByb3BlcnRpZXMgc2VsZWN0ZWQnO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGVsaW1pdGVyID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsJ2RlbGltaXRlcicpO1xyXG4gICAgY29uc3Qgb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwgJ29ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0JykgfHwgZmFsc2U7XHJcbiAgICBpZiAob25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QpIHtcclxuICAgICAgLy8gQ2hlY2sgaWYgYWxsIHByb3BlcnRpZXMgZXhpc3RcclxuICAgICAgY29uc3QgYWxsRXhpc3QgPSBwcm9wZXJ0eUlkcy5ldmVyeShpZCA9PiB7IFxyXG4gICAgICAgIGlmIChpZCA9PT0gdW5kZWZpbmVkIHx8IGlkID09PSBudWxsIHx8IGlkID09PSAnJykge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7IC8vIFNraXAgZW1wdHkgb3IgdW5kZWZpbmVkIHByb3BlcnR5IElEc1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gdG9vbHMuZ2V0RnJvbnRtYXR0ZXJQcm9wZXJ0eShpZCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcHJvcGVydHlWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BlcnR5VmFsdWUgIT09IG51bGwgJiYgcHJvcGVydHlWYWx1ZSAhPT0gJyc7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfSk7XHJcbiAgICAgIGlmICghYWxsRXhpc3QpIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3VsdCA9IHByb3BlcnR5SWRzLm1hcChpZCA9PiB7XHJcbiAgICAgIGxldCB2YWx1ZSA9IHRvb2xzLmdldEZyb250bWF0dGVyUHJvcGVydHkoaWQpO1xyXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICByZXR1cm4gJyc7IC8vIFNraXAgZW1wdHkgb3IgdW5kZWZpbmVkIHByb3BlcnRpZXNcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIH0pLmZpbHRlcihyZXMgPT4gcmVzICE9PSB1bmRlZmluZWQpLmpvaW4oZGVsaW1pdGVyKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICBjb25maWdUYWIob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OiBhbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgZGVsaW1pdGVyOiAnICcsIC8vIERlZmF1bHQgZGVsaW1pdGVyIGZvciBjb25jYXRlbmF0aW9uXHJcbiAgICAgICAgaW5wdXRQcm9wZXJ0aWVzOiBbXSxcclxuICAgICAgICBvbmx5V2hlbkFsbFByb3BlcnRpZXNFeGlzdDogdHJ1ZSwgLy8gRGVmYXVsdCB0byBmYWxzZVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IG11bHRpUHJvcCA9IG5ldyBNdWx0aVByb3BlcnR5U2V0dGluZyhvcHRpb25FTClcclxuICAgICAgLnNldE5hbWUoXCJJbnB1dCBQcm9wZXJ0aWVzXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiU2VsZWN0IHByb3BlcnRpZXMgYXMgaW5wdXQuIFVzZSAnU3BhY2UgcmVwbGFjZW1lbnQnIGFzIGRlbGltaXRlci5cIilcclxuICAgICAgLnNldE9wdGlvbnMoT2JqZWN0LmtleXModGhhdC5rbm93blByb3BlcnRpZXMpLm1hcCgoa2V5KSA9PiBrZXkpKVxyXG4gICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCwgJ2lucHV0UHJvcGVydGllcycpIHx8IFtdKVxyXG4gICAgICAub25DaGFuZ2UoKGFycikgPT4ge1xyXG4gICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwgJ2lucHV0UHJvcGVydGllcycsIGFycik7XHJcbiAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAuc2V0TmFtZSgnRGVsaW1pdGVyJylcclxuICAgICAgICAuc2V0RGVzYygnU3BlY2lmeSBhIGRlbGltaXRlciB0byB1c2Ugd2hlbiBjb25jYXRlbmF0aW5nIHByb3BlcnRpZXMuIERlZmF1bHQgaXMgYSBzcGFjZS4nKVxyXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2RlbGltaXRlcicpIHx8ICcnKVxyXG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGRlbGltaXRlcicpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2RlbGltaXRlcicsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHRoYXQudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgLnNldE5hbWUoJ09ubHkgd2hlbiBhbGwgcHJvcGVydGllcyBleGlzdCcpXHJcbiAgICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZWQsIHRoZSBydWxlIHdpbGwgb25seSByZXR1cm4gYSB2YWx1ZSBpZiBhbGwgc2VsZWN0ZWQgcHJvcGVydGllcyBleGlzdCBhbmQgbm90IGVtcHR5LicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkLCAnb25seVdoZW5BbGxQcm9wZXJ0aWVzRXhpc3QnKSlcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwgJ29ubHlXaGVuQWxsUHJvcGVydGllc0V4aXN0JywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgYnVpbHQtaW4gcnVsZSB0aGF0IHJldHVybnMgYSBjb25zdGFudCB2YWx1ZSBpbnN0ZWFkIG9mIGV4dHJhY3RpbmcgYSB2YWx1ZSBmcm9tIHRoZSBmcm9udG1hdHRlci5cclxuICpcclxuICogVGhpcyBydWxlIGFsbG93cyB1c2VycyB0byBzcGVjaWZ5IGEgY29uc3RhbnQgdmFsdWUgdGhhdCB3aWxsIGFsd2F5cyBiZSByZXR1cm5lZCB3aGVuIHRoZSBydWxlIGlzIGV4ZWN1dGVkLlxyXG4gKiBUaGUgdmFsdWUgY2FuIGJlIGNvbmZpZ3VyZWQgdmlhIHRoZSBwbHVnaW4ncyBzZXR0aW5ncyBVSS5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIHR5cGUgaXMgc2V0IHRvIGAnYnVpbGRJbidgLlxyXG4gKiAtIFRoZSBjb25zdGFudCB2YWx1ZSBpcyBjb25maWd1cmVkIHVzaW5nIHRoZSBgY29uc3RhbnRWYWx1ZWAgb3B0aW9uLlxyXG4gKiAtIFRoZSBydWxlIHN1cHBvcnRzIG11bHRpcGxlIHR5cGVzOiBgJ3RleHQnYCwgYCd0YWdzJ2AsIGAnYWxpYXNlcydgLCBhbmQgYCdtdWx0aXRleHQnYC5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlID0gbmV3IFJ1bGVCdWlsZEluQ29uc3RhbnQoKTtcclxuICogY29uc3QgdmFsdWUgPSBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMpOyAvLyBSZXR1cm5zIHRoZSBjb25maWd1cmVkIGNvbnN0YW50IHZhbHVlXHJcbiAqIGBgYFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluQ29uc3RhbnQgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdjb25zdGFudCc7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnQ29uc3RhbnQgdmFsdWUnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmV0dXJucyBhIGNvbnN0YW50IHZhbHVlIGluc3RlYWQgb2YgdGhlIGZyb250bWF0dGVyIHBhcmFtZXRlci4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGNvbnN0IHJlc3VsdCA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCdjb25zdGFudFZhbHVlJyk7XFxuICByZXR1cm4gcmVzdWx0OyAvLyBSZXR1cm4gdGhlIGNvbnN0YW50IHZhbHVlXFxufTtcIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9XHJcbiAgICBmeChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwnY29uc3RhbnRWYWx1ZScpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7IC8vIFJldHVybiB0aGUgY29uc3RhbnQgdmFsdWVcclxuICAgIH07XHJcbiAgICBjb25maWdUYWIob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OiBhbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIG9wdGlvbkVMLmVtcHR5KCk7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc2V0dGluZyBmb3IgdGhlIGNvbnN0YW50IHZhbHVlXHJcbiAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgICAgIGNvbnN0YW50VmFsdWU6ICcnLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc2V0dGluZyBmb3IgdGhlIGNvbnN0YW50IHZhbHVlXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdDb25zdGFudCB2YWx1ZScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbnRlciBhIGNvbnN0YW50IHZhbHVlIHRvIGJlIHVzZWQgaW4gdGhlIHJ1bGUnKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwnY29uc3RhbnRWYWx1ZScpIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2NvbnN0YW50VmFsdWUnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgIH07XHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBidWlsdC1pbiBydWxlIHRoYXQgcmV0dXJucyB0aGUgZGF0ZSBhbmQgdGltZSB3aGVuIGEgZmlsZSB3YXMgY3JlYXRlZC5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhpcyBydWxlIGNhbGN1bGF0ZXMgdGhlIGZpbGUgY3JlYXRpb24gZGF0ZSBhbmQgdGltZSwgYWRqdXN0ZWQgZm9yIHRoZSBsb2NhbCB0aW1lem9uZSxcclxuICogYW5kIHJldHVybnMgaXQgYXMgYW4gSVNPIHN0cmluZyB3aXRob3V0IHRoZSB0cmFpbGluZyAnWicgKFVUQyBzeW1ib2wpLlxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogY29uc3QgcnVsZSA9IG5ldyBSdWxlQnVpbGRJbkRhdGVUaW1lQ3JlYXRlZCgpO1xyXG4gKiBjb25zdCBjcmVhdGVkRGF0ZSA9IHJ1bGUuZngoYXBwLCBmaWxlLCB0b29scyk7XHJcbiAqIC8vIGNyZWF0ZWREYXRlIHdpbGwgYmUgYSBzdHJpbmcgbGlrZSBcIjIwMjQtMDYtMDFUMTI6MzQ6NTYuNzg5XCJcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwcm9wZXJ0eSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUgKCdkYXRlVGltZUNyZWF0ZWQnKS5cclxuICogQHByb3BlcnR5IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUgKCdidWlsZEluJykuXHJcbiAqIEBwcm9wZXJ0eSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IGRlc2NyaXB0aW9uIC0gQSBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSBydWxlIGRvZXMuXHJcbiAqIEBwcm9wZXJ0eSBzb3VyY2UgLSBUaGUgc291cmNlIGNvZGUgb2YgdGhlIHJ1bGUncyBtYWluIGZ1bmN0aW9uIGFzIGEgc3RyaW5nLlxyXG4gKiBAcHJvcGVydHkgdHlwZSAtIFRoZSB0eXBlcyBvZiBkYXRhIHJldHVybmVkIGJ5IHRoZSBydWxlIChbJ2RhdGUnLCAnZGF0ZXRpbWUnXSkuXHJcbiAqIEBwcm9wZXJ0eSBjb25maWdFbGVtZW50cyAtIFRoZSBjb25maWd1cmF0aW9uIGVsZW1lbnRzIGZvciB0aGUgcnVsZS5cclxuICpcclxuICogQG1ldGhvZCBmeCAtIFJldHVybnMgdGhlIGZpbGUgY3JlYXRpb24gZGF0ZSBhbmQgdGltZSBhcyBhIGxvY2FsIElTTyBzdHJpbmcuXHJcbiAqIEBtZXRob2QgY29uZmlnVGFiIC0gKE9wdGlvbmFsKSBBZGRzIGNvbmZpZ3VyYXRpb24gVUkgZWxlbWVudHMgZm9yIHRoZSBydWxlLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluRGF0ZVRpbWVDcmVhdGVkIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnZGF0ZVRpbWVDcmVhdGVkJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdEYXRlIChhbmQgVGltZSkgY3JlYXRlZCc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9ICdUaGlzIHJ1bGUgcmV0dXJucyB0aGUgZGF0ZSBhbmQgdGltZSB3aGVuIHRoZSBmaWxlIHdhcyBjcmVhdGVkLCBhZGp1c3RlZCBmb3IgbG9jYWwgdGltZXpvbmUuJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24oYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhIFxcbiBjb25zdCB0aW1lT2Zmc2V0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMDsgLy8gZ2V0IGxvY2FsIHRpbWUgb2Zmc2V0IFxcbiBjb25zdCByZXN1bHQgPSBuZXcgRGF0ZShmaWxlLnN0YXQuY3RpbWUtdGltZU9mZnNldCk7IFxcbiByZXR1cm4gcmVzdWx0LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1onKVswXTsgLy8gcmVtb3ZlIFVUQyBzeW1ib2wgXFxuIH1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ2RhdGUnLCAnZGF0ZXRpbWUnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgY29uc3QgdGltZU9mZnNldCA9IG5ldyBEYXRlKERhdGUubm93KCkpLmdldFRpbWV6b25lT2Zmc2V0KCkqNjAwMDA7IC8vIGdldCBsb2NhbCB0aW1lIG9mZnNldFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlKGZpbGUuc3RhdC5jdGltZS10aW1lT2Zmc2V0KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1onKVswXTsgLy8gcmVtb3ZlIFVUQyBzeW1ib2xcclxuICAgICAgfVxyXG5cclxuICAgIGNvbmZpZ1RhYiAob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJ1aWx0LWluIHJ1bGUgdGhhdCByZXR1cm5zIHRoZSBkYXRlIGFuZCB0aW1lIHdoZW4gYSBmaWxlIHdhcyBjcmVhdGVkLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIHJ1bGUgY2FsY3VsYXRlcyB0aGUgZmlsZSBjcmVhdGlvbiBkYXRlIGFuZCB0aW1lLCBhZGp1c3RlZCBmb3IgdGhlIGxvY2FsIHRpbWV6b25lLFxyXG4gKiBhbmQgcmV0dXJucyBpdCBhcyBhbiBJU08gc3RyaW5nIHdpdGhvdXQgdGhlIHRyYWlsaW5nICdaJyAoVVRDIHN5bWJvbCkuXHJcbiAqXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlID0gbmV3IFJ1bGVCdWlsZEluRGF0ZVRpbWVDcmVhdGVkKCk7XHJcbiAqIGNvbnN0IGNyZWF0ZWREYXRlID0gcnVsZS5meChhcHAsIGZpbGUsIHRvb2xzKTtcclxuICogLy8gY3JlYXRlZERhdGUgd2lsbCBiZSBhIHN0cmluZyBsaWtlIFwiMjAyNC0wNi0wMVQxMjozNDo1Ni43ODlcIlxyXG4gKiBgYGBcclxuICpcclxuICogQHByb3BlcnR5IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoJ2RhdGVUaW1lQ3JlYXRlZCcpLlxyXG4gKiBAcHJvcGVydHkgcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoJ2J1aWxkSW4nKS5cclxuICogQHByb3BlcnR5IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkgZGVzY3JpcHRpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHJ1bGUgZG9lcy5cclxuICogQHByb3BlcnR5IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgcnVsZSdzIG1haW4gZnVuY3Rpb24gYXMgYSBzdHJpbmcuXHJcbiAqIEBwcm9wZXJ0eSB0eXBlIC0gVGhlIHR5cGVzIG9mIGRhdGEgcmV0dXJuZWQgYnkgdGhlIHJ1bGUgKFsnZGF0ZScsICdkYXRldGltZSddKS5cclxuICogQHByb3BlcnR5IGNvbmZpZ0VsZW1lbnRzIC0gVGhlIGNvbmZpZ3VyYXRpb24gZWxlbWVudHMgZm9yIHRoZSBydWxlLlxyXG4gKlxyXG4gKiBAbWV0aG9kIGZ4IC0gUmV0dXJucyB0aGUgZmlsZSBjcmVhdGlvbiBkYXRlIGFuZCB0aW1lIGFzIGEgbG9jYWwgSVNPIHN0cmluZy5cclxuICogQG1ldGhvZCBjb25maWdUYWIgLSAoT3B0aW9uYWwpIEFkZHMgY29uZmlndXJhdGlvbiBVSSBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5EYXRlVGltZU1vZGlmaWVkIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnZGF0ZVRpbWVNb2RpZmllZCc7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnRGF0ZSAoYW5kIFRpbWUpIG1vZGlmaWVkJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1RoaXMgcnVsZSByZXR1cm5zIHRoZSBkYXRlIGFuZCB0aW1lIHdoZW4gdGhlIGZpbGUgd2FzIGxhc3QgbW9kaWZpZWQsIGFkanVzdGVkIGZvciBsb2NhbCB0aW1lem9uZS4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbihhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSEgXFxuIGNvbnN0IHRpbWVPZmZzZXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lem9uZU9mZnNldCgpKjYwMDAwOyAvLyBnZXQgbG9jYWwgdGltZSBvZmZzZXQgXFxuIGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZS10aW1lT2Zmc2V0KTsgXFxuIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbCBcXG4gfVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsnZGF0ZScsICdkYXRldGltZSddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBjb25zdCB0aW1lT2Zmc2V0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMDsgLy8gZ2V0IGxvY2FsIHRpbWUgb2Zmc2V0XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lLXRpbWVPZmZzZXQpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQudG9JU09TdHJpbmcoKS5zcGxpdCgnWicpWzBdOyAvLyByZW1vdmUgVVRDIHN5bWJvbFxyXG4gICAgICB9XHJcblxyXG4gICAgY29uZmlnVGFiIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gICAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBidWlsdC1pbiBydWxlIHRoYXQgcGFzc2VzIHRoZSBjb250ZW50IG9mIGEgZnJvbnRtYXR0ZXIgcGFyYW1ldGVyIHVuYWx0ZXJlZC5cclxuICogVGhpcyBydWxlIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSBpbnB1dCBjb250ZW50IHdpdGhvdXQgYW55IG1vZGlmaWNhdGlvbnMuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBgZnhgIGZ1bmN0aW9uIGFuZCBgc291cmNlYCBwcm9wZXJ0eSBhcmUgZGVzaWduZWQgdG8gcHJvY2VzcyB0aGUgaW5wdXQgY29udGVudCBhbmQgcmV0dXJuIGl0IGFzLWlzLlxyXG4gKiAtIFRoaXMgcnVsZSBzdXBwb3J0cyBtdWx0aXBsZSB0eXBlcyBpbmNsdWRpbmcgYHRleHRgLCBgdGFnc2AsIGBhbGlhc2VzYCwgYW5kIGBtdWx0aXRleHRgLlxyXG4gKiAtIFRoZSBgY29uZmlnVGFiYCBtZXRob2QgaXMgY3VycmVudGx5IGEgcGxhY2Vob2xkZXIgZm9yIGNvbmZpZ3VyYXRpb24gVUkgZWxlbWVudHMuXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLCBzZXQgdG8gYCdkZWZhdWx0J2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCBzZXQgdG8gYCdidWlsZEluJ2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZSwgc2V0IHRvIGAnUGFzcyBwYXJhbWV0ZXIgdW5hbHRlcmVkJ2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBydWxlIGFzIGEgc3RyaW5nLCB1c2VkIGZvciBzY3JpcHRpbmcgcHVycG9zZXMuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgc3VwcG9ydGVkIHR5cGVzIGZvciB0aGlzIHJ1bGUsIGluY2x1ZGluZyBgdGV4dGAsIGB0YWdzYCwgYGFsaWFzZXNgLCBhbmQgYG11bHRpdGV4dGAuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIG1haW4gZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgdGhlIGlucHV0IGNvbnRlbnQgYW5kIHJldHVybnMgaXQgdW5hbHRlcmVkLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBBIG1ldGhvZCBmb3IgcmVuZGVyaW5nIHRoZSBjb25maWd1cmF0aW9uIHRhYiBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAY29uc3RydWN0b3JcclxuICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIGBSdWxlQnVpbGRJbkRlZmF1bHRgIGNsYXNzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluRGVmYXVsdCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2RlZmF1bHQnO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1Bhc3MgcGFyYW1ldGVyIHVuYWx0ZXJlZCc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9ICdQYXNzIHRoZSBjb250ZW50IG9mIHRoZSBmcm9udG1hdHRlciBwYXJhbWV0ZXIgdW5hbHRlcmVkLic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgY29uc3QgaW5wdXQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpOyAvLyBHZXQgdGhlIGN1cnJlbnQgY29udGVudCBvZiBwcm9wZXJ0eVxcbiAgcmV0dXJuIGlucHV0OyAvLyBSZXR1cm4gdGhlIGlucHV0IHVuYWx0ZXJlZFxcbn07XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgY29uc3QgaW5wdXQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpOyAvLyBHZXQgdGhlIGN1cnJlbnQgY29udGVudCBvZiBwcm9wZXJ0eVxyXG4gICAgICAgIHJldHVybiBpbnB1dDsgLy8gUmV0dXJuIHRoZSBpbnB1dCB1bmFsdGVyZWRcclxuICAgIH07XHJcblxyXG4gICAgY29uZmlnVGFiIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gICAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgYnVpbHQtaW4gcnVsZSB0aGF0IHJldHJpZXZlcyB0aGUgc2l6ZSBvZiBhIGZpbGUgaW4gYnl0ZXMuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgcnVsZSBpcyBpbnRlbmRlZCBmb3IgdXNlIHdpdGhpbiB0aGUgRm9sZGVyIHRvIFRhZ3MgcGx1Z2luIGZvciBPYnNpZGlhbi5cclxuICogSXQgZXh0ZW5kcyB0aGUge0BsaW5rIFJ1bGVQcm90b3R5cGV9IGNsYXNzIGFuZCBwcm92aWRlcyBmdW5jdGlvbmFsaXR5IHRvIHJldHVyblxyXG4gKiB0aGUgZmlsZSBzaXplIGluIGJ5dGVzIHVzaW5nIHRoZSBgZmlsZS5zdGF0LnNpemVgIHByb3BlcnR5LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZUJ1aWxkSW5GaWxlU2l6ZUJ5dGVzKCk7XHJcbiAqIGNvbnN0IHNpemUgPSBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMpOyAvLyBSZXR1cm5zIHRoZSBmaWxlIHNpemUgaW4gYnl0ZXNcclxuICogYGBgXHJcbiAqXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluRmlsZVNpemVCeXRlcyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2ZpbGVTaXplQnl0ZXMnO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ0ZpbGUgU2l6ZSBpbiBCeXRlcyc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9ICdUaGlzIHJ1bGUgcmV0dXJucyB0aGUgc2l6ZSBvZiB0aGUgZmlsZSBpbiBieXRlcy4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbihhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSEgXFxuIGNvbnN0IHJlc3VsdCA9IGZpbGUuc3RhdC5zaXplOyBcXG4gcmV0dXJuIHJlc3VsdDsgLy8gcmV0dXJuIHlvdSByZXN1bHQuIFxcbiB9XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWydudW1iZXInXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgLy8gYWNxdWlyZSBmaWxlIHNpemVcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWxlLnN0YXQuc2l6ZTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyByZXR1cm4geW91IHJlc3VsdC5cclxuICAgIH1cclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG4gICAgXHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJ1aWx0LWluIHJ1bGUgdGhhdCByZXR1cm5zIHRoZSBzaXplIG9mIGEgZmlsZSBhcyBhIGh1bWFuLXJlYWRhYmxlIHN0cmluZy5cclxuICpcclxuICogVGhpcyBydWxlIGNvbnZlcnRzIHRoZSBmaWxlIHNpemUgZnJvbSBieXRlcyB0byBLQiwgTUIsIG9yIEdCIGFzIGFwcHJvcHJpYXRlLFxyXG4gKiBmb3JtYXR0aW5nIHRoZSByZXN1bHQgd2l0aCBhIGZpeGVkIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlcy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgcnVsZSBpcyBpZGVudGlmaWVkIGJ5IHRoZSBJRCBgJ2ZpbGVTaXplU3RyaW5nJ2AuXHJcbiAqIC0gVGhlIGBmeGAgbWV0aG9kIHBlcmZvcm1zIHRoZSBmaWxlIHNpemUgY29udmVyc2lvbiBhbmQgZm9ybWF0dGluZy5cclxuICogLSBUaGUgcnVsZSBpcyBpbnRlbmRlZCBmb3IgdXNlIHdpdGhpbiB0aGUgRm9sZGVyIHRvIFRhZ3MgcGx1Z2luIGZvciBPYnNpZGlhbi5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiAvLyBSZXR1cm5zIFwiNTEyIEJ5dGVzXCIgZm9yIGEgNTEyLWJ5dGUgZmlsZVxyXG4gKiAvLyBSZXR1cm5zIFwiMS4yMyBLQlwiIGZvciBhIGZpbGUgb2Ygc2l6ZSAxMjU5IGJ5dGVzXHJcbiAqIC8vIFJldHVybnMgXCIyLjM0IE1CXCIgZm9yIGEgZmlsZSBvZiBzaXplIDIsNDUzLDEyMyBieXRlc1xyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5GaWxlU2l6ZVN0cmluZyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2ZpbGVTaXplU3RyaW5nJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGaWxlIFNpemUgYXMgU3RyaW5nJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbnZlcnRzIHRoZSBmaWxlIHNpemUgdG8gYSBodW1hbi1yZWFkYWJsZSBzdHJpbmcgKGUuZy4sIEtCLCBNQiwgR0IpIHdpdGggMiBkZWNpbWFsIHBsYWNlcyBwcmVjaXNpb24uJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24oYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhIFxcbiBsZXQgc2l6ZSA9ZmlsZS5zdGF0LnNpemU7IFxcbiBjb25zdCBwcmVjaXNpb24gPSAyOyAvLyBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMgXFxuIGlmIChzaXplID4gMTAyNCkgeyBcXG4gICBzaXplID0gc2l6ZSAvIDEwMjQ7IFxcbiAgIGlmIChzaXplID4gMTAyNCkgeyBcXG4gICAgIHNpemUgPSBzaXplIC8gMTAyNDsgXFxuICAgICBpZiAoc2l6ZSA+IDEwMjQpIHsgXFxuICAgICAgIHNpemUgPSBzaXplIC8gMTAyNDsgXFxuICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgR0InOyBcXG4gICAgIH0gXFxuICAgICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIE1CJzsgXFxuICAgfSBcXG4gICByZXR1cm4gc2l6ZS50b0ZpeGVkKHByZWNpc2lvbikgKyAnIEtCJzsgXFxuIH0gICBcXG4gcmV0dXJuIHNpemUgKyAnIEJ5dGVzJzsgLy8gcmV0dXJuIHlvdSByZXN1bHQuIFxcbiB9XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgLy8gYWNxdWlyZSBmaWxlIHNpemVcclxuICAgICAgICBsZXQgc2l6ZSA9ZmlsZS5zdGF0LnNpemU7XHJcbiAgICAgICAgY29uc3QgcHJlY2lzaW9uID0gMjsgLy8gbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzXHJcbiAgICAgICAgaWYgKHNpemUgPiAxMDI0KSB7XHJcbiAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgc2l6ZSA9IHNpemUgLyAxMDI0O1xyXG4gICAgICAgICAgICBpZiAoc2l6ZSA+IDEwMjQpIHtcclxuICAgICAgICAgICAgICBzaXplID0gc2l6ZSAvIDEwMjQ7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBHQic7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIHJldHVybiBzaXplLnRvRml4ZWQocHJlY2lzaW9uKSArICcgTUInO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHNpemUudG9GaXhlZChwcmVjaXNpb24pICsgJyBLQic7XHJcbiAgICAgICAgfSAgIFxyXG4gICAgICAgIHJldHVybiBzaXplICsgJyBCeXRlcyc7IC8vIHJldHVybiB5b3UgcmVzdWx0LlxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ1RhYiAob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJ1aWx0LWluIHJ1bGUgdGhhdCBleHRyYWN0cyB0aGUgcGFyZW50IGZvbGRlciBvZiBhIGZpbGUuXHJcbiAqIFRoaXMgcnVsZSBpcyB1c2VkIHRvIGRldGVybWluZSB0aGUgZm9sZGVyIG5hbWUgdGhhdCBkaXJlY3RseSBjb250YWlucyB0aGUgZmlsZS5cclxuICogXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEByZW1hcmtzXHJcbiAqIC0gVGhlIGBmeGAgbWV0aG9kIGNhbGN1bGF0ZXMgdGhlIHBhcmVudCBmb2xkZXIgYnkgYW5hbHl6aW5nIHRoZSBmaWxlIHBhdGguXHJcbiAqIC0gVGhlIGBzb3VyY2VgIHByb3BlcnR5IGNvbnRhaW5zIGEgZGVmYXVsdCBmdW5jdGlvbiB0ZW1wbGF0ZSBmb3Igc2NyaXB0aW5nIHB1cnBvc2VzLlxyXG4gKiAtIFRoZSBgdHlwZWAgcHJvcGVydHkgc3BlY2lmaWVzIHRoZSBzdXBwb3J0ZWQgZGF0YSB0eXBlcyBmb3IgdGhpcyBydWxlLlxyXG4gKiAtIFRoZSBgY29uZmlnVGFiYCBtZXRob2QgY2FuIGJlIHVzZWQgdG8gZGVmaW5lIGEgY29uZmlndXJhdGlvbiBVSSBmb3IgdGhlIHJ1bGUsIGlmIG5lZWRlZC5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEV4YW1wbGUgdXNhZ2Ugb2YgdGhlIGBmeGAgbWV0aG9kOlxyXG4gKiBjb25zdCBwYXJlbnRGb2xkZXIgPSBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMpO1xyXG4gKiBjb25zb2xlLmxvZyhwYXJlbnRGb2xkZXIpOyAvLyBPdXRwdXRzIHRoZSBuYW1lIG9mIHRoZSBwYXJlbnQgZm9sZGVyXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLCBzZXQgdG8gJ2ZvbGRlcicuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCBzZXQgdG8gJ2J1aWxkSW4nLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUsIHNldCB0byAnUGFyZW50IGZvbGRlcicuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gQSBkZWZhdWx0IGZ1bmN0aW9uIHRlbXBsYXRlIGZvciBzY3JpcHRpbmcuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgc3VwcG9ydGVkIGRhdGEgdHlwZXMgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdFbGVtZW50cyAtIEEgbWV0aG9kIHRvIGRlZmluZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gZWxlbWVudHMuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIEBwYXJhbSB7QXBwIHwgdW5kZWZpbmVkfSBhcHAgLSBUaGUgYXBwbGljYXRpb24gaW5zdGFuY2UgKG9wdGlvbmFsKS5cclxuICogQHBhcmFtIHtURmlsZX0gZmlsZSAtIFRoZSBmaWxlIG9iamVjdCBmb3Igd2hpY2ggdGhlIHBhcmVudCBmb2xkZXIgaXMgZGV0ZXJtaW5lZC5cclxuICogQHBhcmFtIHtTY3JpcHRpbmdUb29sc30gdG9vbHMgLSBVdGlsaXR5IHRvb2xzIGZvciBzY3JpcHRpbmcuXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBuYW1lIG9mIHRoZSBwYXJlbnQgZm9sZGVyLCBvciBhbiBlbXB0eSBzdHJpbmcgaWYgbm8gcGFyZW50IGV4aXN0cy5cclxuICogXHJcbiAqIEBtZXRob2QgY29uZmlnVGFiXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG9wdGlvbkVMIC0gVGhlIEhUTUwgZWxlbWVudCBmb3IgdGhlIGNvbmZpZ3VyYXRpb24gdGFiLlxyXG4gKiBAcGFyYW0ge0Zyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3N9IHJ1bGUgLSBUaGUgcnVsZSBzZXR0aW5ncyBvYmplY3QuXHJcbiAqIEBwYXJhbSB7YW55fSB0aGF0IC0gQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgY29udGV4dC5cclxuICogQHBhcmFtIHthbnl9IHByZXZpZXdDb21wb25lbnQgLSBBIGNvbXBvbmVudCBmb3IgcHJldmlld2luZyBjaGFuZ2VzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluRm9sZGVyIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5pZCA9ICdmb2xkZXInO1xyXG4gICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgIHRoaXMubmFtZSA9ICdQYXJlbnQgZm9sZGVyJztcclxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmV0dXJucyB0aGUgcGFyZW50IGZvbGRlciBvZiB0aGUgZmlsZS4nO1xyXG4gICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgY29uc3QgaW5wdXQgPSB0b29scy5nZXRDdXJyZW50Q29udGVudCgpOyAvLyBHZXQgdGhlIGN1cnJlbnQgY29udGVudCBvZiBwcm9wZXJ0eVxcbiAgcmV0dXJuIGlucHV0OyAvLyBSZXR1cm4gdGhlIGlucHV0IHVuYWx0ZXJlZFxcbn07XCI7XHJcbiAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICB9XHJcbiAgXHJcbiAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcclxuICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XHJcbiAgICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcclxuICAgIGxldCByZXN1bHQgPSAnJztcclxuICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgIHJlc3VsdCA9IHBhcnRzW3BhcnRzLmxlbmd0aC0yXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICB9O1xyXG4gICAgXHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJ1aWx0LWluIHJ1bGUgdGhhdCByZXR1cm5zIHRoZSBwYXJlbnQgZm9sZGVyIG9mIGEgZmlsZSxcclxuICogY29tcGF0aWJsZSB3aXRoIHRoZSBcIkZvbGRlciBOb3Rlc1wiIGNvbnZlbnRpb24gaW4gT2JzaWRpYW4uXHJcbiAqXHJcbiAqIFRoaXMgcnVsZSBkZXRlcm1pbmVzIHRoZSBwYXJlbnQgZm9sZGVyIG5hbWUgZm9yIGEgZ2l2ZW4gZmlsZSwgdGFraW5nIGludG8gYWNjb3VudFxyXG4gKiB0aGUgc3BlY2lhbCBjYXNlIHdoZXJlIHRoZSBmaWxlIGlzIGEgZm9sZGVyIG5vdGUgKGkuZS4sIGl0cyBuYW1lIG1hdGNoZXMgaXRzIHBhcmVudCBmb2xkZXIpLlxyXG4gKiBJZiB0aGUgZmlsZSBpcyBsb2NhdGVkIGluIHRoZSByb290IGRpcmVjdG9yeSwgdGhlIHZhdWx0IG5hbWUgaXMgcmV0dXJuZWQgaW5zdGVhZC5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIGlzIGlkZW50aWZpZWQgYnkgdGhlIElEICdmb2xkZXJGb2xkZXJOb3RlcycuXHJcbiAqIC0gVGhlIHJ1bGUgdHlwZSBpcyAnYnVpbGRJbicuXHJcbiAqIC0gVGhlIGBmeGAgbWV0aG9kIHNob3VsZCBub3QgaGF2ZSBpdHMgc2lnbmF0dXJlIGNoYW5nZWQsIGFzIGl0IGlzIHVzZWQgYnkgdGhlIHJ1bGUgZW5naW5lLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiAvLyBGb3IgYSBmaWxlIGF0ICdQcm9qZWN0cy9Ob3Rlcy9Ob3Rlcy5tZCcgKHdoZXJlICdOb3RlcycgaXMgYSBmb2xkZXIgbm90ZSk6XHJcbiAqIC8vIFJldHVybnMgJ1Byb2plY3RzJ1xyXG4gKlxyXG4gKiAvLyBGb3IgYSBmaWxlIGF0ICdQcm9qZWN0cy9Ob3Rlcy9NZWV0aW5nLm1kJzpcclxuICogLy8gUmV0dXJucyAnTm90ZXMnXHJcbiAqXHJcbiAqIC8vIEZvciBhIGZpbGUgYXQgdGhlIHZhdWx0IHJvb3Q6XHJcbiAqIC8vIFJldHVybnMgdGhlIHZhdWx0IG5hbWVcclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBPYnNpZGlhbiBBcHAgaW5zdGFuY2UgKG1heSBiZSB1bmRlZmluZWQpLlxyXG4gKiBAcGFyYW0gZmlsZSAtIFRoZSB0YXJnZXQgVEZpbGUgZm9yIHdoaWNoIHRoZSBwYXJlbnQgZm9sZGVyIGlzIGRldGVybWluZWQuXHJcbiAqIEBwYXJhbSB0b29scyAtIFV0aWxpdHkgdG9vbHMsIGluY2x1ZGluZyBhY2Nlc3MgdG8gdGhlIHZhdWx0LlxyXG4gKiBAcmV0dXJucyBUaGUgbmFtZSBvZiB0aGUgcGFyZW50IGZvbGRlciwgb3IgdGhlIHZhdWx0IG5hbWUgaWYgdGhlIGZpbGUgaXMgaW4gdGhlIHJvb3QuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5Gb2xkZXJGb2xkZXJOb3RlcyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgIHN1cGVyKCk7XHJcbiAgICAgIHRoaXMuaWQgPSAnZm9sZGVyRm9sZGVyTm90ZXMnO1xyXG4gICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICB0aGlzLm5hbWUgPSAnUGFyZW50IEZvbGRlciAoY29tcGxpZXMgd2l0aCBcImZvbGRlciBub3Rlc1wiKSc7XHJcbiAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmV0dXJucyB0aGUgcGFyZW50IGZvbGRlciBvZiB0aGUgZmlsZSBjb21wYXRpYmxlIHdpdGggRm9sZGVyIE5vdGVzLic7XHJcbiAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIC8vIGFjcXVpcmUgZmlsZSBwYXRoXFxuICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO2NvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICBsZXQgaW5kZXggPSBwYXJ0cy5sZW5ndGgtMjsgLy8gaW5kZXggb2YgcGFyZW50IGZvbGRlclxcbiAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0yXT09PWZpbGUuYmFzZW5hbWUpIHtcXG4gICAgICBpbmRleC0tOyAvLyBmb2xkZXIgbm90ZSBwYXJlbnQgaXMgdGhlIGNoaWxkXFxuICB9XFxuICBpZiAoaW5kZXggPj0gMCkge1xcbiAgICByZXR1cm4gcGFydHNbaW5kZXhdOyAvLyBmaWxlIGluIGZvbGRlclxcbiAgfSBlbHNlIHtcXG4gICAgcmV0dXJuIHRvb2xzLmFwcD8udmF1bHQ/LmdldE5hbWUoKSB8fCAnVmF1bHQnOyAvLyBmaWxlIGluIHJvb3QgPSB2YXVsdFxcbiAgfVxcbn1cIjtcclxuICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO2NvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgIGxldCBpbmRleCA9IHBhcnRzLmxlbmd0aC0yOyAvLyBpbmRleCBvZiBwYXJlbnQgZm9sZGVyXHJcbiAgICAgIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMl09PT1maWxlLmJhc2VuYW1lKSB7XHJcbiAgICAgICAgICBpbmRleC0tOyAvLyBmb2xkZXIgbm90ZSBwYXJlbnQgaXMgdGhlIGNoaWxkXHJcbiAgICAgIH1cclxuICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICByZXR1cm4gcGFydHNbaW5kZXhdOyAvLyBmaWxlIGluIGZvbGRlclxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0b29scy5hcHA/LnZhdWx0Py5nZXROYW1lKCkgfHwgJ1ZhdWx0JzsgLy8gZmlsZSBpbiByb290ID0gdmF1bHRcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ1RhYiAob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBBIGJ1aWx0LWluIHJ1bGUgdGhhdCBleHRyYWN0cyBhbGwgZm9sZGVycyBmcm9tIHRoZSBwYXRoIG9mIGEgZ2l2ZW4gZmlsZSBhbmQgcmV0dXJucyB0aGVtIGFzIGEgbGlzdC5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhpcyBydWxlIGlzIGludGVuZGVkIGZvciB1c2Ugd2l0aGluIHRoZSBGb2xkZXItdG8tVGFncyBPYnNpZGlhbiBwbHVnaW4uXHJcbiAqIEl0IHByb3ZpZGVzIGEgd2F5IHRvIHJldHJpZXZlIGFsbCBmb2xkZXIgbmFtZXMgKGFzIGEgc3RyaW5nIGFycmF5KSB0aGF0IGEgZmlsZSBpcyBzdG9yZWQgaW4sXHJcbiAqIGV4Y2x1ZGluZyB0aGUgZmlsZSBuYW1lIGl0c2VsZi5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiAvLyBJZiBmaWxlLnBhdGggaXMgJ2ZvbGRlcjEvZm9sZGVyMi9teWZpbGUubWQnLCB0aGUgcmVzdWx0IHdpbGwgYmUgWydmb2xkZXIxJywgJ2ZvbGRlcjInXVxyXG4gKlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlICgnZm9sZGVycycpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoJ2J1aWxkSW4nKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHJ1bGUgZG9lcy5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2YgdGhlIHJ1bGUgKGVtcHR5IGZvciBidWlsdC1pbikuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgdHlwZXMgdGhpcyBydWxlIGFwcGxpZXMgdG8gKGUuZy4sICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0JykuXHJcbiAqIEBwcm9wZXJ0eSB7YW55W119IGNvbmZpZ0VsZW1lbnRzIC0gVGhlIGNvbmZpZ3VyYXRpb24gZWxlbWVudHMgZm9yIHRoaXMgcnVsZS5cclxuICpcclxuICogQG1ldGhvZCBmeFxyXG4gKiBSZXR1cm5zIGFsbCBmb2xkZXJzIHRoZSBmaWxlIGlzIHN0b3JlZCBpbiBhcyBhIGxpc3QuXHJcbiAqIEBwYXJhbSBhcHAgLSBUaGUgT2JzaWRpYW4gYXBwIGluc3RhbmNlIChvcHRpb25hbCkuXHJcbiAqIEBwYXJhbSBmaWxlIC0gVGhlIGZpbGUgd2hvc2UgZm9sZGVycyBhcmUgdG8gYmUgZXh0cmFjdGVkLlxyXG4gKiBAcGFyYW0gdG9vbHMgLSBTY3JpcHRpbmcgdG9vbHMgcHJvdmlkZWQgYnkgdGhlIHBsdWdpbi5cclxuICogQHJldHVybnMge3N0cmluZ1tdfSBBbiBhcnJheSBvZiBmb2xkZXIgbmFtZXMuXHJcbiAqXHJcbiAqIEBtZXRob2QgY29uZmlnVGFiXHJcbiAqIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGZvciB0aGUgcnVsZS5cclxuICogQHBhcmFtIG9wdGlvbkVMIC0gVGhlIEhUTUwgZWxlbWVudCBmb3IgdGhlIGNvbmZpZ3VyYXRpb24gdGFiLlxyXG4gKiBAcGFyYW0gcnVsZSAtIFRoZSBydWxlIHNldHRpbmdzLlxyXG4gKiBAcGFyYW0gdGhhdCAtIFRoZSBjb250ZXh0IG9iamVjdC5cclxuICogQHBhcmFtIHByZXZpZXdDb21wb25lbnQgLSBUaGUgcHJldmlldyBjb21wb25lbnQgZm9yIHRoZSBjb25maWd1cmF0aW9uIFVJLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluRm9sZGVycyBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgIHN1cGVyKCk7XHJcbiAgICAgIHRoaXMuaWQgPSAnZm9sZGVycyc7XHJcbiAgICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICAgIHRoaXMubmFtZSA9ICdBbGwgZm9sZGVycyBvZiB0aGUgZmlsZSBhcyBhIGxpc3QnO1xyXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1JldHVybnMgYWxsIGZvbGRlcnMgdGhlIGZpbGUgaXMgc3RvcmVkIGluIGFzIGEgbGlzdC4nO1xyXG4gICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxcbiAgY29uc3QgcGF0aCA9IGZpbGUucGF0aDtcXG4gIGNvbnN0IHJlc3VsdCA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIHJlc3VsdC5wb3AoKTsgLy8gcmVtb3ZlIHRoZSBmaWxlIG5hbWVcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICB0aGlzLnR5cGUgPSBbJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAvLyBhY3F1aXJlIGZpbGUgcGF0aFxyXG4gICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgIHJlc3VsdC5wb3AoKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG4gICAgXHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBydWxlIHRoYXQgZ2VuZXJhdGVzIHRoZSBmdWxsIHBhdGggb2YgYSBmaWxlLCBpbmNsdWRpbmcgaXRzIGZpbGVuYW1lLlxyXG4gKiBUaGlzIHJ1bGUgaXMgYnVpbHQtaW4gYW5kIGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBjb21wbGV0ZSBmaWxlIHBhdGggYXMgYSBzdHJpbmcuXHJcbiAqXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICpcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgYGZ4YCBmdW5jdGlvbiBzcGxpdHMgdGhlIGZpbGUgcGF0aCwgcmVtb3ZlcyB0aGUgbGFzdCBwYXJ0IChhc3N1bWVkIHRvIGJlIHRoZSBmaWxlbmFtZSksXHJcbiAqICAgYXBwZW5kcyB0aGUgZmlsZSdzIGJhc2VuYW1lLCBhbmQgdGhlbiBqb2lucyB0aGUgcGFydHMgYmFjayB0b2dldGhlciB0byBmb3JtIHRoZSBmdWxsIHBhdGguXHJcbiAqIC0gVGhpcyBydWxlIGNhbiBiZSB1c2VkIGZvciBtdWx0aXBsZSBwcm9wZXJ0eSB0eXBlczogYHRleHRgLCBgdGFnc2AsIGBhbGlhc2VzYCwgYW5kIGBtdWx0aXRleHRgLlxyXG4gKlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlIChgJ2Z1bGxQYXRoJ2ApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoYCdidWlsZEluJ2ApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUgKGAnRnVsbCBwYXRoLCBmaWxlbmFtZSdgKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIGZ1bmN0aW9uYWxpdHkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzb3VyY2UgLSBUaGUgc291cmNlIGNvZGUgb2YgdGhlIHJ1bGUncyBmdW5jdGlvbiBhcyBhIHN0cmluZy5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSBwcm9wZXJ0eSB0eXBlcyB0aGUgcnVsZSBjYW4gYmUgdXNlZCBmb3IuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIGZ1bmN0aW9uIHRoYXQgaW1wbGVtZW50cyB0aGUgcnVsZSdzIGxvZ2ljLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBBIHBsYWNlaG9sZGVyIGZ1bmN0aW9uIGZvciBjb25maWd1cmluZyB0aGUgcnVsZSBpbiB0aGUgVUkuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEV4YW1wbGUgdXNhZ2Ugb2YgdGhlIGBmeGAgZnVuY3Rpb246XHJcbiAqIGNvbnN0IGZ1bGxQYXRoID0gcnVsZS5meChhcHAsIGZpbGUsIHRvb2xzKTtcclxuICogY29uc29sZS5sb2coZnVsbFBhdGgpOyAvLyBPdXRwdXRzIHRoZSBmdWxsIHBhdGggb2YgdGhlIGZpbGUsIGluY2x1ZGluZyBpdHMgZmlsZW5hbWUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5GdWxsUGF0aCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2Z1bGxQYXRoJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGdWxsIHBhdGgsIGZpbGVuYW1lJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1JldHVybnMgdGhlIGZ1bGwgcGF0aCBvZiB0aGUgZmlsZSwgaW5jbHVkaW5nIHRoZSBmaWxlbmFtZS4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgcGFydHMucG9wKCk7XFxuICBwYXJ0cy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xcbiAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcXG59O1wiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcblxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICBwYXJ0cy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbmZpZ1RhYihvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6IGFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICB9O1xyXG5cclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJ1aWx0LWluIHJ1bGUgdGhhdCByZXR1cm5zIHRoZSBmdWxsIHBhdGggb2YgYSBmaWxlLCBpbmNsdWRpbmcgaXRzIGZpbGVuYW1lIGFuZCBleHRlbnNpb24uXHJcbiAqIFxyXG4gKiBUaGlzIHJ1bGUgaXMgcGFydCBvZiB0aGUgXCJmb2xkZXItdG8tdGFncy1wbHVnaW5cIiBhbmQgaXMgdXNlZCB0byBnZW5lcmF0ZSBvciBtYW5pcHVsYXRlIG1ldGFkYXRhXHJcbiAqIGJhc2VkIG9uIHRoZSBmdWxsIHBhdGggb2YgYSBmaWxlLiBJdCBleHRlbmRzIHRoZSBgUnVsZVByb3RvdHlwZWAgY2xhc3MgYW5kIHByb3ZpZGVzIGNvbmZpZ3VyYXRpb25cclxuICogb3B0aW9ucywgYSBkZXNjcmlwdGlvbiwgYW5kIGEgZnVuY3Rpb24gdG8gZXhlY3V0ZSB0aGUgcnVsZSBsb2dpYy5cclxuICogXHJcbiAqIEBjbGFzcyBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0XHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhpcyBydWxlIChgZnVsbFBhdGhFeHRgKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUgKGBidWlsZEluYCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZSAoYEZ1bGwgcGF0aCwgZmlsZW5hbWUgYW5kIGV4dGVuc2lvbmApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgZnVuY3Rpb25hbGl0eS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgcnVsZSdzIGxvZ2ljIGFzIGEgc3RyaW5nLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIHR5cGVzIG9mIG1ldGFkYXRhIHRoaXMgcnVsZSBjYW4gYmUgYXBwbGllZCB0byAoYHRleHRgLCBgdGFnc2AsIGBhbGlhc2VzYCwgYG11bHRpdGV4dGApLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIFRoZSBmdW5jdGlvbiB0aGF0IGltcGxlbWVudHMgdGhlIHJ1bGUgbG9naWMsIHJldHVybmluZyB0aGUgZnVsbCBwYXRoIG9mIHRoZSBmaWxlLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBBIGZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgY29uZmlndXJhdGlvbiB0YWIgZm9yIHRoaXMgcnVsZS5cclxuICogXHJcbiAqIEBtZXRob2QgZGVmYXVsdENvbmZpZ0VsZW1lbnRzIC0gSW5oZXJpdGVkIGZyb20gYFJ1bGVQcm90b3R5cGVgLCB1c2VkIHRvIGRlZmluZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gZWxlbWVudHMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5GdWxsUGF0aEV4dCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2Z1bGxQYXRoRXh0JztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGdWxsIHBhdGgsIGZpbGVuYW1lIGFuZCBleHRlbnNpb24nO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmV0dXJucyB0aGUgZnVsbCBwYXRoIG9mIHRoZSBmaWxlLCBpbmNsdWRpbmcgaXRzIGZpbGVuYW1lIGFuZCBleHRlbnNpb24uJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICByZXR1cm4gYCR7ZmlsZS5wYXRofWA7XFxufTtcIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ4KGFwcDogQXBwLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7XHJcbiAgICAgICAgcmV0dXJuIGAke2ZpbGUucGF0aH1gO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OiBhbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gICAgICAgIC8vIEZvciBleGFtcGxlLCB5b3UgY2FuIGNyZWF0ZSBzZXR0aW5ncyBmb3IgdGhlIHJ1bGUgaGVyZVxyXG4gICAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBydWxlIGZvciBnZW5lcmF0aW5nIGEgZnVsbCBwYXRoIHdpdGggZXh0ZW5zaW9ucyBjb21wYXRpYmxlIHdpdGggXCJmb2xkZXIgbm90ZXNcIi5cclxuICogVGhpcyBydWxlIG1vZGlmaWVzIHRoZSBmaWxlIHBhdGggdG8gZW5zdXJlIGNvbXBhdGliaWxpdHkgd2l0aCBmb2xkZXIgbm90ZXMgYnkgYWRqdXN0aW5nXHJcbiAqIHRoZSBwYXRoIHN0cnVjdHVyZSBiYXNlZCBvbiB0aGUgZmlsZSdzIGJhc2VuYW1lIGFuZCBwYXJlbnQgZm9sZGVyLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgYHNvdXJjZWAgcHJvcGVydHkgY29udGFpbnMgYSBzdHJpbmdpZmllZCBmdW5jdGlvbiB0aGF0IHBlcmZvcm1zIHRoZSBwYXRoIHRyYW5zZm9ybWF0aW9uLlxyXG4gKiAtIFRoZSBgZnhgIG1ldGhvZCBpbXBsZW1lbnRzIHRoZSBzYW1lIGxvZ2ljIGFzIHRoZSBgc291cmNlYCBmdW5jdGlvbiBidXQgaXMgZGlyZWN0bHkgZXhlY3V0YWJsZS5cclxuICogLSBUaGlzIHJ1bGUgaXMgY2F0ZWdvcml6ZWQgYXMgYSBidWlsdC1pbiBydWxlIChgcnVsZVR5cGU6ICdidWlsZEluJ2ApLlxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlIChgZnVsbFBhdGhFeHRGb2xkZXJOb3Rlc2ApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUeXBlIG9mIHRoZSBydWxlIChgYnVpbGRJbmApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIERpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gRGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBwdXJwb3NlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gU3RyaW5naWZpZWQgZnVuY3Rpb24gZGVmaW5pbmcgdGhlIHJ1bGUncyBsb2dpYy5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIEFwcGxpY2FibGUgdHlwZXMgZm9yIHRoZSBydWxlIChgWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXWApLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIEZ1bmN0aW9uIGltcGxlbWVudGluZyB0aGUgcnVsZSdzIGxvZ2ljLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBPcHRpb25hbCBjb25maWd1cmF0aW9uIHRhYiBsb2dpYyBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIEBwYXJhbSB7QXBwIHwgdW5kZWZpbmVkfSBhcHAgLSBUaGUgYXBwbGljYXRpb24gaW5zdGFuY2UgKG9wdGlvbmFsKS5cclxuICogQHBhcmFtIHtURmlsZX0gZmlsZSAtIFRoZSBmaWxlIG9iamVjdCBjb250YWluaW5nIHBhdGggYW5kIGJhc2VuYW1lIGluZm9ybWF0aW9uLlxyXG4gKiBAcGFyYW0ge1NjcmlwdGluZ1Rvb2xzfSB0b29scyAtIFV0aWxpdHkgdG9vbHMgZm9yIHNjcmlwdGluZy5cclxuICogQHJldHVybnMge3N0cmluZ30gLSBUaGUgdHJhbnNmb3JtZWQgZmlsZSBwYXRoLlxyXG4gKiBcclxuICogQG1ldGhvZCBjb25maWdUYWJcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9uRUwgLSBUaGUgSFRNTCBlbGVtZW50IGZvciB0aGUgY29uZmlndXJhdGlvbiB0YWIuXHJcbiAqIEBwYXJhbSB7RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5nc30gcnVsZSAtIFRoZSBydWxlIHNldHRpbmdzIG9iamVjdC5cclxuICogQHBhcmFtIHthbnl9IHRoYXQgLSBSZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgY29udGV4dC5cclxuICogQHBhcmFtIHthbnl9IHByZXZpZXdDb21wb25lbnQgLSBDb21wb25lbnQgZm9yIHByZXZpZXdpbmcgY2hhbmdlcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0Rm9sZGVyTm90ZXMgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdmdWxsUGF0aEV4dEZvbGRlck5vdGVzJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGdWxsIFBhdGggd2l0aCBFeHRlbnNpb24gKGNvbXBseSB3aXRoIFwiZm9sZGVyIG5vdGVzXCIpJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1BhdGggd2l0aCBFeHRlbnNpb25zIGNvbXBhdGlibGUgd2l0aCBmb2xkZXIgbm90ZXMuJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcXG4gIHBhcnRzLnBvcCgpO1xcbiAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7XFxuICBwYXJ0cy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xcbiAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcXG59O1wiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgZmlsZSBuYW1lXHJcbiAgICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBwYXJlbnQgZm9sZGVyIGlmIHNhbWUgbmFtZSBhcyB0aGUgZmlsZVxyXG4gICAgICAgIHBhcnRzLnB1c2goZmlsZS5uYW1lKTsgLy8gYWRkIHRoZSBmaWxlIG5hbWUgYmFja1xyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlnVGFiIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gICAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIEEgYnVpbHQtaW4gcnVsZSBmb3IgZ2VuZXJhdGluZyBhIGZ1bGwgcGF0aCBjb21wYXRpYmxlIHdpdGggXCJmb2xkZXIgbm90ZXNcIiBwbHVnaW4uXHJcbiAqIFxyXG4gKiBUaGlzIHJ1bGUgcHJvY2Vzc2VzIGEgZmlsZSdzIHBhdGggc3VjaCB0aGF0OlxyXG4gKiAtIFRoZSBmaWxlIG5hbWUgaXMgcmVtb3ZlZCBmcm9tIHRoZSBwYXRoLlxyXG4gKiAtIElmIHRoZSBwYXJlbnQgZm9sZGVyIGhhcyB0aGUgc2FtZSBuYW1lIGFzIHRoZSBmaWxlLCBpdCBpcyBhbHNvIHJlbW92ZWQuXHJcbiAqIC0gVGhlIGZpbGUncyBiYXNlIG5hbWUgaXMgYXBwZW5kZWQgdG8gdGhlIHJlc3VsdGluZyBwYXRoLlxyXG4gKiBcclxuICogVGhlIHJlc3VsdGluZyBwYXRoIGlzIHN1aXRhYmxlIGZvciB1c2UgY2FzZXMgd2hlcmUgZm9sZGVyIG5vdGVzIGFyZSB1c2VkLCBlbnN1cmluZyBjb21wYXRpYmlsaXR5LlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgYGZ4YCBtZXRob2QgaW1wbGVtZW50cyB0aGUgY29yZSBsb2dpYyBmb3IgcGF0aCB0cmFuc2Zvcm1hdGlvbi5cclxuICogLSBUaGUgYGNvbmZpZ1RhYmAgbWV0aG9kIGNhbiBiZSBleHRlbmRlZCB0byBwcm92aWRlIGEgY29uZmlndXJhdGlvbiBVSS5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEZvciBhIGZpbGUgYXQgXCJmb2xkZXIxL2ZvbGRlcjIvbm90ZS9ub3RlLm1kXCJcclxuICogLy8gVGhlIHJlc3VsdGluZyBwYXRoIHdpbGwgYmUgXCJmb2xkZXIxL2ZvbGRlcjIvbm90ZVwiXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFR5cGUgb2YgdGhlIHJ1bGUsIHNldCB0byAnYnVpbGRJbicuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gSHVtYW4tcmVhZGFibGUgbmFtZSBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIERlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgcHVycG9zZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFN0cmluZ2lmaWVkIGZ1bmN0aW9uIHNvdXJjZSBmb3Igc2NyaXB0aW5nLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gU3VwcG9ydGVkIHR5cGVzIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHthbnlbXX0gY29uZmlnRWxlbWVudHMgLSBDb25maWd1cmF0aW9uIGVsZW1lbnRzIGZvciB0aGUgcnVsZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJbkZ1bGxQYXRoRm9sZGVyTm90ZXMgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdmdWxsUGF0aEZvbGRlck5vdGVzJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGdWxsIFBhdGggKGNvbXBseSB3aXRoIFwiZm9sZGVyIG5vdGVzXCIpJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1BhdGggY29tcGF0aWJsZSBjb21wYXRpYmxlIHdpdGggZm9sZGVyIG5vdGVzLic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICBwYXJ0cy5wb3AoKTtcXG4gIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gPT09IGZpbGUuYmFzZW5hbWUpIHBhcnRzLnBvcCgpO1xcbiAgcGFydHMucHVzaChmaWxlLmJhc2VuYW1lKTtcXG4gIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XFxufTtcIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIGZpbGUgbmFtZVxyXG4gICAgICAgIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gPT09IGZpbGUuYmFzZW5hbWUpIHBhcnRzLnBvcCgpOyAvLyByZW1vdmUgcGFyZW50IGZvbGRlciBpZiBzYW1lIG5hbWUgYXMgdGhlIGZpbGVcclxuICAgICAgICBwYXJ0cy5wdXNoKGZpbGUuYmFzZW5hbWUpOyAvLyBhZGQgdGhlIGZpbGUgbmFtZSBiYWNrXHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJy8nKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG4gICAgXHJcbn0iLCAiICBpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCBQcm9wZXJ0eVR5cGVJbmZvIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgYnVpbHQtaW4gcnVsZSBmb3IgcmV0cmlldmluZyBhIHByb3BlcnR5IHZhbHVlIGZyb20gdGhlIGZyb250bWF0dGVyIG9mIGEgZmlsZS5cclxuICogXHJcbiAqIFRoaXMgcnVsZSBhbGxvd3MgdXNlcnMgdG8gc2VsZWN0IGEgcHJvcGVydHkgKHN1Y2ggYXMgdGV4dCwgdGFncywgYWxpYXNlcywgb3IgbXVsdGl0ZXh0KSBhbmQgcmV0cmlldmUgaXRzIHZhbHVlXHJcbiAqIGZyb20gdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBmaWxlJ3MgZnJvbnRtYXR0ZXIuIFRoZSBydWxlIHByb3ZpZGVzIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3Igc2VsZWN0aW5nIHRoZSBwcm9wZXJ0eSxcclxuICogYW5kIGV4cG9zZXMgYSBmdW5jdGlvbiAoYGZ4YCkgdGhhdCBwZXJmb3JtcyB0aGUgcmV0cmlldmFsLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgcnVsZSBpcyBpZGVudGlmaWVkIGJ5IHRoZSBJRCAnZ2V0UHJvcGVydHknIGFuZCBpcyBjYXRlZ29yaXplZCBhcyBhIGJ1aWx0LWluIHJ1bGUuXHJcbiAqIC0gVGhlIGNvbmZpZ3VyYXRpb24gdGFiIGFsbG93cyB1c2VycyB0byBzZWxlY3Qgd2hpY2ggcHJvcGVydHkgdG8gcmV0cmlldmUuXHJcbiAqIC0gVGhlIGBmeGAgbWV0aG9kIGlzIHRoZSBtYWluIGxvZ2ljIGZvciBleHRyYWN0aW5nIHRoZSBwcm9wZXJ0eSB2YWx1ZS5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIFVzYWdlIHdpdGhpbiB0aGUgcGx1Z2luJ3MgcnVsZSBzeXN0ZW06XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZUJ1aWxkSW5HZXRQcm9wZXJ0eSgpO1xyXG4gKiBjb25zdCB2YWx1ZSA9IHJ1bGUuZngoYXBwLCBmaWxlLCB0b29scyk7XHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlICgnZ2V0UHJvcGVydHknKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUgKCdidWlsZEluJykuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIHB1cnBvc2UuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgdHlwZXMgb2YgcHJvcGVydGllcyB0aGlzIHJ1bGUgY2FuIGhhbmRsZS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCByZXRyaWV2ZXMgdGhlIHByb3BlcnR5IHZhbHVlLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBUaGUgZnVuY3Rpb24gdGhhdCByZW5kZXJzIHRoZSBjb25maWd1cmF0aW9uIFVJIGZvciB0aGUgcnVsZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJbkdldFByb3BlcnR5IGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5pZCA9ICdnZXRQcm9wZXJ0eSc7XHJcbiAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgdGhpcy5uYW1lID0gJ0dldCBwcm9wZXJ0eSc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0dldHMgYSBwcm9wZXJ0eSBmcm9tIHNlbGVjdGVkIHByb3BlcnR5Lic7XHJcbiAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24oYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhIFxcbiBjb25zdCBwcm9wZXJ0eUlkID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsJ2lucHV0UHJvcGVydHknKTsgXFxuIGlmIChwcm9wZXJ0eUlkID09PSB1bmRlZmluZWQgfHwgcHJvcGVydHlJZCA9PT0gJycpIHsgXFxuIHJldHVybiAnUHJvcGVydHkgbm90IHNldCc7IFxcbiB9IFxcbiBjb25zdCByZXN1bHQgPSB0b29scy5nZXRGcm9udG1hdHRlclByb3BlcnR5KHByb3BlcnR5SWQpOyBcXG4gaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7IFxcbiByZXR1cm4gJ1Byb3BlcnR5IG5vdCBmb3VuZCc7IFxcbiB9IFxcbiByZXR1cm4gcmVzdWx0OyBcXG4gfVwiO1xyXG4gICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgIGNvbnN0IHByb3BlcnR5SWQgPSB0b29scy5nZXRPcHRpb25Db25maWcodG9vbHMuZ2V0UnVsZSgpPy5pZCwnaW5wdXRQcm9wZXJ0eScpO1xyXG4gICAgaWYgKHByb3BlcnR5SWQgPT09IHVuZGVmaW5lZCB8fCBwcm9wZXJ0eUlkID09PSAnJykge1xyXG4gICAgICByZXR1cm4gJ1Byb3BlcnR5IG5vdCBzZXQnO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzdWx0ID0gdG9vbHMuZ2V0RnJvbnRtYXR0ZXJQcm9wZXJ0eShwcm9wZXJ0eUlkKTtcclxuICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICByZXR1cm4gJ1Byb3BlcnR5IG5vdCBmb3VuZCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgY29uZmlnVGFiIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgICAvLyBDcmVhdGUgYSBzZXR0aW5nIGZvciB0aGUgY29uc3RhbnQgdmFsdWVcclxuICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnRGVmYXVsdHMocnVsZS5pZCwge1xyXG4gICAgICAgIGlucHV0UHJvcGVydHk6ICcnLFxyXG4gICAgfSlcclxuICAgIGxldCBpbnB1dFByb3BlcnRpZXNEcm9wZG93bjphbnk7XHJcbiAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAuc2V0TmFtZSgnSW5wdXQgUHJvcGVydHknKVxyXG4gICAgICAgIC5zZXREZXNjKCdTZWxlY3QgYSBwcm9wZXJ0eSBhcyBpbnB1dCcpXHJcbiAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcclxuICAgICAgICAgICAgaW5wdXRQcm9wZXJ0aWVzRHJvcGRvd24gPSBkcm9wZG93bjtcclxuICAgICAgICAgICAgZHJvcGRvd25cclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdpbnB1dFByb3BlcnR5JykgfHwgJycpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdpbnB1dFByb3BlcnR5JywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICBPYmplY3Qua2V5cyh0aGF0Lmtub3duUHJvcGVydGllcykuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgICAgLy9pbnB1dFByb3BlcnRpZXNEcm9wZG93bi5hZGRPcHRpb24oaXRlbVsxXS5uYW1lLGl0ZW1bMV0ubmFtZSk7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoYXQua25vd25Qcm9wZXJ0aWVzW2tleV0gYXMgUHJvcGVydHlUeXBlSW5mbztcclxuICAgICAgICBpbnB1dFByb3BlcnRpZXNEcm9wZG93bi5hZGRPcHRpb24oaXRlbS5uYW1lLCBpdGVtLm5hbWUpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5Jc1Jvb3QgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdpc1Jvb3QnO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ0ZpbGUgaW4gUm9vdCBmb2xkZXInO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ2hlY2sgaWYgdGhlIGZpbGUgaXMgaW4gdGhlIHJvb3QgZm9sZGVyLic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XFxuICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xcbn07XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWydjaGVja2JveCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICByZXR1cm4gcGFydHMubGVuZ3RoID09PSAxO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ1RhYiAob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgYnVpbHQtaW4gcnVsZSBmb3IgY3JlYXRpbmcgYSBsaW5rIHRvIGEgZmlsZSBpbiB0aGUgY3VycmVudCB2YXVsdC5cclxuICogVGhpcyBydWxlIGNhbiBiZSBjb25maWd1cmVkIHRvIGluY2x1ZGUgb3IgZXhjbHVkZSB0aGUgZmlsZSBleHRlbnNpb24gaW4gdGhlIGdlbmVyYXRlZCBsaW5rLlxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIC0gVGhlIHJ1bGUgZ2VuZXJhdGVzIGEgbGluayBpbiB0aGUgZm9ybWF0IGBbW3BhdGgvdG8vZmlsZXxmaWxlTmFtZV1dYC5cclxuICogLSBUaGUgYGFkZEV4dGVuc2lvbmAgb3B0aW9uIGRldGVybWluZXMgd2hldGhlciB0aGUgZmlsZSBleHRlbnNpb24gaXMgaW5jbHVkZWQgaW4gdGhlIGxpbmsuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEV4YW1wbGUgb3V0cHV0IHdpdGggYGFkZEV4dGVuc2lvbmAgc2V0IHRvIHRydWU6XHJcbiAqIFtbcGF0aC90by9maWxlLm1kfGZpbGVdXVxyXG4gKlxyXG4gKiAvLyBFeGFtcGxlIG91dHB1dCB3aXRoIGBhZGRFeHRlbnNpb25gIHNldCB0byBmYWxzZTpcclxuICogW1twYXRoL3RvL2ZpbGV8ZmlsZV1dXHJcbiAqXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUgKGBsaW5rVG9GaWxlYCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlIChgYnVpbGRJbmApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUgKGBDcmVhdGUgbGluayB0byBmaWxlYCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBydWxlJ3MgbWFpbiBmdW5jdGlvbi5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBjb250ZW50IHRoaXMgcnVsZSBhcHBsaWVzIHRvIChgdGV4dGAsIGB0YWdzYCwgYGFsaWFzZXNgLCBgbXVsdGl0ZXh0YCkuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIG1haW4gZnVuY3Rpb24gdGhhdCBnZW5lcmF0ZXMgdGhlIGxpbmsgdG8gdGhlIGZpbGUuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGNvbmZpZ1RhYiAtIFRoZSBjb25maWd1cmF0aW9uIFVJIGZvciB0aGUgcnVsZSwgYWxsb3dpbmcgdXNlcnMgdG8gdG9nZ2xlIHRoZSBgYWRkRXh0ZW5zaW9uYCBvcHRpb24uXHJcbiAqXHJcbiAqIEBtZXRob2QgZGVmYXVsdENvbmZpZ0VsZW1lbnRzXHJcbiAqIFJldHVybnMgdGhlIGRlZmF1bHQgY29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7QXBwfSBhcHAgLSBUaGUgT2JzaWRpYW4gYXBwbGljYXRpb24gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSB7VEZpbGV9IGZpbGUgLSBUaGUgZmlsZSBmb3Igd2hpY2ggdGhlIGxpbmsgaXMgYmVpbmcgZ2VuZXJhdGVkLlxyXG4gKiBAcGFyYW0ge1NjcmlwdGluZ1Rvb2xzfSB0b29scyAtIFV0aWxpdHkgdG9vbHMgZm9yIHNjcmlwdGluZyBhbmQgcnVsZSBtYW5hZ2VtZW50LlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluTGlua1RvRmlsZSBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ2xpbmtUb0ZpbGUnO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ0NyZWF0ZSBsaW5rIHRvIGZpbGUnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ3JlYXRlIGEgbGluayB0byB0aGUgZmlsZSBpbiB0aGUgY3VycmVudCB2YXVsdC4gQ2FuIGJlIGNvbmZpZ3VyZWQgdG8gaW5jbHVkZSB0aGUgZmlsZSBleHRlbnNpb24uJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgY29uc3QgcnVsZSA9IHRvb2xzLmdldFJ1bGUoKTtcXG4gIGlmICghcnVsZSkgcmV0dXJuIHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7XFxuICBjb25zdCBhZGRFeHRlbnNpb24gPSB0b29scy5nZXRPcHRpb25Db25maWcocnVsZS5pZCwnYWRkRXh0ZW5zaW9uJykgXFxuICBwYXJ0cy5wb3AoKTtcXG4gIGlmIChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0gPT09IGZpbGUuYmFzZW5hbWUpIHBhcnRzLnBvcCgpO1xcbiAgbGV0IGZpbGVOYW1lID0gYWRkRXh0ZW5zaW9uPyBmaWxlLmJhc2VuYW1lICsgJy4nICsgZmlsZS5leHRlbnNpb24gOiBmaWxlLmJhc2VuYW1lOyBcXG4gIHJldHVybiBgW1ske3BhcnRzLmpvaW4oJy8nKX0vJHtmaWxlTmFtZX18JHtmaWxlLmJhc2VuYW1lfV1dYDtcXG59O1wiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBmeCAoYXBwOiBBcHAsIGZpbGU6VEZpbGUsIHRvb2xzOlNjcmlwdGluZ1Rvb2xzKXtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0b29scy5nZXRSdWxlKCk7XHJcbiAgICAgICAgaWYgKCFydWxlKSByZXR1cm4gdG9vbHMuZ2V0Q3VycmVudENvbnRlbnQoKTtcclxuICAgICAgICBjb25zdCBhZGRFeHRlbnNpb24gPSB0b29scy5nZXRPcHRpb25Db25maWcocnVsZS5pZCwnYWRkRXh0ZW5zaW9uJykgXHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7XHJcbiAgICAgICAgbGV0IGZpbGVOYW1lID0gYWRkRXh0ZW5zaW9uPyBmaWxlLmJhc2VuYW1lICsgJy4nICsgZmlsZS5leHRlbnNpb24gOiBmaWxlLmJhc2VuYW1lOyBcclxuICAgICAgICByZXR1cm4gYFtbJHtwYXJ0cy5qb2luKCcvJyl9LyR7ZmlsZU5hbWV9fCR7ZmlsZS5iYXNlbmFtZX1dXWA7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgICAgIGFkZEV4dGVuc2lvbjogdHJ1ZVxyXG4gICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgZmlsZSBleHRlbnNpb24nKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQWRkIGZpbGUgZXh0ZW5zaW9uIHRvIHBhdGhuYW1lJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2FkZEV4dGVuc2lvbicpIHx8IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ2FkZEV4dGVuc2lvbicsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG4vKipcclxuICogQSBydWxlIHRoYXQgZXh0cmFjdHMgdGhlIGZpbGUgbmFtZSB3aXRob3V0IGl0cyBleHRlbnNpb24uXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgcnVsZSBpcyBpbnRlbmRlZCBmb3IgdXNlIHdpdGhpbiB0aGUgRm9sZGVyIHRvIFRhZ3MgT2JzaWRpYW4gcGx1Z2luLlxyXG4gKiBJdCBwcm92aWRlcyBhIHdheSB0byByZXRyaWV2ZSB0aGUgYmFzZSBuYW1lIG9mIGEgZmlsZSwgZXhjbHVkaW5nIGFsbCBleHRlbnNpb25zLlxyXG4gKlxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEdpdmVuIGEgZmlsZSBuYW1lZCBcImV4YW1wbGUubm90ZS5tZFwiLCB0aGUgcnVsZSB3aWxsIHJldHVybiBcImV4YW1wbGVcIi5cclxuICpcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoXCJuYW1lXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoXCJidWlsZEluXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBwdXJwb3NlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBvZiB0aGUgcnVsZSAoZW1wdHkgZm9yIGJ1aWx0LWluKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyB0aGlzIHJ1bGUgYXBwbGllcyB0byAoZS5nLiwgdGV4dCwgdGFncykuXHJcbiAqIEBwcm9wZXJ0eSB7YW55W119IGNvbmZpZ0VsZW1lbnRzIC0gVGhlIGNvbmZpZ3VyYXRpb24gZWxlbWVudHMgZm9yIHRoZSBydWxlLlxyXG4gKlxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIFJldHVybnMgdGhlIGZpbGUgbmFtZSB3aXRob3V0IGl0cyBleHRlbnNpb24gdXNpbmcgdGhlIHByb3ZpZGVkIHNjcmlwdGluZyB0b29scy5cclxuICpcclxuICogQG1ldGhvZCBjb25maWdUYWJcclxuICogKE9wdGlvbmFsKSBQcm92aWRlcyBhIGNvbmZpZ3VyYXRpb24gdGFiIGZvciB0aGUgcnVsZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJbk5hbWUgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmlkID0gJ25hbWUnO1xyXG4gICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgIHRoaXMubmFtZSA9ICdGaWxlIG5hbWUgd2l0aG91dCBleHRlbnNpb24nO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9ICdSZXR1cm5zIHRoZSBmaWxlIG5hbWUgd2l0aG91dCBhbGwgZXh0ZW5zaW9ucy4gSS5lLiBleGFtcGxlLm5vdGUubWQgPT4gZXhhbXBsZSc7XHJcbiAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgbmFtZVxcbiAgY29uc3QgcmVzdWx0ID0gdG9vbHMucmVtb3ZlQWxsRXh0ZW5zaW9ucyhmaWxlLm5hbWUpO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICB9XHJcbiAgXHJcbiAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgLy8gYWNxdWlyZSBmaWxlIG5hbWVcclxuICAgIGNvbnN0IHJlc3VsdCA9IHRvb2xzLnJlbW92ZUFsbEV4dGVuc2lvbnMoZmlsZS5uYW1lKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICB9O1xyXG4gICAgXHJcbn0iLCAiICBpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBBIGJ1aWx0LWluIHJ1bGUgdGhhdCByZXR1cm5zIHRoZSBmaWxlIG5hbWUgd2l0aCBpdHMgZXh0ZW5zaW9uLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIHJ1bGUgaXMgcGFydCBvZiB0aGUgZm9sZGVyLXRvLXRhZ3MtcGx1Z2luIGFuZCBleHRlbmRzIHRoZSB7QGxpbmsgUnVsZVByb3RvdHlwZX0uXHJcbiAqIEl0IGlzIGlkZW50aWZpZWQgYnkgdGhlIElEIGAnbmFtZUV4dCdgIGFuZCBpcyBjYXRlZ29yaXplZCBhcyBhIGJ1aWx0LWluIHJ1bGUuXHJcbiAqIFRoZSBydWxlIGNhbiBiZSB1c2VkIGluIGNvbnRleHRzIHJlcXVpcmluZyB0aGUgZmlsZSBuYW1lIGluY2x1ZGluZyBpdHMgZXh0ZW5zaW9uLFxyXG4gKiBzdWNoIGFzIHRleHQsIHRhZ3MsIGFsaWFzZXMsIG9yIG11bHRpdGV4dCBmaWVsZHMuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIFJldHVybnMgXCJleGFtcGxlLm1kXCIgZm9yIGEgZmlsZSBuYW1lZCBcImV4YW1wbGUubWRcIlxyXG4gKiBjb25zdCBmaWxlTmFtZVdpdGhFeHQgPSBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMpO1xyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5OYW1lRXh0IGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5pZCA9ICduYW1lRXh0JztcclxuICAgIHRoaXMucnVsZVR5cGUgPSAnYnVpbGRJbic7XHJcbiAgICB0aGlzLm5hbWUgPSAnRmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uJztcclxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmV0dXJucyB0aGUgZmlsZSBuYW1lIHdpdGggZXh0ZW5zaW9uLic7XHJcbiAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICAvLyBhY3F1aXJlIGZpbGUgbmFtZSB3aXRoIGV4dGVuc2lvblxcbiAgY29uc3QgcmVzdWx0ID0gZmlsZS5uYW1lO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICB9XHJcbiAgXHJcbiAgcHVibGljIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgIC8vIGFjcXVpcmUgZmlsZSBuYW1lXHJcbiAgICBjb25zdCByZXN1bHQgPSBmaWxlLm5hbWU7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNvbmZpZ1RhYiAob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOkZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6YW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgcnVsZSB0aGF0IGV4dHJhY3RzIHRoZSBmb2xkZXIgcGF0aCBvZiBhIGZpbGUgaW4gT2JzaWRpYW4uXHJcbiAqIFRoaXMgcnVsZSBpcyBidWlsdC1pbiBhbmQgcHJvdmlkZXMgZnVuY3Rpb25hbGl0eSB0byByZXRyaWV2ZSB0aGUgZnVsbCBwYXRoXHJcbiAqIG9mIHRoZSBmb2xkZXIgd2hlcmUgYSBmaWxlIGlzIHN0b3JlZC5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIGlzIGlkZW50aWZpZWQgYnkgdGhlIGBpZGAgXCJwYXRoXCIuXHJcbiAqIC0gSXQgaXMgY2F0ZWdvcml6ZWQgYXMgYSBcImJ1aWxkSW5cIiBydWxlIHR5cGUuXHJcbiAqIC0gVGhlIHJ1bGUgc3VwcG9ydHMgbXVsdGlwbGUgdHlwZXM6IGB0ZXh0YCwgYHRhZ3NgLCBgYWxpYXNlc2AsIGFuZCBgbXVsdGl0ZXh0YC5cclxuICogLSBUaGUgYHNvdXJjZWAgcHJvcGVydHkgY29udGFpbnMgdGhlIGZ1bmN0aW9uIGRlZmluaXRpb24gYXMgYSBzdHJpbmcsIHdoaWNoIHNob3VsZCBub3QgYmUgbW9kaWZpZWQuXHJcbiAqIC0gVGhlIGBmeGAgcHJvcGVydHkgaW1wbGVtZW50cyB0aGUgbG9naWMgdG8gZXh0cmFjdCB0aGUgZm9sZGVyIHBhdGggZnJvbSB0aGUgZmlsZSdzIHBhdGguXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIEV4YW1wbGUgdXNhZ2Ugb2YgdGhlIHJ1bGU6XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZUJ1aWxkSW5QYXRoKCk7XHJcbiAqIGNvbnN0IGZvbGRlclBhdGggPSBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMpO1xyXG4gKiBjb25zb2xlLmxvZyhmb2xkZXJQYXRoKTsgLy8gT3V0cHV0cyB0aGUgZm9sZGVyIHBhdGggb2YgdGhlIGZpbGVcclxuICpcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoXCJwYXRoXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSAoXCJidWlsZEluXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUgKFwiRnVsbCBwYXRoXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgZnVuY3Rpb25hbGl0eS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgcnVsZSdzIGZ1bmN0aW9uIGFzIGEgc3RyaW5nLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIHN1cHBvcnRlZCB0eXBlcyBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIGZ1bmN0aW9uIHRoYXQgaW1wbGVtZW50cyB0aGUgcnVsZSdzIGxvZ2ljLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBBIHBsYWNlaG9sZGVyIGZvciBjb25maWd1cmluZyB0aGUgcnVsZSBpbiB0aGUgVUkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZUJ1aWxkSW5QYXRoIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAncGF0aCc7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnRnVsbCBwYXRoJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1JldHVybnMgdGhlIGZvbGRlciBwYXRoIHRoZSBmaWxlIGlzIHN0b3JlZCBpbi4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgcGFydHMucG9wKCk7XFxuICByZXR1cm4gcGFydHMuam9pbignLycpO1xcbn07XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfTtcclxuXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHtcclxuICAgICAgICBsZXQgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICBwYXJ0cy5wb3AoKTtcclxuICAgICAgICByZXR1cm4gcGFydHMuam9pbignLycpO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgICB9O1xyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBidWlsdC1pbiBydWxlIGZvciBoYW5kbGluZyBmb2xkZXIgbm90ZXMgaW4gYSBwYXRoLWNvbXBhdGlibGUgbWFubmVyLlxyXG4gKiBUaGlzIHJ1bGUgcHJvY2Vzc2VzIGZpbGUgcGF0aHMgdG8gZGV0ZXJtaW5lIHRoZSBhcHByb3ByaWF0ZSBmb2xkZXIgc3RydWN0dXJlLFxyXG4gKiByZW1vdmluZyBwYXJlbnQgZm9sZGVycyBpZiB0aGV5IHNoYXJlIHRoZSBzYW1lIG5hbWUgYXMgdGhlIGZpbGUuXHJcbiAqXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICpcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgYGZ4YCBtZXRob2QgaW1wbGVtZW50cyB0aGUgY29yZSBsb2dpYyBmb3IgcGF0aCBtYW5pcHVsYXRpb24uXHJcbiAqIC0gVGhlIGBzb3VyY2VgIHByb3BlcnR5IGNvbnRhaW5zIHRoZSBzZXJpYWxpemVkIGZ1bmN0aW9uIGxvZ2ljIGZvciBleHRlcm5hbCB1c2UuXHJcbiAqIC0gVGhpcyBydWxlIGlzIGRlc2lnbmVkIHRvIHdvcmsgd2l0aCB0ZXh0LCB0YWdzLCBhbGlhc2VzLCBhbmQgbXVsdGl0ZXh0IHR5cGVzLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiAvLyBFeGFtcGxlIHVzYWdlIG9mIHRoZSBgZnhgIG1ldGhvZDpcclxuICogY29uc3QgcmVzdWx0ID0gcnVsZS5meChhcHAsIGZpbGUsIHRvb2xzKTtcclxuICogY29uc29sZS5sb2cocmVzdWx0KTsgLy8gT3V0cHV0cyB0aGUgcHJvY2Vzc2VkIHBhdGhcclxuICpcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoYHBhdGhGb2xkZXJOb3Rlc2ApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiBydWxlIChgYnVpbGRJbmApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUgKGBQYXRoIChmb2xkZXIgbm90ZXMpYCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBwdXJwb3NlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNlcmlhbGl6ZWQgZnVuY3Rpb24gbG9naWMgZm9yIGV4dGVybmFsIHVzZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBkYXRhIHRoaXMgcnVsZSBhcHBsaWVzIHRvIChgdGV4dGAsIGB0YWdzYCwgYGFsaWFzZXNgLCBgbXVsdGl0ZXh0YCkuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGNvbmZpZ1RhYiAtIEEgcGxhY2Vob2xkZXIgZm9yIGNvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljLlxyXG4gKlxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIFByb2Nlc3NlcyB0aGUgZmlsZSBwYXRoIHRvIGRldGVybWluZSB0aGUgYXBwcm9wcmlhdGUgZm9sZGVyIHN0cnVjdHVyZS5cclxuICogUmVtb3ZlcyB0aGUgcGFyZW50IGZvbGRlciBpZiBpdCBzaGFyZXMgdGhlIHNhbWUgbmFtZSBhcyB0aGUgZmlsZS5cclxuICpcclxuICogQHBhcmFtIHtBcHAgfCB1bmRlZmluZWR9IGFwcCAtIFRoZSBhcHBsaWNhdGlvbiBpbnN0YW5jZSAob3B0aW9uYWwpLlxyXG4gKiBAcGFyYW0ge1RGaWxlfSBmaWxlIC0gVGhlIGZpbGUgb2JqZWN0IGNvbnRhaW5pbmcgcGF0aCBhbmQgYmFzZW5hbWUgaW5mb3JtYXRpb24uXHJcbiAqIEBwYXJhbSB7U2NyaXB0aW5nVG9vbHN9IHRvb2xzIC0gVXRpbGl0eSB0b29scyBmb3Igc2NyaXB0aW5nIG9wZXJhdGlvbnMuXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IC0gVGhlIHByb2Nlc3NlZCBwYXRoIGFmdGVyIGFwcGx5aW5nIHRoZSBydWxlIGxvZ2ljLlxyXG4gKlxyXG4gKiBAbWV0aG9kIGNvbmZpZ1RhYlxyXG4gKiBQbGFjZWhvbGRlciBtZXRob2QgZm9yIGFkZGluZyBjb25maWd1cmF0aW9uIHRhYiBsb2dpYy5cclxuICpcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEluaXRpYWxpemVzIHRoZSBydWxlIHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzIGFuZCBjb25maWd1cmF0aW9uIGVsZW1lbnRzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluUGF0aEZvbGRlck5vdGVzIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAncGF0aEZvbGRlck5vdGVzJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdQYXRoIChmb2xkZXIgbm90ZXMpJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1BhdGggY29tcGF0aWJsZSB3aXRoIGZvbGRlciBub3Rlcy4nO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xcbiAgcGFydHMucG9wKCk7XFxuICBpZiAocGFydHNbcGFydHMubGVuZ3RoLTFdID09PSBmaWxlLmJhc2VuYW1lKSBwYXJ0cy5wb3AoKTsgLy8gcmVtb3ZlIHBhcmVudCBmb2xkZXIgaWYgc2FtZSBuYW1lIGFzIHRoZSBmaWxlXFxuICByZXR1cm4gcGFydHMuam9pbignLycpO1xcbn07XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgbGV0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgcGFydHMucG9wKCk7XHJcbiAgICAgICAgaWYgKHBhcnRzW3BhcnRzLmxlbmd0aC0xXSA9PT0gZmlsZS5iYXNlbmFtZSkgcGFydHMucG9wKCk7IC8vIHJlbW92ZSBwYXJlbnQgZm9sZGVyIGlmIHNhbWUgbmFtZSBhcyB0aGUgZmlsZVxyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCcvJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlnVGFiIChvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6RnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDphbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gdGFiIGxvZ2ljIGNhbiBiZSBhZGRlZCBoZXJlIGlmIG5lZWRlZFxyXG4gICAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJ1bGVCdWlsZEluUm9vdEZvbGRlciBpcyBhIHJ1bGUgaW1wbGVtZW50YXRpb24gdGhhdCBleHRyYWN0cyB0aGUgcm9vdCBmb2xkZXIgbmFtZVxyXG4gKiBmcm9tIHRoZSBwYXRoIG9mIGEgZ2l2ZW4gZmlsZSBpbiBhbiBPYnNpZGlhbiB2YXVsdC5cclxuICpcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBydWxlIGlkZW50aWZpZXMgdGhlIHRvcC1sZXZlbCBkaXJlY3RvcnkgKHJvb3QgZm9sZGVyKSB3aGVyZSB0aGUgZmlsZSBpcyBzdG9yZWQuXHJcbiAqIC0gSWYgdGhlIGZpbGUgaXMgYXQgdGhlIHJvb3Qgb2YgdGhlIHZhdWx0IChpLmUuLCBub3QgaW5zaWRlIGFueSBmb2xkZXIpLCBhbiBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQuXHJcbiAqIC0gVGhlIHJ1bGUgaXMgY2F0ZWdvcml6ZWQgYXMgYSAnYnVpbGRJbicgdHlwZSBhbmQgc3VwcG9ydHMgbXVsdGlwbGUgb3V0cHV0IHR5cGVzOiAndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCBhbmQgJ211bHRpdGV4dCcuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIElmIGZpbGUucGF0aCBpcyAnUHJvamVjdHMvTm90ZXMvbWVldGluZy5tZCcsIHRoZSBydWxlIHJldHVybnMgJ1Byb2plY3RzJy5cclxuICogLy8gSWYgZmlsZS5wYXRoIGlzICdyZWFkbWUubWQnLCB0aGUgcnVsZSByZXR1cm5zICcnIChlbXB0eSBzdHJpbmcpLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gVGhlIGN1cnJlbnQgT2JzaWRpYW4gQXBwIGluc3RhbmNlIChtYXkgYmUgdW5kZWZpbmVkKS5cclxuICogQHBhcmFtIGZpbGUgLSBUaGUgVEZpbGUgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgZmlsZSB3aG9zZSByb290IGZvbGRlciBpcyB0byBiZSBkZXRlcm1pbmVkLlxyXG4gKiBAcGFyYW0gdG9vbHMgLSBTY3JpcHRpbmdUb29scyB1dGlsaXR5IG9iamVjdCBmb3IgYWRkaXRpb25hbCBvcGVyYXRpb25zIChub3QgdXNlZCBpbiB0aGlzIHJ1bGUpLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBUaGUgbmFtZSBvZiB0aGUgcm9vdCBmb2xkZXIgYXMgYSBzdHJpbmcsIG9yIGFuIGVtcHR5IHN0cmluZyBpZiB0aGUgZmlsZSBpcyBpbiB0aGUgdmF1bHQgcm9vdC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlQnVpbGRJblJvb3RGb2xkZXIgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmlkID0gJ3Jvb3RGb2xkZXInO1xyXG4gICAgdGhpcy5ydWxlVHlwZSA9ICdidWlsZEluJztcclxuICAgIHRoaXMubmFtZSA9ICdSb290IGZvbGRlcic7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1JldHVybnMgdGhlIHJvb3QgZm9sZGVyIHdoZXJlIHRoZSBmaWxlIGlzIHN0b3JlZC4nO1xyXG4gICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgLy8gYWNxdWlyZSBmaWxlIHBhdGhcXG4gIGNvbnN0IHBhdGggPSBmaWxlLnBhdGg7XFxuICBjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcXG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPiAxID8gcGFydHNbMF0gOiAnJzsgLy8gcmV0dXJuIHJvb3QgZm9sZGVyIG9yIGVtcHR5IHN0cmluZyBpZiBpbiByb290XFxufVwiO1xyXG4gICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgIC8vIGFjcXVpcmUgZmlsZSBwYXRoXHJcbiAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcbiAgICBsZXQgcmVzdWx0ID0gJyc7XHJcbiAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICByZXN1bHQgPSBwYXJ0c1swXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDphbnkpIHtcclxuICAgICAgLy8gQ29uZmlndXJhdGlvbiB0YWIgbG9naWMgY2FuIGJlIGFkZGVkIGhlcmUgaWYgbmVlZGVkXHJcbiAgfTtcclxuICAgIFxyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBidWlsdC1pbiBydWxlIHRoYXQgcGFzc2VzIHRoZSBjb250ZW50IG9mIGEgZnJvbnRtYXR0ZXIgcGFyYW1ldGVyIHVuYWx0ZXJlZC5cclxuICogVGhpcyBydWxlIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSBpbnB1dCBjb250ZW50IHdpdGhvdXQgYW55IG1vZGlmaWNhdGlvbnMuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFRoZSBgZnhgIGZ1bmN0aW9uIGFuZCBgc291cmNlYCBwcm9wZXJ0eSBhcmUgZGVzaWduZWQgdG8gcHJvY2VzcyB0aGUgaW5wdXQgY29udGVudCBhbmQgcmV0dXJuIGl0IGFzLWlzLlxyXG4gKiAtIFRoaXMgcnVsZSBzdXBwb3J0cyBtdWx0aXBsZSB0eXBlcyBpbmNsdWRpbmcgYHRleHRgLCBgdGFnc2AsIGBhbGlhc2VzYCwgYW5kIGBtdWx0aXRleHRgLlxyXG4gKiAtIFRoZSBgY29uZmlnVGFiYCBtZXRob2QgaXMgY3VycmVudGx5IGEgcGxhY2Vob2xkZXIgZm9yIGNvbmZpZ3VyYXRpb24gVUkgZWxlbWVudHMuXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLCBzZXQgdG8gYCdkZWZhdWx0J2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCBzZXQgdG8gYCdidWlsZEluJ2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZSwgc2V0IHRvIGAnUGFzcyBwYXJhbWV0ZXIgdW5hbHRlcmVkJ2AuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBydWxlIGFzIGEgc3RyaW5nLCB1c2VkIGZvciBzY3JpcHRpbmcgcHVycG9zZXMuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgc3VwcG9ydGVkIHR5cGVzIGZvciB0aGlzIHJ1bGUsIGluY2x1ZGluZyBgdGV4dGAsIGB0YWdzYCwgYGFsaWFzZXNgLCBhbmQgYG11bHRpdGV4dGAuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIG1haW4gZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgdGhlIGlucHV0IGNvbnRlbnQgYW5kIHJldHVybnMgaXQgdW5hbHRlcmVkLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBjb25maWdUYWIgLSBBIG1ldGhvZCBmb3IgcmVuZGVyaW5nIHRoZSBjb25maWd1cmF0aW9uIHRhYiBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAY29uc3RydWN0b3JcclxuICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIGBSdWxlQnVpbGRJbkRlZmF1bHRgIGNsYXNzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVCdWlsZEluU2NyaXB0IGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAnc2NyaXB0JztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2J1aWxkSW4nO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdKYXZhU2NyaXB0IGZ1bmN0aW9uIChhZHZhbmNlZCknO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnSW1wbGVtZW50IGEgSmF2YVNjcmlwdCBmdW5jdGlvbiB0byBwcm9jZXNzIHRoZSBpbnB1dCBjb250ZW50LiBUaGUgZnVuY3Rpb24gc2hvdWxkIHJldHVybiB0aGUgcHJvY2Vzc2VkIGNvbnRlbnQuJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBjb25zdCBpbnB1dCA9IHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7IC8vIEdldCB0aGUgY3VycmVudCBjb250ZW50IG9mIHByb3BlcnR5XFxuICByZXR1cm4gaW5wdXQ7IC8vIFJldHVybiB0aGUgaW5wdXQgdW5hbHRlcmVkXFxufTtcIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBjb25zdCBpbnB1dCA9IHRvb2xzLmdldEN1cnJlbnRDb250ZW50KCk7IC8vIEdldCB0aGUgY3VycmVudCBjb250ZW50IG9mIHByb3BlcnR5XHJcbiAgICAgICAgcmV0dXJuIGlucHV0OyAvLyBSZXR1cm4gdGhlIGlucHV0IHVuYWx0ZXJlZFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIgKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTpGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OmFueSwgcHJldmlld0NvbXBvbmVudDphbnkpIHtcclxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIHRhYiBsb2dpYyBjYW4gYmUgYWRkZWQgaGVyZSBpZiBuZWVkZWRcclxuICAgIH07XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgRVJST1IsIGxvZ2dlciwgV0FSTklORyB9IGZyb20gXCIuLi9Mb2dcIjtcclxuXHJcblxyXG4vKipcclxuICogQSBydWxlIGNsYXNzIGZvciByZXBsYWNpbmcgY29uZmlndXJhYmxlIGNoYXJhY3RlcnMgaW4gYW4gaW5wdXQgdmFsdWUgd2l0aCBhIHNwZWNpZmllZCB0ZXh0IHN0cmluZy5cclxuICogU3VwcG9ydHMgYm90aCBwbGFpbiB0ZXh0IGFuZCByZWd1bGFyIGV4cHJlc3Npb24gcmVwbGFjZW1lbnRzLlxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBUaGlzIHJ1bGUgaXMgaW50ZW5kZWQgZm9yIHVzZSBpbiBmb3JtYXR0aW5nIG9wZXJhdGlvbnMsIHN1Y2ggYXMgcmVwbGFjaW5nIHNwYWNlcyBvciBvdGhlciBjaGFyYWN0ZXJzIGluIHRhZ3MsIGFsaWFzZXMsIG9yIHRleHQgZmllbGRzLlxyXG4gKiAtIFRoZSByZXBsYWNlbWVudCBiZWhhdmlvciBpcyBjb25maWd1cmFibGUgdmlhIHRoZSBgcmVwbGFjZWAgKHNlYXJjaCBwYXR0ZXJuKSBhbmQgYHJlcGxhY2VCeWAgKHJlcGxhY2VtZW50IHN0cmluZykgb3B0aW9ucy5cclxuICogLSBUaGUgY29uZmlndXJhdGlvbiBVSSBhbGxvd3MgdXNlcnMgdG8gc3BlY2lmeSB0aGUgc2VhcmNoIHBhdHRlcm4gKHN1cHBvcnRzIHJlZ2V4KSBhbmQgdGhlIHJlcGxhY2VtZW50IHN0cmluZy5cclxuICogXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIFJlcGxhY2UgYWxsIHNwYWNlcyB3aXRoIHVuZGVyc2NvcmVzIGluIGEgc3RyaW5nXHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVJlcGxhY2VTcGFjZXMoKTtcclxuICogcnVsZS5meChhcHAsIGZpbGUsIHRvb2xzLCBcIm15IHRhZyBuYW1lXCIpOyAvLyByZXR1cm5zIFwibXlfdGFnX25hbWVcIiBpZiBjb25maWd1cmVkIGFwcHJvcHJpYXRlbHlcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSBydWxlIGRvZXMuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHJ1bGUgKGUuZy4sICdmb3JtYXR0ZXInKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSBmb3IgdGhlIHJ1bGUncyBmdW5jdGlvbi5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBmaWVsZHMgdGhpcyBydWxlIGNhbiBiZSBhcHBsaWVkIHRvLlxyXG4gKiBAcHJvcGVydHkge2FueX0gY29uZmlnRWxlbWVudHMgLSBUaGUgY29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGZ4XHJcbiAqIEFwcGxpZXMgdGhlIHJlcGxhY2VtZW50IHJ1bGUgdG8gdGhlIGlucHV0IHZhbHVlIHVzaW5nIHRoZSBjb25maWd1cmVkIHNlYXJjaCBwYXR0ZXJuIGFuZCByZXBsYWNlbWVudCBzdHJpbmcuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGNvbmZpZ1RhYlxyXG4gKiBSZW5kZXJzIHRoZSBjb25maWd1cmF0aW9uIHRhYiBVSSBmb3Igc2V0dGluZyB0aGUgc2VhcmNoIGFuZCByZXBsYWNlbWVudCBzdHJpbmdzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVSZXBsYWNlQ2hhcnMgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdyZXBsYWNlQ2hhcnMnO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdSZXBsYWNlIENoYXJhY3RlcnMnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmVwbGFjZXMgY29uZmlndXJhYmxlIGNoYXJhY3RlcnMgaW4gdGhlIGlucHV0IHZhbHVlIHdpdGggYSBzcGVjaWZpZWQgdGV4dCBzdHJpbmcuIFN1cHBvcnRzIHRleHQgYW5kIHJlZ2V4IHJlcGxhY2VtZW50cy4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IGFueSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dD86YW55KSB7IC8vIERlZmF1bHQgZnVuY3Rpb24gc2lnbmF0dXJlXHJcbiAgICAgICAgY29uc3QgcmVwbGFjZSA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCAncmVwbGFjZScpO1xyXG4gICAgICAgIGlmICghcmVwbGFjZSB8fCByZXBsYWNlID09PSAnJykge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJlcGxhY2VCeSA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCAncmVwbGFjZUJ5Jyk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHJlcGxhY2UsICdnJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKHJlZ2V4LCByZXBsYWNlQnkpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZyhFUlJPUixgRXJyb3IgaW4gUnVsZVJlcGxhY2VDaGFyczogSW52YWxpZCByZWdleCBwYXR0ZXJuIFwiJHtyZXBsYWNlfVwiYCwgZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbmZpZ1RhYihvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6IGFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgb3B0aW9uRUwuZW1wdHkoKTtcclxuICAgICAgICAvLyBDcmVhdGUgYSBzZXR0aW5nIGZvciB0aGUgc21hbGwgd29yZHNcclxuICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgICAgICAgcmVwbGFjZTogJycsIC8vIHNlYXJjaCBmb3IgdGhpcyBzdHJpbmdcclxuICAgICAgICAgICAgcmVwbGFjZUJ5OiAnJywgLy8gcmVwbGFjZSB3aXRoIHRoaXMgc3RyaW5nXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdzZWFyY2ggZm9yJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byBzZWFyY2ggZm9yIGluIHRoZSBpbnB1dCB2YWx1ZSAoUmVnZXggc3VwcG9ydGVkKScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdzZWFyY2ggZm9yJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwncmVwbGFjZScpIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3JlcGxhY2UnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdyZXBsYWNlIGJ5JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byByZXBsYWNlIG1hdGNoZXMnKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncmVwbGFjZSBieScpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ3JlcGxhY2VCeScpIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3JlcGxhY2VCeScsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbi8qKlxyXG4gKiBBIHJ1bGUgY2xhc3MgdGhhdCByZXBsYWNlcyBzcGFjZXMgaW4gYSBnaXZlbiBpbnB1dCB2YWx1ZSB3aXRoIGEgc3BlY2lmaWVkIGNoYXJhY3Rlci5cclxuICogXHJcbiAqIFRoaXMgcnVsZSBpcyBpbnRlbmRlZCBmb3IgdXNlIGluIGZvcm1hdHRpbmcgdGV4dCwgdGFncywgYWxpYXNlcywgb3IgbXVsdGl0ZXh0IGZpZWxkcy5cclxuICogVGhlIHJlcGxhY2VtZW50IGNoYXJhY3RlciBjYW4gYmUgY29uZmlndXJlZCBieSB0aGUgdXNlciB2aWEgdGhlIHNldHRpbmdzIFVJLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogLy8gSWYgdGhlIHJlcGxhY2VtZW50IGNoYXJhY3RlciBpcyBzZXQgdG8gXCJfXCI6XHJcbiAqIHJ1bGUuZngoYXBwLCBmaWxlLCB0b29scywgXCJoZWxsbyB3b3JsZFwiKSAvLyByZXR1cm5zIFwiaGVsbG9fd29ybGRcIlxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZSAoXCJyZXBsYWNlU3BhY2VzXCIpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHJ1bGUgZG9lcy5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgcnVsZSAoXCJmb3JtYXR0ZXJcIikuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgYXBwbGljYWJsZSBmaWVsZCB0eXBlcyBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7YW55fSBjb25maWdFbGVtZW50cyAtIFRoZSBjb25maWd1cmF0aW9uIGVsZW1lbnRzIGZvciB0aGUgcnVsZS5cclxuICogXHJcbiAqIEBtZXRob2QgZnhcclxuICogUmVwbGFjZXMgYWxsIHNwYWNlcyBpbiB0aGUgaW5wdXQgdmFsdWUgd2l0aCB0aGUgY29uZmlndXJlZCByZXBsYWNlbWVudCBjaGFyYWN0ZXIuXHJcbiAqIFxyXG4gKiBAbWV0aG9kIGNvbmZpZ1RhYlxyXG4gKiBSZW5kZXJzIHRoZSBjb25maWd1cmF0aW9uIFVJIGZvciBzZXR0aW5nIHRoZSBzcGFjZSByZXBsYWNlbWVudCBjaGFyYWN0ZXIuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZVJlcGxhY2VTcGFjZXMgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdyZXBsYWNlU3BhY2VzJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnUmVwbGFjZSBTcGFjZXMnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUmVwbGFjZXMgc3BhY2VzIGluIHRoZSBpbnB1dCB2YWx1ZSB3aXRoIGEgc3BlY2lmaWVkIGNoYXJhY3Rlci4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IGFueSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dD86YW55KSB7IC8vIERlZmF1bHQgZnVuY3Rpb24gc2lnbmF0dXJlXHJcbiAgICAgICAgY29uc3Qgc3BhY2VSZXBsYWNlbWVudCA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyh0b29scy5nZXRSdWxlKCk/LmlkLCAnc3BhY2VSZXBsYWNlbWVudCcpO1xyXG4gICAgICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9cXHMrL2csIHNwYWNlUmVwbGFjZW1lbnQpOyAvLyBSZXBsYWNlIGFsbCBzcGFjZXMgd2l0aCB0aGUgc3BlY2lmaWVkIGNoYXJhY3RlclxyXG4gICAgfTtcclxuXHJcbiAgICBjb25maWdUYWIob3B0aW9uRUw6IEhUTUxFbGVtZW50LCBydWxlOiBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzLCB0aGF0OiBhbnksIHByZXZpZXdDb21wb25lbnQ6IGFueSkge1xyXG4gICAgICAgIG9wdGlvbkVMLmVtcHR5KCk7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc2V0dGluZyBmb3IgdGhlIHNtYWxsIHdvcmRzXHJcbiAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWdEZWZhdWx0cyhydWxlLmlkLCB7XHJcbiAgICAgICAgICAgIHNwYWNlUmVwbGFjZW1lbnQgOiAnJywgLy8gRGVmYXVsdCBzdWZmaXhcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1NwYWNlIHJlcGxhY2VtZW50JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYXJhY3RlciB0byByZXBsYWNlIHNwYWNlcyAoc3VnZ2VzdGVkOiBcIl9cIiknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignd2lsbCByZW1vdmUgc3BhY2VzJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGF0LmdldE9wdGlvbkNvbmZpZyhydWxlLmlkICwnc3BhY2VSZXBsYWNlbWVudCcpIHx8ICcnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQsJ3NwYWNlUmVwbGFjZW1lbnQnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC51cGRhdGVQcmV2aWV3KHJ1bGUsIHByZXZpZXdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgIH07XHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBTZXR0aW5nLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBGcm9udG1hdHRlckF1dG9tYXRlUnVsZVNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5cclxuLyoqXHJcbiAqIEEgcnVsZSBjbGFzcyBmb3IgcmVwbGFjaW5nIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBzdHJpbmdzLCB3aGlsZSBwcmVzZXJ2aW5nIGxldHRlcnMgd2l0aCBkaWFjcml0aWNzLlxyXG4gKiBcclxuICogVGhpcyBydWxlIGlzIGludGVuZGVkIGZvciB1c2UgaW4gZm9ybWF0dGluZyB0ZXh0LCB0YWdzLCBhbGlhc2VzLCBhbmQgbXVsdGl0ZXh0IGZpZWxkcy4gSXQgYWxsb3dzXHJcbiAqIHRoZSB1c2VyIHRvIHNwZWNpZnkgYSByZXBsYWNlbWVudCBjaGFyYWN0ZXIgKHN1Z2dlc3RlZDogXCItXCIpIGZvciBhbnkgY2hhcmFjdGVyIHRoYXQgZG9lcyBub3QgbWF0Y2hcclxuICogdGhlIGFsbG93ZWQgc2V0IChsZXR0ZXJzLCBudW1iZXJzLCBkYXNoZXMsIHVuZGVyc2NvcmVzLCBzbGFzaGVzLCBhbmQgY29tbW9uIGRpYWNyaXRpY3MpLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBUaGUgcmVwbGFjZW1lbnQgY2hhcmFjdGVyIGNhbiBiZSBjb25maWd1cmVkIHZpYSB0aGUgc2V0dGluZ3MgVUkuXHJcbiAqIC0gVGhlIHJ1bGUgcHJlc2VydmVzIGxldHRlcnMgd2l0aCBkaWFjcml0aWNzIChlLmcuLCBcdTAwRTQsIFx1MDBGNiwgXHUwMEZDLCBcdTAwRTEsIFx1MDBFOSwgZXRjLikuXHJcbiAqIC0gVGhlIGBmeGAgbWV0aG9kIHBlcmZvcm1zIHRoZSByZXBsYWNlbWVudCB1c2luZyBhIHJlZ3VsYXIgZXhwcmVzc2lvbi5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIFJlcGxhY2UgYWxsIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBhIHN0cmluZyB3aXRoICctJ1xyXG4gKiBydWxlLmZ4KGFwcCwgZmlsZSwgdG9vbHMsIFwiaGVsbG9Ad29ybGQhXCIpIC8vIHJldHVybnMgXCJoZWxsby13b3JsZC1cIlxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIERpc3BsYXkgbmFtZSBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIERlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgcHVycG9zZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVHlwZSBvZiB0aGUgcnVsZSAoZS5nLiwgJ2Zvcm1hdHRlcicpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gU291cmNlIGNvZGUgZm9yIHRoZSBydWxlJ3MgZnVuY3Rpb24uXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUeXBlcyBvZiBmaWVsZHMgdGhlIHJ1bGUgYXBwbGllcyB0by5cclxuICogQHByb3BlcnR5IHtvYmplY3R9IGNvbmZpZ0VsZW1lbnRzIC0gQ29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZVJlcGxhY2VTcGVjaWFsQ2hhcnMgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICdyZXBsYWNlU3BlY2lhbENoYXJzJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnUmVwbGFjZSBTcGVjaWFsIENoYXJhY3RlcnMnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ2hhcmFjdGVyIHRvIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChzdWdnZXN0ZWQ6IFwiLVwiKSAtIHByZXNlcnZlcyBsZXR0ZXJzIHdpdGggZGlhY3JpdGljcyc7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdmb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0PzphbnkpIHsgLy8gRGVmYXVsdCBmdW5jdGlvbiBzaWduYXR1cmVcclxuICAgICAgICBjb25zdCBzcGVjaWFsQ2hhclJlcGxhY2VtZW50ID0gdG9vbHMuZ2V0T3B0aW9uQ29uZmlnKHRvb2xzLmdldFJ1bGUoKT8uaWQsICdzcGVjaWFsQ2hhclJlcGxhY2VtZW50Jyk7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL1teYS16QS1aMC05XFwtX1xcL1x1MDBFNFx1MDBGNlx1MDBGQ1x1MDBERlx1MDBDNFx1MDBENlx1MDBEQ1x1MDBFMVx1MDBFOVx1MDBFRFx1MDBGM1x1MDBGQVx1MDBGRFx1MDBDMVx1MDBDOVx1MDBDRFx1MDBEM1x1MDBEQVx1MDBERFx1MDBFMFx1MDBFOFx1MDBFQ1x1MDBGMlx1MDBGOVx1MDBDMFx1MDBDOFx1MDBDQ1x1MDBEMlx1MDBEOVx1MDBFMlx1MDBFQVx1MDBFRVx1MDBGNFx1MDBGQlx1MDBDMlx1MDBDQVx1MDBDRVx1MDBENFx1MDBEQlx1MDBFM1x1MDBGMVx1MDBGNVx1MDBDM1x1MDBEMVx1MDBENV0vZywgc3BlY2lhbENoYXJSZXBsYWNlbWVudCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbmZpZ1RhYihvcHRpb25FTDogSFRNTEVsZW1lbnQsIHJ1bGU6IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MsIHRoYXQ6IGFueSwgcHJldmlld0NvbXBvbmVudDogYW55KSB7XHJcbiAgICAgICAgb3B0aW9uRUwuZW1wdHkoKTtcclxuICAgICAgICAvLyBDcmVhdGUgYSBzZXR0aW5nIGZvciB0aGUgc21hbGwgd29yZHNcclxuICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZ0RlZmF1bHRzKHJ1bGUuaWQsIHtcclxuICAgICAgICAgICAgc3BlY2lhbENoYXJSZXBsYWNlbWVudCA6ICcnLCAvLyBEZWZhdWx0IHN1ZmZpeFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKG9wdGlvbkVMKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVwbGFjZSBTcGVjaWFsIENoYXJhY3RlcnMnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2hhcmFjdGVyIHRvIHJlcGxhY2Ugc3BlY2lhbCBjaGFyYWN0ZXJzIChzdWdnZXN0ZWQ6IFwiLVwiKSAtIHByZXNlcnZlcyBsZXR0ZXJzIHdpdGggZGlhY3JpdGljcycpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd3aWxsIHJlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdzcGVjaWFsQ2hhclJlcGxhY2VtZW50JykgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnc3BlY2lhbENoYXJSZXBsYWNlbWVudCcsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgdGhhdCBjb252ZXJ0cyBpbnB1dCB2YWx1ZXMgdG8gQ2FtZWwgQ2FzZS5cclxuICogVGhpcyBydWxlIGNhbiBoYW5kbGUgdmFyaW91cyBpbnB1dCB0eXBlcyBpbmNsdWRpbmcgc3RyaW5ncywgYXJyYXlzLCBkYXRlcywgYW5kIG9iamVjdHMuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIEZvciBzdHJpbmdzLCBpdCBjb252ZXJ0cyB0aGUgZW50aXJlIHN0cmluZyB0byBDYW1lbCBDYXNlLlxyXG4gKiAtIEZvciBhcnJheXMsIGl0IG1hcHMgZWFjaCBlbGVtZW50IHRvIGl0cyBDYW1lbCBDYXNlIHN0cmluZyByZXByZXNlbnRhdGlvbi5cclxuICogLSBGb3IgZGF0ZXMsIGl0IGNvbnZlcnRzIHRoZSBkYXRlIHRvIGFuIElTTyBzdHJpbmcgYW5kIGFwcGxpZXMgQ2FtZWwgQ2FzZS5cclxuICogLSBGb3Igb2JqZWN0cywgaXQgc2VyaWFsaXplcyB0aGUgb2JqZWN0IHRvIGEgSlNPTiBzdHJpbmcgYW5kIGFwcGxpZXMgQ2FtZWwgQ2FzZS5cclxuICogLSBJZiB0aGUgaW5wdXQgdHlwZSBpcyBub3QgcmVjb2duaXplZCwgaXQgcmV0dXJucyB0aGUgaW5wdXQgYXMgaXMuXHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvQ2FtZWxDYXNlKCk7XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoXCJoZWxsbyB3b3JsZFwiLCB0b29scykpOyAvLyBPdXRwdXRzOiBcImhlbGxvV29ybGRcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFtcImhlbGxvIHdvcmxkXCIsIFwidGVzdCBjYXNlXCJdLCB0b29scykpOyAvLyBPdXRwdXRzOiBbXCJoZWxsb1dvcmxkXCIsIFwidGVzdENhc2VcIl1cclxuICogY29uc29sZS5sb2cocnVsZS5meChuZXcgRGF0ZShcIjIwMjMtMDEtMDFcIiksIHRvb2xzKSk7IC8vIE91dHB1dHM6IFwiMjAyMy0wMS0wMXQwMDowMDowMC4wMDB6XCJcclxuICogY29uc29sZS5sb2cocnVsZS5meCh7IGtleTogXCJ2YWx1ZVwiIH0sIHRvb2xzKSk7IC8vIE91dHB1dHM6ICd7XCJrZXlcIjpcInZhbHVlXCJ9J1xyXG4gKiBgYGBcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIGZ1bmN0aW9uYWxpdHkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCB3aGljaCBpcyBcImZvcm1hdHRlclwiLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIHRlbXBsYXRlIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBpbnB1dCB0aGlzIHJ1bGUgYXBwbGllcyB0bywgZS5nLiwgWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB0aGUgQ2FtZWwgQ2FzZSB0cmFuc2Zvcm1hdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9DYW1lbENhc2UgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICd0b0NhbWVsQ2FzZSc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1RvIENhbWVsIENhc2UnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ29udmVydCB0aGUgdmFsdWUgdG8gQ2FtZWwgQ2FzZS4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IFxyXG4gICAgICAgIGNvbnN0IHRvQ2FtZWxDYXNlID0gKHN0cjogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0ZXh0UGFydHMgPSBzdHIuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgbGV0IGNvbnZlcnRlZFRleHRQYXJ0czpzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICB0ZXh0UGFydHMuZm9yRWFjaCgodGV4dCxpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbmV3VGV4dFBhcnQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleD4wKSBuZXdUZXh0UGFydCA9IG5ld1RleHRQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmV3VGV4dFBhcnQuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgIGNvbnZlcnRlZFRleHRQYXJ0cy5wdXNoKG5ld1RleHRQYXJ0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb252ZXJ0ZWRUZXh0UGFydHMuam9pbignJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRvQ2FtZWxDYXNlKGlucHV0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5tYXAoKGl0ZW0pID0+IHRvQ2FtZWxDYXNlKFN0cmluZyhpdGVtKSkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0b0NhbWVsQ2FzZShpbnB1dC50b0lTT1N0cmluZygpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRvQ2FtZWxDYXNlKEpTT04uc3RyaW5naWZ5KGlucHV0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgIH07XHJcbn1cclxuXHJcbi8vcnVsZXNNYW5hZ2VyLnJlZ2lzdGVyUnVsZShuZXcgUnVsZVRvQ2FtZWxDYXNlKCkpOyIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBydWxlIGZvciBmb3JtYXR0aW5nIGlucHV0IGFzIGEgbWFya2Rvd24gbGluay5cclxuICogVGhpcyBjbGFzcyBleHRlbmRzIHRoZSBgUnVsZVByb3RvdHlwZWAgYW5kIHByb3ZpZGVzIGZ1bmN0aW9uYWxpdHlcclxuICogdG8gY29udmVydCBpbnB1dCBpbnRvIGEgbWFya2Rvd24gbGluayBmb3JtYXQgdXNpbmcgdGhlIHByb3ZpZGVkIHRvb2xzLlxyXG4gKlxyXG4gKiBAY2xhc3MgUnVsZVRvTGlua01hcmtkb3duXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICpcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEluaXRpYWxpemVzIHRoZSBydWxlIHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzIHN1Y2ggYXMgYGlkYCwgYG5hbWVgLFxyXG4gKiBgZGVzY3JpcHRpb25gLCBgcnVsZVR5cGVgLCBgc291cmNlYCwgYHR5cGVgLCBhbmQgYGNvbmZpZ0VsZW1lbnRzYC5cclxuICpcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgcHVycG9zZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgcnVsZSwgaW4gdGhpcyBjYXNlLCBhIGxpbmsgZm9ybWF0dGVyLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBydWxlIGFzIGEgc3RyaW5nLCB1c2VkIGZvciBzY3JpcHRpbmcgcHVycG9zZXMuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgYXBwbGljYWJsZSBpbnB1dCB0eXBlcyBmb3IgdGhlIHJ1bGUsIHN1Y2ggYXMgJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgYW5kICdtdWx0aXRleHQnLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIFRoZSBmdW5jdGlvbiB0aGF0IHBlcmZvcm1zIHRoZSBtYXJrZG93biBsaW5rIGZvcm1hdHRpbmcuXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGNvbmZpZ0VsZW1lbnRzIC0gQSBtZXRob2QgdG8gcmV0cmlldmUgdGhlIGRlZmF1bHQgY29uZmlndXJhdGlvbiBlbGVtZW50cyBmb3IgdGhlIHJ1bGUuXHJcbiAqXHJcbiAqIEBtZXRob2QgZnhcclxuICogQ29udmVydHMgdGhlIGlucHV0IGludG8gYSBtYXJrZG93biBsaW5rIGZvcm1hdCB1c2luZyB0aGUgYHRvb2xzLnRvTWFya2Rvd25MaW5rYCBtZXRob2QuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvTGlua01hcmtkb3duKCk7XHJcbiAqIGNvbnN0IGZvcm1hdHRlZCA9IHJ1bGUuZngoXCJleGFtcGxlXCIsIHRvb2xzKTtcclxuICogY29uc29sZS5sb2coZm9ybWF0dGVkKTsgLy8gT3V0cHV0cyB0aGUgaW5wdXQgZm9ybWF0dGVkIGFzIGEgbWFya2Rvd24gbGluay5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9MaW5rTWFya2Rvd24gZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICd0b01hcmtkb3duTGluayc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ3RvIG1hcmtkb3duIGxpbmsnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnRm9ybWF0IGFzIGEgbWFya2Rvd24gbGluay4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnbGlua0Zvcm1hdHRlcic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChpbnB1dDogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBpbnB1dCA9IHRvb2xzLnRvTWFya2Rvd25MaW5rKGlucHV0KTsgLy8gQ29udmVydCB0byBtYXJrZG93biBsaW5rIGZvcm1hdFxcbiAgcmV0dXJuIGlucHV0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGlucHV0ID0gdG9vbHMudG9NYXJrZG93bkxpbmsoaW5wdXQpOyAvLyBDb252ZXJ0IHRvIG1hcmtkb3duIGxpbmsgZm9ybWF0XHJcbiAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgdGhhdCBwYXNzZXMgaW5wdXQgdmFsdWVzIHVuYWx0ZXJlZC5cclxuICogVGhpcyBydWxlIHNpbXBseSByZXR1cm5zIHRoZSBpbnB1dCBhcyBpcywgd2l0aG91dCBhbnkgdHJhbnNmb3JtYXRpb24uXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvT3JpZ2luYWwoKTtcclxuICogY29uc29sZS5sb2cocnVsZS5meChcImhlbGxvIHdvcmxkXCIsIHRvb2xzKSk7IC8vIE91dHB1dHM6IFwiaGVsbG8gd29ybGRcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFtcImhlbGxvXCIsIFwid29ybGRcIl0sIHRvb2xzKSk7IC8vIE91dHB1dHM6IFtcImhlbGxvXCIsIFwid29ybGRcIl1cclxuICogY29uc29sZS5sb2cocnVsZS5meChuZXcgRGF0ZShcIjIwMjMtMDEtMDFcIiksIHRvb2xzKSk7IC8vIE91dHB1dHM6IERhdGUgb2JqZWN0XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoeyBrZXk6IFwidmFsdWVcIiB9LCB0b29scykpOyAvLyBPdXRwdXRzOiB7IGtleTogXCJ2YWx1ZVwiIH1cclxuICogYGBgXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSwgd2hpY2ggaXMgXCJmb3JtYXR0ZXJcIi5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSB0ZW1wbGF0ZSBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgdHlwZXMgb2YgaW5wdXQgdGhpcyBydWxlIGFwcGxpZXMgdG8sIGUuZy4sIFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J10uXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgaW5wdXQgdW5hbHRlcmVkLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVUb0xpbmtPcmlnaW5hbCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ3RvT3JpZ2luYWxMaW5rJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAnbm8gY2hhbmdlJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1Bhc3MgdGhlIGlucHV0IHVuYWx0ZXJlZC4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnbGlua0Zvcm1hdHRlcic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIHJldHVybiBpbnB1dDsgLy8gUmV0dXJuIHRoZSBpbnB1dCB1bmFsdGVyZWRcclxuICAgIH07XHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZX0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIEEgcnVsZSB0aGF0IGZvcm1hdHMgYSBnaXZlbiBpbnB1dCBhcyBhIHNpbXBsZSBPYnNpZGlhbiBsaW5rIGJ5IHdyYXBwaW5nIGl0IGluIGRvdWJsZSBzcXVhcmUgYnJhY2tldHMgKFtbLi4uXV0pLlxyXG4gKiBSZXR1cm5zIGFuIGVtcHR5IHN0cmluZyBpZiB0aGUgaW5wdXQgaXMgYHVuZGVmaW5lZGAsIGBudWxsYCwgb3IgYW4gZW1wdHkgc3RyaW5nLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIFJldHVybnMgYW4gZW1wdHkgc3RyaW5nIGlmIHRoZSBpbnB1dCBpcyBgdW5kZWZpbmVkYCwgYG51bGxgLCBvciBhbiBlbXB0eSBzdHJpbmcuXHJcbiAqIC0gSW50ZW5kZWQgZm9yIHVzZSBhcyBhIGxpbmsgZm9ybWF0dGVyIHdpdGhpbiB0aGUgcGx1Z2luJ3MgcnVsZSBzeXN0ZW0uXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogY29uc3QgcnVsZSA9IG5ldyBSdWxlVG9MaW5rU2ltcGxlKCk7XHJcbiAqIHJ1bGUuZngoYXBwLCBmaWxlLCB0b29scywgXCJNeU5vdGVcIik7IC8vIHJldHVybnMgJ1tbTXlOb3RlXV0nXHJcbiAqIHJ1bGUuZngoYXBwLCBmaWxlLCB0b29scywgXCJcIik7IC8vIHJldHVybnMgJydcclxuICogYGBgXHJcbiAqXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9MaW5rU2ltcGxlIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9TaW1wbGVMaW5rJztcclxuICAgICAgICB0aGlzLm5hbWUgPSAndG8gc2ltcGxlIGxpbmsnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnRm9ybWF0IGFzIGEgc2ltcGxlIGxpbmsgYnkgYWRkaW5nIFtbXV0uJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2xpbmtGb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scywgaW5wdXQpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBpZiAoaW5wdXQgPT09IHVuZGVmaW5lZCB8fCBpbnB1dCA9PT0gbnVsbCB8fCBpbnB1dCA9PT0gJycpIHtcXG4gICAgcmV0dXJuICcnOyAvLyBSZXR1cm4gZW1wdHkgc3RyaW5nIGlmIGlucHV0IGlzIHVuZGVmaW5lZCwgbnVsbCwgb3IgZW1wdHlcXG4gIH1cXG4gICAgICAgICBpbnB1dCA9IGBbWyR7aW5wdXR9XV1gOyAvLyBDb252ZXJ0IHRvIHNpbXBsZSBMaW5rXFxuICByZXR1cm4gaW5wdXQ7XFxufTtcIjsgLy8gU291cmNlIGNvZGUgdGVtcGxhdGVcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0OiBhbnkpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgaWYgKGlucHV0ID09PSB1bmRlZmluZWQgfHwgaW5wdXQgPT09IG51bGwgfHwgaW5wdXQgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJzsgLy8gUmV0dXJuIGVtcHR5IHN0cmluZyBpZiBpbnB1dCBpcyB1bmRlZmluZWQsIG51bGwsIG9yIGVtcHR5IFxyXG4gICAgICAgIH1cclxuICAgICAgICBpbnB1dCA9IGBbWyR7aW5wdXR9XV1gOyAvLyBDb252ZXJ0IHRvIHNpbXBsZSBMaW5rXHJcbiAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgfTtcclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgZm9yIGZvcm1hdHRpbmcgaW5wdXQgYXMgYSB3aWtpIGxpbmsuXHJcbiAqIFxyXG4gKiBUaGlzIGNsYXNzIGV4dGVuZHMgdGhlIGBSdWxlUHJvdG90eXBlYCBhbmQgcHJvdmlkZXMgZnVuY3Rpb25hbGl0eSB0b1xyXG4gKiBjb252ZXJ0IGlucHV0IGludG8gYSB3aWtpIGxpbmsgZm9ybWF0IHVzaW5nIHRoZSBwcm92aWRlZCBzY3JpcHRpbmcgdG9vbHMuXHJcbiAqIFxyXG4gKiBAY2xhc3MgUnVsZVRvTGlua1dpa2lcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEluaXRpYWxpemVzIHRoZSBydWxlIHdpdGggcHJlZGVmaW5lZCBwcm9wZXJ0aWVzIHN1Y2ggYXMgSUQsIG5hbWUsIGRlc2NyaXB0aW9uLFxyXG4gKiBydWxlIHR5cGUsIHNvdXJjZSBjb2RlIHRlbXBsYXRlLCBhcHBsaWNhYmxlIHR5cGVzLCBhbmQgY29uZmlndXJhdGlvbiBlbGVtZW50cy5cclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUgKGB0b1dpa2lMaW5rYCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZSAoYHdpa2kgbGlua2ApLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgcHVycG9zZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgcnVsZSAoYGxpbmtGb3JtYXR0ZXJgKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSB0ZW1wbGF0ZSBmb3IgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIGFwcGxpY2FibGUgaW5wdXQgdHlwZXMgZm9yIHRoZSBydWxlIFxyXG4gKiAoYFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J11gKS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCBhcHBsaWVzIHRoZSBydWxlIGxvZ2ljLCBjb252ZXJ0aW5nXHJcbiAqIGlucHV0IHRvIGEgd2lraSBsaW5rIGZvcm1hdCB1c2luZyB0aGUgcHJvdmlkZWQgYFNjcmlwdGluZ1Rvb2xzYC5cclxuICogXHJcbiAqIEBtZXRob2QgZGVmYXVsdENvbmZpZ0VsZW1lbnRzXHJcbiAqIEdlbmVyYXRlcyB0aGUgZGVmYXVsdCBjb25maWd1cmF0aW9uIGVsZW1lbnRzIGZvciB0aGUgcnVsZS5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvTGlua1dpa2koKTtcclxuICogY29uc3QgZm9ybWF0dGVkSW5wdXQgPSBydWxlLmZ4KFwiZXhhbXBsZVwiLCB0b29scyk7XHJcbiAqIGNvbnNvbGUubG9nKGZvcm1hdHRlZElucHV0KTsgLy8gT3V0cHV0cyB0aGUgaW5wdXQgZm9ybWF0dGVkIGFzIGEgd2lraSBsaW5rLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVUb0xpbmtXaWtpIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9XaWtpTGluayc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ3RvIHdpa2kgbGluayc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9ICdGb3JtYXQgYXMgYSB3aWtpIGxpbmsuJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2xpbmtGb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoaW5wdXQ6IGFueSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgaW5wdXQgPSB0b29scy50b1dpa2lMaW5rKGlucHV0KTsgLy8gQ29udmVydCB0byB3aWtpIGxpbmsgZm9ybWF0XFxuICByZXR1cm4gaW5wdXQ7XFxufVwiOyAvLyBTb3VyY2UgY29kZSB0ZW1wbGF0ZVxyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ6IGFueSkgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBpbnB1dCA9IHRvb2xzLnRvV2lraUxpbmsoaW5wdXQpOyAvLyBDb252ZXJ0IHRvIHdpa2kgbGluayBmb3JtYXRcclxuICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICB9O1xyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgcnVsZSB0aGF0IGNvbnZlcnRzIGlucHV0IHZhbHVlcyB0byBsb3dlciBjYXNlLlxyXG4gKiBUaGlzIHJ1bGUgY2FuIGhhbmRsZSB2YXJpb3VzIGlucHV0IHR5cGVzIGluY2x1ZGluZyBzdHJpbmdzLCBhcnJheXMsIGRhdGVzLCBhbmQgb2JqZWN0cy5cclxuICogXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEByZW1hcmtzXHJcbiAqIC0gRm9yIHN0cmluZ3MsIGl0IGNvbnZlcnRzIHRoZSBlbnRpcmUgc3RyaW5nIHRvIGxvd2VyIGNhc2UuXHJcbiAqIC0gRm9yIGFycmF5cywgaXQgbWFwcyBlYWNoIGVsZW1lbnQgdG8gaXRzIGxvd2VyIGNhc2Ugc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxyXG4gKiAtIEZvciBkYXRlcywgaXQgY29udmVydHMgdGhlIGRhdGUgdG8gYW4gSVNPIHN0cmluZyBpbiBsb3dlciBjYXNlLlxyXG4gKiAtIEZvciBvYmplY3RzLCBpdCBzZXJpYWxpemVzIHRoZSBvYmplY3QgdG8gYSBKU09OIHN0cmluZyBhbmQgY29udmVydHMgaXQgdG8gbG93ZXIgY2FzZS5cclxuICogLSBJZiB0aGUgaW5wdXQgdHlwZSBpcyBub3QgcmVjb2duaXplZCwgaXQgcmV0dXJucyB0aGUgaW5wdXQgYXMgaXMuXHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvTG93ZXJDYXNlKCk7XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoXCJIRUxMT1wiLCB0b29scykpOyAvLyBPdXRwdXRzOiBcImhlbGxvXCJcclxuICogY29uc29sZS5sb2cocnVsZS5meChbXCJIRUxMT1wiLCBcIldPUkxEXCJdLCB0b29scykpOyAvLyBPdXRwdXRzOiBbXCJoZWxsb1wiLCBcIndvcmxkXCJdXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngobmV3IERhdGUoXCIyMDIzLTAxLTAxXCIpLCB0b29scykpOyAvLyBPdXRwdXRzOiBcIjIwMjMtMDEtMDF0MDA6MDA6MDAuMDAwelwiXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoeyBLRVk6IFwiVkFMVUVcIiB9LCB0b29scykpOyAvLyBPdXRwdXRzOiAne1wia2V5XCI6XCJ2YWx1ZVwifSdcclxuICogYGBgXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSwgd2hpY2ggaXMgXCJmb3JtYXR0ZXJcIi5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSB0ZW1wbGF0ZSBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgdHlwZXMgb2YgaW5wdXQgdGhpcyBydWxlIGFwcGxpZXMgdG8sIGUuZy4sIFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J10uXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIGZ1bmN0aW9uIHRoYXQgcGVyZm9ybXMgdGhlIGxvd2VyIGNhc2UgdHJhbnNmb3JtYXRpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZVRvTG93ZXJDYXNlIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9Mb3dlckNhc2UnO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdUbyBMb3dlciBDYXNlJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbnZlcnQgdGhlIHZhbHVlIHRvIGxvd2VyIGNhc2UuJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2Zvcm1hdHRlcic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfTtcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ6IGFueSkgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBpZiAoU3RyaW5nLmlzU3RyaW5nKGlucHV0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB9IGVsc2UgaWYoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0Lm1hcCgoaXRlbSkgPT4gU3RyaW5nKGl0ZW0pLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC50b0lTT1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpbnB1dCkudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgfVxyXG59XHJcblxyXG4vL3J1bGVzTWFuYWdlci5yZWdpc3RlclJ1bGUobmV3IFJ1bGVUb0xvd2VyQ2FzZSgpKTsiLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBydWxlIHRoYXQgcGFzc2VzIGlucHV0IHZhbHVlcyB1bmFsdGVyZWQuXHJcbiAqIFRoaXMgcnVsZSBzaW1wbHkgcmV0dXJucyB0aGUgaW5wdXQgYXMgaXMsIHdpdGhvdXQgYW55IHRyYW5zZm9ybWF0aW9uLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlID0gbmV3IFJ1bGVUb09yaWdpbmFsKCk7XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoXCJoZWxsbyB3b3JsZFwiLCB0b29scykpOyAvLyBPdXRwdXRzOiBcImhlbGxvIHdvcmxkXCJcclxuICogY29uc29sZS5sb2cocnVsZS5meChbXCJoZWxsb1wiLCBcIndvcmxkXCJdLCB0b29scykpOyAvLyBPdXRwdXRzOiBbXCJoZWxsb1wiLCBcIndvcmxkXCJdXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngobmV3IERhdGUoXCIyMDIzLTAxLTAxXCIpLCB0b29scykpOyAvLyBPdXRwdXRzOiBEYXRlIG9iamVjdFxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KHsga2V5OiBcInZhbHVlXCIgfSwgdG9vbHMpKTsgLy8gT3V0cHV0czogeyBrZXk6IFwidmFsdWVcIiB9XHJcbiAqIGBgYFxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgZnVuY3Rpb25hbGl0eS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUsIHdoaWNoIGlzIFwiZm9ybWF0dGVyXCIuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzb3VyY2UgLSBUaGUgc291cmNlIGNvZGUgdGVtcGxhdGUgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIHR5cGVzIG9mIGlucHV0IHRoaXMgcnVsZSBhcHBsaWVzIHRvLCBlLmcuLCBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIFRoZSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGlucHV0IHVuYWx0ZXJlZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9PcmlnaW5hbCBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ3RvT3JpZ2luYWwnO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdubyBjaGFuZ2UnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnUGFzcyB0aGUgaW5wdXQgdW5hbHRlcmVkLic7XHJcbiAgICAgICAgdGhpcy5ydWxlVHlwZSA9ICdmb3JtYXR0ZXInO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gXCJmdW5jdGlvbiAoYXBwLCBmaWxlLCB0b29scykgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcXG4gIGxldCByZXN1bHQgPSAnJztcXG4gIHJldHVybiByZXN1bHQ7XFxufVwiO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J107XHJcbiAgICAgICAgdGhpcy5jb25maWdFbGVtZW50cyA9IHRoaXMuZGVmYXVsdENvbmZpZ0VsZW1lbnRzKHt9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogYW55LCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0PzphbnkpIHsgLy8gRGVmYXVsdCBmdW5jdGlvbiBzaWduYXR1cmVcclxuICAgICAgICByZXR1cm4gaW5wdXQ7IC8vIFJldHVybiB0aGUgaW5wdXQgdW5hbHRlcmVkXHJcbiAgICB9O1xyXG59IiwgImltcG9ydCB7IFJ1bGVQcm90b3R5cGUsIHJ1bGVzTWFuYWdlciB9IGZyb20gXCIuL3J1bGVzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ1Rvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzXCI7XHJcbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgcnVsZSB0aGF0IGNvbnZlcnRzIGlucHV0IHZhbHVlcyB0byBQYXNjYWwgQ2FzZSAoVXBwZXIgQ2FtZWwgQ2FzZSkuXHJcbiAqIFRoaXMgcnVsZSBjYW4gaGFuZGxlIHZhcmlvdXMgaW5wdXQgdHlwZXMgaW5jbHVkaW5nIHN0cmluZ3MsIGFycmF5cywgZGF0ZXMsIGFuZCBvYmplY3RzLlxyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBGb3Igc3RyaW5ncywgaXQgY29udmVydHMgdGhlIGVudGlyZSBzdHJpbmcgdG8gUGFzY2FsIENhc2UuXHJcbiAqIC0gRm9yIGFycmF5cywgaXQgbWFwcyBlYWNoIGVsZW1lbnQgdG8gaXRzIFBhc2NhbCBDYXNlIHN0cmluZyByZXByZXNlbnRhdGlvbi5cclxuICogLSBGb3IgZGF0ZXMsIGl0IGNvbnZlcnRzIHRoZSBkYXRlIHRvIGFuIElTTyBzdHJpbmcgYW5kIGFwcGxpZXMgUGFzY2FsIENhc2UuXHJcbiAqIC0gRm9yIG9iamVjdHMsIGl0IHNlcmlhbGl6ZXMgdGhlIG9iamVjdCB0byBhIEpTT04gc3RyaW5nIGFuZCBhcHBsaWVzIFBhc2NhbCBDYXNlLlxyXG4gKiAtIElmIHRoZSBpbnB1dCB0eXBlIGlzIG5vdCByZWNvZ25pemVkLCBpdCByZXR1cm5zIHRoZSBpbnB1dCBhcyBpcy5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogY29uc3QgcnVsZSA9IG5ldyBSdWxlVG9QYXNjYWxDYXNlKCk7XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoXCJoZWxsbyB3b3JsZFwiLCB0b29scykpOyAvLyBPdXRwdXRzOiBcIkhlbGxvV29ybGRcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFtcImhlbGxvIHdvcmxkXCIsIFwidGVzdCBjYXNlXCJdLCB0b29scykpOyAvLyBPdXRwdXRzOiBbXCJIZWxsb1dvcmxkXCIsIFwiVGVzdENhc2VcIl1cclxuICogY29uc29sZS5sb2cocnVsZS5meChuZXcgRGF0ZShcIjIwMjMtMDEtMDFcIiksIHRvb2xzKSk7IC8vIE91dHB1dHM6IFwiMjAyMy0wMS0wMVQwMDowMDowMC4wMDBaXCJcclxuICogY29uc29sZS5sb2cocnVsZS5meCh7IGtleTogXCJ2YWx1ZVwiIH0sIHRvb2xzKSk7IC8vIE91dHB1dHM6ICd7XCJLZXlcIjpcIlZhbHVlXCJ9J1xyXG4gKiBgYGBcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIGZ1bmN0aW9uYWxpdHkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCB3aGljaCBpcyBcImZvcm1hdHRlclwiLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIHRlbXBsYXRlIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBpbnB1dCB0aGlzIHJ1bGUgYXBwbGllcyB0bywgZS5nLiwgWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB0aGUgUGFzY2FsIENhc2UgdHJhbnNmb3JtYXRpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZVRvUGFzY2FsQ2FzZSBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmlkID0gJ3RvUGFzY2FsQ2FzZSc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1RvIFBhc2NhbCBDYXNlJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbnZlcnQgdGhlIHZhbHVlIHRvIFBhc2NhbCBDYXNlIChVcHBlciBDYW1lbCBDYXNlKS4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGNvbnN0IHRvUGFzY2FsQ2FzZSA9IChzdHI6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvKD86Xlxcd3xbQS1aXXxcXGJcXHd8XFxzKykvZywgKG1hdGNoKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoLnRvVXBwZXJDYXNlKClcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcnKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnJyk7IC8vIFJlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnNcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdG9QYXNjYWxDYXNlKGlucHV0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5tYXAoKGl0ZW0pID0+IHRvUGFzY2FsQ2FzZShTdHJpbmcoaXRlbSkpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdG9QYXNjYWxDYXNlKGlucHV0LnRvSVNPU3RyaW5nKCkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gdG9QYXNjYWxDYXNlKEpTT04uc3RyaW5naWZ5KGlucHV0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgIH07XHJcbn1cclxuXHJcbi8vcnVsZXMucmVnaXN0ZXJSdWxlKG5ldyBSdWxlVG9QYXNjYWxDYXNlKCkpOyIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgdGhhdCBjb252ZXJ0cyBpbnB1dCB2YWx1ZXMgdG8gVGl0bGUgQ2FzZS5cclxuICogVGhpcyBydWxlIGNhbiBoYW5kbGUgdmFyaW91cyBpbnB1dCB0eXBlcyBpbmNsdWRpbmcgc3RyaW5ncywgYXJyYXlzLCBkYXRlcywgYW5kIG9iamVjdHMuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIEZvciBzdHJpbmdzLCBpdCBjb252ZXJ0cyB0aGUgZW50aXJlIHN0cmluZyB0byBUaXRsZSBDYXNlLlxyXG4gKiAtIEZvciBhcnJheXMsIGl0IG1hcHMgZWFjaCBlbGVtZW50IHRvIGl0cyBUaXRsZSBDYXNlIHN0cmluZyByZXByZXNlbnRhdGlvbi5cclxuICogLSBGb3IgZGF0ZXMsIGl0IGNvbnZlcnRzIHRoZSBkYXRlIHRvIGFuIElTTyBzdHJpbmcgYW5kIGFwcGxpZXMgVGl0bGUgQ2FzZS5cclxuICogLSBGb3Igb2JqZWN0cywgaXQgc2VyaWFsaXplcyB0aGUgb2JqZWN0IHRvIGEgSlNPTiBzdHJpbmcgYW5kIGFwcGxpZXMgVGl0bGUgQ2FzZS5cclxuICogLSBJZiB0aGUgaW5wdXQgdHlwZSBpcyBub3QgcmVjb2duaXplZCwgaXQgcmV0dXJucyB0aGUgaW5wdXQgYXMgaXMuXHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0eXBlc2NyaXB0XHJcbiAqIGNvbnN0IHJ1bGUgPSBuZXcgUnVsZVRvVGl0bGVDYXNlKCk7XHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoXCJoZWxsbyB3b3JsZFwiLCB0b29scykpOyAvLyBPdXRwdXRzOiBcIkhlbGxvIFdvcmxkXCJcclxuICogY29uc29sZS5sb2cocnVsZS5meChbXCJoZWxsb1wiLCBcIndvcmxkXCJdLCB0b29scykpOyAvLyBPdXRwdXRzOiBbXCJIZWxsb1wiLCBcIldvcmxkXCJdXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngobmV3IERhdGUoXCIyMDIzLTAxLTAxXCIpLCB0b29scykpOyAvLyBPdXRwdXRzOiBcIjIwMjMtMDEtMDFUMDA6MDA6MDAuMDAwWlwiXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoeyBrZXk6IFwidmFsdWVcIiB9LCB0b29scykpOyAvLyBPdXRwdXRzOiAne1wiS2V5XCI6XCJWYWx1ZVwifSdcclxuICogYGBgXHJcbiAqIFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWQgLSBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkaXNwbGF5IG5hbWUgb2YgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIEEgYnJpZWYgZGVzY3JpcHRpb24gb2YgdGhlIHJ1bGUncyBmdW5jdGlvbmFsaXR5LlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcnVsZVR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcnVsZSwgd2hpY2ggaXMgXCJmb3JtYXR0ZXJcIi5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNvdXJjZSAtIFRoZSBzb3VyY2UgY29kZSB0ZW1wbGF0ZSBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW119IHR5cGUgLSBUaGUgdHlwZXMgb2YgaW5wdXQgdGhpcyBydWxlIGFwcGxpZXMgdG8sIGUuZy4sIFsndGV4dCcsICd0YWdzJywgJ2FsaWFzZXMnLCAnbXVsdGl0ZXh0J10uXHJcbiAqIEBwcm9wZXJ0eSB7RnVuY3Rpb259IGZ4IC0gVGhlIGZ1bmN0aW9uIHRoYXQgcGVyZm9ybXMgdGhlIFRpdGxlIENhc2UgdHJhbnNmb3JtYXRpb24uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUnVsZVRvVGl0bGVDYXNlIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9UaXRsZUNhc2UnO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdUbyBUaXRsZSBDYXNlIChTaW1wbGUpJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbnZlcnQgdGhlIHZhbHVlIHRvIFRpdGxlIENhc2UuJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2Zvcm1hdHRlcic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG4gICAgfTtcclxuICAgIGZ4IChhcHA6IEFwcCB8IHVuZGVmaW5lZCwgZmlsZTogVEZpbGUsIHRvb2xzOiBTY3JpcHRpbmdUb29scywgaW5wdXQ6IGFueSkgeyAvLyBkbyBub3QgY2hhbmdlIHRoaXMgbGluZSFcclxuICAgICAgICBjb25zdCB0b1RpdGxlQ2FzZSA9IChzdHI6IHN0cmluZykgPT4geyAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgdGV4dFBhcnRzID0gc3RyLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGxldCBjb252ZXJ0ZWRUZXh0UGFydHM6c3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgdGV4dFBhcnRzLmZvckVhY2goKHRleHQsaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBuZXdUZXh0UGFydCA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIG5ld1RleHRQYXJ0ID0gbmV3VGV4dFBhcnQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuZXdUZXh0UGFydC5zbGljZSgxKTtcclxuICAgICAgICAgICAgICAgIGNvbnZlcnRlZFRleHRQYXJ0cy5wdXNoKG5ld1RleHRQYXJ0KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRlZFRleHRQYXJ0cy5qb2luKCcgJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRvVGl0bGVDYXNlKGlucHV0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5tYXAoKGl0ZW0pID0+IHRvVGl0bGVDYXNlKFN0cmluZyhpdGVtKSkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0b1RpdGxlQ2FzZShpbnB1dC50b0lTT1N0cmluZygpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRvVGl0bGVDYXNlKEpTT04uc3RyaW5naWZ5KGlucHV0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgIH07XHJcbn1cclxuXHJcbi8vIHJ1bGVzLnJlZ2lzdGVyUnVsZShuZXcgUnVsZVRvVGl0bGVDYXNlKCkpOyIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyQXV0b21hdGVSdWxlU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgREVCVUcsIGxvZ2dlciwgVFJBQ0UgfSBmcm9tIFwiLi4vTG9nXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgdGhhdCBjb252ZXJ0cyBpbnB1dCB2YWx1ZXMgdG8gVGl0bGUgQ2FzZSB3aXRoIEdlcm1hbiBcInNtYWxsXCIgV29yZHMuXHJcbiAqIFRoaXMgcnVsZSBjYW4gaGFuZGxlIHZhcmlvdXMgaW5wdXQgdHlwZXMgaW5jbHVkaW5nIHN0cmluZ3MsIGFycmF5cywgZGF0ZXMsIGFuZCBvYmplY3RzLlxyXG4gKiBnZXJtYW4gZGVmaW5pdGlvbiBvZiBzbWFsbCB3b3JkczogaHR0cHM6Ly9jb3B5bWF0ZS5hcHAvZGUvYmxvZy9tdWx0aS90aXRlbC1rYXBpdGFsaXNpZXJlclxyXG4gKiBsaXN0IG9mIG1vc3QgZ2VybWFuIHNtYWxsIHdvcmRzOiBHZW1pbmkgQUlcclxuICogXHJcbiAqIEBleHRlbmRzIFJ1bGVQcm90b3R5cGVcclxuICogXHJcbiAqIEByZW1hcmtzXHJcbiAqIC0gRm9yIHN0cmluZ3MsIGl0IGNvbnZlcnRzIHRoZSBlbnRpcmUgc3RyaW5nIHRvIFRpdGxlIENhc2UuXHJcbiAqIC0gRm9yIGFycmF5cywgaXQgbWFwcyBlYWNoIGVsZW1lbnQgdG8gaXRzIFRpdGxlIENhc2Ugc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxyXG4gKiAtIEZvciBkYXRlcywgaXQgY29udmVydHMgdGhlIGRhdGUgdG8gYW4gSVNPIHN0cmluZyBhbmQgYXBwbGllcyBUaXRsZSBDYXNlLlxyXG4gKiAtIEZvciBvYmplY3RzLCBpdCBzZXJpYWxpemVzIHRoZSBvYmplY3QgdG8gYSBKU09OIHN0cmluZyBhbmQgYXBwbGllcyBUaXRsZSBDYXNlLlxyXG4gKiAtIElmIHRoZSBpbnB1dCB0eXBlIGlzIG5vdCByZWNvZ25pemVkLCBpdCByZXR1cm5zIHRoZSBpbnB1dCBhcyBpcy5cclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogY29uc3QgcnVsZSA9IG5ldyBSdWxlVG9UaXRsZUNhc2UoKTtcclxuICogY29uc29sZS5sb2cocnVsZS5meChcImhlbGxvIHdvcmxkXCIsIHRvb2xzKSk7IC8vIE91dHB1dHM6IFwiSGVsbG8gV29ybGRcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFtcImhlbGxvXCIsIFwid29ybGRcIl0sIHRvb2xzKSk7IC8vIE91dHB1dHM6IFtcIkhlbGxvXCIsIFwiV29ybGRcIl1cclxuICogY29uc29sZS5sb2cocnVsZS5meChuZXcgRGF0ZShcIjIwMjMtMDEtMDFcIiksIHRvb2xzKSk7IC8vIE91dHB1dHM6IFwiMjAyMy0wMS0wMVQwMDowMDowMC4wMDBaXCJcclxuICogY29uc29sZS5sb2cocnVsZS5meCh7IGtleTogXCJ2YWx1ZVwiIH0sIHRvb2xzKSk7IC8vIE91dHB1dHM6ICd7XCJLZXlcIjpcIlZhbHVlXCJ9J1xyXG4gKiBgYGBcclxuICogXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZCAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJ1bGUuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlc2NyaXB0aW9uIC0gQSBicmllZiBkZXNjcmlwdGlvbiBvZiB0aGUgcnVsZSdzIGZ1bmN0aW9uYWxpdHkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBydWxlVHlwZSAtIFRoZSB0eXBlIG9mIHRoZSBydWxlLCB3aGljaCBpcyBcImZvcm1hdHRlclwiLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIC0gVGhlIHNvdXJjZSBjb2RlIHRlbXBsYXRlIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmdbXX0gdHlwZSAtIFRoZSB0eXBlcyBvZiBpbnB1dCB0aGlzIHJ1bGUgYXBwbGllcyB0bywgZS5nLiwgWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB0aGUgVGl0bGUgQ2FzZSB0cmFuc2Zvcm1hdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9UaXRsZUNhc2VERSBleHRlbmRzIFJ1bGVQcm90b3R5cGUge1xyXG4gICAgcHJpdmF0ZSB2ZXJib3NlTG9nZ2luZyA9IGZhbHNlOyAvLyBTZXQgdG8gdHJ1ZSBmb3IgdmVyYm9zZSBsb2dnaW5nXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9UaXRsZUNhc2VEZSc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1RvIFRpdGxlIENhc2UgKEdlcm1hbiBzbWFsbCB3b3JkcyknO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ29udmVydCBHZXJtYW4gdmFsdWUgdG8gVGl0bGUgQ2FzZS4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBmeCAoYXBwOiBBcHAgfCB1bmRlZmluZWQsIGZpbGU6IFRGaWxlLCB0b29sczogU2NyaXB0aW5nVG9vbHMsIGlucHV0OiBhbnkpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXHJcbiAgICAgICAgY29uc3QgdG9UaXRsZUNhc2UgPSAoc3RyOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZUlkID0gdG9vbHMuZ2V0UnVsZSgpPy5pZDtcclxuICAgICAgICAgICAgY29uc3QgZG9Ob3RDYXBpdGFsaXplU21hbGxXb3JkcyA9IHRvb2xzLmdldE9wdGlvbkNvbmZpZyhydWxlSWQsICdkb05vdENhcGl0YWxpemVTbWFsbFdvcmRzJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRpdGxlQ2FwcyhzdHIsIGRvTm90Q2FwaXRhbGl6ZVNtYWxsV29yZHMgPyB0b29scy5nZXRPcHRpb25Db25maWcocnVsZUlkLCdzbWFsbFdvcmRzJykgOiB1bmRlZmluZWQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHJlc3VsdDogYW55ID0gaW5wdXQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gdG9UaXRsZUNhc2UoaW5wdXQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXQubWFwKChpdGVtKSA9PiB0b1RpdGxlQ2FzZShTdHJpbmcoaXRlbSkpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB0b1RpdGxlQ2FzZShpbnB1dC50b0lTT1N0cmluZygpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gdG9UaXRsZUNhc2UoSlNPTi5zdHJpbmdpZnkoaW5wdXQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbG9nZ2VyLmxvZyhERUJVRywgYFJ1bGVUb1RpdGxlQ2FzZURFLmZ4IC0gaW5wdXQ6JyR7aW5wdXR9JyByZXN1bHQ6JyR7IHJlc3VsdH0nYCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgY29uZmlnVGFiKG9wdGlvbkVMOiBIVE1MRWxlbWVudCwgcnVsZTogRnJvbnRtYXR0ZXJBdXRvbWF0ZVJ1bGVTZXR0aW5ncywgdGhhdDogYW55LCBwcmV2aWV3Q29tcG9uZW50OiBhbnkpIHtcclxuICAgICAgICBvcHRpb25FTC5lbXB0eSgpO1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHNldHRpbmcgZm9yIHRoZSBzbWFsbCB3b3Jkc1xyXG4gICAgICAgIHRoYXQuc2V0T3B0aW9uQ29uZmlnRGVmYXVsdHMocnVsZS5pZCwge1xyXG4gICAgICAgICAgICBzbWFsbFdvcmRzOiAnZGVyfGRpZXxkYXN8ZGVufGRlbXxkZXN8ZWluZXJ8ZWluZXN8ZGVyZW58ZWlufGVpbmV8ZWluZW18ZWluZXJ8ZWluZXN8ZWluZXJ8dW5kfG9kZXJ8YWJlcnxkZW5ufHNvbmRlcm58c293aWV8d2VkZXJ8bm9jaHxlbnR3ZWRlcnxvZGVyfGRhc3N8d2VpbHxvYndvaGx8d2VubnxhbHN8bmFjaGRlbXxiZXZvcnx3XHUwMEU0aHJlbmR8YmlzfGRhbWl0fHVtfHp1fHNvYmFsZHxzb2xhbmdlfGRhfGluZGVtfHNvfGRhc3N8b2huZXx6dXxkdXJjaHxmXHUwMEZDcnxnZWdlbnxvaG5lfHVtfGJpc3xhdXN8YXVcdTAwREZlcnxiZWl8Z2VnZW5cdTAwRkNiZXJ8bWl0fG5hY2h8c2VpdHx2b258enV8YW5zdGF0dHxhdWZncnVuZHxhdVx1MDBERmVyaGFsYnxpbm5lcmhhbGJ8dHJvdHp8d1x1MDBFNGhyZW5kfHdlZ2VufGFufGF1ZnxoaW50ZXJ8aW58bmViZW58XHUwMEZDYmVyfHVudGVyfHZvcnx6d2lzY2hlbicsXHJcbiAgICAgICAgICAgIGRvTm90Q2FwaXRhbGl6ZVNtYWxsV29yZHM6IHRydWUsXHJcbiAgICAgICAgfSlcclxuICAgICAgICBuZXcgU2V0dGluZyhvcHRpb25FTClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0RvIG5vdCBjYXBpdGFsaXplIHNtYWxsIHdvcmRzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZWQsIHNtYWxsIHdvcmRzIHdpbGwgbm90IGJlIGNhcGl0YWxpemVkLiBJZiBkaXNhYmxlZCwgYWxsIHdvcmRzIHdpbGwgYmUgY2FwaXRhbGl6ZWQuJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhhdC5nZXRPcHRpb25Db25maWcocnVsZS5pZCAsJ2RvTm90Q2FwaXRhbGl6ZVNtYWxsV29yZHMnKSB8fCBmYWxzZSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnNldE9wdGlvbkNvbmZpZyhydWxlLmlkLCdkb05vdENhcGl0YWxpemVTbWFsbFdvcmRzJywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQudXBkYXRlUHJldmlldyhydWxlLCBwcmV2aWV3Q29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc2V0dGluZyBmb3IgdGhlIHNtYWxsIHdvcmRzXHJcbiAgICAgICAgbmV3IFNldHRpbmcob3B0aW9uRUwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdMaXN0IG9mIHNtYWxsIHdvcmRzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0VudGVyIGEgbGlzdCBvZiBzbWFsbCB3b3JkcyB0byBiZSBleGNsdWRlZCBmcm9tIGNhcGl0YWxpemF0aW9uLiBVc2UgXCJ8XCIgYXMgc2VwYXJhdG9yLicpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoYXQuZ2V0T3B0aW9uQ29uZmlnKHJ1bGUuaWQgLCdzbWFsbFdvcmRzJykgfHwgJycpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRPcHRpb25Db25maWcocnVsZS5pZCwnc21hbGxXb3JkcycsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVByZXZpZXcocnVsZSwgcHJldmlld0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfTtcclxuXHRcclxuXHRwcml2YXRlIHNtYWxsID0gXCIoZGVyfGRpZXxkYXN8ZGVufGRlbXxkZXN8ZWluZXJ8ZWluZXN8ZGVyZW58ZWlufGVpbmV8ZWluZW18ZWluZXJ8ZWluZXN8ZWluZXJ8dW5kfG9kZXJ8YWJlcnxkZW5ufHNvbmRlcm58c293aWV8d2VkZXJ8bm9jaHxlbnR3ZWRlcnxvZGVyfGRhc3N8d2VpbHxvYndvaGx8d2VubnxhbHN8bmFjaGRlbXxiZXZvcnx3XHUwMEU0aHJlbmR8YmlzfGRhbWl0fHVtfHp1fHNvYmFsZHxzb2xhbmdlfGRhfGluZGVtfHNvfGRhc3N8b2huZXx6dXxkdXJjaHxmXHUwMEZDcnxnZWdlbnxvaG5lfHVtfGJpc3xhdXN8YXVcdTAwREZlcnxiZWl8Z2VnZW5cdTAwRkNiZXJ8bWl0fG5hY2h8c2VpdHx2b258enV8YW5zdGF0dHxhdWZncnVuZHxhdVx1MDBERmVyaGFsYnxpbm5lcmhhbGJ8dHJvdHp8d1x1MDBFNGhyZW5kfHdlZ2VufGFufGF1ZnxoaW50ZXJ8aW58bmViZW58XHUwMEZDYmVyfHVudGVyfHZvcnx6d2lzY2hlbilcIjtcclxuICAgIHByaXZhdGUgcHVuY3R1YXRpb24gPSBcIlxcXFwoWyFcXFwiIyQlJicoKSorLC4vOjs8PT4/QFtcXFxcXFxcXFxcXFxdXl9ge3x9flxcXFwtXSpcXFxcKVwiO1xyXG5cclxuICAgIHRpdGxlQ2Fwcyh0aXRsZTogc3RyaW5nLCBzbWFsbFdvcmRzOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcclxuICAgICAgICBjb25zdCBwYXJ0czogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBjb25zdCBzcGxpdCA9IG5ldyBSZWdFeHAoYFs6Ljs/IV0gfCg/OiB8XilbXCIke3RoaXMucHVuY3R1YXRpb259XWAsIFwiZ1wiKTtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG5cclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBtID0gc3BsaXQuZXhlYyh0aXRsZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdWJzdHJpbmcgPSB0aXRsZS5zdWJzdHJpbmcoaW5kZXgsIG0gPyBtLmluZGV4IDogdGl0bGUubGVuZ3RoKTtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZyhUUkFDRSxcIlByb2Nlc3Npbmcgc3Vic3RyaW5nOlwiLCBzdWJzdHJpbmcpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGlzRmlyc3RXb3JkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcGFydHMucHVzaChcclxuICAgICAgICAgICAgICAgIHN1YnN0cmluZy5yZXBsYWNlKC8oW1xccHtMfVxccHtNfV0rKD86XFwuW1xccHtMfVxccHtNfV0rKSopL2d1LCAoYWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhUUkFDRSxcIk1hdGNoZWQgd29yZDpcIiwgYWxsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRXhjbHVkZSB3b3JkcyB3aXRoIG1peGVkIGNhcGl0YWxpemF0aW9uIChlLmcuLCBcImlQaG9uZVwiLCBcImlNYWNcIilcclxuICAgICAgICAgICAgICAgICAgICBpZiAoL1thLXpdW0EtWl18W0EtWl1bYS16XS8udGVzdChhbGwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coVFJBQ0UsXCJFeGNsdWRpbmcgbWl4ZWQgY2FwaXRhbGl6YXRpb24gd29yZDpcIiwgYWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNGaXJzdFdvcmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEV4Y2x1ZGUgZnVsbHkgY2FwaXRhbGl6ZWQgd29yZHMgKGUuZy4sIFwiSUJNXCIsIFwiREVMTFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgvXltBLVpcdTAwQzRcdTAwRDZcdTAwRENcdTAwREZdKyQvLnRlc3QoYWxsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKFRSQUNFLFwiRXhjbHVkaW5nIGZ1bGx5IGNhcGl0YWxpemVkIHdvcmQ6XCIsIGFsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlyc3RXb3JkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBFeGNsdWRlIHdvcmRzIHdpdGggcHVuY3R1YXRpb24gd2l0aG91dCBzcGFjZXMgKGUuZy4sIFwiZ29vZ2xlLmNvbVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgvW15cXHNdK1xcLlteXFxzXSsvLnRlc3QoYWxsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKFRSQUNFLFwiRXhjbHVkaW5nIHdvcmQgd2l0aCBwdW5jdHVhdGlvbjpcIiwgYWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNGaXJzdFdvcmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNtYWxsUmVnZXggPSBuZXcgUmVnRXhwKGBeKCR7c21hbGxXb3Jkc30pJGAsIFwiaXVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRmlyc3RXb3JkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coVFJBQ0UsXCJDYXBpdGFsaXppbmcgZmlyc3Qgd29yZCBvZiBzZW50ZW5jZTpcIiwgYWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNGaXJzdFdvcmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBwZXJERShhbGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc21hbGxSZWdleC50ZXN0KGFsbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhUUkFDRSxcIlNraXBwaW5nIGNhcGl0YWxpemF0aW9uIGZvciBzbWFsbCB3b3JkOlwiLCBhbGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb3dlckRFKGFsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpc0ZpcnN0V29yZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnVwcGVyREUoYWxsKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpbmRleCA9IHNwbGl0Lmxhc3RJbmRleDtcclxuXHJcbiAgICAgICAgICAgIGlmIChtKSBwYXJ0cy5wdXNoKG1bMF0pO1xyXG4gICAgICAgICAgICBlbHNlIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oXCJcIik7XHJcbiAgICB9XHJcblxyXG4gICAgbG93ZXJERSh3b3JkOiBzdHJpbmcpIHtcclxuICAgICAgICBsb2dnZXIubG9nKFRSQUNFLFwiTG93ZXJpbmc6XCIsIHdvcmQpO1xyXG4gICAgICAgIHJldHVybiB3b3JkLnRvTG9jYWxlTG93ZXJDYXNlKFwiZGVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdXBwZXJERSh3b3JkOiBzdHJpbmcpIHtcclxuICAgICAgICBsb2dnZXIubG9nKFRSQUNFLFwiVXBwZXJpbmc6XCIsIHdvcmQpO1xyXG4gICAgICAgIC8vIENhcGl0YWxpemUgdGhlIGZpcnN0IGNoYXJhY3RlciBhbmQgbGVhdmUgdGhlIHJlc3Qgb2YgdGhlIHdvcmQgdW5jaGFuZ2VkXHJcbiAgICAgICAgcmV0dXJuIHdvcmQuY2hhckF0KDApLnRvTG9jYWxlVXBwZXJDYXNlKFwiZGVcIikgKyB3b3JkLnNsaWNlKDEpLnRvTG9jYWxlTG93ZXJDYXNlKFwiZGVcIik7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgUnVsZVByb3RvdHlwZSwgcnVsZXNNYW5hZ2VyIH0gZnJvbSBcIi4vcnVsZXNcIjtcclxuaW1wb3J0IHsgU2NyaXB0aW5nVG9vbHMgfSBmcm9tIFwiLi4vdG9vbHNcIjtcclxuaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBydWxlIHRoYXQgY29udmVydHMgaW5wdXQgdmFsdWVzIHRvIFRpdGxlIENhc2Ugd2l0aCBFbmdsaXNoIFwic21hbGxcIiBXb3Jkcy5cclxuICogVGhpcyBydWxlIGNhbiBoYW5kbGUgdmFyaW91cyBpbnB1dCB0eXBlcyBpbmNsdWRpbmcgc3RyaW5ncywgYXJyYXlzLCBkYXRlcywgYW5kIG9iamVjdHMuXHJcbiAqIGNyZWRpdCBodHRwczovL2pvaG5yZXNpZy5jb20vYmxvZy90aXRsZS1jYXBpdGFsaXphdGlvbi1pbi1qYXZhc2NyaXB0L1xyXG4gKiBcclxuICogQGV4dGVuZHMgUnVsZVByb3RvdHlwZVxyXG4gKiBcclxuICogQHJlbWFya3NcclxuICogLSBGb3Igc3RyaW5ncywgaXQgY29udmVydHMgdGhlIGVudGlyZSBzdHJpbmcgdG8gVGl0bGUgQ2FzZS5cclxuICogLSBGb3IgYXJyYXlzLCBpdCBtYXBzIGVhY2ggZWxlbWVudCB0byBpdHMgVGl0bGUgQ2FzZSBzdHJpbmcgcmVwcmVzZW50YXRpb24uXHJcbiAqIC0gRm9yIGRhdGVzLCBpdCBjb252ZXJ0cyB0aGUgZGF0ZSB0byBhbiBJU08gc3RyaW5nIGFuZCBhcHBsaWVzIFRpdGxlIENhc2UuXHJcbiAqIC0gRm9yIG9iamVjdHMsIGl0IHNlcmlhbGl6ZXMgdGhlIG9iamVjdCB0byBhIEpTT04gc3RyaW5nIGFuZCBhcHBsaWVzIFRpdGxlIENhc2UuXHJcbiAqIC0gSWYgdGhlIGlucHV0IHR5cGUgaXMgbm90IHJlY29nbml6ZWQsIGl0IHJldHVybnMgdGhlIGlucHV0IGFzIGlzLlxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlID0gbmV3IFJ1bGVUb1RpdGxlQ2FzZSgpO1xyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFwiaGVsbG8gd29ybGRcIiwgdG9vbHMpKTsgLy8gT3V0cHV0czogXCJIZWxsbyBXb3JsZFwiXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoW1wiaGVsbG9cIiwgXCJ3b3JsZFwiXSwgdG9vbHMpKTsgLy8gT3V0cHV0czogW1wiSGVsbG9cIiwgXCJXb3JsZFwiXVxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KG5ldyBEYXRlKFwiMjAyMy0wMS0wMVwiKSwgdG9vbHMpKTsgLy8gT3V0cHV0czogXCIyMDIzLTAxLTAxVDAwOjAwOjAwLjAwMFpcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KHsga2V5OiBcInZhbHVlXCIgfSwgdG9vbHMpKTsgLy8gT3V0cHV0czogJ3tcIktleVwiOlwiVmFsdWVcIn0nXHJcbiAqIGBgYFxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgZnVuY3Rpb25hbGl0eS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUsIHdoaWNoIGlzIFwiZm9ybWF0dGVyXCIuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzb3VyY2UgLSBUaGUgc291cmNlIGNvZGUgdGVtcGxhdGUgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIHR5cGVzIG9mIGlucHV0IHRoaXMgcnVsZSBhcHBsaWVzIHRvLCBlLmcuLCBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddLlxyXG4gKiBAcHJvcGVydHkge0Z1bmN0aW9ufSBmeCAtIFRoZSBmdW5jdGlvbiB0aGF0IHBlcmZvcm1zIHRoZSBUaXRsZSBDYXNlIHRyYW5zZm9ybWF0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bGVUb1RpdGxlQ2FzZUVOIGV4dGVuZHMgUnVsZVByb3RvdHlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuaWQgPSAndG9UaXRsZUNhc2VFbic7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1RvIFRpdGxlIENhc2UgKEVuZ2xpc2ggc21hbGwgd29yZHMpJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ0NvbnZlcnQgdGhlIHZhbHVlIHRvIFRpdGxlIENhc2UuJztcclxuICAgICAgICB0aGlzLnJ1bGVUeXBlID0gJ2Zvcm1hdHRlcic7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBcImZ1bmN0aW9uIChhcHAsIGZpbGUsIHRvb2xzKSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxcbiAgbGV0IHJlc3VsdCA9ICcnO1xcbiAgcmV0dXJuIHJlc3VsdDtcXG59XCI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gWyd0ZXh0JywgJ3RhZ3MnLCAnYWxpYXNlcycsICdtdWx0aXRleHQnXTtcclxuICAgICAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gdGhpcy5kZWZhdWx0Q29uZmlnRWxlbWVudHMoe30pO1xyXG5cdH07XHJcblx0XHJcblx0ZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG5cdFx0Y29uc3QgdG9UaXRsZUNhc2UgPSAoc3RyOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0cmV0dXJuIHRoaXMudGl0bGVDYXBzKHN0cik7XHJcblx0XHR9O1xyXG5cclxuXHRcdGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdHJldHVybiB0b1RpdGxlQ2FzZShpbnB1dCk7XHJcblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcblx0XHRcdHJldHVybiBpbnB1dC5tYXAoKGl0ZW0pID0+IHRvVGl0bGVDYXNlKFN0cmluZyhpdGVtKSkpO1xyXG5cdFx0fSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIERhdGUpIHtcclxuXHRcdFx0cmV0dXJuIHRvVGl0bGVDYXNlKGlucHV0LnRvSVNPU3RyaW5nKCkpO1xyXG5cdFx0fSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdHJldHVybiB0b1RpdGxlQ2FzZShKU09OLnN0cmluZ2lmeShpbnB1dCkpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGlucHV0O1xyXG5cdH07XHJcblxyXG5cdHByaXZhdGUgc21hbGwgPSBcIihhfGFufGFuZHxhc3xhdHxidXR8Ynl8ZW58Zm9yfGlmfGlufG9mfG9ufG9yfHRoZXx0b3x2Wy5dP3x2aWF8dnNbLl0/KVwiO1xyXG5cdHByaXZhdGUgcHVuY3R1YXRpb24gPSBcIihbIVxcXCIjJCUmJygpKissLi86Ozw9Pj9AW1xcXFxcXFxcXFxcXF1eX2B7fH1+LV0qKVwiO1xyXG4gIFxyXG5cdHRpdGxlQ2FwcyAodGl0bGU6c3RyaW5nKXtcclxuXHRcdHZhciBwYXJ0czogc3RyaW5nW10gPSBbXSwgc3BsaXQgPSAvWzouOz8hXSB8KD86IHxeKVtcIlx1MDBEMl0vZywgaW5kZXggPSAwO1xyXG5cdFx0XHJcblx0XHR3aGlsZSAodHJ1ZSkge1xyXG5cdFx0XHR2YXIgbSA9IHNwbGl0LmV4ZWModGl0bGUpO1xyXG5cclxuXHRcdFx0cGFydHMucHVzaCggdGl0bGUuc3Vic3RyaW5nKGluZGV4LCBtID8gbS5pbmRleCA6IHRpdGxlLmxlbmd0aClcclxuXHRcdFx0XHQucmVwbGFjZSgvXFxiKFtBLVphLXpdW2Etei4nXHUwMEQ1XSopXFxiL2csIChhbGw6c3RyaW5nKSA9PntcclxuXHRcdFx0XHRcdHJldHVybiAvW0EtWmEtel1cXC5bQS1aYS16XS8udGVzdChhbGwpID8gYWxsIDogdGhpcy51cHBlcihhbGwpO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LnJlcGxhY2UoUmVnRXhwKFwiXFxcXGJcIiArIHRoaXMuc21hbGwgKyBcIlxcXFxiXCIsIFwiaWdcIiksIHRoaXMubG93ZXIpXHJcblx0XHRcdFx0LnJlcGxhY2UoUmVnRXhwKFwiXlwiICsgdGhpcy5wdW5jdHVhdGlvbiArIHRoaXMuc21hbGwgKyBcIlxcXFxiXCIsIFwiaWdcIiksIChhbGw6c3RyaW5nLCBwdW5jdDpzdHJpbmcsIHdvcmQ6c3RyaW5nKSA9PntcclxuXHRcdFx0XHRcdHJldHVybiBwdW5jdCArIHRoaXMudXBwZXIod29yZCk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQucmVwbGFjZShSZWdFeHAoXCJcXFxcYlwiICsgdGhpcy5zbWFsbCArIHRoaXMucHVuY3R1YXRpb24gKyBcIiRcIiwgXCJpZ1wiKSwgdGhpcy51cHBlcikpO1xyXG5cdFx0XHRcclxuXHRcdFx0aW5kZXggPSBzcGxpdC5sYXN0SW5kZXg7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoIG0gKSBwYXJ0cy5wdXNoKCBtWzBdICk7XHJcblx0XHRcdGVsc2UgYnJlYWs7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiBwYXJ0cy5qb2luKFwiXCIpLnJlcGxhY2UoLyBWKHM/KVxcLiAvaWcsIFwiIHYkMS4gXCIpXHJcblx0XHRcdC5yZXBsYWNlKC8oWydcdTAwRDVdKVNcXGIvaWcsIFwiJDFzXCIpXHJcblx0XHRcdC5yZXBsYWNlKC9cXGIoQVQmVHxRJkEpXFxiL2lnLCBmdW5jdGlvbihhbGwpe1xyXG5cdFx0XHRcdHJldHVybiBhbGwudG9VcHBlckNhc2UoKTtcclxuXHRcdFx0fSk7XHJcblx0fTtcclxuICAgIFxyXG5cdGxvd2VyKHdvcmQ6c3RyaW5nKXtcclxuXHRcdHJldHVybiB3b3JkLnRvTG93ZXJDYXNlKCk7XHJcblx0fVxyXG4gICAgXHJcblx0dXBwZXIod29yZDpzdHJpbmcpe1xyXG5cdCAgcmV0dXJuIHdvcmQuc3Vic3RyKDAsMSkudG9VcHBlckNhc2UoKSArIHdvcmQuc3Vic3RyKDEpO1xyXG5cdH1cclxufSIsICJpbXBvcnQgeyBSdWxlUHJvdG90eXBlLCBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHRpbmdUb29scyB9IGZyb20gXCIuLi90b29sc1wiO1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHJ1bGUgdGhhdCBjb252ZXJ0cyBpbnB1dCB2YWx1ZXMgdG8gdXBwZXIgY2FzZS5cclxuICogVGhpcyBydWxlIGNhbiBoYW5kbGUgdmFyaW91cyBpbnB1dCB0eXBlcyBpbmNsdWRpbmcgc3RyaW5ncywgYXJyYXlzLCBkYXRlcywgYW5kIG9iamVjdHMuXHJcbiAqIFxyXG4gKiBAZXh0ZW5kcyBSdWxlUHJvdG90eXBlXHJcbiAqIFxyXG4gKiBAcmVtYXJrc1xyXG4gKiAtIEZvciBzdHJpbmdzLCBpdCBjb252ZXJ0cyB0aGUgZW50aXJlIHN0cmluZyB0byB1cHBlciBjYXNlLlxyXG4gKiAtIEZvciBhcnJheXMsIGl0IG1hcHMgZWFjaCBlbGVtZW50IHRvIGl0cyB1cHBlciBjYXNlIHN0cmluZyByZXByZXNlbnRhdGlvbi5cclxuICogLSBGb3IgZGF0ZXMsIGl0IGNvbnZlcnRzIHRoZSBkYXRlIHRvIGFuIElTTyBzdHJpbmcgaW4gdXBwZXIgY2FzZS5cclxuICogLSBGb3Igb2JqZWN0cywgaXQgc2VyaWFsaXplcyB0aGUgb2JqZWN0IHRvIGEgSlNPTiBzdHJpbmcgYW5kIGNvbnZlcnRzIGl0IHRvIHVwcGVyIGNhc2UuXHJcbiAqIC0gSWYgdGhlIGlucHV0IHR5cGUgaXMgbm90IHJlY29nbml6ZWQsIGl0IHJldHVybnMgdGhlIGlucHV0IGFzIGlzLlxyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogYGBgdHlwZXNjcmlwdFxyXG4gKiBjb25zdCBydWxlID0gbmV3IFJ1bGVUb1VwcGVyQ2FzZSgpO1xyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KFwiaGVsbG9cIiwgdG9vbHMpKTsgLy8gT3V0cHV0czogXCJIRUxMT1wiXHJcbiAqIGNvbnNvbGUubG9nKHJ1bGUuZngoW1wiaGVsbG9cIiwgXCJ3b3JsZFwiXSwgdG9vbHMpKTsgLy8gT3V0cHV0czogW1wiSEVMTE9cIiwgXCJXT1JMRFwiXVxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KG5ldyBEYXRlKFwiMjAyMy0wMS0wMVwiKSwgdG9vbHMpKTsgLy8gT3V0cHV0czogXCIyMDIzLTAxLTAxVDAwOjAwOjAwLjAwMFpcIlxyXG4gKiBjb25zb2xlLmxvZyhydWxlLmZ4KHsga2V5OiBcInZhbHVlXCIgfSwgdG9vbHMpKTsgLy8gT3V0cHV0czogJ3tcIktFWVwiOlwiVkFMVUVcIn0nXHJcbiAqIGBgYFxyXG4gKiBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcnVsZS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBUaGUgZGlzcGxheSBuYW1lIG9mIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZGVzY3JpcHRpb24gLSBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBydWxlJ3MgZnVuY3Rpb25hbGl0eS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IHJ1bGVUeXBlIC0gVGhlIHR5cGUgb2YgdGhlIHJ1bGUsIHdoaWNoIGlzIFwiZm9ybWF0dGVyXCIuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzb3VyY2UgLSBUaGUgc291cmNlIGNvZGUgdGVtcGxhdGUgZm9yIHRoZSBydWxlLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ1tdfSB0eXBlIC0gVGhlIHR5cGVzIG9mIGlucHV0IHRoaXMgcnVsZSBhcHBsaWVzIHRvLCBlLmcuLCBbJ3RleHQnXS5cclxuICogQHByb3BlcnR5IHtGdW5jdGlvbn0gZnggLSBUaGUgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB0aGUgdXBwZXIgY2FzZSB0cmFuc2Zvcm1hdGlvbi5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSdWxlVG9VcHBlckNhc2UgZXh0ZW5kcyBSdWxlUHJvdG90eXBlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5pZCA9ICd0b1VwcGVyQ2FzZSc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ1RvIFVwcGVyIENhc2UnO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSAnQ29udmVydCB0aGUgdmFsdWUgdG8gdXBwZXIgY2FzZS4nO1xyXG4gICAgICAgIHRoaXMucnVsZVR5cGUgPSAnZm9ybWF0dGVyJztcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IFwiZnVuY3Rpb24gKGFwcCwgZmlsZSwgdG9vbHMpIHsgLy8gZG8gbm90IGNoYW5nZSB0aGlzIGxpbmUhXFxuICBsZXQgcmVzdWx0ID0gJyc7XFxuICByZXR1cm4gcmVzdWx0O1xcbn1cIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBbJ3RleHQnLCAndGFncycsICdhbGlhc2VzJywgJ211bHRpdGV4dCddO1xyXG4gICAgICAgIHRoaXMuY29uZmlnRWxlbWVudHMgPSB0aGlzLmRlZmF1bHRDb25maWdFbGVtZW50cyh7fSk7XHJcbiAgICB9O1xyXG4gICAgZnggKGFwcDogQXBwIHwgdW5kZWZpbmVkLCBmaWxlOiBURmlsZSwgdG9vbHM6IFNjcmlwdGluZ1Rvb2xzLCBpbnB1dDogYW55KSB7IC8vIGRvIG5vdCBjaGFuZ2UgdGhpcyBsaW5lIVxyXG4gICAgICAgIGlmIChTdHJpbmcuaXNTdHJpbmcoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZihBcnJheS5pc0FycmF5KGlucHV0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXQubWFwKChpdGVtKSA9PiBTdHJpbmcoaXRlbSkudG9VcHBlckNhc2UoKSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnRvSVNPU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGlucHV0KS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vcnVsZXNNYW5hZ2VyLnJlZ2lzdGVyUnVsZShuZXcgUnVsZVRvVXBwZXJDYXNlKCkpOyIsICIvLyBUaGlzIGZpbGUgaXMgYXV0by1nZW5lcmF0ZWQuIERvIG5vdCBlZGl0IG1hbnVhbGx5LlxuLy8gR2VuZXJhdGVkIGJ5IGJ1aWxkLXJ1bGVzLWluZGV4LmpzXG5pbXBvcnQgeyBydWxlc01hbmFnZXIgfSBmcm9tIFwiLi9ydWxlc1wiO1xuaW1wb3J0IHsgUnVsZUFkZFByZWZpeCB9IGZyb20gXCIuL2FkZFByZWZpeFwiO1xuaW1wb3J0IHsgUnVsZUFkZFN1ZmZpeCB9IGZyb20gXCIuL2FkZFN1ZmZpeFwiO1xuaW1wb3J0IHsgUnVsZUF1dG9tYXRpb25BdXRvTGluayB9IGZyb20gXCIuL2F1dG9tYXRpb25BdXRvTGlua1wiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5BdXRvQ29tcGxldGVNb2RhbCB9IGZyb20gXCIuL2J1aWxkSW5BdXRvQ29tcGxldGVNb2RhbFwiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5Db25jYXRBcnJheXMgfSBmcm9tIFwiLi9idWlsZEluQ29uY2F0QXJyYXlzXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkNvbmNhdFByb3BlcnRpZXMgfSBmcm9tIFwiLi9idWlsZEluQ29uY2F0UHJvcGVydGllc1wiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5Db25zdGFudCB9IGZyb20gXCIuL2J1aWxkSW5Db25zdGFudFwiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5EYXRlVGltZUNyZWF0ZWQgfSBmcm9tIFwiLi9idWlsZEluRGF0ZVRpbWVDcmVhdGVkXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkRhdGVUaW1lTW9kaWZpZWQgfSBmcm9tIFwiLi9idWlsZEluRGF0ZVRpbWVNb2RpZmllZFwiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5EZWZhdWx0IH0gZnJvbSBcIi4vYnVpbGRJbkRlZmF1bHRcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluRmlsZVNpemVCeXRlcyB9IGZyb20gXCIuL2J1aWxkSW5GaWxlU2l6ZUJ5dGVzXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkZpbGVTaXplU3RyaW5nIH0gZnJvbSBcIi4vYnVpbGRJbkZpbGVTaXplU3RyaW5nXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkZvbGRlciB9IGZyb20gXCIuL2J1aWxkSW5Gb2xkZXJcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluRm9sZGVyRm9sZGVyTm90ZXMgfSBmcm9tIFwiLi9idWlsZEluRm9sZGVyRm9sZGVyTm90ZXNcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluRm9sZGVycyB9IGZyb20gXCIuL2J1aWxkSW5Gb2xkZXJzXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkZ1bGxQYXRoIH0gZnJvbSBcIi4vYnVpbGRJbkZ1bGxQYXRoXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0IH0gZnJvbSBcIi4vYnVpbGRJbkZ1bGxQYXRoRXh0XCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0Rm9sZGVyTm90ZXMgfSBmcm9tIFwiLi9idWlsZEluRnVsbFBhdGhFeHRGb2xkZXJOb3Rlc1wiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5GdWxsUGF0aEZvbGRlck5vdGVzIH0gZnJvbSBcIi4vYnVpbGRJbkZ1bGxQYXRoRm9sZGVyTm90ZXNcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluR2V0UHJvcGVydHkgfSBmcm9tIFwiLi9idWlsZEluR2V0UHJvcGVydHlcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluSXNSb290IH0gZnJvbSBcIi4vYnVpbGRJbklzUm9vdFwiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5MaW5rVG9GaWxlIH0gZnJvbSBcIi4vYnVpbGRJbkxpbmtUb0ZpbGVcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluTmFtZSB9IGZyb20gXCIuL2J1aWxkSW5OYW1lXCI7XG5pbXBvcnQgeyBSdWxlQnVpbGRJbk5hbWVFeHQgfSBmcm9tIFwiLi9idWlsZEluTmFtZUV4dFwiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5QYXRoIH0gZnJvbSBcIi4vYnVpbGRJblBhdGhcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluUGF0aEZvbGRlck5vdGVzIH0gZnJvbSBcIi4vYnVpbGRJblBhdGhGb2xkZXJOb3Rlc1wiO1xuaW1wb3J0IHsgUnVsZUJ1aWxkSW5Sb290Rm9sZGVyIH0gZnJvbSBcIi4vYnVpbGRJblJvb3RGb2xkZXJcIjtcbmltcG9ydCB7IFJ1bGVCdWlsZEluU2NyaXB0IH0gZnJvbSBcIi4vYnVpbGRJblNjcmlwdFwiO1xuaW1wb3J0IHsgUnVsZVJlcGxhY2VDaGFycyB9IGZyb20gXCIuL3JlcGxhY2VDaGFyc1wiO1xuaW1wb3J0IHsgUnVsZVJlcGxhY2VTcGFjZXMgfSBmcm9tIFwiLi9yZXBsYWNlU3BhY2VzXCI7XG5pbXBvcnQgeyBSdWxlUmVwbGFjZVNwZWNpYWxDaGFycyB9IGZyb20gXCIuL3JlcGxhY2VTcGVjaWFsQ2hhcnNcIjtcbmltcG9ydCB7IFJ1bGVUb0NhbWVsQ2FzZSB9IGZyb20gXCIuL3RvQ2FtZWxDYXNlXCI7XG5pbXBvcnQgeyBSdWxlVG9MaW5rTWFya2Rvd24gfSBmcm9tIFwiLi90b0xpbmtNYXJrZG93blwiO1xuaW1wb3J0IHsgUnVsZVRvTGlua09yaWdpbmFsIH0gZnJvbSBcIi4vdG9MaW5rT3JpZ2luYWxcIjtcbmltcG9ydCB7IFJ1bGVUb0xpbmtTaW1wbGUgfSBmcm9tIFwiLi90b0xpbmtTaW1wbGVcIjtcbmltcG9ydCB7IFJ1bGVUb0xpbmtXaWtpIH0gZnJvbSBcIi4vdG9MaW5rV2lraVwiO1xuaW1wb3J0IHsgUnVsZVRvTG93ZXJDYXNlIH0gZnJvbSBcIi4vdG9Mb3dlckNhc2VcIjtcbmltcG9ydCB7IFJ1bGVUb09yaWdpbmFsIH0gZnJvbSBcIi4vdG9PcmlnaW5hbFwiO1xuaW1wb3J0IHsgUnVsZVRvUGFzY2FsQ2FzZSB9IGZyb20gXCIuL3RvUGFzY2FsQ2FzZVwiO1xuaW1wb3J0IHsgUnVsZVRvVGl0bGVDYXNlIH0gZnJvbSBcIi4vdG9UaXRsZUNhc2VcIjtcbmltcG9ydCB7IFJ1bGVUb1RpdGxlQ2FzZURFIH0gZnJvbSBcIi4vdG9UaXRsZUNhc2VERVwiO1xuaW1wb3J0IHsgUnVsZVRvVGl0bGVDYXNlRU4gfSBmcm9tIFwiLi90b1RpdGxlQ2FzZUVOXCI7XG5pbXBvcnQgeyBSdWxlVG9VcHBlckNhc2UgfSBmcm9tIFwiLi90b1VwcGVyQ2FzZVwiO1xuXG4vLyBMaXN0IG9mIGFsbCBydWxlIGNsYXNzZXNcbmNvbnN0IHJ1bGVDbGFzc2VzID0gW1J1bGVBZGRQcmVmaXgsIFJ1bGVBZGRTdWZmaXgsIFJ1bGVBdXRvbWF0aW9uQXV0b0xpbmssIFJ1bGVCdWlsZEluQXV0b0NvbXBsZXRlTW9kYWwsIFJ1bGVCdWlsZEluQ29uY2F0QXJyYXlzLCBSdWxlQnVpbGRJbkNvbmNhdFByb3BlcnRpZXMsIFJ1bGVCdWlsZEluQ29uc3RhbnQsIFJ1bGVCdWlsZEluRGF0ZVRpbWVDcmVhdGVkLCBSdWxlQnVpbGRJbkRhdGVUaW1lTW9kaWZpZWQsIFJ1bGVCdWlsZEluRGVmYXVsdCwgUnVsZUJ1aWxkSW5GaWxlU2l6ZUJ5dGVzLCBSdWxlQnVpbGRJbkZpbGVTaXplU3RyaW5nLCBSdWxlQnVpbGRJbkZvbGRlciwgUnVsZUJ1aWxkSW5Gb2xkZXJGb2xkZXJOb3RlcywgUnVsZUJ1aWxkSW5Gb2xkZXJzLCBSdWxlQnVpbGRJbkZ1bGxQYXRoLCBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0LCBSdWxlQnVpbGRJbkZ1bGxQYXRoRXh0Rm9sZGVyTm90ZXMsIFJ1bGVCdWlsZEluRnVsbFBhdGhGb2xkZXJOb3RlcywgUnVsZUJ1aWxkSW5HZXRQcm9wZXJ0eSwgUnVsZUJ1aWxkSW5Jc1Jvb3QsIFJ1bGVCdWlsZEluTGlua1RvRmlsZSwgUnVsZUJ1aWxkSW5OYW1lLCBSdWxlQnVpbGRJbk5hbWVFeHQsIFJ1bGVCdWlsZEluUGF0aCwgUnVsZUJ1aWxkSW5QYXRoRm9sZGVyTm90ZXMsIFJ1bGVCdWlsZEluUm9vdEZvbGRlciwgUnVsZUJ1aWxkSW5TY3JpcHQsIFJ1bGVSZXBsYWNlQ2hhcnMsIFJ1bGVSZXBsYWNlU3BhY2VzLCBSdWxlUmVwbGFjZVNwZWNpYWxDaGFycywgUnVsZVRvQ2FtZWxDYXNlLCBSdWxlVG9MaW5rTWFya2Rvd24sIFJ1bGVUb0xpbmtPcmlnaW5hbCwgUnVsZVRvTGlua1NpbXBsZSwgUnVsZVRvTGlua1dpa2ksIFJ1bGVUb0xvd2VyQ2FzZSwgUnVsZVRvT3JpZ2luYWwsIFJ1bGVUb1Bhc2NhbENhc2UsIFJ1bGVUb1RpdGxlQ2FzZSwgUnVsZVRvVGl0bGVDYXNlREUsIFJ1bGVUb1RpdGxlQ2FzZUVOLCBSdWxlVG9VcHBlckNhc2VdO1xuXG4vLyBSZWdpc3RlciBlYWNoIHJ1bGUgY2xhc3NcbnJ1bGVDbGFzc2VzLmZvckVhY2goKFJ1bGVDbGFzcykgPT4ge1xuICAgIGNvbnN0IHJ1bGVJbnN0YW5jZSA9IG5ldyBSdWxlQ2xhc3MoKTtcbiAgICBydWxlc01hbmFnZXIucmVnaXN0ZXJSdWxlKHJ1bGVJbnN0YW5jZSk7XG59KTsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxvQkFBNkk7OztBQ0E3SSxJQUFBQyxvQkFBaUg7OztBQ0FqSCxJQUFBQyxtQkFBaUQ7OztBQ0FqRCxzQkFBdUI7OztBQ0VoQixJQUFNLGVBQU4sY0FBMkIsTUFBTTtBQUFBLEVBQ3BDLFlBQVksS0FBb0IsYUFBc0I7QUFDbEQsVUFBTSxHQUFHO0FBRG1CO0FBRTVCLFNBQUssT0FBTyxLQUFLLFlBQVk7QUFDN0IsUUFBSSxNQUFNLG1CQUFtQjtBQUN6QixZQUFNLGtCQUFrQixNQUFNLEtBQUssV0FBVztBQUFBLElBQ2xEO0FBQUEsRUFDSjtBQUNKO0FBbUJPLFNBQVMsaUJBQW9CQyxLQUFhLEtBQWdCO0FBQzdELE1BQUk7QUFDQSxXQUFPQSxJQUFHO0FBQUEsRUFDZCxTQUFTLEdBQVA7QUFDRSxRQUFJLGFBQWEsT0FBTztBQUNwQixlQUFTLElBQUksYUFBYSxLQUFLLEVBQUUsT0FBTyxDQUFDO0FBQUEsSUFDN0MsT0FBTztBQUNILGVBQVMsSUFBSSxhQUFhLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQztBQUFBLElBQzdDO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFDSjs7O0FEcENPLElBQU0sTUFBTTtBQUNaLElBQU0sUUFBUTtBQUNkLElBQU0sUUFBUTtBQUNkLElBQU0sVUFBVTtBQUNoQixJQUFNLE9BQU87QUFDYixJQUFNLFFBQVE7QUFDZCxJQUFNLFFBQVE7QUFjZCxTQUFTLFNBQVMsR0FBK0I7QUFDcEQsUUFBTSxTQUFTLElBQUksdUJBQU8sSUFBSSxH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QUFZLEtBQUssWUFBVyxRQUFRLElBQUk7QUFDMUYsWUFBSSxDQUFDLG1CQUFtQixNQUFNLEtBQUssVUFBVSxJQUFJLEdBQUc7QUFDaEQsaUJBQU8sSUFBSSxPQUFNLFFBQVEsS0FBSywwQkFBMEIsS0FBSyxZQUFZLEtBQUssbUJBQW1CO0FBQ2pHLGlCQUFPLFNBQVM7QUFDaEI7QUFBQSxRQUNKO0FBQ0EsWUFBSSxLQUFLLGNBQWMsQ0FBQyxZQUFZLGVBQWUsS0FBSyxRQUFRLEdBQUc7QUFDL0QsaUJBQU8sSUFBSSxPQUFNLFNBQVMsS0FBSyxrQkFBa0IsS0FBSyxrQkFBa0IsS0FBSyxrQ0FBa0M7QUFDL0csaUJBQU8sU0FBUztBQUNoQjtBQUFBLFFBQ0o7QUFDQSxpQkFBUUEsTUFBQSxhQUFhLFlBQVksS0FBSyxPQUFPLE1BQXJDLGdCQUFBQSxJQUF3QyxVQUFVO0FBQUEsVUFDdEQsS0FBSztBQUFBLFVBQ0wsS0FBSztBQUNELHFCQUFTLGtCQUFrQixXQUFXLEtBQUssS0FBSyxNQUFNLEtBQUssVUFBVSxNQUFNLFlBQVksS0FBSyxRQUFRLEdBQUcsTUFBTSxhQUFhLGtCQUFrQjtBQUM1STtBQUFBLFVBQ0o7QUFBQSxRQUNKO0FBQ0Esb0JBQVksS0FBSyxRQUFRLElBQUk7QUFDN0IsZUFBTyxTQUFTO0FBQUEsTUFDcEI7QUFDQSxhQUFPLElBQUksT0FBTSx1QkFBc0IsV0FBVztBQUNsRCxhQUFPLFNBQVM7QUFBQSxJQUNwQixHQUFFLEVBQUMsU0FBUSxLQUFLLEtBQUssTUFBSyxDQUFDO0FBQUEsRUFDL0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQXVCSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZm4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJydWxlIiwgInZhbHVlIiwgImpzQ29kZSIsICJydWxlIiwgInBhdGgiLCAidGV4dCIsICJpbXBvcnRfb2JzaWRpYW4iLCAicGF0aCIsICJpbXBvcnRfb2JzaWRpYW4iLCAicGF0aCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImpzQ29kZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJydWxlIiwgIl9hIiwgIl9iIiwgIl9jIiwgIl9kIiwgIl9lIiwgIl9mIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAibmFtZSIsICJzdHlsZSIsICJ3aW5kb3ciLCAibWluIiwgIm1heCIsICJ0b1BhZGRpbmdPYmplY3QiLCAicG9wcGVyT2Zmc2V0cyIsICJtaW4iLCAibWF4IiwgIm9mZnNldCIsICJlZmZlY3QiLCAicG9wcGVyIiwgImVmZmVjdCIsICJ3aW5kb3ciLCAiaGFzaCIsICJjbGlwcGluZ1BhcmVudHMiLCAicmVmZXJlbmNlIiwgInBvcHBlck9mZnNldHMiLCAib2Zmc2V0IiwgInBsYWNlbWVudHMiLCAicGxhY2VtZW50IiwgInBsYWNlbWVudHMiLCAicGxhY2VtZW50IiwgIl9sb29wIiwgIl9pIiwgImNoZWNrcyIsICJvZmZzZXQiLCAicG9wcGVyT2Zmc2V0cyIsICJvZmZzZXQiLCAibWluIiwgIm1heCIsICJmbiIsICJtZXJnZWQiLCAiZGVmYXVsdE1vZGlmaWVycyIsICJjcmVhdGVQb3BwZXIiLCAicmVmZXJlbmNlIiwgInBvcHBlciIsICJvcHRpb25zIiwgImZuIiwgInN0YXRlIiwgImVmZmVjdCIsICJub29wRm4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZnJvbnRtYXR0ZXIiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJyZXN1bHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInBhdGgiLCAicGF0aCIsICJwYXRoIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicGF0aCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZm9sZGVyIiwgIl9hIl0KfQo=
